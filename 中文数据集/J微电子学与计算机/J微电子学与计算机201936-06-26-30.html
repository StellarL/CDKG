<!DOCTYPE html>
<html>
<head>
    <title>全文阅读--XML全文阅读--中国知网</title>
    <link rel="icon" href="/kxreader/favicon.ico" />
    <link rel="shortcut Icon" href="/kxreader/favicon.ico" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="keywords" content="文献 XML KBASE CNKI 中国知网" />
    <meta name="description" content="XML文献检索" />
    <link href="/kxreader/Content/css/detail?v=qX2z2KjRAEyQiNfAbKtl7dLnsqFoQ5Jdw3TZfDf0n1k1" rel="stylesheet"/>

    <script type="text/javascript">
        var APPPATH = '/kxreader';
    </script>
</head>

<body>
    
<script type="text/javascript" src="//login.cnki.net/TopLogin/api/loginapi/get?type=top&amp;localCSS=&amp;returnurl=%2f%2fkns.cnki.net%2f%2fKXReader%2fDetail%3fTIMESTAMP%3d637134009503225000%26DBCODE%3dCJFD%26TABLEName%3dCJFDLAST2019%26FileName%3dWXYJ201906006%26RESULT%3d1%26SIGN%3dkBmOCs4qBhSqExXxOibiRQhI9Hg%253d"></script>

<div id="headerBox" class="header">
    <div class="topbar">
        <div class="textalign">
            <a href="/kxreader/Detail?dbcode=CJFD&amp;filename=WXYJ201906006&amp;align=md">
                <i class="icon-cen active" title="居中对齐"></i>
            </a>
            <a href="/kxreader/Detail?dbcode=CJFD&amp;filename=WXYJ201906006&amp;align=lt">
                <i class="icon-left " title="左对齐"></i>
            </a>
        </div>
        <h6 class="free-tip"><i class="icon"></i>HTML阅读开放试用阶段，欢迎体验！</h6>
    </div>
</div>

    



<div class="btn-link" style="display: none"><a target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=WXYJ201906006&amp;v=MTA0MTA1NE8zenFxQnRHRnJDVVJMT2VaZVZ1RnkzaFY3dk5NalhTWkxHNEg5ak1xWTlGWW9RS0RIODR2UjRUNmo=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEZ1NGRMODlOanZuT1VLOEVOTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">知网节</a></div>

    <div class="main">

        

    <div class="sidebar-a">
        <!--sidebar start-->
        <div class="sidenav">
            <div class="arrow"><span></span></div>
            <!--sidebar_list start-->
            <dl class="sidenav-list">
                    <dt class="tit">目录结构</dt>
                            <dd class="guide">
                                    <p><a href="#17" data-title="1 &lt;b&gt;引言&lt;/b&gt; ">1 <b>引言</b></a><i></i></p>
                                                            </dd>
                            <dd class="guide">
                                    <p><a href="#20" data-title="2 NVMe&lt;b&gt;简介&lt;/b&gt; ">2 NVMe<b>简介</b></a><i></i></p>
                                                                    <ul class="contentbox">
                                                <li><a href="#22" data-title="2.1 PCIe&lt;b&gt;接口&lt;/b&gt;">2.1 PCIe<b>接口</b></a></li>
                                                <li><a href="#27" data-title="2.2 NVMe&lt;b&gt;队列&lt;/b&gt;">2.2 NVMe<b>队列</b></a></li>
                                                <li><a href="#37" data-title="2.3 NVMe&lt;b&gt;命令&lt;/b&gt;">2.3 NVMe<b>命令</b></a></li>
                                                <li><a href="#50" data-title="2.4 NVMe&lt;b&gt;寄存器&lt;/b&gt;">2.4 NVMe<b>寄存器</b></a></li>
                                    </ul>
                            </dd>
                            <dd class="guide">
                                    <p><a href="#57" data-title="3 &lt;b&gt;基于&lt;/b&gt;FPGA&lt;b&gt;的&lt;/b&gt;NVMe&lt;b&gt;主控端&lt;/b&gt;IP&lt;b&gt;核&lt;/b&gt; ">3 <b>基于</b>FPGA<b>的</b>NVMe<b>主控端</b>IP<b>核</b></a><i></i></p>
                                                                    <ul class="contentbox">
                                                <li><a href="#58" data-title="3.1 &lt;b&gt;设计原理&lt;/b&gt;">3.1 <b>设计原理</b></a></li>
                                                <li><a href="#62" data-title="3.2 &lt;b&gt;系统架构&lt;/b&gt;">3.2 <b>系统架构</b></a></li>
                                                <li><a href="#82" data-title="3.3 &lt;b&gt;操作流程&lt;/b&gt;">3.3 <b>操作流程</b></a></li>
                                    </ul>
                            </dd>
                            <dd class="guide">
                                    <p><a href="#96" data-title="4 &lt;b&gt;仿真验证&lt;/b&gt; ">4 <b>仿真验证</b></a><i></i></p>
                                                            </dd>
                            <dd class="guide">
                                    <p><a href="#100" data-title="5 &lt;b&gt;结束语&lt;/b&gt; ">5 <b>结束语</b></a><i></i></p>
                                                            </dd>
                            <dd class="guide">
                                    <p><a href="#" data-title="文内图表 ">文内图表</a><i></i></p>
                                                                    <ul class="contentbox">
                                                <li><a href="#24" data-title="&lt;b&gt;表&lt;/b&gt;1 &lt;b&gt;总线版本与吞吐量的关系 (单工速度&lt;/b&gt;) "><b>表</b>1 <b>总线版本与吞吐量的关系 (单工速度</b>) </a></li>
                                                <li><a href="#48" data-title="&lt;b&gt;图&lt;/b&gt;1 NVMe&lt;b&gt;命令处理流程&lt;/b&gt;"><b>图</b>1 NVMe<b>命令处理流程</b></a></li>
                                                <li><a href="#60" data-title="&lt;b&gt;图&lt;/b&gt;2 NVMe&lt;b&gt;主控端&lt;/b&gt;IP&lt;b&gt;核原理框图&lt;/b&gt;"><b>图</b>2 NVMe<b>主控端</b>IP<b>核原理框图</b></a></li>
                                                <li><a href="#64" data-title="&lt;b&gt;图&lt;/b&gt;3 NVMe&lt;b&gt;主控端&lt;/b&gt;IP&lt;b&gt;核模块化设计&lt;/b&gt;"><b>图</b>3 NVMe<b>主控端</b>IP<b>核模块化设计</b></a></li>
                                                <li><a href="#98" data-title="&lt;b&gt;图&lt;/b&gt;4 Identify&lt;b&gt;命令仿真测试&lt;/b&gt;"><b>图</b>4 Identify<b>命令仿真测试</b></a></li>
                                                <li><a href="#99" data-title="&lt;b&gt;图&lt;/b&gt;5 Write 128KByte、Read 128KByte&lt;b&gt;命令仿真测试&lt;/b&gt;"><b>图</b>5 Write 128KByte、Read 128KByte<b>命令仿真测试</b></a></li>
                                    </ul>
                            </dd>
                                    <dd class="guide">
                                        <h6>
                                            <p><a href="#a_bibliography">参考文献</a> </p>
                                        </h6>
                                    </dd>

            </dl>
        </div>
        <!--sidebar end-->
        &nbsp;
        <!--此处有一空格符 勿删-->
    </div>

                <div class="sidebar-b three-collumn" style="width:0;">
            <div class="refer" style="width: 0;">
                <div class="arrow off" title="参考文献"><span></span></div>
                <div class="js-scrollbox" >
                    
                    <div class="subbox active">
                        <h4>
                            <span class="tit">参考文献</span>
                            <a class="close" href="javascript:void(0)">x</a>
                        </h4>
                        <div class="side-scroller">
                            <ul class="refer-list">
                                <li id="3">


                                    <a id="bibliography_1" >
                                        <b>[1]</b>
                                     董星.基于FPGA的存储控制器及相关系统设计技术研究[D].杭州:浙江大学, 2016.</a>
                                </li>
                                <li id="5">


                                    <a id="bibliography_2" >
                                        <b>[2]</b>
                                     NVMe标准组织.NVM_Express_Revision_1.3a[EB/OL]. (2017-10-24) [2018-08-24] http://www.nvmexpress.org/about/.</a>
                                </li>
                                <li id="7">


                                    <a id="bibliography_3" title=" SSD FANS.深入浅出SSD:固态存储核心技术、原理与实战[M].北京:机械工业出版社, 2018." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CBBD&amp;filename=9787111599791000&amp;v=MzA4MzlsVTdyTUpGb1JYRnF6R2JLNUg5VEZwb2hNWmVzUERCTTh6eFVTbURkOVNIN24zeEU5ZmJ2bktyaWZadTl1RkNy&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEZ1NGRMODlOanZuT1VLOEVOTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[3]</b>
                                         SSD FANS.深入浅出SSD:固态存储核心技术、原理与实战[M].北京:机械工业出版社, 2018.
                                    </a>
                                </li>
                                <li id="9">


                                    <a id="bibliography_4" title=" 王齐.PCIe体系结构导读[M].北京:机械工业出版社, 2010." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CBBD&amp;filename=9787111298229001&amp;v=Mjc4MTIzeEU5ZmJ2bktyaWZadTl1RkNybFU3ck1KRm9SWEZxekdiSzVIOVBGcDQxSGJlc1BEUk04enhVU21EZDlTSDdu&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEZ1NGRMODlOanZuT1VLOEVOTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[4]</b>
                                         王齐.PCIe体系结构导读[M].北京:机械工业出版社, 2010.
                                    </a>
                                </li>
                                <li id="11">


                                    <a id="bibliography_5" title=" 盘勇军, 黄伯铮.VxWorks6.8操作系统下的NVMe驱动设计[J].航空电子技术, 2017, 48 (4) :32-33." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=HKDZ201704007&amp;v=MDU2NDhIOWJNcTQ5Rlk0UUtESDg0dlI0VDZqNTRPM3pxcUJ0R0ZyQ1VSTE9lWmVWdUZ5M2hWN3ZOTFNiUGRMRzQ=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEZ1NGRMODlOanZuT1VLOEVOTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[5]</b>
                                         盘勇军, 黄伯铮.VxWorks6.8操作系统下的NVMe驱动设计[J].航空电子技术, 2017, 48 (4) :32-33.
                                    </a>
                                </li>
                                <li id="13">


                                    <a id="bibliography_6" title=" 王磊.基于VPX的嵌入式高性能存储技术研究[D].杭州:浙江大学, 2018." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CMFD&amp;filename=1018172666.nh&amp;v=MTM3OTc3dk5WRjI2RnJLL0hOZktxWkViUElRS0RIODR2UjRUNmo1NE8zenFxQnRHRnJDVVJMT2VaZVZ1RnkzaFY=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEZ1NGRMODlOanZuT1VLOEVOTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[6]</b>
                                         王磊.基于VPX的嵌入式高性能存储技术研究[D].杭州:浙江大学, 2018.
                                    </a>
                                </li>
                                <li id="15">


                                    <a id="bibliography_7" title=" 贾效玲, 张刚, 张博.SATA 硬盘控制器的 FPGA 实现[J].火力与指挥控制, 2016, 41 (9) :182." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=HLYZ201609041&amp;v=MTQ0MTVCWllRS0RIODR2UjRUNmo1NE8zenFxQnRHRnJDVVJMT2VaZVZ1RnkzaFY3dk5MU0hTZExHNEg5Zk1wbzk=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEZ1NGRMODlOanZuT1VLOEVOTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[7]</b>
                                         贾效玲, 张刚, 张博.SATA 硬盘控制器的 FPGA 实现[J].火力与指挥控制, 2016, 41 (9) :182.
                                    </a>
                                </li>
                            </ul>
                            <div style='display: none;' class="zqscroller" >
                                <h4 class="">附加材料</h4>
                                <ul></ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            &nbsp;
            <!--此处有一空格符 勿删-->
        </div>

        
    <div class="content">



        <!--tips start-->
                            <div class="tips">
                    <a href="http://navi.cnki.net/KNavi/JournalDetail?pcode=CJFD&amp;pykm=WXYJ" target="_blank">微电子学与计算机</a>
                2019,36(06),26-30             </div>
        <!--tips end-->
            <div class="top-title">
                <h1 class="title">
                    <span class="vm"><b>NVMe高速存储的FPGA实现</b></span>
                                    </h1>

            </div>
                        <h2>
                                <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=au&amp;skey=%E5%B4%94%E4%B8%B9%E4%B8%B9&amp;code=33243407&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEZ1NGRMODlOanZuT1VLOEVOTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">崔丹丹</a>
                                <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=au&amp;skey=%E5%AE%AB%E6%B0%B8%E7%94%9F&amp;code=41180627&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEZ1NGRMODlOanZuT1VLOEVOTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">宫永生</a>
                </h2>
                    <h2>
                    <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=in&amp;skey=%E4%B8%AD%E5%9B%BD%E7%A7%91%E5%AD%A6%E9%99%A2%E5%A4%A7%E5%AD%A6&amp;code=1698842&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEZ1NGRMODlOanZuT1VLOEVOTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">中国科学院大学</a>
                    <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=in&amp;skey=%E4%B8%AD%E5%9B%BD%E7%A7%91%E5%AD%A6%E9%99%A2%E5%A4%AA%E7%A9%BA%E5%BA%94%E7%94%A8%E9%87%8D%E7%82%B9%E5%AE%9E%E9%AA%8C%E5%AE%A4%E4%B8%AD%E5%9B%BD%E7%A7%91%E5%AD%A6%E9%99%A2%E7%A9%BA%E9%97%B4%E5%BA%94%E7%94%A8%E5%B7%A5%E7%A8%8B%E4%B8%8E%E6%8A%80%E6%9C%AF%E4%B8%AD%E5%BF%83&amp;code=1700032&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEZ1NGRMODlOanZuT1VLOEVOTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">中国科学院太空应用重点实验室中国科学院空间应用工程与技术中心</a>
            </h2>

        
<div class="link">
    <a id="aexport" class="icon icon-output"  onclick="" href="javascript:void(0);"><i></i>导出/参考文献</a>
    
    <span class="shareBoard" onmouseover="$('#sharedet').show();$('#this').addClass('shareBoardCUR')" onmouseout="$('#sharedet').hide();$('#this').removeClass('shareBoardCUR')">
        <a class="icon icon-share" href="#"><i></i>分享<em></em></a>
        <ul class="shareHide" id="sharedet" style="display: none;">
            <li><a title="复制链接" class="copy" onclick="" href="#"><i></i>复制链接</a></li>
            <li><a title="分享到新浪微博" class="xl" onclick="" href="javascript:common.ShareAction('xl');"><i></i>新浪微博</a></li>
            <li>
                <a title="分享到微信" class="wx" onclick="" href="#"><i></i>微信扫一扫</a>
                <div class="qrcode"><img src='' alt='' /></div>
            </li>
        </ul>

    </span>
    
    <a id="RefTrack" title="创建引文跟踪" class="icon icon-track" onclick="" href="javascript:void(0);"> <i></i>创建引文跟踪 </a>
    <a id="ashoucang" title="收藏" class="icon icon-favor" onclick="" href="javascript:void(0);"><i></i>收藏</a>
    <a class="icon icon-print" onclick="window.print();" href="javascript:void(0);"><i></i>打印</a>
    
    <!--版本切换 end-->
</div>
                            <div class="data" id="a_abstract">
                <span class="keys">摘<span style="font-family: 'Times New Roman';">&nbsp;&nbsp;&nbsp;&nbsp;</span>要：</span>
                <p>针对当前SATA接口数据传输低延迟和读写性能的不足, 结合空间应用对主控系统的需求, 进行了高速接口设计, 本文提出了一种NVMe高速存储的FPGA实现方案.基于Xilinx公司的ZC706评估板, 参考NVMe协议1.3a, 运用VHDL硬件描述语言, 采用模块化设计理念, 完成NVMe主控IP核的设计.经仿真验证表明, 该主控IP核能正确完成读、写、设备复位、识别等操作, 可应用于嵌入式存储系统.</p>
            </div>
                    <div class="data" id="a_keywords">
                <span class="keys">关键词：</span>
                <p>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=NVMe1.3a&amp;code=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEZ1NGRMODlOanZuT1VLOEVOTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">NVMe1.3a;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=%E4%B8%BB%E6%8E%A7%E7%AB%AF&amp;code=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEZ1NGRMODlOanZuT1VLOEVOTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">主控端;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=%E9%AB%98%E9%80%9F&amp;code=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEZ1NGRMODlOanZuT1VLOEVOTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">高速;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=FPGA&amp;code=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEZ1NGRMODlOanZuT1VLOEVOTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">FPGA;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=VHDL&amp;code=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEZ1NGRMODlOanZuT1VLOEVOTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">VHDL;</a>
                </p>
            </div>
        
        <!--brief start-->
        
            <div class="brief">
                    <p>
                            <b>作者简介：</b>
                                                        <span>
                                    崔丹丹, 女, (1990-) , 硕士研究生.研究方向为空间数据存储.E-mail:cuidandan16@csu.ac.cn.;
                                </span>
                                <span>
                                    宫永生, 男, (1984-) , 博士, 副研究员.研究方向为空间数据存储.;
                                </span>
                    </p>
                                    <p><b>收稿日期：</b>2018-08-24</p>

                    <p>

                            <b>基金：</b>
                                                        <span>国家自然科学基金 (617011484);</span>
                    </p>
            </div>
                    <h1><b>A high-speed storage system of NVMe based on FPGA</b></h1>
                    <h2>
                    <span>CUI Dan-dan</span>
                    <span>GONG Yong-sheng</span>
            </h2>
                    <h2>
                    <span>University of Chinese Academy of Science</span>
                    <span>Key Laboratory of Space Utilization, Technology and Engineering Center for Space Utilization , Chinese Academy of Science</span>
            </h2>
                            <div class="data" id="a_abstractEN">
                <span class="keys">Abstract：</span>
                <p>In view of the shortcomings of low-latency data transmission and fast reading and writing of the current SATA interface, combined with the requirement of space application to the host controller, this paper proposed a FPGA implementation scheme for NVMe high-speed storage. It takes NVMe 1.3 a protocol for reference and is implemented on the basis of ZC706 evaluation board of Xilinx with modular design concept in VHDL language. According to the simulation verification, it shows that the controller IP core can realize many operations, such as reading, writing, device reset and identification. It can be applied to embedded storage system.</p>
            </div>
                    <div class="data" id="a_keywordsEN">
                <span class="keys">Keyword：</span>
                <p>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=NVMe1.3a&amp;code=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEZ1NGRMODlOanZuT1VLOEVOTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">NVMe1.3a;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=Host&amp;code=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEZ1NGRMODlOanZuT1VLOEVOTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">Host;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=High-speed&amp;code=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEZ1NGRMODlOanZuT1VLOEVOTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">High-speed;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=FPGA&amp;code=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEZ1NGRMODlOanZuT1VLOEVOTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">FPGA;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=VHDL&amp;code=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEZ1NGRMODlOanZuT1VLOEVOTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">VHDL;</a>
                </p>
            </div>
                    <div class="brief">
                
                    <p>
                                            </p>
                                    <p><b>Received：</b> 2018-08-24</p>
                                    <p>
                                            </p>
            </div>


        <!--brief start-->
                        <h3 id="17" name="17" class="anchor-tag">1 <b>引言</b></h3>
                <div class="p1">
                    <p id="18">利用固态电子存储芯片阵列 (NAND Flash) 制成的固态硬盘 (SSD) 已经成为数据储存的主要途径, 传统SSD大多采用SATA接口, 运行AHCI/SATA协议, 而SATA3.0理论最大传输速率为600 MB/s<citation id="102" type="reference"><link href="3" rel="bibliography" /><sup>[<a class="sup">1</a>]</sup></citation> (实际速度为560 MB/s) .随着我国空间站的建设, 整个空间系统的数据网将变得更加复杂、庞大, 解决数据传输的实时性、提高功耗的管控能力等迫在眉睫, SATA接口的极限传输速率逐渐无法满足空间应用领域的存储性能需求, 已经成为高带宽、大容量数据存储系统的发展瓶颈.</p>
                </div>
                <div class="p1">
                    <p id="19">基于PCIe接口的SSD加上非易失性存储器协议 (Non-Volatile Memory Express, NVMe) 可以有效解决接口的性能问题.NVMe是闪存类存储介质的逻辑接口总线传输协议规范, 此规范专为SSD而设计, 规定了主机与SSD之间的通信方式, 具有精简的内存接口、命令集和队列设计<citation id="103" type="reference"><link href="5" rel="bibliography" /><sup>[<a class="sup">2</a>]</sup></citation>, 其底层为PCIe通道, 充分利用了PCIe的低延时和并行性, 在可控制的存储成本下, 极大的提升了数据传输带宽和指令并行处理能力, 彻底解放了SATA时代固态硬盘的极致性能.在航天应用领域, FPGA以其丰富的逻辑资源与可靠性保证一直被作为主控系统的首选方案.因此本文将结合FPGA进行NVMe接口设计, 保证数据高速传输, 以适应未来空间领域中大容量、高宽带的存储需求.</p>
                </div>
                <h3 id="20" name="20" class="anchor-tag">2 NVMe<b>简介</b></h3>
                <div class="p1">
                    <p id="21">NVMe作为针对非易失性固态存储架构优化的标准协议, 定义了最优化的寄存器接口、指令集和功能集, 在设计时充分考虑了存储介质和传输过程, 优化数据传输路径和传输方式, 极大提高了数据传输效率, 降低了数据访问延迟.</p>
                </div>
                <h4 class="anchor-tag" id="22" name="22">2.1 PCIe<b>接口</b></h4>
                <div class="p1">
                    <p id="23">NVMe物理层采用 PCIe 通道进行数据传输, PCIe是一种全双工的串行总线, 具有带宽可扩展性的特性<citation id="104" type="reference"><link href="7" rel="bibliography" /><sup>[<a class="sup">3</a>]</sup></citation>, 总线版本与吞吐量的关系如表1所示<citation id="105" type="reference"><link href="9" rel="bibliography" /><link href="11" rel="bibliography" /><sup>[<a class="sup">4</a>,<a class="sup">5</a>]</sup></citation>.由此可见, 其速率远高于SATA3.0的理论最大传输速率.</p>
                </div>
                <div class="area_img" id="24">
                    <p class="img_tit"><b>表</b>1 <b>总线版本与吞吐量的关系 (单工速度</b>)  <a class="downexcel" onclick="DownLoadReportExcel(this)">导出到EXCEL</a></p>
                    <p class="img_tit"></p>
                    <p class="img_note"></p>
                    <table id="24" border="1"><tr><td rowspan="2"><br />PCIe<br />版本</td><td rowspan="2">编码方式</td><td colspan="3"><br />Lane-吞吐量 (MB/s) </td></tr><tr><td><br />×1</td><td>×4</td><td>×16</td></tr><tr><td><br />1.0</td><td>8b/10b</td><td>250</td><td>1 000</td><td>4 000</td></tr><tr><td><br />2.0</td><td>8b/10b</td><td>500</td><td>2 000</td><td>8 000</td></tr><tr><td><br />3.0</td><td>128b/130b</td><td>985</td><td>1 969</td><td>15 754</td></tr><tr><td><br />4.0</td><td>128b/130b</td><td>1 969</td><td>3 938</td><td>31 508</td></tr></table>
                    <form name="form" action="/kxreader/Detail/DownloadReportExcel" method="POST" style="display:inline">
                        <input type="hidden" name="hidTable" value="" />
                        <input type="hidden" name="hidFileName" value="" />
                    </form>
                    <p class="img_note"></p>
                    <p class="img_note"></p>
                </div>
                <div class="p1">
                    <p id="25">作为NVMe协议的底层通信接口, PCIe总线规范采用了分层的体系结构, 依次为事务层、数据链路层和物理层, 其中事务层作为NVMe协议与PCIe接口的信息交互层, 主要负责接收主控端生成的TLP包并发送到数据链路层, 发送包含设备端数据和命令的TLP包至主控端, 因此根据NVMe命令的执行过程, 每次读写操作会经过多次PCIe TLP包的信息交互.</p>
                </div>
                <div class="p1">
                    <p id="26">一个TLP包含多个可选的前缀、头、数据载荷和可选的后缀组成, 其中头是TLP最重要的标识, 包含当前TLP的总线事务类型、路由信息、有无后缀等一系列信息.当存储器读写TLP支持64 bit地址模式时, 头长度为4 DW, 否则为3 DW.数据载荷的长度可变, 最小为0, 最大为1 024 DW.</p>
                </div>
                <h4 class="anchor-tag" id="27" name="27">2.2 NVMe<b>队列</b></h4>
                <div class="p1">
                    <p id="28">NVMe协议主要基于提交队列SQ和完成队列CQ, 二者均分配于主控端存储空间中.当主控端发送命令时, 提交队列完成命令的存放与发送;当SSD执行完命令后, 会返回相应的执行状态, 放入完成队列中.</p>
                </div>
                <div class="p1">
                    <p id="29">根据NVMe命令的不同, 提交队列和完成队列分为Admin、I/O两种.Admin队列用于存放Admin命令码 (如设备识别、创建和删除I/O命令的SQ和CQ等) , I/O队列是NVMe协议的核心, 包含读、写等相关信息 (如逻辑块数量NLB和读写的起始地址SLBA等) .</p>
                </div>
                <div class="p1">
                    <p id="30">队列为固定大小的环形缓冲区, 采用生产-消耗模型, 规定队尾是生产者, 指向队列中的下一个空位, 队首是消耗者, 指向下一个将要被执行命令所在的位置.</p>
                </div>
                <div class="p1">
                    <p id="31">NVMe 协议对Admin SQ/CQ和IO SQ/CQ有不同的约定, 如下所示:</p>
                </div>
                <div class="p1">
                    <p id="32"> (1) 系统有且仅有一对Admin SQ/CQ, 但可以有最多64 K对I/O SQ/CQ;</p>
                </div>
                <div class="p1">
                    <p id="33"> (2) Admin SQ/CQ的队列深度可达4 096 (4K) ;而I/O SQ/CQ的队列深度可达65 536 (64K) ;</p>
                </div>
                <div class="p1">
                    <p id="34"> (3) Admin、I/O SQ条目大小为64 B, 对应的CQ条目大小为16 B;</p>
                </div>
                <div class="p1">
                    <p id="35"> (4) Admin SQ和CQ是一对一的, 而I/O SQ和CQ可以一对一或多对一, 多个SQ可以支持多线程工作, 不同SQ之间可以赋予不同的优先级;</p>
                </div>
                <div class="p1">
                    <p id="36"> (5) Admin和I/O的SQ、CQ均放在主控端内存中, 但SQ由主控端更新, CQ则由设备端更新.</p>
                </div>
                <h4 class="anchor-tag" id="37" name="37">2.3 NVMe<b>命令</b></h4>
                <div class="p1">
                    <p id="38">NVMe是一种主控端与设备端之间的通讯协议, 在协议栈中隶属高层, 即命令层, 它所发出的命令均通过PCIe总线去完成.NVMe有两种命令:admin命令和I/O命令.admin命令用以主控端管理和控制设备端, 而I/O命令用于二者之间的数据传输.</p>
                </div>
                <div class="p1">
                    <p id="39">命令的传输除了需要SQ、CQ外, 还需要门铃寄存器DB以及PCIe接口.每个SQ和CQ都有两个对应的DB:Head DB和Tail DB, DB是SSD端的寄存器, 记录SQ和CQ的头和尾的位置, 即读出和写入指针.命令的执行过程主要分为8步, 如图1所示:</p>
                </div>
                <div class="p1">
                    <p id="40"> (1) 主控端在自身内存中构建SQ和对应的CQ, 并将命令写入SQ尾部;</p>
                </div>
                <div class="p1">
                    <p id="41"> (2) 主控端更新SQ尾指针DB寄存器, 通知设备端到主控端提取新命令;</p>
                </div>
                <div class="p1">
                    <p id="42"> (3) 设备端查询DB的更新值, 到主控端SQ头部提取命令, 并实时更新设备端内部SQ头部指针;</p>
                </div>
                <div class="p1">
                    <p id="43"> (4) 设备端解析并执行命令, 进行相应的读写操作;</p>
                </div>
                <div class="p1">
                    <p id="44"> (5) 设备端完成一条指令后, 将执行结果封装为完成包并写入主控端CQ中;</p>
                </div>
                <div class="p1">
                    <p id="45"> (6) 设备端向主控端发送一个与回执信息相对应的中断信息, 通知主控端命令执行完毕;</p>
                </div>
                <div class="p1">
                    <p id="46"> (7) 主控端收到中断后, 解析CQ中的命令完成包并进行相应处理;</p>
                </div>
                <div class="p1">
                    <p id="47"> (8) 主控端处理完毕后, 释放完成队列位置, 并更新CQ头指针DB寄存器.</p>
                </div>
                <div class="area_img" id="48">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/WXYJ201906006_048.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEZ1NGRMODlOanZuT1VLOEVOTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图1 NVMe命令处理流程" src="Detail/GetImg?filename=images/WXYJ201906006_048.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEZ1NGRMODlOanZuT1VLOEVOTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit"><b>图</b>1 NVMe<b>命令处理流程</b>  <a class="btn-zoomin" href="Detail/GetImg?filename=images/WXYJ201906006_048.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEZ1NGRMODlOanZuT1VLOEVOTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="p1">
                    <p id="49">相较于 SATA/AHCI 协议, NVMe协议指令执行交互过程简单, 队列数量和深度远胜于前两者, 多个队列指令并行操作及简单的指令发送机制保证了读写操作的高效执行<citation id="106" type="reference"><link href="13" rel="bibliography" /><link href="15" rel="bibliography" /><sup>[<a class="sup">6</a>,<a class="sup">7</a>]</sup></citation>.</p>
                </div>
                <h4 class="anchor-tag" id="50" name="50">2.4 NVMe<b>寄存器</b></h4>
                <div class="p1">
                    <p id="51">NVMe协议利用PCIe设备基本配置空间中基地址寄存器0和1所指示的空间, 定义了一组控制寄存器, 用于初始化以及指令执行中指针位置的更新, 主要包括:</p>
                </div>
                <div class="p1">
                    <p id="52"> (1) CAP寄存器:指示SSD可支持的主控端内存页大小范围、命令集、DB寄存器地址间隔、仲裁方式、I/O SQ最大队列深度等;</p>
                </div>
                <div class="p1">
                    <p id="53"> (2) CC寄存器:配置I/O SQ和CQ的位宽、关机提醒、仲裁方式、主控端内存页大小、控制器使能等;</p>
                </div>
                <div class="p1">
                    <p id="54"> (3) CSTS寄存器:指示当前的关机进度、控制器错误信息以及是否准备完成等;</p>
                </div>
                <div class="p1">
                    <p id="55"> (4) ASQ和ACQ寄存器:指示Admin SQ和CQ基地址;</p>
                </div>
                <div class="p1">
                    <p id="56"> (5) SQyTDBL和CQyHDBL寄存器:用于主控端更新相应队列的指针位置.</p>
                </div>
                <h3 id="57" name="57" class="anchor-tag">3 <b>基于</b>FPGA<b>的</b>NVMe<b>主控端</b>IP<b>核</b></h3>
                <h4 class="anchor-tag" id="58" name="58">3.1 <b>设计原理</b></h4>
                <div class="p1">
                    <p id="59">利用FPGA的逻辑资源实现NVMe协议的高速通信, 主要包括用户命令解析、指令执行、数据传输以及系统管理.依据NVMe协议1.3a, 系统原理框图如图2.</p>
                </div>
                <div class="area_img" id="60">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/WXYJ201906006_060.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEZ1NGRMODlOanZuT1VLOEVOTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图2 NVMe主控端IP核原理框图" src="Detail/GetImg?filename=images/WXYJ201906006_060.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEZ1NGRMODlOanZuT1VLOEVOTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit"><b>图</b>2 NVMe<b>主控端</b>IP<b>核原理框图</b>  <a class="btn-zoomin" href="Detail/GetImg?filename=images/WXYJ201906006_060.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEZ1NGRMODlOanZuT1VLOEVOTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="p1">
                    <p id="61">收到用户命令后首先解码为64 Byte的NVMe命令码, 并存入提交队列中;指令执行与数据传输均通过PCIe 存储器读写操作进行, 因此主控端需完成PCIe TLP包的封装以及解封, 将数据和命令码发送到PCIe Block集成块, 并将收到的TLP包解封为数据和完成包, 放入相应的数据缓存区和CQ中.Xilinx公司在器件中提供了集成硬件模块PCIe Block的解决方案, 满足本文需求, 因此本文调用该资源进行功能整合, 并采用128 bit-Tx/Rx AXI4-Stream总线进行数据读写和命令传输.</p>
                </div>
                <h4 class="anchor-tag" id="62" name="62">3.2 <b>系统架构</b></h4>
                <div class="p1">
                    <p id="63">根据上述原理, 本文采用模块化理念完成对主控端IP核架构设计, 根据图1所示的命令处理流程, 可将该IP核分为NVMe_Ctr、Queue_pkg、Data_Buf、Data_Ctr四个子模块进行VHDL设计, 其中设计图如图3所示.</p>
                </div>
                <div class="area_img" id="64">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/WXYJ201906006_064.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEZ1NGRMODlOanZuT1VLOEVOTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图3 NVMe主控端IP核模块化设计" src="Detail/GetImg?filename=images/WXYJ201906006_064.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEZ1NGRMODlOanZuT1VLOEVOTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit"><b>图</b>3 NVMe<b>主控端</b>IP<b>核模块化设计</b>  <a class="btn-zoomin" href="Detail/GetImg?filename=images/WXYJ201906006_064.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEZ1NGRMODlOanZuT1VLOEVOTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <h4 class="anchor-tag" id="65" name="65">3.2.1 NVMe_Ctr模块</h4>
                <div class="p1">
                    <p id="66">该模块作为整个主控端IP的控制中心, 主要完成用户命令解析、SQ尾部/CQ头部控制、指令操作流程控制、状态参数监测、初始化配置、系统复位以及对完成包的处理.</p>
                </div>
                <div class="p1">
                    <p id="67">考虑FPGA内存资源并简化寻址机制, 当用户命令长度大于两个内存页大小时, 自动拆解为多条命令.因此, 除最后一条命令外, 其它命令的数据传输尺寸为两个内存页.当完成命令解码后, 该模块将64 Byte命令码发送至Queue_pkg模块提交队列尾部, 并保存每一个SQ尾部指针以通知设备端需处理的新命令个数.</p>
                </div>
                <div class="p1">
                    <p id="68">该模块包含控制指令操作流程的状态机, 根据图1所示的指令执行流程, 共分为8个执行状态, 状态进入后向Data_Ctr模块发送使能信号, 指令执行完毕后, 所有信号自动复位为初始值, 进入IDLE状态, 以待接收后续命令.</p>
                </div>
                <h4 class="anchor-tag" id="69" name="69">3.2.2 Queue_pkg模块</h4>
                <div class="p1">
                    <p id="70">作为主控端的提交队列和完成队列, 该模块由伪双端口Block RAM实现, 用于存放解码后的64 Byte命令码和指令执行后收到的16 Byte完成包.当第一个SQ为Full后, 自动存入下一个SQ, 直至所有SQ存满, 停止接收命令.</p>
                </div>
                <h4 class="anchor-tag" id="71" name="71">3.2.3 Data_Buf模块</h4>
                <div class="p1">
                    <p id="72">该模块是读写用户数据的缓存区, 由两个128 KByte伪双端口BlockRAM组成, 数据宽度为128 bit, 深度为8 K.</p>
                </div>
                <h4 class="anchor-tag" id="73" name="73">3.2.4 Data_Ctr模块</h4>
                <div class="p1">
                    <p id="74">该模块是NVMe主控端与PCIe Block的信息交互模块, 主要负责PCIe TLP的封装与解封, 根据命令执行过程, 主要包括以下PCIe TLP包的处理:</p>
                </div>
                <div class="p1">
                    <p id="75"> (1) 更新SQ尾部DB寄存器时, 把SQ尾部地址和相应的DB寄存器封装为Mwr TLP包发送到PCIe Block;</p>
                </div>
                <div class="p1">
                    <p id="76"> (2) 设备端控制器取指时, 首先解封来自PCIe Block的Mrd TLP包, 并把SQ命令封装为Cpld TLP包的数据段;</p>
                </div>
                <div class="p1">
                    <p id="77"> (3) 对于Idenify命令, 解封来自PCIe Block的4KByte Mwr TLP包, 去掉包头, 仅留取数据段作为提取硬盘剩余存储空间的依据;</p>
                </div>
                <div class="p1">
                    <p id="78"> (4) 对于write命令, 首先解封来自PCIe Block的Mrd TLP包, 并把用户数据封装为Cpld TLP包的数据段;</p>
                </div>
                <div class="p1">
                    <p id="79"> (5) 对于read命令, 解封来自PCIe Block的Mwr TLP包, 去掉包头, 仅留取数据段并传送到读缓存区;</p>
                </div>
                <div class="p1">
                    <p id="80"> (6) 获取MSI-X中断信号, 并发送至NVMe_Ctr;</p>
                </div>
                <div class="p1">
                    <p id="81"> (7) 更新CQ头部DB寄存器时, 把CQ头部地址和相应的DB寄存器封装为Mwr TLP包发送到PCIe Block.</p>
                </div>
                <h4 class="anchor-tag" id="82" name="82">3.3 <b>操作流程</b></h4>
                <h4 class="anchor-tag" id="83" name="83">3.3.1 初始化配置流程</h4>
                <div class="p1">
                    <p id="84">系统上电后自动进入初始化配置阶段, 复位信号有效, 首先进行PCIe初始化, 包括配置空间映射、链路状态检查与参数监视, 直至PCIe Block进入L0状态, 且PCIeLinkup信号有效; PCIe初始化完成后, 进行NVMe寄存器配置, 配置完成后, IP核进入IDLE状态, 需配置的寄存器功能主要包括:</p>
                </div>
                <div class="p1">
                    <p id="85"> (1) 配置内存页大小为64 KByte;</p>
                </div>
                <div class="p1">
                    <p id="86"> (2) 提交队列位宽64 Byte, Admin提交队列深度为32, I/O完提交队列深度为8 KByte, 并分配基地址;</p>
                </div>
                <div class="p1">
                    <p id="87"> (3) 完成队列位宽16 Byte、Admin完成队列深度为32, I/O完成队列深度为256, 并分配基地址;</p>
                </div>
                <div class="p1">
                    <p id="88"> (4) 选择仲裁方式为RR仲裁.</p>
                </div>
                <h4 class="anchor-tag" id="89" name="89">3.3.2 指令操作流程</h4>
                <div class="p1">
                    <p id="90">命令操作主要包括identify、write、read命令, 其中首条命令必须为identify命令, 识别硬盘的剩余存储空间.当收到用户命令后, IP核完成命令的解析并解码为64 Byte命令码存放于提交队列中.根据NVMe协议1.3a, 指令执行过程中, 主控端和SSD之间将通过多次PCIe存储器读写操作.</p>
                </div>
                <div class="p1">
                    <p id="91">首先主控端通过PCIe Memory Write TLP更新SQ尾部DB寄存器;设备端控制器通过DB寄存器的更新可解析出提交队列中待提取命令的个数, 并发送PCIe Memory Read TLP读取新命令, 主控端收到命令后返回携带SQ命令码的完成报文.设备端控制器收到NVMe SQ码后解析命令内容:</p>
                </div>
                <div class="p1">
                    <p id="92"> (1) 对于Identify命令, 通过PCIe Memory Write TLP返回4KByte数据结构, 该数据结构包含硬盘可用存储空间等信息;</p>
                </div>
                <div class="p1">
                    <p id="93"> (2) 对于write命令, 通过PCIe Memory Read TLP读取相应数据, 主控端返回的完成报文中会携带用户数据, 直至所有数据全部传输;</p>
                </div>
                <div class="p1">
                    <p id="94"> (3) 对于read命令, 通过PCIe Memory Write TLP将数据发送给主控端;</p>
                </div>
                <div class="p1">
                    <p id="95">数据传送完成后, 设备端控制器通过PCIe Memory Write TLP发送完成包, 由主控端IP核完成解析并发送至完成队列;随后, 设备端控制器发送MSI-X中断信号通知主控端IP核命令数据传输完成;IP核收到命令后检查完成队列条目, 对成功执行完毕的完成包直接丢弃, 未成功的完成包重新进行数据传送, 直至完成队列为空, 通过PCIe Memory Write TLP更新CQ头部DB寄存器.</p>
                </div>
                <h3 id="96" name="96" class="anchor-tag">4 <b>仿真验证</b></h3>
                <div class="p1">
                    <p id="97">IP核收到用户命令后, Busy信号置高, 经PCIeTx端口发送更新DB寄存器、64 Byte SQ命令码和用户数据, 图4、图5的仿真以Identify (返回4 K数据包) 、Write 128 KByte、Read 128 KByte数据为例;经PCIeRx端口接收设备端控制器返回的读取SQ头部命令、读用户数据命令、完成包和中断信号.</p>
                </div>
                <div class="area_img" id="98">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/WXYJ201906006_098.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEZ1NGRMODlOanZuT1VLOEVOTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图4 Identify命令仿真测试" src="Detail/GetImg?filename=images/WXYJ201906006_098.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEZ1NGRMODlOanZuT1VLOEVOTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit"><b>图</b>4 Identify<b>命令仿真测试</b>  <a class="btn-zoomin" href="Detail/GetImg?filename=images/WXYJ201906006_098.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEZ1NGRMODlOanZuT1VLOEVOTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="area_img" id="99">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/WXYJ201906006_099.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEZ1NGRMODlOanZuT1VLOEVOTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图5 Write 128KByte、Read 128KByte命令仿真测试" src="Detail/GetImg?filename=images/WXYJ201906006_099.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEZ1NGRMODlOanZuT1VLOEVOTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit"><b>图</b>5 Write 128KByte、Read 128KByte<b>命令仿真测试</b>  <a class="btn-zoomin" href="Detail/GetImg?filename=images/WXYJ201906006_099.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEZ1NGRMODlOanZuT1VLOEVOTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <h3 id="100" name="100" class="anchor-tag">5 <b>结束语</b></h3>
                <div class="p1">
                    <p id="101">当前市场下, SATA SSD已略显疲态, 随着市场存量的不断消解, 最终将被NVMe/PCIe产品所取代.在航天应用领域, FPGA以其丰富的逻辑资源与可靠性保证一直被作为主控系统的首选方案.因此, 结合FPGA的并行加速特性, 本文设计了基于FPGA的NVMe的主控端IP核, 集成度高、扩展性强、运用灵活方便, 特别适合需要大容量存储的嵌入式系统, 具有良好嵌入式应用前景.后续该IP核还可以进一步拓展应用于RAID阵列, 设计并实现更高性能的存储技术.</p>
                </div>

        <!--brief end-->
        
        <!--conten left  end-->
        <!--增强附件-->
        

        <!--reference start-->
            <div class="reference anchor-tag" id="a_bibliography">
                    <h3>参考文献</h3>
                                        <p id="3">
                            <a id="bibliography_1" >
                                    <b>[1]</b>
                                 董星.基于FPGA的存储控制器及相关系统设计技术研究[D].杭州:浙江大学, 2016.
                            </a>
                        </p>
                        <p id="5">
                            <a id="bibliography_2" >
                                    <b>[2]</b>
                                 NVMe标准组织.NVM_Express_Revision_1.3a[EB/OL]. (2017-10-24) [2018-08-24] http://www.nvmexpress.org/about/.
                            </a>
                        </p>
                        <p id="7">
                            <a id="bibliography_3" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CBBD&amp;filename=9787111599791000&amp;v=MTA0MzhLNUg5VEZwb2hNWmVzUERCTTh6eFVTbURkOVNIN24zeEU5ZmJ2bktyaWZadTl1RkNybFU3ck1KRm9SWEZxekdi&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEZ1NGRMODlOanZuT1VLOEVOTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[3]</b> SSD FANS.深入浅出SSD:固态存储核心技术、原理与实战[M].北京:机械工业出版社, 2018.
                            </a>
                        </p>
                        <p id="9">
                            <a id="bibliography_4" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CBBD&amp;filename=9787111298229001&amp;v=MjI1MDlyaWZadTl1RkNybFU3ck1KRm9SWEZxekdiSzVIOVBGcDQxSGJlc1BEUk04enhVU21EZDlTSDduM3hFOWZidm5L&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEZ1NGRMODlOanZuT1VLOEVOTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[4]</b> 王齐.PCIe体系结构导读[M].北京:机械工业出版社, 2010.
                            </a>
                        </p>
                        <p id="11">
                            <a id="bibliography_5" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=HKDZ201704007&amp;v=MjA5MjdlWmVWdUZ5M2hWN3ZOTFNiUGRMRzRIOWJNcTQ5Rlk0UUtESDg0dlI0VDZqNTRPM3pxcUJ0R0ZyQ1VSTE8=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEZ1NGRMODlOanZuT1VLOEVOTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[5]</b> 盘勇军, 黄伯铮.VxWorks6.8操作系统下的NVMe驱动设计[J].航空电子技术, 2017, 48 (4) :32-33.
                            </a>
                        </p>
                        <p id="13">
                            <a id="bibliography_6" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CMFD&amp;filename=1018172666.nh&amp;v=Mjk2MDM0dlI0VDZqNTRPM3pxcUJ0R0ZyQ1VSTE9lWmVWdUZ5M2hWN3ZOVkYyNkZySy9ITmZLcVpFYlBJUUtESDg=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEZ1NGRMODlOanZuT1VLOEVOTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[6]</b> 王磊.基于VPX的嵌入式高性能存储技术研究[D].杭州:浙江大学, 2018.
                            </a>
                        </p>
                        <p id="15">
                            <a id="bibliography_7" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=HLYZ201609041&amp;v=MTIzODBESDg0dlI0VDZqNTRPM3pxcUJ0R0ZyQ1VSTE9lWmVWdUZ5M2hWN3ZOTFNIU2RMRzRIOWZNcG85QlpZUUs=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEZ1NGRMODlOanZuT1VLOEVOTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[7]</b> 贾效玲, 张刚, 张博.SATA 硬盘控制器的 FPGA 实现[J].火力与指挥控制, 2016, 41 (9) :182.
                            </a>
                        </p>
            </div>
        <!--reference end-->
        <!--footnote start-->
        <!--footnote end-->



    </div>

        <input id="fileid" type="hidden" value="WXYJ201906006" />
        <input id="dpi" type="hidden" value="800" />
    </div>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?6e967eb120601ea41b9d312166416aa6";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
</script>

    


<input id="hid_uid" name="hid_uid" type="hidden" value="WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEZ1NGRMODlOanZuT1VLOEVOTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
<input id="hid_kLogin_headerUrl" name="hid_kLogin_headerUrl" type="hidden" value="/KLogin/Request/GetKHeader.ashx%3Fcallback%3D%3F" />
<input id="hid_kLogin_footerUrl" name="hid_kLogin_footerUrl" type="hidden" value="/KLogin/Request/GetKFooter.ashx%3Fcallback%3D%3F" />
<div class="btn-link" style="display: none"><a target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=WXYJ201906006&amp;v=MTA0MTA1NE8zenFxQnRHRnJDVVJMT2VaZVZ1RnkzaFY3dk5NalhTWkxHNEg5ak1xWTlGWW9RS0RIODR2UjRUNmo=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEZ1NGRMODlOanZuT1VLOEVOTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">知网节</a></div>
<div class="popflow" id="popupTips" style="display: none;">
    <div class="popflowArr"></div>
    <div class="popflowCot">
        <div class="hd"><a href="javascript:void(0);" onclick="$('#popupTips').hide();$('#popupmsg').html('')" class="close">X</a></div>
        <div class="bd">
            <p class="mes" id="popupmsg" name="popupmsg"></p>
          
        </div>
    </div>
</div>
<input type="hidden" id="myexport" value="//kns.cnki.net" />

<input type="hidden" id="KPCAPIPATH" value="//ishufang.cnki.net" />
<input type="hidden" id="CitedTimes" value="" />
<div class="link" id="GLSearch" style="display: none;">
    <i class="icon-trangle"></i>
    <div class="inner">
        <a class="icon" id="copytext">复制</a>
        <a class="icon" target="_blank" onclick="searchCRFD(this)">工具书搜索</a>
    </div>
</div>




<input id="hidVirtualPath" name="hidVirtualPath" type="hidden" value="/kxreader" />
<script src="/kxreader/bundles/detail?v=-ULdk-c6FkZHtJA2KAXPgHnyA8mtgyPnBde_C2VZ2BY1"></script>

<script src="/kxreader/Scripts/layer.min.js" type="text/javascript"></script>

<div id="footerBox" class="rootw footer">
</div>
<script>
    if (typeof FlushLogin == 'function') {
        FlushLogin();
    }
    modifyEcpHeader(true);
</script>

<!--图片放大功能 start-->
<script src="/kxreader/bundles/imagebox?v=W4phPu9SNkGcuPeJclikuVE3PpRyIW_gnfjm_19nynI1"></script>

<script type="text/javascript">
    $(function () {
        var j = $.noConflict();
        j(function () {
            j(".zoom-in,.btn-zoomin").imgbox({
                'alignment': 'center',
                'allowMultiple': false,
                'overlayShow': true
            });
        })
    });
</script>
<!--图片放大功能 end-->
<div class="fixedbar">
    <div class="backtop hiddenV" id="backtop">
        <a id="backTopSide" href="javascript:scroll(0,0);" title=""></a>
    </div>
</div>
<script type="text/javascript" src="/kxreader/Scripts/MathJax-2.6-latest/MathJax.js?config=MML_HTMLorMML-full"></script>

</body>
</html>
