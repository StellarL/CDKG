<!DOCTYPE html>
<html>
<head>
    <title>全文阅读--XML全文阅读--中国知网</title>
    <link rel="icon" href="/kxreader/favicon.ico" />
    <link rel="shortcut Icon" href="/kxreader/favicon.ico" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="keywords" content="文献 XML KBASE CNKI 中国知网" />
    <meta name="description" content="XML文献检索" />
    <link href="/kxreader/Content/css/detail?v=qX2z2KjRAEyQiNfAbKtl7dLnsqFoQ5Jdw3TZfDf0n1k1" rel="stylesheet"/>

    <script type="text/javascript">
        var APPPATH = '/kxreader';
    </script>
</head>

<body>
    
<script type="text/javascript" src="//login.cnki.net/TopLogin/api/loginapi/get?type=top&amp;localCSS=&amp;returnurl=%2f%2fkns.cnki.net%2f%2fKXReader%2fDetail%3fTIMESTAMP%3d637134042270568750%26DBCODE%3dCJFD%26TABLEName%3dCJFDLAST2019%26FileName%3dWXYJ201903002%26RESULT%3d1%26SIGN%3dD%252bH%252fLNrwMdLMqUBqd9k9mA6mDD4%253d"></script>

<div id="headerBox" class="header">
    <div class="topbar">
        <div class="textalign">
            <a href="/kxreader/Detail?dbcode=CJFD&amp;filename=WXYJ201903002&amp;align=md">
                <i class="icon-cen active" title="居中对齐"></i>
            </a>
            <a href="/kxreader/Detail?dbcode=CJFD&amp;filename=WXYJ201903002&amp;align=lt">
                <i class="icon-left " title="左对齐"></i>
            </a>
        </div>
        <h6 class="free-tip"><i class="icon"></i>HTML阅读开放试用阶段，欢迎体验！</h6>
    </div>
</div>

    



<div class="btn-link" style="display: none"><a target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=WXYJ201903002&amp;v=Mjc1ODFyQ1VSTE9lWmVWdUZ5emhVcnpQTWpYU1pMRzRIOWpNckk5RlpvUUtESDg0dlI0VDZqNTRPM3pxcUJ0R0Y=&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVC9ralV1aXF1RUpsdE95VG55NWhBaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">知网节</a></div>

    <div class="main">

        

    <div class="sidebar-a">
        <!--sidebar start-->
        <div class="sidenav">
            <div class="arrow"><span></span></div>
            <!--sidebar_list start-->
            <dl class="sidenav-list">
                    <dt class="tit">目录结构</dt>
                            <dd class="guide">
                                    <p><a href="#12" data-title="1 &lt;b&gt;引言&lt;/b&gt; ">1 <b>引言</b></a><i></i></p>
                                                            </dd>
                            <dd class="guide">
                                    <p><a href="#15" data-title="2 FC&lt;b&gt;协议的&lt;/b&gt;PCS&lt;b&gt;层&lt;/b&gt; ">2 FC<b>协议的</b>PCS<b>层</b></a><i></i></p>
                                                                    <ul class="contentbox">
                                                <li><a href="#16" data-title="2.1 FC&lt;b&gt;协议分层&lt;/b&gt;">2.1 FC<b>协议分层</b></a></li>
                                                <li><a href="#25" data-title="2.2 PCS&lt;b&gt;层内部结构&lt;/b&gt;">2.2 PCS<b>层内部结构</b></a></li>
                                    </ul>
                            </dd>
                            <dd class="guide">
                                    <p><a href="#28" data-title="3 &lt;b&gt;设计实现&lt;/b&gt; ">3 <b>设计实现</b></a><i></i></p>
                                                                    <ul class="contentbox">
                                                <li><a href="#30" data-title="3.1 &lt;b&gt;弹性缓冲器&lt;/b&gt;">3.1 <b>弹性缓冲器</b></a></li>
                                                <li><a href="#35" data-title="3.2 8B/10B&lt;b&gt;编解码器&lt;/b&gt;">3.2 8B/10B<b>编解码器</b></a></li>
                                                <li><a href="#39" data-title="3.3 &lt;b&gt;位宽变换器&lt;/b&gt;">3.3 <b>位宽变换器</b></a></li>
                                                <li><a href="#45" data-title="3.4 &lt;b&gt;数据同步器&lt;/b&gt;">3.4 <b>数据同步器</b></a></li>
                                    </ul>
                            </dd>
                            <dd class="guide">
                                    <p><a href="#49" data-title="4 &lt;b&gt;仿真验证&lt;/b&gt; ">4 <b>仿真验证</b></a><i></i></p>
                                                                    <ul class="contentbox">
                                                <li><a href="#51" data-title="4.1 &lt;b&gt;功能仿真&lt;/b&gt;">4.1 <b>功能仿真</b></a></li>
                                                <li><a href="#54" data-title="4.2 &lt;b&gt;协议分析仪验证&lt;/b&gt;">4.2 <b>协议分析仪验证</b></a></li>
                                    </ul>
                            </dd>
                            <dd class="guide">
                                    <p><a href="#57" data-title="5 &lt;b&gt;结束语&lt;/b&gt; ">5 <b>结束语</b></a><i></i></p>
                                                            </dd>
                            <dd class="guide">
                                    <p><a href="#" data-title="文内图表 ">文内图表</a><i></i></p>
                                                                    <ul class="contentbox">
                                                <li><a href="#18" data-title="&lt;b&gt;图&lt;/b&gt;1 FC&lt;b&gt;协议层次结构图&lt;/b&gt;"><b>图</b>1 FC<b>协议层次结构图</b></a></li>
                                                <li><a href="#27" data-title="&lt;b&gt;图&lt;/b&gt;2 FC-PCS&lt;b&gt;层内部结构图&lt;/b&gt;"><b>图</b>2 FC-PCS<b>层内部结构图</b></a></li>
                                                <li><a href="#33" data-title="&lt;b&gt;图&lt;/b&gt;3 TX&lt;b&gt;弹性缓冲器结构图&lt;/b&gt;"><b>图</b>3 TX<b>弹性缓冲器结构图</b></a></li>
                                                <li><a href="#42" data-title="&lt;b&gt;图&lt;/b&gt;4 TX&lt;b&gt;位宽转换示意图&lt;/b&gt;"><b>图</b>4 TX<b>位宽转换示意图</b></a></li>
                                                <li><a href="#44" data-title="&lt;b&gt;图&lt;/b&gt;5 RX&lt;b&gt;位宽转换示意图&lt;/b&gt;"><b>图</b>5 RX<b>位宽转换示意图</b></a></li>
                                                <li><a href="#48" data-title="&lt;b&gt;图&lt;/b&gt;6 &lt;b&gt;同步对齐示意图&lt;/b&gt;"><b>图</b>6 <b>同步对齐示意图</b></a></li>
                                                <li><a href="#53" data-title="&lt;b&gt;图&lt;/b&gt;7 &lt;b&gt;功能仿真结果图&lt;/b&gt;"><b>图</b>7 <b>功能仿真结果图</b></a></li>
                                    </ul>
                            </dd>
                                    <dd class="guide">
                                        <h6>
                                            <p><a href="#a_bibliography">参考文献</a> </p>
                                        </h6>
                                    </dd>

            </dl>
        </div>
        <!--sidebar end-->
        &nbsp;
        <!--此处有一空格符 勿删-->
    </div>

                <div class="sidebar-b three-collumn" style="width:0;">
            <div class="refer" style="width: 0;">
                <div class="arrow off" title="参考文献"><span></span></div>
                <div class="js-scrollbox" >
                    
                    <div class="subbox active">
                        <h4>
                            <span class="tit">参考文献</span>
                            <a class="close" href="javascript:void(0)">x</a>
                        </h4>
                        <div class="side-scroller">
                            <ul class="refer-list">
                                <li id="2">


                                    <a id="bibliography_1" title=" 林强, 熊华钢, 张其善. 光纤通道综述[J]. 计算机应用研究, 2006, 23 (2) :9-13." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JSYJ200602002&amp;v=MDEyODlqNTRPM3pxcUJ0R0ZyQ1VSTE9lWmVWdUZ5emhVcnpPTHo3U1pMRzRIdGZNclk5RlpvUUtESDg0dlI0VDY=&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVC9ralV1aXF1RUpsdE95VG55NWhBaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[1]</b>
                                         林强, 熊华钢, 张其善. 光纤通道综述[J]. 计算机应用研究, 2006, 23 (2) :9-13.
                                    </a>
                                </li>
                                <li id="4">


                                    <a id="bibliography_2" title=" 杜玲, 廖小海.FC-AE-1553总线在箭载测量系统中应用研究[J].遥测遥控, 2015, 39 (5) :33-43." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=YCYK201505011&amp;v=MTg3MTR6aFVyek9QQzdTWmJHNEg5VE1xbzlFWllRS0RIODR2UjRUNmo1NE8zenFxQnRHRnJDVVJMT2VaZVZ1Rnk=&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVC9ralV1aXF1RUpsdE95VG55NWhBaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[2]</b>
                                         杜玲, 廖小海.FC-AE-1553总线在箭载测量系统中应用研究[J].遥测遥控, 2015, 39 (5) :33-43.
                                    </a>
                                </li>
                                <li id="6">


                                    <a id="bibliography_3" title=" KIM Y W, KANG J K. An 8B/10B encoder with a modified coding table[C]//Circuits and Systems, 2008. APCCAS 2008. IEEE Asia Pacific Conference. Macao, China, 2008:1522-1525." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=An8B/10B encoder with a modified coding table">
                                        <b>[3]</b>
                                         KIM Y W, KANG J K. An 8B/10B encoder with a modified coding table[C]//Circuits and Systems, 2008. APCCAS 2008. IEEE Asia Pacific Conference. Macao, China, 2008:1522-1525.
                                    </a>
                                </li>
                                <li id="8">


                                    <a id="bibliography_4" title=" SUN G C, YU D S. Design of dual-gigabit tran- sceiver for fibre channel FC-1 layer[C]//Electron Devices and Solid-State Circuits, EDSSC 2008. IEEE International Conference, China, Hongkong, 2008:1-4." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Design of dual-gigabit tran- sceiver for fibre channel FC-1 layer">
                                        <b>[4]</b>
                                         SUN G C, YU D S. Design of dual-gigabit tran- sceiver for fibre channel FC-1 layer[C]//Electron Devices and Solid-State Circuits, EDSSC 2008. IEEE International Conference, China, Hongkong, 2008:1-4.
                                    </a>
                                </li>
                                <li id="10">


                                    <a id="bibliography_5" title=" VERILOG E, CUMMINGS C E. Simulation and synthesis techniques for asynchronous FIFO design[J]. Snug, 2002, Section TB2 (3) :1-18." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Simulation and synthesis techniques for asynchronous FIFO design">
                                        <b>[5]</b>
                                         VERILOG E, CUMMINGS C E. Simulation and synthesis techniques for asynchronous FIFO design[J]. Snug, 2002, Section TB2 (3) :1-18.
                                    </a>
                                </li>
                            </ul>
                            <div style='display: none;' class="zqscroller" >
                                <h4 class="">附加材料</h4>
                                <ul></ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            &nbsp;
            <!--此处有一空格符 勿删-->
        </div>

        
    <div class="content">



        <!--tips start-->
                            <div class="tips">
                    <a href="http://navi.cnki.net/KNavi/JournalDetail?pcode=CJFD&amp;pykm=WXYJ" target="_blank">微电子学与计算机</a>
                2019,36(03),7-11             </div>
        <!--tips end-->
            <div class="top-title">
                <h1 class="title">
                    <span class="vm"><b>基于FC协议的PCS层设计和协议分析仪验证</b></span>
                                    </h1>

            </div>
                        <h2>
                                <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=au&amp;skey=%E6%9D%A8%E9%92%9E%E7%BF%94&amp;code=36535378&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVC9ralV1aXF1RUpsdE95VG55NWhBaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">杨钞翔</a>
                                <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=au&amp;skey=%E5%AD%94%E5%AE%AA%E4%BC%9F&amp;code=41141511&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVC9ralV1aXF1RUpsdE95VG55NWhBaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">孔宪伟</a>
                                <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=au&amp;skey=%E6%A0%BE%E6%96%87%E7%84%95&amp;code=38815679&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVC9ralV1aXF1RUpsdE95VG55NWhBaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">栾文焕</a>
                                <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=au&amp;skey=%E5%BC%A0%E8%BF%9C%E8%88%AA&amp;code=36991541&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVC9ralV1aXF1RUpsdE95VG55NWhBaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">张远航</a>
                                <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=au&amp;skey=%E7%8E%8B%E5%BF%97%E5%86%9B&amp;code=08181915&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVC9ralV1aXF1RUpsdE95VG55NWhBaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">王志军</a>
                                <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=au&amp;skey=%E5%BC%A0%E6%98%A5&amp;code=08185384&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVC9ralV1aXF1RUpsdE95VG55NWhBaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">张春</a>
                                <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=au&amp;skey=%E7%8E%8B%E8%87%AA%E5%BC%BA&amp;code=08833287&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVC9ralV1aXF1RUpsdE95VG55NWhBaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">王自强</a>
                </h2>
                    <h2>
                    <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=in&amp;skey=%E6%B8%85%E5%8D%8E%E5%A4%A7%E5%AD%A6%E5%BE%AE%E7%94%B5%E5%AD%90%E5%AD%A6%E7%A0%94%E7%A9%B6%E6%89%80&amp;code=0187103&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVC9ralV1aXF1RUpsdE95VG55NWhBaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">清华大学微电子学研究所</a>
                    <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=in&amp;skey=%E4%B8%AD%E5%9B%BD%E7%94%B5%E5%AD%90%E6%8A%80%E6%9C%AF%E6%A0%87%E5%87%86%E5%8C%96%E7%A0%94%E7%A9%B6%E9%99%A2%E9%9B%86%E6%88%90%E7%94%B5%E8%B7%AF%E6%B5%8B%E8%AF%95%E4%B8%8E%E8%AF%84%E4%BB%B7%E5%B7%A5%E4%B8%9A%E5%92%8C%E4%BF%A1%E6%81%AF%E5%8C%96%E9%83%A8%E9%87%8D%E7%82%B9%E5%AE%9E%E9%AA%8C%E5%AE%A4&amp;code=1698690&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVC9ralV1aXF1RUpsdE95VG55NWhBaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">中国电子技术标准化研究院集成电路测试与评价工业和信息化部重点实验室</a>
            </h2>

        
<div class="link">
    <a id="aexport" class="icon icon-output"  onclick="" href="javascript:void(0);"><i></i>导出/参考文献</a>
    
    <span class="shareBoard" onmouseover="$('#sharedet').show();$('#this').addClass('shareBoardCUR')" onmouseout="$('#sharedet').hide();$('#this').removeClass('shareBoardCUR')">
        <a class="icon icon-share" href="#"><i></i>分享<em></em></a>
        <ul class="shareHide" id="sharedet" style="display: none;">
            <li><a title="复制链接" class="copy" onclick="" href="#"><i></i>复制链接</a></li>
            <li><a title="分享到新浪微博" class="xl" onclick="" href="javascript:common.ShareAction('xl');"><i></i>新浪微博</a></li>
            <li>
                <a title="分享到微信" class="wx" onclick="" href="#"><i></i>微信扫一扫</a>
                <div class="qrcode"><img src='' alt='' /></div>
            </li>
        </ul>

    </span>
    
    <a id="RefTrack" title="创建引文跟踪" class="icon icon-track" onclick="" href="javascript:void(0);"> <i></i>创建引文跟踪 </a>
    <a id="ashoucang" title="收藏" class="icon icon-favor" onclick="" href="javascript:void(0);"><i></i>收藏</a>
    <a class="icon icon-print" onclick="window.print();" href="javascript:void(0);"><i></i>打印</a>
    
    <!--版本切换 end-->
</div>
                            <div class="data" id="a_abstract">
                <span class="keys">摘<span style="font-family: 'Times New Roman';">&nbsp;&nbsp;&nbsp;&nbsp;</span>要：</span>
                <p>FC光纤通道协议作为新一代重要总线技术, 具有带宽高、扩展性强、可靠性强、实时性强、支持多种媒介、抗电磁干扰等优良特点, 发展迅速并在诸多领域得到了广泛应用.本文针对FC协议的PCS层进行深入研究, 解析其关键模块:弹性缓冲器、8B/10B编解码器、位宽变换器、同步器等, 提出整体设计架构, 使用verilog语言完成代码设计, 搭建回环验证平台, 并采用FC专用协议分析仪, 结合FPGA进行验证, 完成设计.</p>
            </div>
                    <div class="data" id="a_keywords">
                <span class="keys">关键词：</span>
                <p>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=FC%E5%8D%8F%E8%AE%AE&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVC9ralV1aXF1RUpsdE95VG55NWhBaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">FC协议;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=PCS%E5%B1%82&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVC9ralV1aXF1RUpsdE95VG55NWhBaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">PCS层;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=%E5%8D%8F%E8%AE%AE%E5%88%86%E6%9E%90%E4%BB%AA&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVC9ralV1aXF1RUpsdE95VG55NWhBaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">协议分析仪;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=FPGA%E9%AA%8C%E8%AF%81&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVC9ralV1aXF1RUpsdE95VG55NWhBaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">FPGA验证;</a>
                </p>
            </div>
        
        <!--brief start-->
        
            <div class="brief">
                    <p>
                            <b>作者简介：</b>
                                                        <span>
                                    杨钞翔, 男, (1991-) , 硕士研究生.研究方向为集成电路设计.E-mail:1159580239@qq.com.;
                                </span>
                                <span>
                                    孔宪伟, 男, (1986-) , 硕士, 工程师.研究方向集成电路测试.;
                                </span>
                                <span>
                                    栾文焕, 女, (1994-) , 硕士研究生.研究方向为集成电路设计.;
                                </span>
                                <span>
                                    张远航, 女, (1994-) , 硕士研究生.研究方向为集成电路设计.;
                                </span>
                                <span>
                                    王志军, 男, (1982-) , 硕士, 工程师.研究方向为数字集成电路设计.;
                                </span>
                                <span>
                                    张春, 男, (1972-) , 博士, 副研究员.研究方向为数模混合信号集成电路设计、嵌入式微处理器设计.;
                                </span>
                                <span>
                                    王自强, 男, (1975-) , 博士, 副研究员.研究方向为模拟集成电路设计.;
                                </span>
                    </p>
                                    <p><b>收稿日期：</b>2018-07-04</p>

                    <p>

                            <b>基金：</b>
                                                        <span>国家科技重大专项 (2016ZX01012101);</span>
                    </p>
            </div>
                    <h1>Design and protocol analyzer verification of the physical coding sublayer based on the FC protocol</h1>
                    <h2>
                    <span>YANG Chao-xiang</span>
                    <span>KONG Xian-wei</span>
                    <span>LUAN Wen-huan</span>
                    <span>ZHANG Yuan-hang</span>
                    <span>WANG Zhi-jun</span>
                    <span>ZHANG Chun</span>
                    <span>WANG Zi-qiang</span>
            </h2>
                    <h2>
                    <span>Institute of Microelectronics, Tsinghua University</span>
                    <span>Key Laboratory of Integrated Circuits Testing and Evaluation, Ministry of Industry and Information Technology</span>
            </h2>
                            <div class="data" id="a_abstractEN">
                <span class="keys">Abstract：</span>
                <p>As an important new generation of bus technology, the Fibre Channel protocol has the excellent features of high bandwidth, strong scalability, high reliability, real-time performance, supporting for multiple media, and immunity to electromagnetic interference. It has developed rapidly and has been widely used in many fields. This article carries on the thorough research to the PCS layer of the FC protocol, and analyzes its key modules: elastic buffer, 8 B/10 B codec, bit-width converter, synchronizer, etc. And it proposes an overall design architecture, uses verilog language to complete code design, builds a loopback verification platform, and uses the FC protocol analyzer, combined with FPGA verification to complete the design.</p>
            </div>
                    <div class="data" id="a_keywordsEN">
                <span class="keys">Keyword：</span>
                <p>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=FC%20protocol&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVC9ralV1aXF1RUpsdE95VG55NWhBaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">FC protocol;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=protocol%20analyzer&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVC9ralV1aXF1RUpsdE95VG55NWhBaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">protocol analyzer;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=design&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVC9ralV1aXF1RUpsdE95VG55NWhBaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">design;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=FPGA%20verification&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVC9ralV1aXF1RUpsdE95VG55NWhBaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">FPGA verification;</a>
                </p>
            </div>
                    <div class="brief">
                
                    <p>
                                            </p>
                                    <p><b>Received：</b> 2018-07-04</p>
                                    <p>
                                            </p>
            </div>


        <!--brief start-->
                        <h3 id="12" name="12" class="anchor-tag">1 <b>引言</b></h3>
                <div class="p1">
                    <p id="13">FC (Fibre Channel) 协议通常被称为光纤通道协议, 最早由美国国家标准委员会于1988年成立专门小组开始制定, 作为一种非常重要的高速串行传输协议, 核心目的是适应迅速发展的高速传输需求.作为新一代总线技术, 光纤通道协议使得在同一物理接口上运行网络协议和通道标准成为可能, 并且能在各个网络层次上可以提供多种选项, 包括多种层次、多种优先级控制、多种服务类型、多种拓扑结构、多种上层协议以及多种协议映射等, 因此用户可以根据实际需要进行合理选择和设计, 利于形成符合系统实际要求的专门的网络解决方案<citation id="59" type="reference"><link href="2" rel="bibliography" /><sup>[<a class="sup">1</a>]</sup></citation>.</p>
                </div>
                <div class="p1">
                    <p id="14">FC光纤通道协议具有带宽高、扩展性强、可靠性强、实时性强、支持多种媒介、抗电磁干扰等优良特点, 传输速率高且传输稳定, 和传统的电总线相比, 光纤总线在各方面性能上都有着显著提高, 到如今已经发展成为航空电子系统的主要候选协议之一, 例如在美国F3B35战斗机中, FC协议就已经得到了非常成功的应用.除此之外, 在导弹、船舰、坦克、装甲车等方面FC光纤通道协议也得到非常广泛的应用.目前, 其具体应用已经涉及到传感、测试、自动化、航空、航海等诸多领域, 发展迅速并受到重视案<citation id="60" type="reference"><link href="4" rel="bibliography" /><sup>[<a class="sup">2</a>]</sup></citation>.</p>
                </div>
                <h3 id="15" name="15" class="anchor-tag">2 FC<b>协议的</b>PCS<b>层</b></h3>
                <h4 class="anchor-tag" id="16" name="16">2.1 FC<b>协议分层</b></h4>
                <div class="p1">
                    <p id="17">FC光纤通道协议包含多层, 如图1所示, 从底向上可以分为5个层次:FC-0层～FC-4层, 5个层次之间各自独立但又互相配合, 如此才能正确地实现高速数据的串行传输.</p>
                </div>
                <div class="area_img" id="18">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/WXYJ201903002_018.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVC9ralV1aXF1RUpsdE95VG55NWhBaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图1 FC协议层次结构图" src="Detail/GetImg?filename=images/WXYJ201903002_018.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVC9ralV1aXF1RUpsdE95VG55NWhBaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit"><b>图</b>1 FC<b>协议层次结构图</b>  <a class="btn-zoomin" href="Detail/GetImg?filename=images/WXYJ201903002_018.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVC9ralV1aXF1RUpsdE95VG55NWhBaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="p1">
                    <p id="19">FC-0层:物理层, 定义了通道点到点的物理连接, 由传播介质、发送器和接收器组成.该层设计灵活性较强, 两个<i>N</i>端口之间可以使用不同技术链路, 同时支持多模和单模光缆链接.</p>
                </div>
                <div class="p1">
                    <p id="20">FC-1层:编码层, 该层采用8B/10B编解码, 包含两类字符, 数据字符<i>D</i>码和专用字符<i>K</i>码.<i>D</i>码表示纯数据, <i>K</i>码表示控制字符, 如帧头、帧尾、IDLE空闲状态等.<i>D</i>码有256种, <i>K</i>码有12种, 一共268种统一起来构成8B/10B编解码体系的所有字符.该层核心目的是限制数据的最大长度, 避免长连1和长连0的情况, 编码后的数据流中0和1的个数平衡, 保证了信号传输过程中具有较高的变换频率, 降低了直流分量, 有利于数据的时钟恢复, 实现DC平衡案<citation id="61" type="reference"><link href="6" rel="bibliography" /><link href="8" rel="bibliography" /><sup>[<a class="sup">3</a>,<a class="sup">4</a>]</sup></citation>.</p>
                </div>
                <div class="p1">
                    <p id="21">FC-2层:协议层, 规定数据块传输机制, 包括序列状态块、交换状态块、通用交换网等模型.此外还介绍了分段、重传、服务类型、应答机制以及数据帧格式等.</p>
                </div>
                <div class="p1">
                    <p id="22">FC-3层:通用服务层, 包括多条传送、搜索组和多点传送等, 提供了FC节点上多个<i>N</i>端口的通用服务, 常用的有名称服务和时间服务, 利于设备进行良好的同步.</p>
                </div>
                <div class="p1">
                    <p id="23">FC-4层:映射层, 光纤通道协议最高的层次, 负责完成上层协议到光纤通道的映射, 定义了上层协议如何在光纤通道上运行.</p>
                </div>
                <div class="p1">
                    <p id="24">其中, PCS层称为物理编码子层, 对应于FC光纤通道协议的FC-1层.</p>
                </div>
                <h4 class="anchor-tag" id="25" name="25">2.2 PCS<b>层内部结构</b></h4>
                <div class="p1">
                    <p id="26">本文主要探究FC协议的PCS层, 对应于FC-1编码层, 内部数据路径可分为TX发送通路和RX接收通路, 如图2所示.PCS和MAC子层接口位宽为64位, PCS和PMA子层接口位宽为32位.发送通路包含TX弹性缓冲器、8B/10B编码器、TX变速箱等模块, 接收通路包含RX变速箱、RX数据同步模块、8B/10B解码器、RX弹性缓冲器等.此外, 还增设了PCS远端回环模块、PMA远端回环模块、PCS近端回环模块, 可供实现各种回环测试和验证.下面将对发送通路和接收通路包含的各个关键模块进行设计实现.</p>
                </div>
                <div class="area_img" id="27">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/WXYJ201903002_027.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVC9ralV1aXF1RUpsdE95VG55NWhBaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图2 FC-PCS层内部结构图" src="Detail/GetImg?filename=images/WXYJ201903002_027.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVC9ralV1aXF1RUpsdE95VG55NWhBaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit"><b>图</b>2 FC-PCS<b>层内部结构图</b>  <a class="btn-zoomin" href="Detail/GetImg?filename=images/WXYJ201903002_027.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVC9ralV1aXF1RUpsdE95VG55NWhBaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <h3 id="28" name="28" class="anchor-tag">3 <b>设计实现</b></h3>
                <div class="p1">
                    <p id="29">PCS层发送和接收两条通路互逆, 如图2所示, TX_Elastic_Buffer和RX_Elastic_Buffer分别为发送和接收通路上互逆的弹性缓冲器, 8B/10B Encoder和8B/10B Decoder分别为发送和接收通路上互逆的编码器和解码器, TX_Gearbox和RX_Gearbox分别为发送和接收通路上互逆的位宽变化器, RX_Data_Sync为接收通路上的数据同步器.</p>
                </div>
                <h4 class="anchor-tag" id="30" name="30">3.1 <b>弹性缓冲器</b></h4>
                <div class="p1">
                    <p id="31">PCS子层内部由两个时钟域控制, 分别为MAC层提供的XGMII_CLK和PMA层提供的PMA_CLK, 因此数据进行交换时需要进行跨时钟域操作, 通常的做法是采用异步缓冲器来实现.但是在高速串行传输过程中, 数据率高达8.5 Gbps, 假如采用传统的缓冲器, 即使两个时钟频差很小, 随着时间的积累缓冲器很快便会溢出或者读空, 因而发生严重的传输错误.本文在传统的异步缓冲器基础上进行改进, 结合协议自身特点, 通过检测缓冲器两端读写速率的变化情况, 合适地插入或者删除IDLE字符的方式, 设计出一款具有弹性的缓冲器, 能够对缓冲器两边进行频差弥补, 维持缓冲器一直处于半满最优状态, 并成功地实现了数据的跨时钟域操作.</p>
                </div>
                <div class="p1">
                    <p id="32">发送和接收通路的弹性缓冲器分别对应于图2的TX_Elastic_Buffer和RX_Elastic_Buffer模块, 具体深度设计为16, 位宽为88位, 包含64 bit纯数据、24 bit控制信号.此外, 还单独设有overflow和underflow信号指示缓冲器的溢出/读空情况.以TX弹性缓冲器为例, 实现结构如图3所示, 主要包含:双口存储器、读/写地址产生逻辑、二进制码转格雷码模块、跨时钟域模块、格雷码转二进制码模块、读写地址差值计算器<citation id="62" type="reference"><link href="10" rel="bibliography" /><sup>[<a class="sup">5</a>]</sup></citation>.写数据和读数据都为88 bit, 由64 bit纯数据和3个8 bit控制码链接而成.双口存储器采用“两写一读”的形式, 包含两个写地址<i>w</i><sub>1</sub>/<i>w</i><sub>2</sub>和一个读地址<i>r</i><sub>1</sub>.写入端由上层MAC提供的gttx_clk时钟控制, 读出端由下层PMA提供的pma_txclk时钟控制.读地址<i>r</i><sub>1</sub>先进行二进制码转格雷码的变换, 再从pma_txclk时钟域跨到gttx_clk时钟域, 再将格雷码转换回二进制码, 同写地址进行差值计算.检测差值判断读写速率偏差, 读速率固定不变, 当写速率和读速率匹配适当时, 不进行任何操作;当写速率快于读速率时, 写入端通过删除数据中IDLE字符的方式, 降低写速率;当写速率慢于读速率时, 写入端往数据中插入IDLE字符, 增加写入速率.当读写地址指针差值达到0或者16时, 指示信号tx_overflow或者tx_underflow置1, 表示溢出或者读空, 并进行系统复位.以此调节读写速率, 使弹性缓冲器维持在半满最优状态, 实现读写平衡, 弥补频率偏差.</p>
                </div>
                <div class="area_img" id="33">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/WXYJ201903002_033.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVC9ralV1aXF1RUpsdE95VG55NWhBaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图3 TX弹性缓冲器结构图" src="Detail/GetImg?filename=images/WXYJ201903002_033.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVC9ralV1aXF1RUpsdE95VG55NWhBaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit"><b>图</b>3 TX<b>弹性缓冲器结构图</b>  <a class="btn-zoomin" href="Detail/GetImg?filename=images/WXYJ201903002_033.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVC9ralV1aXF1RUpsdE95VG55NWhBaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="p1">
                    <p id="34">对于RX弹性缓冲器, 设计原理同TX弹性缓冲器相似, 深度仍为16, 位宽仍为88 bit, 但是双口存储器改用“一写两读”的方式, 溢出和指示信号分别为rx_overflow或者rx_underflow.</p>
                </div>
                <h4 class="anchor-tag" id="35" name="35">3.2 8B/10B<b>编解码器</b></h4>
                <div class="p1">
                    <p id="36">FC协议的PCS层采用8B/10B编解码方式, 因为传输数据为64 bit, 所以需要拆分为8次编解码.这种方式有效避免了长连0/1的现象, 最多不超过5位, 也可保证0和1的个数平衡, 数据中0和1的个数差值不超过2, 可以降低信息中的直流分量, 保证电平转换足够密集, 使得数据在高频传输中具有较好的时钟恢复效果.8B/10B编码过程中, 信号可以分为两类字符, 数据字符集<i>D</i>码和专用字符集<i>K</i>码, 分别用<i>Dx</i>.<i>y</i>和<i>Kx</i>.<i>y</i>表示.<i>Dx</i>.<i>y</i>字符集有256个单元, 其中<i>x</i>取0～31, <i>y</i>取0～7;<i>Kx</i>.<i>y</i>字符集有12个单元, 用于控制, 例如表示帧头、帧尾以及IDLE空闲状态等.<i>D</i>码和<i>K</i>码一共有268种, 共同构成8B/10B编解码系统的所有字符.8B/10B编码过程中涉及到两个重要概念:不均等性 (disparity) 和极性偏差 (running disparity) .</p>
                </div>
                <div class="p1">
                    <p id="37">不均等性表示‘1’和‘0’的个数偏差, 极性偏差简称RD, 表示‘1’和‘0’数量的比较.这里主要用到的是极性偏差RD. (1) RD取正:当1的个数比0多时, 或者4B码为1100时, 或者6B码为111000时. (2) RD取负:当0的个数比1多时, 或者4B码为0011时, 或者6B码为000111时. (3) 除以上两类情况, 其他码组定义为中性码, RD取其上一拍码组的RD值.</p>
                </div>
                <div class="p1">
                    <p id="38">8B/10B编码不直接使用8 bit到10 bit的查找表方式, 此方法效率低、开销大, 当8 bit数据为D码时, 先将数据拆分为低5B和高3B, 结合RD值分别进行5B/6B和3B/4B编码, 最后合并数据得到10B编码输出.当8 bit数据为<i>K</i>码时, 由于<i>K</i>码数目较少只有12种, 所以直接采用查找表法进行实现.</p>
                </div>
                <h4 class="anchor-tag" id="39" name="39">3.3 <b>位宽变换器</b></h4>
                <div class="p1">
                    <p id="40">位宽变换器如图2中的两个Gearbox变速箱所示, 因为8B/10B编解码器处理的数据为80 bit, 但是PCS层与PMA层之间数据接口为32 bit, 所以需要使用位宽变换器进行位宽转换, 实现80 bit和32 bit数据之间的相互变换.</p>
                </div>
                <div class="p1">
                    <p id="41">TX变速箱, 目的是将8B/10B编码传来的80 bit数据进行位宽变换, 以32 bit位宽的数据和PMA层进行传输.首先根据最小公倍数法则, 80b×2=32b×5=160b, 结合分数分频法, 可以得到:两组80 bit的数据输入并缓存, 分5次进行32 bit的输出, 一个完整的操作周期正好就能操作160 bit数据, 以此实现80 bit到32 bit的位宽变换.具体操作如图4所示, <i>F</i><sub>rd</sub>为32 bit数据读出频率, <i>F</i><sub>wr</sub>为80 bit数据写入频率, <i>F</i><sub>wr</sub>实际为<i>F</i>rd的2/5分频, <i>F</i><sub>wr</sub>和<i>F</i>rd都为高有效, 即:当<i>F</i><sub>wr</sub>为1时, 80 bit数据写入, 否则保持;当<i>F</i><sub>rd</sub>为1时, 32 bit数据读出, 否则保持.一个完整周期包含2组80 bit数据写入, 5组32 bit数据读出, 正好处理160 bit数据, 以此实现80 bit到32 bit的位宽转换.</p>
                </div>
                <div class="area_img" id="42">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/WXYJ201903002_042.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVC9ralV1aXF1RUpsdE95VG55NWhBaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图4 TX位宽转换示意图" src="Detail/GetImg?filename=images/WXYJ201903002_042.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVC9ralV1aXF1RUpsdE95VG55NWhBaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit"><b>图</b>4 TX<b>位宽转换示意图</b>  <a class="btn-zoomin" href="Detail/GetImg?filename=images/WXYJ201903002_042.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVC9ralV1aXF1RUpsdE95VG55NWhBaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="p1">
                    <p id="43">RX变速箱, 目的是将PMA层传来的32 bit数据进行位宽转换, 变成80 bit数据传输给PCS层, 为TX变速箱的逆操作, 两者实现原理类似, 也根据最小公倍数法则, 32b×5=80b×2=160b, 结合分数分频方法, 5组32 bit的数据输入并缓存, 分2次进行80 bit的输出, 一个完整的操作周期正好就能处理160 bit数据, 完成32 bit到80 bit的位宽转换.具体操作如图5所示, <i>F</i><sub>rd</sub>为80 bit数据读出频率, <i>F</i><sub>wr</sub>为32 bit数据写入频率, <i>F</i><sub>rd</sub>实际为<i>F</i><sub>wr</sub>的2/5分频, <i>F</i><sub>wr</sub>和<i>F</i><sub>rd</sub>都为高有效, 即:当<i>F</i><sub>wr</sub>为1时, 32 bit数据写入, 否则保持;当<i>F</i><sub>rd</sub>为1时, 80 bit数据读出, 否则保持.一个完整周期包含5组32 bit数据写入, 2组80 bit数据读出, 正好处理160 bit数据, 以此实现32 bit到80 bit的位宽转换.</p>
                </div>
                <div class="area_img" id="44">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/WXYJ201903002_044.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVC9ralV1aXF1RUpsdE95VG55NWhBaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图5 RX位宽转换示意图" src="Detail/GetImg?filename=images/WXYJ201903002_044.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVC9ralV1aXF1RUpsdE95VG55NWhBaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit"><b>图</b>5 RX<b>位宽转换示意图</b>  <a class="btn-zoomin" href="Detail/GetImg?filename=images/WXYJ201903002_044.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVC9ralV1aXF1RUpsdE95VG55NWhBaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <h4 class="anchor-tag" id="45" name="45">3.4 <b>数据同步器</b></h4>
                <div class="p1">
                    <p id="46">RX通路比TX通路多一个模块, 即图2中的RX_Data_Sync数据同步器, 同步器的核心目的是将上一级RX_Gearbox传来的数据进行同步对齐操作.具体方法是解析出数据中的<i>K</i>码, 并将其对齐在字符边界上, 如果检测状态为未对齐, 则进行移位操作, 直到数据对齐以后, 才将数据传给下一级8B/10B解码器.</p>
                </div>
                <div class="p1">
                    <p id="47">数据同步机制如图6所示, 复位时系统处于非对齐初始状态, 检测数据中的边界字符是否为<i>K</i>码字符, 如果不是<i>K</i>码字符, 则进行移位操作, 每次移位都重新检测数据中的边界字符是否为<i>K</i>码字符, 当且仅当连续三次检测到边界字符为<i>K</i>码字符并且字符译码无任何错误时, 系统则跳入同步对齐状态.当进入同步对齐状态以后, 如果检测到字符编码错误, 此时并不立即跳出对齐状态, 必须连续检测到三次字符错误才跳出对齐状态, 并重新回到非对齐初始状态, 继续进行移位对齐操作, 以此实现数据同步和对齐.</p>
                </div>
                <div class="area_img" id="48">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/WXYJ201903002_048.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVC9ralV1aXF1RUpsdE95VG55NWhBaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图6 同步对齐示意图" src="Detail/GetImg?filename=images/WXYJ201903002_048.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVC9ralV1aXF1RUpsdE95VG55NWhBaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit"><b>图</b>6 <b>同步对齐示意图</b>  <a class="btn-zoomin" href="Detail/GetImg?filename=images/WXYJ201903002_048.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVC9ralV1aXF1RUpsdE95VG55NWhBaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <h3 id="49" name="49" class="anchor-tag">4 <b>仿真验证</b></h3>
                <div class="p1">
                    <p id="50">完成了FC协议PCS层各关键模块的代码设计后, 采用回环测试法, 借助FPGA提供的GTY, 里边包含IP核PMA, 将设计的PCS层和FPGA提供的PMA联立起来, 并借助第三方专用FC协议分析仪, 搭建完整测试环路, 协议分析仪自动对比分析接收到的数据和发出的数据一致性, 给出分析报告, 最终完成PCS层的验证.</p>
                </div>
                <h4 class="anchor-tag" id="51" name="51">4.1 <b>功能仿真</b></h4>
                <div class="p1">
                    <p id="52">功能仿真结果如图7所示:gtrx_byteisaligned为1, gtrx_byterealign为0, 表明数据字节已经对齐.数据变化部分, 如图中方框所示, 每次交接部分都是一个32h’bc95d5d5、两个32h’bc95b5b5、一个32h’bcb55555.根据协议规定:32h’bc95d5d5为EOF帧尾符号, 实际上为上一帧数据的结束;中间两个32’hbc95b5b5, 实际上为两个IDLE字符;最后一个32h’bcb55555, 为SOF帧头符号, 实际上为下一帧的起始.帧头和帧尾之间为纯数据, 所以gtrx_data[63:0]和gtrx_charisk[7:0]表明接收到的数据流为数据和IDLE字符间插的情况, 且接收到的数据和发出的数据gttx_data[63:0]和gttx_charisk[7:0]完全相同, 且各种错误指示信号gtrx_kerr、gtrx_disperr、gtrx_notintable等都为0表示仿真结果无误, 综上所述, 表明PCS层功能仿真正确.</p>
                </div>
                <div class="area_img" id="53">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/WXYJ201903002_053.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVC9ralV1aXF1RUpsdE95VG55NWhBaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图7 功能仿真结果图" src="Detail/GetImg?filename=images/WXYJ201903002_053.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVC9ralV1aXF1RUpsdE95VG55NWhBaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit"><b>图</b>7 <b>功能仿真结果图</b>  <a class="btn-zoomin" href="Detail/GetImg?filename=images/WXYJ201903002_053.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVC9ralV1aXF1RUpsdE95VG55NWhBaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <h4 class="anchor-tag" id="54" name="54">4.2 <b>协议分析仪验证</b></h4>
                <div class="p1">
                    <p id="55">除了功能仿真, 本设计还借助FPGA和FC专用协议分析仪, 联立PCS层和PMA层, 进行板上环路测试, 左边为FPGA开发板, 右边为FC协议分析仪.</p>
                </div>
                <div class="p1">
                    <p id="56">FC协议分析仪验证实际采用PCS远端回环测试模式, 数据激励由协议分析仪产生, 协议分析仪发出串行数据, 输入到PMA进行串并转换, 再输入给PCS层的RX通路, 先后通过RX变速箱、数据同步器、8B/10B解码模块、弹性缓冲器, 再通过PCS远端回环到TX通路的弹性缓冲器、8B/10B编码模块、变速箱, 再传给PMA进行并串转换, 最后将串行数据传回FC协议分析仪, 协议分析仪自动对比分析接收数据和发出数据, 通过专业软件给出测试报告, 测试时间约为1小时, Tx Data Frames= Rx Data Frames=1220173230, 测试时间内接收的数据帧数和发出的相同, 为1220173230帧, 约为1.2 G的数据.Dropped Frames=0, 说明丢包数目为0, 误码率优于1/1.2G=8.2e-10, 各项error值为0, 平均延迟为0.62 μs, 满足要求, 证明PCS层工作正确.</p>
                </div>
                <h3 id="57" name="57" class="anchor-tag">5 <b>结束语</b></h3>
                <div class="p1">
                    <p id="58">本文深入研究FC协议的PCS层, 解析其内部关键模块:弹性缓冲器、8B/10B编解码器、位宽变换器、同步器等, 提出整体设计架构, 使用VERILOG语言完成代码设计, 搭建回环验证平台, 并采用FC专用协议分析仪, 结合FPGA进行验证, 完成设计.</p>
                </div>

        <!--brief end-->
        
        <!--conten left  end-->
        <!--增强附件-->
        

        <!--reference start-->
            <div class="reference anchor-tag" id="a_bibliography">
                    <h3>参考文献</h3>
                                        <p id="2">
                            <a id="bibliography_1" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JSYJ200602002&amp;v=MTIxNTE0TzN6cXFCdEdGckNVUkxPZVplVnVGeXpoVXJ6T0x6N1NaTEc0SHRmTXJZOUZab1FLREg4NHZSNFQ2ajU=&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVC9ralV1aXF1RUpsdE95VG55NWhBaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[1]</b> 林强, 熊华钢, 张其善. 光纤通道综述[J]. 计算机应用研究, 2006, 23 (2) :9-13.
                            </a>
                        </p>
                        <p id="4">
                            <a id="bibliography_2" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=YCYK201505011&amp;v=MzIxMDFDN1NaYkc0SDlUTXFvOUVaWVFLREg4NHZSNFQ2ajU0TzN6cXFCdEdGckNVUkxPZVplVnVGeXpoVXJ6T1A=&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVC9ralV1aXF1RUpsdE95VG55NWhBaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[2]</b> 杜玲, 廖小海.FC-AE-1553总线在箭载测量系统中应用研究[J].遥测遥控, 2015, 39 (5) :33-43.
                            </a>
                        </p>
                        <p id="6">
                            <a id="bibliography_3" target="_blank" href="http://scholar.cnki.net/result.aspx?q=An8B/10B encoder with a modified coding table">

                                <b>[3]</b> KIM Y W, KANG J K. An 8B/10B encoder with a modified coding table[C]//Circuits and Systems, 2008. APCCAS 2008. IEEE Asia Pacific Conference. Macao, China, 2008:1522-1525.
                            </a>
                        </p>
                        <p id="8">
                            <a id="bibliography_4" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Design of dual-gigabit tran- sceiver for fibre channel FC-1 layer">

                                <b>[4]</b> SUN G C, YU D S. Design of dual-gigabit tran- sceiver for fibre channel FC-1 layer[C]//Electron Devices and Solid-State Circuits, EDSSC 2008. IEEE International Conference, China, Hongkong, 2008:1-4.
                            </a>
                        </p>
                        <p id="10">
                            <a id="bibliography_5" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Simulation and synthesis techniques for asynchronous FIFO design">

                                <b>[5]</b> VERILOG E, CUMMINGS C E. Simulation and synthesis techniques for asynchronous FIFO design[J]. Snug, 2002, Section TB2 (3) :1-18.
                            </a>
                        </p>
            </div>
        <!--reference end-->
        <!--footnote start-->
        <!--footnote end-->



    </div>

        <input id="fileid" type="hidden" value="WXYJ201903002" />
        <input id="dpi" type="hidden" value="800" />
    </div>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?6e967eb120601ea41b9d312166416aa6";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
</script>

    


<input id="hid_uid" name="hid_uid" type="hidden" value="WEEvREcwSlJHSldRa1FhdkJkVG5hVC9ralV1aXF1RUpsdE95VG55NWhBaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
<input id="hid_kLogin_headerUrl" name="hid_kLogin_headerUrl" type="hidden" value="/KLogin/Request/GetKHeader.ashx%3Fcallback%3D%3F" />
<input id="hid_kLogin_footerUrl" name="hid_kLogin_footerUrl" type="hidden" value="/KLogin/Request/GetKFooter.ashx%3Fcallback%3D%3F" />
<div class="btn-link" style="display: none"><a target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=WXYJ201903002&amp;v=Mjc1ODFyQ1VSTE9lWmVWdUZ5emhVcnpQTWpYU1pMRzRIOWpNckk5RlpvUUtESDg0dlI0VDZqNTRPM3pxcUJ0R0Y=&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVC9ralV1aXF1RUpsdE95VG55NWhBaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">知网节</a></div>
<div class="popflow" id="popupTips" style="display: none;">
    <div class="popflowArr"></div>
    <div class="popflowCot">
        <div class="hd"><a href="javascript:void(0);" onclick="$('#popupTips').hide();$('#popupmsg').html('')" class="close">X</a></div>
        <div class="bd">
            <p class="mes" id="popupmsg" name="popupmsg"></p>
          
        </div>
    </div>
</div>
<input type="hidden" id="myexport" value="//kns.cnki.net" />

<input type="hidden" id="KPCAPIPATH" value="//ishufang.cnki.net" />
<input type="hidden" id="CitedTimes" value="1" />
<div class="link" id="GLSearch" style="display: none;">
    <i class="icon-trangle"></i>
    <div class="inner">
        <a class="icon" id="copytext">复制</a>
        <a class="icon" target="_blank" onclick="searchCRFD(this)">工具书搜索</a>
    </div>
</div>




<input id="hidVirtualPath" name="hidVirtualPath" type="hidden" value="/kxreader" />
<script src="/kxreader/bundles/detail?v=-ULdk-c6FkZHtJA2KAXPgHnyA8mtgyPnBde_C2VZ2BY1"></script>

<script src="/kxreader/Scripts/layer.min.js" type="text/javascript"></script>

<div id="footerBox" class="rootw footer">
</div>
<script>
    if (typeof FlushLogin == 'function') {
        FlushLogin();
    }
    modifyEcpHeader(true);
</script>

<!--图片放大功能 start-->
<script src="/kxreader/bundles/imagebox?v=W4phPu9SNkGcuPeJclikuVE3PpRyIW_gnfjm_19nynI1"></script>

<script type="text/javascript">
    $(function () {
        var j = $.noConflict();
        j(function () {
            j(".zoom-in,.btn-zoomin").imgbox({
                'alignment': 'center',
                'allowMultiple': false,
                'overlayShow': true
            });
        })
    });
</script>
<!--图片放大功能 end-->
<div class="fixedbar">
    <div class="backtop hiddenV" id="backtop">
        <a id="backTopSide" href="javascript:scroll(0,0);" title=""></a>
    </div>
</div>
<script type="text/javascript" src="/kxreader/Scripts/MathJax-2.6-latest/MathJax.js?config=MML_HTMLorMML-full"></script>

</body>
</html>
