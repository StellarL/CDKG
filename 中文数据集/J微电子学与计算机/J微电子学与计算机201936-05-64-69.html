<!DOCTYPE html>
<html>
<head>
    <title>全文阅读--XML全文阅读--中国知网</title>
    <link rel="icon" href="/kxreader/favicon.ico" />
    <link rel="shortcut Icon" href="/kxreader/favicon.ico" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="keywords" content="文献 XML KBASE CNKI 中国知网" />
    <meta name="description" content="XML文献检索" />
    <link href="/kxreader/Content/css/detail?v=qX2z2KjRAEyQiNfAbKtl7dLnsqFoQ5Jdw3TZfDf0n1k1" rel="stylesheet"/>

    <script type="text/javascript">
        var APPPATH = '/kxreader';
    </script>
</head>

<body>
    
<script type="text/javascript" src="//login.cnki.net/TopLogin/api/loginapi/get?type=top&amp;localCSS=&amp;returnurl=%2f%2fkns.cnki.net%2f%2fKXReader%2fDetail%3fTIMESTAMP%3d637133885527600000%26DBCODE%3dCJFD%26TABLEName%3dCJFDLAST2019%26FileName%3dWXYJ201905014%26RESULT%3d1%26SIGN%3d%252fBrLcvf2iKdNLLN69OpKNrowbJw%253d"></script>

<div id="headerBox" class="header">
    <div class="topbar">
        <div class="textalign">
            <a href="/kxreader/Detail?dbcode=CJFD&amp;filename=WXYJ201905014&amp;align=md">
                <i class="icon-cen active" title="居中对齐"></i>
            </a>
            <a href="/kxreader/Detail?dbcode=CJFD&amp;filename=WXYJ201905014&amp;align=lt">
                <i class="icon-left " title="左对齐"></i>
            </a>
        </div>
        <h6 class="free-tip"><i class="icon"></i>HTML阅读开放试用阶段，欢迎体验！</h6>
    </div>
</div>

    



<div class="btn-link" style="display: none"><a target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=WXYJ201905014&amp;v=MDIzMDg2ajU0TzN6cXFCdEdGckNVUkxPZVplVnVGeWptVzcvTk1qWFNaTEc0SDlqTXFvOUVZSVFLREg4NHZSNFQ=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY3Zm5LZEo2VXlXemZUQTF2RT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">知网节</a></div>

    <div class="main">

        

    <div class="sidebar-a">
        <!--sidebar start-->
        <div class="sidenav">
            <div class="arrow"><span></span></div>
            <!--sidebar_list start-->
            <dl class="sidenav-list">
                    <dt class="tit">目录结构</dt>
                            <dd class="guide">
                                    <p><a href="#139" data-title="1 引言 ">1 引言</a><i></i></p>
                                                            </dd>
                            <dd class="guide">
                                    <p><a href="#144" data-title="2 FISqrt算法的理论基础 ">2 FISqrt算法的理论基础</a><i></i></p>
                                                                    <ul class="contentbox">
                                                <li><a href="#145" data-title="2.1 浮点数与整数的表示">2.1 浮点数与整数的表示</a></li>
                                                <li><a href="#151" data-title="2.2 FISqrt算法原理">2.2 FISqrt算法原理</a></li>
                                    </ul>
                            </dd>
                            <dd class="guide">
                                    <p><a href="#171" data-title="3 R常数的改进方案 ">3 R常数的改进方案</a><i></i></p>
                                                            </dd>
                            <dd class="guide">
                                    <p><a href="#187" data-title="4 结果验证 ">4 结果验证</a><i></i></p>
                                                            </dd>
                            <dd class="guide">
                                    <p><a href="#200" data-title="5 FISqrt算法的进一步探讨 ">5 FISqrt算法的进一步探讨</a><i></i></p>
                                                            </dd>
                            <dd class="guide">
                                    <p><a href="#205" data-title="6 结束语 ">6 结束语</a><i></i></p>
                                                            </dd>
                            <dd class="guide">
                                    <p><a href="#" data-title="文内图表 ">文内图表</a><i></i></p>
                                                                    <ul class="contentbox">
                                                <li><a href="#149" data-title="图1 IEEE754单精度浮点数格式">图1 IEEE754单精度浮点数格式</a></li>
                                                <li><a href="#158" data-title="图2 y=log&lt;sub&gt;2&lt;/sub&gt; (1+k) 与y=k+δ的函数图象">图2 y=log<sub>2</sub> (1+k) 与y=k+δ的函数图象</a></li>
                                                <li><a href="#170" data-title="表1 平方根倒数的初始估计值与标准值的对比">表1 平方根倒数的初始估计值与标准值的对比</a></li>
                                                <li><a href="#195" data-title="图3 初始估计与精确值的误差百分比">图3 初始估计与精确值的误差百分比</a></li>
                                                <li><a href="#196" data-title="图4 一次迭代值与精确值的误差百分比">图4 一次迭代值与精确值的误差百分比</a></li>
                                                <li><a href="#197" data-title="图5 两次迭代值与精确值的误差百分比">图5 两次迭代值与精确值的误差百分比</a></li>
                                                <li><a href="#199" data-title="图6 R=0x5f34ff59相比于R=0x5f3759df在计算精度上更优/劣的占比分布">图6 R=0x5f34ff59相比于R=0x5f3759df在计算精度上更优/劣的占比分布</a></li>
                                    </ul>
                            </dd>
                                    <dd class="guide">
                                        <h6>
                                            <p><a href="#a_bibliography">参考文献</a> </p>
                                        </h6>
                                    </dd>

            </dl>
        </div>
        <!--sidebar end-->
        &nbsp;
        <!--此处有一空格符 勿删-->
    </div>

                <div class="sidebar-b three-collumn" style="width:0;">
            <div class="refer" style="width: 0;">
                <div class="arrow off" title="参考文献"><span></span></div>
                <div class="js-scrollbox" >
                    
                    <div class="subbox active">
                        <h4>
                            <span class="tit">参考文献</span>
                            <a class="close" href="javascript:void(0)">x</a>
                        </h4>
                        <div class="side-scroller">
                            <ul class="refer-list">
                                <li id="221">


                                    <a id="bibliography_1" title=" IEEE Computer Society.IEEE Standard 754-2008:IEEE Standard for Floating-Point Arithmetic[S].New York:IEEE, 2008." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=IEEE Standard for Floating-Point Arithmetic">
                                        <b>[1]</b>
                                         IEEE Computer Society.IEEE Standard 754-2008:IEEE Standard for Floating-Point Arithmetic[S].New York:IEEE, 2008.
                                    </a>
                                </li>
                                <li id="223">


                                    <a id="bibliography_2" title=" SOMMEFELDT R.Origin of quake3&#39;s fast InvSqrt () , Beyond3D[EB/OL]. (2006-11-29) .[2018-09-03].http://www.beyond3d.com/content/articles/8/" target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Origin of quake3&amp;#39;&amp;#39;s fast InvSqrt (),Beyond3D">
                                        <b>[2]</b>
                                         SOMMEFELDT R.Origin of quake3&#39;s fast InvSqrt () , Beyond3D[EB/OL]. (2006-11-29) .[2018-09-03].http://www.beyond3d.com/content/articles/8/
                                    </a>
                                </li>
                                <li id="225">


                                    <a id="bibliography_3" title=" LOMONT C.Fast inverse square root[R].West Lafayette:Purdue University, Department of Mathematics, 2003." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Fast inverse square root">
                                        <b>[3]</b>
                                         LOMONT C.Fast inverse square root[R].West Lafayette:Purdue University, Department of Mathematics, 2003.
                                    </a>
                                </li>
                                <li id="227">


                                    <a id="bibliography_4" title=" THAKKAR S, HUFF T.Internet streaming SIMD extensions[J].Computer, 1999, 32 (12) :26-34." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Internet Streaming SIMD Extensions">
                                        <b>[4]</b>
                                         THAKKAR S, HUFF T.Internet streaming SIMD extensions[J].Computer, 1999, 32 (12) :26-34.
                                    </a>
                                </li>
                                <li id="229">


                                    <a id="bibliography_5" title=" RAMAN S K, PENTKOVSKI V, KESHAVA J.Implementing streaming SIMD Extensions on the pentium III processor[J].IEEE Micro, 2002, 20 (4) :47-57." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Implementing Streaming SIMD Extensions on the Pentium III Processor">
                                        <b>[5]</b>
                                         RAMAN S K, PENTKOVSKI V, KESHAVA J.Implementing streaming SIMD Extensions on the pentium III processor[J].IEEE Micro, 2002, 20 (4) :47-57.
                                    </a>
                                </li>
                                <li id="231">


                                    <a id="bibliography_6" title=" ERCEGOVAC M D, LANG T, MULLER J M, et al.Reciprocation, square root, inverse square root, and some elementary functions using small multipliers[J].IEEE Transactions on Computers, 1998, 49 (7) :628-637." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Reciprocation, Square Root, Inverse Square Root, and Some Elementary Functions Using Small Multipliers">
                                        <b>[6]</b>
                                         ERCEGOVAC M D, LANG T, MULLER J M, et al.Reciprocation, square root, inverse square root, and some elementary functions using small multipliers[J].IEEE Transactions on Computers, 1998, 49 (7) :628-637.
                                    </a>
                                </li>
                                <li id="233">


                                    <a id="bibliography_7" title=" TAKAGI N.A hardware algorithm for computing reciprocal square root[C]//Proceedings 15th IEEE Symposium on Computer Arithmetic (ARITH-15) .Vail, Colorado:IEEE, 2001:94-100." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=A hardware algorithm for computing reciprocal square root">
                                        <b>[7]</b>
                                         TAKAGI N.A hardware algorithm for computing reciprocal square root[C]//Proceedings 15th IEEE Symposium on Computer Arithmetic (ARITH-15) .Vail, Colorado:IEEE, 2001:94-100.
                                    </a>
                                </li>
                                <li id="235">


                                    <a id="bibliography_8" title=" ZAFAR S, ADAPA R.Hardware architecture design and mapping of fast inverse square root algorithm[C]//IEEE International Conference on Advances in Electrical Engineering (ICAEE) . Vellore, India:IEEE, 2014:1-4." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Hardware architecture design and mapping of fast inverse square root algorithm">
                                        <b>[8]</b>
                                         ZAFAR S, ADAPA R.Hardware architecture design and mapping of fast inverse square root algorithm[C]//IEEE International Conference on Advances in Electrical Engineering (ICAEE) . Vellore, India:IEEE, 2014:1-4.
                                    </a>
                                </li>
                                <li id="237">


                                    <a id="bibliography_9" title=" ZHOU Q, YANG L, YAN X.Reconfigurable instruction-based multicore parallel convolution and its application in real-time template matching[J].IEEE Transactions on Computers, doi:10.1109/TC.2018.2844351." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Reconfigurable instruction-based multicore parallel convolution and its application in real-time template matching">
                                        <b>[9]</b>
                                         ZHOU Q, YANG L, YAN X.Reconfigurable instruction-based multicore parallel convolution and its application in real-time template matching[J].IEEE Transactions on Computers, doi:10.1109/TC.2018.2844351.
                                    </a>
                                </li>
                            </ul>
                            <div style='display: none;' class="zqscroller" >
                                <h4 class="">附加材料</h4>
                                <ul></ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            &nbsp;
            <!--此处有一空格符 勿删-->
        </div>

        
    <div class="content">



        <!--tips start-->
                            <div class="tips">
                    <a href="http://navi.cnki.net/KNavi/JournalDetail?pcode=CJFD&amp;pykm=WXYJ" target="_blank">微电子学与计算机</a>
                2019,36(05),64-69             </div>
        <!--tips end-->
            <div class="top-title">
                <h1 class="title">
                    <span class="vm">平方根倒数速算法的精度优化</span>
                                    </h1>

            </div>
                        <h2>
                                <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=au&amp;skey=%E5%91%A8%E6%B3%89&amp;code=31570696&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY3Zm5LZEo2VXlXemZUQTF2RT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">周泉</a>
                                <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=au&amp;skey=%E6%9D%A8%E9%9D%93&amp;code=22537053&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY3Zm5LZEo2VXlXemZUQTF2RT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">杨靓</a>
                                <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=au&amp;skey=%E4%BD%95%E5%8D%AB%E5%BC%BA&amp;code=29005673&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY3Zm5LZEo2VXlXemZUQTF2RT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">何卫强</a>
                </h2>
                    <h2>
                    <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=in&amp;skey=%E8%A5%BF%E5%AE%89%E5%BE%AE%E7%94%B5%E5%AD%90%E6%8A%80%E6%9C%AF%E7%A0%94%E7%A9%B6%E6%89%80&amp;code=1500262&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY3Zm5LZEo2VXlXemZUQTF2RT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">西安微电子技术研究所</a>
            </h2>

        
<div class="link">
    <a id="aexport" class="icon icon-output"  onclick="" href="javascript:void(0);"><i></i>导出/参考文献</a>
    
    <span class="shareBoard" onmouseover="$('#sharedet').show();$('#this').addClass('shareBoardCUR')" onmouseout="$('#sharedet').hide();$('#this').removeClass('shareBoardCUR')">
        <a class="icon icon-share" href="#"><i></i>分享<em></em></a>
        <ul class="shareHide" id="sharedet" style="display: none;">
            <li><a title="复制链接" class="copy" onclick="" href="#"><i></i>复制链接</a></li>
            <li><a title="分享到新浪微博" class="xl" onclick="" href="javascript:common.ShareAction('xl');"><i></i>新浪微博</a></li>
            <li>
                <a title="分享到微信" class="wx" onclick="" href="#"><i></i>微信扫一扫</a>
                <div class="qrcode"><img src='' alt='' /></div>
            </li>
        </ul>

    </span>
    
    <a id="RefTrack" title="创建引文跟踪" class="icon icon-track" onclick="" href="javascript:void(0);"> <i></i>创建引文跟踪 </a>
    <a id="ashoucang" title="收藏" class="icon icon-favor" onclick="" href="javascript:void(0);"><i></i>收藏</a>
    <a class="icon icon-print" onclick="window.print();" href="javascript:void(0);"><i></i>打印</a>
    
    <!--版本切换 end-->
</div>
                            <div class="data" id="a_abstract">
                <span class="keys">摘<span style="font-family: 'Times New Roman';">&nbsp;&nbsp;&nbsp;&nbsp;</span>要：</span>
                <p>平方根倒数速算法是计算机数值计算中的一种常用方法.文中在对平方根倒数速算法的原理进行分析的基础上, 提出一个新的算法常数来提升计算结果的统计精度.实验结果表明, 本文提供的算法常数相比于原有的算法常数能将批量数据处理的平均精度提升大约30%～40%, 而针对单个数据的计算, 本文方法的意义在于能从一个更大的概率 (平均约77%) 上获得比原有方法更加精确的结果.</p>
            </div>
                    <div class="data" id="a_keywords">
                <span class="keys">关键词：</span>
                <p>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=%E5%B9%B3%E6%96%B9%E6%A0%B9%E5%80%92%E6%95%B0&amp;code=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY3Zm5LZEo2VXlXemZUQTF2RT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">平方根倒数;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=0x5f3759df&amp;code=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY3Zm5LZEo2VXlXemZUQTF2RT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">0x5f3759df;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=0x5f34ff59&amp;code=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY3Zm5LZEo2VXlXemZUQTF2RT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">0x5f34ff59;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=%E5%8D%A1%E9%A9%AC%E5%85%8B%E5%B8%B8%E6%95%B0&amp;code=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY3Zm5LZEo2VXlXemZUQTF2RT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">卡马克常数;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=%E7%B2%BE%E5%BA%A6%E4%BC%98%E5%8C%96&amp;code=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY3Zm5LZEo2VXlXemZUQTF2RT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">精度优化;</a>
                </p>
            </div>
        
        <!--brief start-->
        
            <div class="brief">
                    <p>
                            <b>作者简介：</b>
                                                        <span>
                                    周泉 男, (1987-) , 博士研究生.研究方向为计算机系统结构、数字集成电路设计、高性能计算.E-mail:zhouquan1234.ok@163.com.;
                                </span>
                                <span>
                                    杨靓 男, (1975-) , 博士, 研究员.研究方向为计算机系统结构、数字集成电路设计.;
                                </span>
                                <span>
                                    何卫强 男, (1987-) , 硕士.研究方向为计算机系统结构、数字集成电路设计.;
                                </span>
                    </p>
                                    <p><b>收稿日期：</b>2018-08-22</p>

            </div>
                    <h1>Accuracy optimizing for fast inverse square root algorithm</h1>
                    <h2>
                    <span>ZHOU Quan</span>
                    <span>YANG Liang</span>
                    <span>HE Wei-qiang</span>
            </h2>
                    <h2>
                    <span>Xi′an Microelectronics Technology Institute</span>
            </h2>
                            <div class="data" id="a_abstractEN">
                <span class="keys">Abstract：</span>
                <p>The fast inverse square root algorithm is a common method in computer numerical calculation.Based on the principle analysis of the fast inverse square root algorithm, a new algorithm constant is proposed to improve the statistical accuracy of the calculation results.The experimental results show that the algorithm constant provided by this paper can increase the average precision of batch data processing by about 30% ～40% compared with the original algorithm constant.For the calculation of single data, the significance of the method in this paper is to obtain a more accurate result than the original method on a larger probability (average of about 77%) .</p>
            </div>
                    <div class="data" id="a_keywordsEN">
                <span class="keys">Keyword：</span>
                <p>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=inverse%20square%20root&amp;code=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY3Zm5LZEo2VXlXemZUQTF2RT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">inverse square root;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=0x5f3759df&amp;code=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY3Zm5LZEo2VXlXemZUQTF2RT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">0x5f3759df;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=0x5f34ff59&amp;code=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY3Zm5LZEo2VXlXemZUQTF2RT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">0x5f34ff59;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=carmack%20constant&amp;code=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY3Zm5LZEo2VXlXemZUQTF2RT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">carmack constant;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=accuracy%20optimizing&amp;code=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY3Zm5LZEo2VXlXemZUQTF2RT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">accuracy optimizing;</a>
                </p>
            </div>
                    <div class="brief">
                
                    <p>
                                            </p>
                                    <p><b>Received：</b> 2018-08-22</p>
                            </div>


        <!--brief start-->
                        <h3 id="139" name="139" class="anchor-tag">1 引言</h3>
                <div class="p1">
                    <p id="140">平方根倒数速算法 (Fast Inverse Square Root, FISqrt) 是计算形如<image id="207" type="formula" href="images/WXYJ201905014_20700.jpg" display="inline" placement="inline"><alt></alt></image>的取值的一种快速算法, 其中x为正浮点数, 且按照IEEE754标准<sup><a class="sup">[1]</a></sup>格式表示.FISqrt在数值计算中广泛存在, 其典型应用是计算正规化向量.该算法最初发现于一个被称为“Quake-3”的游戏源代码中<sup><a class="sup">[2]</a></sup>, 但是该算法的原作者到目前为止尚未真正明确.现在已经追溯到该算法最早的应用存在于美国SGI公司上世纪九十年代初的Indigo多媒体工作站中, 但是彼时的FISqrt算法只是由Gary Tarilli进行了实现, 且Gary Tarilli也坦诚, 他只是对算法中的关键常数作了一定改进, 并非原作者<sup><a class="sup">[2]</a></sup>.FISqrt算法的C语言描述如图1所示, 程序的计算结果为x的平方根倒数值, 其中的常数“0x5f3759df”被称为“卡马克常数”或“魔术数字”.该算法的简洁高效是毫无疑问的, 它与Visual C++中1.0/sqrt (x) 相比, 计算速度快了4倍<sup><a class="sup">[3]</a></sup>.</p>
                </div>
                <div class="p1">
                    <p id="141">平方根倒数的计算普遍存在于图像视频等多媒体处理中, 因此Intel在x86架构面向多媒体的SSE指令集中引入了平方根倒数计算指令<sup>[<a class="sup">4</a>,<a class="sup">5</a>]</sup>, 从硬件上支持平方根倒数的计算以获得更快的计算速度.目前平方根倒数的硬件实现方法具有较多的研究<sup>[<a class="sup">6</a>,<a class="sup">7</a>,<a class="sup">8</a>]</sup>, 其中Zafar<sup><a class="sup">[8]</a></sup>等人根据下列所示的软件算法的思路, 直接进行硬化设计, 并对设计进行评估, 证明了其可行性.在目前的大多数RISC处理器中, 为了避免过多的硬件开销, 一般不会提供类似平方根倒数计算的硬件支持, 这时主要采用FISqrt算法来实现浮点数平方根倒数的快速计算.</p>
                </div>
                <div class="area_img" id="142">
                                <img alt="" src="Detail/GetImg?filename=images/WXYJ201905014_14200.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY3Zm5LZEo2VXlXemZUQTF2RT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                            <p class="img_tit"></p>

                </div>
                <div class="p1">
                    <p id="143">在图像视频处理中, 往往需要对批量数据进行相同操作, 平方根倒数的计算也不例外;例如, 在相关图像匹配中计算结果的归一化<sup><a class="sup">[9]</a></sup>时就需要对整个矩阵的每个元素求平方根倒数.本文针对FISqrt算法中的常数提供一种改进方法, 以提升计算结果的精度。实验结果表明, 采用相同的牛顿迭代次数, 文中所给出的算法常数与原有方法相比, 能将批量数据的计算结果的平均精度提升大约30%～40%以上, 而针对单个数据的计算, 能从大约77%的概率上获得比原有算法更加精确的结果。</p>
                </div>
                <h3 id="144" name="144" class="anchor-tag">2 FISqrt算法的理论基础</h3>
                <h4 class="anchor-tag" id="145" name="145">2.1 浮点数与整数的表示</h4>
                <div class="p1">
                    <p id="146">FISqrt算法中的浮点数采用IEEE754标准<sup><a class="sup">[1]</a></sup>格式表示, 且浮点数与整数必须具有相同的比特位数, 本文以32位数据表示为例进行介绍.</p>
                </div>
                <div class="p1">
                    <p id="147">图1所示为IEEE754标准的单精度浮点数表示格式, 其中最高位为符号位s, 当s为0时表示正数, 当s为1时表示负数.接下来的8位表示带偏移量的指数E;32为单精度浮点数中偏移量为固定值B=127, 实际求得的指数值为e=E-B.最后23位代表尾数m, 这里0≤m&lt;1, 且尾数部分包含一个未表示出来的隐藏位1.因此浮点数可以表示为x= (-1) <sup>s</sup>× (1+m) ×2<sup>E-B</sup>.</p>
                </div>
                <div class="area_img" id="149">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/WXYJ201905014_14900.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY3Zm5LZEo2VXlXemZUQTF2RT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图1 IEEE754单精度浮点数格式" src="Detail/GetImg?filename=images/WXYJ201905014_14900.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY3Zm5LZEo2VXlXemZUQTF2RT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图1 IEEE754单精度浮点数格式  <a class="btn-zoomin" href="Detail/GetImg?filename=images/WXYJ201905014_14900.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY3Zm5LZEo2VXlXemZUQTF2RT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="p1">
                    <p id="150">整数的表示相对简单, 有符号数的最高位为符号位, 剩下的31位全是数值位;无符号数的所有位数均为数值位.如果将图2的浮点数看作一个整数, 那么它由8bit的整数E左移23位后加上23bit的m的整数形式得到.如果将m的整数形式用M表示, 则所得的整数I=E×2<sup>23</sup>+M, 这里的符号位s默认为0, 因为平方根倒数的求解只针对正数进行.</p>
                </div>
                <h4 class="anchor-tag" id="151" name="151">2.2 FISqrt算法原理</h4>
                <div class="p1">
                    <p id="152">FISqrt算法只针对正浮点数进行, 符号位为0, 这样图1所示的浮点数的实际数值为x= (1+m) ×2<sup>e</sup>, 其中e=E-B;若将其看作一个整数, 则实际数值为I=EL+M, 其中L=2<sup>n-b-1</sup>, M=mL, 当采用32位的数据表示时n=32, b=8, 且B=2<sup>b-1</sup>-1.</p>
                </div>
                <div class="p1">
                    <p id="153">FISqrt算法需要计算<image id="208" type="formula" href="images/WXYJ201905014_20800.jpg" display="inline" placement="inline"><alt></alt></image>的值, 其中x为正浮点数.对该式子两边同时取2为底的对数得到:</p>
                </div>
                <div class="area_img" id="154">
                            <div class="imgformula">
                                <img class="pFormula" alt="" src="Detail/GetImg?filename=images/WXYJ201905014_15400.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY3Zm5LZEo2VXlXemZUQTF2RT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                <p class="formula_seq"></p>
                            </div>

                </div>
                <div class="p1">
                    <p id="155">x和y均为浮点数, 可以分别表示为x= (1+m<sub>x</sub>) ×2<sup>e</sup>x和y= (1+m<sub>y</sub>) ×2<sup>e</sup>y, 将x, y的指数形式带入 (1) 得到</p>
                </div>
                <div class="area_img" id="156">
                            <div class="imgformula">
                                <img class="pFormula" alt="" src="Detail/GetImg?filename=images/WXYJ201905014_15600.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY3Zm5LZEo2VXlXemZUQTF2RT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                <p class="formula_seq"></p>
                            </div>

                </div>
                <div class="p1">
                    <p id="157">设常数k满足0≤k&lt;1, 则用k可以粗略的表示log<sub>2</sub> (1+k) 的值, 即log<sub>2</sub> (1+k) ≈k.为了让这个粗略的表示更加合理, 可以采用一个常数δ来调和log<sub>2</sub> (1+k) 与k之间的误差, 即用直线y=k+δ来逼近曲线y=log<sub>2</sub> (1+k) .如图2所示, 从图中可以看出直线对曲线的逼近程度随着δ的变化而变化.给定一个合理的δ值, 当k在[0, 1) 中变化时直线与曲线实际上非常接近, 即log<sub>2</sub> (1+k) ≈k+δ, 其中δ为一个可选的常数.</p>
                </div>
                <div class="area_img" id="158">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/WXYJ201905014_15800.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY3Zm5LZEo2VXlXemZUQTF2RT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图2 y=log2 (1+k) 与y=k+δ的函数图象" src="Detail/GetImg?filename=images/WXYJ201905014_15800.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY3Zm5LZEo2VXlXemZUQTF2RT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图2 y=log<sub>2</sub> (1+k) 与y=k+δ的函数图象  <a class="btn-zoomin" href="Detail/GetImg?filename=images/WXYJ201905014_15800.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY3Zm5LZEo2VXlXemZUQTF2RT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="p1">
                    <p id="159">采用上述的近似表示之后, 式 (2) 可以写成:</p>
                </div>
                <div class="area_img" id="160">
                            <div class="imgformula">
                                <img class="pFormula" alt="" src="Detail/GetImg?filename=images/WXYJ201905014_16000.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY3Zm5LZEo2VXlXemZUQTF2RT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                <p class="formula_seq"></p>
                            </div>

                </div>
                <div class="p1">
                    <p id="161">M<sub>x</sub>/L代入式 (3) , 并整理得:</p>
                </div>
                <div class="area_img" id="162">
                            <div class="imgformula">
                                <img class="pFormula" alt="" src="Detail/GetImg?filename=images/WXYJ201905014_16200.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY3Zm5LZEo2VXlXemZUQTF2RT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                <p class="formula_seq"></p>
                            </div>

                </div>
                <div class="p1">
                    <p id="163">式 (4) 中的左端为将浮点数y看成整数I<sub>y</sub>的一种表示, 而右端的E<sub>x</sub>L+M<sub>x</sub>为给定的浮点数x的一种整数表示, 且给定数据表示的格式时B和L都为已知.因此, 式 (4) 表明如果给定式子<image id="209" type="formula" href="images/WXYJ201905014_20900.jpg" display="inline" placement="inline"><alt></alt></image>, 那么可以根据x的整数表示形式I<sub>x</sub>=E<sub>x</sub>L+M<sub>x</sub>导出y的整数表示形式I<sub>y</sub>的近似值.如果将这个导出的I<sub>y</sub>的近似值定义成一个浮点数, 那么它自然也能成为浮点数y的近似值, 即x的平方根倒数的近似值.应用中如果数值精度不够理想, 可以用该近似值为基础进行牛顿迭代, 提高结果的精度, 这就是FISqrt算法的原理.</p>
                </div>
                <div class="p1">
                    <p id="164">设<image id="210" type="formula" href="images/WXYJ201905014_21000.jpg" display="inline" placement="inline"><alt></alt></image>, 那么式 (4) 可以写成:</p>
                </div>
                <div class="area_img" id="165">
                            <div class="imgformula">
                                <img class="pFormula" alt="" src="Detail/GetImg?filename=images/WXYJ201905014_16500.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY3Zm5LZEo2VXlXemZUQTF2RT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                <p class="formula_seq"></p>
                            </div>

                </div>
                <div class="p1">
                    <p id="166">式 (5) 与图1中的第5行代码“i=0x5f3759df- (i&gt;&gt;1) ”相对应, 该行代码实现的是平方根倒数的初值估计.从中可以看出原始代码中的常数“0x5f3759df”为R的值, 即<image id="211" type="formula" href="images/WXYJ201905014_21100.jpg" display="inline" placement="inline"><alt></alt></image><image id="211" type="formula" href="images/WXYJ201905014_21101.jpg" display="inline" placement="inline"><alt></alt></image>.由此可以计算出</p>
                </div>
                <div class="area_img" id="167">
                            <div class="imgformula">
                                <img class="pFormula" alt="" src="Detail/GetImg?filename=images/WXYJ201905014_16700.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY3Zm5LZEo2VXlXemZUQTF2RT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                <p class="formula_seq"></p>
                            </div>

                </div>
                <div class="p1">
                    <p id="168">在目前的应用中, R取“0x5f3759df”的原因尚未真正明确, 对其取值的合理性更没有相应的理论证明, 这也是很多研究人员对FISqrt算法的关键兴趣所在.</p>
                </div>
                <div class="p1">
                    <p id="169">表1根据上述的FISqrt算法原理列举了若干个数据的平方根倒数的初始估计值与标准值的对比, 从这组数据中可以看出平方根倒数的预估初始值与标准值的误差均未超过3.5%.</p>
                </div>
                <div class="area_img" id="170">
                                            <p class="img_tit">
                                                表1 平方根倒数的初始估计值与标准值的对比
                                                
                                                &nbsp;&nbsp;
                                                <a class="btn-zoomin" href="Detail/GetImg?filename=images/WXYJ201905014_17000.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY3Zm5LZEo2VXlXemZUQTF2RT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a>
                                                <a class="table downimg" data-tablename="Detail/GetImg?filename=images/WXYJ201905014_17000.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY3Zm5LZEo2VXlXemZUQTF2RT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">下载原表</a>
                                            </p>
                                    <a class="zoom-in" href="Detail/GetImg?filename=images/WXYJ201905014_17000.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY3Zm5LZEo2VXlXemZUQTF2RT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <img alt="表1 平方根倒数的初始估计值与标准值的对比" src="Detail/GetImg?filename=images/WXYJ201905014_17000.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY3Zm5LZEo2VXlXemZUQTF2RT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                    </a>

                </div>
                <h3 id="171" name="171" class="anchor-tag">3 R常数的改进方案</h3>
                <div class="p1">
                    <p id="172">上一节中, 根据当前算法中广泛采用的R值, 求出了误差调和常数δ的值, 但实际上δ是一个可选的常数.因此, 存在一个问题是如何选择δ的值, 使得当0≤k&lt;1时, 用直线y=k+δ来近似表示曲线y=log<sub>2</sub> (1+k) 会更加合理, 从而进一步减小平方根倒数初始估计的误差.通过上一节的分析可以发现, FISqrt算法中影响初始值估计精度的关键在于由δ值确定的直线是否能很好的逼近曲线.可以设想如果直线和曲线完全重合 (没有误差) , 那么计算得到的初始值也就精确的代表平方根倒数值.从图3可见δ代表直线在y轴上的截距, 改变δ值可以改变曲线的上下位置.如果采用一种方法选择一个更加优化的δ值, 使得直线更加精确的代表曲线, 并通过δ计算出一个更加优化的R值, 便能达到提高初始估计精度的目的.</p>
                </div>
                <div class="p1">
                    <p id="173">假设实际应用中需要计算平方根倒数的数据元素个数为n, 其中每个元素的浮点格式中的尾数m<sub>i</sub>确定了y (m<sub>i</sub>) =m<sub>i</sub>+δ对f (m<sub>i</sub>) =log<sub>2</sub> (1+m<sub>i</sub>) 的一个近似表示, 其中0≤m<sub>i</sub>&lt;1, 0≤i≤n-1.</p>
                </div>
                <div class="p1">
                    <p id="174">为了提高整批数据的求解质量需要让y (m<sub>i</sub>) =m<sub>i</sub>+δ近似表示f (m<sub>i</sub>) =log<sub>2</sub> (1+m<sub>i</sub>) 的平均误差<image id="212" type="formula" href="images/WXYJ201905014_21200.jpg" display="inline" placement="inline"><alt></alt></image>尽可能的小.为了避免绝对<sub>i=0</sub>值的运算, 将平均误差改为均方误差进行计算, 如果用<image id="213" type="formula" href="images/WXYJ201905014_21300.jpg" display="inline" placement="inline"><alt></alt></image>表示均方误差, 则需要让</p>
                </div>
                <div class="area_img" id="177">
                            <div class="imgformula">
                                <img class="pFormula" alt="" src="Detail/GetImg?filename=images/WXYJ201905014_17700.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY3Zm5LZEo2VXlXemZUQTF2RT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                <p class="formula_seq"></p>
                            </div>

                </div>
                <div class="p1">
                    <p id="178">取到最小值.针对具体应用, 式 (6) 中的m<sub>i</sub>和n均为已知, 变化的只有δ, 因此需要取一个能使<image id="214" type="formula" href="images/WXYJ201905014_21400.jpg" display="inline" placement="inline"><alt></alt></image>最小的δ, 并将由此计算出的R用到算法编程中去.但是在讨论算法的一般情况的时候, 并不知道m<sub>i</sub>和n的具体取值, 为了获得一个普遍适用的δ常数, 可以将浮点数的尾数m<sub>i</sub>视为在区间[0, 1) 上随机均匀分布, 并且在求平均值<image id="215" type="formula" href="images/WXYJ201905014_21500.jpg" display="inline" placement="inline"><alt></alt></image>的过程中对区间[0, 1) 上的所有可能的m<sub>i</sub>值进行遍历求和, 这样n=+∞, 对无穷多项的求和操作相应的变成积分操作, 并对整个区间长度求均值, 即</p>
                </div>
                <div class="area_img" id="179">
                            <div class="imgformula">
                                <img class="pFormula" alt="" src="Detail/GetImg?filename=images/WXYJ201905014_17900.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY3Zm5LZEo2VXlXemZUQTF2RT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                <p class="formula_seq"></p>
                            </div>

                </div>
                <div class="p1">
                    <p id="180">为了求得<image id="216" type="formula" href="images/WXYJ201905014_21600.jpg" display="inline" placement="inline"><alt></alt></image>取最小值时的δ值, 由式 (7) 得</p>
                </div>
                <div class="area_img" id="181">
                            <div class="imgformula">
                                <img class="pFormula" alt="" src="Detail/GetImg?filename=images/WXYJ201905014_18100.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY3Zm5LZEo2VXlXemZUQTF2RT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                <p class="formula_seq"></p>
                            </div>

                </div>
                <div class="p1">
                    <p id="182">令<image id="217" type="formula" href="images/WXYJ201905014_21700.jpg" display="inline" placement="inline"><alt></alt></image><image id="217" type="formula" href="images/WXYJ201905014_21701.jpg" display="inline" placement="inline"><alt></alt></image><image id="217" type="formula" href="images/WXYJ201905014_21702.jpg" display="inline" placement="inline"><alt></alt></image>即在区间[0, 1) 上利用本文提供的δ值得到的直线y=k+δ来近似表示曲线y=log<sub>2</sub> (1+k) , 能够使均方误差最小, 且最小均方误差值约为0.000 659 753 005 496.</p>
                </div>
                <div class="p1">
                    <p id="186">根据上述δ的值可得<image id="218" type="formula" href="images/WXYJ201905014_21800.jpg" display="inline" placement="inline"><alt></alt></image><image id="218" type="formula" href="images/WXYJ201905014_21801.jpg" display="inline" placement="inline"><alt></alt></image>在FISqrt算法中采用这里所给出的R值, 从理论上可以减小批量数据的平方根倒数初始估计值与精确值之间的均方误差, 从而减小平均误差.由于初始估计更加优化, 因此用该初始估计值进行牛顿迭代后的值也应该表现出更好的精度性能.本文提出的方法在单个数据求平方根倒数上的意义在于能够从更大的概率上获得更加精确的初始估计.</p>
                </div>
                <h3 id="187" name="187" class="anchor-tag">4 结果验证</h3>
                <div class="p1">
                    <p id="188">为了验证所提出的R参数对FISqrt算法平均精度的提升, 本文的实验中采用五组随机生成的浮点数据进行计算, 求解初始估计值以及迭代后的值与标准平方根倒数之间的误差百分比.每组随机数中包含20 000个浮点数, 取值区间为 (50.0, 10 000.0) .精度验证中根据不同的R取值, 求解这20 000个浮点数据的平方根倒数预估值及其一次、两次牛顿迭代后的值, 将计算结果与标准平方根倒数值进行比较, 并计算出平均误差百分比</p>
                </div>
                <div class="area_img" id="189">
                            <div class="imgformula">
                                <img class="pFormula" alt="" src="Detail/GetImg?filename=images/WXYJ201905014_18900.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY3Zm5LZEo2VXlXemZUQTF2RT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                <p class="formula_seq"></p>
                            </div>

                </div>
                <div class="p1">
                    <p id="190">式中, n=20 000;a<sub>i</sub>为实验中计算出的值;y<sub>i</sub>为标准平方根倒数值;即<image id="220" type="formula" href="images/WXYJ201905014_22000.jpg" display="inline" placement="inline"><alt></alt></image>;x<sub>i</sub>为位于区间 (50.0, 10 000.0) 的原始随机浮点数.</p>
                </div>
                <div class="p1">
                    <p id="191">为了实现计算精度比较, 每组数据都针对R的四个不同取值进行计算, 这四个R值分别为:0x5f3759df、0x5f37642f、0x5f375a86、0x5f34ff59, 其中0x5f3759df为原始算法中的数据, 0x5f34ff59为本文提出的数据.0x5f37642f为Lomont C.对算法进行分析得出的数据, 但是Lomont C.通过实验发现这个数据并不比原始的0x5f3759df能获得更好的计算精度, 因此他又通过穷举搜索的方式发现与0x5f37642f邻近的另外一个数0x5f375a86相比于原有的0x5f3759df在计算精度上稍微有改进.关于0x5f37642f和0x5f375a86这两个R常数的详细论述见文献[3].</p>
                </div>
                <div class="p1">
                    <p id="192">图3对初始估计值的平均误差百分比进行了比较, 每个柱状条代表的数值均按照式 (9) 进行计算.从中可以看出本文提出的R参数相比于另外三个R参数将误差百分比减小约三分之一, 且五组计算数据显示了这种优势的稳定性.从实验结果看, 本文提供的R参数计算出的平方根倒数初始估计值与标准的平方根倒数值相比, 平均误差不到1.6%, 由其它三个R参数得到的预估值误差都约为2.3%.</p>
                </div>
                <div class="p1">
                    <p id="193">图4为一次牛顿迭代后的精度百分比对比.本文提供的R参数相比于其它三个R参数将误差百分比降低了超过40%.图5为两次牛顿迭代后的精度百分比对照, 本文提供的R参数同样将误差百分比降低了超过30%, 且两次迭代后的结果与标准的结果相比, 误差仅略高于百万分之一.</p>
                </div>
                <div class="p1">
                    <p id="194">本文提出的R常数对单次计算平方根倒数的意义在于能够从更大的概率上获得一个更加优化的初始估计及其迭代值.图6统计了20 000次计算中本文给出的R值相比于目前使用的R=0x5f3759df的精度优劣占比分布情况, 其中20 000次计算的源数据仍然是位于区间 (50.0, 10 000.0) 中的随机浮点数.从图中可以看出当采用本文的R=0x5f34ff59时, 在20000次计算中占78.62%的初始估计值比R=0x5f3759df拥有更高的精度, 而剩余21.38%的精度不如R=0x5f3759df.经过一次迭代和两次迭代后, R=0x5f34ff59时, 整批数据中仍然分别有78.36%和75.23%精度更优.</p>
                </div>
                <div class="area_img" id="195">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/WXYJ201905014_19500.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY3Zm5LZEo2VXlXemZUQTF2RT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图3 初始估计与精确值的误差百分比" src="Detail/GetImg?filename=images/WXYJ201905014_19500.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY3Zm5LZEo2VXlXemZUQTF2RT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图3 初始估计与精确值的误差百分比  <a class="btn-zoomin" href="Detail/GetImg?filename=images/WXYJ201905014_19500.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY3Zm5LZEo2VXlXemZUQTF2RT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="area_img" id="196">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/WXYJ201905014_19600.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY3Zm5LZEo2VXlXemZUQTF2RT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图4 一次迭代值与精确值的误差百分比" src="Detail/GetImg?filename=images/WXYJ201905014_19600.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY3Zm5LZEo2VXlXemZUQTF2RT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图4 一次迭代值与精确值的误差百分比  <a class="btn-zoomin" href="Detail/GetImg?filename=images/WXYJ201905014_19600.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY3Zm5LZEo2VXlXemZUQTF2RT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="area_img" id="197">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/WXYJ201905014_19700.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY3Zm5LZEo2VXlXemZUQTF2RT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图5 两次迭代值与精确值的误差百分比" src="Detail/GetImg?filename=images/WXYJ201905014_19700.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY3Zm5LZEo2VXlXemZUQTF2RT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图5 两次迭代值与精确值的误差百分比  <a class="btn-zoomin" href="Detail/GetImg?filename=images/WXYJ201905014_19700.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY3Zm5LZEo2VXlXemZUQTF2RT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="p1">
                    <p id="198">这三个比例的平均值超过了77%, 通过这样的一个样本统计可以得出采用本文的R值能够在约77%的概率下获得一个比R=0x5f3759df更加精确的结果.随着迭代次数的增加, 计算的结果会迅速的收敛到平方根倒数的标准值, 这一比例优势会逐渐降低.</p>
                </div>
                <div class="area_img" id="199">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/WXYJ201905014_19900.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY3Zm5LZEo2VXlXemZUQTF2RT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图6 R=0x5f34ff59相比于R=0x5f3759df在计算精度上更优/劣的占比分布" src="Detail/GetImg?filename=images/WXYJ201905014_19900.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY3Zm5LZEo2VXlXemZUQTF2RT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图6 R=0x5f34ff59相比于R=0x5f3759df在计算精度上更优/劣的占比分布  <a class="btn-zoomin" href="Detail/GetImg?filename=images/WXYJ201905014_19900.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY3Zm5LZEo2VXlXemZUQTF2RT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <h3 id="200" name="200" class="anchor-tag">5 FISqrt算法的进一步探讨</h3>
                <div class="p1">
                    <p id="201">由FISqrt算法的原理, 可以进一步考虑计算y=x<sup>p</sup> (x为正浮点数) , 并根据FISqrt算法作类似推导可得E<sub>y</sub>L+M<sub>y</sub>≈ (1-p) (B-δ) L+p (E<sub>x</sub>L+M<sub>x</sub>) , 即I<sub>y</sub>≈R+pI<sub>x</sub>, 这里R= (1-p) (B-δ) L, 同时后续的牛顿迭代也相应的表示为i<sub>n+1</sub>= (1-p) i<sub>n</sub>+pxi<sub>n</sub><sup>1-1/p</sup>.将指数用p表示之后, 当p取某些值时初始估计的计算中pI<sub>x</sub>可能不能用移位运算来实现, 同时后续的牛顿迭代, 特别是i<sub>n</sub><sup>1-1/p</sup>项的计算也会变得很耗时, 从而大大降低了算法的适用性, 但是这种方法的理论意义还是值得保留的.FISqrt算法不仅提供了一种快速计算浮点数平方根倒数的方法, 更重要的是还提供了一种将浮点数据位当作整数进行运算, 从而充分利用浮点格式的思想方法.根据以上叙述, 计算平方根倒数只是p=-1/2的一种特例;如果令p=0, 那么有y=x<sup>0</sup>=1, 另一方面I<sub>y</sub>≈R+pI<sub>x</sub>= (B-δ) L, 将本文的δ值带入得I<sub>y</sub>≈0x3f78aa3b= (0.971 3…) <sub>float</sub>≈x<sup>0</sup>=1, 即I<sub>y</sub>所代表的浮点数与x<sup>0</sup>=1接近, 近似值的计算依然成立.</p>
                </div>
                <div class="p1">
                    <p id="202">该算法的一项约束条件是计算R+pI<sub>x</sub>得到预估值时一定不能改变浮点格式表示中的符号位, 必须保证符号位为0, 算法才能正确运行.例如当p=-1时 (计算x的倒数) , 采用本文给出的δ值可以计算得到R=0x7ef15476, 因此在计算预估初值的时候需要计算i<sub>0</sub>=0x7ef15476-I<sub>x</sub>, 如果某个浮点数x的整数表示形式I<sub>x</sub>&gt;0x7ef15476, 那么将导致i<sub>0</sub>为负数, 而负整数在不同的机器上可能会采用不同的表示形式, 一般最高位的符号位都为1, 后续的牛顿迭代中再将i<sub>0</sub>解释成浮点数已经不能很好的表示x<sup>-1</sup>的初始近似值.不过值得注意的是, 如果I<sub>x</sub>&gt;0x7ef15476, 此时x指数位的值大于等于253, 这样的浮点数虽然存在, 但在一般的应用中也很少见.如果事先明确知道待处理的数据不会出现那么大的数值, 令p=-1, 采用这种方法计算一个数的倒数, 或者进而实现除法计算 (被除数乘以除数的倒数) 也是一种很高效的方法, 甚至在牛顿迭代初值的计算中根本不用移位, 且牛顿迭代的形式也很简单.当然, 计算一个数的倒数也可以将FISqrt算法的计算结果平方后得到, 但是采用前一种方法会更加高效.</p>
                </div>
                <div class="p1">
                    <p id="203">影响算法可靠性的情况还会发生在计算R+pI<sub>x</sub>时由于结果数值过大, 产生了向最高位符号位的进位, 同样会导致计算的失败.在平方根倒数的计算中p=-1/2, 计算预估初值时需要计算i<sub>0</sub>=0x5f34ff59- (I<sub>x</sub>&gt;&gt;1) , 由于0≤ (I<sub>x</sub>&gt;&gt;1) ≤0x3fffffff, 因此0x1f34ff5a≤i<sub>0</sub>≤0x5f34ff59, 对浮点格式中的符号位无影响, 且除去符号位之外的比特位能够有效表示i<sub>0</sub>的数值, 从而保证了算法的可靠执行.再比如当p=1/2时, 需要计算i<sub>0</sub>=0x1fbc551e+ (I<sub>x</sub>&gt;&gt;1) , 从而有0x1fbc551e≤i<sub>0</sub>≤0x5fbc551d, 算法同样能正确执行, 因此这也为求解平方根提供了一种初值获取方法.总之, 如果要将FISqrt算法的思想扩展到计算指幂函数y=x<sup>p</sup>的值 (x为正浮点数) , 需要满足0≤R+pI<sub>x</sub>≤0x7fffffff.</p>
                </div>
                <div class="p1">
                    <p id="204">本文对FISqrt算法的叙述与实验都是以32位单精度为例进行说明的, 但是很明显FISqrt算法不仅限于单精度的浮点数, 对64位, 128位等浮点数同样适用, 只需根据具体的数据表示格式并结合δ计算出R的值即可.</p>
                </div>
                <h3 id="205" name="205" class="anchor-tag">6 结束语</h3>
                <div class="p1">
                    <p id="206">本文从FISqrt算法的原理出发, 探索了一个新的算法常数0x5f34ff59, 能够从统计角度有效提升FISqrt算法的计算精度.本文方法对单个数据的平方根倒数计算的意义在于能够从更大的概率上获得一个比现有方法更加精确的计算结果.文中对所提出的方法提供了完整的理论支持和实验验证, 最后对FISqrt算法的应用作了进一步讨论.</p>
                </div>

        <!--brief end-->
        
        <!--conten left  end-->
        <!--增强附件-->
        

        <!--reference start-->
            <div class="reference anchor-tag" id="a_bibliography">
                    <h3>参考文献</h3>
                                        <p id="221">
                            <a id="bibliography_1" target="_blank" href="http://scholar.cnki.net/result.aspx?q=IEEE Standard for Floating-Point Arithmetic">

                                <b>[1]</b> IEEE Computer Society.IEEE Standard 754-2008:IEEE Standard for Floating-Point Arithmetic[S].New York:IEEE, 2008.
                            </a>
                        </p>
                        <p id="223">
                            <a id="bibliography_2" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Origin of quake3&amp;#39;&amp;#39;s fast InvSqrt (),Beyond3D">

                                <b>[2]</b> SOMMEFELDT R.Origin of quake3's fast InvSqrt () , Beyond3D[EB/OL]. (2006-11-29) .[2018-09-03].http://www.beyond3d.com/content/articles/8/
                            </a>
                        </p>
                        <p id="225">
                            <a id="bibliography_3" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Fast inverse square root">

                                <b>[3]</b> LOMONT C.Fast inverse square root[R].West Lafayette:Purdue University, Department of Mathematics, 2003.
                            </a>
                        </p>
                        <p id="227">
                            <a id="bibliography_4" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Internet Streaming SIMD Extensions">

                                <b>[4]</b> THAKKAR S, HUFF T.Internet streaming SIMD extensions[J].Computer, 1999, 32 (12) :26-34.
                            </a>
                        </p>
                        <p id="229">
                            <a id="bibliography_5" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Implementing Streaming SIMD Extensions on the Pentium III Processor">

                                <b>[5]</b> RAMAN S K, PENTKOVSKI V, KESHAVA J.Implementing streaming SIMD Extensions on the pentium III processor[J].IEEE Micro, 2002, 20 (4) :47-57.
                            </a>
                        </p>
                        <p id="231">
                            <a id="bibliography_6" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Reciprocation, Square Root, Inverse Square Root, and Some Elementary Functions Using Small Multipliers">

                                <b>[6]</b> ERCEGOVAC M D, LANG T, MULLER J M, et al.Reciprocation, square root, inverse square root, and some elementary functions using small multipliers[J].IEEE Transactions on Computers, 1998, 49 (7) :628-637.
                            </a>
                        </p>
                        <p id="233">
                            <a id="bibliography_7" target="_blank" href="http://scholar.cnki.net/result.aspx?q=A hardware algorithm for computing reciprocal square root">

                                <b>[7]</b> TAKAGI N.A hardware algorithm for computing reciprocal square root[C]//Proceedings 15th IEEE Symposium on Computer Arithmetic (ARITH-15) .Vail, Colorado:IEEE, 2001:94-100.
                            </a>
                        </p>
                        <p id="235">
                            <a id="bibliography_8" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Hardware architecture design and mapping of fast inverse square root algorithm">

                                <b>[8]</b> ZAFAR S, ADAPA R.Hardware architecture design and mapping of fast inverse square root algorithm[C]//IEEE International Conference on Advances in Electrical Engineering (ICAEE) . Vellore, India:IEEE, 2014:1-4.
                            </a>
                        </p>
                        <p id="237">
                            <a id="bibliography_9" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Reconfigurable instruction-based multicore parallel convolution and its application in real-time template matching">

                                <b>[9]</b> ZHOU Q, YANG L, YAN X.Reconfigurable instruction-based multicore parallel convolution and its application in real-time template matching[J].IEEE Transactions on Computers, doi:10.1109/TC.2018.2844351.
                            </a>
                        </p>
            </div>
        <!--reference end-->
        <!--footnote start-->
        <!--footnote end-->



    </div>

        <input id="fileid" type="hidden" value="WXYJ201905014" />
        <input id="dpi" type="hidden" value="300" />
    </div>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?6e967eb120601ea41b9d312166416aa6";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
</script>

    


<input id="hid_uid" name="hid_uid" type="hidden" value="WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY3Zm5LZEo2VXlXemZUQTF2RT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
<input id="hid_kLogin_headerUrl" name="hid_kLogin_headerUrl" type="hidden" value="/KLogin/Request/GetKHeader.ashx%3Fcallback%3D%3F" />
<input id="hid_kLogin_footerUrl" name="hid_kLogin_footerUrl" type="hidden" value="/KLogin/Request/GetKFooter.ashx%3Fcallback%3D%3F" />
<div class="btn-link" style="display: none"><a target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=WXYJ201905014&amp;v=MDIzMDg2ajU0TzN6cXFCdEdGckNVUkxPZVplVnVGeWptVzcvTk1qWFNaTEc0SDlqTXFvOUVZSVFLREg4NHZSNFQ=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY3Zm5LZEo2VXlXemZUQTF2RT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">知网节</a></div>
<div class="popflow" id="popupTips" style="display: none;">
    <div class="popflowArr"></div>
    <div class="popflowCot">
        <div class="hd"><a href="javascript:void(0);" onclick="$('#popupTips').hide();$('#popupmsg').html('')" class="close">X</a></div>
        <div class="bd">
            <p class="mes" id="popupmsg" name="popupmsg"></p>
          
        </div>
    </div>
</div>
<input type="hidden" id="myexport" value="//kns.cnki.net" />

<input type="hidden" id="KPCAPIPATH" value="//ishufang.cnki.net" />
<input type="hidden" id="CitedTimes" value="" />
<div class="link" id="GLSearch" style="display: none;">
    <i class="icon-trangle"></i>
    <div class="inner">
        <a class="icon" id="copytext">复制</a>
        <a class="icon" target="_blank" onclick="searchCRFD(this)">工具书搜索</a>
    </div>
</div>




<input id="hidVirtualPath" name="hidVirtualPath" type="hidden" value="/kxreader" />
<script src="/kxreader/bundles/detail?v=-ULdk-c6FkZHtJA2KAXPgHnyA8mtgyPnBde_C2VZ2BY1"></script>

<script src="/kxreader/Scripts/layer.min.js" type="text/javascript"></script>

<div id="footerBox" class="rootw footer">
</div>
<script>
    if (typeof FlushLogin == 'function') {
        FlushLogin();
    }
    modifyEcpHeader(true);
</script>

<!--图片放大功能 start-->
<script src="/kxreader/bundles/imagebox?v=W4phPu9SNkGcuPeJclikuVE3PpRyIW_gnfjm_19nynI1"></script>

<script type="text/javascript">
    $(function () {
        var j = $.noConflict();
        j(function () {
            j(".zoom-in,.btn-zoomin").imgbox({
                'alignment': 'center',
                'allowMultiple': false,
                'overlayShow': true
            });
        })
    });
</script>
<!--图片放大功能 end-->
<div class="fixedbar">
    <div class="backtop hiddenV" id="backtop">
        <a id="backTopSide" href="javascript:scroll(0,0);" title=""></a>
    </div>
</div>
<script type="text/javascript" src="/kxreader/Scripts/MathJax-2.6-latest/MathJax.js?config=MML_HTMLorMML-full"></script>

</body>
</html>
