<!DOCTYPE html>
<html>
<head>
    <title>全文阅读--XML全文阅读--中国知网</title>
    <link rel="icon" href="/kxreader/favicon.ico" />
    <link rel="shortcut Icon" href="/kxreader/favicon.ico" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="keywords" content="文献 XML KBASE CNKI 中国知网" />
    <meta name="description" content="XML文献检索" />
    <link href="/kxreader/Content/css/detail?v=qX2z2KjRAEyQiNfAbKtl7dLnsqFoQ5Jdw3TZfDf0n1k1" rel="stylesheet"/>

    <script type="text/javascript">
        var APPPATH = '/kxreader';
    </script>
</head>

<body>
    
<script type="text/javascript" src="//login.cnki.net/TopLogin/api/loginapi/get?type=top&amp;localCSS=&amp;returnurl=%2f%2fkns.cnki.net%2f%2fKXReader%2fDetail%3fTIMESTAMP%3d637133864130100000%26DBCODE%3dCJFD%26TABLEName%3dCJFDLAST2019%26FileName%3dWXYJ201907004%26RESULT%3d1%26SIGN%3dNrS1819T3KYQ%252fk0SuKmGS%252fo0H3o%253d"></script>

<div id="headerBox" class="header">
    <div class="topbar">
        <div class="textalign">
            <a href="/kxreader/Detail?dbcode=CJFD&amp;filename=WXYJ201907004&amp;align=md">
                <i class="icon-cen active" title="居中对齐"></i>
            </a>
            <a href="/kxreader/Detail?dbcode=CJFD&amp;filename=WXYJ201907004&amp;align=lt">
                <i class="icon-left " title="左对齐"></i>
            </a>
        </div>
        <h6 class="free-tip"><i class="icon"></i>HTML阅读开放试用阶段，欢迎体验！</h6>
    </div>
</div>

    



<div class="btn-link" style="display: none"><a target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=WXYJ201907004&amp;v=MjAxNTBWdUZ5bmhVYjNOTWpYU1pMRzRIOWpNcUk5RllJUUtESDg0dlI0VDZqNTRPM3pxcUJ0R0ZyQ1VSTE9lWmU=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">知网节</a></div>

    <div class="main">

        

    <div class="sidebar-a">
        <!--sidebar start-->
        <div class="sidenav">
            <div class="arrow"><span></span></div>
            <!--sidebar_list start-->
            <dl class="sidenav-list">
                    <dt class="tit">目录结构</dt>
                            <dd class="guide">
                                    <p><a href="#1" data-title="1 引言 ">1 引言</a><i></i></p>
                                                            </dd>
                            <dd class="guide">
                                    <p><a href="#3" data-title="2 PCIe总线介绍 ">2 PCIe总线介绍</a><i></i></p>
                                                            </dd>
                            <dd class="guide">
                                    <p><a href="#11" data-title="3 设计方案 ">3 设计方案</a><i></i></p>
                                                                    <ul class="contentbox">
                                                <li><a href="#12" data-title="3.1 整体结构设计">3.1 整体结构设计</a></li>
                                                <li><a href="#22" data-title="3.2 接口子模块的设计">3.2 接口子模块的设计</a></li>
                                                <li><a href="#38" data-title="3.3 可编程性设计">3.3 可编程性设计</a></li>
                                                <li><a href="#40" data-title="3.4 应用于FPGA的代码规范">3.4 应用于FPGA的代码规范</a></li>
                                    </ul>
                            </dd>
                            <dd class="guide">
                                    <p><a href="#42" data-title="4 实验结果验证 ">4 实验结果验证</a><i></i></p>
                                                                    <ul class="contentbox">
                                                <li><a href="#46" data-title="4.1 链路训练">4.1 链路训练</a></li>
                                                <li><a href="#49" data-title="4.2 数据传输">4.2 数据传输</a></li>
                                    </ul>
                            </dd>
                            <dd class="guide">
                                    <p><a href="#51" data-title="5 结束语 ">5 结束语</a><i></i></p>
                                                            </dd>
                            <dd class="guide">
                                    <p><a href="#" data-title="文内图表 ">文内图表</a><i></i></p>
                                                                    <ul class="contentbox">
                                                <li><a href="#5" data-title="图1 PCIe分层结构图">图1 PCIe分层结构图</a></li>
                                                <li><a href="#14" data-title="图2 PCIe模块整体结构图">图2 PCIe模块整体结构图</a></li>
                                                <li><a href="#18" data-title="图3 pcie hard ctrl结构图">图3 pcie hard ctrl结构图</a></li>
                                                <li><a href="#28" data-title="图4 Axis＿master＿adapter的状态机">图4 Axis＿master＿adapter的状态机</a></li>
                                                <li><a href="#36" data-title="图5 Axis＿bypass＿adapter的状态机">图5 Axis＿bypass＿adapter的状态机</a></li>
                                                <li><a href="#44" data-title="图6 验证环境整体结构图">图6 验证环境整体结构图</a></li>
                                                <li><a href="#48" data-title="图7 Gen2链路定向的验证波形">图7 Gen2链路定向的验证波形</a></li>
                                    </ul>
                            </dd>
                                    <dd class="guide">
                                        <h6>
                                            <p><a href="#a_bibliography">参考文献</a> </p>
                                        </h6>
                                    </dd>

            </dl>
        </div>
        <!--sidebar end-->
        &nbsp;
        <!--此处有一空格符 勿删-->
    </div>

                <div class="sidebar-b three-collumn" style="width:0;">
            <div class="refer" style="width: 0;">
                <div class="arrow off" title="参考文献"><span></span></div>
                <div class="js-scrollbox" >
                    
                    <div class="subbox active">
                        <h4>
                            <span class="tit">参考文献</span>
                            <a class="close" href="javascript:void(0)">x</a>
                        </h4>
                        <div class="side-scroller">
                            <ul class="refer-list">
                                <li id="53">


                                    <a id="bibliography_1" title="王帅, 李念强, 许惠翔.基于Altera IP核的FPGAPCIE接口设计[J].工业控制计算机, 2017, 30 (2) :41-42." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=GYKJ201702020&amp;v=MDQ5NTMzenFxQnRHRnJDVVJMT2VaZVZ1RnluaFViM05JalRBWkxHNEg5Yk1yWTlIWklRS0RIODR2UjRUNmo1NE8=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[1]</b>
                                        王帅, 李念强, 许惠翔.基于Altera IP核的FPGAPCIE接口设计[J].工业控制计算机, 2017, 30 (2) :41-42.
                                    </a>
                                </li>
                                <li id="55">


                                    <a id="bibliography_2" title="张锐, 曹彦荣.基于FPGA的PCIE总线接口设计[J].硅谷, 2014 (7) :29-31." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=GGYT201407037&amp;v=MjgwNDY0VDZqNTRPM3pxcUJ0R0ZyQ1VSTE9lWmVWdUZ5bmhVYjNOSWlyU2VyRzRIOVhNcUk5R1k0UUtESDg0dlI=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[2]</b>
                                        张锐, 曹彦荣.基于FPGA的PCIE总线接口设计[J].硅谷, 2014 (7) :29-31.
                                    </a>
                                </li>
                                <li id="57">


                                    <a id="bibliography_3" title="陈致远.高速USB误码率的测试及研究[D].上海:复旦大学, 2009." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CMFD&amp;filename=2010058894.nh&amp;v=MTM1MTBuRnE1RWJQSVFLREg4NHZSNFQ2ajU0TzN6cXFCdEdGckNVUkxPZVplVnVGeW5oVWIzTlYxMjZIck85RnQ=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[3]</b>
                                        陈致远.高速USB误码率的测试及研究[D].上海:复旦大学, 2009.
                                    </a>
                                </li>
                                <li id="59">


                                    <a id="bibliography_4" title="SHIN J L, HUANG DAWEI, PETRICK B, et al.A40nm 16Core 128-Thread SPARC SoC[J].IEEEJournal of Solid-State Circuits, 2011, 46 (1) :131-144." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=A40nm 16Core 128-Thread SPARC SoC">
                                        <b>[4]</b>
                                        SHIN J L, HUANG DAWEI, PETRICK B, et al.A40nm 16Core 128-Thread SPARC SoC[J].IEEEJournal of Solid-State Circuits, 2011, 46 (1) :131-144.
                                    </a>
                                </li>
                                <li id="61">


                                    <a id="bibliography_5" title="马萍, 唐卫华, 李绪志.基于PCIe的高速数据传输系统研究与开发[J].计算机测量与控制, 2009, 17 (1) :2555-2557." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JZCK200912067&amp;v=MTMwNjZPZVplVnVGeW5oVWIzTkx6ZklaYkc0SHRqTnJZOURZNFFLREg4NHZSNFQ2ajU0TzN6cXFCdEdGckNVUkw=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[5]</b>
                                        马萍, 唐卫华, 李绪志.基于PCIe的高速数据传输系统研究与开发[J].计算机测量与控制, 2009, 17 (1) :2555-2557.
                                    </a>
                                </li>
                                <li id="63">


                                    <a id="bibliography_6" title="KEVIN PARRISH.PCIe for mobile launched;PCIe3.1, 4.0specs revealed[EB/OL]. (2013-06-28) .[2014-07-10].https://www.tomshardware.co.uk/M-PCIe-M.2-PCIe-3.1-PCIe-4.0-OCuLink, news-44639.html." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=PCIe for mobile launched;PCIe3.1,4.0specs revealed">
                                        <b>[6]</b>
                                        KEVIN PARRISH.PCIe for mobile launched;PCIe3.1, 4.0specs revealed[EB/OL]. (2013-06-28) .[2014-07-10].https://www.tomshardware.co.uk/M-PCIe-M.2-PCIe-3.1-PCIe-4.0-OCuLink, news-44639.html.
                                    </a>
                                </li>
                                <li id="65">


                                    <a id="bibliography_7" title="武桂林.PCIe2.0 MAC层数据通路与PCS层设计[D].合肥:中国科学技术大学, 2016." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CMFD&amp;filename=1016109653.nh&amp;v=MzE3ODRSTE9lWmVWdUZ5bmhVYjNOVkYyNkdMSzRGOWZKckpFYlBJUUtESDg0dlI0VDZqNTRPM3pxcUJ0R0ZyQ1U=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[7]</b>
                                        武桂林.PCIe2.0 MAC层数据通路与PCS层设计[D].合肥:中国科学技术大学, 2016.
                                    </a>
                                </li>
                                <li id="67">


                                    <a id="bibliography_8" title="LI H, LIU Y A, YUAN D M, et al.A wrapper of PCI express with FIFO interfaces based on FPGA[C]//ICICEE 2012.Xi′an, China, 2012, 145:525-529." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=A Wrapper of PCI Express with FIFO Interfaces based on FPGA">
                                        <b>[8]</b>
                                        LI H, LIU Y A, YUAN D M, et al.A wrapper of PCI express with FIFO interfaces based on FPGA[C]//ICICEE 2012.Xi′an, China, 2012, 145:525-529.
                                    </a>
                                </li>
                            </ul>
                            <div style='display: none;' class="zqscroller" >
                                <h4 class="">附加材料</h4>
                                <ul></ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            &nbsp;
            <!--此处有一空格符 勿删-->
        </div>

        
    <div class="content">



        <!--tips start-->
                            <div class="tips">
                    <a href="http://navi.cnki.net/KNavi/JournalDetail?pcode=CJFD&amp;pykm=WXYJ" target="_blank">微电子学与计算机</a>
                2019,36(07),17-21             </div>
        <!--tips end-->
            <div class="top-title">
                <h1 class="title">
                    <span class="vm">应用于FPGA的PCIe接口设计与验证</span>
                                    </h1>

            </div>
                        <h2>
                                <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=au&amp;skey=%E5%91%A8%E5%A5%87&amp;code=08554671&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">周奇</a>
                                <a href="javascript:;">宣学雷</a>
                                <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=au&amp;skey=%E8%B4%BA%E5%85%89%E8%BE%89&amp;code=30484917&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">贺光辉</a>
                </h2>
                    <h2>
                    <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=in&amp;skey=%E4%B8%8A%E6%B5%B7%E4%BA%A4%E9%80%9A%E5%A4%A7%E5%AD%A6%E7%94%B5%E5%AD%90%E4%BF%A1%E6%81%AF%E4%B8%8E%E7%94%B5%E6%B0%94%E5%B7%A5%E7%A8%8B%E5%AD%A6%E9%99%A2&amp;code=0054402&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">上海交通大学电子信息与电气工程学院</a>
                    <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=in&amp;skey=%E6%B7%B1%E5%9C%B3%E5%B8%82%E7%B4%AB%E5%85%89%E5%90%8C%E5%88%9B%E7%94%B5%E5%AD%90%E6%9C%89%E9%99%90%E5%85%AC%E5%8F%B8%E4%B8%8A%E6%B5%B7%E5%88%86%E5%85%AC%E5%8F%B8&amp;code=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">深圳市紫光同创电子有限公司上海分公司</a>
            </h2>

        
<div class="link">
    <a id="aexport" class="icon icon-output"  onclick="" href="javascript:void(0);"><i></i>导出/参考文献</a>
    
    <span class="shareBoard" onmouseover="$('#sharedet').show();$('#this').addClass('shareBoardCUR')" onmouseout="$('#sharedet').hide();$('#this').removeClass('shareBoardCUR')">
        <a class="icon icon-share" href="#"><i></i>分享<em></em></a>
        <ul class="shareHide" id="sharedet" style="display: none;">
            <li><a title="复制链接" class="copy" onclick="" href="#"><i></i>复制链接</a></li>
            <li><a title="分享到新浪微博" class="xl" onclick="" href="javascript:common.ShareAction('xl');"><i></i>新浪微博</a></li>
            <li>
                <a title="分享到微信" class="wx" onclick="" href="#"><i></i>微信扫一扫</a>
                <div class="qrcode"><img src='' alt='' /></div>
            </li>
        </ul>

    </span>
    
    <a id="RefTrack" title="创建引文跟踪" class="icon icon-track" onclick="" href="javascript:void(0);"> <i></i>创建引文跟踪 </a>
    <a id="ashoucang" title="收藏" class="icon icon-favor" onclick="" href="javascript:void(0);"><i></i>收藏</a>
    <a class="icon icon-print" onclick="window.print();" href="javascript:void(0);"><i></i>打印</a>
    
    <!--版本切换 end-->
</div>
                            <div class="data" id="a_abstract">
                <span class="keys">摘<span style="font-family: 'Times New Roman';">&nbsp;&nbsp;&nbsp;&nbsp;</span>要：</span>
                <p>根据PCIe协议, 介绍了PCIe总线的基本结构.在此基础上, 设计了一种可应用于FPGA的PCIe接口, 并根据实际用户需求, 完成接口转换, 同时, 采用可编程性设计方便使用者对接口进行快速配置, 介绍了应用于FPGA的功能代码规范.最后, 基于UVM搭建验证平台, 完成了对PCIe的验证, 最终该PCIe接口被应用于FPGA上.</p>
            </div>
                    <div class="data" id="a_keywords">
                <span class="keys">关键词：</span>
                <p>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=PCIe%E6%80%BB%E7%BA%BF&amp;code=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">PCIe总线;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=FPGA&amp;code=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">FPGA;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=%E9%AA%8C%E8%AF%81&amp;code=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">验证;</a>
                </p>
            </div>
        
        <!--brief start-->
        
            <div class="brief">
                    <p>
                            <b>作者简介：</b>
                                                        <span>
                                    周奇 女, (1994-) , 硕士研究生.研究方向为数字与系统芯片、集成电路设计.E-mail:15201888173@126.com.;
                                </span>
                                <span>
                                    宣学雷 男, (1978-) , 硕士, 工程师.研究方向为芯片设计.;
                                </span>
                                <span>
                                    贺光辉 男, (1980-) , 博士, 副研究员.研究方向为通信系统、VLSI等.;
                                </span>
                    </p>
                                    <p><b>收稿日期：</b>2018-11-04</p>

            </div>
                    <h1>Design and verification of PCIE interface for FPGA</h1>
                    <h2>
                    <span>ZHOU Qi</span>
                    <span>XUAN Xue-lei</span>
                    <span>HE Guang-hui</span>
            </h2>
                    <h2>
                    <span>School of Electronic Information and Electrical Engineering, Shanghai Jiao Tong University</span>
                    <span>Shenzhen Pango Microsystems Co.LTD</span>
            </h2>
                            <div class="data" id="a_abstractEN">
                <span class="keys">Abstract：</span>
                <p>According to the PCIe protocol, the basic structure of the PCIe bus is introduced.On this basis, a PCIE interface that can be applied to the FPGA is designed, and the interface conversion is completed according to the actual user requirements.At the same time, the programmability design is convenient for the user to quickly configure the interface, and the functions applied to the FPGA are introduced.Code specification.Finally, based on the UVM build verification platform, the PCIE verification is completed, and finally the PCIe interface is applied to the FPGA.</p>
            </div>
                    <div class="data" id="a_keywordsEN">
                <span class="keys">Keyword：</span>
                <p>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=PCIe%20bus&amp;code=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">PCIe bus;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=FPGA&amp;code=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">FPGA;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=verification&amp;code=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">verification;</a>
                </p>
            </div>
                    <div class="brief">
                
                    <p>
                                            </p>
                                    <p><b>Received：</b> 2018-11-04</p>
                            </div>


        <!--brief start-->
                        <h3 id="1" name="1" class="anchor-tag">1 引言</h3>
                <div class="p1">
                    <p id="2">随着对计算机数据传输速度的要求提高, PCI已无法满足大量高带宽的并行读写需求, 制约了计算机的性能提高.英特尔公司在2001年提出用于取代PCI等内部总线的第三代I/O总线技术-PCIe (Peripheral Component Interconnection Express) 总线技术<citation id="69" type="reference"><link href="53" rel="bibliography" /><sup>[<a class="sup">1</a>]</sup></citation>.PCIe是一种全新的总线规范, 有着点对点串行连接方式<citation id="70" type="reference"><link href="55" rel="bibliography" /><sup>[<a class="sup">2</a>]</sup></citation>, 这种方式意味着在数据传输方面, 每一个PCIe设备都拥有自己独立的通道, 从而不影响其他设备之间数据并发传输<citation id="71" type="reference"><link href="57" rel="bibliography" /><sup>[<a class="sup">3</a>]</sup></citation>, 有效提升了计算机整体性能.FPGA作为一种新型的可编程逻辑器, 是重要的数字芯片的设计与验证手段, 因其灵活性和可定制性被广泛应用<citation id="72" type="reference"><link href="59" rel="bibliography" /><sup>[<a class="sup">4</a>]</sup></citation>.</p>
                </div>
                <h3 id="3" name="3" class="anchor-tag">2 PCIe总线介绍</h3>
                <div class="p1">
                    <p id="4">PCIe总线协议采取了传输分层结构的设计方式, 从上到下可分为四层, 分别是设备核心的应用层, 事务层 (Transaction Layer) , 数据链路层 (Data Link Layer) 和物理层 (Physical Layer) .如图1, 在设备与设备之间的数据传输方式为串行, 每一个设备在垂直方向上又分为发送部分和接收部分.发送部分负责处理本设备的信号并发送给其他设备, 接收部分负责处理从其他设备传送到本设备的信号<citation id="73" type="reference"><link href="61" rel="bibliography" /><sup>[<a class="sup">5</a>]</sup></citation>.</p>
                </div>
                <div class="area_img" id="5">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/WXYJ201907004_00500.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图1 PCIe分层结构图" src="Detail/GetImg?filename=images/WXYJ201907004_00500.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图1 PCIe分层结构图  <a class="btn-zoomin" href="Detail/GetImg?filename=images/WXYJ201907004_00500.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="p1">
                    <p id="6">发送部分中, 来自应用层的信息通过应用层接口传到事务层, 并在事务层中形成事务层包 (TLP) , 然后进入到数据链路层, 在原始数据中添加纠错码等附加信息, 包装成数据链路层包 (DLLP) , 然后, 事务层包和数据链路层包进入到物理层, 物理层根据不同的包的类型分别处理, 进行编码, 最后再由物理层的底层模拟部分将信号通过差分电路发送到接收设备.</p>
                </div>
                <div class="p1">
                    <p id="7">接收设备的接收部分在物理层接收到信号, 再通过模拟部分把电路信号转化为数字信号, 再将串行信号转化为并行信号, 进行解码等过程后, 再发送到数据链路层, 数据链路层对数据链路层包进行检错, 解析, 没有错误的事务层包再被转发到事务层, 事务层再对事务层包进行解析, 将有效信息转码成可以被应用处理的信息, 通过应用层接口传到应用层中, 由设备核心对信号进行处理与回应<citation id="74" type="reference"><link href="63" rel="bibliography" /><link href="65" rel="bibliography" /><sup>[<a class="sup">6</a>,<a class="sup">7</a>]</sup></citation>.</p>
                </div>
                <div class="p1">
                    <p id="8">应用层主要用于实现设备的一些核心的功能, 由以太网控制器、USB控制器等组成, 能够提供生成事务层包所必须的信息, 包括要发送的事务类型、数据、流量类别、地址等等.同时, 也负责实现接收事务层发送回来的这些信息.</p>
                </div>
                <div class="p1">
                    <p id="9">事务层的主要功能是生成和解析事务层包.事务层包用于传达事务, 如读取和写入, 以及其他某些类型的事件.事务层还负责对事务层包的信用流量进行控制.每个请求事务层包都需要一个响应事务层包, 每个数据包都有一个唯一的标识符, 可以使响应数据包能够定向到正确的始发者.数据包格式支持不同形式的寻址, 具体取决于事务类型 (内存, I/O, 配置和消息) .事务层可以支持存储器地址空间、IO地址空间、配置地址空间和消息空间这四种地址空间.其中, 消息空间被用来支持如中断、电源管理请求等边带信号.</p>
                </div>
                <div class="p1">
                    <p id="10">数据链路层的主要功能是链路管理和数据完整性, 数据完整性包括错误检测和纠错.数据链路层的发送端接受事务层组装的TLP, 计算并应用数据保护代码和TLP序列号, 并将其提交给通过链路传输的物理层.接收数据链路层负责检查接收到的TLP的完整性并将它们提交给事务层进行进一步处理.在检测到TLP错误时, 该层负责请求重新发送TLP, 直到信息被正确接收, 或链路被确定接收信息失败<citation id="75" type="reference"><link href="67" rel="bibliography" /><sup>[<a class="sup">8</a>]</sup></citation>.</p>
                </div>
                <h3 id="11" name="11" class="anchor-tag">3 设计方案</h3>
                <h4 class="anchor-tag" id="12" name="12">3.1 整体结构设计</h4>
                <div class="p1">
                    <p id="13">根据PCIe协议的分层结构, PCIe可分为事务层、数据链路层和物理层, 其中物理层又可分为逻辑物理层和电气物理层.整个PCIe模块设计如图2所示.</p>
                </div>
                <div class="area_img" id="14">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/WXYJ201907004_01400.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图2 PCIe模块整体结构图" src="Detail/GetImg?filename=images/WXYJ201907004_01400.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图2 PCIe模块整体结构图  <a class="btn-zoomin" href="Detail/GetImg?filename=images/WXYJ201907004_01400.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="p1">
                    <p id="15">其中, pgl＿pcie＿phy模块通过在pgl＿hsst模块的基础上增加pipe＿wrap模块软逻辑来实现.pcie＿ctrl＿hard模块通过pipe接口和pgl＿pcie＿phy模块结合在一起形成完整的IP.</p>
                </div>
                <div class="p1">
                    <p id="16">pcie＿ctrl＿hard模块用硬核的方式实现了部分TL层, 全部DLL和全部MAC功能, 具体结构如图3.其中, 模块DWC PCIe controller是Synopsys DW生成的IP核, 模块Axis＿master＿adapter主要功能为把Receive Request Interface接收的接口转换到AXI stream接口, 模块Axis bypass adapter主要功能为把Receive Bypass Interface的接口转换到AXI stream接口, 模块Axis＿slave＿adapter主要功能为把基于AXI stream的发送接口转换到DWC PCIe Controller的XALI0/1/2接口, 模块pcie＿clk＿rst包括整个pcie＿hard＿ctrl的时钟复位控制.</p>
                </div>
                <div class="p1">
                    <p id="17">主要接口包括:用于TLP收发的128bit AXI Steaming接口, 用于访问内部寄存器的DBI接口, 用于访问用户寄存器的ELBI接口, EP模式下用于MSI发送的接口, EP模式下用于MSIX发送的接口, 用于系统控制和debug的SII接口.其中AXI Streaming interface包括接收方向的Axis＿master和Axis＿bypass和三个发送方向的Axis＿slave.</p>
                </div>
                <div class="area_img" id="18">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/WXYJ201907004_01800.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图3 pcie hard ctrl结构图" src="Detail/GetImg?filename=images/WXYJ201907004_01800.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图3 pcie hard ctrl结构图  <a class="btn-zoomin" href="Detail/GetImg?filename=images/WXYJ201907004_01800.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="p1">
                    <p id="19">本文设计的PCIe模块支持以下两种典型应用:</p>
                </div>
                <div class="p1">
                    <p id="20"> (1) 只有一个Axis＿slave接口被使能的情景, 在这种情境下, 其他两个Axis＿slave不被使用, 在Axis＿slave0端口进行User logic读写请求及完成包的接收, 其优点是和User logic的接口最简.</p>
                </div>
                <div class="p1">
                    <p id="21"> (2) 使能了pcie＿ctrl＿hard中的DMA功能, .在这种情境下, 三个Axis＿slave都被使能, 其中, Axis＿slave0接收完成包, Axis＿slave1接收非报告性事务, Axis＿slave2接收报告性事务, 用来批量地异步数据传输.</p>
                </div>
                <h4 class="anchor-tag" id="22" name="22">3.2 接口子模块的设计</h4>
                <div class="p1">
                    <p id="23">在与用户层连接的过程中设计使用AXI stream接口, 因此针对发送和接收存储器读写请求、IO读写请求、配置请求以及作为完成者对请求做出响应、设计了Axis＿master＿adapter、Axis＿bypass＿adapter、Axis＿slave＿adapter模块.</p>
                </div>
                <h4 class="anchor-tag" id="76" name="76">3.2.1 Axis＿master＿adapter</h4>
                <div class="p1">
                    <p id="25">Aaxis＿master＿adapter的模块主要功能是接收Bar-matched存储器、IO请求和消息, 以及Vendor defined message, 把DWC PCIe controller trgt1接口解析出来的TLP Head信息和数据重组入128bt的axis＿master＿tdata., 实现从TRGT接口到AXIS stream接口的转换.</p>
                </div>
                <div class="p1">
                    <p id="26">在TRGT接口, 输入TLP包的相关信号, 例如radm＿trgt1＿dv表示数据是否有效, radm＿trgt1＿dwen, radm＿trgt1＿fmt, radm＿trgt1＿type, radm＿trgt1＿tc, radm＿trgt1＿attr等表示TLP的头 (header) 部分数据.即数据从事务层通过TRGT接口传到Axis＿master＿adapter模块.</p>
                </div>
                <div class="p1">
                    <p id="27">在Axis＿master＿adapter中, 定义了一个状态机, 如图4.定义状态分别为HEAD1, HEAD2, DA-TA, NOP.在HEAD1状态中, 进行prefix TLP的读取.在HEAD2状态中, 进行TLP头的读取.在DATA状态中, 进行TLP数据部分的读取.在NOP状态中, 则输出为0.</p>
                </div>
                <div class="area_img" id="28">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/WXYJ201907004_02800.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图4 Axis＿master＿adapter的状态机" src="Detail/GetImg?filename=images/WXYJ201907004_02800.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图4 Axis＿master＿adapter的状态机  <a class="btn-zoomin" href="Detail/GetImg?filename=images/WXYJ201907004_02800.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="p1">
                    <p id="29">当复位后, 状态机初始状态为HEAD1, 在此状态中, 当radm＿trgt1＿hv=1且data＿in＿ready=1时, 即当TLP数据头有效且允许数据输入时, 再判断radm＿trgt1＿tlp＿prfx＿w[7:5]是否为0, 如果不为0, 则表示此TLP是一个prefix TLP或者为数据的头, 此时进入到HEAD2状态, 否则如果radm＿trgt1＿dv=1, 即TLP数据有效, 进入到DATA状态;如果以上两种都不满足, 则进入到NOP状态.在HEAD2状态中, 首先判断data＿in＿ready是否为1, 如果允许数据输入并且此时radm＿trgt1＿dv=1, 则进入DATA状态, 否则进入到NOP状态.在DA-TA状态中, 判断TLP是否数据有效, 结尾有效并且此时允许数据输入, 如果上述条件成立, 下一状态为HEAD1状态.NOP状态的下一状态也为HEAD1状态.</p>
                </div>
                <h4 class="anchor-tag" id="77" name="77">3.2.2 Axis＿bypass＿adapter</h4>
                <div class="p1">
                    <p id="31">Axis＿bypass＿adapter的模块主要功能是接收Completion, 与前面的axis＿master＿adapter类似, 主要区别为该模块内部对接Receive Bypass Interface (RBYP) 接口, 用于接收Completion, 且该AXI stream接口不带＿ready的信号, 不支持throttling.可选择完成包前缀数据 (Completion prefix) 通过复用debug＿info＿mux输出, 完成包的头信息 (Completion header information) 从axis＿bypass＿tuser输出, 可选择的完成包数据 (Completion data) 从axis＿bypass＿tdata输出.</p>
                </div>
                <h4 class="anchor-tag" id="78" name="78">3.2.3 Axis＿bypass＿adapter</h4>
                <div class="p1">
                    <p id="33">Axis＿slave＿adapter模块的主要功能包括解析User侧的128bit TLP的描述和数据部分, 按照XALI0的接口要求发送给DWC PCIe controller.在本次设计中, 例化了3个slave接口, 分别为XA-LI0、XALI1、XALI2.其中, XALI0接口 (Axis＿slave0＿adapter) 接收完成包, XALI1 (Axis＿slave1＿adapter) 接收非报告性事务, XALI2 (Axis＿slave2＿adapter) 接收报告性事务.</p>
                </div>
                <div class="p1">
                    <p id="34">和接收方向的axis＿master＿adapter一样, 发送方向的AXI stream接口上, TLP prefix, TLP header信息都作为单独的一个beat传输, TLP data作为单独的一个或者多个beat进行传输.与axis＿bypass＿adapter不同的是, 这个接口没有内部的buffer, 所以除非是DWC PCIe controller要求保存数据, 否则用户一旦启动发送信息是不能停顿的.所以在发送信息之前需要先确认信誉 (Credit) 是否足够, 关于排序规则的处理则是完全在用户逻辑 (User logic) 中实现.发送的TLP包括request, completion, 设备定义信息, DMA完成.</p>
                </div>
                <div class="p1">
                    <p id="35">在Axis＿slave＿adapter中, 定义了一个状态机, 如图5.定义状态分别为IDLE, HEAD2, DATA, XMIT＿DEAD.</p>
                </div>
                <div class="area_img" id="36">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/WXYJ201907004_03600.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图5 Axis＿bypass＿adapter的状态机" src="Detail/GetImg?filename=images/WXYJ201907004_03600.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图5 Axis＿bypass＿adapter的状态机  <a class="btn-zoomin" href="Detail/GetImg?filename=images/WXYJ201907004_03600.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="p1">
                    <p id="37">IDLE状态为复位后的初始状态, 在这个状态中主要判断是否当前的TLP是TLP prefix, 此时读数据已准备, 输出接口的client＿tlp＿hv, client＿tlp＿dv, client＿tlp＿eot, client＿tlp＿bad＿eot都为0.如果当前可以传出数据且TLP是完整可读的, 则进入下一状态.如果判断出是TLP prefix, 则进入到HEAD2状态中, 如果不是TLP prefix而是带数据的TLP, 则进入到DATA状态, 如果是不带数据的TLP, 则进入XMIT＿HEAD状态中.在HEAD2状态中主要抓取TLP的头部分信息, 先判断data＿out＿tuser＿bad＿eot是否为1, 如果为1, 则证明当前TLP是一个坏的TLP, 则直接回到IDLE状态, 如果当前TLP是带数据的, 则进入到DATA状态, 如果不带数据则进入到XMIT＿HEAD状态.而在DATA状态中, 主要进行TLP数据部分的读取, 读取结束后回到IDLE状态.在XMIT＿HEAD中主要判定此时控制端是否准备完毕, 如果准备完毕, 则回到IDLE状态.</p>
                </div>
                <h4 class="anchor-tag" id="38" name="38">3.3 可编程性设计</h4>
                <div class="p1">
                    <p id="39">由于FPGA的端口和功耗资源有限, 减少接口数量和功耗.也为了让用户可以更方便的使用与配置, 进行了可编程性的优化, 即添加便于快速配置的接口.例如, sc＿pcie＿hard＿en是整个控制模块的使能信号;sc＿grsn＿dis用于高有效屏蔽复位信号的输入;sc＿pin＿mux＿device＿type＿force用于直接判断该设备处于EP模式或RC模式;sc＿bar＿resizable用于配置空间的直接设置;sc＿num＿of＿rbars可以直接用于判断Bar的数量等.通过对内部信号的处理抓取出快捷信号, 可以实现用户对BAR、Legacy interrupt、MSI、TLP Processing Hints、LTR、ATS、Crosslink等功能的可编程性设置.</p>
                </div>
                <h4 class="anchor-tag" id="40" name="40">3.4 应用于FPGA的代码规范</h4>
                <div class="p1">
                    <p id="41">FPGA (Field-Programmable Gate Array) 现场可编程门阵列的开发需要从顶层设计、模块分层、逻辑实现等多方面入手, 需要软硬件调试的共同配合.而软硬件的开发又是同时分别进行的, 因此, 对于FPGA的设计有统一的逻辑结构的设计要求及规范.在代码实现的过程中, 不仅要实现各项功能, 同时要满足设计层级一致性的设计规范.我们称这个RTL为黄金代码模型 (device golden RTL model, 简称GBM) .这个模型要保证功能的正确性, 也是用户/软件模型与硬件电路设计的接口, 即可以实现软硬件的同时开发.另一种为行为级微结构模型 (behavorial micro-architecture model, BMA) , 这个模型可以对微架构 (Micro-architecture) 进行评估, 同时进行配置的开发, 完成了对配置参数 (Configuration parameter) 到配置接口是否一一映射 (configuration port) 的验证.在对配置参数和配置接口的映射进行验证时, 只保留GBM的接口部分, 而把其他行为描述的内容删除掉, 再把BGM中的代码嵌入到GBM中, 同时确定配置参数到配置接口的转换关系, 最后把嵌入后的模块进行验证, 保证与GBM的完全一致.本文在设计时遵循以上原则, 保证了应用于FPGA的代码的规范性和正确性</p>
                </div>
                <h3 id="42" name="42" class="anchor-tag">4 实验结果验证</h3>
                <div class="p1">
                    <p id="43">当RTL代码完成后, 在流片之前, 需要对这些代码进行验证 (DUT) .验证主要保证从特性列表到RTL转变的正确性, 即要验明DUT的行为表现是否与特性列表中要求的一致, 是否实现了所有的特性, 对于异常处理是否与列表中一致, 是否足够稳健能够从异常状态中恢复等.PCIe的验证平台搭建基于UVM, 使用System Verilog语言构建case.验证环境的整体结构如图6, 设计了支持两个PCIe设备通过PCIe串行连接接口进行数据传输的验证环境.</p>
                </div>
                <div class="area_img" id="44">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/WXYJ201907004_04400.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图6 验证环境整体结构图" src="Detail/GetImg?filename=images/WXYJ201907004_04400.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图6 验证环境整体结构图  <a class="btn-zoomin" href="Detail/GetImg?filename=images/WXYJ201907004_04400.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="p1">
                    <p id="45">有两个PCe设备分别为DUT (Device Under Test) 和VIP (Verification|P) , DUT包含了用待测设计构建的pcie device和pcie device用户侧的APl, VIP包含一个pcie vip模拟的pcie device和使用pcle vip的APl, 板级BCU和S2S主要模拟pcb上对device的控制和影响, 其中BCU主要控制板级信号, 模拟上电、重置、时钟生成等, S2S主要控制串行连接信号, 模拟通道故障、插入skew等DUT和VIP形成PCIe链路, 其通信控制是通过testbench调用API来实现.</p>
                </div>
                <h4 class="anchor-tag" id="46" name="46">4.1 链路训练</h4>
                <div class="p1">
                    <p id="47">首先对链路初始化进行验证, 以Gen2为例, 在物理层复位之后, LTSSM状态机依次经过Detect.Quiet, Detect.Action, Polling.Action, Polling.Configuration, Configuration.Linkwidth.Start, Configuration.Linkwidth.Accept, Configuration.Lanenum.Accept, Configuration.Lanenum.Wait, Configuration.Comlete, Configuration.Idle, L0, Recovery.RcvrLock, Recovery.RcvrCfg, Recovery.Speed, Recovery.RcvrLock, Recovery.RcvrCfg, Recovery.Idle, 最后进入到L0正常工作状态, 波形如图7.</p>
                </div>
                <div class="area_img" id="48">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/WXYJ201907004_04800.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图7 Gen2链路定向的验证波形" src="Detail/GetImg?filename=images/WXYJ201907004_04800.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图7 Gen2链路定向的验证波形  <a class="btn-zoomin" href="Detail/GetImg?filename=images/WXYJ201907004_04800.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <h4 class="anchor-tag" id="49" name="49">4.2 数据传输</h4>
                <div class="p1">
                    <p id="50">在数据传输过程中, 对存储器访问、IO访问和配置访问进行了验证, 结果表明该设计可以正常传输各种类型数据.</p>
                </div>
                <h3 id="51" name="51" class="anchor-tag">5 结束语</h3>
                <div class="p1">
                    <p id="52">本文介绍了一种可应用于FPGA的PCIE接口设计, 对接口转换模块和快速配置的可编程性设计进行了详细的说明, 介绍了应用于FPGA的功能代码规范.同时, 介绍了基于UVM搭建的验证平台结构, 并完成了对PCIE的验证, 接口可以正常工作, 达到了预期的设计目标.下一步将进行流片验证.</p>
                </div>

        <!--brief end-->
        
        <!--conten left  end-->
        <!--增强附件-->
        

        <!--reference start-->
            <div class="reference anchor-tag" id="a_bibliography">
                    <h3>参考文献</h3>
                                        <p id="53">
                            <a id="bibliography_1" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=GYKJ201702020&amp;v=MjIwMTN5bmhVYjNOSWpUQVpMRzRIOWJNclk5SFpJUUtESDg0dlI0VDZqNTRPM3pxcUJ0R0ZyQ1VSTE9lWmVWdUY=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[1]</b>王帅, 李念强, 许惠翔.基于Altera IP核的FPGAPCIE接口设计[J].工业控制计算机, 2017, 30 (2) :41-42.
                            </a>
                        </p>
                        <p id="55">
                            <a id="bibliography_2" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=GGYT201407037&amp;v=MjYxNDllVnVGeW5oVWIzTklpclNlckc0SDlYTXFJOUdZNFFLREg4NHZSNFQ2ajU0TzN6cXFCdEdGckNVUkxPZVo=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[2]</b>张锐, 曹彦荣.基于FPGA的PCIE总线接口设计[J].硅谷, 2014 (7) :29-31.
                            </a>
                        </p>
                        <p id="57">
                            <a id="bibliography_3" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CMFD&amp;filename=2010058894.nh&amp;v=MjU4OTVxcUJ0R0ZyQ1VSTE9lWmVWdUZ5bmhVYjNOVjEyNkhyTzlGdG5GcTVFYlBJUUtESDg0dlI0VDZqNTRPM3o=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[3]</b>陈致远.高速USB误码率的测试及研究[D].上海:复旦大学, 2009.
                            </a>
                        </p>
                        <p id="59">
                            <a id="bibliography_4" target="_blank" href="http://scholar.cnki.net/result.aspx?q=A40nm 16Core 128-Thread SPARC SoC">

                                <b>[4]</b>SHIN J L, HUANG DAWEI, PETRICK B, et al.A40nm 16Core 128-Thread SPARC SoC[J].IEEEJournal of Solid-State Circuits, 2011, 46 (1) :131-144.
                            </a>
                        </p>
                        <p id="61">
                            <a id="bibliography_5" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JZCK200912067&amp;v=MDAwOTh0R0ZyQ1VSTE9lWmVWdUZ5bmhVYjNOTHpmSVpiRzRIdGpOclk5RFk0UUtESDg0dlI0VDZqNTRPM3pxcUI=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[5]</b>马萍, 唐卫华, 李绪志.基于PCIe的高速数据传输系统研究与开发[J].计算机测量与控制, 2009, 17 (1) :2555-2557.
                            </a>
                        </p>
                        <p id="63">
                            <a id="bibliography_6" target="_blank" href="http://scholar.cnki.net/result.aspx?q=PCIe for mobile launched;PCIe3.1,4.0specs revealed">

                                <b>[6]</b>KEVIN PARRISH.PCIe for mobile launched;PCIe3.1, 4.0specs revealed[EB/OL]. (2013-06-28) .[2014-07-10].https://www.tomshardware.co.uk/M-PCIe-M.2-PCIe-3.1-PCIe-4.0-OCuLink, news-44639.html.
                            </a>
                        </p>
                        <p id="65">
                            <a id="bibliography_7" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CMFD&amp;filename=1016109653.nh&amp;v=MTI3NjJDVVJMT2VaZVZ1RnluaFViM05WRjI2R0xLNEY5ZkpySkViUElRS0RIODR2UjRUNmo1NE8zenFxQnRHRnI=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[7]</b>武桂林.PCIe2.0 MAC层数据通路与PCS层设计[D].合肥:中国科学技术大学, 2016.
                            </a>
                        </p>
                        <p id="67">
                            <a id="bibliography_8" target="_blank" href="http://scholar.cnki.net/result.aspx?q=A Wrapper of PCI Express with FIFO Interfaces based on FPGA">

                                <b>[8]</b>LI H, LIU Y A, YUAN D M, et al.A wrapper of PCI express with FIFO interfaces based on FPGA[C]//ICICEE 2012.Xi′an, China, 2012, 145:525-529.
                            </a>
                        </p>
            </div>
        <!--reference end-->
        <!--footnote start-->
        <!--footnote end-->



    </div>

        <input id="fileid" type="hidden" value="WXYJ201907004" />
        <input id="dpi" type="hidden" value="300" />
    </div>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?6e967eb120601ea41b9d312166416aa6";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
</script>

    


<input id="hid_uid" name="hid_uid" type="hidden" value="WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
<input id="hid_kLogin_headerUrl" name="hid_kLogin_headerUrl" type="hidden" value="/KLogin/Request/GetKHeader.ashx%3Fcallback%3D%3F" />
<input id="hid_kLogin_footerUrl" name="hid_kLogin_footerUrl" type="hidden" value="/KLogin/Request/GetKFooter.ashx%3Fcallback%3D%3F" />
<div class="btn-link" style="display: none"><a target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=WXYJ201907004&amp;v=MjAxNTBWdUZ5bmhVYjNOTWpYU1pMRzRIOWpNcUk5RllJUUtESDg0dlI0VDZqNTRPM3pxcUJ0R0ZyQ1VSTE9lWmU=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">知网节</a></div>
<div class="popflow" id="popupTips" style="display: none;">
    <div class="popflowArr"></div>
    <div class="popflowCot">
        <div class="hd"><a href="javascript:void(0);" onclick="$('#popupTips').hide();$('#popupmsg').html('')" class="close">X</a></div>
        <div class="bd">
            <p class="mes" id="popupmsg" name="popupmsg"></p>
          
        </div>
    </div>
</div>
<input type="hidden" id="myexport" value="//kns.cnki.net" />

<input type="hidden" id="KPCAPIPATH" value="//ishufang.cnki.net" />
<input type="hidden" id="CitedTimes" value="" />
<div class="link" id="GLSearch" style="display: none;">
    <i class="icon-trangle"></i>
    <div class="inner">
        <a class="icon" id="copytext">复制</a>
        <a class="icon" target="_blank" onclick="searchCRFD(this)">工具书搜索</a>
    </div>
</div>




<input id="hidVirtualPath" name="hidVirtualPath" type="hidden" value="/kxreader" />
<script src="/kxreader/bundles/detail?v=-ULdk-c6FkZHtJA2KAXPgHnyA8mtgyPnBde_C2VZ2BY1"></script>

<script src="/kxreader/Scripts/layer.min.js" type="text/javascript"></script>

<div id="footerBox" class="rootw footer">
</div>
<script>
    if (typeof FlushLogin == 'function') {
        FlushLogin();
    }
    modifyEcpHeader(true);
</script>

<!--图片放大功能 start-->
<script src="/kxreader/bundles/imagebox?v=W4phPu9SNkGcuPeJclikuVE3PpRyIW_gnfjm_19nynI1"></script>

<script type="text/javascript">
    $(function () {
        var j = $.noConflict();
        j(function () {
            j(".zoom-in,.btn-zoomin").imgbox({
                'alignment': 'center',
                'allowMultiple': false,
                'overlayShow': true
            });
        })
    });
</script>
<!--图片放大功能 end-->
<div class="fixedbar">
    <div class="backtop hiddenV" id="backtop">
        <a id="backTopSide" href="javascript:scroll(0,0);" title=""></a>
    </div>
</div>
<script type="text/javascript" src="/kxreader/Scripts/MathJax-2.6-latest/MathJax.js?config=MML_HTMLorMML-full"></script>

</body>
</html>
