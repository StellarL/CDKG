<!DOCTYPE html>
<html>
<head>
    <title>全文阅读--XML全文阅读--中国知网</title>
    <link rel="icon" href="/kxreader/favicon.ico" />
    <link rel="shortcut Icon" href="/kxreader/favicon.ico" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="keywords" content="文献 XML KBASE CNKI 中国知网" />
    <meta name="description" content="XML文献检索" />
    <link href="/kxreader/Content/css/detail?v=qX2z2KjRAEyQiNfAbKtl7dLnsqFoQ5Jdw3TZfDf0n1k1" rel="stylesheet"/>

    <script type="text/javascript">
        var APPPATH = '/kxreader';
    </script>
</head>

<body>
    
<script type="text/javascript" src="//login.cnki.net/TopLogin/api/loginapi/get?type=top&amp;localCSS=&amp;returnurl=%2f%2fkns.cnki.net%2f%2fKXReader%2fDetail%3fTIMESTAMP%3d637134026699475000%26DBCODE%3dCJFD%26TABLEName%3dCJFDLAST2019%26FileName%3dWXYJ201904003%26RESULT%3d1%26SIGN%3dmKignTV6CYZ5WP%252fdKhWSQSAom8M%253d"></script>

<div id="headerBox" class="header">
    <div class="topbar">
        <div class="textalign">
            <a href="/kxreader/Detail?dbcode=CJFD&amp;filename=WXYJ201904003&amp;align=md">
                <i class="icon-cen active" title="居中对齐"></i>
            </a>
            <a href="/kxreader/Detail?dbcode=CJFD&amp;filename=WXYJ201904003&amp;align=lt">
                <i class="icon-left " title="左对齐"></i>
            </a>
        </div>
        <h6 class="free-tip"><i class="icon"></i>HTML阅读开放试用阶段，欢迎体验！</h6>
    </div>
</div>

    



<div class="btn-link" style="display: none"><a target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=WXYJ201904003&amp;v=MjgxNDVMRzRIOWpNcTQ5Rlo0UUtESDg0dlI0VDZqNTRPM3pxcUJ0R0ZyQ1VSTE9lWmVWdUZ5em1WcnpBTWpYU1o=&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFVsZkNJUGsvbURSNjZHaHV0MCsxOD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">知网节</a></div>

    <div class="main">

        

    <div class="sidebar-a">
        <!--sidebar start-->
        <div class="sidenav">
            <div class="arrow"><span></span></div>
            <!--sidebar_list start-->
            <dl class="sidenav-list">
                    <dt class="tit">目录结构</dt>
                            <dd class="guide">
                                    <p><a href="#23" data-title="1 &lt;b&gt;引言&lt;/b&gt; ">1 <b>引言</b></a><i></i></p>
                                                            </dd>
                            <dd class="guide">
                                    <p><a href="#26" data-title="2 &lt;b&gt;系统总体介绍&lt;/b&gt; ">2 <b>系统总体介绍</b></a><i></i></p>
                                                            </dd>
                            <dd class="guide">
                                    <p><a href="#30" data-title="3 &lt;b&gt;终端节点&lt;/b&gt;Bootloader&lt;b&gt;设计&lt;/b&gt; ">3 <b>终端节点</b>Bootloader<b>设计</b></a><i></i></p>
                                                            </dd>
                            <dd class="guide">
                                    <p><a href="#42" data-title="4 &lt;b&gt;服务器端更新软件设计&lt;/b&gt; ">4 <b>服务器端更新软件设计</b></a><i></i></p>
                                                                    <ul class="contentbox">
                                                <li><a href="#43" data-title="4.1 &lt;b&gt;文本有效数据提取&lt;/b&gt;">4.1 <b>文本有效数据提取</b></a></li>
                                                <li><a href="#48" data-title="4.2 &lt;b&gt;文本比较算法&lt;/b&gt;Needleman/Wunsch">4.2 <b>文本比较算法</b>Needleman/Wunsch</a></li>
                                    </ul>
                            </dd>
                            <dd class="guide">
                                    <p><a href="#56" data-title="5 &lt;b&gt;通信及程序更新&lt;/b&gt; ">5 <b>通信及程序更新</b></a><i></i></p>
                                                                    <ul class="contentbox">
                                                <li><a href="#57" data-title="5.1 &lt;b&gt;服务器端与终端节点通信&lt;/b&gt;">5.1 <b>服务器端与终端节点通信</b></a></li>
                                                <li><a href="#64" data-title="5.2 &lt;b&gt;代码更新&lt;/b&gt;">5.2 <b>代码更新</b></a></li>
                                    </ul>
                            </dd>
                            <dd class="guide">
                                    <p><a href="#77" data-title="6 &lt;b&gt;实验验证与评估&lt;/b&gt; ">6 <b>实验验证与评估</b></a><i></i></p>
                                                            </dd>
                            <dd class="guide">
                                    <p><a href="#83" data-title="7 &lt;b&gt;结束语&lt;/b&gt; ">7 <b>结束语</b></a><i></i></p>
                                                            </dd>
                            <dd class="guide">
                                    <p><a href="#" data-title="文内图表 ">文内图表</a><i></i></p>
                                                                    <ul class="contentbox">
                                                <li><a href="#28" data-title="&lt;b&gt;图&lt;/b&gt;1 &lt;b&gt;系统模型&lt;/b&gt;"><b>图</b>1 <b>系统模型</b></a></li>
                                                <li><a href="#32" data-title="&lt;b&gt;图&lt;/b&gt;2 KL36&lt;b&gt;芯片&lt;/b&gt;Flash&lt;b&gt;划分图&lt;/b&gt;"><b>图</b>2 KL36<b>芯片</b>Flash<b>划分图</b></a></li>
                                                <li><a href="#38" data-title="&lt;b&gt;表&lt;/b&gt;1 Bootloader&lt;b&gt;代码&lt;/b&gt;Flash&lt;b&gt;划分&lt;/b&gt;"><b>表</b>1 Bootloader<b>代码</b>Flash<b>划分</b></a></li>
                                                <li><a href="#40" data-title="&lt;b&gt;表&lt;/b&gt;2 &lt;b&gt;应用程序代码&lt;/b&gt;Flash&lt;b&gt;划分&lt;/b&gt;"><b>表</b>2 <b>应用程序代码</b>Flash<b>划分</b></a></li>
                                                <li><a href="#45" data-title="&lt;b&gt;表&lt;/b&gt;3 Hex&lt;b&gt;文件记录行语义&lt;/b&gt;"><b>表</b>3 Hex<b>文件记录行语义</b></a></li>
                                                <li><a href="#46" data-title="&lt;b&gt;图&lt;/b&gt;3 Hex&lt;b&gt;文件有效数据提取&lt;/b&gt;"><b>图</b>3 Hex<b>文件有效数据提取</b></a></li>
                                                <li><a href="#51" data-title="&lt;b&gt;表&lt;/b&gt;4 &lt;b&gt;通信帧格式&lt;/b&gt;"><b>表</b>4 <b>通信帧格式</b></a></li>
                                                <li><a href="#81" data-title="&lt;b&gt;表&lt;/b&gt;5 &lt;b&gt;更新测试对比表&lt;/b&gt;"><b>表</b>5 <b>更新测试对比表</b></a></li>
                                    </ul>
                            </dd>
                                    <dd class="guide">
                                        <h6>
                                            <p><a href="#a_bibliography">参考文献</a> </p>
                                        </h6>
                                    </dd>

            </dl>
        </div>
        <!--sidebar end-->
        &nbsp;
        <!--此处有一空格符 勿删-->
    </div>

                <div class="sidebar-b three-collumn" style="width:0;">
            <div class="refer" style="width: 0;">
                <div class="arrow off" title="参考文献"><span></span></div>
                <div class="js-scrollbox" >
                    
                    <div class="subbox active">
                        <h4>
                            <span class="tit">参考文献</span>
                            <a class="close" href="javascript:void(0)">x</a>
                        </h4>
                        <div class="side-scroller">
                            <ul class="refer-list">
                                <li id="3">


                                    <a id="bibliography_1" title=" 曲井致. NB-IoT低速率窄带物联网通信技术现状及发展趋势[J].科技创新与应用, 2016 (31) :115-115." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=CXYY201631088&amp;v=MTIyODdlWmVWdUZ5em1WcnpBSmpYU2Q3RzRIOWZQcm85TmJJUUtESDg0dlI0VDZqNTRPM3pxcUJ0R0ZyQ1VSTE8=&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFVsZkNJUGsvbURSNjZHaHV0MCsxOD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[1]</b>
                                         曲井致. NB-IoT低速率窄带物联网通信技术现状及发展趋势[J].科技创新与应用, 2016 (31) :115-115.
                                    </a>
                                </li>
                                <li id="5">


                                    <a id="bibliography_2" title=" WANG Y P E, LIN X, Adhikary A, et al. A Primer on 3GPP Narrowband Internet of Things[J]. IEEE Communications Magazine, 2017, 55 (3) :117-123." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=A Primer on 3GPP Narrowband Internet of Things">
                                        <b>[2]</b>
                                         WANG Y P E, LIN X, Adhikary A, et al. A Primer on 3GPP Narrowband Internet of Things[J]. IEEE Communications Magazine, 2017, 55 (3) :117-123.
                                    </a>
                                </li>
                                <li id="7">


                                    <a id="bibliography_3" >
                                        <b>[3]</b>
                                     JOSEPH YIU. ARM Cortex-M0与Cortex-M0+权威指南 (第2版) [M]. 北京:清华大学出版社, 2018.</a>
                                </li>
                                <li id="9">


                                    <a id="bibliography_4" title=" Quectel_BC95_AT_Commands_Manual_V1.6 [DB/OL]. [2017-07-03]. http://www.quectel.com/cn/." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Quectel_BC95_AT_Commands_Manual_V1.6">
                                        <b>[4]</b>
                                         Quectel_BC95_AT_Commands_Manual_V1.6 [DB/OL]. [2017-07-03]. http://www.quectel.com/cn/.
                                    </a>
                                </li>
                                <li id="11">


                                    <a id="bibliography_5" title=" 顾会光, 王宜怀, 史新峰. 数据无损的远程代码更新的设计与研究[J].计算机工程与设计, 2015, 36 (10) :2633-2639." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=SJSJ201510007&amp;v=MDg4ODRaTEc0SDlUTnI0OUZZNFFLREg4NHZSNFQ2ajU0TzN6cXFCdEdGckNVUkxPZVplVnVGeXptVnJ6QU5pZlk=&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFVsZkNJUGsvbURSNjZHaHV0MCsxOD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[5]</b>
                                         顾会光, 王宜怀, 史新峰. 数据无损的远程代码更新的设计与研究[J].计算机工程与设计, 2015, 36 (10) :2633-2639.
                                    </a>
                                </li>
                                <li id="13">


                                    <a id="bibliography_6" title=" 陈瑞杰, 王宜怀, 李会. 一种无线代码可靠更新系统的研究与设计[J].现代电子技术, 2016, 39 (4) :67-71." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=XDDJ201604019&amp;v=MDE0NTFNcTQ5RWJZUUtESDg0dlI0VDZqNTRPM3pxcUJ0R0ZyQ1VSTE9lWmVWdUZ5em1WcnpBUFNuUFpMRzRIOWY=&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFVsZkNJUGsvbURSNjZHaHV0MCsxOD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[6]</b>
                                         陈瑞杰, 王宜怀, 李会. 一种无线代码可靠更新系统的研究与设计[J].现代电子技术, 2016, 39 (4) :67-71.
                                    </a>
                                </li>
                                <li id="15">


                                    <a id="bibliography_7" title=" 陈发堂, 郭丽强. ARM+DSP嵌入式系统BootLoader在LTE中的实现[J].电子技术应用, 2013, 39 (5) :25-28." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=DZJY201305015&amp;v=MTQ5NjI4NHZSNFQ2ajU0TzN6cXFCdEdGckNVUkxPZVplVnVGeXptVnJ6QUlUZkJkN0c0SDlMTXFvOUVZWVFLREg=&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFVsZkNJUGsvbURSNjZHaHV0MCsxOD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[7]</b>
                                         陈发堂, 郭丽强. ARM+DSP嵌入式系统BootLoader在LTE中的实现[J].电子技术应用, 2013, 39 (5) :25-28.
                                    </a>
                                </li>
                                <li id="17">


                                    <a id="bibliography_8" title=" 汪春华, 白稳峰, 刘胤博, 等. 基于CAN总线UDS服务BootLoader应用开发[J].电子测量技术, 2017, 40 (2) :166-170." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=DZCL201702035&amp;v=MDU3MDZHNEg5Yk1yWTlHWVlRS0RIODR2UjRUNmo1NE8zenFxQnRHRnJDVVJMT2VaZVZ1Rnl6bVZyekFJVGZJWXI=&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFVsZkNJUGsvbURSNjZHaHV0MCsxOD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[8]</b>
                                         汪春华, 白稳峰, 刘胤博, 等. 基于CAN总线UDS服务BootLoader应用开发[J].电子测量技术, 2017, 40 (2) :166-170.
                                    </a>
                                </li>
                                <li id="19">


                                    <a id="bibliography_9" title=" 王宜怀, 朱仕浪, 郭芸. 嵌入式技术基础与实践 (第4版) [M]. 北京:清华大学出版社, 2017." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CBBD&amp;filename=9787302467571000&amp;v=MDY4MjJFOWZidm5LcmlmWnU5dUZDcmxVN3ZMSlYwY1hGcXpHYkM0SE5YS3FJcENaZXNQREJNOHp4VVNtRGQ5U0g3bjN4&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFVsZkNJUGsvbURSNjZHaHV0MCsxOD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[9]</b>
                                         王宜怀, 朱仕浪, 郭芸. 嵌入式技术基础与实践 (第4版) [M]. 北京:清华大学出版社, 2017.
                                    </a>
                                </li>
                                <li id="21">


                                    <a id="bibliography_10" title=" 姜鲜桃. 双序列比对Needleman-Wunsch算法研究[D].呼和浩特:内蒙古农业大学, 2017." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CMFD&amp;filename=1017211808.nh&amp;v=MjkzMzdyekFWRjI2R2JHNUg5bk1wNUViUElRS0RIODR2UjRUNmo1NE8zenFxQnRHRnJDVVJMT2VaZVZ1Rnl6bVY=&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFVsZkNJUGsvbURSNjZHaHV0MCsxOD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[10]</b>
                                         姜鲜桃. 双序列比对Needleman-Wunsch算法研究[D].呼和浩特:内蒙古农业大学, 2017.
                                    </a>
                                </li>
                            </ul>
                            <div style='display: none;' class="zqscroller" >
                                <h4 class="">附加材料</h4>
                                <ul></ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            &nbsp;
            <!--此处有一空格符 勿删-->
        </div>

        
    <div class="content">



        <!--tips start-->
                            <div class="tips">
                    <a href="http://navi.cnki.net/KNavi/JournalDetail?pcode=CJFD&amp;pykm=WXYJ" target="_blank">微电子学与计算机</a>
                2019,36(04),12-16+22             </div>
        <!--tips end-->
            <div class="top-title">
                <h1 class="title">
                    <span class="vm"><b>基于NB-IoT的嵌入式远程软件更新系统设计</b></span>
                                    </h1>

            </div>
                        <h2>
                                <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=au&amp;skey=%E9%99%88%E6%88%90&amp;code=08841250&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFVsZkNJUGsvbURSNjZHaHV0MCsxOD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">陈成</a>
                                <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=au&amp;skey=%E7%8E%8B%E5%AE%9C%E6%80%80&amp;code=08846742&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFVsZkNJUGsvbURSNjZHaHV0MCsxOD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">王宜怀</a>
                                <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=au&amp;skey=%E9%92%B1%E6%B6%B5%E4%BD%B3&amp;code=33405196&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFVsZkNJUGsvbURSNjZHaHV0MCsxOD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">钱涵佳</a>
                                <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=au&amp;skey=%E5%BD%AD%E6%B6%9B&amp;code=14197276&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFVsZkNJUGsvbURSNjZHaHV0MCsxOD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">彭涛</a>
                </h2>
                    <h2>
                    <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=in&amp;skey=%E8%8B%8F%E5%B7%9E%E5%A4%A7%E5%AD%A6%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6%E4%B8%8E%E6%8A%80%E6%9C%AF%E5%AD%A6%E9%99%A2&amp;code=0240077&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFVsZkNJUGsvbURSNjZHaHV0MCsxOD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">苏州大学计算机科学与技术学院</a>
            </h2>

        
<div class="link">
    <a id="aexport" class="icon icon-output"  onclick="" href="javascript:void(0);"><i></i>导出/参考文献</a>
    
    <span class="shareBoard" onmouseover="$('#sharedet').show();$('#this').addClass('shareBoardCUR')" onmouseout="$('#sharedet').hide();$('#this').removeClass('shareBoardCUR')">
        <a class="icon icon-share" href="#"><i></i>分享<em></em></a>
        <ul class="shareHide" id="sharedet" style="display: none;">
            <li><a title="复制链接" class="copy" onclick="" href="#"><i></i>复制链接</a></li>
            <li><a title="分享到新浪微博" class="xl" onclick="" href="javascript:common.ShareAction('xl');"><i></i>新浪微博</a></li>
            <li>
                <a title="分享到微信" class="wx" onclick="" href="#"><i></i>微信扫一扫</a>
                <div class="qrcode"><img src='' alt='' /></div>
            </li>
        </ul>

    </span>
    
    <a id="RefTrack" title="创建引文跟踪" class="icon icon-track" onclick="" href="javascript:void(0);"> <i></i>创建引文跟踪 </a>
    <a id="ashoucang" title="收藏" class="icon icon-favor" onclick="" href="javascript:void(0);"><i></i>收藏</a>
    <a class="icon icon-print" onclick="window.print();" href="javascript:void(0);"><i></i>打印</a>
    
    <!--版本切换 end-->
</div>
                            <div class="data" id="a_abstract">
                <span class="keys">摘<span style="font-family: 'Times New Roman';">&nbsp;&nbsp;&nbsp;&nbsp;</span>要：</span>
                <p>针对嵌入式设备软件更新繁琐、代价高昂以及NB-IoT上下行传输数据量少的问题, 设计了一种基于NB-IoT的远程更新系统.并在硬件和软件方面进行优化, 以节约更新所需的网络开销、缩短更新时间.在硬件层面上, 对终端节点的Flash进行合理划分, 设计出Bootloader区和驱动固化区等, 以减少代码更新区域.在软件层面上, 利用文本比较算法Needleman/Wunsch, 避免重复代码数据的传输.最后对远程更新系统进行测试, 测试结果表明该系统更新代码量少, 更新时间短, 且具有较好的成功率.</p>
            </div>
                    <div class="data" id="a_keywords">
                <span class="keys">关键词：</span>
                <p>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=NB-IoT&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFVsZkNJUGsvbURSNjZHaHV0MCsxOD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">NB-IoT;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=KL36&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFVsZkNJUGsvbURSNjZHaHV0MCsxOD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">KL36;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=%E8%BF%9C%E7%A8%8B%E8%BD%AF%E4%BB%B6%E6%9B%B4%E6%96%B0&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFVsZkNJUGsvbURSNjZHaHV0MCsxOD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">远程软件更新;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=Bootloader&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFVsZkNJUGsvbURSNjZHaHV0MCsxOD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">Bootloader;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=Needleman%2FWunsch&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFVsZkNJUGsvbURSNjZHaHV0MCsxOD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">Needleman/Wunsch;</a>
                </p>
            </div>
        
        <!--brief start-->
        
            <div class="brief">
                    <p>
                            <b>作者简介：</b>
                                                        <span>
                                    陈成 男, (1993-) , 硕士研究生.研究方向为嵌入式系统与物联网.E-mail:20165227004@stu.suda.edu.cn.;
                                </span>
                                <span>
                                    王宜怀 男, (1962-) , 博士, 教授.研究方向为嵌入式系统、传感网与智能控制技术.;
                                </span>
                                <span>
                                    钱涵佳 女, (1994-) , 硕士研究生.研究方向为嵌入式系统与物联网.;
                                </span>
                                <span>
                                    彭涛 男, (1989-) , 博士研究生.研究方向为物联网与图像处理.;
                                </span>
                    </p>
                                    <p><b>收稿日期：</b>2018-08-01</p>

                    <p>

                            <b>基金：</b>
                                                        <span>国家自然科学基金项目 (61672369);</span>
                    </p>
            </div>
                    <h1><b>Design of Embedded Device Remote Software Update System Based on NB-IoT</b></h1>
                    <h2>
                    <span>CHEN Cheng</span>
                    <span>WANG Yi-huai</span>
                    <span>QIAN Han-jia</span>
                    <span>PENG Tao</span>
            </h2>
                    <h2>
                    <span>School of Computer and Technology, Soochow University</span>
            </h2>
                            <div class="data" id="a_abstractEN">
                <span class="keys">Abstract：</span>
                <p>In the face of the complexity and high cost of software update for embedded devices and NB-IoT has less uplink and downlink transmission data, a remote software update system was designed. And optimize the hardware and software to save the network overhead required to update and shorten the update time. The system makes a reasonable division of the terminal nodes Flash, design the bootloader area and the drive curing area, and reduces the code update area at the hardware level. And use the text comparison algorithm Needleman/Wunsch in the server software to avoid duplicate code data transmission at the software level. Finally, the remote update system is tested. The test results show that the system has less update code, shorter update time, and better success rate.</p>
            </div>
                    <div class="data" id="a_keywordsEN">
                <span class="keys">Keyword：</span>
                <p>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=NB-IoT&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFVsZkNJUGsvbURSNjZHaHV0MCsxOD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">NB-IoT;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=KL36&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFVsZkNJUGsvbURSNjZHaHV0MCsxOD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">KL36;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=remote%20software%20update&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFVsZkNJUGsvbURSNjZHaHV0MCsxOD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">remote software update;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=bootloader&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFVsZkNJUGsvbURSNjZHaHV0MCsxOD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">bootloader;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=needleman%2Fwunsch&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFVsZkNJUGsvbURSNjZHaHV0MCsxOD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">needleman/wunsch;</a>
                </p>
            </div>
                    <div class="brief">
                
                    <p>
                                            </p>
                                    <p><b>Received：</b> 2018-08-01</p>
                                    <p>
                                            </p>
            </div>


        <!--brief start-->
                        <h3 id="23" name="23" class="anchor-tag">1 <b>引言</b></h3>
                <div class="p1">
                    <p id="24">随着物联网技术的快速发展, 特别是GPRS、Zigbee、NB-IoT等远传技术在单片机上的大量应用, 远程代码更新技术愈发显得必要.一般修改单片机程序往往需要对单片机产品进行回收才能实现, 这对那些数量较多, 分布较广的单片机产品而言就显得回收成本高昂和繁琐.NB-IoT技术是3GPP标准定义的一种低功耗广域网解决方案, 可支持人与物及物与物之间的连接<citation id="85" type="reference"><link href="3" rel="bibliography" /><sup>[<a class="sup">1</a>]</sup></citation>.因其具有大连接、深覆盖、低成本、低功耗等特点, NB-IoT在智能抄表、智能停车、车辆跟踪、物流监控、智慧农业、智能设备等方面具有极大优势<citation id="86" type="reference"><link href="3" rel="bibliography" /><link href="5" rel="bibliography" /><sup>[<a class="sup">1</a>,<a class="sup">2</a>]</sup></citation>, 应用前景十分广阔, 因此本系统选用NB-IoT作为远程更新的通信方式.</p>
                </div>
                <div class="p1">
                    <p id="25">本文设计并实现一套基于NB-IoT的远程程序更新系统, 选择KL36和BC95为硬件平台来实现单片机远程程序更新操作.在深入分析机器码格式、Bootloader机制等技术要点的基础上, 优化单片机Flash的划分并引入文本比较算法Needleman/Wunsch来减少通讯流程中的网络开销.</p>
                </div>
                <h3 id="26" name="26" class="anchor-tag">2 <b>系统总体介绍</b></h3>
                <div class="p1">
                    <p id="27">本文实现一套基于NB-IoT的远程程序更新系统, 该系统可通过服务器端软件更新与之相连的终端程序.NB-IoT远程程序更新系统涉及到两个部分:终端和服务器端.系统的总体模型如图1所示, 其中NB-IoT基站、核心网、平台由移动运营商负责维护.终端节点可通过NB-IoT通信模组直接与基站连接, 在附着核心网成功后即可与服务器端更新软件进行数据交互以此完成更新代码的传递.远程代码更新工作流程为:服务器端软件解析程序机器码文件 (Hex文件) , 提取出有效数据并通过NB-IoT通信协议将命令或数据发送至指定的终端节点, 终端节点接收到命令或数据后对片上Flash进行相应的复制、插入操作, 最后分别接收服务器端校验和更新命令以实现更新代码的校验和远程更新操作.</p>
                </div>
                <div class="area_img" id="28">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/WXYJ201904003_028.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFVsZkNJUGsvbURSNjZHaHV0MCsxOD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图1 系统模型" src="Detail/GetImg?filename=images/WXYJ201904003_028.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFVsZkNJUGsvbURSNjZHaHV0MCsxOD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit"><b>图</b>1 <b>系统模型</b>  <a class="btn-zoomin" href="Detail/GetImg?filename=images/WXYJ201904003_028.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFVsZkNJUGsvbURSNjZHaHV0MCsxOD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="p1">
                    <p id="29">在本系统中终端节点使用的是系统时钟频率可达48 MHz的低功耗芯片MKL36Z64, 该主控芯片是属于ARM Cortex M0+内核, 其拥有64 KB的Flash、8 KB的RAM和48个通用IO<citation id="87" type="reference"><link href="7" rel="bibliography" /><sup>[<a class="sup">3</a>]</sup></citation>.NB-IoT通信模组选择的是BC95, 支持串口AT指令, 数据传输方式支持UDP和COAP协议, 同时具有高性能、低功耗等特点<citation id="88" type="reference"><link href="9" rel="bibliography" /><sup>[<a class="sup">4</a>]</sup></citation>.</p>
                </div>
                <h3 id="30" name="30" class="anchor-tag">3 <b>终端节点</b>Bootloader<b>设计</b></h3>
                <div class="p1">
                    <p id="31">NB-IoT终端节点设计包含硬件设计和软件设计.其中硬件由KL36芯片最小系统、BC95通信模组外围电路及其他电路组成, KL36作为终端节点的主控芯片主要负责数据采集、运算和控制等操作.软件设计由Bootloader程序和真正的用户应用程序组成.Bootloader是指终端芯片上电后运行的一段代码、其在用户应用程序运行之前执行, 主要功能是Flash合理划分、各种硬件驱动初始化、更新操作判断, 最终将终端节点带到合适的状态, 为用户应用程序的执行准备好软硬件环境.</p>
                </div>
                <div class="area_img" id="32">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/WXYJ201904003_032.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFVsZkNJUGsvbURSNjZHaHV0MCsxOD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图2 KL36芯片Flash划分图" src="Detail/GetImg?filename=images/WXYJ201904003_032.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFVsZkNJUGsvbURSNjZHaHV0MCsxOD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit"><b>图</b>2 KL36<b>芯片</b>Flash<b>划分图</b>  <a class="btn-zoomin" href="Detail/GetImg?filename=images/WXYJ201904003_032.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFVsZkNJUGsvbURSNjZHaHV0MCsxOD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="p1">
                    <p id="33">参考文献<citation id="89" type="reference">[<a class="sup">5</a>]</citation>提出一种基于SD卡的GPRS远程代码更新方式, 但使用该方法需要在硬件层面增加一块SD卡, 增加硬件成本的同时软硬件的可移植性也不高.参考文献<citation id="90" type="reference">[<a class="sup">6</a>]</citation>提出一种基于片上Flash分区方式的Zigbee远程代码更新方式, 但使用该方法须将Flash一分为三, 应用程序Flash所占区域少于原Flash大小的一半, 严重限制应用程序代码的规模.本文基于以上不足, 提出一种新型的Flash分区方法, 如图2所示.</p>
                </div>
                <div class="p1">
                    <p id="34">本文将终端芯片Flash分为四个部分:Bootolader区、驱动固化区、用户代码区和更新代码区.Bootloader区是由Bootloader代码和Bootloader中断向量表两部分组成, 驱动固化区包括应用程序固化的驱动和应用程序中断向量表, 用户代码区和更新代码区则分别包含正在运行的和待更新的主函数和中断处理函数.对终端节点而言更新程序往往只需修改主函数或中断处理函数, 芯片的各个驱动是不需要变动的.因此本系统每次更新的代码仅为应用程序主函数和中断处理函数, 这样可避免重复更新驱动固化区的各个驱动代码, 减少更新过程中的代码量.</p>
                </div>
                <div class="p1">
                    <p id="35">根据图2中的描述, 用户应用程序中断向量表需重定位.原中断向量表起始地址寄存器SCB-&gt;VTOR指向地址0x0000, 即Bootloader程序的中断向量表地址.现需将其重定位至用户应用程序中断向量表起始地址0x02000, 具体可通过语句SCB-&gt;VTOR=0x2000来设置<citation id="91" type="reference"><link href="15" rel="bibliography" /><sup>[<a class="sup">7</a>]</sup></citation>.芯片Flash的具体划分可在链接文件中进行配置, 链接文件可控制工程程序各部分在地址空间上的布局, 即可将不同属性的内容放入不同的段中 (代码和数据的基本单位是“段”) .链接器按照链接文件中各段的起始地址和长度将各个段数据放入指定Flash区域, 完成链接操作<citation id="92" type="reference"><link href="17" rel="bibliography" /><sup>[<a class="sup">8</a>]</sup></citation>.</p>
                </div>
                <div class="p1">
                    <p id="36">同时需按照Bootloader程序和应用程序所占物理空间大小的不同和图2中Flash的划分机制合理划分Bootloader程序和应用程序中链接文件的配置.</p>
                </div>
                <div class="p1">
                    <p id="37">Bootloader程序链接文件Flash划分如表1所示.</p>
                </div>
                <div class="area_img" id="38">
                    <p class="img_tit"><b>表</b>1 Bootloader<b>代码</b>Flash<b>划分</b> <a class="downexcel" onclick="DownLoadReportExcel(this)">导出到EXCEL</a></p>
                    <p class="img_tit"></p>
                    <p class="img_note"></p>
                    <table id="38" border="1"><tr><td>段名</td><td>起始地址</td><td>长度</td><td>说明</td></tr><tr><td><br />m_interrupts<br />m_flash_config<br />m_text<br />m_data</td><td>0x00000000<br />0x00000400<br />0x00000410<br />0x1FFFF800</td><td>0x0100<br />0x0010<br />0x1BF0<br />0x2000</td><td>中断向量表<br />Flash配置域<br />代码、常量区<br />数据区 (RAM) </td></tr></table>
                    <form name="form" action="/kxreader/Detail/DownloadReportExcel" method="POST" style="display:inline">
                        <input type="hidden" name="hidTable" value="" />
                        <input type="hidden" name="hidFileName" value="" />
                    </form>
                    <p class="img_note"></p>
                    <p class="img_note"></p>
                </div>
                <div class="p1">
                    <p id="39">应用程序链接文件Flash划分如表2所示.</p>
                </div>
                <div class="area_img" id="40">
                    <p class="img_tit"><b>表</b>2 <b>应用程序代码</b>Flash<b>划分</b> <a class="downexcel" onclick="DownLoadReportExcel(this)">导出到EXCEL</a></p>
                    <p class="img_tit"></p>
                    <p class="img_note"></p>
                    <table id="40" border="1"><tr><td>段名</td><td>起始地址</td><td>长度</td><td>说明</td></tr><tr><td><br />m_interrupts<br />m_flash_config<br />m_text<br />m_fun_text<br />m_data</td><td>0x00002000<br />0x00002400<br />0x00002410<br />0x0000A000<br />0x1FFFF800</td><td>0x0100<br />0x0010<br />0x7BF0<br />0x6000<br />0x2000</td><td>中断向量表<br />Flash配置域<br />驱动固化区<br />用户代码区<br />数据区 (RAM) </td></tr></table>
                    <form name="form" action="/kxreader/Detail/DownloadReportExcel" method="POST" style="display:inline">
                        <input type="hidden" name="hidTable" value="" />
                        <input type="hidden" name="hidFileName" value="" />
                    </form>
                    <p class="img_note"></p>
                    <p class="img_note"></p>
                </div>
                <div class="p1">
                    <p id="41">Bootloader程序的起始地址从0x0000开始, 可执行代码起始地址为0x0410.Bootloader程序最大占Flash大小为8 K, 主要负责程序更新操作判断, 若需更新则将更新代码区Flash数据复制到用户代码区.应用程序的中断向量表的起始地址设置为0x2000, 具体的程序代码分别存储在驱动固化区和用户代码区.驱动固化区存放无需修改的驱动代码, 如GPIO驱动、UART驱动等, 程序更新时无需变动.用户代码区存放主函数、中断处理函数代码, 这两块函数代码与具体项目紧密相关, 也是代码更新的变动所在.其中驱动固化区占有30KB的Flash, 可包含KL36芯片所有的基础硬件驱动.</p>
                </div>
                <h3 id="42" name="42" class="anchor-tag">4 <b>服务器端更新软件设计</b></h3>
                <h4 class="anchor-tag" id="43" name="43">4.1 <b>文本有效数据提取</b></h4>
                <div class="p1">
                    <p id="44">Hex文件是可以烧写到单片机中, 被单片机执行的一种文件格式.本系统服务器端更新软件从Hex文件中提取有文本有效数据.Hex的全称是Intel HEX, Intel HEX文件以行为单位, 每一行包含一个Hex记录, 这些记录由对应的机器码十六进制编码数字组成.每行Hex记录由6个部分组成<citation id="93" type="reference"><link href="19" rel="bibliography" /><sup>[<a class="sup">9</a>]</sup></citation>, 如表3所示.Hex文件共有6种记录类型, 分别为数据记录、文件结束记录、扩展段地址记录、开始段地址记录、扩展线性地址记录和链接开始地址记录.数据段中的数据为一行Hex记录中的有效数据, 校验和用于检验Hex记录的正确性, 算法为:校验和=0x100-校验和之前所有16进制数据累加和.</p>
                </div>
                <div class="area_img" id="45">
                    <p class="img_tit"><b>表</b>3 Hex<b>文件记录行语义</b> <a class="downexcel" onclick="DownLoadReportExcel(this)">导出到EXCEL</a></p>
                    <p class="img_tit"></p>
                    <p class="img_note"></p>
                    <table id="45" border="1"><tr><td><br /></td><td>字段1</td><td>字段2</td><td>字段3</td><td>字段4</td><td>字段5</td><td>字段6</td></tr><tr><td><br />名称</td><td>开始符</td><td>数据长度</td><td>地址</td><td>记录类型</td><td>数据段</td><td>检验和</td></tr><tr><td><br />长度</td><td>1字节</td><td>2字节</td><td>2字节</td><td>1字节</td><td>n字节</td><td>1字节</td></tr><tr><td><br />内容</td><td>开始标<br />志“:”</td><td></td><td>数据记<br />录有效</td><td>记录类<br />型:00～05</td><td>取决于记<br />录类型</td><td>所有字节<br />之和的补码</td></tr></table>
                    <form name="form" action="/kxreader/Detail/DownloadReportExcel" method="POST" style="display:inline">
                        <input type="hidden" name="hidTable" value="" />
                        <input type="hidden" name="hidFileName" value="" />
                    </form>
                    <p class="img_note"></p>
                    <p class="img_note"></p>
                </div>
                <div class="area_img" id="46">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/WXYJ201904003_046.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFVsZkNJUGsvbURSNjZHaHV0MCsxOD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图3 Hex文件有效数据提取" src="Detail/GetImg?filename=images/WXYJ201904003_046.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFVsZkNJUGsvbURSNjZHaHV0MCsxOD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit"><b>图</b>3 Hex<b>文件有效数据提取</b>  <a class="btn-zoomin" href="Detail/GetImg?filename=images/WXYJ201904003_046.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFVsZkNJUGsvbURSNjZHaHV0MCsxOD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="p1">
                    <p id="47">图3为Hex文件有效数据提取流程图, 本系统使用结构体变量储存每行数据, 包括数据长度、地址和数据等.每次读取Hex文件一行数据, 取出所有记录类型为00的数据并存入结构体中.</p>
                </div>
                <h4 class="anchor-tag" id="48" name="48">4.2 <b>文本比较算法</b>Needleman/Wunsch</h4>
                <div class="p1">
                    <p id="49">当代码更新变动不大时可以发现更新前后Hex文件有较多相同代码段.本文针对终端节点代码更新变动较少的特点, 结合文本比较算法Needleman/Wunsch, 优化降低更新过程中所需的网络传输量.文本比较算法Needleman/Wunsch是使用动态规划的思想找出两段文本之间的最大公共子序列.因此使用本算法需在服务器端更新软件导入新旧两份Hex文件来作比较.</p>
                </div>
                <div class="p1">
                    <p id="50">文本比较算法Needleman/Wunsch思想如下:<i>X</i><sub><i>i</i></sub> = &lt;<i>x</i><sub>1</sub>, <i>x</i><sub>2</sub>, …, <i>x</i><sub><i>i</i></sub>&gt;为<i>X</i>序列的前<i>i</i>个字符 (1≤<i>i</i>≤<i>m</i>) , <i>Y</i><sub><i>j</i></sub> = &lt;<i>y</i><sub>1</sub>, <i>y</i><sub>2</sub>, …, <i>y</i><sub><i>j</i></sub>&gt;为<i>Y</i>序列的前<i>j</i>个字符 (1≤<i>j</i>≤<i>n</i>) , 序列<i>X</i><sub><i>i</i></sub>和<i>Y</i><sub><i>j</i></sub>的最长公共子序列的长度记录在<i>c</i>[<i>i</i>, <i>j</i>]中.当<i>i</i>=0或<i>j</i>=0时, <i>X</i><sub><i>i</i></sub>和<i>Y</i><sub><i>j</i></sub>的公共子序列为空, 故<i>c</i>[<i>i</i>, <i>j</i>]=0.其他情况下, 可由如下关系求解<citation id="94" type="reference"><link href="21" rel="bibliography" /><sup>[<a class="sup">10</a>]</sup></citation>.</p>
                </div>
                <div class="area_img" id="51">
                    <p class="img_tit"><b>表</b>4 <b>通信帧格式</b> <a class="downexcel" onclick="DownLoadReportExcel(this)">导出到EXCEL</a></p>
                    <p class="img_tit"></p>
                    <p class="img_note"></p>
                    <table id="51" border="1"><tr><td><br />名称</td><td>帧头</td><td>帧长</td><td>总帧数</td><td>当前帧数</td><td>命令</td><td>复制/插入个数</td><td>Flash数据</td><td>校验和</td><td>帧尾</td></tr><tr><td><br />字节数</td><td>2</td><td>2</td><td>2</td><td>2</td><td>1</td><td>1</td><td>n</td><td>2</td><td>2</td></tr></table>
                    <form name="form" action="/kxreader/Detail/DownloadReportExcel" method="POST" style="display:inline">
                        <input type="hidden" name="hidTable" value="" />
                        <input type="hidden" name="hidFileName" value="" />
                    </form>
                    <p class="img_note"></p>
                    <p class="img_note"></p>
                </div>
                <div class="p1">
                    <p id="52" class="code-formula">
                        <mathml id="52"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtable columnalign="left"><mtr><mtd><mi>c</mi><mo stretchy="false">[</mo><mi>i</mi><mo>, </mo><mi>j</mi><mo stretchy="false">]</mo><mo>=</mo></mtd></mtr><mtr><mtd><mrow><mo>{</mo><mrow><mtable><mtr><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mi>c</mi><mo stretchy="false">[</mo><mi>i</mi><mo>-</mo><mn>1</mn><mo>, </mo><mi>j</mi><mo>-</mo><mn>1</mn><mo stretchy="false">]</mo><mo>+</mo><mn>1</mn></mtd></mtr><mtr><mtd><mi>max</mi><mo stretchy="false"> (</mo><mi>c</mi><mo stretchy="false">[</mo><mi>i</mi><mo>, </mo><mi>j</mi><mo>-</mo><mn>1</mn><mo stretchy="false">]</mo><mo>, </mo><mi>c</mi><mo stretchy="false">[</mo><mi>i</mi><mo>-</mo><mn>1</mn><mo>, </mo><mi>j</mi><mo stretchy="false">]</mo><mo stretchy="false">) </mo></mtd></mtr></mtable></mrow></mrow><mtable><mtr><mtd><mtext>i</mtext><mtext>f</mtext><mtext> </mtext><mi>i</mi><mo>=</mo><mn>0</mn><mspace width="0.25em" /><mtext>o</mtext><mtext>r</mtext><mspace width="0.25em" /><mi>j</mi><mo>=</mo><mn>0</mn></mtd></mtr><mtr><mtd><mtext>i</mtext><mtext>f</mtext><mtext> </mtext><mi>i</mi><mo>, </mo><mi>j</mi><mo>&gt;</mo><mn>0</mn><mspace width="0.25em" /><mtext>a</mtext><mtext>n</mtext><mtext>d</mtext><mspace width="0.25em" /><mi>x</mi><msub><mrow></mrow><mi>i</mi></msub><mo>=</mo><mi>y</mi><msub><mrow></mrow><mi>j</mi></msub></mtd></mtr><mtr><mtd><mtext>i</mtext><mtext>f</mtext><mtext> </mtext><mi>i</mi><mo>, </mo><mi>j</mi><mo>&gt;</mo><mn>0</mn><mspace width="0.25em" /><mtext>a</mtext><mtext>n</mtext><mtext>d</mtext><mspace width="0.25em" /><mi>x</mi><msub><mrow></mrow><mi>i</mi></msub><mo>≠</mo><mi>y</mi><msub><mrow></mrow><mi>j</mi></msub></mtd></mtr></mtable></mtd></mtr></mtable></math></mathml>
                    </p>
                </div>
                <div class="p1">
                    <p id="53">最后可根据矩阵<i>c</i>使用动态规划算法自底向上求得两段文本之间的最大公共子序列.当<i>c</i>[<i>i</i>, <i>j</i>]=<i>c</i>[<i>i</i>-1, <i>j</i>-1]+1时, 表示<i>X</i><sub><i>i</i>-1</sub>与<i>Y</i><sub><i>j</i>-1</sub>的最长公共子序列加上<i>x</i><sub><i>i</i></sub>得到的子序列即为<i>X</i><sub><i>i</i></sub>与<i>Y</i><sub><i>j</i></sub>的最长公共子序列.</p>
                </div>
                <div class="p1">
                    <p id="54">要想将文本比较算法Needleman/Wunsch用于本远程更新系统, 需对提取出的Hex有效数据进行一定的优化处理, 本系统将Hex文件每一行有效数据当作一个序列.当比较<i>x</i><sub><i>i</i></sub>和<i>y</i><sub><i>j</i></sub>时, 即比较新旧Hex文件行数据中的有效数据.若有效数据相同则<i>x</i><sub><i>i</i></sub>和<i>y</i><sub><i>j</i></sub>是序列<i>X</i>和<i>Y</i>的公共子序列.将新旧两个Hex文件进行文本比较算法Needleman/Wunsch处理后, 可以知道本次远程更新中不变的代码有哪些, 需要修改的代码有哪些.无需更改的只需告知终端节点该代码段原Flash起始地址、长度和现Flash起始地址, 即可从现有Flash中获取代码数据.需修改的则需要告知终端节点该代码段需插入的Flash起始地址、长度和数据, 然后进行Flash数据插入操作.</p>
                </div>
                <div class="p1">
                    <p id="55">因此使用文本比较算法Needleman/Wunsch可避免传输Flash中已有的、无需变化的代码段, 仅需传递待变动的代码.对于终端节点更新代码变动不大的情况下, 本算法的应用可大大减少远程更新代码网络开销.</p>
                </div>
                <h3 id="56" name="56" class="anchor-tag">5 <b>通信及程序更新</b></h3>
                <h4 class="anchor-tag" id="57" name="57">5.1 <b>服务器端与终端节点通信</b></h4>
                <div class="p1">
                    <p id="58">服务器端更新软件提取出Hex文件有效数据后, 可通过NB-IoT通信方式将更新代码发送至指定的终端节点.本文设计了服务器端软件与终端节点之间的通信帧格式, 来确保远程更新过程中数据的可靠性和安全性, 如表4所示.根据命令字节的不同可分为开始命令帧、复制数据帧、插入数据帧、校验命令帧和更新命令帧五种帧.</p>
                </div>
                <div class="p1">
                    <p id="59">开始命令帧, 命令字节为0.通信帧格式中仅总帧数和命令字节数据有效, 可通知终端节点更新操作开始, 终端节点进行硬件环境准备.</p>
                </div>
                <div class="p1">
                    <p id="60">复制数据帧, 命令字节为1.终端节点可根据复制操作个数和数据内容项知道需进行复制操作的原Flash起始地址、长度和现Flash起始地址, 即可根据终端节点现有的Flash内容进行复制操作, 减少网络传输数据量.</p>
                </div>
                <div class="p1">
                    <p id="61">插入数据帧, 命令字节为2.插入数据帧中数据内容项包含待插入的Flash起始地址、长度和数据, 根据该内容可进行终端节点的Flash插入赋值操作.</p>
                </div>
                <div class="p1">
                    <p id="62">校验命令帧, 命令字节为3.仅命令字节有效, 根据总帧数和每次收到的通信帧中的当前帧数进行判断, 若接收帧数完整则校验成功, 否则终端节点上传告知服务器端软件未接收到的帧号.</p>
                </div>
                <div class="p1">
                    <p id="63">更新命令帧, 命令字节为4.当校验命令帧执行成功后, 方可向终端节点发送更新命令帧.终端节点接收到更新命令后, 进行Flash更新标志设置, 然后系统复位进入Bootloader程序中识别Flash更新标志, 最后进行更新操作.</p>
                </div>
                <h4 class="anchor-tag" id="64" name="64">5.2 <b>代码更新</b></h4>
                <div class="p1">
                    <p id="65">终端节点和服务器端软件按照4.1节中介绍的通信帧格式完成更新代码的传递后会进行终端节点代码的更新.按照图2中Flash区划分角度来观察, 更新代码区用于存放待更新的代码, 在接收到更新命令帧后, 系统复位转向Bootloader程序执行.在Bootloader程序中先对用户代码区的扇区进行擦除, 读取更新代码区数据, 最后将代码数据写入用户代码区.待更新代码替换完毕后, 重设主堆栈指针MSP为用户应用程序起始地址, 并将PC指针指向用户应用程序Reset_Handler函数, 以实现程序跳转功能.跳转函数代码如下.</p>
                </div>
                <div class="area_img" id="95">
                                <img alt="" src="Detail/GetImg?filename=images/WXYJ201904003_09500.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFVsZkNJUGsvbURSNjZHaHV0MCsxOD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                            <p class="img_tit"></p>

                </div>
                <h3 id="77" name="77" class="anchor-tag">6 <b>实验验证与评估</b></h3>
                <div class="p1">
                    <p id="78">在以KL36和BC95为硬件平台的基础上对本文设计的远程软件更新系统进行更新测试, 以验证软件更新的实时性、可靠性和网络开销.</p>
                </div>
                <div class="p1">
                    <p id="79">更新场景如下:修改终端节点信息上传时间间隔为1小时, 并添加采集终端节点温度功能、数据上传失败蜂鸣器报警功能.</p>
                </div>
                <div class="p1">
                    <p id="80">本文同时对本系统更新不同大小的程序所需的网络开销和更新时间进行了对比测试, 实验结果如表5.其中原系统方案是指将Hex文件中所有有效数据传递给终端节点.</p>
                </div>
                <div class="area_img" id="81">
                    <p class="img_tit"><b>表</b>5 <b>更新测试对比表</b> <a class="downexcel" onclick="DownLoadReportExcel(this)">导出到EXCEL</a></p>
                    <p class="img_tit"></p>
                    <p class="img_note"></p>
                    <table id="81" border="1"><tr><td><br />组别</td><td>更新<br />方案</td><td colspan="2">更新代<br />码字节 (k) </td><td colspan="2">更新<br />次数</td><td colspan="2">成功<br />次数</td><td colspan="2">平均更<br />新时间 (s) </td></tr><tr><td><br />组别1</td><td rowspan="2">原系统方案<br />本系统方案<br /><br />原系统方案<br />本系统方案</td><td rowspan="2" colspan="2">30.0<br />1.1<br /><br />27.6<br />1.2</td><td rowspan="2" colspan="2">30<br />30<br /><br />30<br />30</td><td rowspan="2" colspan="2">28<br />30<br /><br />29<br />29</td><td rowspan="2" colspan="2">32.4<br />2.7<br /><br />29.5<br />2.9</td></tr><tr><td><br />组别2</td></tr><tr><td><br />组别3</td><td colspan="2">原系统方案<br />本系统方案</td><td colspan="2">43.2<br />2.7</td><td colspan="2">30<br />30</td><td colspan="2">27<br />29</td><td>44.7<br />4.1<br /></td></tr></table>
                    <form name="form" action="/kxreader/Detail/DownloadReportExcel" method="POST" style="display:inline">
                        <input type="hidden" name="hidTable" value="" />
                        <input type="hidden" name="hidFileName" value="" />
                    </form>
                    <p class="img_note"></p>
                    <p class="img_note"></p>
                </div>
                <div class="p1">
                    <p id="82">测试结果表明:使用本系统实验与目标设计一致, 更新所需网络开销和时间大大减少.同时验证本系统所需的网络开销和更新时间与更新程序的大小无关, 而是与更新程序的变动量相关.这对更新变动量较小的程序而言具有很大的优势, 且随着网络传输数据的减少, 更新成功率也大大提高, 保证了更新系统的可靠性.</p>
                </div>
                <h3 id="83" name="83" class="anchor-tag">7 <b>结束语</b></h3>
                <div class="p1">
                    <p id="84">本文设计一款基于NB-IoT的远程软件更新系统, 在终端节点部分对Flash进行合理划分, 将无需修改的驱动构件放置在驱动固化区, 代码更新时无需修改该区域代码.在服务器端更新软件使用文本比较算法Needleman/Wunsch来优化更新过程中的网络开销, 避免相同代码的重复传输.本文介绍的远程更新系统不仅仅适用于NB-IoT通信方式, 其他远程无线通信方式也可适用.与传统的远程程序更新相比, 本系统可靠、可行、实时性强、网络开销少、更新时间短, 同时具有很好的稳定性与可移植性.目前, 该方案已在NB-IoT远程水质监测系统中成功应用, 实践结果表明, 该设计方法稳定可靠、更新成功率高.</p>
                </div>

        <!--brief end-->
        
        <!--conten left  end-->
        <!--增强附件-->
        

        <!--reference start-->
            <div class="reference anchor-tag" id="a_bibliography">
                    <h3>参考文献</h3>
                                        <p id="3">
                            <a id="bibliography_1" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=CXYY201631088&amp;v=MzAxMTF1Rnl6bVZyekFKalhTZDdHNEg5ZlBybzlOYklRS0RIODR2UjRUNmo1NE8zenFxQnRHRnJDVVJMT2VaZVY=&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFVsZkNJUGsvbURSNjZHaHV0MCsxOD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[1]</b> 曲井致. NB-IoT低速率窄带物联网通信技术现状及发展趋势[J].科技创新与应用, 2016 (31) :115-115.
                            </a>
                        </p>
                        <p id="5">
                            <a id="bibliography_2" target="_blank" href="http://scholar.cnki.net/result.aspx?q=A Primer on 3GPP Narrowband Internet of Things">

                                <b>[2]</b> WANG Y P E, LIN X, Adhikary A, et al. A Primer on 3GPP Narrowband Internet of Things[J]. IEEE Communications Magazine, 2017, 55 (3) :117-123.
                            </a>
                        </p>
                        <p id="7">
                            <a id="bibliography_3" >
                                    <b>[3]</b>
                                 JOSEPH YIU. ARM Cortex-M0与Cortex-M0+权威指南 (第2版) [M]. 北京:清华大学出版社, 2018.
                            </a>
                        </p>
                        <p id="9">
                            <a id="bibliography_4" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Quectel_BC95_AT_Commands_Manual_V1.6">

                                <b>[4]</b> Quectel_BC95_AT_Commands_Manual_V1.6 [DB/OL]. [2017-07-03]. http://www.quectel.com/cn/.
                            </a>
                        </p>
                        <p id="11">
                            <a id="bibliography_5" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=SJSJ201510007&amp;v=MjQwOTVxcUJ0R0ZyQ1VSTE9lWmVWdUZ5em1WcnpBTmlmWVpMRzRIOVROcjQ5Rlk0UUtESDg0dlI0VDZqNTRPM3o=&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFVsZkNJUGsvbURSNjZHaHV0MCsxOD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[5]</b> 顾会光, 王宜怀, 史新峰. 数据无损的远程代码更新的设计与研究[J].计算机工程与设计, 2015, 36 (10) :2633-2639.
                            </a>
                        </p>
                        <p id="13">
                            <a id="bibliography_6" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=XDDJ201604019&amp;v=MjI4NzBmTXE0OUViWVFLREg4NHZSNFQ2ajU0TzN6cXFCdEdGckNVUkxPZVplVnVGeXptVnJ6QVBTblBaTEc0SDk=&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFVsZkNJUGsvbURSNjZHaHV0MCsxOD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[6]</b> 陈瑞杰, 王宜怀, 李会. 一种无线代码可靠更新系统的研究与设计[J].现代电子技术, 2016, 39 (4) :67-71.
                            </a>
                        </p>
                        <p id="15">
                            <a id="bibliography_7" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=DZJY201305015&amp;v=Mjc5NzBMTXFvOUVZWVFLREg4NHZSNFQ2ajU0TzN6cXFCdEdGckNVUkxPZVplVnVGeXptVnJ6QUlUZkJkN0c0SDk=&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFVsZkNJUGsvbURSNjZHaHV0MCsxOD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[7]</b> 陈发堂, 郭丽强. ARM+DSP嵌入式系统BootLoader在LTE中的实现[J].电子技术应用, 2013, 39 (5) :25-28.
                            </a>
                        </p>
                        <p id="17">
                            <a id="bibliography_8" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=DZCL201702035&amp;v=MzAxNDBESDg0dlI0VDZqNTRPM3pxcUJ0R0ZyQ1VSTE9lWmVWdUZ5em1WcnpBSVRmSVlyRzRIOWJNclk5R1lZUUs=&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFVsZkNJUGsvbURSNjZHaHV0MCsxOD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[8]</b> 汪春华, 白稳峰, 刘胤博, 等. 基于CAN总线UDS服务BootLoader应用开发[J].电子测量技术, 2017, 40 (2) :166-170.
                            </a>
                        </p>
                        <p id="19">
                            <a id="bibliography_9" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CBBD&amp;filename=9787302467571000&amp;v=MjA2NzNGcXpHYkM0SE5YS3FJcENaZXNQREJNOHp4VVNtRGQ5U0g3bjN4RTlmYnZuS3JpZlp1OXVGQ3JsVTd2TEpWMGNY&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFVsZkNJUGsvbURSNjZHaHV0MCsxOD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[9]</b> 王宜怀, 朱仕浪, 郭芸. 嵌入式技术基础与实践 (第4版) [M]. 北京:清华大学出版社, 2017.
                            </a>
                        </p>
                        <p id="21">
                            <a id="bibliography_10" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CMFD&amp;filename=1017211808.nh&amp;v=MjQyNjFIODR2UjRUNmo1NE8zenFxQnRHRnJDVVJMT2VaZVZ1Rnl6bVZyekFWRjI2R2JHNUg5bk1wNUViUElRS0Q=&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFVsZkNJUGsvbURSNjZHaHV0MCsxOD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[10]</b> 姜鲜桃. 双序列比对Needleman-Wunsch算法研究[D].呼和浩特:内蒙古农业大学, 2017.
                            </a>
                        </p>
            </div>
        <!--reference end-->
        <!--footnote start-->
        <!--footnote end-->



    </div>

        <input id="fileid" type="hidden" value="WXYJ201904003" />
        <input id="dpi" type="hidden" value="300" />
    </div>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?6e967eb120601ea41b9d312166416aa6";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
</script>

    


<input id="hid_uid" name="hid_uid" type="hidden" value="WEEvREcwSlJHSldRa1FhdXNXaEhoRFVsZkNJUGsvbURSNjZHaHV0MCsxOD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
<input id="hid_kLogin_headerUrl" name="hid_kLogin_headerUrl" type="hidden" value="/KLogin/Request/GetKHeader.ashx%3Fcallback%3D%3F" />
<input id="hid_kLogin_footerUrl" name="hid_kLogin_footerUrl" type="hidden" value="/KLogin/Request/GetKFooter.ashx%3Fcallback%3D%3F" />
<div class="btn-link" style="display: none"><a target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=WXYJ201904003&amp;v=MjgxNDVMRzRIOWpNcTQ5Rlo0UUtESDg0dlI0VDZqNTRPM3pxcUJ0R0ZyQ1VSTE9lWmVWdUZ5em1WcnpBTWpYU1o=&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFVsZkNJUGsvbURSNjZHaHV0MCsxOD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">知网节</a></div>
<div class="popflow" id="popupTips" style="display: none;">
    <div class="popflowArr"></div>
    <div class="popflowCot">
        <div class="hd"><a href="javascript:void(0);" onclick="$('#popupTips').hide();$('#popupmsg').html('')" class="close">X</a></div>
        <div class="bd">
            <p class="mes" id="popupmsg" name="popupmsg"></p>
          
        </div>
    </div>
</div>
<input type="hidden" id="myexport" value="//kns.cnki.net" />

<input type="hidden" id="KPCAPIPATH" value="//ishufang.cnki.net" />
<input type="hidden" id="CitedTimes" value="1" />
<div class="link" id="GLSearch" style="display: none;">
    <i class="icon-trangle"></i>
    <div class="inner">
        <a class="icon" id="copytext">复制</a>
        <a class="icon" target="_blank" onclick="searchCRFD(this)">工具书搜索</a>
    </div>
</div>




<input id="hidVirtualPath" name="hidVirtualPath" type="hidden" value="/kxreader" />
<script src="/kxreader/bundles/detail?v=-ULdk-c6FkZHtJA2KAXPgHnyA8mtgyPnBde_C2VZ2BY1"></script>

<script src="/kxreader/Scripts/layer.min.js" type="text/javascript"></script>

<div id="footerBox" class="rootw footer">
</div>
<script>
    if (typeof FlushLogin == 'function') {
        FlushLogin();
    }
    modifyEcpHeader(true);
</script>

<!--图片放大功能 start-->
<script src="/kxreader/bundles/imagebox?v=W4phPu9SNkGcuPeJclikuVE3PpRyIW_gnfjm_19nynI1"></script>

<script type="text/javascript">
    $(function () {
        var j = $.noConflict();
        j(function () {
            j(".zoom-in,.btn-zoomin").imgbox({
                'alignment': 'center',
                'allowMultiple': false,
                'overlayShow': true
            });
        })
    });
</script>
<!--图片放大功能 end-->
<div class="fixedbar">
    <div class="backtop hiddenV" id="backtop">
        <a id="backTopSide" href="javascript:scroll(0,0);" title=""></a>
    </div>
</div>
<script type="text/javascript" src="/kxreader/Scripts/MathJax-2.6-latest/MathJax.js?config=MML_HTMLorMML-full"></script>

</body>
</html>
