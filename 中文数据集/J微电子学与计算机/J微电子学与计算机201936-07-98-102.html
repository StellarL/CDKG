<!DOCTYPE html>
<html>
<head>
    <title>全文阅读--XML全文阅读--中国知网</title>
    <link rel="icon" href="/kxreader/favicon.ico" />
    <link rel="shortcut Icon" href="/kxreader/favicon.ico" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="keywords" content="文献 XML KBASE CNKI 中国知网" />
    <meta name="description" content="XML文献检索" />
    <link href="/kxreader/Content/css/detail?v=qX2z2KjRAEyQiNfAbKtl7dLnsqFoQ5Jdw3TZfDf0n1k1" rel="stylesheet"/>

    <script type="text/javascript">
        var APPPATH = '/kxreader';
    </script>
</head>

<body>
    
<script type="text/javascript" src="//login.cnki.net/TopLogin/api/loginapi/get?type=top&amp;localCSS=&amp;returnurl=%2f%2fkns.cnki.net%2f%2fKXReader%2fDetail%3fTIMESTAMP%3d637133871780568750%26DBCODE%3dCJFD%26TABLEName%3dCJFDLAST2019%26FileName%3dWXYJ201907019%26RESULT%3d1%26SIGN%3d9Oh%252b4utjATUrXhbrGNPTyEYCsBI%253d"></script>

<div id="headerBox" class="header">
    <div class="topbar">
        <div class="textalign">
            <a href="/kxreader/Detail?dbcode=CJFD&amp;filename=WXYJ201907019&amp;align=md">
                <i class="icon-cen active" title="居中对齐"></i>
            </a>
            <a href="/kxreader/Detail?dbcode=CJFD&amp;filename=WXYJ201907019&amp;align=lt">
                <i class="icon-left " title="左对齐"></i>
            </a>
        </div>
        <h6 class="free-tip"><i class="icon"></i>HTML阅读开放试用阶段，欢迎体验！</h6>
    </div>
</div>

    



<div class="btn-link" style="display: none"><a target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=WXYJ201907019&amp;v=MjIxNTFNcUk5RWJZUUtESDg0dlI0VDZqNTRPM3pxcUJ0R0ZyQ1VSTE9lWmVWdUZ5amtWTC9BTWpYU1pMRzRIOWo=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">知网节</a></div>

    <div class="main">

        

    <div class="sidebar-a">
        <!--sidebar start-->
        <div class="sidenav">
            <div class="arrow"><span></span></div>
            <!--sidebar_list start-->
            <dl class="sidenav-list">
                    <dt class="tit">目录结构</dt>
                            <dd class="guide">
                                    <p><a href="#1" data-title="1 引言 ">1 引言</a><i></i></p>
                                                            </dd>
                            <dd class="guide">
                                    <p><a href="#5" data-title="2 安全状态机的定义 ">2 安全状态机的定义</a><i></i></p>
                                                            </dd>
                            <dd class="guide">
                                    <p><a href="#32" data-title="3 安全状态机的典型应用 ">3 安全状态机的典型应用</a><i></i></p>
                                                                    <ul class="contentbox">
                                                <li><a href="#33" data-title="3.1 芯片初始化">3.1 芯片初始化</a></li>
                                                <li><a href="#41" data-title="3.2 芯片安全状态机的运行示例">3.2 芯片安全状态机的运行示例</a></li>
                                    </ul>
                            </dd>
                            <dd class="guide">
                                    <p><a href="#54" data-title="4 结束语 ">4 结束语</a><i></i></p>
                                                            </dd>
                            <dd class="guide">
                                    <p><a href="#" data-title="文内图表 ">文内图表</a><i></i></p>
                                                                    <ul class="contentbox">
                                                <li><a href="#4" data-title="图1 芯片操作系统架构图">图1 芯片操作系统架构图</a></li>
                                                <li><a href="#13" data-title="图2 安全芯片文件系统架构图">图2 安全芯片文件系统架构图</a></li>
                                                <li><a href="#14" data-title="表1 安全状态机数据格式">表1 安全状态机数据格式</a></li>
                                                <li><a href="#20" data-title="图3 安全状态机变迁">图3 安全状态机变迁</a></li>
                                                <li><a href="#24" data-title="图4 文件访问模式状态机">图4 文件访问模式状态机</a></li>
                                                <li><a href="#30" data-title="表2 文件头中保存文件访问权限的字段">表2 文件头中保存文件访问权限的字段</a></li>
                                                <li><a href="#35" data-title="图5 安全芯片初始化过程">图5 安全芯片初始化过程</a></li>
                                                <li><a href="#37" data-title="表3 文件头结构">表3 文件头结构</a></li>
                                                <li><a href="#44" data-title="图6 实际应用中的安全状态机变化">图6 实际应用中的安全状态机变化</a></li>
                                                <li><a href="#51" data-title="图7 多应用环境下的安全状态机">图7 多应用环境下的安全状态机</a></li>
                                    </ul>
                            </dd>
                                    <dd class="guide">
                                        <h6>
                                            <p><a href="#a_bibliography">参考文献</a> </p>
                                        </h6>
                                    </dd>

            </dl>
        </div>
        <!--sidebar end-->
        &nbsp;
        <!--此处有一空格符 勿删-->
    </div>

                <div class="sidebar-b three-collumn" style="width:0;">
            <div class="refer" style="width: 0;">
                <div class="arrow off" title="参考文献"><span></span></div>
                <div class="js-scrollbox" >
                    
                    <div class="subbox active">
                        <h4>
                            <span class="tit">参考文献</span>
                            <a class="close" href="javascript:void(0)">x</a>
                        </h4>
                        <div class="side-scroller">
                            <ul class="refer-list">
                                <li id="58">


                                    <a id="bibliography_1" title="刘丁丽, 张大方, 宁佐廷, 等.基于SM1算法的文件安全机制设计与实现[J].计算机应用与软件, 2015, 32 (12) :316-320." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JYRJ201512076&amp;v=MDU2NThRS0RIODR2UjRUNmo1NE8zenFxQnRHRnJDVVJMT2VaZVZ1Rnlqa1ZML0FMelRaWkxHNEg5VE5yWTlDWW8=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[1]</b>
                                        刘丁丽, 张大方, 宁佐廷, 等.基于SM1算法的文件安全机制设计与实现[J].计算机应用与软件, 2015, 32 (12) :316-320.
                                    </a>
                                </li>
                                <li id="60">


                                    <a id="bibliography_2" title="FU Q Q.An improved smart card authentication method[J].Computer Engineering and Science.2014, 36 (1) , 94-98." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=An improved smart card authentication method">
                                        <b>[2]</b>
                                        FU Q Q.An improved smart card authentication method[J].Computer Engineering and Science.2014, 36 (1) , 94-98.
                                    </a>
                                </li>
                                <li id="62">


                                    <a id="bibliography_3" title="CHEN H J.An implement of the digital certificate on electrical IC card[J].CRC Press/Balkema, 2015, 725-727." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=An implement of the digital certificate on electrical IC card">
                                        <b>[3]</b>
                                        CHEN H J.An implement of the digital certificate on electrical IC card[J].CRC Press/Balkema, 2015, 725-727.
                                    </a>
                                </li>
                                <li id="64">


                                    <a id="bibliography_4" title="徐平江.基于链表方式的智能卡文件系统设计[J].微计算机信息, 2011, 27 (11) :49-50." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=WJSJ201111023&amp;v=MTk2MTJGeWprVkwvQU1pZllaTEc0SDlETnJvOUhaNFFLREg4NHZSNFQ2ajU0TzN6cXFCdEdGckNVUkxPZVplVnU=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[4]</b>
                                        徐平江.基于链表方式的智能卡文件系统设计[J].微计算机信息, 2011, 27 (11) :49-50.
                                    </a>
                                </li>
                                <li id="66">


                                    <a id="bibliography_5" title="赵东艳, 王于波.一种智能卡写保护机制的实现[J].电子技术应用, 2014 (12) :32-34." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=DZCS201412017&amp;v=MzI3MjY0VDZqNTRPM3pxcUJ0R0ZyQ1VSTE9lWmVWdUZ5amtWTC9BSVRmSWZiRzRIOVhOclk5RVk0UUtESDg0dlI=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[5]</b>
                                        赵东艳, 王于波.一种智能卡写保护机制的实现[J].电子技术应用, 2014 (12) :32-34.
                                    </a>
                                </li>
                                <li id="68">


                                    <a id="bibliography_6" title="王爱英.智能卡技术[M].北京:清华大学出版社, 2009." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CBBD&amp;filename=9787302202400001&amp;v=MzI0MTBVU21EZDlTSDduM3hFOWZidm5LcmlmWnU5dUZDcmxVNy9KSjE0Y1hGcXpHYkM0SE5QTXJZdEZaT3NQRFJNOHp4&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[6]</b>
                                        王爱英.智能卡技术[M].北京:清华大学出版社, 2009.
                                    </a>
                                </li>
                                <li id="70">


                                    <a id="bibliography_7" >
                                        <b>[7]</b>
                                    明华科技.SmartCos-PK-manual Version 1.0[M].深圳:深圳市明华澳汉科技股份有限公司, 2000.</a>
                                </li>
                                <li id="72">


                                    <a id="bibliography_8" title="李涛, 曾英.一种新的基于动态口令的远程双向认证[J].微计算机信息, 2007, 11 (3) :38-40." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=WJSJ200733016&amp;v=MDg5MzRqa1ZML0FNaWZZWkxHNEh0YlBySTlFWW9RS0RIODR2UjRUNmo1NE8zenFxQnRHRnJDVVJMT2VaZVZ1Rnk=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[8]</b>
                                        李涛, 曾英.一种新的基于动态口令的远程双向认证[J].微计算机信息, 2007, 11 (3) :38-40.
                                    </a>
                                </li>
                                <li id="74">


                                    <a id="bibliography_9" title="韦小刚, 黄益彬, 杨维永.一种基于ISO/IEC 7816的COS的设计与实现[J].计算机技术与发展, 2012, 22 (3) :230-232." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=WJFZ201203061&amp;v=MjIxMTR6cXFCdEdGckNVUkxPZVplVnVGeWprVkwvQU1pZk5kTEc0SDlQTXJJOURaWVFLREg4NHZSNFQ2ajU0TzM=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[9]</b>
                                        韦小刚, 黄益彬, 杨维永.一种基于ISO/IEC 7816的COS的设计与实现[J].计算机技术与发展, 2012, 22 (3) :230-232.
                                    </a>
                                </li>
                            </ul>
                            <div style='display: none;' class="zqscroller" >
                                <h4 class="">附加材料</h4>
                                <ul></ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            &nbsp;
            <!--此处有一空格符 勿删-->
        </div>

        
    <div class="content">



        <!--tips start-->
                            <div class="tips">
                    <a href="http://navi.cnki.net/KNavi/JournalDetail?pcode=CJFD&amp;pykm=WXYJ" target="_blank">微电子学与计算机</a>
                2019,36(07),98-102             </div>
        <!--tips end-->
            <div class="top-title">
                <h1 class="title">
                    <span class="vm">基于状态机的芯片访问控制实现</span>
                                    </h1>

            </div>
                        <h2>
                                <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=au&amp;skey=%E5%BE%90%E5%B9%B3%E6%B1%9F&amp;code=38305685&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">徐平江</a>
                                <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=au&amp;skey=%E8%A2%81%E8%89%B3%E8%8A%B3&amp;code=38306952&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">袁艳芳</a>
                                <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=au&amp;skey=%E4%BB%98%E9%9D%92%E7%90%B4&amp;code=38306953&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">付青琴</a>
                </h2>
                    <h2>
                    <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=in&amp;skey=%E5%8C%97%E4%BA%AC%E6%99%BA%E8%8A%AF%E5%BE%AE%E7%94%B5%E5%AD%90%E7%A7%91%E6%8A%80%E6%9C%89%E9%99%90%E5%85%AC%E5%8F%B8&amp;code=1702167&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">北京智芯微电子科技有限公司</a>
            </h2>

        
<div class="link">
    <a id="aexport" class="icon icon-output"  onclick="" href="javascript:void(0);"><i></i>导出/参考文献</a>
    
    <span class="shareBoard" onmouseover="$('#sharedet').show();$('#this').addClass('shareBoardCUR')" onmouseout="$('#sharedet').hide();$('#this').removeClass('shareBoardCUR')">
        <a class="icon icon-share" href="#"><i></i>分享<em></em></a>
        <ul class="shareHide" id="sharedet" style="display: none;">
            <li><a title="复制链接" class="copy" onclick="" href="#"><i></i>复制链接</a></li>
            <li><a title="分享到新浪微博" class="xl" onclick="" href="javascript:common.ShareAction('xl');"><i></i>新浪微博</a></li>
            <li>
                <a title="分享到微信" class="wx" onclick="" href="#"><i></i>微信扫一扫</a>
                <div class="qrcode"><img src='' alt='' /></div>
            </li>
        </ul>

    </span>
    
    <a id="RefTrack" title="创建引文跟踪" class="icon icon-track" onclick="" href="javascript:void(0);"> <i></i>创建引文跟踪 </a>
    <a id="ashoucang" title="收藏" class="icon icon-favor" onclick="" href="javascript:void(0);"><i></i>收藏</a>
    <a class="icon icon-print" onclick="window.print();" href="javascript:void(0);"><i></i>打印</a>
    
    <!--版本切换 end-->
</div>
                            <div class="data" id="a_abstract">
                <span class="keys">摘<span style="font-family: 'Times New Roman';">&nbsp;&nbsp;&nbsp;&nbsp;</span>要：</span>
                <p>本文提出了一种芯片访问控制方法, 解决了多应用芯片中文件的访问权限控制问题.该方法首先设计了一种安全权限状态机, 该状态机将访问权限细分为32级, 在用户指令的驱动下安全状态机发生安全状态的变迁, 只有安全状态满足预置的文件访问条件, 文件访问才被许可.同时为了隔离不同应用的访问权限, 定义了环境权限状态机和应用权限状态机.环境状态机控制芯片整体访问权限, 应用状态机控制单个应用的访问权限, 通过两种状态机的组合应用, 实现芯片文件访问控制的精细化管理.</p>
            </div>
                    <div class="data" id="a_keywords">
                <span class="keys">关键词：</span>
                <p>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=%E5%AE%89%E5%85%A8%E8%8A%AF%E7%89%87&amp;code=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">安全芯片;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6&amp;code=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">访问控制;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=%E5%AE%89%E5%85%A8%E7%8A%B6%E6%80%81&amp;code=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">安全状态;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F&amp;code=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">文件系统;</a>
                </p>
            </div>
        
        <!--brief start-->
        
            <div class="brief">
                    <p>
                            <b>作者简介：</b>
                                                        <span>
                                    徐平江 男, (1977-) , 硕士, 工程师.研究方向为安全芯片操作系统.E-mail:xupingjiang@126.com.;
                                </span>
                                <span>
                                    袁艳芳 女, (1980-) , 硕士.研究方向为智能电网.;
                                </span>
                                <span>
                                    付青琴 女, (1982-) , 硕士, 副高.研究方向为电力芯片测试.;
                                </span>
                    </p>
                                    <p><b>收稿日期：</b>2018-10-08</p>

                    <p>

                            <b>基金：</b>
                                                        <span>国家重点研发计划 (2018YFB0407502);</span>
                    </p>
            </div>
                    <h1>Implementation of chip access control based on state machine</h1>
                    <h2>
                    <span>XU Ping-jiang</span>
                    <span>YUAN Yang-fang</span>
                    <span>FU Qing-qin</span>
            </h2>
                    <h2>
                    <span>Beijing Smartchip Microelectronics Technology Company Ltd</span>
            </h2>
                            <div class="data" id="a_abstractEN">
                <span class="keys">Abstract：</span>
                <p>A chip access control method is proposed in this paper to solve the file access control problem of multiapplications chip.Firstly, a security state machine is designed, which subdivides the access right into 32 levels.Driven by user instructions, the security state machine undergoes security state transition.Only when the security state meets the preset file access conditions, file access is allowed.At the same time, in order to isolate the access right of different applications, the environment state machine and the application state machine are defined.The environment state machine controls the access authority of the chip as a whole, the application state machine controls the access authority of a single application, and through the combination of two state machines, the fine management of chip file access control is realized.</p>
            </div>
                    <div class="data" id="a_keywordsEN">
                <span class="keys">Keyword：</span>
                <p>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=security%20chip&amp;code=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">security chip;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=access%20control&amp;code=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">access control;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=state%20of%20safety&amp;code=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">state of safety;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=file%20system&amp;code=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">file system;</a>
                </p>
            </div>
                    <div class="brief">
                
                    <p>
                                            </p>
                                    <p><b>Received：</b> 2018-10-08</p>
                                    <p>
                                            </p>
            </div>


        <!--brief start-->
                        <h3 id="1" name="1" class="anchor-tag">1 引言</h3>
                <div class="p1">
                    <p id="2">随着微电子技术的迅猛发展, 各种各样的电子设备如雨后春笋般的涌现.这些设备极大的帮助人们更好的工作、学习, 然而这些设备的使用有时候会需要进行用户的身份识别.在各种终端上建立用户名和密码是解决身份认证问题的一个手段, 然而这种认证方法将终端与用户绑定, 当用户更换设备后往往无法直接使用.同时一些第三方的服务提供商为终端设备提供附加服务, 这些服务需要载入服务商自己的硬件设备.为了实现更多样的身份认证及附加服务, 安全芯片类的产品被广泛应用于当前的电子产品中.人们熟知的如智能手机SIM卡、金融领域的U盾, 或者各类不被人知、在设备中默默工作的ESAM、PSAM芯片等.</p>
                </div>
                <div class="p1">
                    <p id="3">这些安全芯片一般具有独立的CPU和具备国密资质的算法模块, 安装到终端主机中为其提供计算服务、数据保存和安全认证功能.为了实现不同的业务功能, 安全芯片会搭载一个芯片操作系统 (COS) .COS通常是一个分层结构分为固件系统、存储管理系统、文件系统、安全体系及应用指令系统, 如图1所示.其中应用指令中的通用指令部分、安全体系、文件及存储管理部分是COS中相对稳定的部分, 被称为操作系统平台.平台在更换固件层后可以在不同芯片硬件上使用, 而不同的行业应用是COS中最灵活的部分, 通常应用功能都需要通过相关行业的检测认证才能给用户提供<citation id="76" type="reference"><link href="58" rel="bibliography" /><link href="60" rel="bibliography" /><link href="62" rel="bibliography" /><sup>[<a class="sup">1</a>,<a class="sup">2</a>,<a class="sup">3</a>]</sup></citation>.</p>
                </div>
                <div class="area_img" id="4">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/WXYJ201907019_00400.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图1 芯片操作系统架构图" src="Detail/GetImg?filename=images/WXYJ201907019_00400.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图1 芯片操作系统架构图  <a class="btn-zoomin" href="Detail/GetImg?filename=images/WXYJ201907019_00400.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <h3 id="5" name="5" class="anchor-tag">2 安全状态机的定义</h3>
                <div class="p1">
                    <p id="6">芯片中的安全防护主要包括对人员及终端设备身份合法性验证及片内文件访问的权限校验.通常的方法是芯片执行认证指令成功后获得对应操作的安全权限, 然而芯片上需要进行安全控制的操作非常多, 为这些操作全部设置相应的权限认证指令过于繁杂、难以实现.为了实现安全的精细管理, 又不增加过多的冗余指令需要设计一个巧妙的安全体系来满足芯片操作权限控制需求.</p>
                </div>
                <div class="p1">
                    <p id="7">不同的应用对安全体系的要求不同, 本文将实现一个安全功能状态机, 通过安全状态机的状态变迁, 在不同层次满足应用对安全的要求.</p>
                </div>
                <div class="p1">
                    <p id="8">在安全芯片中用户数据通常以文件形式保存, 而功能相关联的基本文件 (EF) 经常保存在一起形成一个应用目录 (ADF) .功能相近的应用目录共同形成环境目录 (DF) , 最终应用目录和环境目录共同归属于系统根目录 (MF) .</p>
                </div>
                <div class="p1">
                    <p id="9">安全芯片的基本文件 (EF) 按文件数据的保存格式可以将基本文件分为两类:</p>
                </div>
                <div class="p1">
                    <p id="10"> (1) 透明文件:文件数据是通过连续空间中的字节地址进行存取.</p>
                </div>
                <div class="p1">
                    <p id="11"> (2) 记录文件:数据以固定格式记录在文件中, 文件内最多可以容纳255条记录.</p>
                </div>
                <div class="p1">
                    <p id="12">图2显示了安全芯片内部文件系统的架构, 可以看到不同的应用对应不同的文件目录.对应不同的目录可以为其定义应用的安全状态机S<sub>local</sub>, 而对于整个芯片而言定义一个控制环境的安全状态机S<sub>global</sub>.安全状态机定义为一个8bit的全局变量, 定义如表1所示.</p>
                </div>
                <div class="area_img" id="13">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/WXYJ201907019_01300.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图2 安全芯片文件系统架构图" src="Detail/GetImg?filename=images/WXYJ201907019_01300.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图2 安全芯片文件系统架构图  <a class="btn-zoomin" href="Detail/GetImg?filename=images/WXYJ201907019_01300.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="area_img" id="14">
                                            <p class="img_tit">
                                                表1 安全状态机数据格式
                                                
                                                &nbsp;&nbsp;
                                                <a class="btn-zoomin" href="Detail/GetImg?filename=images/WXYJ201907019_01400.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a>
                                                <a class="table downimg" data-tablename="Detail/GetImg?filename=images/WXYJ201907019_01400.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">下载原表</a>
                                            </p>
                                    <a class="zoom-in" href="Detail/GetImg?filename=images/WXYJ201907019_01400.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <img alt="表1 安全状态机数据格式" src="Detail/GetImg?filename=images/WXYJ201907019_01400.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                    </a>

                </div>
                <div class="p1">
                    <p id="15">为了便于描述, 将安全状态机S定义如下:</p>
                </div>
                <div class="area_img" id="16">
                            <div class="imgformula">
                                <img class="pFormula" alt="" src="Detail/GetImg?filename=images/WXYJ201907019_01600.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                <p class="formula_seq"></p>
                            </div>

                </div>
                <div class="p1">
                    <p id="17">安全状态机由两个子状态机组成, 其中M是文件访问模式状态机, R是文件访问权限状态机.下面以图示的方法说明两种状态机的定义.</p>
                </div>
                <div class="p1">
                    <p id="18">为了便于描述, 引入状态变迁图来说明以上两种状态机的工作过程.状态变迁图L= (R/M, T, F) , 其中R/M表示权限状态或者文件访问状态, T是引发状态改变的指令集合, F是状态转变弧集合.</p>
                </div>
                <div class="p1">
                    <p id="19">图3中0≤R<sub>i</sub>&lt;32, 由于安全芯片中的文件数量较少, 因此将其划分为32级访问权限.</p>
                </div>
                <div class="area_img" id="20">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/WXYJ201907019_02000.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图3 安全状态机变迁" src="Detail/GetImg?filename=images/WXYJ201907019_02000.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图3 安全状态机变迁  <a class="btn-zoomin" href="Detail/GetImg?filename=images/WXYJ201907019_02000.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="p1">
                    <p id="21">而T<sub>i</sub>表示安全芯片可执行的权限命令及其返回结果的集合, 即T<sub>i</sub>={APDU∪SW}.其中AP-DU是可以触发安全状态变化的芯片指令集合, 包括校验PIN命令、外部认证命令、应用选择指令、芯片初始化指令等.SW表示指令执行结果的状态码集合, 分为成功状态码和各种不同原因的失败状态码, 指令执行结果直接影响芯片状态机当前状态.</p>
                </div>
                <div class="p1">
                    <p id="22">图4为文件访问模式状态机, 由文件访问指令T<sub>i</sub>触发的文件访问模式一共8种, 由三种文件基本操作明文读、密文读及MAC校验组合而成.将文件访问状态定义为小于8的正整数, 则有0≤M<sub>i</sub>&lt;8.</p>
                </div>
                <div class="area_img" id="24">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/WXYJ201907019_02400.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图4 文件访问模式状态机" src="Detail/GetImg?filename=images/WXYJ201907019_02400.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图4 文件访问模式状态机  <a class="btn-zoomin" href="Detail/GetImg?filename=images/WXYJ201907019_02400.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="p1">
                    <p id="25">可以看到图3的安全状态机是封闭路径, 而图4的安全状态机为开放路径, 造成这种区别的原因是状态机的驱动方式不同.访问权限状态机状态转换和芯片指令的执行结果紧密相关, 只有指令执行成功状态机才会改变并影响下一条指令的执行状态.而访问模式状态机的状态转换只和指令本身有关, 指令是否运行成功不会影响状态机, 不会对下一条指令有任何影响.</p>
                </div>
                <div class="p1">
                    <p id="26">最终安全状态机S是文件访问状态M和访问权限R的集合.校验状态机S时需要分别鉴别这两个分量是否都满足预置安全条件条件.</p>
                </div>
                <div class="p1">
                    <p id="27">假设安全芯片的文件访问权限设置为访问上限R<sub>min</sub>和访问下限R<sub>max</sub>, 文件访问模式为M<sub>spec</sub>, 只有状态机分量满足以下条件才能允许文件访问操作:</p>
                </div>
                <div class="area_img" id="28">
                            <div class="imgformula">
                                <img class="pFormula" alt="" src="Detail/GetImg?filename=images/WXYJ201907019_02800.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                <p class="formula_seq"></p>
                            </div>

                </div>
                <div class="p1">
                    <p id="29">文件访问权限属于文件固有信息, 需要保存在文件中.在安全芯片文件系统设计中, 文件通常采用文件头和文件体分离的设计<citation id="77" type="reference"><link href="64" rel="bibliography" /><sup>[<a class="sup">4</a>]</sup></citation>方法实现.文件头中保存文件概要信息, 便于文件的选择、更新等操作, 而文件体保存用户数据.为了保存安全芯片发行时的为每一个文件确定的访问权限, 在文件头中开辟2个字节保存其权限, 如表2所示.</p>
                </div>
                <div class="area_img" id="30">
                                            <p class="img_tit">
                                                表2 文件头中保存文件访问权限的字段
                                                
                                                &nbsp;&nbsp;
                                                <a class="btn-zoomin" href="Detail/GetImg?filename=images/WXYJ201907019_03000.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a>
                                                <a class="table downimg" data-tablename="Detail/GetImg?filename=images/WXYJ201907019_03000.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">下载原表</a>
                                            </p>
                                    <a class="zoom-in" href="Detail/GetImg?filename=images/WXYJ201907019_03000.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <img alt="表2 文件头中保存文件访问权限的字段" src="Detail/GetImg?filename=images/WXYJ201907019_03000.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                    </a>

                </div>
                <div class="p1">
                    <p id="31">安全芯片执行身份认证相关操作时, 通常需要使用密钥进行计算或验证.认证通过, 则用户将获得密钥中规定的安全权限.同样用户可以为每一条密钥定制安全权限K (0≤K&lt;32) , 其值保存在每一条密钥的密钥头信息中<citation id="78" type="reference"><link href="66" rel="bibliography" /><link href="68" rel="bibliography" /><sup>[<a class="sup">5</a>,<a class="sup">6</a>]</sup></citation>.</p>
                </div>
                <h3 id="32" name="32" class="anchor-tag">3 安全状态机的典型应用</h3>
                <h4 class="anchor-tag" id="33" name="33">3.1 芯片初始化</h4>
                <div class="p1">
                    <p id="34">安全芯片在使用之前需要完成两步初始化操作:预个人化和个人化.通常由芯片厂家完成操作系统 (COS) 下载和文件系统建立工作, 此过程称为预个人化.用户完成芯片的个性化数据写入, 包括密钥数据、身份信息和缺省设置等, 此过程称为个人化.芯片初始化过程如图5所示.</p>
                </div>
                <div class="area_img" id="35">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/WXYJ201907019_03500.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图5 安全芯片初始化过程" src="Detail/GetImg?filename=images/WXYJ201907019_03500.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图5 安全芯片初始化过程  <a class="btn-zoomin" href="Detail/GetImg?filename=images/WXYJ201907019_03500.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="p1">
                    <p id="36">芯片中的文件通常由文件头和文件体组成, 结构如表3.</p>
                </div>
                <div class="area_img" id="37">
                                            <p class="img_tit">
                                                表3 文件头结构
                                                
                                                &nbsp;&nbsp;
                                                <a class="btn-zoomin" href="Detail/GetImg?filename=images/WXYJ201907019_03700.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a>
                                                <a class="table downimg" data-tablename="Detail/GetImg?filename=images/WXYJ201907019_03700.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">下载原表</a>
                                            </p>
                                    <a class="zoom-in" href="Detail/GetImg?filename=images/WXYJ201907019_03700.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <img alt="表3 文件头结构" src="Detail/GetImg?filename=images/WXYJ201907019_03700.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                    </a>

                </div>
                <div class="p1">
                    <p id="38">表3中的file access permission属性表示该文件的安全属性, 该属性在表2定义.当文件被访问时, 需要判断安全状态机的当前状态是否满足文件安全属性规定的安全等级.</p>
                </div>
                <div class="p1">
                    <p id="39">文件的访问模式指访问文件时, 对数据组织形式的要求.输入或输出数据的组织形式包括明文数据、密文数据、明文数据加校验码和密文加校验码等 (在某些应用场合还存在明密文混合打包的情况) .如果用户发给芯片的文件访问指令中隐含的访问模式和文件发行时写入文件头的访问模式不符, 此次访问仍然会被芯片拒绝.</p>
                </div>
                <div class="p1">
                    <p id="40">文件头中的Key index字段表示密钥索引号, 通过该密钥索引找到对应密钥进行对文件数据的加密或计算校验码操作<citation id="79" type="reference"><link href="70" rel="bibliography" /><link href="72" rel="bibliography" /><sup>[<a class="sup">7</a>,<a class="sup">8</a>]</sup></citation>.</p>
                </div>
                <h4 class="anchor-tag" id="41" name="41">3.2 芯片安全状态机的运行示例</h4>
                <div class="p1">
                    <p id="42">现在通过执行典型的芯片文件访问操作来验证安全状态机是否能正常工作.假定芯片已经完成发行, 文件系统的根目录是MF, 电力应用目录为ADF01, 数据文件名称为EF01, EF01的访问权限为R∈ (2, 8) , 文件访问模式明文读, 其属性值为0即M=0, 芯片外部认证密钥的权限为6.</p>
                </div>
                <div class="p1">
                    <p id="43">如图6所示, 当芯片上电后执行初始化命令T<sub>1</sub>, 安全状态机为初始状态R<sub>1</sub>=0.用户执行选择电力应用命令T<sub>2</sub>, 安全状态机为应用初始状态R<sub>2</sub>=0.此时用户进行身份认证, 发送外部认证命令T<sub>3</sub>, 芯片收到命令后, 读取外部认证密钥对认证数据进行加密计算并校验.如果身份认证命令执行成功, 则读取外部认证密钥对应权限6并将安全状态机设置为认证通过状态R<sub>3</sub>=6.</p>
                </div>
                <div class="area_img" id="44">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/WXYJ201907019_04400.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图6 实际应用中的安全状态机变化" src="Detail/GetImg?filename=images/WXYJ201907019_04400.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图6 实际应用中的安全状态机变化  <a class="btn-zoomin" href="Detail/GetImg?filename=images/WXYJ201907019_04400.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="p1">
                    <p id="45">芯片完成上述操作后进行文件访问, 发送明文读EF01指令T<sub>4</sub>, 对文件进行明文读操作, 芯片解析指令后给文件访问状态赋值为明文读, 即M=0.T<sub>4</sub>指令在读取文件数据前, 将校验已经获得的安全状态和文件发行时配置的条件是否匹配, 即需要满足以下条件:</p>
                </div>
                <div class="area_img" id="46">
                            <div class="imgformula">
                                <img class="pFormula" alt="" src="Detail/GetImg?filename=images/WXYJ201907019_04600.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                <p class="formula_seq"></p>
                            </div>

                </div>
                <div class="p1">
                    <p id="47">只有当安全状态机S的文件访问权限R<sub>3</sub>和文件访问状态M都满足式1的要求时, 文件访问才被许可.</p>
                </div>
                <div class="p1">
                    <p id="48">由以上可以看到, 当用户为每一个文件预置访问权限区间及访问模式后, 文件访问变得可控, 文件能否访问的关键就是用户设置的密钥权限和用户命令隐含的访问模式.用户可以通过验证PIN码、身份认证等方式获得访问权限, 通过命令本身可以解析出访问模式.同时当应用目录切换或芯片初始化后其权限清除.</p>
                </div>
                <div class="p1">
                    <p id="49">安全芯片一个应用环境下可能会承载多个应用, 例如电力环境下会派生电动汽车应用和电表缴费应用.不同的电力应用会有共同的用户数据文件, 比如用户名信息、密钥信息等.这些文件作为共有信息保存在应用环境下.不同应用独有的费率信息、运行参数及钱包文件等必须放在对应的应用目录下.应用环境由多个子应用组成, 此时用一个安全状态机对不同的子应用进行访问控制显然不能满足安全访问要求.</p>
                </div>
                <div class="p1">
                    <p id="50">为了满足不同应用的安全需求, 在芯片中定义了环境安全状态机和应用安全状态机, 如图7所示.</p>
                </div>
                <div class="area_img" id="51">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/WXYJ201907019_05100.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图7 多应用环境下的安全状态机" src="Detail/GetImg?filename=images/WXYJ201907019_05100.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图7 多应用环境下的安全状态机  <a class="btn-zoomin" href="Detail/GetImg?filename=images/WXYJ201907019_05100.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="p1">
                    <p id="52">在环境目录下, 对文件的访问需要检查环境权限状态机, 当用户选择具体应用以后, 环境状态机变为低优先级, 权限校验优先使用应用权限状态机, 只有该应用没有定义自己的安全状态时才会使用环境状态机作为缺省的安全保护措施.</p>
                </div>
                <div class="p1">
                    <p id="53">环境权限状态机为S<sub>e</sub>=M<sub>e</sub>∪R<sub>e</sub>, 应用权限状态机为S<sub>a</sub>=M<sub>a</sub>∪R<sub>a</sub>.</p>
                </div>
                <h3 id="54" name="54" class="anchor-tag">4 结束语</h3>
                <div class="p1">
                    <p id="55">本文提出了一种芯片安全防护方法, 根据芯片的应用特点设计了一种安全权限状态机.该状态机在芯片指令的驱动下实现芯片安全状态的变迁, 个性化的为文件定制访问权限区间及访问状态.只有安全状态机的权限等级S包含在文件访问权限区间且安全状态机的文件访问状态等于预置的文件访问状态时, 文件访问才被许可.</p>
                </div>
                <div class="p1">
                    <p id="56">为了细化安全管理, 定义了管辖权限不同的安全状态机.满足用户在不同应用切换时不同的安全需求.</p>
                </div>
                <div class="p1">
                    <p id="57">依据本方法设计的安全芯片COS系统, 由于采用模块化分层设计, 具有非常好的可移植性和可扩展性, 而且在功能测试中验证了其良好的安全性.由于安全保护的实施会带来芯片执行效率的下降, 因此在满足安全需求的条件下尽量简化安全设计是本项工作的目标<citation id="80" type="reference"><link href="74" rel="bibliography" /><sup>[<a class="sup">9</a>]</sup></citation>.</p>
                </div>

        <!--brief end-->
        
        <!--conten left  end-->
        <!--增强附件-->
        

        <!--reference start-->
            <div class="reference anchor-tag" id="a_bibliography">
                    <h3>参考文献</h3>
                                        <p id="58">
                            <a id="bibliography_1" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JYRJ201512076&amp;v=MDUxODR2UjRUNmo1NE8zenFxQnRHRnJDVVJMT2VaZVZ1Rnlqa1ZML0FMelRaWkxHNEg5VE5yWTlDWW9RS0RIODQ=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[1]</b>刘丁丽, 张大方, 宁佐廷, 等.基于SM1算法的文件安全机制设计与实现[J].计算机应用与软件, 2015, 32 (12) :316-320.
                            </a>
                        </p>
                        <p id="60">
                            <a id="bibliography_2" target="_blank" href="http://scholar.cnki.net/result.aspx?q=An improved smart card authentication method">

                                <b>[2]</b>FU Q Q.An improved smart card authentication method[J].Computer Engineering and Science.2014, 36 (1) , 94-98.
                            </a>
                        </p>
                        <p id="62">
                            <a id="bibliography_3" target="_blank" href="http://scholar.cnki.net/result.aspx?q=An implement of the digital certificate on electrical IC card">

                                <b>[3]</b>CHEN H J.An implement of the digital certificate on electrical IC card[J].CRC Press/Balkema, 2015, 725-727.
                            </a>
                        </p>
                        <p id="64">
                            <a id="bibliography_4" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=WJSJ201111023&amp;v=MjU5NTR6cXFCdEdGckNVUkxPZVplVnVGeWprVkwvQU1pZllaTEc0SDlETnJvOUhaNFFLREg4NHZSNFQ2ajU0TzM=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[4]</b>徐平江.基于链表方式的智能卡文件系统设计[J].微计算机信息, 2011, 27 (11) :49-50.
                            </a>
                        </p>
                        <p id="66">
                            <a id="bibliography_5" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=DZCS201412017&amp;v=MjIxOTlBSVRmSWZiRzRIOVhOclk5RVk0UUtESDg0dlI0VDZqNTRPM3pxcUJ0R0ZyQ1VSTE9lWmVWdUZ5amtWTC8=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[5]</b>赵东艳, 王于波.一种智能卡写保护机制的实现[J].电子技术应用, 2014 (12) :32-34.
                            </a>
                        </p>
                        <p id="68">
                            <a id="bibliography_6" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CBBD&amp;filename=9787302202400001&amp;v=MDE0NjU3L0pKMTRjWEZxekdiQzRITlBNcll0RlpPc1BEUk04enhVU21EZDlTSDduM3hFOWZidm5LcmlmWnU5dUZDcmxV&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[6]</b>王爱英.智能卡技术[M].北京:清华大学出版社, 2009.
                            </a>
                        </p>
                        <p id="70">
                            <a id="bibliography_7" >
                                    <b>[7]</b>
                                明华科技.SmartCos-PK-manual Version 1.0[M].深圳:深圳市明华澳汉科技股份有限公司, 2000.
                            </a>
                        </p>
                        <p id="72">
                            <a id="bibliography_8" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=WJSJ200733016&amp;v=MDcyMDFpZllaTEc0SHRiUHJJOUVZb1FLREg4NHZSNFQ2ajU0TzN6cXFCdEdGckNVUkxPZVplVnVGeWprVkwvQU0=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[8]</b>李涛, 曾英.一种新的基于动态口令的远程双向认证[J].微计算机信息, 2007, 11 (3) :38-40.
                            </a>
                        </p>
                        <p id="74">
                            <a id="bibliography_9" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=WJFZ201203061&amp;v=MTA1NzNJOURaWVFLREg4NHZSNFQ2ajU0TzN6cXFCdEdGckNVUkxPZVplVnVGeWprVkwvQU1pZk5kTEc0SDlQTXI=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[9]</b>韦小刚, 黄益彬, 杨维永.一种基于ISO/IEC 7816的COS的设计与实现[J].计算机技术与发展, 2012, 22 (3) :230-232.
                            </a>
                        </p>
            </div>
        <!--reference end-->
        <!--footnote start-->
        <!--footnote end-->



    </div>

        <input id="fileid" type="hidden" value="WXYJ201907019" />
        <input id="dpi" type="hidden" value="300" />
    </div>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?6e967eb120601ea41b9d312166416aa6";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
</script>

    


<input id="hid_uid" name="hid_uid" type="hidden" value="WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
<input id="hid_kLogin_headerUrl" name="hid_kLogin_headerUrl" type="hidden" value="/KLogin/Request/GetKHeader.ashx%3Fcallback%3D%3F" />
<input id="hid_kLogin_footerUrl" name="hid_kLogin_footerUrl" type="hidden" value="/KLogin/Request/GetKFooter.ashx%3Fcallback%3D%3F" />
<div class="btn-link" style="display: none"><a target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=WXYJ201907019&amp;v=MjIxNTFNcUk5RWJZUUtESDg0dlI0VDZqNTRPM3pxcUJ0R0ZyQ1VSTE9lWmVWdUZ5amtWTC9BTWpYU1pMRzRIOWo=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUUo3bEY4T2FiTmZaMW5CaDlzTGhwUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">知网节</a></div>
<div class="popflow" id="popupTips" style="display: none;">
    <div class="popflowArr"></div>
    <div class="popflowCot">
        <div class="hd"><a href="javascript:void(0);" onclick="$('#popupTips').hide();$('#popupmsg').html('')" class="close">X</a></div>
        <div class="bd">
            <p class="mes" id="popupmsg" name="popupmsg"></p>
          
        </div>
    </div>
</div>
<input type="hidden" id="myexport" value="//kns.cnki.net" />

<input type="hidden" id="KPCAPIPATH" value="//ishufang.cnki.net" />
<input type="hidden" id="CitedTimes" value="" />
<div class="link" id="GLSearch" style="display: none;">
    <i class="icon-trangle"></i>
    <div class="inner">
        <a class="icon" id="copytext">复制</a>
        <a class="icon" target="_blank" onclick="searchCRFD(this)">工具书搜索</a>
    </div>
</div>




<input id="hidVirtualPath" name="hidVirtualPath" type="hidden" value="/kxreader" />
<script src="/kxreader/bundles/detail?v=-ULdk-c6FkZHtJA2KAXPgHnyA8mtgyPnBde_C2VZ2BY1"></script>

<script src="/kxreader/Scripts/layer.min.js" type="text/javascript"></script>

<div id="footerBox" class="rootw footer">
</div>
<script>
    if (typeof FlushLogin == 'function') {
        FlushLogin();
    }
    modifyEcpHeader(true);
</script>

<!--图片放大功能 start-->
<script src="/kxreader/bundles/imagebox?v=W4phPu9SNkGcuPeJclikuVE3PpRyIW_gnfjm_19nynI1"></script>

<script type="text/javascript">
    $(function () {
        var j = $.noConflict();
        j(function () {
            j(".zoom-in,.btn-zoomin").imgbox({
                'alignment': 'center',
                'allowMultiple': false,
                'overlayShow': true
            });
        })
    });
</script>
<!--图片放大功能 end-->
<div class="fixedbar">
    <div class="backtop hiddenV" id="backtop">
        <a id="backTopSide" href="javascript:scroll(0,0);" title=""></a>
    </div>
</div>
<script type="text/javascript" src="/kxreader/Scripts/MathJax-2.6-latest/MathJax.js?config=MML_HTMLorMML-full"></script>

</body>
</html>
