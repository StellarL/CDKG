

<!DOCTYPE html>
<html>
<head>
    <title>全文阅读--XML全文阅读--中国知网</title>
    <link rel="icon" href="/kxreader/favicon.ico" />
    <link rel="shortcut Icon" href="/kxreader/favicon.ico" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="keywords" content="文献 XML KBASE CNKI 中国知网" />
    <meta name="description" content="XML文献检索" />
    <script type="text/javascript">
        var APPPATH = '/kxreader';
    </script>

</head>

<body>

    
<script type="text/javascript" src="//login.cnki.net/TopLogin/api/loginapi/get?type=top&amp;localCSS=&amp;returnurl=%2f%2fkns.cnki.net%2f%2fKXReader%2fDetail%3fTIMESTAMP%3d637129897489493750%26DBCODE%3dCJFD%26TABLEName%3dCJFDTEMP%26FileName%3dGUAN201911054%26RESULT%3d1%26SIGN%3dS5j9kIM%252fGc0rj0czOxlVlOlJFH4%253d"></script>

<div id="headerBox" class="header">
    <div class="topbar">
        <div class="textalign">
            <a href="/kxreader/Detail?dbcode=CJFD&amp;filename=GUAN201911054&amp;align=md">
                <i class="icon-cen active" title="居中对齐"></i>
            </a>
            <a href="/kxreader/Detail?dbcode=CJFD&amp;filename=GUAN201911054&amp;align=lt">
                <i class="icon-left " title="左对齐"></i>
            </a>
        </div>
        <h6 class="free-tip"><i class="icon"></i>HTML阅读开放试用阶段，欢迎体验！</h6>
    </div>
</div>


    



<div class="btn-link" style="display: none"><a target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=GUAN201911054&amp;v=MDE0NTdJUUtESDg0dlI0VDZqNTRPM3pxcUJ0R0ZyQ1VSTE9lWmVScEZDbmdVTHpBSWpqS1lMRzRIOWpOcm85QVk=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU44R3d5TUN4L3J2VXg3V1NwMm54QT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">知网节</a></div>

    <div class="main">

        

    <div class="sidebar-a">
        <!--sidebar start-->
        <div class="sidenav">
            <div class="arrow"><span></span></div>
            <!--sidebar_list start-->
            <dl class="sidenav-list">
                    <dt class="tit">目录结构</dt>
                            <dd class="guide">
                                    <p><a href="#29" data-title="引 言 ">引 言</a><i></i></p>
                                                            </dd>
                            <dd class="guide">
                                    <p><a href="#33" data-title="1 算法描述 ">1 算法描述</a><i></i></p>
                                                                    <ul class="contentbox">
                                                <li><a href="#34" data-title="&lt;b&gt;1.1 卷积神经网络&lt;/b&gt;"><b>1.1 卷积神经网络</b></a></li>
                                                <li><a href="#40" data-title="&lt;b&gt;1.2 深度卷积神经网络的设计&lt;/b&gt;"><b>1.2 深度卷积神经网络的设计</b></a></li>
                                                <li><a href="#46" data-title="&lt;b&gt;1.3 卷积神经网络的训练&lt;/b&gt;"><b>1.3 卷积神经网络的训练</b></a></li>
                                                <li><a href="#48" data-title="&lt;b&gt;1.4 其他对比实验算法简介&lt;/b&gt;"><b>1.4 其他对比实验算法简介</b></a></li>
                                    </ul>
                            </dd>
                            <dd class="guide">
                                    <p><a href="#54" data-title="2 实验部分 ">2 实验部分</a><i></i></p>
                                                                    <ul class="contentbox">
                                                <li><a href="#55" data-title="&lt;b&gt;2.1 数据采集&lt;/b&gt;"><b>2.1 数据采集</b></a></li>
                                                <li><a href="#61" data-title="&lt;b&gt;2.2 光谱数据预处理&lt;/b&gt;"><b>2.2 光谱数据预处理</b></a></li>
                                                <li><a href="#69" data-title="&lt;b&gt;2.3 建立校正模型&lt;/b&gt;"><b>2.3 建立校正模型</b></a></li>
                                    </ul>
                            </dd>
                            <dd class="guide">
                                    <p><a href="#75" data-title="3 结果与讨论 ">3 结果与讨论</a><i></i></p>
                                                                    <ul class="contentbox">
                                                <li><a href="#77" data-title="&lt;b&gt;3.1 二分类实验&lt;/b&gt;"><b>3.1 二分类实验</b></a></li>
                                                <li><a href="#80" data-title="&lt;b&gt;3.2 多分类实验&lt;/b&gt;"><b>3.2 多分类实验</b></a></li>
                                    </ul>
                            </dd>
                            <dd class="guide">
                                    <p><a href="#91" data-title="4 结 论 ">4 结 论</a><i></i></p>
                                                            </dd>
                            <dd class="guide">
                                    <p><a href="#" data-title="文内图表 ">文内图表</a><i></i></p>
                                                                    <ul class="contentbox">
                                                <li><a href="#38" data-title="&lt;b&gt;图1 一维CNN模型示意图&lt;/b&gt;"><b>图1 一维CNN模型示意图</b></a></li>
                                                <li><a href="#42" data-title="&lt;b&gt;表1 CNN-1网络的各项参数&lt;/b&gt;"><b>表1 CNN-1网络的各项参数</b></a></li>
                                                <li><a href="#44" data-title="&lt;b&gt;表2 CNN-4网络的各项参数&lt;/b&gt;"><b>表2 CNN-4网络的各项参数</b></a></li>
                                                <li><a href="#57" data-title="&lt;b&gt;表3 头孢克肟片NIR数据&lt;/b&gt;"><b>表3 头孢克肟片NIR数据</b></a></li>
                                                <li><a href="#58" data-title="&lt;b&gt;表4 苯妥英钠片NIR数据&lt;/b&gt;"><b>表4 苯妥英钠片NIR数据</b></a></li>
                                                <li><a href="#59" data-title="&lt;b&gt;图2 7个制药厂商头孢克肟片光谱曲线图&lt;/b&gt;"><b>图2 7个制药厂商头孢克肟片光谱曲线图</b></a></li>
                                                <li><a href="#64" data-title="&lt;b&gt;图3 11个制药厂商苯妥英钠片光谱曲线图&lt;/b&gt;"><b>图3 11个制药厂商苯妥英钠片光谱曲线图</b></a></li>
                                                <li><a href="#107" data-title="图4 光谱原图与5种方法预处理后光谱曲线图">图4 光谱原图与5种方法预处理后光谱曲线图</a></li>
                                                <li><a href="#107" data-title="图4 光谱原图与5种方法预处理后光谱曲线图">图4 光谱原图与5种方法预处理后光谱曲线图</a></li>
                                                <li><a href="#72" data-title="&lt;b&gt;表5 不同预处理NIR数据在CNN-2模型的分类性能&lt;/b&gt;"><b>表5 不同预处理NIR数据在CNN-2模型的分类性能</b></a></li>
                                                <li><a href="#73" data-title="&lt;b&gt;表6 七种CNN模型的分类性能对比&lt;/b&gt;"><b>表6 七种CNN模型的分类性能对比</b></a></li>
                                                <li><a href="#79" data-title="&lt;b&gt;表7 二分类实验不同方法分类准确率&lt;/b&gt;"><b>表7 二分类实验不同方法分类准确率</b></a></li>
                                                <li><a href="#83" data-title="&lt;b&gt;表8 七分类实验不同方法分类准确率&lt;/b&gt;"><b>表8 七分类实验不同方法分类准确率</b></a></li>
                                                <li><a href="#84" data-title="&lt;b&gt;图5 ratio=0.7时七分类实验ROC曲线&lt;/b&gt;"><b>图5 ratio=0.7时七分类实验ROC曲线</b></a></li>
                                                <li><a href="#88" data-title="&lt;b&gt;表9 十八分类实验不同方法分类准确率&lt;/b&gt;"><b>表9 十八分类实验不同方法分类准确率</b></a></li>
                                                <li><a href="#89" data-title="&lt;b&gt;表10 十八分类实验不同方法训练时间和推理时间(单位: 秒&lt;/b&gt;)"><b>表10 十八分类实验不同方法训练时间和推理时间(单位: 秒</b>)</a></li>
                                                <li><a href="#93" data-title="&lt;b&gt;图6 ratio=0.2时十八分类ROC曲线&lt;/b&gt;"><b>图6 ratio=0.2时十八分类ROC曲线</b></a></li>
                                    </ul>
                            </dd>
                                    <dd class="guide">
                                        <h6>
                                            <p><a href="#a_bibliography">参考文献</a> </p>
                                        </h6>
                                    </dd>

            </dl>
        </div>
        <!--sidebar end-->
        &nbsp;
        <!--此处有一空格符 勿删-->
    </div>

                <div class="sidebar-b three-collumn" style="width:0;">
            <div class="refer" style="width: 0;">
                <div class="arrow off" title="参考文献"><span></span></div>
                <div class="js-scrollbox" >
                    
                    <div class="subbox active">
                        <h4>
                            <span class="tit">参考文献</span>
                            <a class="close" href="javascript:void(0)">x</a>
                        </h4>
                        <div class="side-scroller">
                            <ul class="refer-list">
                                <li id="108">


                                    <a id="bibliography_1" title=" Ma H L,Wang J W,Chen Y J,et al.Food Chemistry,2017,215:108." target="_blank"
                                       href="">
                                        <b>[1]</b>
                                         Ma H L,Wang J W,Chen Y J,et al.Food Chemistry,2017,215:108.
                                    </a>
                                </li>
                                <li id="110">


                                    <a id="bibliography_2" title=" L&#234; L M M,Eveleigh L,Hasnaoui I,et al.Journal of Pharmaceutical and Biomedical Analysis,2017,138:249." target="_blank"
                                       href="">
                                        <b>[2]</b>
                                         L&#234; L M M,Eveleigh L,Hasnaoui I,et al.Journal of Pharmaceutical and Biomedical Analysis,2017,138:249.
                                    </a>
                                </li>
                                <li id="112">


                                    <a id="bibliography_3" title=" Xue J T,Ye L M,Li C Y,et al.Optik,2018,170:30." target="_blank"
                                       href="">
                                        <b>[3]</b>
                                         Xue J T,Ye L M,Li C Y,et al.Optik,2018,170:30.
                                    </a>
                                </li>
                                <li id="114">


                                    <a id="bibliography_4" title=" Risoluti R,Materazzi S,Gregori A,et al.Talanta,2016,153:407." target="_blank"
                                       href="">
                                        <b>[4]</b>
                                         Risoluti R,Materazzi S,Gregori A,et al.Talanta,2016,153:407.
                                    </a>
                                </li>
                                <li id="116">


                                    <a id="bibliography_5" title=" Deconinck E,Sacr&#233; P Y,Coomans D,et al.Journal of Pharmaceutical and Biomedical Analysis,2012,57:68." target="_blank"
                                       href="">
                                        <b>[5]</b>
                                         Deconinck E,Sacr&#233; P Y,Coomans D,et al.Journal of Pharmaceutical and Biomedical Analysis,2012,57:68.
                                    </a>
                                </li>
                                <li id="118">


                                    <a id="bibliography_6" title=" ZHANG Wei-dong,LI Ling-qiao,HU Jin-quan,et al(张卫东,李灵巧,胡锦泉,等).Chinese Journal of Analytical Chemistry(分析化学),2018,46(9):1446." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=FXHX201809018&amp;v=MjUxMDM0dlI0VDZqNTRPM3pxcUJ0R0ZyQ1VSTE9lWmVScEZDbmdVTHpBSXpYRGRyRzRIOW5NcG85RWJJUUtESDg=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU44R3d5TUN4L3J2VXg3V1NwMm54QT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[6]</b>
                                         ZHANG Wei-dong,LI Ling-qiao,HU Jin-quan,et al(张卫东,李灵巧,胡锦泉,等).Chinese Journal of Analytical Chemistry(分析化学),2018,46(9):1446.
                                    </a>
                                </li>
                                <li id="120">


                                    <a id="bibliography_7" title=" Yang H H,Hu B C,Pan X P,et al.Journal of Innovative Optical Health Sciences,2016,10(2):1630011." target="_blank"
                                       href="">
                                        <b>[7]</b>
                                         Yang H H,Hu B C,Pan X P,et al.Journal of Innovative Optical Health Sciences,2016,10(2):1630011.
                                    </a>
                                </li>
                                <li id="122">


                                    <a id="bibliography_8" title=" Lecun Y,Bengio Y,Hinton G.Nature,2015,521(7553):436." target="_blank"
                                       href="">
                                        <b>[8]</b>
                                         Lecun Y,Bengio Y,Hinton G.Nature,2015,521(7553):436.
                                    </a>
                                </li>
                                <li id="124">


                                    <a id="bibliography_9" title=" Nassif A B,Shahin I,Attili I,et al.IEEE Access,2019,7:19143." target="_blank"
                                       href="">
                                        <b>[9]</b>
                                         Nassif A B,Shahin I,Attili I,et al.IEEE Access,2019,7:19143.
                                    </a>
                                </li>
                                <li id="126">


                                    <a id="bibliography_10" title=" Lai D,Tian W,Chen L.Pattern Recognition,2019,88:547." target="_blank"
                                       href="">
                                        <b>[10]</b>
                                         Lai D,Tian W,Chen L.Pattern Recognition,2019,88:547.
                                    </a>
                                </li>
                                <li id="128">


                                    <a id="bibliography_11" title=" LU Meng-yao,YANG Kai,SONG Peng-fei,et al(鲁梦瑶,杨凯,宋鹏飞,等).Spectroscopy and Spectral Analysis(光谱学与光谱分析),2018,38(12):3724." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=GUAN201812014&amp;v=MDM5NzVFWUlRS0RIODR2UjRUNmo1NE8zenFxQnRHRnJDVVJMT2VaZVJwRkNuZ1VMekFJampLWUxHNEg5bk5yWTk=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU44R3d5TUN4L3J2VXg3V1NwMm54QT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[11]</b>
                                         LU Meng-yao,YANG Kai,SONG Peng-fei,et al(鲁梦瑶,杨凯,宋鹏飞,等).Spectroscopy and Spectral Analysis(光谱学与光谱分析),2018,38(12):3724.
                                    </a>
                                </li>
                                <li id="130">


                                    <a id="bibliography_12" title=" Acquarelli J,Laarhoven T V,Gerretzen J,et al.Analytica Chimica Acta,2017,954:22." target="_blank"
                                       href="">
                                        <b>[12]</b>
                                         Acquarelli J,Laarhoven T V,Gerretzen J,et al.Analytica Chimica Acta,2017,954:22.
                                    </a>
                                </li>
                                <li id="132">


                                    <a id="bibliography_13" title=" Srivastava N,Hinton G,Krizhevsky A,et al.Journal of Machine Learning Research,2014,15(1):1929." target="_blank"
                                       href="">
                                        <b>[13]</b>
                                         Srivastava N,Hinton G,Krizhevsky A,et al.Journal of Machine Learning Research,2014,15(1):1929.
                                    </a>
                                </li>
                            </ul>
                            <div style='display: none;' class="zqscroller" >
                                <h4 class="">附加材料</h4>
                                <ul></ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            &nbsp;
            <!--此处有一空格符 勿删-->
        </div>

        
    <div class="content">



        <!--tips start-->
                            <div class="tips">
                    <a href="http://navi.cnki.net/KNavi/JournalDetail?pcode=CJFD&amp;pykm=GUAN" target="_blank">光谱学与光谱分析</a>
                2019,39(11),3606-3613 DOI:10.3964/j.issn.1000-0593(2019)11-3606-08            </div>
        <!--tips end-->
            <div class="top-title">
                <h1 class="title">
                    <span class="vm"><b>深度卷积网络的多品种多厂商药品近红外光谱分类</b></span>
                                    </h1>

            </div>
                        <h2>
                                <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=au&amp;skey=%E6%9D%8E%E7%81%B5%E5%B7%A7&amp;code=34230662&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU44R3d5TUN4L3J2VXg3V1NwMm54QT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">李灵巧</a>
                                <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=au&amp;skey=%E6%BD%98%E7%BB%86%E6%9C%8B&amp;code=36471462&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU44R3d5TUN4L3J2VXg3V1NwMm54QT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">潘细朋</a>
                                <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=au&amp;skey=%E5%86%AF%E8%89%B3%E6%98%A5&amp;code=27327765&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU44R3d5TUN4L3J2VXg3V1NwMm54QT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">冯艳春</a>
                                <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=au&amp;skey=%E5%B0%B9%E5%88%A9%E8%BE%89&amp;code=27327894&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU44R3d5TUN4L3J2VXg3V1NwMm54QT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">尹利辉</a>
                                <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=au&amp;skey=%E8%83%A1%E6%98%8C%E5%8B%A4&amp;code=27327766&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU44R3d5TUN4L3J2VXg3V1NwMm54QT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">胡昌勤</a>
                                <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=au&amp;skey=%E6%9D%A8%E8%BE%89%E5%8D%8E&amp;code=32347794&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU44R3d5TUN4L3J2VXg3V1NwMm54QT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">杨辉华</a>
                </h2>
                    <h2>
                    <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=in&amp;skey=%E5%8C%97%E4%BA%AC%E9%82%AE%E7%94%B5%E5%A4%A7%E5%AD%A6%E8%87%AA%E5%8A%A8%E5%8C%96%E5%AD%A6%E9%99%A2&amp;code=0041796&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU44R3d5TUN4L3J2VXg3V1NwMm54QT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">北京邮电大学自动化学院</a>
                    <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=in&amp;skey=%E6%A1%82%E6%9E%97%E7%94%B5%E5%AD%90%E7%A7%91%E6%8A%80%E5%A4%A7%E5%AD%A6%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%B8%8E%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E5%AD%A6%E9%99%A2&amp;code=0269119&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU44R3d5TUN4L3J2VXg3V1NwMm54QT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">桂林电子科技大学计算机与信息安全学院</a>
                    <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=in&amp;skey=%E4%B8%AD%E5%9B%BD%E9%A3%9F%E5%93%81%E8%8D%AF%E5%93%81%E6%A3%80%E5%AE%9A%E7%A0%94%E7%A9%B6%E9%99%A2&amp;code=1694335&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU44R3d5TUN4L3J2VXg3V1NwMm54QT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">中国食品药品检定研究院</a>
            </h2>

        
<div class="link">
    <a id="aexport" class="icon icon-output"  onclick="" href="javascript:void(0);"><i></i>导出/参考文献</a>
    
    <span class="shareBoard" onmouseover="$('#sharedet').show();$('#this').addClass('shareBoardCUR')" onmouseout="$('#sharedet').hide();$('#this').removeClass('shareBoardCUR')">
        <a class="icon icon-share" href="#"><i></i>分享<em></em></a>
        <ul class="shareHide" id="sharedet" style="display: none;">
            <li><a title="复制链接" class="copy" onclick="" href="#"><i></i>复制链接</a></li>
            <li><a title="分享到新浪微博" class="xl" onclick="" href="javascript:common.ShareAction('xl');"><i></i>新浪微博</a></li>
            <li>
                <a title="分享到微信" class="wx" onclick="" href="#"><i></i>微信扫一扫</a>
                <div class="qrcode"><img src='' alt='' /></div>
            </li>
        </ul>

    </span>
    
    <a id="RefTrack" title="创建引文跟踪" class="icon icon-track" onclick="" href="javascript:void(0);"> <i></i>创建引文跟踪 </a>
    <a id="ashoucang" title="收藏" class="icon icon-favor" onclick="" href="javascript:void(0);"><i></i>收藏</a>
    <a class="icon icon-print" onclick="window.print();" href="javascript:void(0);"><i></i>打印</a>
    
    <!--版本切换 end-->
</div>
                            <div class="data" id="a_abstract">
                <span class="keys">摘<span style="font-family: 'Times New Roman';">&nbsp;&nbsp;&nbsp;&nbsp;</span>要：</span>
                <p>近红外光谱(NIR)分析具有分析高效、样品无损、环境无污染以及可现场检测等优点,特别适合药品的快速建模分析。但NIR存在吸收强度弱以及谱带重叠等缺点,需要建立稳健可靠的化学计量学模型对其进行分析。深度卷积神经网络是深度学习方法中一个重要分支,它通过逐层抽取数据特征并进行组合、转换,形成更高层的语义特征,具有极强的建模能力,广泛应用于计算机视觉、语音识别等领域,而在药品NIR分析方面尚未见报道。基于深度卷积网络模型,对药品NIR多分类建模进行研究。针对药品NIR数据的特点,设计若干个面向多品种、多厂商药品NIR分类的一维深度卷积网络模型。模型中卷积层和池化层交叠排列用于逐层抽取NIR数据特征,输出层连接softmax分类器,对药品NIR数据进行分类概率预测。在输出层之前采用全局最大池化层,将特征图进行整体池化,形成一个特征点,用于解决全连接层存在的限制输入维度大小,参数过多的问题。同时,在网络模型中引入批处理操作和dropout机制,以防止梯度消失和减小网络过拟合的风险。在网络模型的设计过程中,通过设计不同的卷积网络层数以及不同的卷积核尺寸大小,分析其对建模效果的影响,同时分析五种经典数据预处理方法对NIR分析的影响。以我国7个厂商生产的头孢克肟片和11个厂商生产的苯妥英钠片样本NIR为实验对象,建立药品的多品种、多厂商分类模型,该模型在二分类、多分类实验中取得了良好的分类效果。在十八分类实验中,当训练集与测试集比例为7∶3时,分类准确率为99.37±0.45,比SVM, BP, AE和ELM算法取得更优的分类性能。同时,深度卷积神经网络模型推理速度较快,优于SVM和ELM算法,但训练速度慢于二者。大量实验结果表明,深度卷积神经网络可对多品种、多厂商药品NIR数据准确、可靠地判别分类,且模型具有良好的鲁棒性和可扩展性。该方法也可推广到烟草、石化等其他领域的NIR数据分类应用中。</p>
            </div>
                    <div class="data" id="a_keywords">
                <span class="keys">关键词：</span>
                <p>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=%E6%B7%B1%E5%BA%A6%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C&amp;code=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU44R3d5TUN4L3J2VXg3V1NwMm54QT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">深度卷积神经网络;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=%E8%BF%91%E7%BA%A2%E5%A4%96%E5%85%89%E8%B0%B1&amp;code=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU44R3d5TUN4L3J2VXg3V1NwMm54QT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">近红外光谱;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=%E8%8D%AF%E5%93%81%E9%89%B4%E5%88%AB&amp;code=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU44R3d5TUN4L3J2VXg3V1NwMm54QT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">药品鉴别;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=%E5%A4%9A%E5%88%86%E7%B1%BB&amp;code=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU44R3d5TUN4L3J2VXg3V1NwMm54QT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">多分类;</a>
                </p>
            </div>
        
        <!--brief start-->
        
            <div class="brief">
                    <p>
                            <b>作者简介：</b>
                                                        <span>
                                    李灵巧,1986年生,北京邮电大学自动化学院博士研究生e-mail:54pe@163.com;
                                </span>
                                <span>
                                    潘细朋,1985年生,北京邮电大学自动化学院博士研究生e-mail:pxp201@bupt.edu.cn;
                                </span>
                                <span>
                                    *冯艳春,e-mail:fyc@nifdc.org.cn;;
                                </span>
                                <span>
                                    *杨辉华,yhh@bupt.edu.cn;
                                </span>
                    </p>
                                    <p><b>收稿日期：</b>2019-03-04</p>

                    <p>

                            <b>基金：</b>
                                                        <span>国家自然科学基金项目(21365008,61562013)资助;</span>
                    </p>
            </div>
                    <h1><b>Deep Convolution Network Application in Identification of Multi-Variety and Multi-Manufacturer Pharmaceutical</b></h1>
                    <h2>
                    <span>LI Ling-qiao</span>
                    <span>PAN Xi-peng</span>
                    <span>FENG Yan-chun</span>
                    <span>YIN Li-hui</span>
                    <span>HU Chang-qin</span>
                    <span>YANG Hui-hua</span>
            </h2>
                    <h2>
                    <span>School of Automation, Beijing University of Posts and Telecommunications</span>
                    <span>School of Computer and Information Security, Guilin University of Electronic Technology</span>
                    <span>National Institutes for Food and Drug Control</span>
            </h2>
                            <div class="data" id="a_abstractEN">
                <span class="keys">Abstract：</span>
                <p>As near infrared spectroscopy(NIR) has many advantages, such as high efficiency, being non-destructive and environment-friendly and on-site detection, it is especially suitable for rapid modeling and analysis of drugs. However, there are some shortcomings such as weak absorption intensity and overlapping bands. It is necessary to establish a robust and reliable chemometrics model to analyze NIR. Deep convolution neural network(DCNN) is an important branch of deep learning method, which extracts data features layer by layer, combines and transforms them to form higher-level semantic features. It is widely used in computer vision, speech recognition and other fields, and has achieved great success, but has not been reported in drug NIR analysis yet. Based on the deep convolution network model, this paper studies the multi-class modeling of drug NIR. According to the characteristics of drug NIR data, several one-dimensional deep convolution network models for multi-class and multi-manufacturer drug NIR classification are designed. The overlapping arrangement of convolution layer and pool layer in the model is employed to extract NIR data features layer by layer, and the output layer is connected with the softmax classifier to predict the classification probability of NIR data. Before the output layer, the global maximum pooling layer is used to solve the problem of restricting the size of input dimension and too many parameters in the full connection layer. At the same time, batch normalization and dropout are introduced in the network model to prevent the gradient vanishing and reduce the risk of network overfitting. The impact on the modeling effect with different convolutional network layers and different convolution kernel sizes is analyzed. At the same time, the influence of five classical data preprocessing methods is explored. Taking NIR samples of cefixime and phenytoin tablets as experimental datasets, a multi-class and multi-manufacturer classification model of drugs is established. The model achieved good classification results in the experiments of binary-classification and multi-classification. In eighteen classification experiments, when the ratio between training set and test set was 7∶3, the classification accuracy was 99.37±0.45, which achieved better classification performance than SVM, BP, AE and ELM. At the same time, inference speed of deep convolution neural network was faster than SVM and ELM, but training speed was slower than both. A large number of experimental results showed that the deep convolutional neural network can accurately and reliably distinguish the NIR data of multi-class and multi-manufacturer drugs, with good robustness and scalability. The proposed method can also be extended to the application of NIR data classification in tobacco, petrochemical and other fields.</p>
            </div>
                    <div class="data" id="a_keywordsEN">
                <span class="keys">Keyword：</span>
                <p>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=Deep%20convolution%20neural%20network&amp;code=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU44R3d5TUN4L3J2VXg3V1NwMm54QT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">Deep convolution neural network;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=Near%20infrared%20spectroscopy&amp;code=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU44R3d5TUN4L3J2VXg3V1NwMm54QT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">Near infrared spectroscopy;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=Pharmaceutical%20discrimination&amp;code=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU44R3d5TUN4L3J2VXg3V1NwMm54QT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">Pharmaceutical discrimination;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=Multi-classification&amp;code=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU44R3d5TUN4L3J2VXg3V1NwMm54QT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">Multi-classification;</a>
                </p>
            </div>
                    <div class="brief">
                
                    <p>
                                            </p>
                                    <p><b>Received：</b> 2019-03-04</p>
                                    <p>
                                            </p>
            </div>


        <!--brief start-->
                        <h3 id="29" name="29" class="anchor-tag">引 言</h3>
                <div class="p1">
                    <p id="30">由于原材料, 生产工艺以及包装形式等的差别, 不同厂商生产的同一种药品的品质也有一定的差异。 对这些差异性的鉴别在药品的监管过程中具有重要意义。 近红外光谱(near infrared spectroscopy, NIR)分析具有高效、 稳定、 无损、 无污染等优点, 已广泛应用于食品、 制药以及医疗等领域<citation id="137" type="reference"><link href="108" rel="bibliography" /><link href="110" rel="bibliography" /><link href="112" rel="bibliography" /><link href="114" rel="bibliography" /><sup>[<a class="sup">1</a>,<a class="sup">2</a>,<a class="sup">3</a>,<a class="sup">4</a>]</sup></citation>。 近红外光谱分析结合化学计量学方法已广泛应用于药品的快速、 无损建模分析。  Deconinck等<citation id="134" type="reference"><link href="116" rel="bibliography" /><sup>[<a class="sup">5</a>]</sup></citation>使用决策树对Viagra和Cialis两种药品的近红外光谱进行了鉴别, 但该方法尚未对多分类问题进行研究。 张卫东等<citation id="135" type="reference"><link href="118" rel="bibliography" /><sup>[<a class="sup">6</a>]</sup></citation>融合堆栈稀疏自编码和核极限学习机各自的优势, 提出SSAE-KELM模型, 对四个厂商生产的铝塑和非铝塑包装形式的头孢克肟片近红外光谱进行分类研究, 取得良好的效果, 但仅报道了单个药品分类研究结果。 Yang等<citation id="136" type="reference"><link href="120" rel="bibliography" /><sup>[<a class="sup">7</a>]</sup></citation>结合Dropout和深度信念网络构建Dropout-DBN分类器, 对琥乙红霉素药品近红外光谱进行鉴别, 有效缓解了由于训练数据少导致模型过拟合现象, 实验结果表明深度学习方法适合相对较小样本规模的近红外光谱数据分析。 然而, 随着制药厂商以及药品品种的增加, 药品光谱数据进一步积累, 设计面向多品种、 多厂商并且可扩展性良好的分类模型显得尤为重要。</p>
                </div>
                <div class="p1">
                    <p id="31">深度卷积神经网络(convolutional neural network, CNN)具有极强的建模能力, 广泛应用于多分类和大规模数据的计算机视觉和语音识别等领域并取得了巨大成功<citation id="140" type="reference"><link href="122" rel="bibliography" /><link href="124" rel="bibliography" /><link href="126" rel="bibliography" /><sup>[<a class="sup">8</a>,<a class="sup">9</a>,<a class="sup">10</a>]</sup></citation>。 同时, 由于其深层的网络结构和非线性激活能力, 深度卷积网络应用到近红外光谱的建模分析已有些报道<citation id="141" type="reference"><link href="128" rel="bibliography" /><link href="130" rel="bibliography" /><sup>[<a class="sup">11</a>,<a class="sup">12</a>]</sup></citation>。 鲁梦瑶等<citation id="138" type="reference"><link href="128" rel="bibliography" /><sup>[<a class="sup">11</a>]</sup></citation>提出一种改进的LeNet-5卷积神经网络模型, 对烟叶样本的近红外光谱进行分类实验研究, 获得良好的分类性能。 该方法本质上是将一维光谱数据转换成二维的矩阵, 以适应现有的CNN模型。 Acquarelli等<citation id="139" type="reference"><link href="130" rel="bibliography" /><sup>[<a class="sup">12</a>]</sup></citation>设计一个含一层卷积的CNN模型, 并用于振动光谱数据分析的分类、 分析, 但由于采用浅层CNN模型, 面向大规模的光谱数据分类准确率有待提高。</p>
                </div>
                <div class="p1">
                    <p id="32">尽管CNN网络在图像分类、 语音识别等领域取得了突破性的进展, 但在NIR分析方面的应用却比较少。 其主要原因有以下两点: (1)近红外光谱数据本质上是一维向量(矩阵), 不大适合套用现有的二维CNN模型; (2)相比图像数据, 光谱数据的获取困难的多, 光谱样本量通常较小, 经典的化学计量学方法可满足应用要求。 但随着数据的积累, 光谱类别数大幅增加, 经典的分类方法无法满足高精度光谱数据鉴别的要求。 基于上述分析, 本文采用一维CNN模型用于多品种、 多厂商的药品近红外光谱分类研究。 核心贡献为: (1)将CNN模型引入药品NIR光谱鉴别领域; (2)基于一维CNN, 设计若干个端到端的NIR光谱分类模型, 适用于大规模、 多品种、 多厂商的药品鉴别场景; (3)本方法性能良好, 分类准确率超过或比肩多个现有的最佳方法, 同时具有良好的鲁棒性和可扩展性, 适合其他领域的NIR光谱数据分析。</p>
                </div>
                <h3 id="33" name="33" class="anchor-tag">1 算法描述</h3>
                <h4 class="anchor-tag" id="34" name="34"><b>1.1 卷积神经网络</b></h4>
                <div class="p1">
                    <p id="35">针对NIR光谱数据的特性, 设计了多个一维的CNN网络模型, 并进行比较研究, 具体在第1.2节将详细介绍和讨论, 本节以其中的一个CNN网络为例进行介绍。 网络主要分为输入层、 卷积层、 池化层、 全局最大池化层、 输出层, 示意图如图1所示。 图1中含三个卷积层, 卷积核大小分别为21, 19和17。 卷积核的权值采用Xavier正态分布初始化。 卷积后进行批处理化(batch normalization, BN)操作, BN操作将每个batch上前一层的激活值重新标准化, 将原本减小的激活值放大, 防止梯度消失。 池化层紧接在每个卷积层的后边, 它起到减小输出大小, 降低过拟合的作用。 该网络采用pool_size=3,  strides=3的池化操作。 全局最大池化层的思想是将最后一层的特征图进行整体池化, 形成一个特征点, 主要是用来解决全连接层存在的限制输入维度大小, 参数过多的问题。 输出层的神经元个数为药品的类别数, 通过连接softmax分类器, 对药品NIR数据进行分类概率预测。 softmax公式为</p>
                </div>
                <div class="p1">
                    <p id="36" class="code-formula">
                        <mathml id="36"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>L</mi><msub><mrow></mrow><mrow><mtext>s</mtext><mtext>o</mtext><mtext>f</mtext><mtext>t</mtext><mtext>m</mtext><mtext>a</mtext><mtext>x</mtext></mrow></msub><mo>=</mo><mo>-</mo><mfrac><mn>1</mn><mi>Ν</mi></mfrac><mrow><mo>[</mo><mrow><mstyle displaystyle="true"><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>Ν</mi></munderover><mrow><mstyle displaystyle="true"><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>k</mi></munderover><mn>1</mn></mstyle></mrow></mstyle><mo stretchy="false">{</mo><mi>y</mi><msub><mrow></mrow><mi>i</mi></msub><mo>=</mo><mi>j</mi><mo stretchy="false">}</mo><mi>log</mi><mfrac><mrow><mtext>e</mtext><msup><mrow></mrow><mrow><mi>θ</mi><msubsup><mrow></mrow><mi>j</mi><mtext>Τ</mtext></msubsup><mi>x</mi><msub><mrow></mrow><mi>i</mi></msub></mrow></msup></mrow><mrow><mstyle displaystyle="true"><msubsup><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>k</mi></msubsup><mtext>e</mtext></mstyle><msup><mrow></mrow><mrow><mi>θ</mi><msubsup><mrow></mrow><mi>j</mi><mtext>Τ</mtext></msubsup><mi>x</mi><msub><mrow></mrow><mi>i</mi></msub></mrow></msup></mrow></mfrac></mrow><mo>]</mo></mrow><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mrow><mtext> </mtext><mtext> </mtext><mtext> </mtext></mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></math></mathml>
                    </p>
                </div>
                <div class="p1">
                    <p id="37">其中1{<i>y</i><sub><i>i</i></sub>=<i>j</i>}为示性函数, 当<i>y</i><sub><i>i</i></sub>=<i>j</i>时, 1{<i>y</i><sub><i>i</i></sub>=<i>j</i>}=1, 否则1{<i>y</i><sub><i>i</i></sub>=<i>j</i>}=0。 <i>N</i>是光谱样本数, <i>k</i>是光谱样本类别数。 <i>θ</i>表示softmax分类器参数。</p>
                </div>
                <div class="area_img" id="38">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/GUAN201911054_038.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU44R3d5TUN4L3J2VXg3V1NwMm54QT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图1 一维CNN模型示意图" src="Detail/GetImg?filename=images/GUAN201911054_038.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU44R3d5TUN4L3J2VXg3V1NwMm54QT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit"><b>图1 一维CNN模型示意图</b>  <a class="btn-zoomin" href="Detail/GetImg?filename=images/GUAN201911054_038.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU44R3d5TUN4L3J2VXg3V1NwMm54QT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"><b>Fig.1 The structure of one-dimensional CNN</b></p>

                </div>
                <div class="p1">
                    <p id="39">为减小网络过拟合的风险, 在网络的每个卷积层后引入dropout机制<citation id="142" type="reference"><link href="132" rel="bibliography" /><sup>[<a class="sup">13</a>]</sup></citation>。 为了公平对比, BP模型和AE算法与本文设计的CNN网络模型采用同样的dropout值。</p>
                </div>
                <h4 class="anchor-tag" id="40" name="40"><b>1.2 深度卷积神经网络的设计</b></h4>
                <div class="p1">
                    <p id="41">为了探究卷积核大小以及网络层数对药品NIR分类性能的影响, 设计了7种具有不同深度和不同卷积核大小的卷积神经网络模型, 分别为3种大卷积核的网络, 以及4种小卷积核的网络, 取名CNN-1—CNN-7。 为节约篇幅, 从大卷积核和小卷积核神经网络中选取CNN-1和CNN-4为代表进行说明, 详见表1和表2。 其中, 药品NIR光谱数据维度为2074; 以七分类为例, 其输出层神经元个数为7。</p>
                </div>
                <div class="area_img" id="42">
                    <p class="img_tit"><b>表1 CNN-1网络的各项参数</b> <a class="downexcel" onclick="DownLoadReportExcel(this)">导出到EXCEL</a></p>
                    <p class="img_tit"><b>Table 1 The parameters of CNN-1</b></p>
                    <p class="img_note"></p>
                    <table id="42" border="1"><tr><td>层类别</td><td>卷积核<br />大小</td><td>卷积核<br />数量</td><td>步长</td><td>输出<br />形状</td><td>神经元<br />个数</td><td>参数量</td></tr><tr><td><br />Conv_1</td><td>21</td><td>64</td><td>1</td><td>2 054×64</td><td>131 456</td><td>1 408</td></tr><tr><td><br />BN_1</td><td>-</td><td>-</td><td>-</td><td>2 054×64</td><td>131 456</td><td>256</td></tr><tr><td><br />MP_1</td><td>-</td><td>-</td><td>3</td><td>684×64</td><td>43 776</td><td>0</td></tr><tr><td><br />Conv_2</td><td>19</td><td>64</td><td>1</td><td>666×64</td><td>42 624</td><td>77 888</td></tr><tr><td><br />BN_2</td><td>-</td><td>-</td><td>-</td><td>666×64</td><td>42 624</td><td>256</td></tr><tr><td><br />MP_2</td><td>-</td><td>-</td><td>3</td><td>222×64</td><td>14 208</td><td>0</td></tr><tr><td><br />GMP</td><td>-</td><td>-</td><td>-</td><td>64</td><td>64</td><td>0</td></tr><tr><td><br />Output</td><td>-</td><td>-</td><td>-</td><td>7</td><td>7</td><td>455</td></tr><tr><td><br />合计</td><td>-</td><td>-</td><td>-</td><td>-</td><td>406 215</td><td>80 263</td></tr></table>
                    <form name="form" action="/kxreader/Detail/DownloadReportExcel" method="POST" style="display:inline">
                        <input type="hidden" name="hidTable" value="" />
                        <input type="hidden" name="hidFileName" value="" />
                    </form>
                    <p class="img_note"></p>
                    <p class="img_note"></p>
                </div>
                <div class="p1">
                    <p id="43">CNN-1模型含有两个卷积层, 卷积核大小分别为21和19。 卷积层后紧接着BN层以及最大池化层。 第二个最大池化层后连接全局最大池化层, 最后是输出层。 第一个卷积层采用64个尺寸为21的卷积核, 在一维光谱上移动的步长为1, 生成64层特征映射图, 需要训练的参数为1 408个。 第二个卷积层采用64个尺寸为19的卷积核, 生成64层特征映射图, 需要训练的参数为77 888个。 经全局最大池化层后神经元个数为64, 经全连接输出, 输出为7分类, 该层的参数为455个。 加上2个BN层的参数, CNN-1模型总共含有80 263个参数。 CNN-2与CNN-1网络类似, 比CNN-1多一个卷积层、 BN层以及最大池化层组合。 CNN-3比CNN-2同样多一个卷积层、 BN层以及最大池化层组合。</p>
                </div>
                <div class="area_img" id="44">
                    <p class="img_tit"><b>表2 CNN-4网络的各项参数</b> <a class="downexcel" onclick="DownLoadReportExcel(this)">导出到EXCEL</a></p>
                    <p class="img_tit"><b>Table 2 The parameters of CNN-4</b></p>
                    <p class="img_note"></p>
                    <table id="44" border="1"><tr><td>层类别</td><td>卷积核<br />大小</td><td>卷积核<br />数量</td><td>步长</td><td>输出<br />形状</td><td>神经元<br />个数</td><td>参数量</td></tr><tr><td><br />Conv_1</td><td>3</td><td>64</td><td>1</td><td>2 072×64</td><td>132 608</td><td>256</td></tr><tr><td><br />BN_1</td><td>-</td><td>-</td><td>-</td><td>2 072×64</td><td>132 608</td><td>256</td></tr><tr><td><br />MP_1</td><td>-</td><td>-</td><td>3</td><td>690×64</td><td>44 160</td><td>0</td></tr><tr><td><br />Conv_2</td><td>3</td><td>64</td><td>1</td><td>688×64</td><td>44 032</td><td>12 352</td></tr><tr><td><br />BN_2</td><td>-</td><td>-</td><td>-</td><td>688×64</td><td>44 032</td><td>256</td></tr><tr><td><br />MP_2</td><td>-</td><td>-</td><td>3</td><td>229×64</td><td>14 656</td><td>0</td></tr><tr><td><br />GMP</td><td>-</td><td>-</td><td>-</td><td>64</td><td>64</td><td>0</td></tr><tr><td><br />Output</td><td>-</td><td>-</td><td>-</td><td>7</td><td>7</td><td>455</td></tr><tr><td><br />合计</td><td>-</td><td>-</td><td>-</td><td>-</td><td>412 167</td><td>13 575</td></tr></table>
                    <form name="form" action="/kxreader/Detail/DownloadReportExcel" method="POST" style="display:inline">
                        <input type="hidden" name="hidTable" value="" />
                        <input type="hidden" name="hidFileName" value="" />
                    </form>
                    <p class="img_note"></p>
                    <p class="img_note"></p>
                </div>
                <div class="p1">
                    <p id="45">CNN-4—CNN-7模型是小卷积核网络, 卷积核大小都为3, 但所含卷积层数不同。 CNN-4模型与CNN-1模型结构类似, 只是卷积核大小不同。 CNN-5与CNN-2模型结构类似, 唯一区别是将卷积核的大小都变成3。 CNN-6与CNN-7在CNN-5的基础上逐一增加一个卷积核、 BN层以及最大池化层组合。</p>
                </div>
                <h4 class="anchor-tag" id="46" name="46"><b>1.3 卷积神经网络的训练</b></h4>
                <div class="p1">
                    <p id="47">整个CNN网络模型使用Adam优化器进行训练, Adam优化器由Kingma和Ba两位学者于2014年底提出, 结合AdaGrad和RMSProp两种优化算法的优点, 计算高效, 收敛速度较快。 模型训练过程中, 使用回调函数来观察网络内部的状态和统计信息。 在验证集损失在一定的周期<i>n</i>(e.g.,  <i>n</i>=10)内不下降的情况下, 对学习率乘以系数lambda(e.g.,  lambda=0.2)达到减小学习率的目的。 如验证集损失相比上一个训练周期没有下降, 则经过patience(e.g.,  patience=50)个周期后停止训练, 以防止过拟合。</p>
                </div>
                <h4 class="anchor-tag" id="48" name="48"><b>1.4 其他对比实验算法简介</b></h4>
                <div class="p1">
                    <p id="49">对比实验方法有支持向量机(support vector machines,  SVM), 反向传播算法(back propagation,  BP), 自编码器(autoencoder,  AE)以及极限学习机(extreme learning machines,  ELM), 几种方法简要介绍如下。</p>
                </div>
                <div class="p1">
                    <p id="50">(1)SVM的参数C设置为1.0, gamma设置为0.001, 其他参数使用python机器学习库sklearn的默认值。 多分类实验时, 采用one-against-all策略来构造多类SVM分类器。</p>
                </div>
                <div class="p1">
                    <p id="51">(2)BP算法与CNN模型一致, 也采用三层网络结构。 BP网络结构为: 2074-500-100-20-num_class(num_class为分类类别数)。</p>
                </div>
                <div class="p1">
                    <p id="52">(3)AE模型也采用三层网络结构, AE编码网络结构为: 2074-500-100-20-num_class, 解码网络结构为: num_class-20-100-500-2074。 训练自编码模型时, 损失函数采用均方误差损失, 使用Adam作为优化器; 当无监督预训练结束后, 进行有监督分类训练。</p>
                </div>
                <div class="p1">
                    <p id="53">(4)ELM的网络结构为2074-800-num_class。 实验表明, ELM网络隐藏层神经元个数设置为800, 模型取得较好的性能。</p>
                </div>
                <h3 id="54" name="54" class="anchor-tag">2 实验部分</h3>
                <h4 class="anchor-tag" id="55" name="55"><b>2.1 数据采集</b></h4>
                <div class="p1">
                    <p id="56">实验数据为中国食品药品检定研究院采集的非铝塑包装头孢克肟片和苯妥英钠片两种药品的NIR数据。 数据通过Bruker Matrix光谱仪测得, 每条NIR数据的波长范围是4 000～11 995 cm<sup>-1</sup>, 间隔4 cm<sup>-1</sup>, 有2 074个吸光度值。 NIR样品信息如表3和表4所示。 7个厂商生产的头孢克肟片样本NIR光谱如图2所示。 图3为11个不同的制药厂商生产的苯妥英钠片光谱。 从图2和图3中可以看出, 不同厂商的同种药品光谱图非常相似, 部分谱段甚至重叠, 这对分类算法带来较大挑战。</p>
                </div>
                <div class="area_img" id="57">
                    <p class="img_tit"><b>表3 头孢克肟片NIR数据</b> <a class="downexcel" onclick="DownLoadReportExcel(this)">导出到EXCEL</a></p>
                    <p class="img_tit"><b>Table 3 NIR data of cefixime tablets</b></p>
                    <p class="img_note"></p>
                    <table id="57" border="1"><tr><td><br />厂商</td><td>种类</td><td>数量</td></tr><tr><td><br />湖南方盛制药股份有限公司</td><td>头孢克肟片</td><td>54</td></tr><tr><td><br />江苏正大清江制药有限公司</td><td>头孢克肟片</td><td>63</td></tr><tr><td><br />山东鲁抗医药股份有限公司</td><td>头孢克肟片</td><td>51</td></tr><tr><td><br />山东罗欣药业股份有限公司</td><td>头孢克肟片</td><td>48</td></tr><tr><td><br />广州白云山制药总厂</td><td>头孢克肟片</td><td>39</td></tr><tr><td><br />四川方向药业有限责任公司</td><td>头孢克肟片</td><td>48</td></tr><tr><td><br />苏州东瑞制药有限公司</td><td>头孢克肟片</td><td>30</td></tr><tr><td><br /></td><td>共计</td><td>333</td></tr></table>
                    <form name="form" action="/kxreader/Detail/DownloadReportExcel" method="POST" style="display:inline">
                        <input type="hidden" name="hidTable" value="" />
                        <input type="hidden" name="hidFileName" value="" />
                    </form>
                    <p class="img_note"></p>
                    <p class="img_note"></p>
                </div>
                <div class="area_img" id="58">
                    <p class="img_tit"><b>表4 苯妥英钠片NIR数据</b> <a class="downexcel" onclick="DownLoadReportExcel(this)">导出到EXCEL</a></p>
                    <p class="img_tit"><b>Table 4 NIR data of phenytoin tablets</b></p>
                    <p class="img_note"></p>
                    <table id="58" border="1"><tr><td><br />厂商</td><td>种类</td><td>数量</td></tr><tr><td><br />东北制药集团沈阳第一制药厂</td><td>苯妥英钠片</td><td>42</td></tr><tr><td><br />河北东风药业有限公司</td><td>苯妥英钠片</td><td>30</td></tr><tr><td><br />开封制药(集团)有限公司</td><td>苯妥英钠片</td><td>30</td></tr><tr><td><br />山西汾河制药有限公司</td><td>苯妥英钠片</td><td>47</td></tr><tr><td><br />山西省临汾健民制药厂</td><td>苯妥英钠片</td><td>72</td></tr><tr><td><br />山西云鹏制药有限公司</td><td>苯妥英钠片</td><td>135</td></tr><tr><td><br />上海信谊黄河制药有限公司</td><td>苯妥英钠片</td><td>87</td></tr><tr><td><br />石药集团欧意药业有限公司</td><td>苯妥英钠片</td><td>50</td></tr><tr><td><br />天津力生制药股份有限公司</td><td>苯妥英钠片</td><td>98</td></tr><tr><td><br />西南药业股份有限公司</td><td>苯妥英钠片</td><td>71</td></tr><tr><td><br />扬州市星斗药业有限公司</td><td>苯妥英钠片</td><td>54</td></tr><tr><td><br /></td><td>共计</td><td>716<br /></td></tr></table>
                    <form name="form" action="/kxreader/Detail/DownloadReportExcel" method="POST" style="display:inline">
                        <input type="hidden" name="hidTable" value="" />
                        <input type="hidden" name="hidFileName" value="" />
                    </form>
                    <p class="img_note"></p>
                    <p class="img_note"></p>
                </div>
                <div class="area_img" id="59">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/GUAN201911054_059.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU44R3d5TUN4L3J2VXg3V1NwMm54QT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图2 7个制药厂商头孢克肟片光谱曲线图" src="Detail/GetImg?filename=images/GUAN201911054_059.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU44R3d5TUN4L3J2VXg3V1NwMm54QT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit"><b>图2 7个制药厂商头孢克肟片光谱曲线图</b>  <a class="btn-zoomin" href="Detail/GetImg?filename=images/GUAN201911054_059.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU44R3d5TUN4L3J2VXg3V1NwMm54QT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"><b>Fig.2 NIR of cefixime tablets from seven</b> pharmaceutical manufacturers</p>

                </div>
                <h4 class="anchor-tag" id="61" name="61"><b>2.2 光谱数据预处理</b></h4>
                <div class="p1">
                    <p id="62">采用均值中心化、 标准化、 标准正态变量变换、 Savitzky-Golay(SG)平滑求导以及多元散射校正5种经典方法对NIR光谱进行预处理。 以7个制药厂商生产的头孢克肟片光谱为例, 分析5种光谱数据预处理方法的效果。 从图4可以看出, 均值中心化方法可以使光谱之间的差异性增大, 标准化方法能有效克服光谱数据中存在的噪声点和异常值, SG算法对NIR光谱曲线进行平滑, 可有效消除光谱中噪声。</p>
                </div>
                <div class="p1">
                    <p id="63">对每一个光谱预处理方法处理后的数据进行分类实验,选取性能最佳的预处理方法, 实验结果详见表5。 表5中, ratio表示训练集占总数据的比率, acc_raw, acc_cen, acc_auto, acc_snv, acc_savg和acc_msc分别代表NIR数据未经预处理以及经过上述5种预处理测试集的分类准确率。 随机重复5次实验取均值和标准差作为实验结果, 实验中迭代周期设为100。 从表5的实验结果可以看出, 相比原始光谱实验结果, 均值中心化、 标准化、 标准正态变量变换后的分类准确率有较大的提高, 经过标准化后的光谱数据在大多数情况下取得最佳分类结果。 因此, 后续的分类实验中选取标准化为预处理方法。</p>
                </div>
                <div class="area_img" id="64">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/GUAN201911054_064.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU44R3d5TUN4L3J2VXg3V1NwMm54QT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图3 11个制药厂商苯妥英钠片光谱曲线图" src="Detail/GetImg?filename=images/GUAN201911054_064.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU44R3d5TUN4L3J2VXg3V1NwMm54QT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit"><b>图3 11个制药厂商苯妥英钠片光谱曲线图</b>  <a class="btn-zoomin" href="Detail/GetImg?filename=images/GUAN201911054_064.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU44R3d5TUN4L3J2VXg3V1NwMm54QT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"><b>Fig.3 NIR of phenytoin tablets from eleven</b> pharmaceutical manufacturers</p>

                </div>
                <div class="area_img" id="107">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/GUAN201911054_10700.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU44R3d5TUN4L3J2VXg3V1NwMm54QT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图4 光谱原图与5种方法预处理后光谱曲线图" src="Detail/GetImg?filename=images/GUAN201911054_10700.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU44R3d5TUN4L3J2VXg3V1NwMm54QT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图4 光谱原图与5种方法预处理后光谱曲线图  <a class="btn-zoomin" href="Detail/GetImg?filename=images/GUAN201911054_10700.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU44R3d5TUN4L3J2VXg3V1NwMm54QT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit">Fig.4 The original NIR and the NIR preprocessed by five methods</p>

                </div>
                <div class="area_img" id="107">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/GUAN201911054_10701.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU44R3d5TUN4L3J2VXg3V1NwMm54QT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图4 光谱原图与5种方法预处理后光谱曲线图" src="Detail/GetImg?filename=images/GUAN201911054_10701.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU44R3d5TUN4L3J2VXg3V1NwMm54QT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图4 光谱原图与5种方法预处理后光谱曲线图  <a class="btn-zoomin" href="Detail/GetImg?filename=images/GUAN201911054_10701.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU44R3d5TUN4L3J2VXg3V1NwMm54QT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit">Fig.4 The original NIR and the NIR preprocessed by five methods</p>

                </div>
                <h4 class="anchor-tag" id="69" name="69"><b>2.3 建立校正模型</b></h4>
                <div class="p1">
                    <p id="70">以7个厂商头孢克肟片未经预处理的NIR数据为例, 通过对每一个CNN模型重复多次(5次)实验, 计算光谱数据分类准确率, 选取性能最优的模型, 用于光谱数据分类实验, 实验结果如表6所示。</p>
                </div>
                <div class="p1">
                    <p id="71">表6中, ratio的含义与表5一致。 acc_cnn1—acc_cnn7分别代表上述七种CNN网络模型在测试集上的分类准确率。 从表6中可以看出, CNN-1—CNN-3这3个模型获得较优的分类性能, 而CNN-4—CNN-7这4个模型性能较差。 主要原因是CNN-4—CNN-7模型采用小的卷积核, 难以捕获光谱曲线有区分度的模式特征, 而CNN-1—CNN-3中的卷积核尺寸较大, 在光谱曲线上滑动时跨度较大, 能有效提取连续变化分辨率高的光谱曲线的模式特征。 同时, 我们观察到CNN-2比CNN-1和CNN-3整体性能更优。 CNN-1—CNN-3分别包含2～4个卷积层。 对于样本量较小的光谱数据, 采用层数过多的模型, 容易出现过拟合, 但浅层网络建模能力较弱, 综合考虑, 采用CNN-2模型进行后续实验研究。</p>
                </div>
                <div class="area_img" id="72">
                    <p class="img_tit"><b>表5 不同预处理NIR数据在CNN-2模型的分类性能</b> <a class="downexcel" onclick="DownLoadReportExcel(this)">导出到EXCEL</a></p>
                    <p class="img_tit"><b>Table 5 Classification performance of NIR data with different preprocessing methods in CNN-2 model</b></p>
                    <p class="img_note"></p>
                    <table id="72" border="1"><tr><td><br />ratio</td><td>acc_raw</td><td>acc_cen</td><td>acc_auto</td><td>acc_snv</td><td>acc_savg</td><td>acc_msc</td></tr><tr><td><br />0.8</td><td>87.35±6.21</td><td>99.41±0.72</td><td>99.12±0.72</td><td>99.71±0.59</td><td>84.71±12.43</td><td>79.71±11.89</td></tr><tr><td><br />0.7</td><td>85.74±9.51</td><td>98.02±0.0</td><td>99.01±0.89</td><td>97.23±3.22</td><td>81.58±8.62</td><td>69.5±15.68</td></tr><tr><td><br />0.6</td><td>79.7±10.87</td><td>97.14±1.46</td><td>99.1±0.56</td><td>99.25±0.48</td><td>79.55±3.76</td><td>52.33±14.89</td></tr><tr><td><br />0.5</td><td>79.03±5.67</td><td>98.67±0.8</td><td>99.03±0.91</td><td>97.45±1.85</td><td>71.52±11.08</td><td>65.82±7.44</td></tr><tr><td><br />0.4</td><td>77.59±5.99</td><td>97.59±0.86</td><td>98.39±0.74</td><td>91.96±6.85</td><td>70.65±13.95</td><td>68.04±19.7</td></tr><tr><td><br />0.3</td><td>58.53±9.49</td><td>97.49±1.07</td><td>98.18±0.69</td><td>97.49±1.63</td><td>69.35±8.21</td><td>51.77±15.64</td></tr><tr><td><br />0.2</td><td>60.45±4.32</td><td>94.39±2.01</td><td>95.53±2.25</td><td>82.12±10.61</td><td>62.27±4.1</td><td>63.71±10.96</td></tr></table>
                    <form name="form" action="/kxreader/Detail/DownloadReportExcel" method="POST" style="display:inline">
                        <input type="hidden" name="hidTable" value="" />
                        <input type="hidden" name="hidFileName" value="" />
                    </form>
                    <p class="img_note"></p>
                    <p class="img_note"></p>
                </div>
                <div class="area_img" id="73">
                    <p class="img_tit"><b>表6 七种CNN模型的分类性能对比</b> <a class="downexcel" onclick="DownLoadReportExcel(this)">导出到EXCEL</a></p>
                    <p class="img_tit"><b>Table 6 Comparison of classification performance of seven CNN models</b></p>
                    <p class="img_note"></p>
                    <table id="73" border="1"><tr><td><br />ratio</td><td>acc_cnn1</td><td>acc_cnn2</td><td>acc_cnn3</td><td>acc_cnn4</td><td>acc_cnn5</td><td>acc_cnn6</td><td>acc_cnn7</td></tr><tr><td><br />0.8</td><td>70.29±15.15</td><td>85.0±7.11</td><td>74.41±8.95</td><td>18.24±1.5</td><td>28.82±4.32</td><td>25.29±5.84</td><td>37.06±9.08</td></tr><tr><td><br />0.7</td><td>77.03±14.31</td><td>77.03±10.32</td><td>68.12±11.09</td><td>18.22±3.35</td><td>32.67±2.58</td><td>22.77±6.2</td><td>31.49±6.78</td></tr><tr><td><br />0.6</td><td>79.1±15.06</td><td>69.62±4.53</td><td>65.26±6.86</td><td>18.8±1.96</td><td>32.03±3.58</td><td>23.01±4.13</td><td>27.82±6.4</td></tr><tr><td><br />0.5</td><td>58.18±14.05</td><td>70.67±9.41</td><td>57.45±8.2</td><td>18.79±4.0</td><td>22.18±4.55</td><td>22.55±6.3</td><td>24.97±4.12</td></tr><tr><td><br />0.4</td><td>53.37±14.31</td><td>75.38±3.05</td><td>55.58±5.23</td><td>17.19±0.97</td><td>19.6±3.85</td><td>21.71±5.12</td><td>18.29±4.27</td></tr><tr><td><br />0.3</td><td>44.68±18.42</td><td>67.79±6.74</td><td>47.79±6.39</td><td>20.78±7.3</td><td>21.73±5.55</td><td>20.61±6.25</td><td>19.48±9.13</td></tr><tr><td><br />0.2</td><td>35.3±15.42</td><td>56.97±8.07</td><td>47.88±5.33</td><td>18.79±1.28</td><td>20.0±8.14</td><td>20.23±5.25</td><td>14.85±2.79</td></tr></table>
                    <form name="form" action="/kxreader/Detail/DownloadReportExcel" method="POST" style="display:inline">
                        <input type="hidden" name="hidTable" value="" />
                        <input type="hidden" name="hidFileName" value="" />
                    </form>
                    <p class="img_note"></p>
                    <p class="img_note"></p>
                </div>
                <div class="p1">
                    <p id="74">实验代码采用python2.7编写, 硬件环境GPU型号为NVIDIA Tesla P100。 在二分类和多分类光谱数据上进行实验, 并与当前最佳NIR光谱分类算法, 如SVM, BP, AE以及ELM进行比较。</p>
                </div>
                <h3 id="75" name="75" class="anchor-tag">3 结果与讨论</h3>
                <div class="p1">
                    <p id="76">本工作的实验设置思路为: 首先在头孢克肟片NIR数据上分别进行二分类和七分类实验, 然后结合苯妥英钠片NIR数据进行多药品多厂商的十八分类实验。</p>
                </div>
                <h4 class="anchor-tag" id="77" name="77"><b>3.1 二分类实验</b></h4>
                <div class="p1">
                    <p id="78">参照文献<citation id="143" type="reference">[<a class="sup">6</a>]</citation>的实验数据设置进行二分类实验。 实验样本设置为: 取表3中江苏正大生产的头孢克肟片NIR样本共63个, 作为负类样本集; 取湖南方盛、 山东鲁抗和山东罗欣三个厂商生产的头孢克肟片NIR样本共153个, 作为正类样本集。 两组数据的实验结果如表7所示。 二分类实验由于分类性能都较好, 不能体现本文设计的CNN模型的优越性。</p>
                </div>
                <div class="area_img" id="79">
                    <p class="img_tit"><b>表7 二分类实验不同方法分类准确率</b> <a class="downexcel" onclick="DownLoadReportExcel(this)">导出到EXCEL</a></p>
                    <p class="img_tit"><b>Table 7 Classification accuracy of different methods in binary classification experiment</b></p>
                    <p class="img_note"></p>
                    <table id="79" border="1"><tr><td><br />ratio</td><td>acc_cnn</td><td>acc_svm</td><td>acc_bp</td><td>acc_ae</td><td>acc_elm</td></tr><tr><td><br />0.8</td><td>100.0±0.0</td><td>100.0±0.0</td><td>100.0±0.0</td><td>94.09±11.82</td><td>100.0±0.0</td></tr><tr><td><br />0.7</td><td>100.0±0.0</td><td>100.0±0.0</td><td>100.0±0.0</td><td>94.15±11.69</td><td>100.0±0.0</td></tr><tr><td><br />0.6</td><td>100.0±0.0</td><td>99.77±0.47</td><td>98.84±1.8</td><td>99.3±0.93</td><td>100.0±0.0</td></tr><tr><td><br />0.5</td><td>99.81±0.37</td><td>99.81±0.37</td><td>99.25±0.7</td><td>92.9±11.07</td><td>100.0±0.0</td></tr><tr><td><br />0.4</td><td>99.22±0.98</td><td>99.69±0.38</td><td>99.69±0.62</td><td>99.22±1.2</td><td>100.0±0.0</td></tr><tr><td><br />0.3</td><td>99.07±0.53</td><td>99.33±0.42</td><td>98.4±0.68</td><td>87.73±13.15</td><td>99.07±0.68</td></tr><tr><td><br />0.2</td><td>97.78±1.19</td><td>98.71±0.86</td><td>99.06±0.7</td><td>91.7±10.69</td><td>99.18±0.79</td></tr></table>
                    <form name="form" action="/kxreader/Detail/DownloadReportExcel" method="POST" style="display:inline">
                        <input type="hidden" name="hidTable" value="" />
                        <input type="hidden" name="hidFileName" value="" />
                    </form>
                    <p class="img_note"></p>
                    <p class="img_note"></p>
                </div>
                <h4 class="anchor-tag" id="80" name="80"><b>3.2 多分类实验</b></h4>
                <h4 class="anchor-tag" id="81" name="81">(1)七分类实验。</h4>
                <div class="p1">
                    <p id="82">表3中7个厂商生产的头孢克肟片NIR样本分别作为不同的类, 计7类。 实验结果如表8所示, CNN在ratio=0.7, 0.6时, 相比其他方法, 获得最高分类准确率; ELM算法在ratio较小时, 获得最佳性能, 但在这些情况下, CNN与ELM性能相近。 相同条件下, CNN比SVM高1～3个点, 比BP高1～2.8个点, 比AE高4～21个点。 图5为七分类ratio=0.7时, 迭代周期为100的ROC曲线, 从图中可以看出, ELM方法的AUC值为1, CNN的AUC值为0.9997, 接近1, 说明两个方法取得非常好的分类性能。 SVM, BP和AE方法的AUC值也大于0.9, 表明分类性能也不错。 该结论从表8中也可以得到佐证。</p>
                </div>
                <div class="area_img" id="83">
                    <p class="img_tit"><b>表8 七分类实验不同方法分类准确率</b> <a class="downexcel" onclick="DownLoadReportExcel(this)">导出到EXCEL</a></p>
                    <p class="img_tit"><b>Table 8 Classification accuracy of different methods in seven classification experiments</b></p>
                    <p class="img_note"></p>
                    <table id="83" border="1"><tr><td><br />ratio</td><td>acc_cnn</td><td>acc_svm</td><td>acc_bp</td><td>acc_ae</td><td>acc_elm</td></tr><tr><td><br />0.8</td><td>99.12±1.18</td><td>98.53±1.61</td><td>97.94±1.18</td><td>95.29±5.98</td><td>99.41±1.18</td></tr><tr><td><br />0.7</td><td>98.81±1.15</td><td>95.64±1.34</td><td>97.82±1.92</td><td>86.73±8.18</td><td>98.61±1.34</td></tr><tr><td><br />0.6</td><td>99.25±0.67</td><td>97.74±1.26</td><td>98.65±1.67</td><td>77.74±20.23</td><td>98.95±0.77</td></tr><tr><td><br />0.5</td><td>98.3±0.89</td><td>96.97±1.15</td><td>97.21±0.98</td><td>77.82±15.93</td><td>98.91±0.8</td></tr><tr><td><br />0.4</td><td>96.18±2.47</td><td>93.67±2.87</td><td>95.08±1.57</td><td>79.1±12.87</td><td>97.89±0.86</td></tr><tr><td><br />0.3</td><td>96.1±2.27</td><td>93.25±1.59</td><td>93.59±2.42</td><td>72.03±7.59</td><td>97.66±1.05</td></tr><tr><td><br />0.2</td><td>93.94±1.1</td><td>91.06±1.6</td><td>91.14±3.21</td><td>78.26±10.17</td><td>97.42±1.08<br /></td></tr></table>
                    <form name="form" action="/kxreader/Detail/DownloadReportExcel" method="POST" style="display:inline">
                        <input type="hidden" name="hidTable" value="" />
                        <input type="hidden" name="hidFileName" value="" />
                    </form>
                    <p class="img_note"></p>
                    <p class="img_note"></p>
                </div>
                <div class="area_img" id="84">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/GUAN201911054_084.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU44R3d5TUN4L3J2VXg3V1NwMm54QT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图5 ratio=0.7时七分类实验ROC曲线" src="Detail/GetImg?filename=images/GUAN201911054_084.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU44R3d5TUN4L3J2VXg3V1NwMm54QT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit"><b>图5 ratio=0.7时七分类实验ROC曲线</b>  <a class="btn-zoomin" href="Detail/GetImg?filename=images/GUAN201911054_084.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU44R3d5TUN4L3J2VXg3V1NwMm54QT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"><b>Fig.5 ROC curve of seven classification</b> experiment when ratio is 0.7</p>

                </div>
                <h4 class="anchor-tag" id="86" name="86">(2)十八分类实验。</h4>
                <div class="p1">
                    <p id="87">取表3中7个厂商生产的头孢克肟片光谱样本以及表4中11个不同厂商生产的苯妥英钠片NIR数据分别作为不同的类, 共18类。 实验结果如表9、 表10所示。 表9是十八分类实验不同方法分类准确率, 环比二分类和七分类实验结果, CNN方法在十八分类实验中仍然获得了非常好的性能, 但其他方法性能下降幅度较大, 尤其是SVM和ELM, 体现了CNN方法对于多药品、 多厂商分类的优越性。 实验中采用one-against-all策略构造多类SVM分类器, 由于算法策略带来的样本不平衡问题, 导致分类准确率一定程度的降低。 ELM模型在隐藏层的权重和偏置被随机确定后, 隐藏层的输出矩阵<i><b>H</b></i>就被唯一确定。 训练单隐层神经网络可以转化为求解一个线性方程<i><b>H</b></i><i>β</i>=<i><b>T</b></i>, 并且输出权重<i>β</i>可以被确定为<mathml id="96"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mover accent="true"><mi>β</mi><mo>^</mo></mover><mo>=</mo><mi mathvariant="bold-italic">Η</mi><msup><mrow></mrow><mo>*</mo></msup><mi mathvariant="bold-italic">Τ</mi></mrow></math></mathml>。 然而, ELM这种模型的求解方式容易出现过拟合的现象。 表10是十八分类实验各方法的训练和推理时间列表。 从表中可以看出, 所有算法随着训练集所占比率的减小, 训练时间呈下降趋势。 SVM算法的模型训练时间最少, ELM算法次之, BP, AE以及CNN训练时间开销较大。 推理时间方面, BP, AE以及CNN在一个数量级, 速度较快, 而SVM和ELM的推理时间比其他3种方法多一个数量级。 从时间维度来看, 模型推理时间往往更值得关注, 因为模型一般是离线训练, 然后再上线部署。 图6是十八分类ratio=0.2时, 迭代周期为100的ROC曲线图。5种方法获得的AUC值都较大, 证明这些方法都较适合NIR光谱数据的分类, 其中, CNN模型获得最大AUC值, 从另一个角度也证明了CNN模型在多分类准确率方面的优越性。</p>
                </div>
                <div class="area_img" id="88">
                    <p class="img_tit"><b>表9 十八分类实验不同方法分类准确率</b> <a class="downexcel" onclick="DownLoadReportExcel(this)">导出到EXCEL</a></p>
                    <p class="img_tit"><b>Table 9 Classification accuracy of different methods in eighteen classification experiment</b></p>
                    <p class="img_note"></p>
                    <table id="88" border="1"><tr><td><br />ratio</td><td>acc_cnn</td><td>acc_svm</td><td>acc_bp</td><td>acc_ae</td><td>acc_elm</td></tr><tr><td><br />0.8</td><td>99.16±0.75</td><td>88.69±2.22</td><td>90.84±1.86</td><td>89.07±6.52</td><td>80.84±3.4</td></tr><tr><td><br />0.7</td><td>99.37±0.45</td><td>87.38±1.0</td><td>90.73±2.86</td><td>95.33±1.87</td><td>78.55±3.9</td></tr><tr><td><br />0.6</td><td>98.0±0.32</td><td>86.9±1.29</td><td>90.71±1.78</td><td>91.1±4.31</td><td>86.1±1.19</td></tr><tr><td><br />0.5</td><td>97.81±0.6</td><td>84.8±1.08</td><td>86.76±4.25</td><td>88.06±7.01</td><td>88.25±0.87</td></tr><tr><td><br />0.4</td><td>96.17±0.23</td><td>82.71±2.14</td><td>85.23±5.76</td><td>83.41±4.63</td><td>90.3±1.22</td></tr><tr><td><br />0.3</td><td>94.55±1.61</td><td>80.41±1.73</td><td>83.86±3.31</td><td>80.41±4.84</td><td>88.22±2.28</td></tr><tr><td><br />0.2</td><td>89.03±1.92</td><td>76.59±2.48</td><td>81.2±2.86</td><td>74.48±3.75</td><td>85.88±1.66<br /></td></tr></table>
                    <form name="form" action="/kxreader/Detail/DownloadReportExcel" method="POST" style="display:inline">
                        <input type="hidden" name="hidTable" value="" />
                        <input type="hidden" name="hidFileName" value="" />
                    </form>
                    <p class="img_note"></p>
                    <p class="img_note"></p>
                </div>
                <div class="area_img" id="89">
                    <p class="img_tit"><b>表10 十八分类实验不同方法训练时间和推理时间(单位: 秒</b>) <a class="downexcel" onclick="DownLoadReportExcel(this)">导出到EXCEL</a></p>
                    <p class="img_tit"><b>Table 10 Training and inference time of different methods in eighteen classification experiments (unit: s</b>)</p>
                    <p class="img_note"></p>
                    <table id="89" border="1"><tr><td><br />ratio</td><td>ttime_cnn</td><td>ttime_svm</td><td>ttime_bp</td><td>ttime_ae</td><td>ttime_elm</td></tr><tr><td><br />0.8</td><td>88.13</td><td>3.37</td><td>28.52</td><td>27.91</td><td>2.29</td></tr><tr><td><br />0.7</td><td>80.03</td><td>2.7</td><td>27.91</td><td>27.2</td><td>1.94</td></tr><tr><td><br />0.6</td><td>73.06</td><td>2.16</td><td>27.09</td><td>26.47</td><td>1.45</td></tr><tr><td><br />0.5</td><td>64.41</td><td>1.67</td><td>26.08</td><td>24.51</td><td>1.14</td></tr><tr><td><br />0.4</td><td>56.91</td><td>1.16</td><td>24.62</td><td>23.96</td><td>0.75</td></tr><tr><td><br />0.3</td><td>50.68</td><td>0.71</td><td>24.52</td><td>22.02</td><td>0.5</td></tr><tr><td><br />0.2</td><td>26.13</td><td>0.39</td><td>23.26</td><td>23.28</td><td>0.28</td></tr><tr><td><br />ratio</td><td>itime_cnn</td><td>itime_svm</td><td>itime_bp</td><td>itime_ae</td><td>itime_elm</td></tr><tr><td><br />0.8</td><td>0.04</td><td>0.41</td><td>0.01</td><td>0.01</td><td>0.1</td></tr><tr><td><br />0.7</td><td>0.05</td><td>0.56</td><td>0.01</td><td>0.01</td><td>0.18</td></tr><tr><td><br />0.6</td><td>0.07</td><td>0.67</td><td>0.02</td><td>0.02</td><td>0.28</td></tr><tr><td><br />0.5</td><td>0.09</td><td>0.77</td><td>0.03</td><td>0.03</td><td>0.41</td></tr><tr><td><br />0.4</td><td>0.06</td><td>0.79</td><td>0.03</td><td>0.03</td><td>0.62</td></tr><tr><td><br />0.3</td><td>0.1</td><td>0.76</td><td>0.03</td><td>0.04</td><td>0.85</td></tr><tr><td><br />0.2</td><td>0.08</td><td>0.68</td><td>0.05</td><td>0.04</td><td>1.09</td></tr></table>
                    <form name="form" action="/kxreader/Detail/DownloadReportExcel" method="POST" style="display:inline">
                        <input type="hidden" name="hidTable" value="" />
                        <input type="hidden" name="hidFileName" value="" />
                    </form>
                    <p class="img_note"></p>
                    <p class="img_note"></p>
                </div>
                <h3 id="91" name="91" class="anchor-tag">4 结 论</h3>
                <div class="p1">
                    <p id="92">设计了几种简单但非常有效的一维深度卷积网络模型,用于药品的NIR鉴别分析, 并对卷积网络层数以及卷积核尺寸对建模结果的影响进行详细实验研究, 同时分析五种经典预处理方法对药品NIR数据分析的影响。 与当前最佳方法, 比如: SVM,  BP,  AE,  ELM算法进行对比, 在大规模, 多药品、 多厂商NIR鉴别实验中取得了更高的分类准确率和良好的可扩展性。 一维深度卷积网络模型推理阶段速度较快, 优于SVM和ELM算法, 但训练速度慢于二者。</p>
                </div>
                <div class="area_img" id="93">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/GUAN201911054_093.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU44R3d5TUN4L3J2VXg3V1NwMm54QT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图6 ratio=0.2时十八分类ROC曲线" src="Detail/GetImg?filename=images/GUAN201911054_093.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU44R3d5TUN4L3J2VXg3V1NwMm54QT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit"><b>图6 ratio=0.2时十八分类ROC曲线</b>  <a class="btn-zoomin" href="Detail/GetImg?filename=images/GUAN201911054_093.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU44R3d5TUN4L3J2VXg3V1NwMm54QT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"><b>Fig.6 ROC curve of eighteen classification</b> experiment when ratiois 0.2</p>

                </div>

        <!--brief end-->
        
        <!--conten left  end-->
        <!--增强附件-->
        

        <!--reference start-->
            <div class="reference anchor-tag" id="a_bibliography">
                    <h3>参考文献</h3>
                                        <p id="108">
                            <a id="bibliography_1" target="_blank" href="">

                                <b>[1]</b> Ma H L,Wang J W,Chen Y J,et al.Food Chemistry,2017,215:108.
                            </a>
                        </p>
                        <p id="110">
                            <a id="bibliography_2" target="_blank" href="">

                                <b>[2]</b> Lê L M M,Eveleigh L,Hasnaoui I,et al.Journal of Pharmaceutical and Biomedical Analysis,2017,138:249.
                            </a>
                        </p>
                        <p id="112">
                            <a id="bibliography_3" target="_blank" href="">

                                <b>[3]</b> Xue J T,Ye L M,Li C Y,et al.Optik,2018,170:30.
                            </a>
                        </p>
                        <p id="114">
                            <a id="bibliography_4" target="_blank" href="">

                                <b>[4]</b> Risoluti R,Materazzi S,Gregori A,et al.Talanta,2016,153:407.
                            </a>
                        </p>
                        <p id="116">
                            <a id="bibliography_5" target="_blank" href="">

                                <b>[5]</b> Deconinck E,Sacré P Y,Coomans D,et al.Journal of Pharmaceutical and Biomedical Analysis,2012,57:68.
                            </a>
                        </p>
                        <p id="118">
                            <a id="bibliography_6" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=FXHX201809018&amp;v=MTA1ODR2UjRUNmo1NE8zenFxQnRHRnJDVVJMT2VaZVJwRkNuZ1VMekFJelhEZHJHNEg5bk1wbzlFYklRS0RIODQ=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU44R3d5TUN4L3J2VXg3V1NwMm54QT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[6]</b> ZHANG Wei-dong,LI Ling-qiao,HU Jin-quan,et al(张卫东,李灵巧,胡锦泉,等).Chinese Journal of Analytical Chemistry(分析化学),2018,46(9):1446.
                            </a>
                        </p>
                        <p id="120">
                            <a id="bibliography_7" target="_blank" href="">

                                <b>[7]</b> Yang H H,Hu B C,Pan X P,et al.Journal of Innovative Optical Health Sciences,2016,10(2):1630011.
                            </a>
                        </p>
                        <p id="122">
                            <a id="bibliography_8" target="_blank" href="">

                                <b>[8]</b> Lecun Y,Bengio Y,Hinton G.Nature,2015,521(7553):436.
                            </a>
                        </p>
                        <p id="124">
                            <a id="bibliography_9" target="_blank" href="">

                                <b>[9]</b> Nassif A B,Shahin I,Attili I,et al.IEEE Access,2019,7:19143.
                            </a>
                        </p>
                        <p id="126">
                            <a id="bibliography_10" target="_blank" href="">

                                <b>[10]</b> Lai D,Tian W,Chen L.Pattern Recognition,2019,88:547.
                            </a>
                        </p>
                        <p id="128">
                            <a id="bibliography_11" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=GUAN201812014&amp;v=MzA1NjY0VDZqNTRPM3pxcUJ0R0ZyQ1VSTE9lWmVScEZDbmdVTHpBSWpqS1lMRzRIOW5Oclk5RVlJUUtESDg0dlI=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU44R3d5TUN4L3J2VXg3V1NwMm54QT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[11]</b> LU Meng-yao,YANG Kai,SONG Peng-fei,et al(鲁梦瑶,杨凯,宋鹏飞,等).Spectroscopy and Spectral Analysis(光谱学与光谱分析),2018,38(12):3724.
                            </a>
                        </p>
                        <p id="130">
                            <a id="bibliography_12" target="_blank" href="">

                                <b>[12]</b> Acquarelli J,Laarhoven T V,Gerretzen J,et al.Analytica Chimica Acta,2017,954:22.
                            </a>
                        </p>
                        <p id="132">
                            <a id="bibliography_13" target="_blank" href="">

                                <b>[13]</b> Srivastava N,Hinton G,Krizhevsky A,et al.Journal of Machine Learning Research,2014,15(1):1929.
                            </a>
                        </p>
            </div>
        <!--reference end-->
        <!--footnote start-->
        <!--footnote end-->



    </div>

        <input id="fileid" type="hidden" value="GUAN201911054" />
        <input id="dpi" type="hidden" value="600" />
    </div>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?6e967eb120601ea41b9d312166416aa6";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
</script>


    


<input id="hid_uid" name="hid_uid" type="hidden" value="WEEvREcwSlJHSldRa1Fhb09jT0lPUU44R3d5TUN4L3J2VXg3V1NwMm54QT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
<input id="hid_kLogin_headerUrl" name="hid_kLogin_headerUrl" type="hidden" value="/KLogin/Request/GetKHeader.ashx%3Fcallback%3D%3F" />
<input id="hid_kLogin_footerUrl" name="hid_kLogin_footerUrl" type="hidden" value="/KLogin/Request/GetKFooter.ashx%3Fcallback%3D%3F" />
<div class="btn-link" style="display: none"><a target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=GUAN201911054&amp;v=MDE0NTdJUUtESDg0dlI0VDZqNTRPM3pxcUJ0R0ZyQ1VSTE9lWmVScEZDbmdVTHpBSWpqS1lMRzRIOWpOcm85QVk=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU44R3d5TUN4L3J2VXg3V1NwMm54QT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">知网节</a></div>
<div class="popflow" id="popupTips" style="display: none;">
    <div class="popflowArr"></div>
    <div class="popflowCot">
        <div class="hd"><a href="javascript:void(0);" onclick="$('#popupTips').hide();$('#popupmsg').html('')" class="close">X</a></div>
        <div class="bd">
            <p class="mes" id="popupmsg" name="popupmsg"></p>
          
        </div>
    </div>
</div>
<input type="hidden" id="myexport" value="//kns.cnki.net" />

<input type="hidden" id="KPCAPIPATH" value="//ishufang.cnki.net" />
<input type="hidden" id="CitedTimes" value="0" />
<div class="link" id="GLSearch" style="display: none;">
    <i class="icon-trangle"></i>
    <div class="inner">
        <a class="icon" id="copytext">复制</a>
        <a class="icon" target="_blank" onclick="searchCRFD(this)">工具书搜索</a>
    </div>
</div>




<input id="hidVirtualPath" name="hidVirtualPath" type="hidden" value="/kxreader" />
<script src="/kxreader/bundles/detail?v=-ULdk-c6FkZHtJA2KAXPgHnyA8mtgyPnBde_C2VZ2BY1"></script>

<script src="/kxreader/Scripts/layer.min.js" type="text/javascript"></script>

<div id="footerBox" class="rootw footer">
</div>
<script>
    if (typeof FlushLogin == 'function') {
        FlushLogin();
    }
    modifyEcpHeader(true);
</script>

<!--图片放大功能 start-->
<script src="/kxreader/bundles/imagebox?v=W4phPu9SNkGcuPeJclikuVE3PpRyIW_gnfjm_19nynI1"></script>

<script type="text/javascript">
    $(function () {
        var j = $.noConflict();
        j(function () {
            j(".zoom-in,.btn-zoomin").imgbox({
                'alignment': 'center',
                'allowMultiple': false,
                'overlayShow': true
            });
        })
    });
</script>
<!--图片放大功能 end-->
<div class="fixedbar">
    <div class="backtop hiddenV" id="backtop">
        <a id="backTopSide" href="javascript:scroll(0,0);" title=""></a>
    </div>
</div>
<script type="text/javascript" src="/kxreader/Scripts/MathJax-2.6-latest/MathJax.js?config=MML_HTMLorMML-full"></script>


    <link href="/kxreader/Content/css/LeftDetail?v=NLcKG8I1SJUaVFrQ0iGpF2klAT0OsmHRaVSZ1rKb5xg1" rel="stylesheet"/>

</body>
</html>

