

<!DOCTYPE html>
<html>
<head>
    <title>全文阅读--XML全文阅读--中国知网</title>
    <link rel="icon" href="/kxreader/favicon.ico" />
    <link rel="shortcut Icon" href="/kxreader/favicon.ico" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="keywords" content="文献 XML KBASE CNKI 中国知网" />
    <meta name="description" content="XML文献检索" />
    <script type="text/javascript">
        var APPPATH = '/kxreader';
    </script>

</head>

<body>

    
<script type="text/javascript" src="//login.cnki.net/TopLogin/api/loginapi/get?type=top&amp;localCSS=&amp;returnurl=%2f%2fkns.cnki.net%2fKXReader%2fDetail%3fTIMESTAMP%3d637139163868232500%26DBCODE%3dCJFD%26TABLEName%3dCJFDLAST2019%26FileName%3dDZKK201911010%26RESULT%3d1%26SIGN%3dbw71PeKhQ2dUK1hqJN1alHThFwU%253d"></script>

<div id="headerBox" class="header">
    <div class="topbar">
        <div class="textalign">
            <a href="/kxreader/Detail?dbcode=CJFD&amp;filename=DZKK201911010&amp;align=md">
                <i class="icon-cen active" title="居中对齐"></i>
            </a>
            <a href="/kxreader/Detail?dbcode=CJFD&amp;filename=DZKK201911010&amp;align=lt">
                <i class="icon-left " title="左对齐"></i>
            </a>
        </div>
        <h6 class="free-tip"><i class="icon"></i>HTML阅读开放试用阶段，欢迎体验！</h6>
    </div>
</div>


    



<div class="btn-link" style="display: none"><a target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=DZKK201911010&amp;v=MTc4NDM0dlI0VDZqNTRPM3pxcUJ0R0ZyQ1VSN3FmWnVacEZ5M2tWTHpQSVRmQVpiRzRIOWpOcm85RVpJUUtESDg=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZONEl2ZXMzNXJlUkZjWFB4bHhwYz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">知网节</a></div>

    <div class="main">

        

    <div class="sidebar-a">
        <!--sidebar start-->
        <div class="sidenav">
            <div class="arrow"><span></span></div>
            <!--sidebar_list start-->
            <dl class="sidenav-list">
                    <dt class="tit">目录结构</dt>
                            <dd class="guide">
                                    <p><a href="#40" data-title="&lt;b&gt;1 系统总体设计和同步原理&lt;/b&gt; "><b>1 系统总体设计和同步原理</b></a><i></i></p>
                                                                    <ul class="contentbox">
                                                <li><a href="#41" data-title="&lt;b&gt;1.1 系统总体设计&lt;/b&gt;"><b>1.1 系统总体设计</b></a></li>
                                                <li><a href="#44" data-title="&lt;b&gt;1.2 系统同步原理&lt;/b&gt;"><b>1.2 系统同步原理</b></a></li>
                                    </ul>
                            </dd>
                            <dd class="guide">
                                    <p><a href="#57" data-title="&lt;b&gt;2 系统同步过程&lt;/b&gt; "><b>2 系统同步过程</b></a><i></i></p>
                                                                    <ul class="contentbox">
                                                <li><a href="#58" data-title="&lt;b&gt;2.1 主系统同步过程&lt;/b&gt;"><b>2.1 主系统同步过程</b></a></li>
                                                <li><a href="#68" data-title="&lt;b&gt;2.2 从系统同步过程&lt;/b&gt;"><b>2.2 从系统同步过程</b></a></li>
                                    </ul>
                            </dd>
                            <dd class="guide">
                                    <p><a href="#70" data-title="&lt;b&gt;3 结果验证&lt;/b&gt; "><b>3 结果验证</b></a><i></i></p>
                                                            </dd>
                            <dd class="guide">
                                    <p><a href="#80" data-title="&lt;b&gt;4 结束语&lt;/b&gt; "><b>4 结束语</b></a><i></i></p>
                                                            </dd>
                            <dd class="guide">
                                    <p><a href="#" data-title="文内图表 ">文内图表</a><i></i></p>
                                                                    <ul class="contentbox">
                                                <li><a href="#43" data-title="图1 系统详细框图">图1 系统详细框图</a></li>
                                                <li><a href="#47" data-title="图2 时间同步原理图">图2 时间同步原理图</a></li>
                                                <li><a href="#95" data-title="图3 PTP报文封装格式">图3 PTP报文封装格式</a></li>
                                                <li><a href="#64" data-title="图4 主系统发送状态机">图4 主系统发送状态机</a></li>
                                                <li><a href="#67" data-title="图5 主系统接收状态机">图5 主系统接收状态机</a></li>
                                                <li><a href="#72" data-title="图6 实验平台">图6 实验平台</a></li>
                                                <li><a href="#74" data-title="图7 从系统1时间同步">图7 从系统1时间同步</a></li>
                                                <li><a href="#75" data-title="图8 从系统2时间同步">图8 从系统2时间同步</a></li>
                                                <li><a href="#78" data-title="&lt;b&gt;表&lt;/b&gt;1 &lt;b&gt;时间同步成功率&lt;/b&gt;"><b>表</b>1 <b>时间同步成功率</b></a></li>
                                    </ul>
                            </dd>
                                    <dd class="guide">
                                        <h6>
                                            <p><a href="#a_bibliography">参考文献</a> </p>
                                        </h6>
                                    </dd>

            </dl>
        </div>
        <!--sidebar end-->
        &nbsp;
        <!--此处有一空格符 勿删-->
    </div>

                <div class="sidebar-b three-collumn" style="width:0;">
            <div class="refer" style="width: 0;">
                <div class="arrow off" title="参考文献"><span></span></div>
                <div class="js-scrollbox" >
                    
                    <div class="subbox active">
                        <h4>
                            <span class="tit">参考文献</span>
                            <a class="close" href="javascript:void(0)">x</a>
                        </h4>
                        <div class="side-scroller">
                            <ul class="refer-list">
                                <li id="3">


                                    <a id="bibliography_1" title=" IEEE.IEEE Std 1588-2002,IEEE standard for a precision clock synchronization protocol for networked measurement and control system[S].New York:IEEE,2002." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=IEEE standard for a precision clock synchronization protocol for networked measurement and control systems">
                                        <b>[1]</b>
                                         IEEE.IEEE Std 1588-2002,IEEE standard for a precision clock synchronization protocol for networked measurement and control system[S].New York:IEEE,2002.
                                    </a>
                                </li>
                                <li id="5">


                                    <a id="bibliography_2" title=" IEEE.IEEE Std 1588-2008,IEEE standard for a precision clock synchronization protocol for networked measurement and control system[S].New York:IEEE,2008." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=IEEE Standard for a Precision Clock Synchronization Protocol for Networked Measurement and Control Systems">
                                        <b>[2]</b>
                                         IEEE.IEEE Std 1588-2008,IEEE standard for a precision clock synchronization protocol for networked measurement and control system[S].New York:IEEE,2008.
                                    </a>
                                </li>
                                <li id="7">


                                    <a id="bibliography_3" title=" Crossley P A,Guo H,Ma Z.Time synchronization for transmission substations using GPS and IEEE 1588[J].CSEE Journal of Power and Energy Systems,2016,2(3):91-99." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Time synchronization for transmission substations using GPS and IEEE 1588">
                                        <b>[3]</b>
                                         Crossley P A,Guo H,Ma Z.Time synchronization for transmission substations using GPS and IEEE 1588[J].CSEE Journal of Power and Energy Systems,2016,2(3):91-99.
                                    </a>
                                </li>
                                <li id="9">


                                    <a id="bibliography_4" title=" Astarloa A,Moreira N,Bidarte U,et al.FPGA based nodes for sub-microsecond synchronization of cyber-physical production systems on high availability ring networks[C].Mexico City:International Conference on ReConFigurable Computing and FPGAs(ReConFig),2015." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=FPGA based nodes for sub-microsecond synchronization of cyber-physical production systems on high availability ring networks">
                                        <b>[4]</b>
                                         Astarloa A,Moreira N,Bidarte U,et al.FPGA based nodes for sub-microsecond synchronization of cyber-physical production systems on high availability ring networks[C].Mexico City:International Conference on ReConFigurable Computing and FPGAs(ReConFig),2015.
                                    </a>
                                </li>
                                <li id="11">


                                    <a id="bibliography_5" title=" Oliver D,Otto A J,Neufeld N.A study of the merits of precision time protocol (IEEE-1588) across high-speed data networks[M].Meyrin:CERN,2015." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=A study of the merits of precision time protocol (IEEE-1588) across high-speed data networks">
                                        <b>[5]</b>
                                         Oliver D,Otto A J,Neufeld N.A study of the merits of precision time protocol (IEEE-1588) across high-speed data networks[M].Meyrin:CERN,2015.
                                    </a>
                                </li>
                                <li id="13">


                                    <a id="bibliography_6" title=" Le Pallec M,Bui D T.Automatic capture of the network delay components:U.S.,patent application,9413625[P].2016-08-09." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Automatic capture of the network delay components">
                                        <b>[6]</b>
                                         Le Pallec M,Bui D T.Automatic capture of the network delay components:U.S.,patent application,9413625[P].2016-08-09.
                                    </a>
                                </li>
                                <li id="15">


                                    <a id="bibliography_7" title=" Ruffini S,Gray E W,Kini S,et al.Transmitting residence time information in a network:U.S.,Patent Application,15/524540[P].2017-11-09." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Transmitting residence time information in a network">
                                        <b>[7]</b>
                                         Ruffini S,Gray E W,Kini S,et al.Transmitting residence time information in a network:U.S.,Patent Application,15/524540[P].2017-11-09.
                                    </a>
                                </li>
                                <li id="17">


                                    <a id="bibliography_8" title=" Dong M,Qiu Z,Pan W,et al.The design and implementation of IEEE 1588v2 clock synchronization system by generating hardware timestamps in MAC layer[C].Colmar:International Conference on Computer,Information and Telecommunication Systems (CITS),2018." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=The design and implementation of IEEE 1588v2 clock synchronization system by generating hardware timestamps in MAC layer">
                                        <b>[8]</b>
                                         Dong M,Qiu Z,Pan W,et al.The design and implementation of IEEE 1588v2 clock synchronization system by generating hardware timestamps in MAC layer[C].Colmar:International Conference on Computer,Information and Telecommunication Systems (CITS),2018.
                                    </a>
                                </li>
                                <li id="19">


                                    <a id="bibliography_9" title=" Fubin P,Yubo Y,Lei G,et al.The accuracy of IEEE 1588 time synchronization protocol and its improvement[C].Qingdao:12&lt;sup&gt;th&lt;/sup&gt; IEEE International Conference on Electronic Measurement &amp;amp; Instruments (ICEMI),2015." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=The accuracy of IEEE 1588 time synchronization protocol and its improvement">
                                        <b>[9]</b>
                                         Fubin P,Yubo Y,Lei G,et al.The accuracy of IEEE 1588 time synchronization protocol and its improvement[C].Qingdao:12&lt;sup&gt;th&lt;/sup&gt; IEEE International Conference on Electronic Measurement &amp;amp; Instruments (ICEMI),2015.
                                    </a>
                                </li>
                                <li id="21">


                                    <a id="bibliography_10" title=" 郑恭明,沈媛媛.基于FPGA的GPS同步时钟系统设计[J].桂林理工大学学报,2015,35(1):198-201.Zheng Gongming,Shen Yuanyuan.Design of GPS synchronous clock system based on FPGA[J].Journal of Guilin University of Technology,2015,35(1):198-201." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=GLGX201501032&amp;v=MjkwNjI4NHZSNFQ2ajU0TzN6cXFCdEdGckNVUjdxZlp1WnBGeTNrVkx6T0lpSE1kckc0SDlUTXJvOUdab1FLREg=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZONEl2ZXMzNXJlUkZjWFB4bHhwYz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[10]</b>
                                         郑恭明,沈媛媛.基于FPGA的GPS同步时钟系统设计[J].桂林理工大学学报,2015,35(1):198-201.Zheng Gongming,Shen Yuanyuan.Design of GPS synchronous clock system based on FPGA[J].Journal of Guilin University of Technology,2015,35(1):198-201.
                                    </a>
                                </li>
                                <li id="23">


                                    <a id="bibliography_11" title=" 魏建新.IEEE1588时钟同步技术在飞行试验遥测网络系统中的应用[J].计算机测量与控制,2015,23(4):1115-1117.Wei Jianxin.Application of IEEE1588 clock synchronization technology in network system of flight test telemetry[J].Computer Measurement and Control,2015,23(4):1115-1117." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JZCK201504015&amp;v=MDQ1NTN5M2tWTHpPTHpmSVpiRzRIOVRNcTQ5RVlZUUtESDg0dlI0VDZqNTRPM3pxcUJ0R0ZyQ1VSN3FmWnVacEY=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZONEl2ZXMzNXJlUkZjWFB4bHhwYz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[11]</b>
                                         魏建新.IEEE1588时钟同步技术在飞行试验遥测网络系统中的应用[J].计算机测量与控制,2015,23(4):1115-1117.Wei Jianxin.Application of IEEE1588 clock synchronization technology in network system of flight test telemetry[J].Computer Measurement and Control,2015,23(4):1115-1117.
                                    </a>
                                </li>
                                <li id="25">


                                    <a id="bibliography_12" title=" Kero N,Kernen T,Muller T,et al.Optimizing large media networks for highly accurate time transfer via PTP[J].SMPTE Motion Imaging Journal,2016,125(2):30-44." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Optimizing large media networks for highly accurate time transfer via PTP">
                                        <b>[12]</b>
                                         Kero N,Kernen T,Muller T,et al.Optimizing large media networks for highly accurate time transfer via PTP[J].SMPTE Motion Imaging Journal,2016,125(2):30-44.
                                    </a>
                                </li>
                                <li id="27">


                                    <a id="bibliography_13" title=" 杜慧琦,刘玥,刘博,等.IEEE1588v2时钟同步技术在战术信息系统中的应用[J].计算机应用与软件,2017,34(11):125-129.Du Huiqi,Liu Yue,Liu Bo,et al.Application of IEEE1588v2 clock synchronization technology in tactical information system[J].Computer Applications and Software,2017,34(11):125-129." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JYRJ201711023&amp;v=MTMxMTR6cXFCdEdGckNVUjdxZlp1WnBGeTNrVkx6T0x6VFpaTEc0SDliTnJvOUhaNFFLREg4NHZSNFQ2ajU0TzM=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZONEl2ZXMzNXJlUkZjWFB4bHhwYz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[13]</b>
                                         杜慧琦,刘玥,刘博,等.IEEE1588v2时钟同步技术在战术信息系统中的应用[J].计算机应用与软件,2017,34(11):125-129.Du Huiqi,Liu Yue,Liu Bo,et al.Application of IEEE1588v2 clock synchronization technology in tactical information system[J].Computer Applications and Software,2017,34(11):125-129.
                                    </a>
                                </li>
                                <li id="29">


                                    <a id="bibliography_14" title=" Yin H,Fu P,Qiao J,et al.The implementation of IEEE 1588 clock synchronization protocol based on FPGA[C].Houston:IEEE International Instrumentation and Measurement Technology Conference (I&lt;sup&gt;2&lt;/sup&gt;MTC),2018." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=The Implementation of IEEE 1588 Clock Synchronization Protocol Based on FPGA">
                                        <b>[14]</b>
                                         Yin H,Fu P,Qiao J,et al.The implementation of IEEE 1588 clock synchronization protocol based on FPGA[C].Houston:IEEE International Instrumentation and Measurement Technology Conference (I&lt;sup&gt;2&lt;/sup&gt;MTC),2018.
                                    </a>
                                </li>
                                <li id="31">


                                    <a id="bibliography_15" title=" Esquembri S,Sanz D,Barrera E,et al.Hardware timestamping for an image acquisition system based on FlexRIO and IEEE 1588 v2 standard[J].IEEE Transactions on Nuclear Science,2016,63(1):228-235." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Hardware Timestamping for an Image Acquisition System Based on FlexRIO and IEEE 1588 v2 Standard">
                                        <b>[15]</b>
                                         Esquembri S,Sanz D,Barrera E,et al.Hardware timestamping for an image acquisition system based on FlexRIO and IEEE 1588 v2 standard[J].IEEE Transactions on Nuclear Science,2016,63(1):228-235.
                                    </a>
                                </li>
                                <li id="33">


                                    <a id="bibliography_16" title=" 李文辉,简献忠,肖儿良.变电站实时监控系统中的千兆以太网传输设计[J].电子科技,2018,31(1):16-19,33.Li Wenhui,Jian Xianzhong,Xiao Erliang.Design of gigabit Ethernet transmission in real-time monitoring system of substation[J].Electronic Science and Technology,2018,31(1):16-19,33." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=DZKK201801006&amp;v=MTYzNjFyQ1VSN3FmWnVacEZ5M2tWTHpPSVRmQVpiRzRIOW5Ncm85RllvUUtESDg0dlI0VDZqNTRPM3pxcUJ0R0Y=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZONEl2ZXMzNXJlUkZjWFB4bHhwYz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[16]</b>
                                         李文辉,简献忠,肖儿良.变电站实时监控系统中的千兆以太网传输设计[J].电子科技,2018,31(1):16-19,33.Li Wenhui,Jian Xianzhong,Xiao Erliang.Design of gigabit Ethernet transmission in real-time monitoring system of substation[J].Electronic Science and Technology,2018,31(1):16-19,33.
                                    </a>
                                </li>
                                <li id="35">


                                    <a id="bibliography_17" title=" 陈凯,唐清善,李亚捷,等.基于FPGA的千兆以太网传输实现方案[J].电子科技,2017,30(6):102-104,108.Chen Kai,Tang Qingshan,Li Yajie,et al.Implementation scheme of gigabit Ethernet transmission based on FPGA [J].Electronic Science and Technology,2017,30(6):102-104,108." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=DZKK201706029&amp;v=MDgxMzdCdEdGckNVUjdxZlp1WnBGeTNrVkx6T0lUZkFaYkc0SDliTXFZOUhiWVFLREg4NHZSNFQ2ajU0TzN6cXE=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZONEl2ZXMzNXJlUkZjWFB4bHhwYz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[17]</b>
                                         陈凯,唐清善,李亚捷,等.基于FPGA的千兆以太网传输实现方案[J].电子科技,2017,30(6):102-104,108.Chen Kai,Tang Qingshan,Li Yajie,et al.Implementation scheme of gigabit Ethernet transmission based on FPGA [J].Electronic Science and Technology,2017,30(6):102-104,108.
                                    </a>
                                </li>
                            </ul>
                            <div style='display: none;' class="zqscroller" >
                                <h4 class="">附加材料</h4>
                                <ul></ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            &nbsp;
            <!--此处有一空格符 勿删-->
        </div>

        
    <div class="content">

    <div class="head-tag">   
            <p>
               <b> 网络首发时间: 2018-12-29 14:42</b>
            </p>     
    </div>


        <!--tips start-->
                            <div class="tips">
                    <a href="http://navi.cnki.net/KNavi/JournalDetail?pcode=CJFD&amp;pykm=DZKK" target="_blank">电子科技</a>
                2019,32(11),43-46+57 DOI:10.16180/j.cnki.issn1007-7820.2019.11.009            </div>
        <!--tips end-->
            <div class="top-title">
                <h1 class="title">
                    <span class="vm"><b>基于</b>FPGA<b>的</b>PTP<b>时间同步技术实现</b></span>
                                    </h1>

            </div>
                        <h2>
                                <a href="javascript:;">房晓瑜</a>
                                <a href="javascript:;">王京梅</a>
                                <a href="javascript:;">晏子杰</a>
                                <a href="javascript:;">陈卓</a>
                </h2>
                    <h2>

                    <span>电子科技大学电子科学与工程学院</span>
            </h2>

        
<div class="link">
    <a id="aexport" class="icon icon-output"  onclick="" href="javascript:void(0);"><i></i>导出/参考文献</a>
    
    <span class="shareBoard" onmouseover="$('#sharedet').show();$('#this').addClass('shareBoardCUR')" onmouseout="$('#sharedet').hide();$('#this').removeClass('shareBoardCUR')">
        <a class="icon icon-share" href="#"><i></i>分享<em></em></a>
        <ul class="shareHide" id="sharedet" style="display: none;">
            <li><a title="复制链接" class="copy" onclick="" href="#"><i></i>复制链接</a></li>
            <li><a title="分享到新浪微博" class="xl" onclick="" href="javascript:common.ShareAction('xl');"><i></i>新浪微博</a></li>
            <li>
                <a title="分享到微信" class="wx" onclick="" href="#"><i></i>微信扫一扫</a>
                <div class="qrcode"><img src='' alt='' /></div>
            </li>
        </ul>

    </span>
    
    <a id="RefTrack" title="创建引文跟踪" class="icon icon-track" onclick="" href="javascript:void(0);"> <i></i>创建引文跟踪 </a>
    <a id="ashoucang" title="收藏" class="icon icon-favor" onclick="" href="javascript:void(0);"><i></i>收藏</a>
    <a class="icon icon-print" onclick="window.print();" href="javascript:void(0);"><i></i>打印</a>
    
    <!--版本切换 end-->
</div>
                            <div class="data" id="a_abstract">
                <span class="keys">摘<span style="font-family: 'Times New Roman';">&nbsp;&nbsp;&nbsp;&nbsp;</span>要：</span>
                <p>针对现有PTP时间同步技术实现方案系统复杂、结构冗余以及成本高的问题,文中提出了一种基于FPGA的PTP时间同步技术实现方案。通过在确立主从关系的FPGA系统之间交互四种报文的方式,从系统在数据链路层截取Sync和Delay<sub>r</sub>eq报文的时间戳,并计算主从系统之间的链路延迟和时间偏移量,对本地时钟进行补偿以实现时间同步。文中采用Xilinx公司提供的ChipScope Pro工具做板级验证,抓取主从系统的时间信息,并测试同步精度和成功率。实验结果表明,所设计的系统在时间同步精度上可以达到纳秒级,同步的成功率基本维持在99.99%。</p>
            </div>
                    <div class="data" id="a_keywords">
                <span class="keys">关键词：</span>
                <p>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=PTP&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZONEl2ZXMzNXJlUkZjWFB4bHhwYz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">PTP;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=%E6%97%B6%E9%97%B4%E5%90%8C%E6%AD%A5&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZONEl2ZXMzNXJlUkZjWFB4bHhwYz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">时间同步;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=%E5%BB%B6%E8%BF%9F&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZONEl2ZXMzNXJlUkZjWFB4bHhwYz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">延迟;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=%E5%81%8F%E7%A7%BB%E9%87%8F&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZONEl2ZXMzNXJlUkZjWFB4bHhwYz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">偏移量;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=%E5%90%8C%E6%AD%A5%E7%B2%BE%E5%BA%A6&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZONEl2ZXMzNXJlUkZjWFB4bHhwYz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">同步精度;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=%E6%88%90%E5%8A%9F%E7%8E%87&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZONEl2ZXMzNXJlUkZjWFB4bHhwYz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">成功率;</a>
                </p>
            </div>
        
        <!--brief start-->
        
            <div class="brief">
                    <p>
                            <b>作者简介：</b>
                                                        <span>
                                    房晓瑜(1993-),男,硕士研究生。研究方向:网络通信与图像处理。;
                                </span>
                                <span>
                                    王京梅(1968-),女,副教授。研究方向:电路与系统。;
                                </span>
                    </p>
                                    <p><b>收稿日期：</b>2018-11-27</p>

                    <p>

                            <b>基金：</b>
                                                        <span>中央高校基本科研业务费(ZYGX2016J162);</span>
                    </p>
            </div>
                    <h1><b>Implementation of PTP Time Synchronization Technology Based on FPGA</b></h1>
                    <h2>
                    <span>FANG Xiaoyu</span>
                    <span>WANG Jingmei</span>
                    <span>YAN Zijie</span>
                    <span>CHEN Zhuo</span>
            </h2>
                    <h2>
                    <span>School of Electronic Science and Engineering,University of Electronic Science and Technology of China</span>
            </h2>
                            <div class="data" id="a_abstractEN">
                <span class="keys">Abstract：</span>
                <p>Aiming the problem of complexity, redundant structure and high cost in the implementation scheme of the existing PTP technology, this paper proposed an implementation scheme of PTP time synchronization technology based on FPGA. The timestamps of Sync and Delay<sub>r</sub>eq messages were intercepted in the data link layer by establishing four kinds of messages between systems of FPGA which had the master-slave structure. Then, slave system calculated the link delay and time offset according to timestamps. Finally, the local clock of slave system was compensated to achieve the goal of time synchronization. ChipScope Pro tool provided by Xilinx was used to capture the time information of master and slave system, as well as to test time accuracy and success rate for board level verification in this study. The experimental results showed that the designed system could reach nanosecond accuracy in time synchronization, and the success rate of synchronization was basically maintained at 99.99%.</p>
            </div>
                    <div class="data" id="a_keywordsEN">
                <span class="keys">Keyword：</span>
                <p>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=PTP&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZONEl2ZXMzNXJlUkZjWFB4bHhwYz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">PTP;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=timesynchronization&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZONEl2ZXMzNXJlUkZjWFB4bHhwYz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">timesynchronization;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=delay&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZONEl2ZXMzNXJlUkZjWFB4bHhwYz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">delay;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=offset&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZONEl2ZXMzNXJlUkZjWFB4bHhwYz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">offset;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=synchronizationprecision&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZONEl2ZXMzNXJlUkZjWFB4bHhwYz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">synchronizationprecision;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=success%20rate&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZONEl2ZXMzNXJlUkZjWFB4bHhwYz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">success rate;</a>
                </p>
            </div>
                    <div class="brief">
                
                    <p>
                                            </p>
                                    <p><b>Received：</b> 2018-11-27</p>
                                    <p>
                            <b>Fund：</b>
                                                        <span>The Fundamental Research Funds for the Central Universities(ZYGX2016J162);</span>
                    </p>
            </div>


        <!--brief start-->
                        <div class="p1">
                    <p id="37">精确时间协议(Precision Time Protocol,PTP)又称为IEEE1588协议<citation id="88" type="reference"><link href="3" rel="bibliography" /><link href="5" rel="bibliography" /><sup>[<a class="sup">1</a>,<a class="sup">2</a>]</sup></citation>。此协议最早被提出时主要应用于电力系统等自动控制领域<citation id="84" type="reference"><link href="7" rel="bibliography" /><sup>[<a class="sup">3</a>]</sup></citation>,其理论同步精度可以达到亚微秒级<citation id="85" type="reference"><link href="9" rel="bibliography" /><sup>[<a class="sup">4</a>]</sup></citation>,相比于早期的网络时间协议具有巨大的精度优势<citation id="86" type="reference"><link href="11" rel="bibliography" /><sup>[<a class="sup">5</a>]</sup></citation>。2008年发布的第二版PTP协议新增了报文类型和同步机制,例如支持节点驻留时间测量和链路不对称测量等<citation id="89" type="reference"><link href="13" rel="bibliography" /><link href="15" rel="bibliography" /><sup>[<a class="sup">6</a>,<a class="sup">7</a>]</sup></citation>。在一些支持新版PTP协议的转发节点上(交换机等),同步精度进一步提高到几十ns<citation id="90" type="reference"><link href="17" rel="bibliography" /><link href="19" rel="bibliography" /><sup>[<a class="sup">8</a>,<a class="sup">9</a>]</sup></citation>。相比于目前比较常见的全球定位系统提供的时间同步技术<citation id="87" type="reference"><link href="21" rel="bibliography" /><sup>[<a class="sup">10</a>]</sup></citation>,PTP具有应用灵活、成本低的优势。PTP协议的优良性能使得其迅速发展,被广泛应用于网络通信、工业控制和仪器测量等方面<citation id="91" type="reference"><link href="23" rel="bibliography" /><link href="25" rel="bibliography" /><sup>[<a class="sup">11</a>,<a class="sup">12</a>]</sup></citation>。</p>
                </div>
                <div class="p1">
                    <p id="38">目前主要存在两种PTP时间同步技术方案:软件方案和软硬件结合方案<citation id="93" type="reference"><link href="27" rel="bibliography" /><link href="29" rel="bibliography" /><sup>[<a class="sup">13</a>,<a class="sup">14</a>]</sup></citation>。软件方案同步精度只能达到微秒级,软硬件结合方案同步精度虽可达到亚微秒级,但是其成本相对增加,系统也更为复杂。两种方案的本质区别是时间戳的获取方式不同。在一些应用场景下,系统的主从关系是确定的,如多点图像远程同步触发采集<citation id="92" type="reference"><link href="31" rel="bibliography" /><sup>[<a class="sup">15</a>]</sup></citation>、工业流水线高精度切割操作等。此时如果采用PTP时间同步技术作为同步控制算法,主系统只需要维护一个高可靠性的时间源,不需要执行复杂的最优主时钟选择算法。主从系统之间可以通过组网技术,实现多点远程精确同步控制的目的。这种情况下,上述两种方案均显得结构冗余、系统复杂、成本高昂。</p>
                </div>
                <div class="p1">
                    <p id="39">鉴于与上述应用场景类似的场景非常普遍,文中提出了基于FPGA的纯硬件平台方案实现PTP时间同步技术来对PTP协议进行简化处理。FPGA同时承担时间戳截取与MAC层报文封装的功能<citation id="94" type="reference"><link href="33" rel="bibliography" /><link href="35" rel="bibliography" /><sup>[<a class="sup">16</a>,<a class="sup">17</a>]</sup></citation>,可在确定主从关系的系统上运行时间同步算法。</p>
                </div>
                <h3 id="40" name="40" class="anchor-tag"><b>1 系统总体设计和同步原理</b></h3>
                <h4 class="anchor-tag" id="41" name="41"><b>1.1 系统总体设计</b></h4>
                <div class="p1">
                    <p id="42">本设计以一主两从结构为例(一主多从结构类似)进行阐述。主系统主要包含的功能模块有:报文发送模块、报文接收模块、CRC32校验模块和本地时钟模块。从系统主要包含的功能模块与主系统基本相同,并在此基础上增加了偏移量计算模块,这些功能模块均在FPGA器件上综合实现。系统详细框图如图1所示。</p>
                </div>
                <div class="area_img" id="43">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/DZKK201911010_043.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZONEl2ZXMzNXJlUkZjWFB4bHhwYz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图1 系统详细框图" src="Detail/GetImg?filename=images/DZKK201911010_043.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZONEl2ZXMzNXJlUkZjWFB4bHhwYz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图1 系统详细框图  <a class="btn-zoomin" href="Detail/GetImg?filename=images/DZKK201911010_043.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZONEl2ZXMzNXJlUkZjWFB4bHhwYz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit">Figure 1. Block diagram of detailed system</p>

                </div>
                <h4 class="anchor-tag" id="44" name="44"><b>1.2 系统同步原理</b></h4>
                <div class="p1">
                    <p id="45">主系统和两个从系统之间通过交换机连接并进行组网,主从系统之间的交互过程如图2所示。主系统每间隔一定的时钟周期(周期可调)向从系统发送Sync报文,启动同步算法。</p>
                </div>
                <div class="p1">
                    <p id="46">设计中采用双步模式,所以主系统发送完Sync报文之后,将Sync报文发送的时间戳<i>T</i><sub>1</sub>封装到Follow_up报文中发送给从系统。从系统接收到Sync报文,记录报文到达的时间戳<i>T</i><sub>2</sub>,接收到Follow_up报文后,记录下报文携带的时间戳信息<i>T</i><sub>1</sub>。间隔一段时间后,从系统向主系统发送Delay_req报文,并记录报文发送的时间戳<i>T</i><sub>3</sub>。主系统接收到Delay_req报文后,记录下报文到达的时间戳<i>T</i><sub>4</sub>,并将时间信息填充到Delay_resp报文的时间域字段,发送给从系统,从系统接收到Delay_resp报文,保存时间戳信息<i>T</i><sub>4</sub>。至此,一次时间同步的报文交互过程完成,从系统依次获得了<i>T</i><sub>1</sub>、<i>T</i><sub>2</sub>、<i>T</i><sub>3</sub>和<i>T</i><sub>4</sub>的时间戳信息。</p>
                </div>
                <div class="area_img" id="47">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/DZKK201911010_047.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZONEl2ZXMzNXJlUkZjWFB4bHhwYz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图2 时间同步原理图" src="Detail/GetImg?filename=images/DZKK201911010_047.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZONEl2ZXMzNXJlUkZjWFB4bHhwYz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图2 时间同步原理图  <a class="btn-zoomin" href="Detail/GetImg?filename=images/DZKK201911010_047.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZONEl2ZXMzNXJlUkZjWFB4bHhwYz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit">Figure 2. Schematic diagram of time synchronization</p>

                </div>
                <div class="p1">
                    <p id="48">由图2可知,当从系统获得<i>T</i><sub>1</sub>和<i>T</i><sub>2</sub>时间戳时,可以得到</p>
                </div>
                <div class="p1">
                    <p id="49"><i>T</i><sub>2</sub>-<i>T</i><sub>1</sub>=Offset+Delay      (1)</p>
                </div>
                <div class="p1">
                    <p id="50">式(1)中,Offset为偏移量,Delay为链路延迟。</p>
                </div>
                <div class="p1">
                    <p id="51">当从系统获得<i>T</i><sub>3</sub>和<i>T</i><sub>4</sub>时间戳时,可以得到</p>
                </div>
                <div class="p1">
                    <p id="52"><i>T</i><sub>4</sub>-<i>T</i><sub>3</sub>=Delay-Offset      (2)</p>
                </div>
                <div class="p1">
                    <p id="53">由式(1)和式(2)可以推导得到Delay和Offset的表达式</p>
                </div>
                <div class="p1">
                    <p id="54"><mathml id="82"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mtext>D</mtext><mtext>e</mtext><mtext>l</mtext><mtext>a</mtext><mtext>y</mtext><mo>=</mo><mfrac><mrow><mo stretchy="false">(</mo><mi>Τ</mi><msub><mrow></mrow><mn>2</mn></msub><mo>-</mo><mi>Τ</mi><msub><mrow></mrow><mn>1</mn></msub><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mi>Τ</mi><msub><mrow></mrow><mn>4</mn></msub><mo>-</mo><mi>Τ</mi><msub><mrow></mrow><mn>3</mn></msub><mo stretchy="false">)</mo></mrow><mn>2</mn></mfrac></mrow></math></mathml>      (3)</p>
                </div>
                <div class="p1">
                    <p id="55"><mathml id="83"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mtext>Ο</mtext><mtext>f</mtext><mtext>f</mtext><mtext>s</mtext><mtext>e</mtext><mtext>t</mtext><mo>=</mo><mfrac><mrow><mo stretchy="false">(</mo><mi>Τ</mi><msub><mrow></mrow><mn>2</mn></msub><mo>-</mo><mi>Τ</mi><msub><mrow></mrow><mn>1</mn></msub><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mi>Τ</mi><msub><mrow></mrow><mn>4</mn></msub><mo>-</mo><mi>Τ</mi><msub><mrow></mrow><mn>3</mn></msub><mo stretchy="false">)</mo></mrow><mn>2</mn></mfrac></mrow></math></mathml>      (4)</p>
                </div>
                <div class="p1">
                    <p id="56">从系统根据计算得到的偏移量Offset对本地时钟进行补偿,补偿之后,整个主从系统处于同一时钟域,时间同步完成。</p>
                </div>
                <h3 id="57" name="57" class="anchor-tag"><b>2 系统同步过程</b></h3>
                <h4 class="anchor-tag" id="58" name="58"><b>2.1 主系统同步过程</b></h4>
                <div class="p1">
                    <p id="59">主系统发送Sync、Follow_up和Delay_resp3种报文,接收Delay_req一种报文,通过协议规定的目的MAC地址、源MAC地址、类型和报文头等字段对报文进行封装和解封。PTP协议中对PTP报文封装的形式主要有3种:PTP over UDP over IPv4、PTP over UDP over IPv6和PTP over IEEE802.3/Ethernet。本设计中采用硬件方案规避了上层操作系统带来的抖动、不对称性对同步精度产生的影响,只涉及到数据链路层和物理层,因此采用PTP over IEEE802.3/Ethernet的报文封装格式,如图3所示。</p>
                </div>
                <div class="area_img" id="95">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/DZKK201911010_09500.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZONEl2ZXMzNXJlUkZjWFB4bHhwYz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图3 PTP报文封装格式" src="Detail/GetImg?filename=images/DZKK201911010_09500.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZONEl2ZXMzNXJlUkZjWFB4bHhwYz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图3 PTP报文封装格式  <a class="btn-zoomin" href="Detail/GetImg?filename=images/DZKK201911010_09500.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZONEl2ZXMzNXJlUkZjWFB4bHhwYz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit">Figure 3.Format of PTP messages</p>

                </div>
                <div class="p1">
                    <p id="63">主系统设计中最主要的部分为发送模块和接收模块,发送和接收报文的过程是顺序执行且具有周期性的,应考虑采用状态机的设计思路。图4所示为主系统发送状态机的简单示意图,实际过程中的状态跳转条件远比图示的复杂。</p>
                </div>
                <div class="area_img" id="64">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/DZKK201911010_064.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZONEl2ZXMzNXJlUkZjWFB4bHhwYz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图4 主系统发送状态机" src="Detail/GetImg?filename=images/DZKK201911010_064.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZONEl2ZXMzNXJlUkZjWFB4bHhwYz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图4 主系统发送状态机  <a class="btn-zoomin" href="Detail/GetImg?filename=images/DZKK201911010_064.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZONEl2ZXMzNXJlUkZjWFB4bHhwYz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit">Figure 4. Sending state machine of the master system</p>

                </div>
                <div class="p1">
                    <p id="65">主系统在一个同步周期开始时以广播的形式发送Sync报文和Follow_up报文,然后根据主系统中接收到Delay_req报文的反馈信号以及从系统的MAC地址等信息,向指定的从系统发送Delay_resp报文。为了保证主系统的稳定可靠,防止接收不到Delay_req报文时,发送状态机停止在Wait状态的情况出现,故在Wait状态添加一个计数器,其只在Wait状态计数,其他状态清零。当计数器记到一个阈值还未清零的情况下,状态从Wait跳转到Idle,保证同步算法的稳定运行。</p>
                </div>
                <div class="p1">
                    <p id="66">主系统的接收模块较为简单,只针对Delay_req一种报文进行识别,整个接收过程由状态机控制,状态机的示意图如图5所示。状态机的每个状态分别对接收到的报文各个字段进行识别,一旦发现接收错误,即跳转到Idle状态。在Rx_finish状态对接收到的CRC校验值和计算得到的校验值做对比以决定是否产生反馈信号。</p>
                </div>
                <div class="area_img" id="67">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/DZKK201911010_067.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZONEl2ZXMzNXJlUkZjWFB4bHhwYz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图5 主系统接收状态机" src="Detail/GetImg?filename=images/DZKK201911010_067.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZONEl2ZXMzNXJlUkZjWFB4bHhwYz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图5 主系统接收状态机  <a class="btn-zoomin" href="Detail/GetImg?filename=images/DZKK201911010_067.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZONEl2ZXMzNXJlUkZjWFB4bHhwYz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit">Figure 5. Receiving state machine of the master system</p>

                </div>
                <h4 class="anchor-tag" id="68" name="68"><b>2.2 从系统同步过程</b></h4>
                <div class="p1">
                    <p id="69">从系统与主系统类似,同样包含发送模块和接收模块。两者的不同之处在于接收模块对3种报文字段识别,而发送模块只发送一种报文,在此不再对发送模块和接收模块的状态机做赘述。从系统包含一个偏移量计算模块,对一个同步周期内获得的<i>T</i><sub>1</sub>、<i>T</i><sub>2</sub>、<i>T</i><sub>3</sub>和<i>T</i><sub>4</sub>时间戳做加法、减法以及除法运算。当从系统正确接收到Delay_resp报文时,将相应的标志位置为高电平,作为计算模块的使能信号。计算得到的偏移量对从系统的本地时钟做修正,并设置同步完成标志以方便后续调试。</p>
                </div>
                <h3 id="70" name="70" class="anchor-tag"><b>3 结果验证</b></h3>
                <div class="p1">
                    <p id="71">本设计通过Xilinx公司提供的一款在线调试平台ChipScope Pro捕获FPGA芯片内部的信号来验证设计的正确性,并通过触发信号的触发时间间隔验证系统的稳定性。主从系统基于Xilinx Artix7系列的FPGA设计完成,实验平台如图6所示。将一主两从系统采用一个顶层文件封装,在一个拥有多个网口外设的硬件平台上进行验证。从图6中可以看到,主系统采用晶振1产生的时钟作为本地时钟,从系统1和从系统2分别采用晶振2和晶振3产生的时钟作为本地时钟,所以三者之间的时钟源是相互独立的,但是时钟频率相同,均为125 MHz。</p>
                </div>
                <div class="area_img" id="72">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/DZKK201911010_072.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZONEl2ZXMzNXJlUkZjWFB4bHhwYz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图6 实验平台" src="Detail/GetImg?filename=images/DZKK201911010_072.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZONEl2ZXMzNXJlUkZjWFB4bHhwYz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图6 实验平台  <a class="btn-zoomin" href="Detail/GetImg?filename=images/DZKK201911010_072.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZONEl2ZXMzNXJlUkZjWFB4bHhwYz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit">Figure 6. Experimental platform</p>

                </div>
                <div class="p1">
                    <p id="73">因为本设计中是采用一主两从的结构,主系统向从系统发送Delay_resp报文的时间点不同,所以两个从系统同步完成的时间不同。图7所示为从系统1与主系统之间完成时间同步;图8所示为从系统2与主系统之间完成时间同步,两个触发信号之间的间隔约为一个Delay_resp报文的接收时间。当两个从系统均向主系统做时间对齐后,整个系统处于同一时钟域。</p>
                </div>
                <div class="area_img" id="74">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/DZKK201911010_074.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZONEl2ZXMzNXJlUkZjWFB4bHhwYz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图7 从系统1时间同步" src="Detail/GetImg?filename=images/DZKK201911010_074.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZONEl2ZXMzNXJlUkZjWFB4bHhwYz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图7 从系统1时间同步  <a class="btn-zoomin" href="Detail/GetImg?filename=images/DZKK201911010_074.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZONEl2ZXMzNXJlUkZjWFB4bHhwYz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit">Figure 7. Time synchronization of slave system I</p>

                </div>
                <div class="area_img" id="75">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/DZKK201911010_075.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZONEl2ZXMzNXJlUkZjWFB4bHhwYz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图8 从系统2时间同步" src="Detail/GetImg?filename=images/DZKK201911010_075.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZONEl2ZXMzNXJlUkZjWFB4bHhwYz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图8 从系统2时间同步  <a class="btn-zoomin" href="Detail/GetImg?filename=images/DZKK201911010_075.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZONEl2ZXMzNXJlUkZjWFB4bHhwYz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit">Figure 8. Time synchronization of slave system II</p>

                </div>
                <div class="p1">
                    <p id="76">设计中使用80 bit的计数器来体现本地时间,随着本地时钟频率做加一运算。为了使同步现象比较明显,文中将主从系统的计数器设置为不同的初始值。</p>
                </div>
                <div class="p1">
                    <p id="77">从图8中可以看到同步之后三者之间的计数值误差仅为1,而千兆以太网的时钟频率为125 MHz,即同步误差为8 ns,甚至更小。图示中的flag_d3信号是偏移量补偿使能信号,每当flag_d3为高电平时,即完成一次对从系统的时间补偿。通过将ChipScope Pro的信号触发方式设置为连续触发,统计在一段时间内捕获flag_d3信号为高电平的次数,可以得到时间同步的成功率,测试系统的稳定性。</p>
                </div>
                <div class="area_img" id="78">
                    <p class="img_tit"><b>表</b>1 <b>时间同步成功率</b> <a class="downexcel" onclick="DownLoadReportExcel(this)">导出到EXCEL</a></p>
                    <p class="img_tit">Table 1. Success rate of time synchronization</p>
                    <p class="img_note"></p>
                    <table id="78" border="1"><tr><td><br />序号</td><td>同步次数/次</td><td>捕获次数/次</td><td>成功率</td></tr><tr><td><br />1</td><td>20 000</td><td>19 998</td><td>99.990 0%</td></tr><tr><td><br />2</td><td>40 000</td><td>39 997</td><td>99.992 5%</td></tr><tr><td><br />3</td><td>60 000</td><td>59 995</td><td>99.991 7%</td></tr><tr><td><br />4</td><td>80 000</td><td>79 991</td><td>99.988 8%</td></tr></table>
                    <form name="form" action="/kxreader/Detail/DownloadReportExcel" method="POST" style="display:inline">
                        <input type="hidden" name="hidTable" value="" />
                        <input type="hidden" name="hidFileName" value="" />
                    </form>
                    <p class="img_note"></p>
                    <p class="img_note"></p>
                </div>
                <div class="p1">
                    <p id="79">表1所示为统计结果,从表中可以看出,时间同步的成功率很高,基本维持在99.99%,主从系统之间同步算法运行稳定。</p>
                </div>
                <h3 id="80" name="80" class="anchor-tag"><b>4 结束语</b></h3>
                <div class="p1">
                    <p id="81">文中详细描述了一种基于FPGA的PTP时间同步技术实现方案,并且通过在线调试工具在硬件平台上验证了系统的稳定性、时间同步精度以及方案的可行性,为确定主从关系的系统提供了一种简单可靠的时间同步设计。本设计只完成了PTP协议的基本功能,后续可以考虑将更多功能集成到性能日益强大的FPGA内部,例如非对称链路矫正的硬件实现、透明时钟的转发延迟测量等,其实现方案还需要进一步探索验证。</p>
                </div>

        <!--brief end-->
        
        <!--conten left  end-->
        <!--增强附件-->
        

        <!--reference start-->
            <div class="reference anchor-tag" id="a_bibliography">
                    <h3>参考文献</h3>
                                        <p id="3">
                            <a id="bibliography_1" target="_blank" href="http://scholar.cnki.net/result.aspx?q=IEEE standard for a precision clock synchronization protocol for networked measurement and control systems">

                                <b>[1]</b> IEEE.IEEE Std 1588-2002,IEEE standard for a precision clock synchronization protocol for networked measurement and control system[S].New York:IEEE,2002.
                            </a>
                        </p>
                        <p id="5">
                            <a id="bibliography_2" target="_blank" href="http://scholar.cnki.net/result.aspx?q=IEEE Standard for a Precision Clock Synchronization Protocol for Networked Measurement and Control Systems">

                                <b>[2]</b> IEEE.IEEE Std 1588-2008,IEEE standard for a precision clock synchronization protocol for networked measurement and control system[S].New York:IEEE,2008.
                            </a>
                        </p>
                        <p id="7">
                            <a id="bibliography_3" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Time synchronization for transmission substations using GPS and IEEE 1588">

                                <b>[3]</b> Crossley P A,Guo H,Ma Z.Time synchronization for transmission substations using GPS and IEEE 1588[J].CSEE Journal of Power and Energy Systems,2016,2(3):91-99.
                            </a>
                        </p>
                        <p id="9">
                            <a id="bibliography_4" target="_blank" href="http://scholar.cnki.net/result.aspx?q=FPGA based nodes for sub-microsecond synchronization of cyber-physical production systems on high availability ring networks">

                                <b>[4]</b> Astarloa A,Moreira N,Bidarte U,et al.FPGA based nodes for sub-microsecond synchronization of cyber-physical production systems on high availability ring networks[C].Mexico City:International Conference on ReConFigurable Computing and FPGAs(ReConFig),2015.
                            </a>
                        </p>
                        <p id="11">
                            <a id="bibliography_5" target="_blank" href="http://scholar.cnki.net/result.aspx?q=A study of the merits of precision time protocol (IEEE-1588) across high-speed data networks">

                                <b>[5]</b> Oliver D,Otto A J,Neufeld N.A study of the merits of precision time protocol (IEEE-1588) across high-speed data networks[M].Meyrin:CERN,2015.
                            </a>
                        </p>
                        <p id="13">
                            <a id="bibliography_6" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Automatic capture of the network delay components">

                                <b>[6]</b> Le Pallec M,Bui D T.Automatic capture of the network delay components:U.S.,patent application,9413625[P].2016-08-09.
                            </a>
                        </p>
                        <p id="15">
                            <a id="bibliography_7" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Transmitting residence time information in a network">

                                <b>[7]</b> Ruffini S,Gray E W,Kini S,et al.Transmitting residence time information in a network:U.S.,Patent Application,15/524540[P].2017-11-09.
                            </a>
                        </p>
                        <p id="17">
                            <a id="bibliography_8" target="_blank" href="http://scholar.cnki.net/result.aspx?q=The design and implementation of IEEE 1588v2 clock synchronization system by generating hardware timestamps in MAC layer">

                                <b>[8]</b> Dong M,Qiu Z,Pan W,et al.The design and implementation of IEEE 1588v2 clock synchronization system by generating hardware timestamps in MAC layer[C].Colmar:International Conference on Computer,Information and Telecommunication Systems (CITS),2018.
                            </a>
                        </p>
                        <p id="19">
                            <a id="bibliography_9" target="_blank" href="http://scholar.cnki.net/result.aspx?q=The accuracy of IEEE 1588 time synchronization protocol and its improvement">

                                <b>[9]</b> Fubin P,Yubo Y,Lei G,et al.The accuracy of IEEE 1588 time synchronization protocol and its improvement[C].Qingdao:12<sup>th</sup> IEEE International Conference on Electronic Measurement &amp; Instruments (ICEMI),2015.
                            </a>
                        </p>
                        <p id="21">
                            <a id="bibliography_10" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=GLGX201501032&amp;v=MDkxMTBacEZ5M2tWTHpPSWlITWRyRzRIOVRNcm85R1pvUUtESDg0dlI0VDZqNTRPM3pxcUJ0R0ZyQ1VSN3FmWnU=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZONEl2ZXMzNXJlUkZjWFB4bHhwYz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[10]</b> 郑恭明,沈媛媛.基于FPGA的GPS同步时钟系统设计[J].桂林理工大学学报,2015,35(1):198-201.Zheng Gongming,Shen Yuanyuan.Design of GPS synchronous clock system based on FPGA[J].Journal of Guilin University of Technology,2015,35(1):198-201.
                            </a>
                        </p>
                        <p id="23">
                            <a id="bibliography_11" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JZCK201504015&amp;v=MjAwNTM0OUVZWVFLREg4NHZSNFQ2ajU0TzN6cXFCdEdGckNVUjdxZlp1WnBGeTNrVkx6T0x6ZklaYkc0SDlUTXE=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZONEl2ZXMzNXJlUkZjWFB4bHhwYz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[11]</b> 魏建新.IEEE1588时钟同步技术在飞行试验遥测网络系统中的应用[J].计算机测量与控制,2015,23(4):1115-1117.Wei Jianxin.Application of IEEE1588 clock synchronization technology in network system of flight test telemetry[J].Computer Measurement and Control,2015,23(4):1115-1117.
                            </a>
                        </p>
                        <p id="25">
                            <a id="bibliography_12" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Optimizing large media networks for highly accurate time transfer via PTP">

                                <b>[12]</b> Kero N,Kernen T,Muller T,et al.Optimizing large media networks for highly accurate time transfer via PTP[J].SMPTE Motion Imaging Journal,2016,125(2):30-44.
                            </a>
                        </p>
                        <p id="27">
                            <a id="bibliography_13" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JYRJ201711023&amp;v=MDI2NDF6VFpaTEc0SDliTnJvOUhaNFFLREg4NHZSNFQ2ajU0TzN6cXFCdEdGckNVUjdxZlp1WnBGeTNrVkx6T0w=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZONEl2ZXMzNXJlUkZjWFB4bHhwYz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[13]</b> 杜慧琦,刘玥,刘博,等.IEEE1588v2时钟同步技术在战术信息系统中的应用[J].计算机应用与软件,2017,34(11):125-129.Du Huiqi,Liu Yue,Liu Bo,et al.Application of IEEE1588v2 clock synchronization technology in tactical information system[J].Computer Applications and Software,2017,34(11):125-129.
                            </a>
                        </p>
                        <p id="29">
                            <a id="bibliography_14" target="_blank" href="http://scholar.cnki.net/result.aspx?q=The Implementation of IEEE 1588 Clock Synchronization Protocol Based on FPGA">

                                <b>[14]</b> Yin H,Fu P,Qiao J,et al.The implementation of IEEE 1588 clock synchronization protocol based on FPGA[C].Houston:IEEE International Instrumentation and Measurement Technology Conference (I<sup>2</sup>MTC),2018.
                            </a>
                        </p>
                        <p id="31">
                            <a id="bibliography_15" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Hardware Timestamping for an Image Acquisition System Based on FlexRIO and IEEE 1588 v2 Standard">

                                <b>[15]</b> Esquembri S,Sanz D,Barrera E,et al.Hardware timestamping for an image acquisition system based on FlexRIO and IEEE 1588 v2 standard[J].IEEE Transactions on Nuclear Science,2016,63(1):228-235.
                            </a>
                        </p>
                        <p id="33">
                            <a id="bibliography_16" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=DZKK201801006&amp;v=MTc4Mjk5bk1ybzlGWW9RS0RIODR2UjRUNmo1NE8zenFxQnRHRnJDVVI3cWZadVpwRnkza1ZMek9JVGZBWmJHNEg=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZONEl2ZXMzNXJlUkZjWFB4bHhwYz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[16]</b> 李文辉,简献忠,肖儿良.变电站实时监控系统中的千兆以太网传输设计[J].电子科技,2018,31(1):16-19,33.Li Wenhui,Jian Xianzhong,Xiao Erliang.Design of gigabit Ethernet transmission in real-time monitoring system of substation[J].Electronic Science and Technology,2018,31(1):16-19,33.
                            </a>
                        </p>
                        <p id="35">
                            <a id="bibliography_17" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=DZKK201706029&amp;v=MDY2NTh6T0lUZkFaYkc0SDliTXFZOUhiWVFLREg4NHZSNFQ2ajU0TzN6cXFCdEdGckNVUjdxZlp1WnBGeTNrVkw=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZONEl2ZXMzNXJlUkZjWFB4bHhwYz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[17]</b> 陈凯,唐清善,李亚捷,等.基于FPGA的千兆以太网传输实现方案[J].电子科技,2017,30(6):102-104,108.Chen Kai,Tang Qingshan,Li Yajie,et al.Implementation scheme of gigabit Ethernet transmission based on FPGA [J].Electronic Science and Technology,2017,30(6):102-104,108.
                            </a>
                        </p>
            </div>
        <!--reference end-->
        <!--footnote start-->
        <!--footnote end-->



    </div>

        <input id="fileid" type="hidden" value="DZKK201911010" />
        <input id="dpi" type="hidden" value="299" />
    </div>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?6e967eb120601ea41b9d312166416aa6";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
</script>


    


<input id="hid_uid" name="hid_uid" type="hidden" value="WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZONEl2ZXMzNXJlUkZjWFB4bHhwYz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
<input id="hid_kLogin_headerUrl" name="hid_kLogin_headerUrl" type="hidden" value="/KLogin/Request/GetKHeader.ashx%3Fcallback%3D%3F" />
<input id="hid_kLogin_footerUrl" name="hid_kLogin_footerUrl" type="hidden" value="/KLogin/Request/GetKFooter.ashx%3Fcallback%3D%3F" />
<div class="btn-link" style="display: none"><a target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=DZKK201911010&amp;v=MTc4NDM0dlI0VDZqNTRPM3pxcUJ0R0ZyQ1VSN3FmWnVacEZ5M2tWTHpQSVRmQVpiRzRIOWpOcm85RVpJUUtESDg=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZONEl2ZXMzNXJlUkZjWFB4bHhwYz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">知网节</a></div>
<div class="popflow" id="popupTips" style="display: none;">
    <div class="popflowArr"></div>
    <div class="popflowCot">
        <div class="hd"><a href="javascript:void(0);" onclick="$('#popupTips').hide();$('#popupmsg').html('')" class="close">X</a></div>
        <div class="bd">
            <p class="mes" id="popupmsg" name="popupmsg"></p>
          
        </div>
    </div>
</div>
<input type="hidden" id="myexport" value="//kns.cnki.net" />

<input type="hidden" id="KPCAPIPATH" value="//ishufang.cnki.net" />
<input type="hidden" id="CitedTimes" value="1" />
<div class="link" id="GLSearch" style="display: none;">
    <i class="icon-trangle"></i>
    <div class="inner">
        <a class="icon" id="copytext">复制</a>
        <a class="icon" target="_blank" onclick="searchCRFD(this)">工具书搜索</a>
    </div>
</div>




<input id="hidVirtualPath" name="hidVirtualPath" type="hidden" value="/kxreader" />
<script src="/kxreader/bundles/detail?v=P0ea_aWnQfx5aXr8bS4u3GGmKX_ORbqAf_1HJ_4Trvg1"></script>

<script src="/kxreader/Scripts/layer.min.js" type="text/javascript"></script>

<div id="footerBox" class="rootw footer">
</div>
<script>
    if (typeof FlushLogin == 'function') {
        FlushLogin();
    }
    modifyEcpHeader(true);
</script>

<!--图片放大功能 start-->
<script src="/kxreader/bundles/imagebox?v=W4phPu9SNkGcuPeJclikuVE3PpRyIW_gnfjm_19nynI1"></script>

<script type="text/javascript">
    $(function () {
        var j = $.noConflict();
        j(function () {
            j(".zoom-in,.btn-zoomin").imgbox({
                'alignment': 'center',
                'allowMultiple': false,
                'overlayShow': true
            });
        })
    });
</script>
<!--图片放大功能 end-->
<div class="fixedbar">
    <div class="backtop hiddenV" id="backtop">
        <a id="backTopSide" href="javascript:scroll(0,0);" title=""></a>
    </div>
</div>
<script type="text/javascript" src="/kxreader/Scripts/MathJax-2.6-latest/MathJax.js?config=MML_HTMLorMML-full"></script>


    <link href="/kxreader/Content/css/LeftDetail?v=vAscMyvIPP9NePnbGPkqJ0A5tHOvnzl65tGuRDsf9xg1" rel="stylesheet"/>

</body>
</html>

