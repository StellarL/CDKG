<!DOCTYPE html>
<html>
<head>
    <title>全文阅读--XML全文阅读--中国知网</title>
    <link rel="icon" href="/kxreader/favicon.ico" />
    <link rel="shortcut Icon" href="/kxreader/favicon.ico" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="keywords" content="文献 XML KBASE CNKI 中国知网" />
    <meta name="description" content="XML文献检索" />
    <link href="/kxreader/Content/css/detail?v=qX2z2KjRAEyQiNfAbKtl7dLnsqFoQ5Jdw3TZfDf0n1k1" rel="stylesheet"/>

    <script type="text/javascript">
        var APPPATH = '/kxreader';
    </script>
</head>

<body>
    
<script type="text/javascript" src="//login.cnki.net/TopLogin/api/loginapi/get?type=top&amp;localCSS=&amp;returnurl=%2f%2fkns.cnki.net%2f%2fKXReader%2fDetail%3fTIMESTAMP%3d637132364067530000%26DBCODE%3dCJFD%26TABLEName%3dCJFDLAST2019%26FileName%3dJSJK201908002%26RESULT%3d1%26SIGN%3dQt%252bn2UxNFU5Vcqfr9jUj8zihPAc%253d"></script>

<div id="headerBox" class="header">
    <div class="topbar">
        <div class="textalign">
            <a href="/kxreader/Detail?dbcode=CJFD&amp;filename=JSJK201908002&amp;align=md">
                <i class="icon-cen active" title="居中对齐"></i>
            </a>
            <a href="/kxreader/Detail?dbcode=CJFD&amp;filename=JSJK201908002&amp;align=lt">
                <i class="icon-left " title="左对齐"></i>
            </a>
        </div>
        <h6 class="free-tip"><i class="icon"></i>HTML阅读开放试用阶段，欢迎体验！</h6>
    </div>
</div>

    



<div class="btn-link" style="display: none"><a target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JSJK201908002&amp;v=MDczMjhIOWpNcDQ5RlpvUUtESDg0dlI0VDZqNTRPM3pxcUJ0R0ZyQ1VSTE9lWmVSbUZ5N2xVYnpPTHo3QlpiRzQ=&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDY2UXI4RUJreUIrY05aSWZBQVJmWT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">知网节</a></div>

    <div class="main">

        

    <div class="sidebar-a">
        <!--sidebar start-->
        <div class="sidenav">
            <div class="arrow"><span></span></div>
            <!--sidebar_list start-->
            <dl class="sidenav-list">
                    <dt class="tit">目录结构</dt>
                            <dd class="guide">
                                    <p><a href="#41" data-title="&lt;b&gt;1 引言&lt;/b&gt; "><b>1 引言</b></a><i></i></p>
                                                            </dd>
                            <dd class="guide">
                                    <p><a href="#45" data-title="&lt;b&gt;2 相关工作介绍&lt;/b&gt; "><b>2 相关工作介绍</b></a><i></i></p>
                                                                    <ul class="contentbox">
                                                <li><a href="#46" data-title="&lt;b&gt;2.1 研究背景与二进制翻译介绍&lt;/b&gt;"><b>2.1 研究背景与二进制翻译介绍</b></a></li>
                                                <li><a href="#53" data-title="&lt;b&gt;2.2 TCG技术介绍&lt;/b&gt;"><b>2.2 TCG技术介绍</b></a></li>
                                    </ul>
                            </dd>
                            <dd class="guide">
                                    <p><a href="#61" data-title="&lt;b&gt;3 代码膨胀率及问题分析&lt;/b&gt; "><b>3 代码膨胀率及问题分析</b></a><i></i></p>
                                                                    <ul class="contentbox">
                                                <li><a href="#62" data-title="&lt;b&gt;3.1 代码生成指令分析&lt;/b&gt;"><b>3.1 代码生成指令分析</b></a></li>
                                                <li><a href="#68" data-title="&lt;b&gt;3.2 代码膨胀率分析&lt;/b&gt;"><b>3.2 代码膨胀率分析</b></a></li>
                                    </ul>
                            </dd>
                            <dd class="guide">
                                    <p><a href="#77" data-title="&lt;b&gt;4 条件跳转指令后端生成优化设计&lt;/b&gt; "><b>4 条件跳转指令后端生成优化设计</b></a><i></i></p>
                                                                    <ul class="contentbox">
                                                <li><a href="#78" data-title="&lt;b&gt;4.1 优化指令的选取与分析&lt;/b&gt;"><b>4.1 优化指令的选取与分析</b></a></li>
                                                <li><a href="#89" data-title="&lt;b&gt;4.2 指令预处理与归约操作消除冗余指令&lt;/b&gt;"><b>4.2 指令预处理与归约操作消除冗余指令</b></a></li>
                                                <li><a href="#102" data-title="&lt;b&gt;4.3 条件跳转指令优化算法的实现&lt;/b&gt;"><b>4.3 条件跳转指令优化算法的实现</b></a></li>
                                    </ul>
                            </dd>
                            <dd class="guide">
                                    <p><a href="#176" data-title="&lt;b&gt;5 实验结果&lt;/b&gt; "><b>5 实验结果</b></a><i></i></p>
                                                                    <ul class="contentbox">
                                                <li><a href="#181" data-title="&lt;b&gt;5.1 实验环境及测试用例简介&lt;/b&gt;"><b>5.1 实验环境及测试用例简介</b></a></li>
                                                <li><a href="#187" data-title="&lt;b&gt;5.2 生成代码膨胀率检测&lt;/b&gt;"><b>5.2 生成代码膨胀率检测</b></a></li>
                                                <li><a href="#197" data-title="&lt;b&gt;5.3 翻译性能测试&lt;/b&gt;"><b>5.3 翻译性能测试</b></a></li>
                                    </ul>
                            </dd>
                            <dd class="guide">
                                    <p><a href="#201" data-title="&lt;b&gt;6 结束语&lt;/b&gt; "><b>6 结束语</b></a><i></i></p>
                                                            </dd>
                            <dd class="guide">
                                    <p><a href="#" data-title="文内图表 ">文内图表</a><i></i></p>
                                                                    <ul class="contentbox">
                                                <li><a href="#50" data-title="图1 QEMU系统结构">图1 QEMU系统结构</a></li>
                                                <li><a href="#55" data-title="图2 TCG工作流程">图2 TCG工作流程</a></li>
                                                <li><a href="#59" data-title="图3 TCG目标代码生成">图3 TCG目标代码生成</a></li>
                                                <li><a href="#65" data-title="&lt;b&gt;表1 生成指令对照表&lt;/b&gt;"><b>表1 生成指令对照表</b></a></li>
                                                <li><a href="#72" data-title="图4 条件跳转指令代码分析">图4 条件跳转指令代码分析</a></li>
                                                <li><a href="#80" data-title="&lt;b&gt;表2 测试集指令执行频率统计&lt;/b&gt;"><b>表2 测试集指令执行频率统计</b></a></li>
                                                <li><a href="#101" data-title="图5 代码预处理模块">图5 代码预处理模块</a></li>
                                                <li><a href="#105" data-title="&lt;b&gt;表3 指令格式与功能介绍&lt;/b&gt;"><b>表3 指令格式与功能介绍</b></a></li>
                                                <li><a href="#115" data-title="图6 代码翻译流程">图6 代码翻译流程</a></li>
                                                <li><a href="#134" data-title="图7 优化前后生成代码对比">图7 优化前后生成代码对比</a></li>
                                                <li><a href="#183" data-title="&lt;b&gt;表4 指令格式与功能介绍&lt;/b&gt;"><b>表4 指令格式与功能介绍</b></a></li>
                                                <li><a href="#185" data-title="&lt;b&gt;表5 SPEC CPU2006测试用例简介&lt;/b&gt;"><b>表5 SPEC CPU2006测试用例简介</b></a></li>
                                                <li><a href="#189" data-title="&lt;b&gt;表6 NPB测试用例简介&lt;/b&gt;"><b>表6 NPB测试用例简介</b></a></li>
                                                <li><a href="#191" data-title="图8 代码膨胀率对比图">图8 代码膨胀率对比图</a></li>
                                                <li><a href="#194" data-title="图9 相关性比较图">图9 相关性比较图</a></li>
                                                <li><a href="#199" data-title="图10 SPEC CPU 2006程序加速比">图10 SPEC CPU 2006程序加速比</a></li>
                                    </ul>
                            </dd>
                                    <dd class="guide">
                                        <h6>
                                            <p><a href="#a_bibliography">参考文献</a> </p>
                                        </h6>
                                    </dd>

            </dl>
        </div>
        <!--sidebar end-->
        &nbsp;
        <!--此处有一空格符 勿删-->
    </div>

                <div class="sidebar-b three-collumn" style="width:0;">
            <div class="refer" style="width: 0;">
                <div class="arrow off" title="参考文献"><span></span></div>
                <div class="js-scrollbox" >
                    
                    <div class="subbox active">
                        <h4>
                            <span class="tit">参考文献</span>
                            <a class="close" href="javascript:void(0)">x</a>
                        </h4>
                        <div class="side-scroller">
                            <ul class="refer-list">
                                <li id="232">


                                    <a id="bibliography_1" title=" Altman E R, Kaeli D, Sheffer Y.Welcome to the opportunities of binary translation[J].Computer, 2000, 33 (3) :40-45." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Welcome to the opportunities of binary translation">
                                        <b>[1]</b>
                                         Altman E R, Kaeli D, Sheffer Y.Welcome to the opportunities of binary translation[J].Computer, 2000, 33 (3) :40-45.
                                    </a>
                                </li>
                                <li id="234">


                                    <a id="bibliography_2" title=" Zhong X, Li J, Chen J P, et al.Methods and systems for performing a binary translation:WIPO Patent WO/2014/043886[P].2014-03-27." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Methods and systems for performing a binary translation">
                                        <b>[2]</b>
                                         Zhong X, Li J, Chen J P, et al.Methods and systems for performing a binary translation:WIPO Patent WO/2014/043886[P].2014-03-27.
                                    </a>
                                </li>
                                <li id="236">


                                    <a id="bibliography_3" title=" Cifuentes C N, Malhotra V M.Binary translation:static, dynamic, retargetable?[C]//Proc of International Conference on Software Maintenance, 2002:340-349." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Binary translation:static,dynamic,retargetable?">
                                        <b>[3]</b>
                                         Cifuentes C N, Malhotra V M.Binary translation:static, dynamic, retargetable?[C]//Proc of International Conference on Software Maintenance, 2002:340-349.
                                    </a>
                                </li>
                                <li id="238">


                                    <a id="bibliography_4" title=" Federico A D, Agosta G.A jump-target identification method for multi-architecture static binary translation[C]//Proc of International Conference on Compliers, Architectures, and Sythesis of Embedded Systems, 2016:Article No.17." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=A jump-target identification method for multi-architecture static binary translation">
                                        <b>[4]</b>
                                         Federico A D, Agosta G.A jump-target identification method for multi-architecture static binary translation[C]//Proc of International Conference on Compliers, Architectures, and Sythesis of Embedded Systems, 2016:Article No.17.
                                    </a>
                                </li>
                                <li id="240">


                                    <a id="bibliography_5" title=" Li Jian-hui, Ma Xiang-ning, Zhu Chuan-qi.Dynamic binary translation and optimization[J].Journal of Computer Research &amp;amp; Development, 2007, 44 (1) :161-168. (in Chinese) " target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JFYZ200701022&amp;v=MjkxOTE0TzN6cXFCdEdGckNVUkxPZVplUm1GeTdsVWJ6T0x5dlNkTEc0SHRiTXJvOUhab1FLREg4NHZSNFQ2ajU=&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDY2UXI4RUJreUIrY05aSWZBQVJmWT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[5]</b>
                                         Li Jian-hui, Ma Xiang-ning, Zhu Chuan-qi.Dynamic binary translation and optimization[J].Journal of Computer Research &amp;amp; Development, 2007, 44 (1) :161-168. (in Chinese) 
                                    </a>
                                </li>
                                <li id="242">


                                    <a id="bibliography_6" title=" Bellard F.QEMU, A fast and portable dynamic translator[C]//Proc of the Annual Conference on Usenix Technical, 2005:41." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=QEMU,A fast and portable dynamic translator">
                                        <b>[6]</b>
                                         Bellard F.QEMU, A fast and portable dynamic translator[C]//Proc of the Annual Conference on Usenix Technical, 2005:41.
                                    </a>
                                </li>
                                <li id="244">


                                    <a id="bibliography_7" title=" Bartholomew D.QEMU:A multihost, multitarget emulator[M].Houston:Belltown Media, 2006." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=QEMU:A multihost,multitarget emulator">
                                        <b>[7]</b>
                                         Bartholomew D.QEMU:A multihost, multitarget emulator[M].Houston:Belltown Media, 2006.
                                    </a>
                                </li>
                                <li id="246">


                                    <a id="bibliography_8" title=" Lu Shuai-bing, Pang Jian-min, Shan Zheng, et al.Cross-platform static binary translation system based on QEMU [J].Journal of Zhejiang University (Engineering Edition) , 2016, 50 (1) :158-165. (in Chinese) " target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Cross-platform static binary translation system based on QEMU">
                                        <b>[8]</b>
                                         Lu Shuai-bing, Pang Jian-min, Shan Zheng, et al.Cross-platform static binary translation system based on QEMU [J].Journal of Zhejiang University (Engineering Edition) , 2016, 50 (1) :158-165. (in Chinese) 
                                    </a>
                                </li>
                                <li id="248">


                                    <a id="bibliography_9" title=" Liang Y, Shao Y H, Yang G W, et al.Register allocation for QEMU dynamic binary translation systems[J].International Journal of Hybrid Information Technology, 2015, 8 (2) :199-210." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Register allocation for QEMU dynamic binary translation systems">
                                        <b>[9]</b>
                                         Liang Y, Shao Y H, Yang G W, et al.Register allocation for QEMU dynamic binary translation systems[J].International Journal of Hybrid Information Technology, 2015, 8 (2) :199-210.
                                    </a>
                                </li>
                                <li id="250">


                                    <a id="bibliography_10" title=" Lu S, Pang J, Pan Y, et al.A MPI-friendly efficient static binary translator based on QEMU[C]//Proc of International Conference on Computer Science and Mechanical Automation, 2015:36-40." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=A MPI-Friendly Efficient Static Binary Translator Based on QEMU">
                                        <b>[10]</b>
                                         Lu S, Pang J, Pan Y, et al.A MPI-friendly efficient static binary translator based on QEMU[C]//Proc of International Conference on Computer Science and Mechanical Automation, 2015:36-40.
                                    </a>
                                </li>
                                <li id="252">


                                    <a id="bibliography_11" title=" Zhang Xi-chao, Guo Xiang-ying, Zhao Lei.Study on TCG dynamic binary translation technique[J].Computer Applications and Software, 2013, 30 (11) :34-37. (in Chinese) " target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JYRJ201311011&amp;v=MTA5NjFyQ1VSTE9lWmVSbUZ5N2xVYnpPTHpUWlpMRzRIOUxOcm85RVpZUUtESDg0dlI0VDZqNTRPM3pxcUJ0R0Y=&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDY2UXI4RUJreUIrY05aSWZBQVJmWT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[11]</b>
                                         Zhang Xi-chao, Guo Xiang-ying, Zhao Lei.Study on TCG dynamic binary translation technique[J].Computer Applications and Software, 2013, 30 (11) :34-37. (in Chinese) 
                                    </a>
                                </li>
                                <li id="254">


                                    <a id="bibliography_12" title=" Jeery A.Using the LLVM compiler infrastructure for optimised, asynchronous dynamic translation in QEMU[J].Adelaide:University of Adelaide, 2009." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Using the LLVM compiler infrastructure for optimised,asynchronous dynamic translation in QEMU">
                                        <b>[12]</b>
                                         Jeery A.Using the LLVM compiler infrastructure for optimised, asynchronous dynamic translation in QEMU[J].Adelaide:University of Adelaide, 2009.
                                    </a>
                                </li>
                                <li id="256">


                                    <a id="bibliography_13" title=" Zhang Shi-yi.Research and implementation of hot code detection and dynamic optimization model based on QEMU [D].Chengdu:University of Electronic Science and Technology of China, 2013. (in Chinese) " target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Research and implementation of hot code detection and dynamic optimization model based on QEMU">
                                        <b>[13]</b>
                                         Zhang Shi-yi.Research and implementation of hot code detection and dynamic optimization model based on QEMU [D].Chengdu:University of Electronic Science and Technology of China, 2013. (in Chinese) 
                                    </a>
                                </li>
                                <li id="258">


                                    <a id="bibliography_14" title=" http://www.spec.org/cpu2006/." target="_blank"
                                       href="">
                                        <b>[14]</b>
                                         http://www.spec.org/cpu2006/.
                                    </a>
                                </li>
                                <li id="260">


                                    <a id="bibliography_15" title=" http://www.nas.nasa.gov/publications/npb.html." target="_blank"
                                       href="">
                                        <b>[15]</b>
                                         http://www.nas.nasa.gov/publications/npb.html.
                                    </a>
                                </li>
                                <li id="262">


                                    <a id="bibliography_5" >
                                        <b>[5]</b>
                                     李剑慧, 马湘宁, 朱传琪.动态二进制翻译与优化技术研究[J].计算机研究与发展, 2007, 44 (1) :161-168.</a>
                                </li>
                                <li id="264">


                                    <a id="bibliography_8" title=" 卢帅兵, 庞建民, 单征, 等.基于QEMU的跨平台静态二进制翻译系统[J].浙江大学学报 (工学版) , 2016, 50 (1) :158-165." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=ZDZC201601023&amp;v=MDY0OThRS0RIODR2UjRUNmo1NE8zenFxQnRHRnJDVVJMT2VaZVJtRnk3bFViek9QeW5SYmJHNEg5Zk1ybzlIWjQ=&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDY2UXI4RUJreUIrY05aSWZBQVJmWT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[8]</b>
                                         卢帅兵, 庞建民, 单征, 等.基于QEMU的跨平台静态二进制翻译系统[J].浙江大学学报 (工学版) , 2016, 50 (1) :158-165.
                                    </a>
                                </li>
                                <li id="266">


                                    <a id="bibliography_11" >
                                        <b>[11]</b>
                                     张西超, 郭向英, 赵雷.TCG动态二进制翻译技术研究[J].计算机应用与软件, 2013, 30 (11) :34-37.</a>
                                </li>
                                <li id="268">


                                    <a id="bibliography_13" title=" 张世宜.基于QEMU的热点代码探测与动态优化模型的研究与实现[D].成都:电子科技大学, 2013." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CMFD&amp;filename=1013331147.nh&amp;v=MzA0ODBWRjI2SGJDN0g5RElxSkViUElRS0RIODR2UjRUNmo1NE8zenFxQnRHRnJDVVJMT2VaZVJtRnk3bFViek8=&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDY2UXI4RUJreUIrY05aSWZBQVJmWT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[13]</b>
                                         张世宜.基于QEMU的热点代码探测与动态优化模型的研究与实现[D].成都:电子科技大学, 2013.
                                    </a>
                                </li>
                            </ul>
                            <div style='display: none;' class="zqscroller" >
                                <h4 class="">附加材料</h4>
                                <ul></ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            &nbsp;
            <!--此处有一空格符 勿删-->
        </div>

        
    <div class="content">



        <!--tips start-->
                            <div class="tips">
                    <a href="http://navi.cnki.net/KNavi/JournalDetail?pcode=CJFD&amp;pykm=JSJK" target="_blank">计算机工程与科学</a>
                2019,41(08),1343-1352 DOI:10.3969/j.issn.1007-130X.2019.08.002            </div>
        <!--tips end-->
            <div class="top-title">
                <h1 class="title">
                    <span class="vm"><b>基于TCG技术的二进制翻译条件转移指令优化研究</b></span>
                                    </h1>

            </div>
                        <h2>
                                <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=au&amp;skey=%E5%BC%A0%E5%AE%B6%E8%B1%AA&amp;code=38999076&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDY2UXI4RUJreUIrY05aSWZBQVJmWT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">张家豪</a>
                                <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=au&amp;skey=%E5%8D%95%E5%BE%81&amp;code=20437679&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDY2UXI4RUJreUIrY05aSWZBQVJmWT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">单征</a>
                                <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=au&amp;skey=%E5%B2%B3%E5%B3%B0&amp;code=21138539&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDY2UXI4RUJreUIrY05aSWZBQVJmWT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">岳峰</a>
                                <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=au&amp;skey=%E5%82%85%E7%AB%8B%E5%9B%BD&amp;code=29138491&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDY2UXI4RUJreUIrY05aSWZBQVJmWT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">傅立国</a>
                                <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=au&amp;skey=%E7%8E%8B%E5%86%9B&amp;code=20613916&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDY2UXI4RUJreUIrY05aSWZBQVJmWT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">王军</a>
                                <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=au&amp;skey=%E6%9D%8E%E6%98%8E%E4%BA%AE&amp;code=29537024&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDY2UXI4RUJreUIrY05aSWZBQVJmWT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">李明亮</a>
                </h2>
                    <h2>
                    <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=in&amp;skey=%E6%95%B0%E5%AD%A6%E5%B7%A5%E7%A8%8B%E4%B8%8E%E5%85%88%E8%BF%9B%E8%AE%A1%E7%AE%97%E5%9B%BD%E5%AE%B6%E9%87%8D%E7%82%B9%E5%AE%9E%E9%AA%8C%E5%AE%A4&amp;code=0199248&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDY2UXI4RUJreUIrY05aSWZBQVJmWT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">数学工程与先进计算国家重点实验室</a>
            </h2>

        
<div class="link">
    <a id="aexport" class="icon icon-output"  onclick="" href="javascript:void(0);"><i></i>导出/参考文献</a>
    
    <span class="shareBoard" onmouseover="$('#sharedet').show();$('#this').addClass('shareBoardCUR')" onmouseout="$('#sharedet').hide();$('#this').removeClass('shareBoardCUR')">
        <a class="icon icon-share" href="#"><i></i>分享<em></em></a>
        <ul class="shareHide" id="sharedet" style="display: none;">
            <li><a title="复制链接" class="copy" onclick="" href="#"><i></i>复制链接</a></li>
            <li><a title="分享到新浪微博" class="xl" onclick="" href="javascript:common.ShareAction('xl');"><i></i>新浪微博</a></li>
            <li>
                <a title="分享到微信" class="wx" onclick="" href="#"><i></i>微信扫一扫</a>
                <div class="qrcode"><img src='' alt='' /></div>
            </li>
        </ul>

    </span>
    
    <a id="RefTrack" title="创建引文跟踪" class="icon icon-track" onclick="" href="javascript:void(0);"> <i></i>创建引文跟踪 </a>
    <a id="ashoucang" title="收藏" class="icon icon-favor" onclick="" href="javascript:void(0);"><i></i>收藏</a>
    <a class="icon icon-print" onclick="window.print();" href="javascript:void(0);"><i></i>打印</a>
    
    <!--版本切换 end-->
</div>
                            <div class="data" id="a_abstract">
                <span class="keys">摘<span style="font-family: 'Times New Roman';">&nbsp;&nbsp;&nbsp;&nbsp;</span>要：</span>
                <p>在二进制翻译中引入TCG中间表示技术可以实现多目标平台之间的程序移植, 同时可以更加方便地引入新型平台, 解决新平台对主流平台的兼容性问题。然而由于原有的中间表示在翻译过程中影响了代码的关联度, 生成的后端代码中存在较多冗余指令, 影响翻译程序的执行效率。分析了指令优化可行性, 针对条件跳转指令进行优化, 通过指令预处理对中间表示进行改进, 实现中间表示到后端代码生成由一对多翻译模式到多对多翻译模式的转变, 采用指令归约技术, 针对条件跳转指令的2种模式CMP-JX型与TEST-JX型, 分别设计相应的优化翻译算法, 并在开源二进制平台QEMU上实现。基于NPB-3.3和SPEC CPU 2006测试集进行了测试, 与以前的翻译模式进行对比, 优化后的代码膨胀率平均减少了14.62%, 翻译程序运行速度提升了17.23%, 验证了该优化方法的有效性。</p>
            </div>
                    <div class="data" id="a_keywords">
                <span class="keys">关键词：</span>
                <p>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=%E4%BA%8C%E8%BF%9B%E5%88%B6%E7%BF%BB%E8%AF%91&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDY2UXI4RUJreUIrY05aSWZBQVJmWT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">二进制翻译;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=TCG%E4%B8%AD%E9%97%B4%E8%A1%A8%E7%A4%BA&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDY2UXI4RUJreUIrY05aSWZBQVJmWT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">TCG中间表示;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=%E6%9D%A1%E4%BB%B6%E8%B7%B3%E8%BD%AC&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDY2UXI4RUJreUIrY05aSWZBQVJmWT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">条件跳转;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=%E4%BB%A3%E7%A0%81%E9%A2%84%E5%A4%84%E7%90%86&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDY2UXI4RUJreUIrY05aSWZBQVJmWT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">代码预处理;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=%E6%8C%87%E4%BB%A4%E5%BD%92%E7%BA%A6&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDY2UXI4RUJreUIrY05aSWZBQVJmWT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">指令归约;</a>
                </p>
            </div>
        
        <!--brief start-->
        
            <div class="brief">
                    <p>
                            <b>作者简介：</b>
                                                        <span>
                                    张家豪 (1991-) , 男, 山东淄博人, 硕士, 研究方向为计算机体系结构。E-mail:Jiahao_zhang@yeah.net通信地址:450001河南省郑州市信息工程大学数学工程与先进计算国家重点实验室;
                                </span>
                                <span>
                                    单征 (1977-) , 男, 辽宁沈阳人, 博士, 教授, 研究方向为计算机体系结构。E-mail:zzzhengming@163.com通信地址:450001河南省郑州市信息工程大学数学工程与先进计算国家重点实验室;
                                </span>
                                <span>
                                    岳峰 (1985-) , 男, 山西长治人, 博士, 讲师, 研究方向为计算机体系结构。E-mail:Yue_feng123@163.com通信地址:450001河南省郑州市信息工程大学数学工程与先进计算国家重点实验室;
                                </span>
                                <span>
                                    傅立国 (1989-) , 男, 山东沂水人, 博士, 研究方向为计算机体系结构。E-mail:flgwongeog@126.com通信地址:450001河南省郑州市信息工程大学数学工程与先进计算国家重点实验室;
                                </span>
                                <span>
                                    王军 (1992-) , 男, 安徽亳州人, 博士生, 研究方向为计算机体系结构。E-mail:Erick_wang@126.com通信地址:450001河南省郑州市信息工程大学数学工程与先进计算国家重点实验室;
                                </span>
                                <span>
                                    李明亮 (1991-) , 男, 山东滕州人, 博士生, 研究方向为计算机体系结构。E-mail:Lml22345@163.com通信地址:450001河南省郑州市信息工程大学数学工程与先进计算国家重点实验室;
                                </span>
                    </p>
                                    <p><b>收稿日期：</b>2019-01-15</p>

            </div>
                    <h1><b>Optimization of binary translation conditional transfer instructions based on TCG technology</b></h1>
                    <h2>
                    <span>ZHANG Jia-hao</span>
                    <span>SHAN Zheng</span>
                    <span>YUE Feng</span>
                    <span>FU Li-guo</span>
                    <span>WANG Jun</span>
                    <span>LI Ming-liang</span>
            </h2>
                    <h2>
                    <span>State Key Laboratory of Mathematical Engineering and Advanced Computing</span>
            </h2>
                            <div class="data" id="a_abstractEN">
                <span class="keys">Abstract：</span>
                <p>The application of TCG intermediate representation technology in binary translation can realize the migration of programs between multiple target platforms. In addition, it makes the introduction of new platforms more conveniently and ensure the compatibility between new platforms and mainstream platforms. However, due to a lack of consideration for the association of code in the translation process, the traditional intermediate representation generates back-end codes with many redundant instructions which affect the execution efficiency of the translation program. We firstly analyze the feasibility of instruction optimization and optimize conditional jump instructions. Secondly, we improve intermediate representation via instruction preprocessing, and implement the many-to-many translation model instead of one-to-many translation model to realize the transformation from intermediate representation to back-end code generation. We adopt the instruction reduction technique to design corresponding optimized translation algorithms for the two modes (CMP-JX and TEST-JX) of conditional jump instructions, and realize them on the open source binary platform QEMU. Experiments on the NPB-3.3 and SPEC CPU 2006 test sets show that the code expansion rate is reduced by an average of 14.62% and the running speed of translation programs is improved by 17.23% in comparison with the existing translation modes, which verifies the effectiveness of the proposed method.</p>
            </div>
                    <div class="data" id="a_keywordsEN">
                <span class="keys">Keyword：</span>
                <p>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=binary%20translation&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDY2UXI4RUJreUIrY05aSWZBQVJmWT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">binary translation;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=TCG%20intermediate%20representation&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDY2UXI4RUJreUIrY05aSWZBQVJmWT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">TCG intermediate representation;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=conditional%20jump%20instruction&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDY2UXI4RUJreUIrY05aSWZBQVJmWT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">conditional jump instruction;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=code%20preprocessing&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDY2UXI4RUJreUIrY05aSWZBQVJmWT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">code preprocessing;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=instruction%20optimization&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDY2UXI4RUJreUIrY05aSWZBQVJmWT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">instruction optimization;</a>
                </p>
            </div>
                    <div class="brief">
                
                    <p>
                            <b>Author：</b>
                                                        <span>
                                    ZHANG Jia-hao, born in 1991, MS, his research interest includes computer architecture.Address:State Key Laboratory of Mathematical Engineering and Advanced Computing, Information Engineering University, Zhengzhou 450001, Henan, P.R.China;
                                </span>
                                <span>
                                    SHAN Zheng, born in 1977, PhD, professor, his research interest includes computer architecture.Address:State Key Laboratory of Mathematical Engineering and Advanced Computing, Information Engineering University, Zhengzhou 450001, Henan, P.R.China;
                                </span>
                                <span>
                                    YUE Feng, born in 1985, PhD, lecturer, his research interest includes computer architecture.Address:State Key Laboratory of Mathematical Engineering and Advanced Computing, Information Engineering University, Zhengzhou 450001, Henan, P.R.China;
                                </span>
                                <span>
                                    FU Li-guo, born in 1989, PhD, his research interest includes computer architecture.Address:State Key Laboratory of Mathematical Engineering and Advanced Computing, Information Engineering University, Zhengzhou 450001, Henan, P.R.China;
                                </span>
                                <span>
                                    WANG Jun, born in 1992, PhD candidate, his research interest includes computer architecture.Address:State Key Laboratory of Mathematical Engineering and Advanced Computing, Information Engineering University, Zhengzhou 450001, Henan, P.R.China;
                                </span>
                                <span>
                                    LI Ming-liang, born in 1991, PhD candidate, his research interest includes computer architecture.Address:State Key Laboratory of Mathematical Engineering and Advanced Computing, Information Engineering University, Zhengzhou 450001, Henan, P.R.China;
                                </span>
                    </p>
                                    <p><b>Received：</b> 2019-01-15</p>
                            </div>


        <!--brief start-->
                        <h3 id="41" name="41" class="anchor-tag"><b>1 引言</b></h3>
                <div class="p1">
                    <p id="42">二进制翻译技术是将源指令集的指令序列通过代码翻译, 生成其他指令集下的指令序列。它是解决软件移植问题的重要手段, 在遗产代码移植、程序优化、系统安全等方面都有着重要的意义<citation id="270" type="reference"><link href="232" rel="bibliography" /><sup>[<a class="sup">1</a>]</sup></citation>。</p>
                </div>
                <div class="p1">
                    <p id="43">为了实现多平台到多平台的翻译, 许多二进制翻译平台引入中间表示, 即将不同的体系结构下生成的可执行文件反编译成统一的约定格式, 之后再将其翻译至不同的目标平台, 实现翻译的过程。然而在翻译中, 一条指令往往需要多条代码进行解释, 这就导致了生成代码质量不高且存在较多冗余代码。因此, 提高后端代码执行效率成为了二进制翻译发展的关键研究方向之一。</p>
                </div>
                <div class="p1">
                    <p id="44">为解决上述问题, 本文分析了二进制翻译器QEMU (Quck EMUlator) 中TCG (Ting Code Generator) 中间表示在生成代码中存在冗余的情况, 针对平台处理器相关特性, 在结合指令集特点的基础上设计了指令归约合并算法, 针对翻译中的条件跳转指令进行优化, 实现了程序翻译代码由一对多映射到多对多映射的改变, 消除冗余指令。测试结果说明, 翻译程序加速比具有明显提升, 翻译效率得到了提高。</p>
                </div>
                <h3 id="45" name="45" class="anchor-tag"><b>2 相关工作介绍</b></h3>
                <h4 class="anchor-tag" id="46" name="46"><b>2.1 研究背景与二进制翻译介绍</b></h4>
                <div class="p1">
                    <p id="47">近年来, 随着我国信息化水平的日益提高, 信息安全形势引起了越来越多的关注。但是, 目前流行的常用软件大多是基于x86体系架构设计的, 这些软件往往并不能直接在非x86平台的国产处理器上直接执行, 而且因技术封锁、专利版权、开发成本以及遗产代码等因素的限制, 这些软件也很难在源码层面上实现到国产处理器的移植<citation id="271" type="reference"><link href="234" rel="bibliography" /><sup>[<a class="sup">2</a>]</sup></citation>。因此, 如何高效地使用新型硬件平台, 尽可能地降低软件的开发成本, 扩大软件的适用范围, 并最大程度地发挥新型平台的性能优势, 实现新型计算机的软硬件兼容, 是摆在我们面前的首要问题。</p>
                </div>
                <div class="p1">
                    <p id="48">采用二进制翻译技术可以有效解决上述问题。二进制翻译<citation id="272" type="reference"><link href="236" rel="bibliography" /><sup>[<a class="sup">3</a>]</sup></citation>是一种在不需要源码的前提下能够实现跨架构软件移植的技术, 其为新型微处理器兼容其它不同架构上的软件提供了可能<citation id="273" type="reference"><link href="238" rel="bibliography" /><sup>[<a class="sup">4</a>]</sup></citation>。目前, 二进制翻译已经成为新型CPU支撑已有应用程序的核心技术<citation id="274" type="reference"><link href="240" rel="bibliography" /><link href="262" rel="bibliography" /><sup>[<a class="sup">5</a>,<a class="sup">5</a>]</sup></citation>。</p>
                </div>
                <div class="p1">
                    <p id="49">QEMU是Bellard等<citation id="275" type="reference"><link href="242" rel="bibliography" /><sup>[<a class="sup">6</a>]</sup></citation>编写的开源可变源和目标的高效跨平台的动态二进制翻译系统。QEMU在用户模式下支持多源平台和多目标平台。QEMU翻译过程如图1所示。</p>
                </div>
                <div class="area_img" id="50">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JSJK201908002_050.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDY2UXI4RUJreUIrY05aSWZBQVJmWT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图1 QEMU系统结构" src="Detail/GetImg?filename=images/JSJK201908002_050.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDY2UXI4RUJreUIrY05aSWZBQVJmWT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图1 QEMU系统结构  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JSJK201908002_050.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDY2UXI4RUJreUIrY05aSWZBQVJmWT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit">Figure 1 System structure of QEMU</p>

                </div>
                <div class="p1">
                    <p id="51">目前, QEMU对部分主流平台的翻译已经达到了较好的执行效率;同时, 由于QEMU代码开源性、翻译高效性以及可变源和目标特性等优势, 使得其成为了热门的研究动态二进制翻译工具之一<citation id="276" type="reference"><link href="244" rel="bibliography" /><sup>[<a class="sup">7</a>]</sup></citation>。</p>
                </div>
                <div class="p1">
                    <p id="52">课题组在QEMU基础上, 结合申威SW平台相关特性, 设计了针对SW平台的TCG后端代码生成翻译模块, 在SW平台上实现了基本的二进制翻译功能<citation id="277" type="reference"><link href="246" rel="bibliography" /><link href="264" rel="bibliography" /><sup>[<a class="sup">8</a>,<a class="sup">8</a>]</sup></citation>。</p>
                </div>
                <h4 class="anchor-tag" id="53" name="53"><b>2.2 TCG技术介绍</b></h4>
                <div class="p1">
                    <p id="54">QEMU采用指令集无关中间表示TCG<citation id="278" type="reference"><link href="248" rel="bibliography" /><sup>[<a class="sup">9</a>]</sup></citation>, 可先将x86、Arm、Alpha、PowerPC等平台的指令序列先翻译为TCG中间表示, 然后再翻译为目标指令集。TCG技术屏蔽了不同平台之间的差异, 是QEMU跨平台性的关键技术<citation id="279" type="reference"><link href="250" rel="bibliography" /><sup>[<a class="sup">10</a>]</sup></citation>。TCG的核心特点是引入了中间表示层, 即先将待翻译平台程序转换为TCG中间表示, 之后将中间表示翻译成目标平台的可执行代码<citation id="280" type="reference"><link href="252" rel="bibliography" /><link href="266" rel="bibliography" /><sup>[<a class="sup">11</a>,<a class="sup">11</a>]</sup></citation>。图2给出了其具体工作流程。</p>
                </div>
                <div class="area_img" id="55">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JSJK201908002_055.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDY2UXI4RUJreUIrY05aSWZBQVJmWT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图2 TCG工作流程" src="Detail/GetImg?filename=images/JSJK201908002_055.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDY2UXI4RUJreUIrY05aSWZBQVJmWT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图2 TCG工作流程  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JSJK201908002_055.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDY2UXI4RUJreUIrY05aSWZBQVJmWT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit">Figure 2 Workflow diagram of TCG</p>

                </div>
                <div class="p1">
                    <p id="56">翻译程序时, 首先会根据待翻译基本块的起始地址在缓存中查找此基本块是否被翻译。已经翻译过的基本块会存入QEMU设定的哈希表中, 用以提高查找效率, 如果查找命中, 则直接运行, 反之则进入基本块翻译过程<citation id="281" type="reference"><link href="254" rel="bibliography" /><sup>[<a class="sup">12</a>]</sup></citation>。根据基本块中的指令生成TCG中间表示, 之后将中间表示通过翻译器转换为目标机器码, 存入缓存备用, 并根据基本块跳转地址转入下一基本块进行翻译操作<citation id="282" type="reference"><link href="256" rel="bibliography" /><link href="268" rel="bibliography" /><sup>[<a class="sup">13</a>,<a class="sup">13</a>]</sup></citation>。</p>
                </div>
                <div class="p1">
                    <p id="57">引入TCG的优点有:</p>
                </div>
                <div class="p1">
                    <p id="58"> (1) 更快捷实现多对多平台的翻译, 便于维护。传统的翻译模式, 如果要实现不同平台之间的翻译, 需要在2个平台之间制定相应的翻译规则。而引入TCG中间表示后, 则只需要针对中间表示编写相对应的后端代码生成规则, 便可实现多源平台到目标平台的翻译功能, 可以节省工作量, 降低翻译复杂程度。</p>
                </div>
                <div class="area_img" id="59">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JSJK201908002_059.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDY2UXI4RUJreUIrY05aSWZBQVJmWT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图3 TCG目标代码生成" src="Detail/GetImg?filename=images/JSJK201908002_059.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDY2UXI4RUJreUIrY05aSWZBQVJmWT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图3 TCG目标代码生成  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JSJK201908002_059.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDY2UXI4RUJreUIrY05aSWZBQVJmWT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit">Figure 3 TCG target code generation</p>

                </div>
                <div class="p1">
                    <p id="60"> (2) 保证翻译的正确性。中间表示使用微指令操作对源指令进行解释, 每条微指令近似于原子操作, 对于源程序中的每一条指令, 微指令可以将其功能操作分步详细解释, 保证每条指令都可正确翻译到目标平台上, 确保翻译准确无误。</p>
                </div>
                <h3 id="61" name="61" class="anchor-tag"><b>3 代码膨胀率及问题分析</b></h3>
                <h4 class="anchor-tag" id="62" name="62"><b>3.1 代码生成指令分析</b></h4>
                <div class="p1">
                    <p id="63">目前QEMU的TCG技术已经非常成熟, 经过课题组修改后的SQEMU (Static Quick EMUlator) 翻译器已能够进行多源平台的翻译。但是, 在实验测试中代码膨胀率过高的问题一直存在, 已经成为制约程序移植的关键问题。为详细分析上述问题, 在SW平台上使用SQEMU翻译器对SPEC CPU 2006<citation id="283" type="reference"><link href="258" rel="bibliography" /><sup>[<a class="sup">14</a>]</sup></citation>与NPB3.3<citation id="284" type="reference"><link href="260" rel="bibliography" /><sup>[<a class="sup">15</a>]</sup></citation>测试用例进行翻译, 同时, 将测试用例的源码在SW平台上进行编译。使用反汇编技术统计这2种方法产生的汇编指令, 分别对指令出现的次数和种类进行记录。表1是对生成指令的信息展示。</p>
                </div>
                <div class="p1">
                    <p id="64">对表1中数据进行分析可以发现, 在生成指令的总数方面, 通过SQEMU翻译器翻译后生成的指令数目要远远大于本地编译产生的指令数目, 平均代码膨胀率约为5.91。但是, 在使用到的指令种类方面, SQEMU翻译器翻译过程中使用到的指令种类数要远远少于本地编译所使用的种类数。</p>
                </div>
                <div class="area_img" id="65">
                    <p class="img_tit"><b>表1 生成指令对照表</b> <a class="downexcel" onclick="DownLoadReportExcel(this)">导出到EXCEL</a></p>
                    <p class="img_tit"><b>Table 1 Instruction generation table</b></p>
                    <p class="img_note"></p>
                    <table id="65" border="1"><tr><td><br />测试实例</td><td colspan="2"><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mfrac><mrow><mtext>S</mtext><mtext>W</mtext><mspace width="0.25em" /><mtext>编</mtext><mtext>译</mtext></mrow><mrow><mtext>种</mtext><mtext>类</mtext><mtext> </mtext><mtext>总</mtext><mtext>数</mtext></mrow></mfrac></mrow></math></td><td colspan="2"><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mfrac><mrow><mtext>S</mtext><mtext>Q</mtext><mtext>E</mtext><mtext>Μ</mtext><mtext>U</mtext><mtext>翻</mtext><mtext>译</mtext></mrow><mrow><mtext>种</mtext><mtext>类</mtext><mtext> </mtext><mtext>总</mtext><mtext>数</mtext></mrow></mfrac></mrow></math></td><td>代码膨胀率</td></tr><tr><td>BT</td><td>65</td><td>12 660</td><td>31</td><td>91 656</td><td>7.24</td></tr><tr><td><br />CG</td><td>62</td><td>3 288</td><td>30</td><td>18 766</td><td>5.71</td></tr><tr><td><br />DC</td><td>74</td><td>8 532</td><td>33</td><td>44 770</td><td>5.36</td></tr><tr><td><br />EP</td><td>56</td><td>1 972</td><td>30</td><td>7 802</td><td>3.96</td></tr><tr><td><br />FT</td><td>67</td><td>4 672</td><td>32</td><td>24 063</td><td>5.15</td></tr><tr><td><br />IS</td><td>52</td><td>1 132</td><td>27</td><td>4 679</td><td>4.13</td></tr><tr><td><br />LU</td><td>71</td><td>13 996</td><td>32</td><td>87 139</td><td>6.22</td></tr><tr><td><br />MG</td><td>71</td><td>6 732</td><td>32</td><td>34 759</td><td>5.16</td></tr><tr><td><br />SP</td><td>70</td><td>12 584</td><td>31</td><td>79 792</td><td>6.34</td></tr><tr><td><br />UA</td><td>86</td><td>21 496</td><td>34</td><td>109 818</td><td>5.11</td></tr><tr><td><br />汇总</td><td>104</td><td>86 254</td><td>37</td><td>509 641</td><td>5.91</td></tr></table>
                    <form name="form" action="/kxreader/Detail/DownloadReportExcel" method="POST" style="display:inline">
                        <input type="hidden" name="hidTable" value="" />
                        <input type="hidden" name="hidFileName" value="" />
                    </form>
                    <p class="img_note"></p>
                    <p class="img_note"></p>
                </div>
                <div class="p1">
                    <p id="67">根据指令种类汇总来看, SQEMU翻译器在翻译源程序时, 仅仅使用了37种指令, 而SW本地指令集的种类数目超过150种。翻译程序使用有限种类的指令去实现全部指令的功能, 必然会提升代码膨胀率, 影响翻译效率。</p>
                </div>
                <h4 class="anchor-tag" id="68" name="68"><b>3.2 代码膨胀率分析</b></h4>
                <div class="p1">
                    <p id="69">我们以x86指令到SW指令翻译为例分析代码膨胀的原因, 其流程如图3所示。</p>
                </div>
                <div class="p1">
                    <p id="70">源x86指令是1条间接寻址指令, 在将其翻译到中间表示时, 首先将rax寄存器内容读入本地寄存器$9, 将立即数2读入$10;将$9进行移位后把rbp值读入$10, 两者相加后读入立即数0xfc0到$10, 继续进行相加操作, 使用$10模拟寄存器edx, 最后将$9所在地址的值存入$10。整个过程中使用了大量的存取指令, 1条源指令翻译后生成多条指令, 使得代码膨胀率增加。</p>
                </div>
                <div class="p1">
                    <p id="71">另外, 在中间表示的生成过程中, 对指令序列进行逐条翻译, 虽然TCG使用了参数活性和操作简化等手段对生成代码进行了一定优化, 但是指令之间的关联被忽略, 冗余操作不可避免, 在此, 我们以间接跳转指令为例进行分析, 如图4所示。</p>
                </div>
                <div class="area_img" id="72">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JSJK201908002_072.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDY2UXI4RUJreUIrY05aSWZBQVJmWT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图4 条件跳转指令代码分析" src="Detail/GetImg?filename=images/JSJK201908002_072.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDY2UXI4RUJreUIrY05aSWZBQVJmWT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图4 条件跳转指令代码分析  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JSJK201908002_072.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDY2UXI4RUJreUIrY05aSWZBQVJmWT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit">Figure 4 Code analysis of conditional jump instruction</p>

                </div>
                <div class="p1">
                    <p id="73">通过图4中虚线框标出的代码部分可以看出, 在进行比较指令翻译的过程中, 将立即数0x1与间接寻址的值分别存入$9、$10, 之后进行了1次减法操作, 目的是比较2个数的大小, 并将比较结果存入$9待用。之后, 在进行条件跳转指令翻译的过程中, 将$9与存入全1的$10进行与操作, 之后将立即数0存入$10与$9进行等于比较操作, 根据比较结果完成跳转。相较于源平台指令操作, 翻译过程中进行了1次减法运算, 1次与运算, 1次比较运算, 存在运算冗余的同时还引入了多次存取冗余操作。</p>
                </div>
                <div class="p1">
                    <p id="74">由此可见, 源平台相邻的指令之间的联系被TCG中间表示分割, 在翻译过程中, 相邻的指令被按照2条独立指令分解为原子操作进行翻译。这样做可以有效保证每条指令翻译前后的程序的正确性, 但是过多的冗余操作影响了翻译后程序的执行效率。因此, 减小生成代码的膨胀率可以从以下几个方面开展工作:</p>
                </div>
                <div class="p1">
                    <p id="75"> (1) 添加反馈机制, 增强待翻译代码之间的关联度, 减少后端代码生成中不必要的冗余指令。</p>
                </div>
                <div class="p1">
                    <p id="76"> (2) 修改生成代码规则, 用更复杂的指令替代原有指令, 实现指令的归约, 将后端代码生成规则由一对多翻译向多对多翻译模式转变。</p>
                </div>
                <h3 id="77" name="77" class="anchor-tag"><b>4 条件跳转指令后端生成优化设计</b></h3>
                <h4 class="anchor-tag" id="78" name="78"><b>4.1 优化指令的选取与分析</b></h4>
                <div class="p1">
                    <p id="79">修改生成代码规则实现对指令的归约需要一定的开销, 对于一些出现次数较少的指令, 过多的判断与处理反而影响程序的执行效率。我们用SPEC CPU 2006与NPB3.3测试集的测试用例进行测试, 统计出现频率排在前10的指令种类和数目, 如表2所示。</p>
                </div>
                <div class="area_img" id="80">
                    <p class="img_tit"><b>表2 测试集指令执行频率统计</b> <a class="downexcel" onclick="DownLoadReportExcel(this)">导出到EXCEL</a></p>
                    <p class="img_tit"><b>Table 2 Instruction execution frequency statistics</b></p>
                    <p class="img_note"></p>
                    <table id="80" border="1"><tr><td><br />序号</td><td>指令名称</td><td>指令类别</td><td>次数</td><td>占比/%</td></tr><tr><td><br />1</td><td>mov</td><td>数据传送</td><td>503 295 619</td><td>39.15</td></tr><tr><td><br />2</td><td>add</td><td>算数加</td><td>120 156 748</td><td>9.34</td></tr><tr><td><br />3</td><td>cmp</td><td>比较</td><td>107 659 451</td><td>8.37</td></tr><tr><td><br />4</td><td>inc</td><td>自加</td><td>90 236 514</td><td>7.01</td></tr><tr><td><br />5</td><td>ja</td><td>条件跳转</td><td>56 126 468</td><td>4.36</td></tr><tr><td><br />6</td><td>je</td><td>条件跳转</td><td>49 541 561</td><td>3.85</td></tr><tr><td><br />7</td><td>lea</td><td>数据传送</td><td>44 071 023</td><td>3.43</td></tr><tr><td><br />8</td><td>jmp</td><td>跳转</td><td>36 548 789</td><td>2.84</td></tr><tr><td><br />9</td><td>jne</td><td>条件跳转</td><td>34 516 647</td><td>2.68</td></tr><tr><td><br />10</td><td>shl</td><td>移位</td><td>22 154 649</td><td>1.72</td></tr><tr><td><br />汇总</td><td></td><td></td><td>1 064 307 469</td><td>82.76</td></tr></table>
                    <form name="form" action="/kxreader/Detail/DownloadReportExcel" method="POST" style="display:inline">
                        <input type="hidden" name="hidTable" value="" />
                        <input type="hidden" name="hidFileName" value="" />
                    </form>
                    <p class="img_note"></p>
                    <p class="img_note"></p>
                </div>
                <div class="p1">
                    <p id="81">通过表2的结果可知, 数据传送类指令、算数加减类指令、条件跳转类指令和逻辑移位指令具有较高的执行频率。出现频率前10的指令占据了指令总数的82.76%, 分别对以上4种指令进行分析并寻找可优化方案, 其中数据传送、算数加减和逻辑移位指令相对比较简单, 中间表示生成的原子操作少, 实现指令归约的可行度不高。而条件跳转指令一般伴随着比较指令cmp或者逻辑运算指令test共同出现, 其出现频率达到20%左右, 且上文分析了其中存在冗余操作, 因此针对其生成代码优化可以达到较好的加速效果。</p>
                </div>
                <div class="p1">
                    <p id="82">比较指令cmp功能相当于减法指令, 逻辑运算test指令同and指令相一致, 但是两者都不保存结果, 只会对标志寄存器产生影响, 其他相关指令通过识别这些被影响的标志寄存器来得知比较结果。1次条件跳转指令完成需要经过比较、判断、跳转3个操作。我们以图4为例, 分析其后端生成代码中存在的冗余操作。在原有的翻译模式下, 条件跳转指令的翻译主要分为以下4个步骤:</p>
                </div>
                <div class="p1">
                    <p id="83"> (1) 将源平台待比较的值分别读入寄存器;</p>
                </div>
                <div class="p1">
                    <p id="84"> (2) 模拟cmp/test比较, 将2个寄存器中的值相减/与, 存入内存中待用;</p>
                </div>
                <div class="p1">
                    <p id="85"> (3) 将传入的值与全1进行与操作, 按照具体跳转条件传入比较位, 将处理过的值与比较位进行判断;</p>
                </div>
                <div class="p1">
                    <p id="86"> (4) 根据比较结果, 决定是否进行跳转, 如果跳转, 先跳转到标签位置, 再根据标签位置的计算得到具体跳转位置。</p>
                </div>
                <div class="p1">
                    <p id="87">在原系统中, 实际进行了1次运算与1次比较操作。经过翻译后, 系统进行了2次运算、1次比较操作, 同时为了运算, 还加入了部分冗余的存取指令。产生此问题的主要原因在于指令的分割翻译, 使得前后指令失去了关联性。在进行比较指令翻译时, 翻译器不明确接下来要立即进行条件跳转操作, 为了保证程序翻译的正确性, 需要对之前不需要记录的相减结果等中间值进行存取, 以供接下来翻译使用;在进行条件跳转判断时, 只能根据前面处理过的参数再进行1次比较才可以确定是否进行跳转。</p>
                </div>
                <div class="p1">
                    <p id="88">通过分析可知, 在现有的翻译模式下, 条件跳转指令的翻译存在较多冗余指令, 并且条件跳转指令在程序中的比例较高, 因此可以对条件跳转指令进行优化, 提升程序的翻译效率。</p>
                </div>
                <h4 class="anchor-tag" id="89" name="89"><b>4.2 指令预处理与归约操作消除冗余指令</b></h4>
                <div class="p1">
                    <p id="90">设1个程序在其执行前的状态集合为<i>A</i>={<i>a</i><sub>1</sub>, <i>a</i><sub>2</sub>, <i>a</i><sub>3</sub>, …, <i>a</i><sub><i>n</i></sub>}, 程序执行后的状态集合为<i>B</i>={<i>b</i><sub>1</sub>, <i>b</i><sub>2</sub>, <i>b</i><sub>3</sub>, …, <i>b</i><sub><i>n</i></sub>}, 其中<i>a</i><sub><i>i</i></sub>、<i>b</i><sub><i>i</i></sub>表示当前某个状态。操作集合<i>G</i>={<i>g</i><sub>1</sub>, <i>g</i><sub>2</sub>, <i>g</i><sub>3</sub>, …, <i>g</i><sub><i>n</i></sub>}, 操作<mathml id="91"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>g</mi><msub><mrow></mrow><mi>i</mi></msub><mo>=</mo><mrow><mo>[</mo><mrow><mi>Ο</mi><mi>Ρ</mi><mo>, </mo><mi>E</mi></mrow><mo>]</mo></mrow></mrow></math></mathml>, 其中包含操作指令<i>OP</i>与操作变量<i>E</i>。对于任一程序, 如果其在某一时刻状态为<i>A</i><sub><i>u</i></sub>, 经过操作<i>G</i><sub><i>u</i></sub>到达状态<i>B</i><sub><i>u</i></sub>, 其形式化描述如下:</p>
                </div>
                <div class="p1">
                    <p id="92" class="code-formula">
                        <mathml id="92"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mrow><mo> (</mo><mrow><mi>A</mi><msub><mrow></mrow><mi>u</mi></msub></mrow><mo>) </mo></mrow><mo>→</mo><mi>G</mi><msub><mrow></mrow><mi>u</mi></msub><mo>→</mo><mrow><mo> (</mo><mrow><mi>B</mi><msub><mrow></mrow><mi>u</mi></msub></mrow><mo>) </mo></mrow></mrow></math></mathml>
                    </p>
                </div>
                <div class="p1">
                    <p id="93">对于状态集合<i>A</i><sub><i>u</i></sub>、<i>B</i><sub><i>u</i></sub>, 如果存在<i>A</i>′<sub><i>u</i></sub>使得任意<i>a</i><sub><i>i</i></sub>⊂<i>A</i><sub><i>u</i></sub>, 满足<i>a</i><sub><i>i</i></sub>⊂<i>A</i>′<sub><i>u</i></sub>, 存在<i>B</i>′<sub><i>u</i></sub>使得任意<i>b</i><sub><i>i</i></sub>⊂<i>B</i><sub><i>u</i></sub>, 满足<i>b</i><sub><i>i</i></sub>⊂<i>B</i>′<sub><i>u</i></sub>, 存在<i>G</i>′<sub><i>u</i></sub>满足<mathml id="94"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mrow><mo> (</mo><mrow><msup><mi>A</mi><mo>′</mo></msup><msub><mrow></mrow><mi>u</mi></msub></mrow><mo>) </mo></mrow><mo>→</mo><msup><mi>G</mi><mo>′</mo></msup><msub><mrow></mrow><mi>u</mi></msub><mo>→</mo><mrow><mo> (</mo><mrow><msup><mi>B</mi><mo>′</mo></msup><msub><mrow></mrow><mi>u</mi></msub></mrow><mo>) </mo></mrow></mrow></math></mathml>, 那么<i>G</i>′<sub><i>u</i></sub>等价于<i>G</i><sub><i>u</i></sub>, 即<i>G</i>′<sub><i>u</i></sub>⇔<i>G</i><sub><i>u</i></sub>。</p>
                </div>
                <div class="p1">
                    <p id="95">同理可知, 如果存在<i>G</i>′<sub><i>u</i></sub>等价于<i>G</i><sub><i>u</i></sub>, 那么状态<i>A</i><sub><i>u</i></sub>经过<i>G</i>′<sub><i>u</i></sub>后, 也可到达状态<i>B</i><sub><i>u</i></sub>。</p>
                </div>
                <div class="p1">
                    <p id="96">设未进行优化前指令集合为<i>G</i><sub><i>u</i></sub>, 修改后的指令集合为<i>G</i>′<sub><i>u</i></sub>, 在进行指令优化的过程中, 如果初始状态和翻译结束状态均保持一致, 那么我们可以认为优化后的指令等价于原翻译指令, 翻译指令的正确性可以得到保证。</p>
                </div>
                <div class="p1">
                    <p id="97">为了增加程序指令翻译之间的关联度, 可以对翻译规则进行改进, 在生成后端代码前对中间表示进行预处理操作, 将多条相关代码组合后共同翻译, 使得翻译代码方式从一对多向多对多翻译模式进行转变, 有效降低翻译中的冗余指令。</p>
                </div>
                <div class="p1">
                    <p id="98">实现上述方案的具体操作如图5所示, 左侧虚线框中分别是源指令<i>A</i>、<i>B</i>的中间表示。在中间表示中加入标记位, 代码预处理过程中, 首先遍历中间表示伪代码, 根据规则找到符合条件的指令后进行标记, 图中黑色方格即代表已被标记, 之后对标记过的代码进行合并构建代码组。处理过的中间表示变为图5中间部分的样式, 在进行翻译的过程中, 其它未被标记的指令仍然按照之前翻译方式进行代码生成, 而代码组中代码则不再按照原有的一条中间表示对应多条后端代码指令的翻译模式, 而是将其作为一个整体进行翻译。</p>
                </div>
                <div class="p1">
                    <p id="99">翻译优化的过程相当于指令归约的过程, 在对代码组的中间指令进行分析过程中, 在保证翻译正确性的基础上, 可以使用目标平台更加符合源平台语义的指令将中间表示中的原子操作进行合并翻译, 即使用更精简的生成代码代替现有的翻译代码, 降低代码膨胀率, 提高翻译效率。</p>
                </div>
                <div class="p1">
                    <p id="100">按照之前形式化分析的结论, 在转化过程中, 由于程序代码执行前各个状态能够与之前翻译状态一致, 在代码组翻译等价替换的基础上, 翻译优化后的状态与原翻译仍保持一致, 翻译的正确性得以保证。</p>
                </div>
                <div class="area_img" id="101">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JSJK201908002_101.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDY2UXI4RUJreUIrY05aSWZBQVJmWT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图5 代码预处理模块" src="Detail/GetImg?filename=images/JSJK201908002_101.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDY2UXI4RUJreUIrY05aSWZBQVJmWT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图5 代码预处理模块  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JSJK201908002_101.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDY2UXI4RUJreUIrY05aSWZBQVJmWT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit">Figure 5 Code preprocessing module</p>

                </div>
                <h4 class="anchor-tag" id="102" name="102"><b>4.3 条件跳转指令优化算法的实现</b></h4>
                <div class="p1">
                    <p id="103">条件跳转指令主要分为以下2类, 其中CMP-JX型为先比较操作数后判断跳转;TEST-JX型指令为操作数相与后判断跳转。为实现功能等价优化, 在后端指令生成模块, 对于CMP-JX型指令使用本地指令CMPXX简化操作, 使用整数条件选择指令SELXX实现跳转地址的选取;对于TEST-JX型指令引入BXX实现条件跳转。几种指令的格式和功能如表3所示。</p>
                </div>
                <div class="p1">
                    <p id="104">使用上述指令后, 对于CMP-JX型指令的翻译便可简化为如下操作:</p>
                </div>
                <div class="area_img" id="105">
                    <p class="img_tit"><b>表3 指令格式与功能介绍</b> <a class="downexcel" onclick="DownLoadReportExcel(this)">导出到EXCEL</a></p>
                    <p class="img_tit"><b>Table 3 Instruction format and function introduction</b></p>
                    <p class="img_note"></p>
                    <table id="105" border="1"><tr><td><br />指令格式</td><td>功能</td></tr><tr><td><br />CMPXX Ra.rl, Rb.rl, Rc.wl</td><td>对Ra和Rb (或立即数) 的值进行比较, 若满足指定关系, 则Rc的值为“1”, 否则为“0”</td></tr><tr><td><br />SELXX Ra.rl, Rb.rl, Rc.rl, Rd.wl</td><td>对Ra按照指令指定的条件进行测试, 根据测试结果选择写入Rd的结果值。若条件成立, 则将Rb (或立即数) 的值写入Rd, 否则将Rc的值写入Rd</td></tr><tr><td><br />BXX Ra.rl, disp.aw</td><td>测试寄存器Ra, 如果指定的关系为真, 则用目标指令地址Vaddr修改PC, 否则继续顺序执行</td></tr></table>
                    <form name="form" action="/kxreader/Detail/DownloadReportExcel" method="POST" style="display:inline">
                        <input type="hidden" name="hidTable" value="" />
                        <input type="hidden" name="hidFileName" value="" />
                    </form>
                    <p class="img_note"></p>
                    <p class="img_note"></p>
                </div>
                <div class="p1">
                    <p id="106"> (1) 读取比较值;</p>
                </div>
                <div class="p1">
                    <p id="107"> (2) CMPXX指令比较;</p>
                </div>
                <div class="p1">
                    <p id="108"> (3) 根据比较结果决定跳转地址;</p>
                </div>
                <div class="p1">
                    <p id="109"> (4) 完成跳转。</p>
                </div>
                <div class="p1">
                    <p id="110">对于TEST-JX型指令翻译则可简化为如下操作:</p>
                </div>
                <div class="p1">
                    <p id="111"> (1) 读取比较值;</p>
                </div>
                <div class="p1">
                    <p id="112"> (2) 比较值相与操作;</p>
                </div>
                <div class="p1">
                    <p id="113"> (3) 根据比较结果完成跳转。</p>
                </div>
                <div class="p1">
                    <p id="114">针对条件跳转指令的翻译, 本文设计了如图6所示的翻译流程。</p>
                </div>
                <div class="area_img" id="115">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JSJK201908002_115.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDY2UXI4RUJreUIrY05aSWZBQVJmWT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图6 代码翻译流程" src="Detail/GetImg?filename=images/JSJK201908002_115.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDY2UXI4RUJreUIrY05aSWZBQVJmWT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图6 代码翻译流程  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JSJK201908002_115.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDY2UXI4RUJreUIrY05aSWZBQVJmWT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit">Figure 6 Code translation process</p>

                </div>
                <div class="p1">
                    <p id="116"> (1) 读取待翻译指令基本块末尾2条指令, 寻找代码段CMP-JX或者TEST-JX, 如果查找到对应指令, 转入 (2) , 若没有找到, 按照正常翻译模式进行翻译, 读取下一基本块。</p>
                </div>
                <div class="p1">
                    <p id="117"> (2) 分析指令段具体格式, 如果为CMP-JX型转入 (3) , 如果为TEST-JX型转入 (4) 。</p>
                </div>
                <div class="p1">
                    <p id="118"> (3) 分析源指令JX的具体格式, 采用相应的本地比较指令与条件选择指令进行具体翻译。</p>
                </div>
                <div class="p1">
                    <p id="119"> (4) 分析源指令JX的具体格式, 采用相应的本地条件跳转指令进行具体翻译。</p>
                </div>
                <div class="p1">
                    <p id="120"> (5) 判断代码翻译是否结束, 如果未结束, 跳转到下一基本块, 并重复 (1) , 如果结束则退出。</p>
                </div>
                <div class="p1">
                    <p id="121">针对2种不同的模式, 分别设计如算法1和算法2所示的翻译算法。</p>
                </div>
                <div class="p1">
                    <p id="122"><b>算法1</b> CMP-JX型指令翻译算法</p>
                </div>
                <div class="p1">
                    <p id="123">//对CMP-JX型指令进行优化翻译</p>
                </div>
                <div class="p1">
                    <p id="124"><b>步骤1</b> 获取2个待比较的值存入寄存器中。</p>
                </div>
                <div class="p1">
                    <p id="125"><b>步骤2</b> 根据JX指令具体形式, 分别对应后端比较指令:JE (JZ) 为等于时跳转、JNE (JNZ) 为不等于时跳转, 对应CMPEQ等于比较;JA (JNBE) 为大于时跳转、JNA (JBE) 为小于或等于时跳转, 对应CMPLE小于或等于比较;JAE (JNB) 为小于时跳转, JANE (JB) 为大于或等于时跳转, 对应CMPLT小于比较。比较结果存入寄存器。</p>
                </div>
                <div class="p1">
                    <p id="126"><b>步骤3</b> 分别将满足条件跳转的目的地址和不满足条件的地址存入寄存器中。</p>
                </div>
                <div class="p1">
                    <p id="127"><b>步骤4</b> 使用条件选择指令SELEQ (等于零赋值) 按照之前的比较结果选择跳转地址, 并完成跳转工作。</p>
                </div>
                <div class="p1">
                    <p id="128"><b>算法2</b> TEST-JX型指令翻译算法</p>
                </div>
                <div class="p1">
                    <p id="129">//对TEST-JX型指令进行优化翻译</p>
                </div>
                <div class="p1">
                    <p id="130"><b>步骤1</b> 获取2个待比较的值并存入寄存器中。如果2个值来自同1寄存器, 转入步骤3, 反之转入步骤2。</p>
                </div>
                <div class="p1">
                    <p id="131"><b>步骤2</b> 将两者进行与操作, 并将结果记录至寄存器中。</p>
                </div>
                <div class="p1">
                    <p id="132"><b>步骤3</b> 根据JE和JNE分别使用BEQ (等于零跳转) 、BNE (不等于零跳转) , 设置标签地址, 如果满足条件, 跳转到指定标签位置。</p>
                </div>
                <div class="p1">
                    <p id="133"><b>步骤4</b> 设置跳转地址, 完成跳转过程。</p>
                </div>
                <div class="area_img" id="134">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JSJK201908002_134.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDY2UXI4RUJreUIrY05aSWZBQVJmWT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图7 优化前后生成代码对比" src="Detail/GetImg?filename=images/JSJK201908002_134.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDY2UXI4RUJreUIrY05aSWZBQVJmWT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图7 优化前后生成代码对比  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JSJK201908002_134.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDY2UXI4RUJreUIrY05aSWZBQVJmWT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit">Figure 7 Comparison of generated code before and after optimization</p>

                </div>
                <div class="p1">
                    <p id="135">根据图6的翻译流程和2类条件跳转指令优化算法, 设计如下伪代码:</p>
                </div>
                <div class="p1">
                    <p id="136">input:<i>DBlock</i> (<i>OP</i>, <i>E</i>) </p>
                </div>
                <div class="p1">
                    <p id="137">1:<i>get</i>_<i>DBlock</i> () {</p>
                </div>
                <div class="p1">
                    <p id="138">2: <i>n</i>=<i>sizeof</i> (<i>DB</i>) ;</p>
                </div>
                <div class="p1">
                    <p id="139">3: *<i>DBptr</i>=<i>DB</i>[<i>n</i>-1];</p>
                </div>
                <div class="p1">
                    <p id="140">4: switch <i>DBptr</i>{</p>
                </div>
                <div class="p1">
                    <p id="141">5:  case 'cmp':call <i>cmp</i>_<i>jx</i> (<i>DB</i>) ;break;</p>
                </div>
                <div class="p1">
                    <p id="142">6:  case 'test':call <i>test</i>_<i>jx</i> (<i>DB</i>) ;break;</p>
                </div>
                <div class="p1">
                    <p id="143">7:  default:break;}</p>
                </div>
                <div class="p1">
                    <p id="144">8: }</p>
                </div>
                <div class="p1">
                    <p id="145">9:<i>cmp</i>_<i>jx</i> () {</p>
                </div>
                <div class="p1">
                    <p id="146">10. <i>mov</i>_<i>i</i> (<i>a</i>[<i>x</i>], <i>b</i>[<i>x</i>]) ;</p>
                </div>
                <div class="p1">
                    <p id="147">11. <i>mov</i>_<i>i</i> (<i>c</i>[<i>x</i>], <i>d</i>[<i>x</i>]) ;</p>
                </div>
                <div class="p1">
                    <p id="148">12: switch <i>jx</i> {</p>
                </div>
                <div class="p1">
                    <p id="149">13:  case JE|JNE:<i>style</i>=cmpeq;break;</p>
                </div>
                <div class="p1">
                    <p id="150">14:  case JA|JNA:<i>style</i>=cmple;break;</p>
                </div>
                <div class="p1">
                    <p id="151">15:  case JB|JNB:<i>style</i>=cmpeq;break;</p>
                </div>
                <div class="p1">
                    <p id="152">16:  ……</p>
                </div>
                <div class="p1">
                    <p id="153">17:  default:break;}</p>
                </div>
                <div class="p1">
                    <p id="154">18: <i>store</i>_<i>address</i> (<i>sel</i>, <i>style</i>) ;</p>
                </div>
                <div class="p1">
                    <p id="155">19:}</p>
                </div>
                <div class="p1">
                    <p id="156">20:<i>cmp</i>_<i>test</i> () {</p>
                </div>
                <div class="p1">
                    <p id="157">21: <i>mov</i>_<i>i</i> (<i>a</i>[<i>x</i>], <i>b</i>[<i>x</i>]) ;</p>
                </div>
                <div class="p1">
                    <p id="158">22: <i>mov</i>_<i>i</i> (<i>c</i>[<i>x</i>], <i>d</i>[<i>x</i>]) ;</p>
                </div>
                <div class="p1">
                    <p id="159">23: <i>and</i>_<i>i</i> (<i>a</i>[<i>x</i>], <i>c</i>[<i>x</i>]) ;</p>
                </div>
                <div class="p1">
                    <p id="160">24: switch <i>jx</i>{</p>
                </div>
                <div class="p1">
                    <p id="161">25:  case JE:<i>style</i>=beq;break;</p>
                </div>
                <div class="p1">
                    <p id="162">26:  case JNE:<i>style</i>=bne;break;</p>
                </div>
                <div class="p1">
                    <p id="163">27:  default:break;}</p>
                </div>
                <div class="p1">
                    <p id="164">28: <i>store</i>_<i>address</i> (<i>jmp</i>, <i>style</i>) ;</p>
                </div>
                <div class="p1">
                    <p id="165">29:}</p>
                </div>
                <div class="p1">
                    <p id="166">30:main () {</p>
                </div>
                <div class="p1">
                    <p id="167">31: <i>read</i>_<i>file</i> () ;</p>
                </div>
                <div class="p1">
                    <p id="168">32: if *<i>flir</i>!=NULL</p>
                </div>
                <div class="p1">
                    <p id="169">33:  call <i>get</i>_<i>DBlock</i> () ;</p>
                </div>
                <div class="p1">
                    <p id="170">34: else</p>
                </div>
                <div class="p1">
                    <p id="171">35:  end translation;</p>
                </div>
                <div class="p1">
                    <p id="172">36:}</p>
                </div>
                <div class="p1">
                    <p id="173">代码中30～35行为代码主程序, 实现程序基本块的读取与判断程序是否结束;代码的1～7行是检测条件跳转模式程序;8～18行为CMP-JX条件跳转的处理函数, 19～28行为TEST-JX条件跳转处理函数。</p>
                </div>
                <div class="p1">
                    <p id="174">我们对2种情况下生成的后端代码进行对比, 图7给出了优化后的生成代码段同优化之前的对比。</p>
                </div>
                <div class="p1">
                    <p id="175">对于图7中的条件跳转指令, 之前产生的后端代码为19条, 经过优化后代码变为10条, 代码膨胀率减少了47.3%, 优化效果较为明显。</p>
                </div>
                <h3 id="176" name="176" class="anchor-tag"><b>5 实验结果</b></h3>
                <div class="p1">
                    <p id="177">本节针对优化程序进行测试, 测试的结果同原翻译器进行比较, 测试的内容主要包括程序的正确性测试、翻译指令膨胀率检测、优化翻译程序性能测试3个方面。</p>
                </div>
                <div class="p1">
                    <p id="178">为更直观地反映翻译效率变化, 本文引入加速比<i>S</i><sub>t</sub>, 其计算方法如下所示:</p>
                </div>
                <div class="p1">
                    <p id="179" class="code-formula">
                        <mathml id="179"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>S</mi><msub><mrow></mrow><mtext>t</mtext></msub><mo>=</mo><mi>Τ</mi><msub><mrow></mrow><mrow><mtext>n</mtext><mtext>a</mtext><mtext>t</mtext><mtext>i</mtext><mtext>v</mtext><mtext>e</mtext></mrow></msub><mo>/</mo><mi>Τ</mi><msub><mrow></mrow><mrow><mtext>t</mtext><mtext>r</mtext><mtext>a</mtext><mtext>n</mtext><mtext>s</mtext><mtext>l</mtext><mtext>a</mtext><mtext>t</mtext><mtext>e</mtext><mtext>d</mtext></mrow></msub></mrow></math></mathml>
                    </p>
                </div>
                <div class="p1">
                    <p id="180">其中, <i>T</i><sub>native</sub>为基本时间, <i>T</i><sub>translated</sub>表示优化后的时间。</p>
                </div>
                <h4 class="anchor-tag" id="181" name="181"><b>5.1 实验环境及测试用例简介</b></h4>
                <div class="p1">
                    <p id="182">实验测试所使用的源平台为<i>x</i>86架构, 目标平台为国产<i>SW</i>处理器, 两者的具体环境参数如表4所示。</p>
                </div>
                <div class="area_img" id="183">
                    <p class="img_tit"><b>表4 指令格式与功能介绍</b> <a class="downexcel" onclick="DownLoadReportExcel(this)">导出到EXCEL</a></p>
                    <p class="img_tit"><b>Table 4 Instruction format and function introduction</b></p>
                    <p class="img_note"></p>
                    <table id="183" border="1"><tr><td><br /></td><td>源平台</td><td>目标平台</td></tr><tr><td><br />OS</td><td>Fedora 2.6.27.5-117.fc10.i686</td><td>中标麒麟 4.0.0</td></tr><tr><td><br />CPU</td><td>Intel (R) Core (TM) 2 Quad CPU Q9500 @ 2.83 GHz</td><td>SW410 1.4 GHz</td></tr><tr><td><br />编译器</td><td>gcc-5.1.1</td><td>gcc-5.1.1</td></tr></table>
                    <form name="form" action="/kxreader/Detail/DownloadReportExcel" method="POST" style="display:inline">
                        <input type="hidden" name="hidTable" value="" />
                        <input type="hidden" name="hidFileName" value="" />
                    </form>
                    <p class="img_note"></p>
                    <p class="img_note"></p>
                </div>
                <div class="p1">
                    <p id="184">实验使用的测试集来自标准性能测试集SPEC CPU2006<sup></sup><citation id="285" type="reference"><link href="258" rel="bibliography" /><sup>[<a class="sup">14</a>]</sup></citation>。本次测试使用的具体测试用例包括SPEC CPU2006中所有的C程序, 如表5所示。</p>
                </div>
                <div class="area_img" id="185">
                    <p class="img_tit"><b>表5 SPEC CPU2006测试用例简介</b> <a class="downexcel" onclick="DownLoadReportExcel(this)">导出到EXCEL</a></p>
                    <p class="img_tit"><b>Table 5 Introduction of SPEC CPU2006 test cases</b></p>
                    <p class="img_note"></p>
                    <table id="185" border="1"><tr><td><br />Test Case</td><td>Task</td></tr><tr><td><br />401.bzip2</td><td>Compression</td></tr><tr><td><br />403.gcc</td><td>C Compiler</td></tr><tr><td><br />429.mcf</td><td>Combinatorial Optimization</td></tr><tr><td><br />445.gobmk</td><td>Artificial Intelligence: go</td></tr><tr><td><br />456.hmmer</td><td>Search Gene Sequence</td></tr><tr><td><br />458.sjeng</td><td>Artificial Intelligence: Chess</td></tr><tr><td><br />462.libquantum</td><td>Physics: Quantum Computing</td></tr><tr><td><br />464.h264ref</td><td>Video Compression</td></tr><tr><td><br />433.milc</td><td>Physics: Quantum Chromodynamics</td></tr><tr><td><br />470.lbm</td><td>Fluid Dynamics</td></tr><tr><td><br />482.sphinx3</td><td>Speech Recognition</td></tr></table>
                    <form name="form" action="/kxreader/Detail/DownloadReportExcel" method="POST" style="display:inline">
                        <input type="hidden" name="hidTable" value="" />
                        <input type="hidden" name="hidFileName" value="" />
                    </form>
                    <p class="img_note"></p>
                    <p class="img_note"></p>
                </div>
                <div class="p1">
                    <p id="186">实验使用的NPB测试集<sup></sup><citation id="286" type="reference"><link href="260" rel="bibliography" /><sup>[<a class="sup">15</a>]</sup></citation>的基本介绍如表6所示。</p>
                </div>
                <h4 class="anchor-tag" id="187" name="187"><b>5.2 生成代码膨胀率检测</b></h4>
                <div class="p1">
                    <p id="188">实验数据统计显示, JMP-JX型翻译指令, 其代码膨胀率平均减少了42.86%;TEST-JX型翻译指令, 其代码膨胀率平均减少了26.31%。针对NPB中10个测试用例的膨胀率进行分析, 其结果如图8所示, 图中实心黑色柱形图代表原翻译系统膨胀率, 实心灰色柱形图代表经过优化后的代码膨胀率。</p>
                </div>
                <div class="area_img" id="189">
                    <p class="img_tit"><b>表6 NPB测试用例简介</b> <a class="downexcel" onclick="DownLoadReportExcel(this)">导出到EXCEL</a></p>
                    <p class="img_tit"><b>Table 6 Introduction of NPB test cases</b></p>
                    <p class="img_note"></p>
                    <table id="189" border="1"><tr><td><br />Test Case</td><td>Task</td></tr><tr><td><br />IS</td><td>Integer Sort, Random Memory Access</td></tr><tr><td><br />EP</td><td>Embarrassingly Parallel</td></tr><tr><td><br />CG</td><td>Conjugate Gradient, Irregular Memory Access and Communication</td></tr><tr><td><br />MG</td><td>Multi-Grid on a Sequence of Meshes</td></tr><tr><td><br />FT</td><td>Discrete 3D Fast Fourier Transform, all-to-all Communication</td></tr><tr><td><br />BT</td><td>Block Tri-diagonal Solver</td></tr><tr><td><br />SP</td><td>Scalar Penta-diagonal Solver</td></tr><tr><td><br />LU</td><td>Lower-Upper Gauss-Seidel Solver</td></tr><tr><td><br />UA</td><td>Unstructured Adaptive Mesh, Dynamic and Irregular Memory Access</td></tr><tr><td><br />DC</td><td>Data Cube</td></tr></table>
                    <form name="form" action="/kxreader/Detail/DownloadReportExcel" method="POST" style="display:inline">
                        <input type="hidden" name="hidTable" value="" />
                        <input type="hidden" name="hidFileName" value="" />
                    </form>
                    <p class="img_note"></p>
                    <p class="img_note"></p>
                </div>
                <div class="area_img" id="191">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JSJK201908002_191.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDY2UXI4RUJreUIrY05aSWZBQVJmWT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图8 代码膨胀率对比图" src="Detail/GetImg?filename=images/JSJK201908002_191.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDY2UXI4RUJreUIrY05aSWZBQVJmWT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图8 代码膨胀率对比图  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JSJK201908002_191.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDY2UXI4RUJreUIrY05aSWZBQVJmWT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit">Figure 8 Comparison of code expansion rate</p>

                </div>
                <div class="p1">
                    <p id="192">对于不同的测试用例, 优化后的代码均较之优化前的代码膨胀率低, 平均优化度约为13.4%。特别是对于之前代码膨胀率较高的测试用例, 具有较好的优化效果。</p>
                </div>
                <div class="p1">
                    <p id="193">实际的测试中, 如果1个程序的条件跳转指令所占比重比较高, 其代码膨胀率较之其它程序偏高, 根据本文提供的方法进行优化翻译后, 代码膨胀率优化效果也比较显著。针对上述分析, 为了研究两者之间的关联度, 选取NPB-3.3作为测试用例, 将源代码在x86下进行编译并对编译产生的测试程序进行指令分析, 将各个程序中条件跳转代码所占比例同膨胀率优化比率进行相关性对比, 如图9所示。</p>
                </div>
                <div class="area_img" id="194">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JSJK201908002_194.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDY2UXI4RUJreUIrY05aSWZBQVJmWT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图9 相关性比较图" src="Detail/GetImg?filename=images/JSJK201908002_194.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDY2UXI4RUJreUIrY05aSWZBQVJmWT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图9 相关性比较图  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JSJK201908002_194.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDY2UXI4RUJreUIrY05aSWZBQVJmWT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit">Figure 9 Relevance comparison</p>

                </div>
                <div class="p1">
                    <p id="195">图9中黑色实线代表的是源平台中的跳转指令所占比率, 灰色实线代表膨胀率优化比率, 两者基本呈现正相关。通过实验可知, 在程序翻译中, 条件跳转指令对代码膨胀率影响较大, 通过改进条件跳转指令的翻译规则, 可以有效降低翻译生成代码的膨胀率。</p>
                </div>
                <div class="p1">
                    <p id="196">从测试结果来看, 改进的条件转移指令翻译算法可以有效降低代码膨胀率。相比之前的翻译模式, 改进后的翻译模式代码膨胀率平均降低14.62%, 特别是对于多循环大规模运算程序案例, 代码膨胀率优化效果更加明显。</p>
                </div>
                <h4 class="anchor-tag" id="197" name="197"><b>5.3 翻译性能测试</b></h4>
                <div class="p1">
                    <p id="198">本节实验针对SPEC CPU 2006中的测试用例, 分别测试了优化前翻译工具的运行时间<i>T</i><sub>1</sub>和经过改进后翻译运行时间<i>T</i>′<sub>1</sub>, 按照上文给出的公式计算加速比<i>S</i><sub>t</sub>。加速比对照图如图10所示。</p>
                </div>
                <div class="area_img" id="199">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JSJK201908002_199.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDY2UXI4RUJreUIrY05aSWZBQVJmWT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图10 SPEC CPU 2006程序加速比" src="Detail/GetImg?filename=images/JSJK201908002_199.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDY2UXI4RUJreUIrY05aSWZBQVJmWT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图10 SPEC CPU 2006程序加速比  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JSJK201908002_199.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDY2UXI4RUJreUIrY05aSWZBQVJmWT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit">Figure 10 Speed ratio on SPEC CPU 2006</p>

                </div>
                <div class="p1">
                    <p id="200">对于所有测试用例, 改进后的翻译程序运行时间都有所缩短, 均得到了加速。其中SPEC CPU 2006中的mcf测试用例加速比达到了42%, 平均提速为17.23%, 程序加速效果较为明显。</p>
                </div>
                <h3 id="201" name="201" class="anchor-tag"><b>6 结束语</b></h3>
                <div class="p1">
                    <p id="202">本文在分析原有TCG中间表示生成代码过程的基础上, 针对现有的中间表示翻译过程中过度分割原子操作造成冗余翻译代码的情况, 对TCG翻译机制进行了改进, 针对条件跳转指令膨胀率较高的问题, 采用了指令归约技术降低翻译过程中的冗余操作, 设计了相关算法。通过实验验证了该方法在保证程序翻译正确性的基础上可以有效降低代码膨胀率, 提升翻译效率。</p>
                </div>

        <!--brief end-->
        
        <!--conten left  end-->
        <!--增强附件-->
                        <h3 class="anchor-tag">作者图片</h3>
                <div class="anchor-wrap">
                        <p>
                                    <div class="anchor-box">
                                        <span class="anchor-a"><image id="226" type="formula" href="images/JSJK201908002_22600.jpg" display="inline" placement="inline"><alt></alt></image></span>
                                        <span class="anchor-a">张家豪</span>
                                    </div>
                                    <div class="anchor-box">
                                        <span class="anchor-a"><image id="227" type="formula" href="images/JSJK201908002_22700.jpg" display="inline" placement="inline"><alt></alt></image></span>
                                        <span class="anchor-a">单征</span>
                                    </div>
                                    <div class="anchor-box">
                                        <span class="anchor-a"><image id="228" type="formula" href="images/JSJK201908002_22800.jpg" display="inline" placement="inline"><alt></alt></image></span>
                                        <span class="anchor-a">岳峰</span>
                                    </div>
                                    <div class="anchor-box">
                                        <span class="anchor-a"><image id="229" type="formula" href="images/JSJK201908002_22900.jpg" display="inline" placement="inline"><alt></alt></image></span>
                                        <span class="anchor-a">傅立国</span>
                                    </div>
                                    <div class="anchor-box">
                                        <span class="anchor-a"><image id="230" type="formula" href="images/JSJK201908002_23000.jpg" display="inline" placement="inline"><alt></alt></image></span>
                                        <span class="anchor-a">王军</span>
                                    </div>
                                    <div class="anchor-box">
                                        <span class="anchor-a"><image id="231" type="formula" href="images/JSJK201908002_23100.jpg" display="inline" placement="inline"><alt></alt></image></span>
                                        <span class="anchor-a">李明亮</span>
                                    </div>
                        </p>
                </div>


        <!--reference start-->
            <div class="reference anchor-tag" id="a_bibliography">
                    <h3>参考文献</h3>
                                        <p id="232">
                            <a id="bibliography_1" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Welcome to the opportunities of binary translation">

                                <b>[1]</b> Altman E R, Kaeli D, Sheffer Y.Welcome to the opportunities of binary translation[J].Computer, 2000, 33 (3) :40-45.
                            </a>
                        </p>
                        <p id="234">
                            <a id="bibliography_2" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Methods and systems for performing a binary translation">

                                <b>[2]</b> Zhong X, Li J, Chen J P, et al.Methods and systems for performing a binary translation:WIPO Patent WO/2014/043886[P].2014-03-27.
                            </a>
                        </p>
                        <p id="236">
                            <a id="bibliography_3" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Binary translation:static,dynamic,retargetable?">

                                <b>[3]</b> Cifuentes C N, Malhotra V M.Binary translation:static, dynamic, retargetable?[C]//Proc of International Conference on Software Maintenance, 2002:340-349.
                            </a>
                        </p>
                        <p id="238">
                            <a id="bibliography_4" target="_blank" href="http://scholar.cnki.net/result.aspx?q=A jump-target identification method for multi-architecture static binary translation">

                                <b>[4]</b> Federico A D, Agosta G.A jump-target identification method for multi-architecture static binary translation[C]//Proc of International Conference on Compliers, Architectures, and Sythesis of Embedded Systems, 2016:Article No.17.
                            </a>
                        </p>
                        <p id="240">
                            <a id="bibliography_5" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JFYZ200701022&amp;v=MTc3NDRSTE9lWmVSbUZ5N2xVYnpPTHl2U2RMRzRIdGJNcm85SFpvUUtESDg0dlI0VDZqNTRPM3pxcUJ0R0ZyQ1U=&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDY2UXI4RUJreUIrY05aSWZBQVJmWT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[5]</b> Li Jian-hui, Ma Xiang-ning, Zhu Chuan-qi.Dynamic binary translation and optimization[J].Journal of Computer Research &amp; Development, 2007, 44 (1) :161-168. (in Chinese) 
                            </a>
                        </p>
                        <p id="242">
                            <a id="bibliography_6" target="_blank" href="http://scholar.cnki.net/result.aspx?q=QEMU,A fast and portable dynamic translator">

                                <b>[6]</b> Bellard F.QEMU, A fast and portable dynamic translator[C]//Proc of the Annual Conference on Usenix Technical, 2005:41.
                            </a>
                        </p>
                        <p id="244">
                            <a id="bibliography_7" target="_blank" href="http://scholar.cnki.net/result.aspx?q=QEMU:A multihost,multitarget emulator">

                                <b>[7]</b> Bartholomew D.QEMU:A multihost, multitarget emulator[M].Houston:Belltown Media, 2006.
                            </a>
                        </p>
                        <p id="246">
                            <a id="bibliography_8" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Cross-platform static binary translation system based on QEMU">

                                <b>[8]</b> Lu Shuai-bing, Pang Jian-min, Shan Zheng, et al.Cross-platform static binary translation system based on QEMU [J].Journal of Zhejiang University (Engineering Edition) , 2016, 50 (1) :158-165. (in Chinese) 
                            </a>
                        </p>
                        <p id="248">
                            <a id="bibliography_9" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Register allocation for QEMU dynamic binary translation systems">

                                <b>[9]</b> Liang Y, Shao Y H, Yang G W, et al.Register allocation for QEMU dynamic binary translation systems[J].International Journal of Hybrid Information Technology, 2015, 8 (2) :199-210.
                            </a>
                        </p>
                        <p id="250">
                            <a id="bibliography_10" target="_blank" href="http://scholar.cnki.net/result.aspx?q=A MPI-Friendly Efficient Static Binary Translator Based on QEMU">

                                <b>[10]</b> Lu S, Pang J, Pan Y, et al.A MPI-friendly efficient static binary translator based on QEMU[C]//Proc of International Conference on Computer Science and Mechanical Automation, 2015:36-40.
                            </a>
                        </p>
                        <p id="252">
                            <a id="bibliography_11" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JYRJ201311011&amp;v=MTQ5NDhIOUxOcm85RVpZUUtESDg0dlI0VDZqNTRPM3pxcUJ0R0ZyQ1VSTE9lWmVSbUZ5N2xVYnpPTHpUWlpMRzQ=&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDY2UXI4RUJreUIrY05aSWZBQVJmWT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[11]</b> Zhang Xi-chao, Guo Xiang-ying, Zhao Lei.Study on TCG dynamic binary translation technique[J].Computer Applications and Software, 2013, 30 (11) :34-37. (in Chinese) 
                            </a>
                        </p>
                        <p id="254">
                            <a id="bibliography_12" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Using the LLVM compiler infrastructure for optimised,asynchronous dynamic translation in QEMU">

                                <b>[12]</b> Jeery A.Using the LLVM compiler infrastructure for optimised, asynchronous dynamic translation in QEMU[J].Adelaide:University of Adelaide, 2009.
                            </a>
                        </p>
                        <p id="256">
                            <a id="bibliography_13" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Research and implementation of hot code detection and dynamic optimization model based on QEMU">

                                <b>[13]</b> Zhang Shi-yi.Research and implementation of hot code detection and dynamic optimization model based on QEMU [D].Chengdu:University of Electronic Science and Technology of China, 2013. (in Chinese) 
                            </a>
                        </p>
                        <p id="258">
                            <a id="bibliography_14" target="_blank" href="">

                                <b>[14]</b> http://www.spec.org/cpu2006/.
                            </a>
                        </p>
                        <p id="260">
                            <a id="bibliography_15" target="_blank" href="">

                                <b>[15]</b> http://www.nas.nasa.gov/publications/npb.html.
                            </a>
                        </p>
                        <p id="262">
                            <a id="bibliography_5" >
                                    <b>[5]</b>
                                 李剑慧, 马湘宁, 朱传琪.动态二进制翻译与优化技术研究[J].计算机研究与发展, 2007, 44 (1) :161-168.
                            </a>
                        </p>
                        <p id="264">
                            <a id="bibliography_8" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=ZDZC201601023&amp;v=MTUwMDZHNEg5Zk1ybzlIWjRRS0RIODR2UjRUNmo1NE8zenFxQnRHRnJDVVJMT2VaZVJtRnk3bFViek9QeW5SYmI=&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDY2UXI4RUJreUIrY05aSWZBQVJmWT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[8]</b> 卢帅兵, 庞建民, 单征, 等.基于QEMU的跨平台静态二进制翻译系统[J].浙江大学学报 (工学版) , 2016, 50 (1) :158-165.
                            </a>
                        </p>
                        <p id="266">
                            <a id="bibliography_11" >
                                    <b>[11]</b>
                                 张西超, 郭向英, 赵雷.TCG动态二进制翻译技术研究[J].计算机应用与软件, 2013, 30 (11) :34-37.
                            </a>
                        </p>
                        <p id="268">
                            <a id="bibliography_13" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CMFD&amp;filename=1013331147.nh&amp;v=MjQyNTJxSkViUElRS0RIODR2UjRUNmo1NE8zenFxQnRHRnJDVVJMT2VaZVJtRnk3bFViek9WRjI2SGJDN0g5REk=&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDY2UXI4RUJreUIrY05aSWZBQVJmWT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[13]</b> 张世宜.基于QEMU的热点代码探测与动态优化模型的研究与实现[D].成都:电子科技大学, 2013.
                            </a>
                        </p>
            </div>
        <!--reference end-->
        <!--footnote start-->
        <!--footnote end-->



    </div>

        <input id="fileid" type="hidden" value="JSJK201908002" />
        <input id="dpi" type="hidden" value="300" />
    </div>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?6e967eb120601ea41b9d312166416aa6";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
</script>

    


<input id="hid_uid" name="hid_uid" type="hidden" value="WEEvREcwSlJHSldRa1FhdkJkVG5hVDY2UXI4RUJreUIrY05aSWZBQVJmWT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
<input id="hid_kLogin_headerUrl" name="hid_kLogin_headerUrl" type="hidden" value="/KLogin/Request/GetKHeader.ashx%3Fcallback%3D%3F" />
<input id="hid_kLogin_footerUrl" name="hid_kLogin_footerUrl" type="hidden" value="/KLogin/Request/GetKFooter.ashx%3Fcallback%3D%3F" />
<div class="btn-link" style="display: none"><a target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JSJK201908002&amp;v=MDczMjhIOWpNcDQ5RlpvUUtESDg0dlI0VDZqNTRPM3pxcUJ0R0ZyQ1VSTE9lWmVSbUZ5N2xVYnpPTHo3QlpiRzQ=&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDY2UXI4RUJreUIrY05aSWZBQVJmWT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">知网节</a></div>
<div class="popflow" id="popupTips" style="display: none;">
    <div class="popflowArr"></div>
    <div class="popflowCot">
        <div class="hd"><a href="javascript:void(0);" onclick="$('#popupTips').hide();$('#popupmsg').html('')" class="close">X</a></div>
        <div class="bd">
            <p class="mes" id="popupmsg" name="popupmsg"></p>
          
        </div>
    </div>
</div>
<input type="hidden" id="myexport" value="//kns.cnki.net" />

<input type="hidden" id="KPCAPIPATH" value="//ishufang.cnki.net" />
<input type="hidden" id="CitedTimes" value="" />
<div class="link" id="GLSearch" style="display: none;">
    <i class="icon-trangle"></i>
    <div class="inner">
        <a class="icon" id="copytext">复制</a>
        <a class="icon" target="_blank" onclick="searchCRFD(this)">工具书搜索</a>
    </div>
</div>




<input id="hidVirtualPath" name="hidVirtualPath" type="hidden" value="/kxreader" />
<script src="/kxreader/bundles/detail?v=-ULdk-c6FkZHtJA2KAXPgHnyA8mtgyPnBde_C2VZ2BY1"></script>

<script src="/kxreader/Scripts/layer.min.js" type="text/javascript"></script>

<div id="footerBox" class="rootw footer">
</div>
<script>
    if (typeof FlushLogin == 'function') {
        FlushLogin();
    }
    modifyEcpHeader(true);
</script>

<!--图片放大功能 start-->
<script src="/kxreader/bundles/imagebox?v=W4phPu9SNkGcuPeJclikuVE3PpRyIW_gnfjm_19nynI1"></script>

<script type="text/javascript">
    $(function () {
        var j = $.noConflict();
        j(function () {
            j(".zoom-in,.btn-zoomin").imgbox({
                'alignment': 'center',
                'allowMultiple': false,
                'overlayShow': true
            });
        })
    });
</script>
<!--图片放大功能 end-->
<div class="fixedbar">
    <div class="backtop hiddenV" id="backtop">
        <a id="backTopSide" href="javascript:scroll(0,0);" title=""></a>
    </div>
</div>
<script type="text/javascript" src="/kxreader/Scripts/MathJax-2.6-latest/MathJax.js?config=MML_HTMLorMML-full"></script>

</body>
</html>
