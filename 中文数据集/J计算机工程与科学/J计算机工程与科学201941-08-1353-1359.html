<!DOCTYPE html>
<html>
<head>
    <title>全文阅读--XML全文阅读--中国知网</title>
    <link rel="icon" href="/kxreader/favicon.ico" />
    <link rel="shortcut Icon" href="/kxreader/favicon.ico" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="keywords" content="文献 XML KBASE CNKI 中国知网" />
    <meta name="description" content="XML文献检索" />
    <link href="/kxreader/Content/css/detail?v=qX2z2KjRAEyQiNfAbKtl7dLnsqFoQ5Jdw3TZfDf0n1k1" rel="stylesheet"/>

    <script type="text/javascript">
        var APPPATH = '/kxreader';
    </script>
</head>

<body>
    
<script type="text/javascript" src="//login.cnki.net/TopLogin/api/loginapi/get?type=top&amp;localCSS=&amp;returnurl=%2f%2fkns.cnki.net%2f%2fKXReader%2fDetail%3fTIMESTAMP%3d637132363255030000%26DBCODE%3dCJFD%26TABLEName%3dCJFDLAST2019%26FileName%3dJSJK201908003%26RESULT%3d1%26SIGN%3dlWAcU3pb%252bCWdHclAKsLVel%252bIF%252bE%253d"></script>

<div id="headerBox" class="header">
    <div class="topbar">
        <div class="textalign">
            <a href="/kxreader/Detail?dbcode=CJFD&amp;filename=JSJK201908003&amp;align=md">
                <i class="icon-cen active" title="居中对齐"></i>
            </a>
            <a href="/kxreader/Detail?dbcode=CJFD&amp;filename=JSJK201908003&amp;align=lt">
                <i class="icon-left " title="左对齐"></i>
            </a>
        </div>
        <h6 class="free-tip"><i class="icon"></i>HTML阅读开放试用阶段，欢迎体验！</h6>
    </div>
</div>

    



<div class="btn-link" style="display: none"><a target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JSJK201908003&amp;v=MjAwMzQ3bFVMN01MejdCWmJHNEg5ak1wNDlGWjRRS0RIODR2UjRUNmo1NE8zenFxQnRHRnJDVVJMT2VaZVJtRnk=&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDY2UXI4RUJreUIrY05aSWZBQVJmWT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">知网节</a></div>

    <div class="main">

        

    <div class="sidebar-a">
        <!--sidebar start-->
        <div class="sidenav">
            <div class="arrow"><span></span></div>
            <!--sidebar_list start-->
            <dl class="sidenav-list">
                    <dt class="tit">目录结构</dt>
                            <dd class="guide">
                                    <p><a href="#29" data-title="&lt;b&gt;1 引言&lt;/b&gt; "><b>1 引言</b></a><i></i></p>
                                                            </dd>
                            <dd class="guide">
                                    <p><a href="#31" data-title="&lt;b&gt;2 相关工作&lt;/b&gt; "><b>2 相关工作</b></a><i></i></p>
                                                            </dd>
                            <dd class="guide">
                                    <p><a href="#34" data-title="&lt;b&gt;3 MapReduce工作流与运行集群的抽象模型&lt;/b&gt; "><b>3 MapReduce工作流与运行集群的抽象模型</b></a><i></i></p>
                                                                    <ul class="contentbox">
                                                <li><a href="#35" data-title="&lt;b&gt;3.1 MapReduce工作流与集群建模&lt;/b&gt;"><b>3.1 MapReduce工作流与集群建模</b></a></li>
                                                <li><a href="#43" data-title="&lt;b&gt;3.2 模型相关参数定义&lt;/b&gt;"><b>3.2 模型相关参数定义</b></a></li>
                                    </ul>
                            </dd>
                            <dd class="guide">
                                    <p><a href="#86" data-title="&lt;b&gt;4 2-MRHS算法&lt;/b&gt; "><b>4 2-MRHS算法</b></a><i></i></p>
                                                                    <ul class="contentbox">
                                                <li><a href="#88" data-title="&lt;b&gt;4.1 任务优先级排序阶段&lt;/b&gt;"><b>4.1 任务优先级排序阶段</b></a></li>
                                                <li><a href="#98" data-title="&lt;b&gt;4.2 计算结点分配阶段&lt;/b&gt;"><b>4.2 计算结点分配阶段</b></a></li>
                                    </ul>
                            </dd>
                            <dd class="guide">
                                    <p><a href="#114" data-title="&lt;b&gt;5 实验及结果&lt;/b&gt; "><b>5 实验及结果</b></a><i></i></p>
                                                                    <ul class="contentbox">
                                                <li><a href="#115" data-title="&lt;b&gt;5.1 实验设置&lt;/b&gt;"><b>5.1 实验设置</b></a></li>
                                                <li><a href="#118" data-title="&lt;b&gt;5.2 性能分析&lt;/b&gt;"><b>5.2 性能分析</b></a></li>
                                    </ul>
                            </dd>
                            <dd class="guide">
                                    <p><a href="#124" data-title="&lt;b&gt;6 结束语&lt;/b&gt; "><b>6 结束语</b></a><i></i></p>
                                                            </dd>
                            <dd class="guide">
                                    <p><a href="#" data-title="文内图表 ">文内图表</a><i></i></p>
                                                                    <ul class="contentbox">
                                                <li><a href="#39" data-title="图1 MapReduce工作流的两级DAG模型示例">图1 MapReduce工作流的两级DAG模型示例</a></li>
                                                <li><a href="#120" data-title="图2 各算法处理不同数据量的平均&lt;i&gt;Makespan&lt;/i&gt;">图2 各算法处理不同数据量的平均<i>Makespan</i></a></li>
                                                <li><a href="#121" data-title="&lt;b&gt;表1 实验中相关模拟参数设置&lt;/b&gt;"><b>表1 实验中相关模拟参数设置</b></a></li>
                                                <li><a href="#123" data-title="&lt;b&gt;表2 各调度算法的调度长度对比&lt;/b&gt; %"><b>表2 各调度算法的调度长度对比</b> %</a></li>
                                    </ul>
                            </dd>
                                    <dd class="guide">
                                        <h6>
                                            <p><a href="#a_bibliography">参考文献</a> </p>
                                        </h6>
                                    </dd>

            </dl>
        </div>
        <!--sidebar end-->
        &nbsp;
        <!--此处有一空格符 勿删-->
    </div>

                <div class="sidebar-b three-collumn" style="width:0;">
            <div class="refer" style="width: 0;">
                <div class="arrow off" title="参考文献"><span></span></div>
                <div class="js-scrollbox" >
                    
                    <div class="subbox active">
                        <h4>
                            <span class="tit">参考文献</span>
                            <a class="close" href="javascript:void(0)">x</a>
                        </h4>
                        <div class="side-scroller">
                            <ul class="refer-list">
                                <li id="148">


                                    <a id="bibliography_1" title=" Dean J, Ghemawat S.MapReduce:Simplified data processing on large clusters [J].Communications of the ACM, 2008, 51 (1) :107-113." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=SJCM&amp;filename=SJCM13091000030554&amp;v=MTExMTFUNlQ0UFFIL2lyUmRHZXJxUVRNbndaZVp1SHlqbVVMZklKbDRYYXhZPU5pZklZN0s3SHRqTnI0OUZaT2dQQ1hrOW9CTQ==&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDY2UXI4RUJreUIrY05aSWZBQVJmWT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[1]</b>
                                         Dean J, Ghemawat S.MapReduce:Simplified data processing on large clusters [J].Communications of the ACM, 2008, 51 (1) :107-113.
                                    </a>
                                </li>
                                <li id="150">


                                    <a id="bibliography_2" title=" Johnson D, Garey M.Computers and intractability:A guide to the theory of MP-completeness[M].New York:Freeman&amp;amp;Co, 1979." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Computers and intractability: a guide to the theory of NP-completeness">
                                        <b>[2]</b>
                                         Johnson D, Garey M.Computers and intractability:A guide to the theory of MP-completeness[M].New York:Freeman&amp;amp;Co, 1979.
                                    </a>
                                </li>
                                <li id="152">


                                    <a id="bibliography_3" title=" Zaharia M, Konwinski A, Joseph A D, et al.Improving MapReduce performance in heterogeneous environments[C]//Proc of the 8th USENIX Conference on Operating Systems Design and Implementation, 2008:29-42." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Improving mapreduce performance in heterogeneous environments">
                                        <b>[3]</b>
                                         Zaharia M, Konwinski A, Joseph A D, et al.Improving MapReduce performance in heterogeneous environments[C]//Proc of the 8th USENIX Conference on Operating Systems Design and Implementation, 2008:29-42.
                                    </a>
                                </li>
                                <li id="154">


                                    <a id="bibliography_4" title=" Tang Zhuo, Zhou Jun-qing, Li Ken-li, et al.A MapReduce task scheduling algorithm for deadline constraints [J].Cluster Computing, 2013, 16 (4) :651-662." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=SSJD&amp;filename=SSJD13120500002249&amp;v=MTU5MThLN0g5UE1xbzlGWk9zTkRuZ3dvQk1UNlQ0UFFIL2lyUmRHZXJxUVRNbndaZVp1SHlqbVVMZklKbDRYYXhZPU5qN0Jhcg==&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDY2UXI4RUJreUIrY05aSWZBQVJmWT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[4]</b>
                                         Tang Zhuo, Zhou Jun-qing, Li Ken-li, et al.A MapReduce task scheduling algorithm for deadline constraints [J].Cluster Computing, 2013, 16 (4) :651-662.
                                    </a>
                                </li>
                                <li id="156">


                                    <a id="bibliography_5" title=" Lu Qing-hua, Li Shan-shan, Zhang Wei-shan, et al.A genetic algorithm-based job scheduling model for big data analytics [J].EURASIP Journal on Wireless Communications and Networking, 2016 (1) :Article No.152." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=A genetic algorithm-based job scheduling model for big data analytics">
                                        <b>[5]</b>
                                         Lu Qing-hua, Li Shan-shan, Zhang Wei-shan, et al.A genetic algorithm-based job scheduling model for big data analytics [J].EURASIP Journal on Wireless Communications and Networking, 2016 (1) :Article No.152.
                                    </a>
                                </li>
                                <li id="158">


                                    <a id="bibliography_6" >
                                        <b>[6]</b>
                                     Pan Jia-yi, Wang Fang, Yang Jing-yi, et al.A load-adaptive feedback scheduling strategy for heterogeneous Hadoop cluster[J].Computer Engineering &amp;amp; Science, 2017, 39 (3) :413-423. (in Chinese) </a>
                                </li>
                                <li id="160">


                                    <a id="bibliography_7" title=" Zhuo Tang, Min Liu, Ammar A, et al.An optimized MapReduce workflow scheduling algorithm for heterogeneous computing [J].The Journal of Supercomputing, 2016, 72 (6) :2059-2079." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=An optimized Map Reduce workflow scheduling algorithm for heterogeneous computing">
                                        <b>[7]</b>
                                         Zhuo Tang, Min Liu, Ammar A, et al.An optimized MapReduce workflow scheduling algorithm for heterogeneous computing [J].The Journal of Supercomputing, 2016, 72 (6) :2059-2079.
                                    </a>
                                </li>
                                <li id="162">


                                    <a id="bibliography_8" title=" Topcuouglu H, Hariri S, Wu M Y.Performance-effective and low-complexity task scheduling for heterogeneous computing [J].IEEE Transactions on Parallel and Distributed Systems, 2002, 13 (3) :260-274." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Performance-effective and low-complexity task scheduling for heterogeneous computing">
                                        <b>[8]</b>
                                         Topcuouglu H, Hariri S, Wu M Y.Performance-effective and low-complexity task scheduling for heterogeneous computing [J].IEEE Transactions on Parallel and Distributed Systems, 2002, 13 (3) :260-274.
                                    </a>
                                </li>
                                <li id="164">


                                    <a id="bibliography_9" title=" Wang Guan, Wang Yu-xin, Chen Xin, et al.Heterogeneous scheduling algorithm with immediate successor finish time [J].Journal of Computer Applications, 2017, 37 (1) :12-17. (in Chinese) " target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JSJY201701005&amp;v=MjUwNjFyQ1VSTE9lWmVSbUZ5N2xVTDdNTHo3QmQ3RzRIOWJNcm85RllZUUtESDg0dlI0VDZqNTRPM3pxcUJ0R0Y=&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDY2UXI4RUJreUIrY05aSWZBQVJmWT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[9]</b>
                                         Wang Guan, Wang Yu-xin, Chen Xin, et al.Heterogeneous scheduling algorithm with immediate successor finish time [J].Journal of Computer Applications, 2017, 37 (1) :12-17. (in Chinese) 
                                    </a>
                                </li>
                                <li id="166">


                                    <a id="bibliography_10" title=" Wang Fei.Research on task scheduling method based on DAG in big data environment [D].Dalian:Dalian University of Technology, 2018. (in Chinese) " target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Research on task scheduling method based on DAG in big data environment">
                                        <b>[10]</b>
                                         Wang Fei.Research on task scheduling method based on DAG in big data environment [D].Dalian:Dalian University of Technology, 2018. (in Chinese) 
                                    </a>
                                </li>
                                <li id="168">


                                    <a id="bibliography_6" title=" 潘佳艺, 王芳, 杨静怡, 等.异构Hadoop集群下的负载自适应反馈调度策略[J].计算机工程与科学, 2017, 39 (3) :413-423." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JSJK201703002&amp;v=MDQ3NTBiTXJJOUZab1FLREg4NHZSNFQ2ajU0TzN6cXFCdEdGckNVUkxPZVplUm1GeTdsVUw3TUx6N0JaYkc0SDk=&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDY2UXI4RUJreUIrY05aSWZBQVJmWT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[6]</b>
                                         潘佳艺, 王芳, 杨静怡, 等.异构Hadoop集群下的负载自适应反馈调度策略[J].计算机工程与科学, 2017, 39 (3) :413-423.
                                    </a>
                                </li>
                                <li id="170">


                                    <a id="bibliography_9" >
                                        <b>[9]</b>
                                     王冠, 王宇新, 陈鑫, 等.基于直接后继节点完成时间的异构调度算法[J].计算机应用, 2017, 37 (1) :12-17.</a>
                                </li>
                                <li id="172">


                                    <a id="bibliography_10" title=" 王飞.大数据环境下基于DAG的任务调度研究[D].大连:大连理工大学, 2018." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CMFD&amp;filename=1018868401.nh&amp;v=MjM4OTZQSVFLREg4NHZSNFQ2ajU0TzN6cXFCdEdGckNVUkxPZVplUm1GeTdsVUw3TVZGMjZGcnUrRnRYTXJwRWI=&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDY2UXI4RUJreUIrY05aSWZBQVJmWT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[10]</b>
                                         王飞.大数据环境下基于DAG的任务调度研究[D].大连:大连理工大学, 2018.
                                    </a>
                                </li>
                            </ul>
                            <div style='display: none;' class="zqscroller" >
                                <h4 class="">附加材料</h4>
                                <ul></ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            &nbsp;
            <!--此处有一空格符 勿删-->
        </div>

        
    <div class="content">



        <!--tips start-->
                            <div class="tips">
                    <a href="http://navi.cnki.net/KNavi/JournalDetail?pcode=CJFD&amp;pykm=JSJK" target="_blank">计算机工程与科学</a>
                2019,41(08),1353-1359 DOI:10.3969/j.issn.1007-130X.2019.08.003            </div>
        <!--tips end-->
            <div class="top-title">
                <h1 class="title">
                    <span class="vm"><b>一种基于两级DAG模型的MapReduce工作流异构调度算法</b></span>
                                    </h1>

            </div>
                        <h2>
                                <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=au&amp;skey=%E7%8E%8B%E5%AE%87%E6%96%B0&amp;code=06532559&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDY2UXI4RUJreUIrY05aSWZBQVJmWT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">王宇新</a>
                                <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=au&amp;skey=%E7%8E%8B%E9%A3%9E&amp;code=06506649&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDY2UXI4RUJreUIrY05aSWZBQVJmWT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">王飞</a>
                                <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=au&amp;skey=%E7%8E%8B%E5%86%A0&amp;code=29347497&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDY2UXI4RUJreUIrY05aSWZBQVJmWT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">王冠</a>
                                <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=au&amp;skey=%E9%83%AD%E7%A6%BE&amp;code=06526918&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDY2UXI4RUJreUIrY05aSWZBQVJmWT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">郭禾</a>
                </h2>
                    <h2>
                    <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=in&amp;skey=%E5%A4%A7%E8%BF%9E%E7%90%86%E5%B7%A5%E5%A4%A7%E5%AD%A6%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6%E4%B8%8E%E6%8A%80%E6%9C%AF%E5%AD%A6%E9%99%A2&amp;code=0222286&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDY2UXI4RUJreUIrY05aSWZBQVJmWT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">大连理工大学计算机科学与技术学院</a>
            </h2>

        
<div class="link">
    <a id="aexport" class="icon icon-output"  onclick="" href="javascript:void(0);"><i></i>导出/参考文献</a>
    
    <span class="shareBoard" onmouseover="$('#sharedet').show();$('#this').addClass('shareBoardCUR')" onmouseout="$('#sharedet').hide();$('#this').removeClass('shareBoardCUR')">
        <a class="icon icon-share" href="#"><i></i>分享<em></em></a>
        <ul class="shareHide" id="sharedet" style="display: none;">
            <li><a title="复制链接" class="copy" onclick="" href="#"><i></i>复制链接</a></li>
            <li><a title="分享到新浪微博" class="xl" onclick="" href="javascript:common.ShareAction('xl');"><i></i>新浪微博</a></li>
            <li>
                <a title="分享到微信" class="wx" onclick="" href="#"><i></i>微信扫一扫</a>
                <div class="qrcode"><img src='' alt='' /></div>
            </li>
        </ul>

    </span>
    
    <a id="RefTrack" title="创建引文跟踪" class="icon icon-track" onclick="" href="javascript:void(0);"> <i></i>创建引文跟踪 </a>
    <a id="ashoucang" title="收藏" class="icon icon-favor" onclick="" href="javascript:void(0);"><i></i>收藏</a>
    <a class="icon icon-print" onclick="window.print();" href="javascript:void(0);"><i></i>打印</a>
    
    <!--版本切换 end-->
</div>
                            <div class="data" id="a_abstract">
                <span class="keys">摘<span style="font-family: 'Times New Roman';">&nbsp;&nbsp;&nbsp;&nbsp;</span>要：</span>
                <p>MapReduce编程模型被广泛应用于大数据处理平台, 而一个有效的任务调度算法对模型的运行效率至关重要。将MapReduce工作流的Map和Reduce阶段分别拆解为若干个有先后序限定关系的作业, 每个作业再拆解为多个任务。之后基于计算集群的可用资源和任务异构性, 构建面向作业和任务的2级有向无环图 (DAG) 模型, 同时提出基于2级优先级排序的异构调度算法2-MRHS。算法的第1阶段进行优先级排序, 即对作业和任务分别进行优先权值计算, 再汇总得到任务的调度队列;第2阶段进行任务分配, 即基于最快完成时间将每个任务所包含的数据块子任务分配给最适合的计算结点。采用大批量随机生成的DAG模型进行实验, 结果表明与其他相关算法相比, 本文算法有更短的调度长度 (makespan) 且更加稳定。</p>
            </div>
                    <div class="data" id="a_keywords">
                <span class="keys">关键词：</span>
                <p>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=MapReduce&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDY2UXI4RUJreUIrY05aSWZBQVJmWT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">MapReduce;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=%E5%B7%A5%E4%BD%9C%E6%B5%81&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDY2UXI4RUJreUIrY05aSWZBQVJmWT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">工作流;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=%E5%BC%82%E6%9E%84%E8%AE%A1%E7%AE%97&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDY2UXI4RUJreUIrY05aSWZBQVJmWT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">异构计算;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=%E4%BB%BB%E5%8A%A1%E8%B0%83%E5%BA%A6&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDY2UXI4RUJreUIrY05aSWZBQVJmWT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">任务调度;</a>
                </p>
            </div>
        
        <!--brief start-->
        
            <div class="brief">
                    <p>
                            <b>作者简介：</b>
                                                        <span>
                                    王宇新 (1973-) , 男, 辽宁大连人, 博士, 副教授, CCF会员 (13091M) , 研究方向为计算机系统结构和并行计算。E-mail:wyx@dlut.edu.cn通信地址:116023辽宁省大连市大连理工大学计算机科学与技术学院;
                                </span>
                                <span>
                                    王飞 (1993-) , 男, 山东滕州人, 硕士生, 研究方向为计算机系统结构和并行计算。E-mail:crawn420@163.com通信地址:116023辽宁省大连市大连理工大学计算机科学与技术学院;
                                </span>
                                <span>
                                    王冠 (1984-) , 男, 辽宁大连人, 博士生, 讲师, CCF会员 (59489M) , 研究方向为计算机系统结构和并行计算。E-mail:lnpc_wg@163.com通信地址:116023辽宁省大连市大连理工大学计算机科学与技术学院;
                                </span>
                                <span>
                                    郭禾 (1955-) , 男, 辽宁大连人, 硕士, 教授, 研究方向为计算机系统结构。E-mail:guohe@dlut.edu.cn通信地址:116023辽宁省大连市大连理工大学计算机科学与技术学院;
                                </span>
                    </p>
                                    <p><b>收稿日期：</b>2018-12-01</p>

                    <p>

                            <b>基金：</b>
                                                        <span>国家自然科学基金 (11372067, 61772112);</span>
                    </p>
            </div>
                    <h1><b>A MapReduce workflow heterogeneous scheduling algorithm based on two-level DAG model</b></h1>
                    <h2>
                    <span>WANG Yu-xin</span>
                    <span>WANG Fei</span>
                    <span>WANG Guan</span>
                    <span>GUO He</span>
            </h2>
                    <h2>
                    <span>School of Computer Science and Technology, Dalian University of Technology</span>
            </h2>
                            <div class="data" id="a_abstractEN">
                <span class="keys">Abstract：</span>
                <p>The MapReduce programming model is widely applied in big data processing platforms, and an effective task scheduling algorithm is critical to the efficiency of the model. In our approach, a MapReduce workflow is decomposed as a number of jobs with successive qualifying relationships and each job has a Map phase and a Reduce phase that both contain multiple tasks. Based on the available resources and task heterogeneity of computing cluster, we construct a two-level directed acyclic graph (DAG) model for job and tasks, and propose a MapReduce workflow heterogeneous scheduling algorithm based on two level priority ordering (2-MRHS) . In the first stage of the algorithm, the priority ordering is performed: the priority weights of the job level and task level are calculated respectively to form the scheduling queue of tasks. In task assignment stage, the data block subtasks of each task are assigned to the appropriate computing node according to the tasks' earliest finish time (EFT) . A large number of randomly generated DAG models are used to conduct experiments and the results show that our algorithm has shorter scheduling length (makespan) and better stability than those of others.</p>
            </div>
                    <div class="data" id="a_keywordsEN">
                <span class="keys">Keyword：</span>
                <p>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=MapReduce&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDY2UXI4RUJreUIrY05aSWZBQVJmWT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">MapReduce;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=workflow&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDY2UXI4RUJreUIrY05aSWZBQVJmWT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">workflow;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=heterogeneous%20computing&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDY2UXI4RUJreUIrY05aSWZBQVJmWT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">heterogeneous computing;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=task%20scheduling&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDY2UXI4RUJreUIrY05aSWZBQVJmWT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">task scheduling;</a>
                </p>
            </div>
                    <div class="brief">
                
                    <p>
                            <b>Author：</b>
                                                        <span>
                                    WANG Yu-xin, born in 1973, PhD, associate professor, CCF member (13091M) , his research interests include computer architecture, and parallel computing.Address:School of Computer Science and Technology, Dalian University of Technology, Dalian 116023, Liaoning, P.R.China;
                                </span>
                                <span>
                                    WANG Fei, born in 1993, MS candidate, his research interests include computer architecture, and parallel computing.Address:School of Computer Science and Technology, Dalian University of Technology, Dalian 116023, Liaoning, P.R.China;
                                </span>
                                <span>
                                    WANG Guan, born in 1984, PhD candidate, lecturer, CCF member (59489M) , his research interests include computer architecture, and parallel computing.Address:School of Computer Science and Technology, Dalian University of Technology, Dalian 116023, Liaoning, P.R.China;
                                </span>
                                <span>
                                    GUO He, born in 1955, MS, professor, his research interest includes computer architecture.Address:School of Computer Science and Technology, Dalian University of Technology, Dalian 116023, Liaoning, P.R.China;
                                </span>
                    </p>
                                    <p><b>Received：</b> 2018-12-01</p>
                                    <p>
                                            </p>
            </div>


        <!--brief start-->
                        <h3 id="29" name="29" class="anchor-tag"><b>1 引言</b></h3>
                <div class="p1">
                    <p id="30">在大数据时代, 动辄需处理TB和PB级的数据, 老式的常规数据处理技术往往不能满足复杂计算的需求, 需引入MapReduce <citation id="174" type="reference"><link href="148" rel="bibliography" /><sup>[<a class="sup">1</a>]</sup></citation>来解决这一问题。MapReduce具有良好的伸缩性和容错性, 已经成为有效的大数据编程模型。然而在面对具有先后序关系的作业构成的大数据工程时, MapReduce并不能有效地进行作业调度。为解决这一问题, 学者们将这些工程整合为工作流的形式, 使其可以并行化运行的同时, 通过合理的调度算法来解决大规模数据集引发的瓶颈问题。工作流在现阶段通常用有向无环图DAG (Directed Acyclic Graph) 模型来进行抽象并研究相应的调度算法, 这已被证实为一个NP-hard问题<citation id="175" type="reference"><link href="150" rel="bibliography" /><sup>[<a class="sup">2</a>]</sup></citation>。同时, 随着计算机硬件资源的不断更新换代, 大数据处理集群中的计算结点在计算能力、I/O传输等方面的特性也不断变化, 再考虑到GPU异构计算的普遍应用, 因此如何将上述因素综合起来对MapReduce工作流进行合理的DAG建模, 成为研究MapReduce调度算法至关重要的问题。</p>
                </div>
                <h3 id="31" name="31" class="anchor-tag"><b>2 相关工作</b></h3>
                <div class="p1">
                    <p id="32">近年来, 针对MapReduce平台默认的FIFO (First In First Out) 作业调度算法制约复杂集群环境下作业调度效率的情况, Zaharia等人<citation id="176" type="reference"><link href="152" rel="bibliography" /><sup>[<a class="sup">3</a>]</sup></citation>的LATE (Longest Approximate Time to End) 算法、Facebook的FairScheduler和Yahoo!的CapacityScheduler分别从容错性、多用户公平性、用户优先级等方面对MapReduce任务调度进行了改进, 但在异构计算中的调度效率上仍需提升。后续的研究又提出基于监测数据实时到来的动态调度策略, 文献<citation id="177" type="reference">[<a class="sup">4</a>]</citation>中的算法通过各个计算结点的计算能力来分配该结点的数据存储量, 提高了任务在本地的存储合理性, 并且引入任务完成截止时间和剩余任务时间来确定任务在MapReduce中的调度优先级。文献<citation id="178" type="reference">[<a class="sup">5</a>]</citation>中采用遗传算法来对预估数据模块进行预测, 构建了预测实时集群的作业调度模型。文献<citation id="179" type="reference">[<a class="sup">6</a>,<a class="sup">6</a>]</citation>则通过对实时监控集群和作业运行的数据建模、量化结点的综合计算能力, 提出一种负载自适应调度策略。此上几种方法虽在一定程度上对MapReduce作业的调度进行了优化, 但仍缺乏对作业调度的全局规划, 也不能针对具有先后优先级的多MapReduce作业的工作流进行调配。文献<citation id="180" type="reference">[<a class="sup">7</a>]</citation>提出的MRWS (Map Reduced-enabled Workflow Scheduler) 算法通过对MapReduce工作流进行DAG建模, 在考虑异构集群的情况下, 借鉴HEFT (Heterogeneous Earliest-Finish-Time) 调度算法<citation id="181" type="reference"><link href="162" rel="bibliography" /><sup>[<a class="sup">8</a>]</sup></citation>对作业优先级排序后再调度。但是, 其对DAG建模时只是简单地将一个MapReduce作业抽象成由多个独立的基于数据块的任务组成的作业, 与MapReduce模型包含Map和Reduce 2个不同阶段的情况不符, 无法合理地对Map任务和Reduce任务进行区分。同时, 针对集群中计算结点的计算能力和通信能力差异性较大的情况, 文献<citation id="182" type="reference">[<a class="sup">7</a>]</citation>使用的HEFT算法具有较大的提升空间。</p>
                </div>
                <div class="p1">
                    <p id="33">本文通过构建MapReduce工作流的基于Job和Task的2级DAG模型, 提出基于2级优先级排序的异构调度2-MRHS (MapReduce workflow Heterogeneous Scheduling algorithm based on the two-level priority ordering) 算法。下文将从模型构建、算法详述和实验与结果分析等方面对模型和算法展开详细阐述。</p>
                </div>
                <h3 id="34" name="34" class="anchor-tag"><b>3 MapReduce工作流与运行集群的抽象模型</b></h3>
                <h4 class="anchor-tag" id="35" name="35"><b>3.1 MapReduce工作流与集群建模</b></h4>
                <div class="p1">
                    <p id="36">MapReduce的编程模型分为Map和Reduce 2个阶段, 在映射 (Map) 过程中首先读取数据并将其划分成一个个具体的数据块, 然后对数据块进行清洗和转换工作, 生成有效的数据集;在规约 (Reduce) 过程中, 对于上一阶段产生的有效数据集进行进一步的数据计算和数据整理, 并对其排序存储。所以, 每一个MapReduce的作业任务都由一个对应过程的Map和Reduce构成, 再具体地处理多个不同目标的对应任务。将多个具有先后序约束关系的作业任务组成在一起就是MapReduce工作流。</p>
                </div>
                <div class="p1">
                    <p id="37">对于一个具体的MapReduce工作流, 为了便于解决问题通常会将其构建为向无环图 (DAG) 模型<i>W</i>= (<i>J</i>, <i>T</i>, <i>E</i>, <i>D</i>, <i>B</i>) 。其中, 作业<i>J</i> (Job) 为MapReduce工作流中所有的作业集合;任务<i>T</i> (Task) 为工作流中包含的所有任务集合, 任务分为<i>T</i><sub>Map</sub>和<i>T</i><sub>Reduce</sub> 2类, 分别表示Map阶段和Reduce阶段各自任务集合。集合<i>J</i>中每个作业<i>j</i>都是一个任务集合, 如第<i>i</i>个作业<i>j</i><sub><i>i</i></sub>可以表示为<i>j</i><sub><i>i</i></sub>=<i>T</i><sub><i>i</i></sub>, <i>T</i><sub><i>i</i></sub>⊆<i>T</i>。边<i>E</i> (Edge) 表示在抽象为有向无环图的任务之间传输关系的边的集合;数据集<i>D</i> (Data set) 表示在具体的MapReduce中所有需要被处理的数据块集合;子任务<i>B</i> (suBtask) 表示所有的子任务集合。对于每个任务, 根据其分配的待处理的数据块个数可以划分出具体的子任务, 如第<i>k</i>个任务<i>t</i><sub><i>k</i></sub>对应的子任务集合为<i>B</i><sub><i>k</i></sub>, <i>t</i><sub><i>k</i></sub>=<i>B</i><sub><i>k</i></sub>, <i>B</i><sub><i>k</i></sub>⊆<i>B</i>。</p>
                </div>
                <div class="p1">
                    <p id="38">图1是1个由4个Job和14个Task组成的MapReduce工作流模型示例, 其中入口作业<i>j</i><sub>entry</sub>和出口作业<i>j</i><sub>exit</sub>为2个虚拟结点, 内含任务复杂度为0 (不存在任何计算开销) 的虚拟任务结点<i>t</i><sub>entry</sub>和<i>t</i><sub>exit</sub>。</p>
                </div>
                <div class="area_img" id="39">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JSJK201908003_039.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDY2UXI4RUJreUIrY05aSWZBQVJmWT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图1 MapReduce工作流的两级DAG模型示例" src="Detail/GetImg?filename=images/JSJK201908003_039.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDY2UXI4RUJreUIrY05aSWZBQVJmWT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图1 MapReduce工作流的两级DAG模型示例  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JSJK201908003_039.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDY2UXI4RUJreUIrY05aSWZBQVJmWT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit">Figure 1 A demonstration of two-level  DAG model of a MapReduce workflow</p>

                </div>
                <div class="p1">
                    <p id="40">对MapReduce工作流的计算集群 (包含计算结点和数据) 进行DAG建模为<i>C</i>= (<i>S</i>, <i>P</i>, <i>DC</i>, <i>D</i>, <i>V</i>) 。其中, 计算结点<i>S</i> (Slot) 表示集群中所有计算结点的集合;计算池<i>P</i> (Pool) 为集群中所有计算池的集合。计算池通常用于表示在整个大数据计算集群中性能同构的部分计算结点集合, <i>p</i><sub><i>i</i></sub>=<i>S</i><sub><i>i</i></sub>, <i>S</i><sub><i>i</i></sub>⊆<i>S</i>, 这是因为整个集群中硬件在不断地调整更新, 计算结点会表现出不同的计算能力。数据中心<i>DC</i> (Data Center) 表示在集群中用于数据存储的位置, 每个数据中心<i>dc</i>的数据由一组数据集组成, <i>dc</i><sub><i>i</i></sub>.<i>dataSet</i>=<i>D</i><sub><i>i</i></sub>, <i>D</i><sub><i>i</i></sub>⊆<i>D</i>;数据集<i>D</i> (Data set) 为集群中具体的数据集合, 采用相同大小的数据分块方式, 并根据数据大小与对应的计算池计算能力的比值不同存放到对应的<i>dc</i>中, 即<i>dc</i><sub>1</sub>.<i>dataSize</i>/<i>p</i><sub>1</sub>.<i>capicity</i>=<i>dc</i><sub>2</sub>.<i>dataSize</i>/<i>p</i><sub>2</sub>.<i>capicity</i>=…=<i>dc</i><sub><i>n</i></sub>.<i>dataSize</i>/<i>p</i><sub><i>n</i></sub>.<i>capicity</i>, 同样采用3个冗余备份的数据存储方式 (与Hadoop平台一致) ;集群数据传输速率<i>V</i> (Velocity) 包括计算完成后更新数据库并备份的速率<i>v</i><sub>1</sub>和跨资源池或数据中心存取数据速率<i>v</i><sub>2</sub>, 即<image id="147" type="formula" href="images/JSJK201908003_14700.jpg" display="inline" placement="inline"><alt></alt></image>, 单位为Mb/s。</p>
                </div>
                <h4 class="anchor-tag" id="43" name="43"><b>3.2 模型相关参数定义</b></h4>
                <div class="p1">
                    <p id="44">本节将MapReduce模型中相关的工作流和集群对应的参数定义如下:</p>
                </div>
                <div class="p1">
                    <p id="45"><b>定义1</b> (加速计算池 (Accelerated Pool) 和普通计算池 (Regularity Pool) ) 将具有GPU的高速计算能力的结点计算池称为加速计算池, 将不具有GPU的计算池称为普通计算池, 即:</p>
                </div>
                <div class="p1">
                    <p id="46" class="code-formula">
                        <mathml id="46"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>p</mi><msub><mrow></mrow><mi>k</mi></msub><mo>.</mo><mi>t</mi><mi>y</mi><mi>p</mi><mi>e</mi><mo>=</mo><mrow><mo>{</mo><mtable columnalign="left"><mtr><mtd><mn>0</mn><mo>, </mo><mtext>A</mtext><mtext>c</mtext><mtext>c</mtext><mtext>e</mtext><mtext>l</mtext><mtext>e</mtext><mtext>r</mtext><mtext>a</mtext><mtext>t</mtext><mtext>e</mtext><mtext>d</mtext><mspace width="0.25em" /><mtext>Ρ</mtext><mtext>o</mtext><mtext>o</mtext><mtext>l</mtext></mtd></mtr><mtr><mtd><mn>1</mn><mo>, </mo><mtext>R</mtext><mtext>e</mtext><mtext>g</mtext><mtext>u</mtext><mtext>l</mtext><mtext>a</mtext><mtext>r</mtext><mtext>i</mtext><mtext>t</mtext><mtext>y</mtext><mspace width="0.25em" /><mtext>Ρ</mtext><mtext>o</mtext><mtext>o</mtext><mtext>l</mtext></mtd></mtr></mtable></mrow><mspace width="0.25em" /></mrow></math></mathml>
                    </p>
                </div>
                <div class="p1">
                    <p id="47"><b>定义2</b> (计算密集型任务 (Compute_intense Task) 和I/O密集型任务 (I/O_intense Task) ) 将在GPU计算结点上具有明显提升计算效率的任务称为计算密集型任务, 其它的称为I/O密集型任务, 即:</p>
                </div>
                <div class="p1">
                    <p id="48" class="code-formula">
                        <mathml id="48"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>t</mi><msub><mrow></mrow><mi>i</mi></msub><mo>.</mo><mi>t</mi><mi>y</mi><mi>p</mi><mi>e</mi><mo>=</mo><mrow><mo>{</mo><mtable columnalign="left"><mtr><mtd><mn>0</mn><mo>, </mo><mtext>C</mtext><mtext>o</mtext><mtext>m</mtext><mtext>p</mtext><mtext>u</mtext><mtext>t</mtext><mtext>e</mtext><mo>_</mo><mtext>i</mtext><mtext>n</mtext><mtext>t</mtext><mtext>e</mtext><mtext>n</mtext><mtext>s</mtext><mtext>e</mtext><mspace width="0.25em" /><mtext>Τ</mtext><mtext>a</mtext><mtext>s</mtext><mtext>k</mtext></mtd></mtr><mtr><mtd><mn>1</mn><mo>, </mo><mtext>Ι</mtext><mo>/</mo><mtext>Ο</mtext><mo>_</mo><mtext>i</mtext><mtext>n</mtext><mtext>t</mtext><mtext>e</mtext><mtext>n</mtext><mtext>s</mtext><mtext>e</mtext><mspace width="0.25em" /><mtext>Τ</mtext><mtext>a</mtext><mtext>s</mtext><mtext>k</mtext></mtd></mtr></mtable></mrow><mspace width="0.25em" /></mrow></math></mathml>
                    </p>
                </div>
                <div class="p1">
                    <p id="49">通常Reduce任务是将对应的Map任务进行处理和整合并送往数据中心, 因此对于默认的任务均定义为I/O密集型<i>t</i><sub>Reduce</sub>.<i>type</i>=1。</p>
                </div>
                <div class="p1">
                    <p id="50"><b>定义3</b> (计算结点性能<i>Pf</i> (Performance of Computing Slot) ) 定义<i>Pf</i><sub><i>m</i></sub> (<i>m</i>=1, 2, 3, …, <i>S</i>.<i>size</i>, <i>S</i>.<i>size</i>表示集群中所有计算结点的数量, 即集合<i>S</i>的大小) 为计算结点<i>s</i><sub><i>m</i></sub> 的计算能力指标, 该性能指标值为将同一类任务在该类型节点上进行相同计算任务测试完成时间的倒数, 该值越大其完成时间越短, 计算性能越强。同一计算池中的各计算结点由于同构性, 其计算性能相同。</p>
                </div>
                <div class="p1">
                    <p id="51"><b>定义4</b> (任务复杂度<i>Cp</i> (Complexity of Task) ) 定义<i>Cp</i><sub><i>i</i></sub> (<i>i</i>=1, 2, 3, …, <i>T</i>.<i>size</i>, <i>T</i>.<i>size</i>表示所有任务集合<i>T</i>的大小) 为任务<i>t</i><sub><i>i</i></sub>具体对应的计算复杂度, 由该任务在同类计算结点上完成一个单独数据块的处理时间来表示。</p>
                </div>
                <div class="p1">
                    <p id="52"><b>定义5</b> (任务异构度<i>Ht</i> (Heterogenous Parameter of Task) ) <i>H</i><sub><i>t</i><sub><i>i</i></sub>, <i>s</i><sub><i>m</i></sub></sub>为<i>t</i><sub><i>i</i></sub>在计算结点<i>s</i><sub><i>m</i></sub>上的运行效率:</p>
                </div>
                <div class="p1">
                    <p id="53" class="code-formula">
                        <mathml id="53"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>Η</mi><msub><mrow></mrow><mrow><mi>t</mi><msub><mrow></mrow><mi>i</mi></msub><mo>, </mo><mi>s</mi><msub><mrow></mrow><mi>m</mi></msub></mrow></msub><mo>=</mo><mrow><mo>{</mo><mtable columnalign="left"><mtr><mtd><mn>1</mn><mo>, </mo><mi>t</mi><msub><mrow></mrow><mi>i</mi></msub><mo>.</mo><mi>t</mi><mi>y</mi><mi>p</mi><mi>e</mi><mo>=</mo><mi>p</mi><msub><mrow></mrow><mi>k</mi></msub><mo>.</mo><mi>t</mi><mi>y</mi><mi>p</mi><mi>e</mi></mtd></mtr><mtr><mtd><mi>x</mi><mo>, </mo><mi>t</mi><msub><mrow></mrow><mi>i</mi></msub><mo>.</mo><mi>t</mi><mi>y</mi><mi>p</mi><mi>e</mi><mo>≠</mo><mi>p</mi><msub><mrow></mrow><mi>k</mi></msub><mo>.</mo><mi>t</mi><mi>y</mi><mi>p</mi><mi>e</mi></mtd></mtr></mtable></mrow><mspace width="0.25em" /><mo>, </mo><mi>s</mi><msub><mrow></mrow><mi>m</mi></msub><mo>∈</mo><mi>p</mi><msub><mrow></mrow><mi>k</mi></msub><mo>, </mo><mn>0</mn><mo>&lt;</mo><mi>x</mi><mo>&lt;</mo><mn>1</mn></mrow></math></mathml>
                    </p>
                </div>
                <div class="p1">
                    <p id="54">任务<i>t</i><sub><i>i</i></sub>在结点<i>s</i><sub><i>m</i></sub>上完成计算的时间表示为:</p>
                </div>
                <div class="p1">
                    <p id="55" class="code-formula">
                        <mathml id="55"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>ω</mi><msub><mrow></mrow><mrow><mi>t</mi><msub><mrow></mrow><mi>i</mi></msub><mo>, </mo><mi>s</mi><msub><mrow></mrow><mi>m</mi></msub></mrow></msub><mo>=</mo><mfrac><mrow><mi>D</mi><msub><mrow></mrow><mrow><mi>t</mi><msub><mrow></mrow><mi>i</mi></msub><mi>i</mi><mi>n</mi></mrow></msub><mo>.</mo><mi>s</mi><mi>i</mi><mi>z</mi><mi>e</mi><mo>×</mo><mi>C</mi><mi>p</mi><msub><mrow></mrow><mi>i</mi></msub></mrow><mrow><mi>Ρ</mi><mi>f</mi><msub><mrow></mrow><mi>m</mi></msub><mo>×</mo><mi>Η</mi><msub><mrow></mrow><mrow><mi>t</mi><msub><mrow></mrow><mi>i</mi></msub><mo>, </mo><mi>s</mi><msub><mrow></mrow><mi>m</mi></msub></mrow></msub></mrow></mfrac><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mrow><mtext> </mtext><mtext> </mtext><mtext> </mtext></mrow><mo stretchy="false"> (</mo><mn>1</mn><mo stretchy="false">) </mo></mrow></math></mathml>
                    </p>
                </div>
                <div class="p1">
                    <p id="56">其中, <i>D</i><sub><i>t</i><sub><i>i</i></sub><i>in</i></sub>.<i>size</i> 表示任务<i>t</i><sub><i>i</i></sub>输入的数据集合中需要处理的具体数据块数;任务<i>t</i><sub><i>i</i></sub>在数据集群中计算的平均时间为:<mathml id="57"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mover accent="true"><mrow><mi>ω</mi><msub><mrow></mrow><mrow><mi>t</mi><msub><mrow></mrow><mi>i</mi></msub></mrow></msub></mrow><mo stretchy="true">¯</mo></mover><mo>=</mo><mstyle displaystyle="true"><munder><mo>∑</mo><mrow><mi>s</mi><msub><mrow></mrow><mi>m</mi></msub><mo>∈</mo><mi>S</mi></mrow></munder><mi>ω</mi></mstyle><msub><mrow></mrow><mrow><mi>t</mi><msub><mrow></mrow><mi>i</mi></msub><mo>, </mo><mi>s</mi><msub><mrow></mrow><mi>m</mi></msub></mrow></msub><mo>/</mo><mi>S</mi><mo>.</mo><mi>s</mi><mi>i</mi><mi>z</mi><mi>e</mi></mrow></math></mathml>。任务<i>t</i><sub><i>i</i></sub>数据处理完成后传输到数据中心, 并完成备份后传给后继任务<i>t</i><sub><i>j</i></sub>的通信时间<i>c</i><sub><i>t</i><sub><i>i</i></sub>, <i>t</i><sub><i>j</i></sub></sub>为:</p>
                </div>
                <div class="p1">
                    <p id="58" class="code-formula">
                        <mathml id="58"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>c</mi><msub><mrow></mrow><mrow><mi>t</mi><msub><mrow></mrow><mi>i</mi></msub><mo>, </mo><mi>t</mi><msub><mrow></mrow><mi>j</mi></msub></mrow></msub><mo>=</mo><mrow><mo> (</mo><mrow><mi>D</mi><msub><mrow></mrow><mrow><mi>t</mi><msub><mrow></mrow><mi>i</mi></msub><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub><mo>.</mo><mi>s</mi><mi>i</mi><mi>z</mi><mi>e</mi><mo>×</mo><mi>e</mi><msub><mrow></mrow><mrow><mi>t</mi><msub><mrow></mrow><mi>i</mi></msub><mo>, </mo><mi>t</mi><msub><mrow></mrow><mi>j</mi></msub></mrow></msub><mo>×</mo><mi>d</mi><mi>a</mi><mi>t</mi><mi>a</mi><mo>.</mo><mi>s</mi><mi>i</mi><mi>z</mi><mi>e</mi></mrow><mo>) </mo></mrow><mo>/</mo><mi>v</mi><msub><mrow></mrow><mn>1</mn></msub><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mrow><mtext> </mtext><mtext> </mtext><mtext> </mtext></mrow><mo stretchy="false"> (</mo><mn>2</mn><mo stretchy="false">) </mo></mrow></math></mathml>
                    </p>
                </div>
                <div class="p1">
                    <p id="59">其中, <i>D</i><sub><i>t</i><sub><i>i</i></sub><i>out</i></sub>.<i>size</i>为任务输出数据集合的数据块个数;<i>e</i><sub><i>t</i><sub><i>i</i></sub>, <i>t</i><sub><i>j</i></sub></sub>为任务<i>t</i><sub><i>i</i></sub>传输给后继任务<i>t</i><sub><i>j</i></sub>的数据量占任务<i>t</i><sub><i>i</i></sub>所有输出数据的比例;<i>data</i>.<i>size</i>表示一个数据块的容量大小 (通常采用HDFS默认值即64 Mb) ;<i>v</i><sub>1</sub>表示任务处理完成后将结果更新备份到数据库的速率。</p>
                </div>
                <div class="p1">
                    <p id="60">所以, 作业<i>j</i><sub><i>k</i></sub>在计算结点<i>s</i><sub><i>m</i></sub>上的计算完成时间和在数据集群中平均计算完成时间分别表示为:<mathml id="61"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>ω</mi><msub><mrow></mrow><mrow><mi>j</mi><msub><mrow></mrow><mi>k</mi></msub><mo>, </mo><mi>s</mi><msub><mrow></mrow><mi>m</mi></msub></mrow></msub><mo>=</mo><mstyle displaystyle="true"><munder><mo>∑</mo><mrow><mi>t</mi><msub><mrow></mrow><mi>i</mi></msub><mo>∈</mo><mi>j</mi><msub><mrow></mrow><mi>k</mi></msub></mrow></munder><mi>ω</mi></mstyle><msub><mrow></mrow><mrow><mi>t</mi><msub><mrow></mrow><mi>i</mi></msub><mo>, </mo><mi>s</mi><msub><mrow></mrow><mi>m</mi></msub></mrow></msub></mrow></math></mathml>, <mathml id="62"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mover accent="true"><mrow><mi>ω</mi><msub><mrow></mrow><mrow><mi>j</mi><msub><mrow></mrow><mi>k</mi></msub></mrow></msub></mrow><mo stretchy="true">¯</mo></mover><mo>=</mo><mo stretchy="false"> (</mo><mstyle displaystyle="true"><msub><mo>∑</mo><mrow><mi>s</mi><msub><mrow></mrow><mi>m</mi></msub><mo>∈</mo><mi>S</mi></mrow></msub><mi>ω</mi></mstyle><msub><mrow></mrow><mrow><mi>j</mi><msub><mrow></mrow><mi>k</mi></msub><mo>, </mo><mi>s</mi><msub><mrow></mrow><mi>m</mi></msub></mrow></msub><mo stretchy="false">) </mo><mo>/</mo><mi>S</mi><mo>.</mo><mi>s</mi><mi>i</mi><mi>z</mi><mi>e</mi></mrow></math></mathml>;同样, <mathml id="63"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>c</mi><msub><mrow></mrow><mrow><mi>j</mi><msub><mrow></mrow><mi>k</mi></msub><mo>, </mo><mi>j</mi><msub><mrow></mrow><mi>n</mi></msub></mrow></msub><mo>=</mo><mstyle displaystyle="true"><munder><mo>∑</mo><mrow><mi>t</mi><msub><mrow></mrow><mi>i</mi></msub><mo>∈</mo><mi>j</mi><msub><mrow></mrow><mi>k</mi></msub><mo>, </mo><mi>t</mi><msub><mrow></mrow><mi>j</mi></msub><mo>∈</mo><mi>j</mi><msub><mrow></mrow><mi>n</mi></msub></mrow></munder><mi>c</mi></mstyle><msub><mrow></mrow><mrow><mi>t</mi><msub><mrow></mrow><mi>i</mi></msub><mo>, </mo><mi>t</mi><msub><mrow></mrow><mi>j</mi></msub></mrow></msub></mrow></math></mathml>。</p>
                </div>
                <div class="p1">
                    <p id="64"><b>定义6</b> 出度通信开销权值<i>occw</i> (Out-degree Communication Cost Weight) 为任务<i>t</i><sub><i>i</i></sub>与其直接后继结点产生的通信开销的累加, 公式表示为:</p>
                </div>
                <div class="p1">
                    <p id="65" class="code-formula">
                        <mathml id="65"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mrow><mo>{</mo><mtable columnalign="left"><mtr><mtd><mi>o</mi><mi>c</mi><mi>c</mi><mi>w</mi><mo stretchy="false"> (</mo><mi>t</mi><msub><mrow></mrow><mi>i</mi></msub><mo stretchy="false">) </mo><mo>=</mo><mstyle displaystyle="true"><munder><mo>∑</mo><mrow><mi>t</mi><msub><mrow></mrow><mi>j</mi></msub><mo>∈</mo><mi>s</mi><mi>u</mi><mi>c</mi><mi>c</mi><mo stretchy="false"> (</mo><mi>t</mi><msub><mrow></mrow><mi>i</mi></msub><mo stretchy="false">) </mo></mrow></munder><mi>c</mi></mstyle><msub><mrow></mrow><mrow><mi>t</mi><msub><mrow></mrow><mi>i</mi></msub><mo>, </mo><mi>t</mi><msub><mrow></mrow><mi>j</mi></msub></mrow></msub></mtd></mtr><mtr><mtd><mi>o</mi><mi>c</mi><mi>c</mi><mi>w</mi><mo stretchy="false"> (</mo><mi>t</mi><msub><mrow></mrow><mrow><mtext>e</mtext><mtext>x</mtext><mtext>i</mtext><mtext>t</mtext></mrow></msub><mo stretchy="false">) </mo><mo>=</mo><mn>0</mn></mtd></mtr></mtable></mrow><mspace width="0.25em" /></mrow></math></mathml>
                    </p>
                </div>
                <div class="p1">
                    <p id="66">同样, 对作业<i>j</i><sub><i>i</i></sub>其出度通信开销权值可以表示为:</p>
                </div>
                <div class="p1">
                    <p id="67" class="code-formula">
                        <mathml id="67"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mrow><mo>{</mo><mtable columnalign="left"><mtr><mtd><mi>o</mi><mi>c</mi><mi>c</mi><mi>w</mi><mo stretchy="false"> (</mo><mi>j</mi><msub><mrow></mrow><mi>i</mi></msub><mo stretchy="false">) </mo><mo>=</mo><mstyle displaystyle="true"><munder><mo>∑</mo><mrow><mi>j</mi><msub><mrow></mrow><mi>k</mi></msub><mo>∈</mo><mi>s</mi><mi>u</mi><mi>c</mi><mi>c</mi><mo stretchy="false"> (</mo><mi>j</mi><msub><mrow></mrow><mi>i</mi></msub><mo stretchy="false">) </mo></mrow></munder><mi>c</mi></mstyle><msub><mrow></mrow><mrow><mi>j</mi><msub><mrow></mrow><mi>i</mi></msub><mo>, </mo><mi>j</mi><msub><mrow></mrow><mi>k</mi></msub></mrow></msub></mtd></mtr><mtr><mtd><mi>o</mi><mi>c</mi><mi>c</mi><mi>w</mi><mrow><mo> (</mo><mrow><mi>j</mi><msub><mrow></mrow><mrow><mtext>e</mtext><mtext>x</mtext><mtext>i</mtext><mtext>t</mtext></mrow></msub></mrow><mo>) </mo></mrow><mo>=</mo><mn>0</mn></mtd></mtr></mtable></mrow><mspace width="0.25em" /></mrow></math></mathml>
                    </p>
                </div>
                <div class="p1">
                    <p id="68">其中, <i>succ</i> (<i>t</i><sub><i>i</i></sub>) 表示任务<i>t</i><sub><i>i</i></sub>的所有后继任务结点, <i>succ</i> (<i>j</i><sub><i>i</i></sub>) 表示作业<i>j</i><sub><i>i</i></sub>的所有后继作业结点。</p>
                </div>
                <div class="p1">
                    <p id="69">对于通信密集型任务来说, 一个任务的出度通信开销权值将直接决定调度结果的效率, 较大的权值任务没有进行优先调度会造成其所有直接后继结点都需要进行等待。</p>
                </div>
                <div class="p1">
                    <p id="70"><b>定义7</b> 实际完成时间<mathml id="71"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>A</mi><mi>F</mi><mi>Τ</mi><mrow><mo> (</mo><mrow><mi>b</mi><msub><mrow></mrow><mi>i</mi></msub></mrow><mo>) </mo></mrow></mrow></math></mathml> (Actually Finish Time) 表示一个具体子任务<i>b</i><sub><i>i</i></sub>的实际完成时间;<mathml id="72"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>A</mi><mi>F</mi><mi>Τ</mi><mrow><mo> (</mo><mrow><mi>t</mi><msub><mrow></mrow><mi>k</mi></msub></mrow><mo>) </mo></mrow></mrow></math></mathml>表示任务<i>t</i><sub><i>k</i></sub> 在对应数据集群中的实际完成时间, 即<i>t</i><sub><i>k</i></sub>的所有子任务中最大的完成时间, <mathml id="73"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>A</mi><mi>F</mi><mi>Τ</mi><mrow><mo> (</mo><mrow><mi>t</mi><msub><mrow></mrow><mi>k</mi></msub></mrow><mo>) </mo></mrow><mo>=</mo><munder><mstyle mathsize="140%" displaystyle="true"><mrow><mi>max</mi></mrow></mstyle><mrow><mi>b</mi><msub><mrow></mrow><mi>i</mi></msub><mo>∈</mo><mi>B</mi><msub><mrow></mrow><mi>k</mi></msub></mrow></munder><mspace width="0.25em" /><mi>A</mi><mi>F</mi><mi>Τ</mi><mrow><mo> (</mo><mrow><mi>b</mi><msub><mrow></mrow><mi>i</mi></msub></mrow><mo>) </mo></mrow></mrow></math></mathml>。</p>
                </div>
                <div class="p1">
                    <p id="74"><b>定义8</b> 最快开始时间<mathml id="75"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>E</mi><mi>S</mi><mi>Τ</mi><mrow><mo> (</mo><mrow><mi>b</mi><msub><mrow></mrow><mi>i</mi></msub><mo>, </mo><mi>s</mi><msub><mrow></mrow><mi>m</mi></msub></mrow><mo>) </mo></mrow></mrow></math></mathml> (Earliest Start Time) 为子任务<i>b</i><sub><i>i</i></sub>在计算结点<i>s</i><sub><i>m</i></sub>上最早可以开始执行的时间, 定义为:</p>
                </div>
                <div class="p1">
                    <p id="76" class="code-formula">
                        <mathml id="76"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtable columnalign="left"><mtr><mtd><mi>E</mi><mi>S</mi><mi>Τ</mi><mrow><mo> (</mo><mrow><mi>b</mi><msub><mrow></mrow><mi>i</mi></msub><mo>, </mo><mi>s</mi><msub><mrow></mrow><mi>m</mi></msub></mrow><mo>) </mo></mrow><mo>=</mo><mi>max</mi><mo stretchy="false">{</mo><mi>Τ</mi><msub><mrow></mrow><mrow><mtext>A</mtext><mtext>v</mtext><mtext>l</mtext></mrow></msub><mrow><mo> (</mo><mrow><mi>s</mi><msub><mrow></mrow><mi>m</mi></msub></mrow><mo>) </mo></mrow><mo>, </mo></mtd></mtr><mtr><mtd><mrow><mrow><munder><mstyle mathsize="140%" displaystyle="true"><mrow><mi>max</mi></mrow></mstyle><mrow><mi>t</mi><msub><mrow></mrow><mi>n</mi></msub><mo>∈</mo><mi>p</mi><mi>r</mi><mi>e</mi><mi>d</mi><mo stretchy="false"> (</mo><mi>t</mi><msub><mrow></mrow><mi>j</mi></msub><mo stretchy="false">) </mo></mrow></munder><mrow><mo>{</mo><mrow><mi>A</mi><mi>F</mi><mi>Τ</mi><mrow><mo> (</mo><mrow><mi>t</mi><msub><mrow></mrow><mi>n</mi></msub></mrow><mo>) </mo></mrow><mo>+</mo><mi>c</mi><msub><mrow></mrow><mrow><mi>t</mi><msub><mrow></mrow><mi>n</mi></msub><mo>, </mo><mi>t</mi><msub><mrow></mrow><mi>j</mi></msub></mrow></msub><mo>+</mo><mi>ρ</mi><mo>×</mo><mrow><mo> (</mo><mrow><mi>d</mi><mi>a</mi><mi>t</mi><mi>a</mi><mo>.</mo><mi>s</mi><mi>i</mi><mi>z</mi><mi>e</mi><mo>/</mo><mi>v</mi><msub><mrow></mrow><mn>2</mn></msub></mrow><mo>) </mo></mrow></mrow><mo>}</mo></mrow></mrow><mo>}</mo></mrow></mtd></mtr><mtr><mtd><mrow><mo> (</mo><mrow><mi>b</mi><msub><mrow></mrow><mi>i</mi></msub><mo>∈</mo><mi>t</mi><msub><mrow></mrow><mi>j</mi></msub><mo>, </mo><mi>s</mi><msub><mrow></mrow><mi>m</mi></msub><mo>∈</mo><mi>p</mi><msub><mrow></mrow><mi>k</mi></msub><mo>, </mo><mi>ρ</mi><mo>=</mo><mrow><mo>{</mo><mtable columnalign="left"><mtr><mtd><mn>0</mn><mo>, </mo><mi>d</mi><msub><mrow></mrow><mrow><mi>b</mi><msub><mrow></mrow><mi>i</mi></msub></mrow></msub><mo>∈</mo><mi>d</mi><mi>c</mi><msub><mrow></mrow><mi>k</mi></msub></mtd></mtr><mtr><mtd><mn>1</mn><mo>, </mo><mi>d</mi><msub><mrow></mrow><mrow><mi>b</mi><msub><mrow></mrow><mi>i</mi></msub></mrow></msub><mo>∉</mo><mi>d</mi><mi>c</mi><msub><mrow></mrow><mi>k</mi></msub></mtd></mtr></mtable></mrow><mspace width="0.25em" /></mrow><mo>) </mo></mrow><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mrow><mtext> </mtext><mtext> </mtext><mtext> </mtext></mrow><mo stretchy="false"> (</mo><mn>3</mn><mo stretchy="false">) </mo></mtd></mtr></mtable></math></mathml>
                    </p>
                </div>
                <div class="p1">
                    <p id="77">其中, <mathml id="78"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>Τ</mi><msub><mrow></mrow><mrow><mtext>A</mtext><mtext>v</mtext><mtext>l</mtext></mrow></msub><mrow><mo> (</mo><mrow><mi>s</mi><msub><mrow></mrow><mi>m</mi></msub></mrow><mo>) </mo></mrow></mrow></math></mathml>表示计算结点<i>s</i><sub><i>m</i></sub>最早可以空闲并开始运行子任务<i>b</i><sub><i>i</i></sub>的时间;<i>pred</i> (<i>t</i><sub><i>j</i></sub>) 表示任务<i>t</i><sub><i>j</i></sub>的直接前驱结点的集合;<i>v</i><sub>2</sub>为跨池传输和存取数据的速率;若子任务<i>b</i><sub><i>i</i></sub>当前处理的数据块在计算结点<i>s</i><sub><i>m</i></sub>对应的数据中心<i>dc</i><sub><i>k</i></sub>上存有备份, 则不需要从其他数据中心获取数据, 即<i>ρ</i>=0, 否则, <i>ρ</i>=1。对于初始结点的子任务<i>b</i><sub><i>i</i></sub>, 忽略计算结点启动时间, 最快开始时间<mathml id="79"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>E</mi><mi>S</mi><mi>Τ</mi><mrow><mo> (</mo><mrow><mi>b</mi><msub><mrow></mrow><mi>i</mi></msub><mo>, </mo><mi>s</mi><msub><mrow></mrow><mi>m</mi></msub></mrow><mo>) </mo></mrow><mo>=</mo><mn>0</mn></mrow></math></mathml>。<mathml id="80"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>A</mi><mi>F</mi><mi>Τ</mi><mrow><mo> (</mo><mrow><mi>t</mi><msub><mrow></mrow><mi>n</mi></msub></mrow><mo>) </mo></mrow></mrow></math></mathml>为任务<i>t</i><sub><i>n</i></sub>结尾子任务的完成时间, 由于<i>t</i><sub>entry</sub>为虚结点, 故<mathml id="81"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>A</mi><mi>F</mi><mi>Τ</mi><mrow><mo> (</mo><mrow><mi>t</mi><msub><mrow></mrow><mrow><mtext>e</mtext><mtext>n</mtext><mtext>t</mtext><mtext>r</mtext><mtext>y</mtext></mrow></msub></mrow><mo>) </mo></mrow><mo>=</mo><mn>0</mn></mrow></math></mathml>。</p>
                </div>
                <div class="p1">
                    <p id="82"><b>定义9</b> 最快完成时间<mathml id="83"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>E</mi><mi>F</mi><mi>Τ</mi><mrow><mo> (</mo><mrow><mi>b</mi><msub><mrow></mrow><mi>i</mi></msub><mo>, </mo><mi>s</mi><msub><mrow></mrow><mi>m</mi></msub></mrow><mo>) </mo></mrow></mrow></math></mathml> (Earliest Finish Time) 表示子任务<i>b</i><sub><i>i</i></sub>在计算结点<i>s</i><sub><i>m</i></sub>上的最快完成时间, <mathml id="84"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>E</mi><mi>F</mi><mi>Τ</mi><mrow><mo> (</mo><mrow><mi>b</mi><msub><mrow></mrow><mi>i</mi></msub><mo>, </mo><mi>s</mi><msub><mrow></mrow><mi>m</mi></msub></mrow><mo>) </mo></mrow><mo>=</mo><mi>E</mi><mi>S</mi><mi>Τ</mi><mrow><mo> (</mo><mrow><mi>b</mi><msub><mrow></mrow><mi>i</mi></msub><mo>, </mo><mi>s</mi><msub><mrow></mrow><mi>m</mi></msub></mrow><mo>) </mo></mrow><mo>+</mo><mi>ω</mi><msub><mrow></mrow><mrow><mi>b</mi><msub><mrow></mrow><mi>i</mi></msub><mo>, </mo><mi>s</mi><msub><mrow></mrow><mi>m</mi></msub></mrow></msub></mrow></math></mathml>。</p>
                </div>
                <div class="p1">
                    <p id="85"><b>定义10</b> 调度长度<i>Makespan</i>表示整个MapReduce工作流<i>W</i>在计算集群<i>C</i>上的实际完成时间<i>Makespan</i>=<i>AFT</i> (<i>t</i><sub>exit</sub>) 。</p>
                </div>
                <h3 id="86" name="86" class="anchor-tag"><b>4 2-MRHS算法</b></h3>
                <div class="p1">
                    <p id="87">通过构建2级MapReduce工作流DAG模型, 进一步提出一种基于2级优先级排序的MapReduce异构调度算法2-MRHS。算法包括任务调度优先级排序和计算结点分配2阶段。</p>
                </div>
                <h4 class="anchor-tag" id="88" name="88"><b>4.1 任务优先级排序阶段</b></h4>
                <div class="p1">
                    <p id="89">综合考虑计算开销与通信开销对MapReduce工作流的影响, 借鉴DAG调度算法中的向上排序值 (<i>rank</i><sub>u</sub>) 思想对作业 (Job) 和任务 (Task) 2级分别进行优先权值计算后, 再汇总得到Task的调度队列。<i>rank</i><sub>u</sub>值的计算采用本课题组提出的HSFT算法<citation id="183" type="reference"><link href="164" rel="bibliography" /><link href="170" rel="bibliography" /><sup>[<a class="sup">9</a>,<a class="sup">9</a>]</sup></citation>:</p>
                </div>
                <div class="p1">
                    <p id="90" class="code-formula">
                        <mathml id="90"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mrow><mo>{</mo><mtable columnalign="left"><mtr><mtd><mi>r</mi><mi>a</mi><mi>n</mi><mi>k</mi><msub><mrow></mrow><mtext>u</mtext></msub><mo stretchy="false"> (</mo><mi>t</mi><msub><mrow></mrow><mi>i</mi></msub><mo stretchy="false">) </mo><mo>=</mo></mtd></mtr><mtr><mtd><mtext> </mtext><mtext> </mtext><munder><mstyle mathsize="140%" displaystyle="true"><mrow><mi>max</mi></mrow></mstyle><mrow><mi>t</mi><msub><mrow></mrow><mi>j</mi></msub><mo>∈</mo><mi>s</mi><mi>u</mi><mi>c</mi><mi>c</mi><mo stretchy="false"> (</mo><mi>t</mi><msub><mrow></mrow><mi>i</mi></msub><mo stretchy="false">) </mo></mrow></munder><mrow><mo>{</mo><mrow><mover accent="true"><mrow><mi>w</mi><msub><mrow></mrow><mi>i</mi></msub></mrow><mo stretchy="true">¯</mo></mover><mo>×</mo><mi>σ</mi><msub><mrow></mrow><mi>i</mi></msub><mo>+</mo><mfrac><mrow><mi>o</mi><mi>c</mi><mi>c</mi><mi>w</mi><mo stretchy="false"> (</mo><mi>t</mi><msub><mrow></mrow><mi>i</mi></msub><mo stretchy="false">) </mo></mrow><mrow><mi>o</mi><mi>u</mi><mi>t</mi><mi>d</mi><mo stretchy="false"> (</mo><mi>t</mi><msub><mrow></mrow><mi>i</mi></msub><mo stretchy="false">) </mo></mrow></mfrac><mo>+</mo><mi>r</mi><mi>a</mi><mi>n</mi><mi>k</mi><msub><mrow></mrow><mi>u</mi></msub><mrow><mo> (</mo><mrow><mi>t</mi><msub><mrow></mrow><mi>j</mi></msub></mrow><mo>) </mo></mrow></mrow><mo>}</mo></mrow></mtd></mtr><mtr><mtd><mi>r</mi><mi>a</mi><mi>n</mi><mi>k</mi><msub><mrow></mrow><mtext>u</mtext></msub><mrow><mo> (</mo><mrow><mi>v</mi><msub><mrow></mrow><mrow><mtext>e</mtext><mtext>x</mtext><mtext>i</mtext><mtext>t</mtext></mrow></msub></mrow><mo>) </mo></mrow><mo>=</mo><mover accent="true"><mrow><mi>w</mi><msub><mrow></mrow><mrow><mtext>e</mtext><mtext>x</mtext><mtext>i</mtext><mtext>t</mtext></mrow></msub></mrow><mo stretchy="true">¯</mo></mover><mo>×</mo><mi>σ</mi><msub><mrow></mrow><mrow><mtext>e</mtext><mtext>x</mtext><mtext>i</mtext><mtext>t</mtext></mrow></msub></mtd></mtr></mtable></mrow><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mrow><mtext> </mtext><mtext> </mtext><mtext> </mtext></mrow><mo stretchy="false"> (</mo><mn>4</mn><mo stretchy="false">) </mo></mrow></math></mathml>
                    </p>
                </div>
                <div class="p1">
                    <p id="91">其中, <i>succ</i> (<i>t</i><sub><i>i</i></sub>) 表示任务<i>t</i><sub><i>i</i></sub>直接后继结点, <i>σ</i><sub><i>i</i></sub>为任务<i>t</i><sub><i>i</i></sub>在不同计算结点上计算时间的标准方差值, <i>outd</i> (<i>t</i><sub><i>i</i></sub>) 表示任务<i>t</i><sub><i>i</i></sub>的出度, 即该结点拥有的直接后继结点个数。标准方差相对于均值来说, 可以更好地反映出该结点在不同计算结点上计算差异的敏感性, 在该计算结点上计算的标准方差值越大, 其调度优先级越高。式 (14) 中采用均值与方差的乘积作为计算权值, 是为了更好地平衡计算开销与通信开销之间的数据量级, 以保证公平性。采用出度通信开销权值<i>occw</i>除以出度值, 求得结点直接后继结点的平均通信开销值作为通信开销参数, 也可以更好地适应异构环境下通信密集型任务调度的优先性。</p>
                </div>
                <div class="p1">
                    <p id="92">由此得出对于MapReduce工作流的2级DAG模型中的作业 (Job) 级和任务 (Task) 级的优先级计算公式分别为:</p>
                </div>
                <div class="p1">
                    <p id="93" class="code-formula">
                        <mathml id="93"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtable columnalign="left"><mtr><mtd><mrow><mo>{</mo><mtable columnalign="left"><mtr><mtd><mi>r</mi><mi>a</mi><mi>n</mi><mi>k</mi><msub><mrow></mrow><mtext>u</mtext></msub><mrow><mo> (</mo><mrow><mi>j</mi><msub><mrow></mrow><mi>k</mi></msub></mrow><mo>) </mo></mrow><mo>=</mo></mtd></mtr><mtr><mtd><mtext> </mtext><mtext> </mtext><munder><mstyle mathsize="140%" displaystyle="true"><mrow><mi>max</mi></mrow></mstyle><mrow><mi>j</mi><msub><mrow></mrow><mi>n</mi></msub><mo>∈</mo><mi>s</mi><mi>u</mi><mi>c</mi><mi>c</mi><mo stretchy="false"> (</mo><mi>j</mi><msub><mrow></mrow><mi>k</mi></msub><mo stretchy="false">) </mo></mrow></munder><mrow><mo>{</mo><mrow><mover accent="true"><mrow><mi>w</mi><msub><mrow></mrow><mrow><mi>j</mi><msub><mrow></mrow><mi>k</mi></msub></mrow></msub></mrow><mo stretchy="true">¯</mo></mover><mo>×</mo><mi>σ</mi><msub><mrow></mrow><mrow><mi>j</mi><msub><mrow></mrow><mi>k</mi></msub></mrow></msub><mo>+</mo><mfrac><mrow><mi>o</mi><mi>c</mi><mi>c</mi><mi>w</mi><mo stretchy="false"> (</mo><mi>j</mi><msub><mrow></mrow><mi>k</mi></msub><mo stretchy="false">) </mo></mrow><mrow><mi>o</mi><mi>u</mi><mi>t</mi><mi>d</mi><mo stretchy="false"> (</mo><mi>j</mi><msub><mrow></mrow><mi>k</mi></msub><mo stretchy="false">) </mo></mrow></mfrac><mo>+</mo><mi>r</mi><mi>a</mi><mi>n</mi><mi>k</mi><msub><mrow></mrow><mtext>u</mtext></msub><mrow><mo> (</mo><mrow><mi>j</mi><msub><mrow></mrow><mi>n</mi></msub></mrow><mo>) </mo></mrow></mrow><mo>}</mo></mrow></mtd></mtr><mtr><mtd><mi>r</mi><mi>a</mi><mi>n</mi><mi>k</mi><msub><mrow></mrow><mtext>u</mtext></msub><mrow><mo> (</mo><mrow><mi>j</mi><msub><mrow></mrow><mrow><mtext>e</mtext><mtext>x</mtext><mtext>i</mtext><mtext>t</mtext></mrow></msub></mrow><mo>) </mo></mrow><mo>=</mo><mn>0</mn></mtd></mtr></mtable></mrow><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mrow><mtext> </mtext><mtext> </mtext><mtext> </mtext></mrow><mo stretchy="false"> (</mo><mn>5</mn><mo stretchy="false">) </mo></mtd></mtr><mtr><mtd><mrow><mo>{</mo><mtable columnalign="left"><mtr><mtd><mi>r</mi><mi>a</mi><mi>n</mi><mi>k</mi><msub><mrow></mrow><mtext>u</mtext></msub><mo stretchy="false"> (</mo><mi>t</mi><msub><mrow></mrow><mi>i</mi></msub><mo stretchy="false">) </mo><mo>=</mo></mtd></mtr><mtr><mtd><mtext> </mtext><mtext> </mtext><munder><mstyle mathsize="140%" displaystyle="true"><mrow><mi>max</mi></mrow></mstyle><mrow><mi>t</mi><msub><mrow></mrow><mi>j</mi></msub><mo>∈</mo><mi>s</mi><mi>u</mi><mi>c</mi><mi>c</mi><mo stretchy="false"> (</mo><mi>t</mi><msub><mrow></mrow><mi>i</mi></msub><mo stretchy="false">) </mo></mrow></munder><mrow><mo>{</mo><mrow><mover accent="true"><mrow><mi>w</mi><msub><mrow></mrow><mrow><mi>t</mi><msub><mrow></mrow><mi>i</mi></msub></mrow></msub></mrow><mo stretchy="true">¯</mo></mover><mo>×</mo><mi>σ</mi><msub><mrow></mrow><mrow><mi>t</mi><msub><mrow></mrow><mi>i</mi></msub></mrow></msub><mo>+</mo><mfrac><mrow><mi>o</mi><mi>c</mi><mi>c</mi><mi>w</mi><mo stretchy="false"> (</mo><mi>t</mi><msub><mrow></mrow><mi>i</mi></msub><mo stretchy="false">) </mo></mrow><mrow><mi>o</mi><mi>u</mi><mi>t</mi><mi>d</mi><mo stretchy="false"> (</mo><mi>t</mi><msub><mrow></mrow><mi>i</mi></msub><mo stretchy="false">) </mo></mrow></mfrac><mo>+</mo><mi>r</mi><mi>a</mi><mi>n</mi><mi>k</mi><msub><mrow></mrow><mtext>u</mtext></msub><mo stretchy="false"> (</mo><mi>t</mi><msub><mrow></mrow><mi>j</mi></msub><mo stretchy="false">) </mo></mrow><mo>}</mo></mrow></mtd></mtr><mtr><mtd><mi>r</mi><mi>a</mi><mi>n</mi><mi>k</mi><msub><mrow></mrow><mtext>u</mtext></msub><mo stretchy="false"> (</mo><mi>t</mi><msub><mrow></mrow><mrow><mtext>e</mtext><mtext>x</mtext><mtext>i</mtext><mtext>t</mtext></mrow></msub><mo stretchy="false">) </mo><mo>=</mo><mover accent="true"><mrow><mi>w</mi><msub><mrow></mrow><mrow><mi>t</mi><msub><mrow></mrow><mrow><mtext>e</mtext><mtext>x</mtext><mtext>i</mtext><mtext>t</mtext></mrow></msub></mrow></msub></mrow><mo stretchy="true">¯</mo></mover><mo>×</mo><mi>σ</mi><msub><mrow></mrow><mrow><mi>t</mi><msub><mrow></mrow><mrow><mtext>e</mtext><mtext>x</mtext><mtext>i</mtext><mtext>t</mtext></mrow></msub></mrow></msub></mtd></mtr></mtable></mrow><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mrow><mtext> </mtext><mtext> </mtext><mtext> </mtext></mrow><mo stretchy="false"> (</mo><mn>6</mn><mo stretchy="false">) </mo></mtd></mtr></mtable></math></mathml>
                    </p>
                </div>
                <div class="p1">
                    <p id="94">具体步骤如下所示:</p>
                </div>
                <div class="p1">
                    <p id="95"><b>步骤1</b> 由式 (5) 计算出MapReduce工作流中各作业的<i>rank</i><sub>u</sub> (<i>j</i><sub><i>k</i></sub>) 值, 并递增排序为作业序列<i>JobQueue</i>;</p>
                </div>
                <div class="p1">
                    <p id="96"><b>步骤2</b> 由式 (6) 计算出每个作业<i>j</i><sub><i>k</i></sub>内每个任务的<i>rank</i><sub>u</sub> (<i>t</i><sub><i>i</i></sub>) 值, 并递增排序为任务序列<i>TaskQueue</i><sub><i>k</i></sub>;</p>
                </div>
                <div class="p1">
                    <p id="97"><b>步骤3</b> 将<i>JobQueue</i>中具体各作业任务序列<i>TaskQueue</i><sub><i>k</i></sub>合并成汇总任务调度序列<i>TaskQueue</i>。</p>
                </div>
                <h4 class="anchor-tag" id="98" name="98"><b>4.2 计算结点分配阶段</b></h4>
                <div class="p1">
                    <p id="99">在计算结点分配阶段, 按照上一阶段排列完成的Task调度序列<i>TaskQueue</i>依次对具体的子任务分配计算结点。根据每个子任务的最早完成时间 (<i>EFT</i>) 、最早开始时间 (<i>EST</i>) 和资源池划分情况, 综合考虑数据的本地性、调度时长、资源分配合理性等, 提出基于插入的子任务计算结点分配算法。从<i>TaskQueue</i>中依次提取未调度的任务<i>t</i><sub><i>j</i></sub>, 执行以下步骤:</p>
                </div>
                <div class="p1">
                    <p id="100"><b>步骤1</b> 通过定义8和定义9依次计算任务<i>t</i><sub><i>j</i></sub>中每个子任务<i>b</i><sub><i>i</i></sub>的<mathml id="101"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>E</mi><mi>S</mi><mi>Τ</mi><mrow><mo> (</mo><mrow><mi>b</mi><msub><mrow></mrow><mi>i</mi></msub><mo>, </mo><mi>s</mi><msub><mrow></mrow><mi>m</mi></msub></mrow><mo>) </mo></mrow></mrow></math></mathml>、<mathml id="102"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>E</mi><mi>F</mi><mi>Τ</mi><mrow><mo> (</mo><mrow><mi>b</mi><msub><mrow></mrow><mi>i</mi></msub><mo>, </mo><mi>s</mi><msub><mrow></mrow><mi>m</mi></msub></mrow><mo>) </mo></mrow><mo>;</mo></mrow></math></mathml></p>
                </div>
                <div class="p1">
                    <p id="103"><b>步骤2</b> 依次选出满足下述条件 (1) ～ (4) 的计算结点集合<i>S</i><sub><i>h</i></sub>并排序。选取集合<i>S</i><sub><i>h</i></sub>中的第1个计算结点<i>s</i><sub><i>m</i></sub>, 直接将子任务<i>b</i><sub><i>i</i></sub>分配到该结点<i>s</i><sub><i>m</i></sub>, 并更新<mathml id="104"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>Τ</mi><msub><mrow></mrow><mrow><mtext>A</mtext><mtext>v</mtext><mtext>l</mtext></mrow></msub><mrow><mo> (</mo><mrow><mi>s</mi><msub><mrow></mrow><mi>m</mi></msub></mrow><mo>) </mo></mrow><mo>;</mo></mrow></math></mathml></p>
                </div>
                <div class="p1">
                    <p id="105"><b>步骤3</b> 在<i>t</i><sub><i>k</i></sub>所有子任务完成后由定义7更新<i>AFT</i> (<i>t</i><sub><i>j</i></sub>) , 将任务<i>t</i><sub><i>j</i></sub>从待调度队列中移除。</p>
                </div>
                <div class="p1">
                    <p id="106">判断条件:</p>
                </div>
                <div class="p1">
                    <p id="107"> (1) <mathml id="108"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mtext>Μ</mtext><mtext>i</mtext><mtext>n</mtext><mrow><mo>{</mo><mrow><mi>E</mi><mi>F</mi><mi>Τ</mi><mrow><mo> (</mo><mrow><mi>b</mi><msub><mrow></mrow><mi>i</mi></msub><mo>, </mo><mi>s</mi><msub><mrow></mrow><mi>m</mi></msub></mrow><mo>) </mo></mrow></mrow><mo>}</mo></mrow></mrow></math></mathml>:结点<i>s</i><sub><i>m</i></sub>最早完成子任务<i>b</i><sub><i>i</i></sub>;</p>
                </div>
                <div class="p1">
                    <p id="109"> (2) <mathml id="110"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mrow><mo>{</mo><mrow><mi>s</mi><msub><mrow></mrow><mi>m</mi></msub><mo>∈</mo><mi>p</mi><msub><mrow></mrow><mi>k</mi></msub><mo>, </mo><mi>d</mi><msub><mrow></mrow><mrow><mi>b</mi><msub><mrow></mrow><mi>i</mi></msub></mrow></msub><mo>∈</mo><mi>d</mi><mi>c</mi><msub><mrow></mrow><mi>k</mi></msub></mrow><mo>}</mo></mrow></mrow></math></mathml>:结点<i>s</i><sub><i>m</i></sub>所属计算池<i>p</i><sub><i>k</i></sub>的数据中心含有子任务<i>b</i><sub><i>i</i></sub>的数据块;</p>
                </div>
                <div class="p1">
                    <p id="111"> (3) <i>b</i><sub><i>k</i></sub>.<i>type</i>=<i>s</i><sub><i>m</i></sub>.<i>type</i>:结点<i>s</i><sub><i>m</i></sub>所属计算类型与子任务<i>b</i><sub><i>i</i></sub>的任务类型相同;</p>
                </div>
                <div class="p1">
                    <p id="112"> (4) <mathml id="113"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mtext>Μ</mtext><mtext>a</mtext><mtext>x</mtext><mrow><mo>{</mo><mrow><mi>t</mi><msub><mrow></mrow><mi>j</mi></msub><mo>.</mo><mtext>s</mtext><mtext>u</mtext><mtext>b</mtext><mtext>t</mtext><mtext>a</mtext><mtext>s</mtext><mtext>k</mtext><mtext>s</mtext><mspace width="0.25em" /><mtext>a</mtext><mtext>l</mtext><mtext>l</mtext><mtext>o</mtext><mtext>c</mtext><mtext>a</mtext><mtext>t</mtext><mtext>e</mtext><mtext>d</mtext><mspace width="0.25em" /><mtext>i</mtext><mtext>n</mtext><mspace width="0.25em" /><mi>p</mi><msub><mrow></mrow><mi>k</mi></msub></mrow><mo>}</mo></mrow></mrow></math></mathml>:结点<i>s</i><sub><i>m</i></sub>所属计算池<i>p</i><sub><i>k</i></sub>包含任务<i>t</i><sub><i>j</i></sub>的最多子任务。</p>
                </div>
                <h3 id="114" name="114" class="anchor-tag"><b>5 实验及结果</b></h3>
                <h4 class="anchor-tag" id="115" name="115"><b>5.1 实验设置</b></h4>
                <div class="p1">
                    <p id="116">在实验数据生成阶段, 采用课题组自主研发的DAG仿真模拟器<citation id="184" type="reference"><link href="164" rel="bibliography" /><link href="170" rel="bibliography" /><sup>[<a class="sup">9</a>,<a class="sup">9</a>]</sup></citation>, 随机生成大量MapReduce工作流DAG以及对应的计算集群, 用于MapReduce工作流模拟实验, 对本文算法进行验证。同时, 依据本文思想将文献<citation id="185" type="reference">[<a class="sup">7</a>]</citation>的MRWS算法进行2级DAG模型改进为2-MRWS用于实验对比。</p>
                </div>
                <div class="p1">
                    <p id="117">依据表1中的给定参数及其取值, 参照<i>TaskNumber</i>≥2*<i>JobNumber</i>, 模拟调度本文算法与FIFO、MRWS、2-MRWS, 共生成58 320组不同参数的实验, 每组实验中再随机生成10个不同的参数数据。</p>
                </div>
                <h4 class="anchor-tag" id="118" name="118"><b>5.2 性能分析</b></h4>
                <div class="p1">
                    <p id="119">本文采用最常用的DAG调度结果的指标<i>Makespan</i> (调度长度) 。图2显示了4种算法处理不同数据量时完成时间<i>Makespan</i>的均值分析情况, 所调度的MapReduce工作流均包含5个Job、12个Task, 剩余的实验参数随机设置。表2对583 200组实验数据进行统计, 各算法进行两两对比的情况如表2所示。</p>
                </div>
                <div class="area_img" id="120">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JSJK201908003_120.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDY2UXI4RUJreUIrY05aSWZBQVJmWT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图2 各算法处理不同数据量的平均Makespan" src="Detail/GetImg?filename=images/JSJK201908003_120.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDY2UXI4RUJreUIrY05aSWZBQVJmWT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图2 各算法处理不同数据量的平均<i>Makespan</i>  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JSJK201908003_120.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDY2UXI4RUJreUIrY05aSWZBQVJmWT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit">Figure 2 Average <i>Makespan</i> of different  data volumes by different algorithms</p>

                </div>
                <div class="area_img" id="121">
                    <p class="img_tit"><b>表1 实验中相关模拟参数设置</b> <a class="downexcel" onclick="DownLoadReportExcel(this)">导出到EXCEL</a></p>
                    <p class="img_tit"><b>Table 1 Simulation parameter setting in experiments</b></p>
                    <p class="img_note"></p>
                    <table id="121" border="1"><tr><td><br />参数</td><td>含义</td><td>实验取值范围</td></tr><tr><td><br /><i>JobNumber</i></td><td>MapReduce工作流的DAG模型中包含的作业个数</td><td>{5, 7}</td></tr><tr><td><br /><i>TaskNumber</i></td><td>作业包含任务中个数, 单一作业最少包含1个<i>t</i><sub>Map</sub> 和一个<i>t</i><sub>Reduce</sub></td><td>{10, 12, 17}</td></tr><tr><td><br /><i>DataNumber</i></td><td>MapReduce工作流的DAG模型中所处理的数据块个数</td><td>{80, 150, 300, 400, 500, 1 000}</td></tr><tr><td><br /><i>SlotNumber</i></td><td>运行集群的计算结点的个数</td><td>{8, 12, 16}</td></tr><tr><td><br /><i>PoolNumber</i></td><td>运行集群的计算池的个数</td><td>{5, 8}</td></tr><tr><td><br /><i>η</i></td><td>任务间复杂度差异:<math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>C</mi><mi>p</mi><msub><mrow></mrow><mrow><mtext>d</mtext><mtext>e</mtext><mtext>f</mtext><mtext>a</mtext><mtext>u</mtext><mtext>l</mtext><mtext>t</mtext></mrow></msub><mo>×</mo><mrow><mo> (</mo><mrow><mn>1</mn><mo>-</mo><mi>η</mi></mrow><mo>) </mo></mrow><mo>≤</mo><mi>C</mi><mi>p</mi><msub><mrow></mrow><mi>i</mi></msub><mo>≤</mo><mi>C</mi><mi>p</mi><msub><mrow></mrow><mrow><mtext>d</mtext><mtext>e</mtext><mtext>f</mtext><mtext>a</mtext><mtext>u</mtext><mtext>l</mtext><mtext>t</mtext></mrow></msub><mo>×</mo><mrow><mo> (</mo><mrow><mn>1</mn><mo>+</mo><mi>η</mi></mrow><mo>) </mo></mrow></mrow></math></td><td>{0.3, 0.5, 0.7}默认<i>Cp</i><sub>default</sub>为30</td></tr><tr><td><br /><i>λ</i></td><td>计算结点性能指数差异:<math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>Ρ</mi><mi>f</mi><msub><mrow></mrow><mrow><mtext>d</mtext><mtext>e</mtext><mtext>f</mtext><mtext>a</mtext><mtext>u</mtext><mtext>l</mtext><mtext>t</mtext></mrow></msub><mo>×</mo><mrow><mo> (</mo><mrow><mn>1</mn><mo>-</mo><mi>λ</mi></mrow><mo>) </mo></mrow><mo>≤</mo><mi>Ρ</mi><mi>f</mi><msub><mrow></mrow><mi>i</mi></msub><mo>≤</mo><mi>Ρ</mi><mi>f</mi><msub><mrow></mrow><mrow><mtext>d</mtext><mtext>e</mtext><mtext>f</mtext><mtext>a</mtext><mtext>u</mtext><mtext>l</mtext><mtext>t</mtext></mrow></msub><mo>×</mo><mrow><mo> (</mo><mrow><mn>1</mn><mo>+</mo><mi>λ</mi></mrow><mo>) </mo></mrow></mrow></math></td><td>{0.3, 0.5, 0.7}默认<i>Pf</i><sub>default</sub>为8</td></tr><tr><td><br /><i>Density</i></td><td>边密度参数:<math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>D</mi><mi>e</mi><mi>n</mi><mi>s</mi><mi>i</mi><mi>t</mi><mi>y</mi><mo>=</mo><mi>E</mi><mo>.</mo><mi>s</mi><mi>i</mi><mi>z</mi><mi>e</mi><mo>/</mo><mrow><mo> (</mo><mrow><mi>Τ</mi><mi>a</mi><mi>s</mi><mi>k</mi><mi>Ν</mi><mi>u</mi><mi>m</mi><mi>b</mi><mi>e</mi><mi>r</mi><mo>!</mo></mrow><mo>) </mo></mrow></mrow></math></td><td>{0.2, 0.5, 0.8}</td></tr><tr><td><br /><i>CCR</i></td><td>通信计算比:集群平均通信速率与集群计算结点平均计算能力数值的比例, 即 ( (<i>v</i><sub>1</sub>+<i>v</i><sub>2</sub>) /2) / (∑<i>Pf</i><sub><i>m</i></sub>/<i>SlotNumber</i>) </td><td>{0.2, 0.5, 0.8, 1, 2}<br />默认1≤<i>v</i><sub>1</sub>/<i>v</i><sub>2</sub>&lt;2</td></tr><tr><td><br /><i>β</i></td><td>工作流中Compute_intense Task和集群中Accelerated Pool的比重</td><td>{0.3, 0.5, 0.8}</td></tr></table>
                    <form name="form" action="/kxreader/Detail/DownloadReportExcel" method="POST" style="display:inline">
                        <input type="hidden" name="hidTable" value="" />
                        <input type="hidden" name="hidFileName" value="" />
                    </form>
                    <p class="img_note"></p>
                    <p class="img_note"></p>
                </div>
                <div class="p1">
                    <p id="122">通过实验数据可以清楚地看出, 本文所提出的2-MRHS算法较FIFO、MRWS、2-MRWS具有相对更为理想的Makespan, 和其它算法相比也具有更好的调度率和稳定性。</p>
                </div>
                <div class="area_img" id="123">
                    <p class="img_tit"><b>表2 各调度算法的调度长度对比</b> % <a class="downexcel" onclick="DownLoadReportExcel(this)">导出到EXCEL</a></p>
                    <p class="img_tit"><b>Table 2 Comparisons of <i>Makespan</i> between scheduling algorithms</b></p>
                    <p class="img_note"></p>
                    <table id="123" border="1"><tr><td rowspan="2" colspan="2"><br />算法<i>A</i></td><td colspan="4"><br />算法<i>B</i></td></tr><tr><td><br />2-MRHS</td><td>FIFO</td><td>MRWS</td><td>2-MRWS</td></tr><tr><td><br /></td><td>Better</td><td></td><td>70.40</td><td>22.00</td><td>31.40</td></tr><tr><td><br />2-MRHS</td><td>Worse</td><td>*</td><td>6.50</td><td>8.30</td><td>3.20</td></tr><tr><td><br /></td><td>Equal</td><td></td><td>23.10</td><td>69.60</td><td>65.40</td></tr><tr><td><br /></td><td>Better</td><td>6.50</td><td></td><td>11.30</td><td>13.80</td></tr><tr><td><br />FIFO</td><td>Worse</td><td>70.40</td><td>*</td><td>67.90</td><td>65.80</td></tr><tr><td><br /></td><td>Equal</td><td>23.10</td><td></td><td>20.80</td><td>20.40</td></tr><tr><td><br /></td><td>Better</td><td>8.30</td><td>67.90</td><td></td><td>20.46</td></tr><tr><td><br />MRWS</td><td>Worse</td><td>22.00</td><td>11.30</td><td>*</td><td>9.17</td></tr><tr><td><br /></td><td>Equal</td><td>69.60</td><td>20.80</td><td></td><td>70.37</td></tr><tr><td><br /></td><td>Better</td><td>3.20</td><td>65.80</td><td>9.17</td><td></td></tr><tr><td><br />2-MRWS</td><td>Worse</td><td>31.40</td><td>13.80</td><td>20.46</td><td>*</td></tr><tr><td><br /></td><td>Equal</td><td>65.40</td><td>20.40</td><td>70.37</td><td></td></tr></table>
                    <form name="form" action="/kxreader/Detail/DownloadReportExcel" method="POST" style="display:inline">
                        <input type="hidden" name="hidTable" value="" />
                        <input type="hidden" name="hidFileName" value="" />
                    </form>
                    <p class="img_note"></p>
                    <p class="img_note"></p>
                </div>
                <h3 id="124" name="124" class="anchor-tag"><b>6 结束语</b></h3>
                <div class="p1">
                    <p id="125">本文首先结合MapReduce工作流提出了2级DAG模型, 并由此提出基于2级优先级排序的MapReduce工作流异构调度算法。不仅实现了对由一系列具有先后序限定关系的MapReduce作业的自动化调度, 也在一定程度上提高了调度效率, 缩短了完成时间, 具有更高的优化比和更好的稳定性<citation id="186" type="reference"><link href="166" rel="bibliography" /><link href="172" rel="bibliography" /><sup>[<a class="sup">10</a>,<a class="sup">10</a>]</sup></citation>。然而, 由于时间仓促, 本文只对预测MapReduce工作流进行调度, 未考虑动态集群和调度容错性等问题, 将在日后进一步研究。</p>
                </div>

        <!--brief end-->
        
        <!--conten left  end-->
        <!--增强附件-->
                        <h3 class="anchor-tag">作者图片</h3>
                <div class="anchor-wrap">
                        <p>
                                    <div class="anchor-box">
                                        <span class="anchor-a"><image id="143" type="formula" href="images/JSJK201908003_14300.jpg" display="inline" placement="inline"><alt></alt></image></span>
                                        <span class="anchor-a">王宇新</span>
                                    </div>
                                    <div class="anchor-box">
                                        <span class="anchor-a"><image id="144" type="formula" href="images/JSJK201908003_14400.jpg" display="inline" placement="inline"><alt></alt></image></span>
                                        <span class="anchor-a">王飞</span>
                                    </div>
                                    <div class="anchor-box">
                                        <span class="anchor-a"><image id="145" type="formula" href="images/JSJK201908003_14500.jpg" display="inline" placement="inline"><alt></alt></image></span>
                                        <span class="anchor-a">王冠</span>
                                    </div>
                                    <div class="anchor-box">
                                        <span class="anchor-a"><image id="146" type="formula" href="images/JSJK201908003_14600.jpg" display="inline" placement="inline"><alt></alt></image></span>
                                        <span class="anchor-a">郭禾</span>
                                    </div>
                        </p>
                </div>


        <!--reference start-->
            <div class="reference anchor-tag" id="a_bibliography">
                    <h3>参考文献</h3>
                                        <p id="148">
                            <a id="bibliography_1" target="_blank" href="/kcms/detail/detail.aspx?dbcode=SJCM&amp;filename=SJCM13091000030554&amp;v=MDU2NTc0OUZaT2dQQ1hrOW9CTVQ2VDRQUUgvaXJSZEdlcnFRVE1ud1plWnVIeWptVUxmSUpsNFhheFk9TmlmSVk3SzdIdGpOcg==&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDY2UXI4RUJreUIrY05aSWZBQVJmWT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[1]</b> Dean J, Ghemawat S.MapReduce:Simplified data processing on large clusters [J].Communications of the ACM, 2008, 51 (1) :107-113.
                            </a>
                        </p>
                        <p id="150">
                            <a id="bibliography_2" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Computers and intractability: a guide to the theory of NP-completeness">

                                <b>[2]</b> Johnson D, Garey M.Computers and intractability:A guide to the theory of MP-completeness[M].New York:Freeman&amp;Co, 1979.
                            </a>
                        </p>
                        <p id="152">
                            <a id="bibliography_3" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Improving mapreduce performance in heterogeneous environments">

                                <b>[3]</b> Zaharia M, Konwinski A, Joseph A D, et al.Improving MapReduce performance in heterogeneous environments[C]//Proc of the 8th USENIX Conference on Operating Systems Design and Implementation, 2008:29-42.
                            </a>
                        </p>
                        <p id="154">
                            <a id="bibliography_4" target="_blank" href="/kcms/detail/detail.aspx?dbcode=SSJD&amp;filename=SSJD13120500002249&amp;v=MjEwMjlPc05Ebmd3b0JNVDZUNFBRSC9pclJkR2VycVFUTW53WmVadUh5am1VTGZJSmw0WGF4WT1OajdCYXJLN0g5UE1xbzlGWg==&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDY2UXI4RUJreUIrY05aSWZBQVJmWT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[4]</b> Tang Zhuo, Zhou Jun-qing, Li Ken-li, et al.A MapReduce task scheduling algorithm for deadline constraints [J].Cluster Computing, 2013, 16 (4) :651-662.
                            </a>
                        </p>
                        <p id="156">
                            <a id="bibliography_5" target="_blank" href="http://scholar.cnki.net/result.aspx?q=A genetic algorithm-based job scheduling model for big data analytics">

                                <b>[5]</b> Lu Qing-hua, Li Shan-shan, Zhang Wei-shan, et al.A genetic algorithm-based job scheduling model for big data analytics [J].EURASIP Journal on Wireless Communications and Networking, 2016 (1) :Article No.152.
                            </a>
                        </p>
                        <p id="158">
                            <a id="bibliography_6" >
                                    <b>[6]</b>
                                 Pan Jia-yi, Wang Fang, Yang Jing-yi, et al.A load-adaptive feedback scheduling strategy for heterogeneous Hadoop cluster[J].Computer Engineering &amp; Science, 2017, 39 (3) :413-423. (in Chinese) 
                            </a>
                        </p>
                        <p id="160">
                            <a id="bibliography_7" target="_blank" href="http://scholar.cnki.net/result.aspx?q=An optimized Map Reduce workflow scheduling algorithm for heterogeneous computing">

                                <b>[7]</b> Zhuo Tang, Min Liu, Ammar A, et al.An optimized MapReduce workflow scheduling algorithm for heterogeneous computing [J].The Journal of Supercomputing, 2016, 72 (6) :2059-2079.
                            </a>
                        </p>
                        <p id="162">
                            <a id="bibliography_8" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Performance-effective and low-complexity task scheduling for heterogeneous computing">

                                <b>[8]</b> Topcuouglu H, Hariri S, Wu M Y.Performance-effective and low-complexity task scheduling for heterogeneous computing [J].IEEE Transactions on Parallel and Distributed Systems, 2002, 13 (3) :260-274.
                            </a>
                        </p>
                        <p id="164">
                            <a id="bibliography_9" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JSJY201701005&amp;v=MDU2NDF6N0JkN0c0SDliTXJvOUZZWVFLREg4NHZSNFQ2ajU0TzN6cXFCdEdGckNVUkxPZVplUm1GeTdsVUw3TUw=&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDY2UXI4RUJreUIrY05aSWZBQVJmWT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[9]</b> Wang Guan, Wang Yu-xin, Chen Xin, et al.Heterogeneous scheduling algorithm with immediate successor finish time [J].Journal of Computer Applications, 2017, 37 (1) :12-17. (in Chinese) 
                            </a>
                        </p>
                        <p id="166">
                            <a id="bibliography_10" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Research on task scheduling method based on DAG in big data environment">

                                <b>[10]</b> Wang Fei.Research on task scheduling method based on DAG in big data environment [D].Dalian:Dalian University of Technology, 2018. (in Chinese) 
                            </a>
                        </p>
                        <p id="168">
                            <a id="bibliography_6" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JSJK201703002&amp;v=MDg1NzBSbUZ5N2xVTDdNTHo3QlpiRzRIOWJNckk5RlpvUUtESDg0dlI0VDZqNTRPM3pxcUJ0R0ZyQ1VSTE9lWmU=&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDY2UXI4RUJreUIrY05aSWZBQVJmWT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[6]</b> 潘佳艺, 王芳, 杨静怡, 等.异构Hadoop集群下的负载自适应反馈调度策略[J].计算机工程与科学, 2017, 39 (3) :413-423.
                            </a>
                        </p>
                        <p id="170">
                            <a id="bibliography_9" >
                                    <b>[9]</b>
                                 王冠, 王宇新, 陈鑫, 等.基于直接后继节点完成时间的异构调度算法[J].计算机应用, 2017, 37 (1) :12-17.
                            </a>
                        </p>
                        <p id="172">
                            <a id="bibliography_10" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CMFD&amp;filename=1018868401.nh&amp;v=MzE4MDRGcnUrRnRYTXJwRWJQSVFLREg4NHZSNFQ2ajU0TzN6cXFCdEdGckNVUkxPZVplUm1GeTdsVUw3TVZGMjY=&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDY2UXI4RUJreUIrY05aSWZBQVJmWT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[10]</b> 王飞.大数据环境下基于DAG的任务调度研究[D].大连:大连理工大学, 2018.
                            </a>
                        </p>
            </div>
        <!--reference end-->
        <!--footnote start-->
        <!--footnote end-->



    </div>

        <input id="fileid" type="hidden" value="JSJK201908003" />
        <input id="dpi" type="hidden" value="300" />
    </div>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?6e967eb120601ea41b9d312166416aa6";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
</script>

    


<input id="hid_uid" name="hid_uid" type="hidden" value="WEEvREcwSlJHSldRa1FhdkJkVG5hVDY2UXI4RUJreUIrY05aSWZBQVJmWT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
<input id="hid_kLogin_headerUrl" name="hid_kLogin_headerUrl" type="hidden" value="/KLogin/Request/GetKHeader.ashx%3Fcallback%3D%3F" />
<input id="hid_kLogin_footerUrl" name="hid_kLogin_footerUrl" type="hidden" value="/KLogin/Request/GetKFooter.ashx%3Fcallback%3D%3F" />
<div class="btn-link" style="display: none"><a target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JSJK201908003&amp;v=MjAwMzQ3bFVMN01MejdCWmJHNEg5ak1wNDlGWjRRS0RIODR2UjRUNmo1NE8zenFxQnRHRnJDVVJMT2VaZVJtRnk=&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDY2UXI4RUJreUIrY05aSWZBQVJmWT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">知网节</a></div>
<div class="popflow" id="popupTips" style="display: none;">
    <div class="popflowArr"></div>
    <div class="popflowCot">
        <div class="hd"><a href="javascript:void(0);" onclick="$('#popupTips').hide();$('#popupmsg').html('')" class="close">X</a></div>
        <div class="bd">
            <p class="mes" id="popupmsg" name="popupmsg"></p>
          
        </div>
    </div>
</div>
<input type="hidden" id="myexport" value="//kns.cnki.net" />

<input type="hidden" id="KPCAPIPATH" value="//ishufang.cnki.net" />
<input type="hidden" id="CitedTimes" value="" />
<div class="link" id="GLSearch" style="display: none;">
    <i class="icon-trangle"></i>
    <div class="inner">
        <a class="icon" id="copytext">复制</a>
        <a class="icon" target="_blank" onclick="searchCRFD(this)">工具书搜索</a>
    </div>
</div>




<input id="hidVirtualPath" name="hidVirtualPath" type="hidden" value="/kxreader" />
<script src="/kxreader/bundles/detail?v=-ULdk-c6FkZHtJA2KAXPgHnyA8mtgyPnBde_C2VZ2BY1"></script>

<script src="/kxreader/Scripts/layer.min.js" type="text/javascript"></script>

<div id="footerBox" class="rootw footer">
</div>
<script>
    if (typeof FlushLogin == 'function') {
        FlushLogin();
    }
    modifyEcpHeader(true);
</script>

<!--图片放大功能 start-->
<script src="/kxreader/bundles/imagebox?v=W4phPu9SNkGcuPeJclikuVE3PpRyIW_gnfjm_19nynI1"></script>

<script type="text/javascript">
    $(function () {
        var j = $.noConflict();
        j(function () {
            j(".zoom-in,.btn-zoomin").imgbox({
                'alignment': 'center',
                'allowMultiple': false,
                'overlayShow': true
            });
        })
    });
</script>
<!--图片放大功能 end-->
<div class="fixedbar">
    <div class="backtop hiddenV" id="backtop">
        <a id="backTopSide" href="javascript:scroll(0,0);" title=""></a>
    </div>
</div>
<script type="text/javascript" src="/kxreader/Scripts/MathJax-2.6-latest/MathJax.js?config=MML_HTMLorMML-full"></script>

</body>
</html>
