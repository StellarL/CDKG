<!DOCTYPE html>
<html>
<head>
    <title>全文阅读--XML全文阅读--中国知网</title>
    <link rel="icon" href="/kxreader/favicon.ico" />
    <link rel="shortcut Icon" href="/kxreader/favicon.ico" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="keywords" content="文献 XML KBASE CNKI 中国知网" />
    <meta name="description" content="XML文献检索" />
    <link href="/kxreader/Content/css/detail?v=NOOK-mvTMnxl11s6oPYV0boPXN3iP4N7Rc-A56nk4KI1" rel="stylesheet"/>

    <script type="text/javascript">
        var APPPATH = '/kxreader';
    </script>
</head>

<body>
    
<script type="text/javascript" src="//login.cnki.net/TopLogin/api/loginapi/get?type=top&amp;localCSS=&amp;returnurl=%2f%2fkns.cnki.net%2fKXReader%2fDetail%3fTIMESTAMP%3d637141010993881250%26DBCODE%3dCJFD%26TABLEName%3dCJFDLAST2019%26FileName%3dZGWT201902043%26RESULT%3d1%26SIGN%3dKqo6BkOSafHAoV5bhgYBOt8PR8M%253d"></script>

<div id="headerBox" class="header">
    <div class="topbar">
        <div class="textalign">
            <a href="/kxreader/Detail?dbcode=CJFD&amp;filename=ZGWT201902043&amp;align=md">
                <i class="icon-cen active" title="居中对齐"></i>
            </a>
            <a href="/kxreader/Detail?dbcode=CJFD&amp;filename=ZGWT201902043&amp;align=lt">
                <i class="icon-left " title="左对齐"></i>
            </a>
        </div>
        <h6 class="free-tip"><i class="icon"></i>HTML阅读开放试用阶段，欢迎体验！</h6>
    </div>
</div>

    



<div class="btn-link" style="display: none"><a target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=ZGWT201902043&amp;v=MjQxOTc0UUtESDg0dlI0VDZqNTRPM3pxcUJ0R0ZyQ1VSN3FmWnVabkZ5N21WcnZPUHlyY2VyRzRIOWpNclk5Qlo=&amp;uid=WEEvREcwSlJHSldRa1FhdkJtNEYxa3hESGJHemFFMEVVb1VEa0hsL0w5az0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">知网节</a></div>

    <div class="main">

        

    <div class="sidebar-a">
        <!--sidebar start-->
        <div class="sidenav">
            <div class="arrow"><span></span></div>
            <!--sidebar_list start-->
            <dl class="sidenav-list">
                    <dt class="tit">目录结构</dt>
                            <dd class="guide">
                                    <p><a href="#" data-title="文内图表 ">文内图表</a><i></i></p>
                                                                    <ul class="contentbox">
                                                <li><a href="#29" data-title="&lt;b&gt;图1-65&lt;/b&gt; nQuery Advanced 关于例1-27样本量估计的参数设置与计算结果"><b>图1-65</b> nQuery Advanced 关于例1-27样本量估计的参数设置与计算结果</a></li>
                                                <li><a href="#70" data-title="&lt;b&gt;图1-66a&lt;/b&gt; SAS 9.4关于例1-27样本量估计的参数设置与计算结果 (power=80%) "><b>图1-66a</b> SAS 9.4关于例1-27样本量估计的参数设置与计算结果 (power=80%) </a></li>
                                                <li><a href="#71" data-title="&lt;b&gt;图1-66b&lt;/b&gt; SAS 9.4关于例1-27样本量估计的参数设置与计算结果 (power=90%) "><b>图1-66b</b> SAS 9.4关于例1-27样本量估计的参数设置与计算结果 (power=90%) </a></li>
                                                <li><a href="#111" data-title="&lt;b&gt;图1-67a&lt;/b&gt; nQuery Advanced 关于例1-28样本量估计的参数设置与计算结果"><b>图1-67a</b> nQuery Advanced 关于例1-28样本量估计的参数设置与计算结果</a></li>
                                                <li><a href="#112" data-title="&lt;b&gt;图1-67b&lt;/b&gt; nQuery Advanced 关于例1-28样本量估计的参数设置与计算结果 (均值矩阵) "><b>图1-67b</b> nQuery Advanced 关于例1-28样本量估计的参数设置与计算结果 (均值矩阵) </a></li>
                                                <li><a href="#113" data-title="&lt;b&gt;图1-67c&lt;/b&gt; nQueryAdvanced 关于例1-28样本量估计的参数设置与计算结果 (协方差矩阵) "><b>图1-67c</b> nQueryAdvanced 关于例1-28样本量估计的参数设置与计算结果 (协方差矩阵) </a></li>
                                                <li><a href="#338" data-title="&lt;b&gt;图1-68&lt;/b&gt; SAS 9.4关于例1-28样本量估计的参数设置与计算结果"><b>图1-68</b> SAS 9.4关于例1-28样本量估计的参数设置与计算结果</a></li>
                                    </ul>
                            </dd>
                                    <dd class="guide">
                                        <h6>
                                            <p><a href="#a_bibliography">参考文献</a> </p>
                                        </h6>
                                    </dd>

            </dl>
        </div>
        <!--sidebar end-->
        &nbsp;
        <!--此处有一空格符 勿删-->
    </div>

                <div class="sidebar-b three-collumn" style="width:0;">
            <div class="refer" style="width: 0;">
                <div class="arrow off" title="参考文献"><span></span></div>
                <div class="js-scrollbox" >
                    
                    <div class="subbox active">
                        <h4>
                            <span class="tit">参考文献</span>
                            <a class="close" href="javascript:void(0)">x</a>
                        </h4>
                        <div class="side-scroller">
                            <ul class="refer-list">
                                <li id="392">


                                    <a id="bibliography_1" title=" Keppel G. Design and Analysis-A Researcher&#39;s Handbook. Third Edition. Prentice Hall:1991." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Design and Analysis-A Researcher&amp;#39;&amp;#39;s Handbook">
                                        <b>[1]</b>
                                         Keppel G. Design and Analysis-A Researcher&#39;s Handbook. Third Edition. Prentice Hall:1991.
                                    </a>
                                </li>
                                <li id="394">


                                    <a id="bibliography_2" title="陈平雁.临床试验中样本量确定的统计学考虑.中国卫生统计, 2015, 32 (4) :727-731." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=ZGWT201504058&amp;v=MDAxNDR2UjRUNmo1NE8zenFxQnRHRnJDVVI3cWZadVpuRnk3bVZydk9QeXJjZXJHNEg5VE1xNDlBYklRS0RIODQ=&amp;uid=WEEvREcwSlJHSldRa1FhdkJtNEYxa3hESGJHemFFMEVVb1VEa0hsL0w5az0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[2]</b>
                                        陈平雁.临床试验中样本量确定的统计学考虑.中国卫生统计, 2015, 32 (4) :727-731.
                                    </a>
                                </li>
                                <li id="396">


                                    <a id="bibliography_3" title=" Muller KE, Barton CN. Approximate Power for Repeated-Measures ANOVA Lacking Sphericity. Publications of the American Statistical Association, 1989, 84 (406) :549-555." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Approximate Power for Repeated-Measures ANOVA Lacking Sphericity">
                                        <b>[3]</b>
                                         Muller KE, Barton CN. Approximate Power for Repeated-Measures ANOVA Lacking Sphericity. Publications of the American Statistical Association, 1989, 84 (406) :549-555.
                                    </a>
                                </li>
                                <li id="398">


                                    <a id="bibliography_4" title=" Muller KE, Lavange LM, Ramey SL, et al. Power Calculations for General Linear M ultivariate M odels Including Repeated M easures Applications. Journal of the American Statistical Association, 1992, 87 (420) :1209-1226." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Power calculations for general linear multivariatemodels including repeated measures applications">
                                        <b>[4]</b>
                                         Muller KE, Lavange LM, Ramey SL, et al. Power Calculations for General Linear M ultivariate M odels Including Repeated M easures Applications. Journal of the American Statistical Association, 1992, 87 (420) :1209-1226.
                                    </a>
                                </li>
                            </ul>
                            <div style='display: none;' class="zqscroller" >
                                <h4 class="">附加材料</h4>
                                <ul></ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            &nbsp;
            <!--此处有一空格符 勿删-->
        </div>

        
    <div class="content">



        <!--tips start-->
                            <div class="tips">
                    <a href="http://navi.cnki.net/KNavi/JournalDetail?pcode=CJFD&amp;pykm=ZGWT" target="_blank">中国卫生统计</a>
                2019,36(02),314-320             </div>
        <!--tips end-->
            <div class="top-title">
                <h1 class="title">
                    <span class="vm"><b>样本量估计及其在</b>nQuery<b>和</b>SAS<b>软件上的实现</b>——均数比较 (九) </span>
                                    </h1>

            </div>
                        <h2>
                                <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=au&amp;skey=%E7%8E%8B%E5%B2%A9&amp;code=35361941&amp;uid=WEEvREcwSlJHSldRa1FhdkJtNEYxa3hESGJHemFFMEVVb1VEa0hsL0w5az0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">王岩</a>
                                <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=au&amp;skey=%E9%92%B1%E8%8B%A5%E8%BF%9C&amp;code=41824894&amp;uid=WEEvREcwSlJHSldRa1FhdkJtNEYxa3hESGJHemFFMEVVb1VEa0hsL0w5az0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">钱若远</a>
                                <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=au&amp;skey=%E9%99%88%E5%B9%B3%E9%9B%81&amp;code=08022023&amp;uid=WEEvREcwSlJHSldRa1FhdkJtNEYxa3hESGJHemFFMEVVb1VEa0hsL0w5az0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">陈平雁</a>
                </h2>
                    <h2>
                    <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=in&amp;skey=%E5%8D%97%E6%96%B9%E5%8C%BB%E7%A7%91%E5%A4%A7%E5%AD%A6%E5%85%AC%E5%85%B1%E5%8D%AB%E7%94%9F%E5%AD%A6%E9%99%A2%E7%94%9F%E7%89%A9%E7%BB%9F%E8%AE%A1%E5%AD%A6%E7%B3%BB&amp;code=0060982&amp;uid=WEEvREcwSlJHSldRa1FhdkJtNEYxa3hESGJHemFFMEVVb1VEa0hsL0w5az0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">南方医科大学公共卫生学院生物统计学系</a>
            </h2>

        
<div class="link">
    <a id="aexport" class="icon icon-output"  onclick="" href="javascript:void(0);"><i></i>导出/参考文献</a>
    
    <span class="shareBoard" onmouseover="$('#sharedet').show();$('#this').addClass('shareBoardCUR')" onmouseout="$('#sharedet').hide();$('#this').removeClass('shareBoardCUR')">
        <a class="icon icon-share" href="#"><i></i>分享<em></em></a>
        <ul class="shareHide" id="sharedet" style="display: none;">
            <li><a title="复制链接" class="copy" onclick="" href="#"><i></i>复制链接</a></li>
            <li><a title="分享到新浪微博" class="xl" onclick="" href="javascript:common.ShareAction('xl');"><i></i>新浪微博</a></li>
            <li>
                <a title="分享到微信" class="wx" onclick="" href="#"><i></i>微信扫一扫</a>
                <div class="qrcode"><img src='' alt='' /></div>
            </li>
        </ul>

    </span>
    
    <a id="RefTrack" title="创建引文跟踪" class="icon icon-track" onclick="" href="javascript:void(0);"> <i></i>创建引文跟踪 </a>
    <a id="ashoucang" title="收藏" class="icon icon-favor" onclick="" href="javascript:void(0);"><i></i>收藏</a>
    <a class="icon icon-print" onclick="window.print();" href="javascript:void(0);"><i></i>打印</a>
    
    <!--版本切换 end-->
</div>
                                
        <!--brief start-->
        
            <div class="brief">
                    <p>
                                            </p>
                
                    <p>

                            <b>基金：</b>
                                                        <span>国家自然科学基金 (81673270);</span>
                    </p>
            </div>
                                                        

        <!--brief start-->
                        <div class="p1">
                    <p id="10">1.3 多样本的均数比较</p>
                </div>
                <div class="p1">
                    <p id="11">1.3.1 差异性检验</p>
                </div>
                <div class="p1">
                    <p id="12">1.3.1.4 协方差分析 (ANCOVA) </p>
                </div>
                <div class="p1">
                    <p id="13">方法:Keppel (1991) <citation id="400" type="reference"><link href="392" rel="bibliography" /><sup>[<a class="sup">1</a>]</sup></citation>给出的协方差分析样本量估计方法是建立在自由度为<i>G</i>-1, <i>N</i>-<i>G</i>-<i>c</i>, 非中心参数为<mathml id="14"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mover accent="true"><mi>n</mi><mo>¯</mo></mover><mi>G</mi><mi>V</mi><mo>/</mo><mo stretchy="false">[</mo><mo stretchy="false"> (</mo><mn>1</mn><mo>-</mo><mi>ρ</mi><msup><mrow></mrow><mn>2</mn></msup><mo stretchy="false">) </mo><mi>σ</mi><msup><mrow></mrow><mn>2</mn></msup><mo stretchy="false">]</mo></mrow></math></mathml>的非中心F分布上。其检验效能的计算公式为:</p>
                </div>
                <div class="p1">
                    <p id="15" class="code-formula">
                        <mathml id="15"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mn>1</mn><mo>-</mo><mi>β</mi><mo>=</mo><mn>1</mn><mo>-</mo><mtext>Ρ</mtext><mtext>r</mtext><mtext>o</mtext><mtext>b</mtext><mi>F</mi><mo stretchy="false"> (</mo><mi>F</mi><msub><mrow></mrow><mrow><mo stretchy="false"> (</mo><mn>1</mn><mo>-</mo><mi>α</mi><mo>, </mo><mi>G</mi><mo>-</mo><mn>1</mn><mo>, </mo><mi>Ν</mi><mo>-</mo><mi>G</mi><mo>-</mo><mi>c</mi><mo stretchy="false">) </mo></mrow></msub><mo>, </mo><mi>G</mi><mo>-</mo><mn>1</mn><mo>, </mo><mi>Ν</mi><mo>-</mo><mi>G</mi><mo>-</mo><mi>c</mi><mo>, </mo><mover accent="true"><mi>n</mi><mo>¯</mo></mover><mi>G</mi><mi>V</mi><mo>/</mo><mo stretchy="false">[</mo><mo stretchy="false"> (</mo><mn>1</mn><mo>-</mo><mi>ρ</mi><msup><mrow></mrow><mn>2</mn></msup><mo stretchy="false">) </mo><mi>σ</mi><msup><mrow></mrow><mn>2</mn></msup><mo stretchy="false">]</mo><mo stretchy="false">) </mo><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mrow><mtext> </mtext><mtext> </mtext><mtext> </mtext></mrow><mo stretchy="false"> (</mo><mn>1</mn><mo>-</mo><mn>4</mn><mn>3</mn><mo stretchy="false">) </mo></mrow></math></mathml>
                    </p>
                </div>
                <div class="p1">
                    <p id="16">式中, N代表总样本量, G代表组数, c代表协变量个数, ρ<sup>2</sup>代表多变量决定系数 (<i>coefficient of multiple determination</i>) , 反映协变量与结局变量间的关联强度, 可由R<sup>2</sup>估计得到, σ代表组内标准差, V代表各水平均数的方差, 其计算公式为<i>V</i>=∑<mathml id="17"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msubsup><mrow></mrow><mn>1</mn><mi>G</mi></msubsup></mrow></math></mathml><i>r</i><sub><i>i</i></sub> (<i>μ</i><sub><i>i</i></sub>-) <sup>2</sup>/∑<mathml id="18"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msubsup><mrow></mrow><mn>1</mn><mi>G</mi></msubsup></mrow></math></mathml><i>r</i><sub><i>i</i></sub>, 其中<i>r</i><sub><i>i</i></sub>代表每组的样本量与第一组 (参照组) 的比值, <i>n</i><sub><i>i</i></sub>和<i>μ</i><sub><i>i</i></sub>分别代表第<i>i</i>组的样本量和均值, <mathml id="19"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mover accent="true"><mi>n</mi><mo>¯</mo></mover><mo>=</mo><mi>Ν</mi><mo>/</mo><mi>G</mi><mo>, </mo><mover accent="true"><mi>μ</mi><mo>¯</mo></mover><mo>=</mo><mstyle displaystyle="true"><msubsup><mo>∑</mo><mn>1</mn><mi>G</mi></msubsup><mo stretchy="false"> (</mo></mstyle><mi>n</mi><msub><mrow></mrow><mi>i</mi></msub><mi>μ</mi><msub><mrow></mrow><mi>i</mi></msub><mo>/</mo><mi>Ν</mi><mo stretchy="false">) </mo></mrow></math></mathml>。</p>
                </div>
                <div class="p1">
                    <p id="20">计算样本量时, 先设定样本量初始值, 然后迭代样本量直到所得的检验效能满足设定值为止, 此时的样本量即研究所需的样本量<citation id="401" type="reference"><link href="394" rel="bibliography" /><sup>[<a class="sup">2</a>]</sup></citation>。</p>
                </div>
                <div class="p1">
                    <p id="21">【例1-27】某研究欲比较三种不同教学干预方法 (有声思维教学法、指导性阅读思维教学法、指导性阅读教学法) 对小学四年级学生阅读理解能力的影响。采用平衡设计, 在干预前后分别评估受试者的错误检测任务 (error detection task, EDT) 得分。以干预前EDT得分和干预后理解监控问卷 (comprehension monitoring questionnaire) 得分为2个协变量, 干预后EDT得分为因变量进行协方差分析。根据既往研究数据, 三组均值分别为8.2220, 9.8148, 6.1904, 标准差为2.3788, <i>ρ</i><sup>2</sup>为0.4434, 设定检验水准为0.05, 试以检验效能分别为0.8和0.9进行样本量估计。</p>
                </div>
                <div class="p1">
                    <p id="22">nQuery Advanced实现:设定检验水准<i>α</i>=0.05;检验效能分别取80%和90%。依据上述基础数据可知, <i>G</i>=3, <i>c</i>=2, <i>ρ</i><sup>2</sup>=0.4344, <i>σ</i>=2.3788, <i>r</i><sub>1</sub>=<i>r</i><sub>2</sub>=<i>r</i><sub>3</sub>=1, <i>μ</i>={<i>μ</i><sub>1</sub>, <i>μ</i><sub>2</sub>, <i>μ</i><sub>3</sub>}={8.2220, 9.8148, 6.1904}计算可得<i>V</i>=2.20, 在nQueryAdvanced 主菜单选择:</p>
                </div>
                <div class="p1">
                    <p id="23">Design:⊙Fixed Term</p>
                </div>
                <div class="p1">
                    <p id="24">Goal:⊙Means</p>
                </div>
                <div class="p1">
                    <p id="25">No.of Groups:⊙&gt;Two</p>
                </div>
                <div class="p1">
                    <p id="26">Analysis Method:⊙Test</p>
                </div>
                <div class="p1">
                    <p id="27">方法框中选择Analysis of Covariance (ANCOVA) 。</p>
                </div>
                <div class="p1">
                    <p id="28">在弹出的样本量计算窗口将各参数键入, 如图1-65所示, 检验效能取80%的结果<i>N</i>=18, 即总样本量为18例, 每组6例。检验效能取90%的结果<i>N</i>=22, 即总样本量为22例, 三组例数分别为8例、7例和7例 (因总例数不是组数的整倍数, 故各组例数不绝对相等) 。</p>
                </div>
                <div class="area_img" id="29">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/ZGWT201902043_029.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJtNEYxa3hESGJHemFFMEVVb1VEa0hsL0w5az0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图1-65 nQuery Advanced 关于例1-27样本量估计的参数设置与计算结果" src="Detail/GetImg?filename=images/ZGWT201902043_029.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJtNEYxa3hESGJHemFFMEVVb1VEa0hsL0w5az0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit"><b>图1-65</b> nQuery Advanced 关于例1-27样本量估计的参数设置与计算结果  <a class="btn-zoomin" href="Detail/GetImg?filename=images/ZGWT201902043_029.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJtNEYxa3hESGJHemFFMEVVb1VEa0hsL0w5az0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="p1">
                    <p id="30">SAS 9.4软件实现:</p>
                </div>
                <div class="p1">
                    <p id="31">%let u={8.2220 9.8148 6.1904}; /*各组均值*/</p>
                </div>
                <div class="p1">
                    <p id="32">%let r={1 1 1}; /*各组样本量与第一组 (参照组) 样本量的比值*/</p>
                </div>
                <div class="p1">
                    <p id="33">proc IML;</p>
                </div>
                <div class="p1">
                    <p id="34">start MGT4_1 (a, G, sd, c, R2, power) ;</p>
                </div>
                <div class="p1">
                    <p id="35">error=0;</p>
                </div>
                <div class="p1">
                    <p id="36">if ( a&gt;=1 | a&lt;=0 ) then do; error=1; print "Error" "Test significance Level must be in 0-1"; end;</p>
                </div>
                <div class="p1">
                    <p id="37">if ( sd&lt;=0 ) then do; error=1; print "Error" "Common standard deviation must be &gt;=0"; end;</p>
                </div>
                <div class="p1">
                    <p id="38">if (G&lt;=0 | ceil (G) ^=G) then do; error=1; print "Error" "The Number of groups must be positive integer "; end;</p>
                </div>
                <div class="p1">
                    <p id="39">if (c&lt;=0 | ceil (c) ^=c) then do; error=1; print "Error" "The Number of coveriates must be positive integer "; end;</p>
                </div>
                <div class="p1">
                    <p id="40">if (power&gt;=100 | power&lt;1) then do; error=1; print "error" "Power (%) must be in 1-100"; end;</p>
                </div>
                <div class="p1">
                    <p id="41">if (R2&gt;1 | R2&lt;0) then do; error=1; print "error" "R_squared value must be in 0-1";end;</p>
                </div>
                <div class="p1">
                    <p id="42">if (error=1) then stop;</p>
                </div>
                <div class="p1">
                    <p id="43">if (error=0) then do;</p>
                </div>
                <div class="p1">
                    <p id="44">n1=ceil (c/G+1) ; n=n1#&amp;r.;sum_N=n[1, +]-0.01;</p>
                </div>
                <div class="p1">
                    <p id="45">do until (pw&gt;=power/100) ;</p>
                </div>
                <div class="p1">
                    <p id="46">sum_n=ceil (sum_n+0.01) ; n1=sum_N/&amp;r.[1, +]; n=n1#&amp;r.;</p>
                </div>
                <div class="p1">
                    <p id="47">u_mean= (n#&amp;u.) [, +]/sum_N;</p>
                </div>
                <div class="p1">
                    <p id="48">v= (&amp;r.# (&amp;u.-u_mean) ##2) [, +]/&amp;r.[, +];</p>
                </div>
                <div class="p1">
                    <p id="49">n_mean=sum_N/G;</p>
                </div>
                <div class="p1">
                    <p id="50">sigma_e2= (1-R2) *sd##2;</p>
                </div>
                <div class="p1">
                    <p id="51">lamda=n_mean*G*v/sigma_e2;</p>
                </div>
                <div class="p1">
                    <p id="52">df1=G-1;df2=sum_N-G-c;</p>
                </div>
                <div class="p1">
                    <p id="53">f=finv (1-a, df1, df2) ;</p>
                </div>
                <div class="p1">
                    <p id="54">pw=1-probf (f, df1, df2, lamda) ; pw1=100*pw;</p>
                </div>
                <div class="p1">
                    <p id="55">end;</p>
                </div>
                <div class="p1">
                    <p id="56">end;</p>
                </div>
                <div class="p1">
                    <p id="57">print a[label="Test Significance level"]</p>
                </div>
                <div class="p1">
                    <p id="58">G[label="Number of groups"]</p>
                </div>
                <div class="p1">
                    <p id="59">V[label="Variance of means"]</p>
                </div>
                <div class="p1">
                    <p id="60">sd[label="Common standard deviation"]</p>
                </div>
                <div class="p1">
                    <p id="61">c[label="Number of coveriates"]</p>
                </div>
                <div class="p1">
                    <p id="62">R2[label="R_squared value between the reponse and the covariates"]</p>
                </div>
                <div class="p1">
                    <p id="63">Pw1[label="Power (%) "]</p>
                </div>
                <div class="p1">
                    <p id="64">sum_N[label="Total sample size"];</p>
                </div>
                <div class="p1">
                    <p id="65">finish MGT4_1;</p>
                </div>
                <div class="p1">
                    <p id="66">run MGT4_1 (0.05, 3, 2.3788, 2, 0.4434, 80) ;</p>
                </div>
                <div class="p1">
                    <p id="67">run MGT4_1 (0.05, 3, 2.3788, 2, 0.4434, 90) ;</p>
                </div>
                <div class="p1">
                    <p id="68">quit;</p>
                </div>
                <div class="p1">
                    <p id="69">SAS 9.4运行结果:</p>
                </div>
                <div class="area_img" id="70">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/ZGWT201902043_070.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJtNEYxa3hESGJHemFFMEVVb1VEa0hsL0w5az0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图1-66a SAS 9.4关于例1-27样本量估计的参数设置与计算结果 (power=80%)" src="Detail/GetImg?filename=images/ZGWT201902043_070.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJtNEYxa3hESGJHemFFMEVVb1VEa0hsL0w5az0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit"><b>图1-66a</b> SAS 9.4关于例1-27样本量估计的参数设置与计算结果 (power=80%)   <a class="btn-zoomin" href="Detail/GetImg?filename=images/ZGWT201902043_070.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJtNEYxa3hESGJHemFFMEVVb1VEa0hsL0w5az0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="area_img" id="71">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/ZGWT201902043_071.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJtNEYxa3hESGJHemFFMEVVb1VEa0hsL0w5az0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图1-66b SAS 9.4关于例1-27样本量估计的参数设置与计算结果 (power=90%)" src="Detail/GetImg?filename=images/ZGWT201902043_071.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJtNEYxa3hESGJHemFFMEVVb1VEa0hsL0w5az0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit"><b>图1-66b</b> SAS 9.4关于例1-27样本量估计的参数设置与计算结果 (power=90%)   <a class="btn-zoomin" href="Detail/GetImg?filename=images/ZGWT201902043_071.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJtNEYxa3hESGJHemFFMEVVb1VEa0hsL0w5az0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="p1">
                    <p id="72">1.3.1.5 多变量方差分析 (MANOVA) </p>
                </div>
                <div class="p1">
                    <p id="73">方法:多变量方差分析针对分析中有多个反应变量的情况, 目前有多种常用统计量可用于分析, nQuery给出了其中三种供用户选择, 分别是Wilks’似然比统计量、Pillai-Bartlett Trace统计量、Hotelling-Lawley Trace统计量。Muller and Barton (1989) <citation id="402" type="reference"><link href="396" rel="bibliography" /><sup>[<a class="sup">3</a>]</sup></citation>, 以及 Muller, LaVange, Ramey (1992) <citation id="403" type="reference"><link href="398" rel="bibliography" /><sup>[<a class="sup">4</a>]</sup></citation>等给出了多变量方差分析的样本量和检验效能的估计方法, 各主效应及其交互效应的检验效能估计是建立在各自的自由度及非中心参数的<i>F</i>分布上。其检验效能的计算公式为:</p>
                </div>
                <div class="p1">
                    <p id="74">1-<i>β</i>=1-Prob<i>F</i> (<i>F</i><sub>1-<i>α</i>, <i>df</i><sub>1</sub>, <i>df</i><sub>2</sub></sub>, <i>df</i><sub>1</sub>, <i>df</i><sub>2</sub>, <i>λ</i>)      (1-44) </p>
                </div>
                <div class="p1">
                    <p id="75">式中, <i>df</i><sub>1</sub>, <i>df</i><sub>2</sub>代表<i>F</i>分布的自由度, <i>λ</i>为非中心参数, 根据不同的统计量, 其各参数计算方式如下:</p>
                </div>
                <div class="p1">
                    <p id="76">首先, 我们用<i>p</i>代表因变量个数, <i>q</i>代表所研究的分组变量的水平数, <i>X</i>代表设计矩阵, <i>r</i>代表设计矩阵的秩, <i>M</i>代表均值矩阵, <i>Σ</i>代表协方差矩阵, <i>C</i>代表对比矩阵, 不同效应的检验可以构建不同对比矩阵<i>C</i>, <i>N</i>代表总样本量。Wilks’似然比统计量、Pillai-Bartlett Trace统计量、Hotelling-Lawley Trace统计量可基于如下矩阵构建 :</p>
                </div>
                <div class="p1">
                    <p id="77"><i>H</i>= (<i>CM</i>) ′[<i>C</i> (<i>X</i>′<i>X</i>) <sup>-1</sup><i>C</i>′]<sup>-1</sup> (<i>CM</i>)      (1-45) </p>
                </div>
                <div class="p1">
                    <p id="78"><i>E</i>=<i>Σ</i> (<i>N</i>-<i>r</i>)      (1-46) </p>
                </div>
                <div class="p1">
                    <p id="79"><i>T</i>=<i>H</i>+<i>E</i>      (1-47) </p>
                </div>
                <div class="p1">
                    <p id="80"> (1) Wilks’ Lambda</p>
                </div>
                <div class="p1">
                    <p id="81">利用矩阵 (1-46) , (1-47) 可得Wilks’似然比统计量:</p>
                </div>
                <div class="p1">
                    <p id="82"><i>W</i>=|<i>ET</i><sup>-1</sup>|      (1-48) </p>
                </div>
                <div class="p1">
                    <p id="83">该检验统计量转化为近似的<i>F</i>统计量为:</p>
                </div>
                <div class="p1">
                    <p id="84" class="code-formula">
                        <mathml id="84"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>F</mi><msub><mrow></mrow><mrow><mi>d</mi><mi>f</mi><msub><mrow></mrow><mn>1</mn></msub><mo>, </mo><mi>d</mi><mi>f</mi><msub><mrow></mrow><mn>2</mn></msub></mrow></msub><mo>=</mo><mfrac><mrow><mi>η</mi><mo>/</mo><mi>d</mi><mi>f</mi><msub><mrow></mrow><mn>1</mn></msub></mrow><mrow><mo stretchy="false"> (</mo><mn>1</mn><mo>-</mo><mi>η</mi><mo stretchy="false">) </mo><mo>/</mo><mi>d</mi><mi>f</mi><msub><mrow></mrow><mn>2</mn></msub></mrow></mfrac><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mrow><mtext> </mtext><mtext> </mtext><mtext> </mtext></mrow><mo stretchy="false"> (</mo><mn>1</mn><mo>-</mo><mn>4</mn><mn>9</mn><mo stretchy="false">) </mo></mrow></math></mathml>
                    </p>
                </div>
                <div class="p1">
                    <p id="85">其中, </p>
                </div>
                <div class="p1">
                    <p id="86" class="code-formula">
                        <mathml id="86"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtable columnalign="left"><mtr><mtd><mi>d</mi><mi>f</mi><msub><mrow></mrow><mn>1</mn></msub><mo>=</mo><mi>a</mi><mi>p</mi><mo>, </mo></mtd></mtr><mtr><mtd><mi>d</mi><mi>f</mi><msub><mrow></mrow><mn>2</mn></msub><mo>=</mo><mi>g</mi><mo stretchy="false">[</mo><mo stretchy="false"> (</mo><mi>Ν</mi><mo>-</mo><mi>r</mi><mo stretchy="false">) </mo><mo>-</mo><mo stretchy="false"> (</mo><mi>p</mi><mo>-</mo><mi>a</mi><mo>+</mo><mn>1</mn><mo stretchy="false">) </mo><mo>/</mo><mn>2</mn><mo stretchy="false">]</mo><mo>-</mo><mo stretchy="false"> (</mo><mi>a</mi><mi>p</mi><mo>-</mo><mn>2</mn><mo stretchy="false">) </mo><mo>/</mo><mn>2</mn><mo>, </mo></mtd></mtr><mtr><mtd><mi>a</mi><mo>=</mo><mi>q</mi><mo>-</mo><mn>1</mn><mo>, </mo><mi>g</mi><mo>=</mo><mo stretchy="false"> (</mo><mfrac><mrow><mi>a</mi><msup><mrow></mrow><mn>2</mn></msup><mi>p</mi><msup><mrow></mrow><mn>2</mn></msup><mo>-</mo><mn>4</mn></mrow><mrow><mi>a</mi><msup><mrow></mrow><mn>2</mn></msup><mo>+</mo><mi>p</mi><msup><mrow></mrow><mn>2</mn></msup><mo>-</mo><mn>5</mn></mrow></mfrac><mo stretchy="false">) </mo><msup><mrow></mrow><mrow><mfrac><mn>1</mn><mn>2</mn></mfrac></mrow></msup><mo>, </mo><mi>η</mi><mo>=</mo><mn>1</mn><mo>-</mo><mi>W</mi><msup><mrow></mrow><mrow><mfrac><mn>1</mn><mi>g</mi></mfrac></mrow></msup></mtd></mtr><mtr><mtd><mo stretchy="false"> (</mo><mn>2</mn><mo stretchy="false">) </mo><mspace width="0.25em" /><mtext>Ρ</mtext><mtext>i</mtext><mtext>l</mtext><mtext>l</mtext><mtext>a</mtext><mtext>i</mtext><mo>-</mo><mtext>B</mtext><mtext>a</mtext><mtext>r</mtext><mtext>t</mtext><mtext>l</mtext><mtext>e</mtext><mtext>t</mtext><mtext>t</mtext><mspace width="0.25em" /><mtext>Τ</mtext><mtext>r</mtext><mtext>a</mtext><mtext>c</mtext><mtext>e</mtext><mspace width="0.25em" /></mtd></mtr></mtable></math></mathml>
                    </p>
                </div>
                <div class="p1">
                    <p id="87">利用矩阵 (1-45) , (1-47) 可得Pillai-Bartlett Trace统计量:</p>
                </div>
                <div class="p1">
                    <p id="88"><i>PBT</i>=<i>tr</i> (<i>HT</i><sup>-1</sup>)      (1-50) </p>
                </div>
                <div class="p1">
                    <p id="89">该检验统计量转化为近似的<i>F</i>统计量为:</p>
                </div>
                <div class="p1">
                    <p id="90" class="code-formula">
                        <mathml id="90"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>F</mi><msub><mrow></mrow><mrow><mi>d</mi><mi>f</mi><msub><mrow></mrow><mn>1</mn></msub><mo>, </mo><mi>d</mi><mi>f</mi><msub><mrow></mrow><mn>2</mn></msub></mrow></msub><mo>=</mo><mfrac><mrow><mi>η</mi><mo>/</mo><mi>d</mi><mi>f</mi><msub><mrow></mrow><mn>1</mn></msub></mrow><mrow><mo stretchy="false"> (</mo><mn>1</mn><mo>-</mo><mi>η</mi><mo stretchy="false">) </mo><mo>/</mo><mi>d</mi><mi>f</mi><msub><mrow></mrow><mn>2</mn></msub></mrow></mfrac><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mrow><mtext> </mtext><mtext> </mtext><mtext> </mtext></mrow><mo stretchy="false"> (</mo><mn>1</mn><mo>-</mo><mn>5</mn><mn>1</mn><mo stretchy="false">) </mo></mrow></math></mathml>
                    </p>
                </div>
                <div class="p1">
                    <p id="91">其中, </p>
                </div>
                <div class="area_img" id="92">
                            <div class="imgformula">
                                <img class="pFormula" alt="" src="Detail/GetImg?filename=images/ZGWT201902043_09200.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJtNEYxa3hESGJHemFFMEVVb1VEa0hsL0w5az0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                <p class="formula_seq"></p>
                            </div>

                </div>
                <div class="p1">
                    <p id="451"> (3) Hotelling-Lawley Trace</p>
                </div>
                <div class="p1">
                    <p id="93">利用矩阵 (1-45) , (1-46) 可得Hotelling-Lawley Trace统计量:</p>
                </div>
                <div class="p1">
                    <p id="94"><i>HLT</i>=<i>tr</i> (<i>HE</i><sup>-1</sup>)      (1-52) </p>
                </div>
                <div class="p1">
                    <p id="95">该检验统计量转化为近似的<i>F</i>统计量为:</p>
                </div>
                <div class="p1">
                    <p id="96" class="code-formula">
                        <mathml id="96"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>F</mi><msub><mrow></mrow><mrow><mi>d</mi><mi>f</mi><msub><mrow></mrow><mn>1</mn></msub><mo>, </mo><mi>d</mi><mi>f</mi><msub><mrow></mrow><mn>2</mn></msub></mrow></msub><mo>=</mo><mfrac><mrow><mi>η</mi><mo>/</mo><mi>d</mi><mi>f</mi><msub><mrow></mrow><mn>1</mn></msub></mrow><mrow><mo stretchy="false"> (</mo><mn>1</mn><mo>-</mo><mi>η</mi><mo stretchy="false">) </mo><mo>/</mo><mi>d</mi><mi>f</mi><msub><mrow></mrow><mn>2</mn></msub></mrow></mfrac><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mrow><mtext> </mtext><mtext> </mtext><mtext> </mtext></mrow><mo stretchy="false"> (</mo><mn>1</mn><mo>-</mo><mn>5</mn><mn>3</mn><mo stretchy="false">) </mo></mrow></math></mathml>
                    </p>
                </div>
                <div class="p1">
                    <p id="97">其中, </p>
                </div>
                <div class="p1">
                    <p id="98" class="code-formula">
                        <mathml id="98"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtable columnalign="left"><mtr><mtd><mi>d</mi><mi>f</mi><msub><mrow></mrow><mn>1</mn></msub><mo>=</mo><mi>a</mi><mi>p</mi><mo>, </mo></mtd></mtr><mtr><mtd><mi>d</mi><mi>f</mi><msub><mrow></mrow><mn>2</mn></msub><mo>=</mo><mi>s</mi><mo stretchy="false">[</mo><mo stretchy="false"> (</mo><mi>Ν</mi><mo>-</mo><mi>r</mi><mo stretchy="false">) </mo><mo>-</mo><mi>p</mi><mo>-</mo><mn>1</mn><mo stretchy="false">]</mo><mo>+</mo><mn>2</mn><mo>, </mo></mtd></mtr><mtr><mtd><mi>a</mi><mo>=</mo><mi>q</mi><mo>-</mo><mn>1</mn><mo>, </mo><mi>s</mi><mo>=</mo><mrow><mi>min</mi></mrow><mo stretchy="false"> (</mo><mi>a</mi><mo>, </mo><mi>p</mi><mo stretchy="false">) </mo><mo>, </mo><mi>η</mi><mo>=</mo><mfrac><mrow><mi>Η</mi><mi>L</mi><mi>Τ</mi><mo>/</mo><mi>s</mi></mrow><mrow><mn>1</mn><mo>+</mo><mi>Η</mi><mi>L</mi><mi>Τ</mi><mo>/</mo><mi>s</mi></mrow></mfrac></mtd></mtr></mtable></math></mathml>
                    </p>
                </div>
                <div class="p1">
                    <p id="99">对于上述各统计量, 其非中心参数<i>λ</i>为:</p>
                </div>
                <div class="p1">
                    <p id="100"><i>λ</i>=<i>F</i>·<i>df</i><sub>1</sub>      (1-54) </p>
                </div>
                <div class="p1">
                    <p id="101">计算样本量时, 先设定样本量初始值, 然后选择相应统计方法并迭代样本量直到所得的检验效能满足设定值为止, 此时的样本量即研究所需的样本量<citation id="404" type="reference"><link href="394" rel="bibliography" /><sup>[<a class="sup">2</a>]</sup></citation>。</p>
                </div>
                <div class="p1">
                    <p id="102">【例1-28】某研究欲比较不同教学方法在培养中学生良好学习行为中的作用, 教学方法分为传统教学组、视听教学组和对照组三个组, 因变量包括4个衡量学习行为的指标:学习环境、学习习惯、笔记能力和总结能力。根据既往研究, 均值矩阵如矩阵<i>M</i>所示, 协方差矩阵如矩阵<i>Σ</i>所示, 设定检验水准为0.05, 检验效能为80%, 试采用Wilks’ Lambda方法据此参数进行样本量估计。</p>
                </div>
                <div class="p1">
                    <p id="103" class="code-formula">
                        <mathml id="103"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtable columnalign="left"><mtr><mtd><mi>Μ</mi><mo>=</mo><mrow><mo> (</mo><mrow><mtable><mtr><mtd><mn>8</mn><mo>.</mo><mn>7</mn><mn>5</mn></mtd><mtd><mn>7</mn><mo>.</mo><mn>7</mn><mn>9</mn></mtd><mtd><mn>8</mn><mo>.</mo><mn>1</mn><mn>4</mn></mtd></mtr><mtr><mtd><mn>8</mn><mo>.</mo><mn>1</mn><mn>0</mn></mtd><mtd><mn>7</mn><mo>.</mo><mn>7</mn><mn>1</mn></mtd><mtd><mn>7</mn><mo>.</mo><mn>1</mn><mn>9</mn></mtd></mtr><mtr><mtd><mn>1</mn><mn>7</mn><mo>.</mo><mn>8</mn><mn>3</mn></mtd><mtd><mn>1</mn><mn>7</mn><mo>.</mo><mn>3</mn><mn>2</mn></mtd><mtd><mn>1</mn><mn>6</mn><mo>.</mo><mn>6</mn><mn>7</mn></mtd></mtr><mtr><mtd><mn>1</mn><mn>8</mn><mo>.</mo><mn>9</mn><mn>0</mn></mtd><mtd><mn>1</mn><mn>9</mn><mo>.</mo><mn>1</mn><mn>8</mn></mtd><mtd><mn>1</mn><mn>7</mn><mo>.</mo><mn>6</mn><mn>9</mn></mtd></mtr></mtable></mrow><mo>) </mo></mrow></mtd></mtr><mtr><mtd><mstyle displaystyle="true"><mo>∑</mo><mo>=</mo></mstyle><mrow><mo> (</mo><mrow><mtable><mtr><mtd><mn>3</mn><mo>.</mo><mn>6</mn><mn>4</mn><mn>1</mn></mtd><mtd><mn>1</mn><mo>.</mo><mn>2</mn><mn>7</mn><mn>4</mn></mtd><mtd><mn>2</mn><mo>.</mo><mn>6</mn><mn>4</mn><mn>1</mn></mtd><mtd><mn>4</mn><mo>.</mo><mn>5</mn><mn>5</mn><mn>5</mn></mtd></mtr><mtr><mtd><mn>1</mn><mo>.</mo><mn>2</mn><mn>7</mn><mn>4</mn></mtd><mtd><mn>2</mn><mo>.</mo><mn>6</mn><mn>2</mn><mn>3</mn></mtd><mtd><mn>1</mn><mo>.</mo><mn>9</mn><mn>4</mn><mn>7</mn></mtd><mtd><mn>2</mn><mo>.</mo><mn>7</mn><mn>2</mn><mn>2</mn></mtd></mtr><mtr><mtd><mn>2</mn><mo>.</mo><mn>6</mn><mn>4</mn><mn>1</mn></mtd><mtd><mn>1</mn><mo>.</mo><mn>9</mn><mn>4</mn><mn>7</mn></mtd><mtd><mn>9</mn><mo>.</mo><mn>5</mn><mn>4</mn><mn>8</mn></mtd><mtd><mn>7</mn><mo>.</mo><mn>0</mn><mn>0</mn><mn>1</mn></mtd></mtr><mtr><mtd><mn>4</mn><mo>.</mo><mn>5</mn><mn>5</mn><mn>5</mn></mtd><mtd><mn>2</mn><mo>.</mo><mn>7</mn><mn>2</mn><mn>2</mn></mtd><mtd><mn>7</mn><mo>.</mo><mn>0</mn><mn>0</mn><mn>1</mn></mtd><mtd><mn>1</mn><mn>5</mn><mo>.</mo><mn>9</mn><mn>1</mn><mn>4</mn></mtd></mtr></mtable></mrow><mo>) </mo></mrow></mtd></mtr></mtable></math></mathml>
                    </p>
                </div>
                <div class="p1">
                    <p id="104">nQuery Advanced实现:设定检验水准为<i>α</i>= 0.05;检验效能取80%。依据上述基础数据可知, <i>p</i>=4, 试验包含1个影响因素, 其水平数为3, 均值矩阵如矩阵M所示, 协方差矩阵Σ如矩阵所示。在nQueryAdvanced 主菜单选择:</p>
                </div>
                <div class="p1">
                    <p id="105">Design:⊙Fixed Term</p>
                </div>
                <div class="p1">
                    <p id="106">Goal:⊙Means</p>
                </div>
                <div class="p1">
                    <p id="107">No.of Groups:⊙&gt;Two</p>
                </div>
                <div class="p1">
                    <p id="108">Analysis Method:⊙Test</p>
                </div>
                <div class="p1">
                    <p id="109">方法框中选择Multivariate Analysis of Variance (MANOVA) 。</p>
                </div>
                <div class="p1">
                    <p id="110">在弹出的样本量计算窗口将各参数键入, 如图1-67a所示, 均值矩阵和协方差矩阵如图1-67b和图1-67c所示, 结果<i>n</i>和<i>N</i>分别为37和111, 即每组样本量为37例, 总样本量为111例。</p>
                </div>
                <div class="area_img" id="111">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/ZGWT201902043_111.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJtNEYxa3hESGJHemFFMEVVb1VEa0hsL0w5az0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图1-67a nQuery Advanced 关于例1-28样本量估计的参数设置与计算结果" src="Detail/GetImg?filename=images/ZGWT201902043_111.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJtNEYxa3hESGJHemFFMEVVb1VEa0hsL0w5az0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit"><b>图1-67a</b> nQuery Advanced 关于例1-28样本量估计的参数设置与计算结果  <a class="btn-zoomin" href="Detail/GetImg?filename=images/ZGWT201902043_111.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJtNEYxa3hESGJHemFFMEVVb1VEa0hsL0w5az0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="area_img" id="112">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/ZGWT201902043_112.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJtNEYxa3hESGJHemFFMEVVb1VEa0hsL0w5az0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图1-67b nQuery Advanced 关于例1-28样本量估计的参数设置与计算结果 (均值矩阵)" src="Detail/GetImg?filename=images/ZGWT201902043_112.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJtNEYxa3hESGJHemFFMEVVb1VEa0hsL0w5az0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit"><b>图1-67b</b> nQuery Advanced 关于例1-28样本量估计的参数设置与计算结果 (均值矩阵)   <a class="btn-zoomin" href="Detail/GetImg?filename=images/ZGWT201902043_112.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJtNEYxa3hESGJHemFFMEVVb1VEa0hsL0w5az0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="area_img" id="113">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/ZGWT201902043_113.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJtNEYxa3hESGJHemFFMEVVb1VEa0hsL0w5az0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图1-67c nQueryAdvanced 关于例1-28样本量估计的参数设置与计算结果 (协方差矩阵)" src="Detail/GetImg?filename=images/ZGWT201902043_113.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJtNEYxa3hESGJHemFFMEVVb1VEa0hsL0w5az0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit"><b>图1-67c</b> nQueryAdvanced 关于例1-28样本量估计的参数设置与计算结果 (协方差矩阵)   <a class="btn-zoomin" href="Detail/GetImg?filename=images/ZGWT201902043_113.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJtNEYxa3hESGJHemFFMEVVb1VEa0hsL0w5az0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="p1">
                    <p id="114">SAS 9.4软件实现:</p>
                </div>
                <div class="p1">
                    <p id="115">%let f_level={3}; /*各分组变量的水平数*/</p>
                </div>
                <div class="p1">
                    <p id="116">%let m= { 8.75 7.79 8.14, 8.10 7.71 7.19, 17.83 17.32 16.67, 18.90 19.18 17.69};</p>
                </div>
                <div class="p1">
                    <p id="117">/*因变量在所有分组变量各个水平组合下的均值*/</p>
                </div>
                <div class="p1">
                    <p id="118">prociml;</p>
                </div>
                <div class="p1">
                    <p id="119">start MGT3 (alpha, power, p, f, rho, sd, sigma_def, method) ;</p>
                </div>
                <div class="p1">
                    <p id="120">f_level=&amp;f_level.;</p>
                </div>
                <div class="p1">
                    <p id="121">m=t (&amp;m.) ;</p>
                </div>
                <div class="p1">
                    <p id="122">/*parameter check*/</p>
                </div>
                <div class="p1">
                    <p id="123">error=0;</p>
                </div>
                <div class="p1">
                    <p id="124">if ( alpha&gt;=1 | alpha&lt;=0 ) then do; error=1; print "Error" "Test significance Level must be in 0-1"; end;</p>
                </div>
                <div class="p1">
                    <p id="125">/*参数f代表分组变量个数, 不超过3个*/</p>
                </div>
                <div class="p1">
                    <p id="126">if (f^=1 &amp; f^=2 &amp; f^=3) then do; error=1; print "Error""The number of factors must be in 1, 2, 3";end;</p>
                </div>
                <div class="p1">
                    <p id="127">/*参数power代表各个效应的检验效能向量;当研究包含A和B两个分组变量时, 可依次定义A、B及其交互效应AB的检验效能;当研究包含A、B、C三个分组变量时, 可依次定义A、B、C、AB、AC、BC、ABC的检验效能*/</p>
                </div>
                <div class="p1">
                    <p id="128">if f=1 &amp; nrow (power) ^=1 &amp; ncol (power) ^=1 then do;error=1;print "Error""Please input power of factor A";end;</p>
                </div>
                <div class="p1">
                    <p id="129">if f=2 &amp; nrow (power) ^=3 &amp; ncol (power) ^=3 then do;error=1;print "Error""Please input power of factor A, factor B, factor AB (input "." if missing) ";end;</p>
                </div>
                <div class="p1">
                    <p id="130">if f=3 &amp; nrow (power) ^=7 &amp; ncol (power) ^=7 then do; error=1; print "Error""Please input power of factor A, factor B, factor C, factor AB, factor AC, factor BC, factor ABC (input "." if missing) "; end;</p>
                </div>
                <div class="p1">
                    <p id="131">if (p&lt;=0 | ceil (p) ^=p) then do; error=1; print "Error" "The number of response variables must be a positive integer "; end;</p>
                </div>
                <div class="p1">
                    <p id="132">if error=0 then do; q=1;do i=1 to f; q= q * &amp;f_level.[i]; end;end;else stop;</p>
                </div>
                <div class="p1">
                    <p id="133">if nrow (f_level) ^=f then do;error=1; print "Error""The row number of factor levels should be equal to the number of factors";end;</p>
                </div>
                <div class="p1">
                    <p id="134">if ncol (m) ^=p then do; error=1; print "Error" "The row number of mean matrix should be equal to the number of response variables"; end;</p>
                </div>
                <div class="p1">
                    <p id="135">if nrow (m) ^=q then do; error=1; print "Error" "The column number of mean matrix should be equal to the product of factor levels"; end;</p>
                </div>
                <div class="p1">
                    <p id="136">/*协方差矩阵可以由参数rho和sd生成, 也可以由参数sigma_def直接定义*/</p>
                </div>
                <div class="p1">
                    <p id="137">if (rho^=.&amp; (rho&gt;=1 | rho&lt;=0) ) then do; error=1;print "error" "Correlation must be in 0-1";end;</p>
                </div>
                <div class="p1">
                    <p id="138">if (sd^=.&amp; ( sd&lt;=0 ) ) then do;error=1; print "Error" "Standard deviation at each level must be &gt;=0"; end;</p>
                </div>
                <div class="p1">
                    <p id="139">if (sigma_def^=.&amp; (ncol (sigma_def) ^=p | nrow (sigma_def) ^=p) ) then do;</p>
                </div>
                <div class="p1">
                    <p id="140">error=1; print "Error" "The row and column numbers of covariance matrix should be equal to the number of response variables"; end;</p>
                </div>
                <div class="p1">
                    <p id="141">/*参数method代表所选用的检验统计量, 其中1=Wilks' Lambda统计量, 2=Pillai-Bartlett Trace统计量, 3=Hotelling-Lawley Trace统计量。*/</p>
                </div>
                <div class="p1">
                    <p id="142">if (method^=1 &amp; method^=2 &amp; method^=3) then do; error=1; print "Error""method must be in 1, 2, 3";end;</p>
                </div>
                <div class="p1">
                    <p id="143">if (rho^=.&amp; sd^=.) then do;</p>
                </div>
                <div class="p1">
                    <p id="144">covariance=rho*sd**2;sigma=j (p, p, covariance) ;</p>
                </div>
                <div class="p1">
                    <p id="145">do i=1 to p; sigma[i, i]=sd**2; end;</p>
                </div>
                <div class="p1">
                    <p id="146">end;</p>
                </div>
                <div class="p1">
                    <p id="147">else sigma=sigma_def;</p>
                </div>
                <div class="p1">
                    <p id="148">if (error=1) then stop;</p>
                </div>
                <div class="p1">
                    <p id="149">if (error=0) then do;</p>
                </div>
                <div class="p1">
                    <p id="150">/*C matrix*/</p>
                </div>
                <div class="p1">
                    <p id="151">max_level=&amp;f_level.[&lt;&gt;, ];</p>
                </div>
                <div class="p1">
                    <p id="152">origin_c=j (max_level-1, max_level, 0) ;</p>
                </div>
                <div class="p1">
                    <p id="153">origin_j=j (max_level-1, max_level, .) ;</p>
                </div>
                <div class="p1">
                    <p id="154">do i=2 to max_level;</p>
                </div>
                <div class="p1">
                    <p id="155">e1=- (i-1) /sqrt (i* (i-1) ) ; e2=1/sqrt (i* (i-1) ) ; e3=j (1, i-1, e2) ; e4=1/sqrt (i) ;</p>
                </div>
                <div class="p1">
                    <p id="156">e5=j (1, i, e4) ;</p>
                </div>
                <div class="p1">
                    <p id="157">index=max_level+1-i;</p>
                </div>
                <div class="p1">
                    <p id="158">origin_c[index, index]=e1;</p>
                </div>
                <div class="p1">
                    <p id="159">origin_c[index, index+1:max_level]=e3;</p>
                </div>
                <div class="p1">
                    <p id="160">origin_j[index, index:max_level]=e5;</p>
                </div>
                <div class="p1">
                    <p id="161">end;</p>
                </div>
                <div class="p1">
                    <p id="162">f1=&amp;f_level.[1]; index1=max_level-f1+1;</p>
                </div>
                <div class="p1">
                    <p id="163">C1=origin_c[index1:max_level-1, index1:max_level];</p>
                </div>
                <div class="p1">
                    <p id="164">J1=origin_j[index1, index1:max_level];C_A=C1; power_a=power[1];</p>
                </div>
                <div class="p1">
                    <p id="165">if f&gt;1 then do;</p>
                </div>
                <div class="p1">
                    <p id="166">f2=&amp;f_level.[2]; index2=max_level-f2+1; C2=origin_c[index2:max_level-1, index2:max_level];</p>
                </div>
                <div class="p1">
                    <p id="167">J2=origin_j[index2, index2:max_level];</p>
                </div>
                <div class="p1">
                    <p id="168">C_A=C1@J2;C_B=J1@C2;C_AB=C1@C2;</p>
                </div>
                <div class="p1">
                    <p id="169">power_b=power[2];power_ab=power[3];</p>
                </div>
                <div class="p1">
                    <p id="170">end;</p>
                </div>
                <div class="p1">
                    <p id="171">if f&gt;2 then do;</p>
                </div>
                <div class="p1">
                    <p id="172">f3=&amp;f_level.[3];</p>
                </div>
                <div class="p1">
                    <p id="173">index3=max_level-f3+1;</p>
                </div>
                <div class="p1">
                    <p id="174">C3=origin_c[index3:max_level-1, index3:max_level];</p>
                </div>
                <div class="p1">
                    <p id="175">J3=origin_j[index3, index3:max_level];</p>
                </div>
                <div class="p1">
                    <p id="176">C_A=C1@J2@J3;C_B=J1@C2@J3;C_C=J1@J2@C3;</p>
                </div>
                <div class="p1">
                    <p id="177">C_AB=C1@C2@J3;C_AC=C1@J2@C3;C_BC=J1@C2@C3;</p>
                </div>
                <div class="p1">
                    <p id="178">C_ABC=C1@C2@C3;</p>
                </div>
                <div class="p1">
                    <p id="179">power_c=power[3];</p>
                </div>
                <div class="p1">
                    <p id="180">power_ab=power[4];power_ac=power[5];power_bc=power[6];</p>
                </div>
                <div class="p1">
                    <p id="181">power_abc=power[7];</p>
                </div>
                <div class="p1">
                    <p id="182">end;</p>
                </div>
                <div class="p1">
                    <p id="183">/*power*/</p>
                </div>
                <div class="p1">
                    <p id="184">%macro pw (c, pw_exp) ;</p>
                </div>
                <div class="p1">
                    <p id="185">n_orig=j (1, q, 1) ;n=j (1, q, 1) ;</p>
                </div>
                <div class="p1">
                    <p id="186">if &amp;pw_exp.^=.then do;</p>
                </div>
                <div class="p1">
                    <p id="187">if method=1 then do;</p>
                </div>
                <div class="p1">
                    <p id="188">test="Wilks' Lambda";</p>
                </div>
                <div class="p1">
                    <p id="189">do until (pw&gt;=&amp;pw_exp.) ;</p>
                </div>
                <div class="p1">
                    <p id="190">n=n+n_orig;xx=t (n) #I (q) ;E=sigma * (n[&lt;&gt;, +]-q) ;</p>
                </div>
                <div class="p1">
                    <p id="191">theta=&amp;C.* m; H=t (theta) *inv ( (&amp;C.*inv (XX) *t (&amp;C.) ) ) *theta;</p>
                </div>
                <div class="p1">
                    <p id="192">T=H+E;df1=a*p;W=det (E*inv (T) ) ;fmm=a**2+p**2-5;</p>
                </div>
                <div class="p1">
                    <p id="193">if fmm&gt;0 then g=sqrt ( (a**2*p**2-4) / (a**2+p**2-5) ) ; else g=1;</p>
                </div>
                <div class="p1">
                    <p id="194">eta=1-W**inv (g) ;</p>
                </div>
                <div class="p1">
                    <p id="195">df2=g* ( (n[&lt;&gt;, +]-q) - (p-a+1) /2) - (a*p-2) /2;</p>
                </div>
                <div class="p1">
                    <p id="196">if df2&gt;0 then do;</p>
                </div>
                <div class="p1">
                    <p id="197">F_statistics= (eta/df1) / ( (1-eta) /df2) ;</p>
                </div>
                <div class="p1">
                    <p id="198">f_c=finv (1-alpha, df1, df2) ;lambda=df1*F_statistics;</p>
                </div>
                <div class="p1">
                    <p id="199">pw= (1-probf (f_c, df1, df2, lambda) ) *100; sum_n=n[&lt;&gt;, +];</p>
                </div>
                <div class="p1">
                    <p id="200">end;</p>
                </div>
                <div class="p1">
                    <p id="201">else pw=0;</p>
                </div>
                <div class="p1">
                    <p id="202">end;</p>
                </div>
                <div class="p1">
                    <p id="203">end;</p>
                </div>
                <div class="p1">
                    <p id="204">if method=2 then do;</p>
                </div>
                <div class="p1">
                    <p id="205">test="Pillai-Bartlett Trace";</p>
                </div>
                <div class="p1">
                    <p id="206">do until (pw&gt;=&amp;pw_exp.) ;</p>
                </div>
                <div class="p1">
                    <p id="207">n=n+n_orig;xx=t (n) #I (q) ;E=sigma * (n[&lt;&gt;, +]-q) ;</p>
                </div>
                <div class="p1">
                    <p id="208">theta=&amp;C.* m; H=t (theta) *inv ( (&amp;C.*inv (XX) *t (&amp;C.) ) ) *theta;</p>
                </div>
                <div class="p1">
                    <p id="209">T=H+E;df1=a*p;</p>
                </div>
                <div class="p1">
                    <p id="210">ht=h*inv (t) ;PBT=trace (ht) ;s=min (a, p) ;</p>
                </div>
                <div class="p1">
                    <p id="211">eta=pbt/s;df2=s* ( (n[&lt;&gt;, +]-q) -p+s) ;</p>
                </div>
                <div class="p1">
                    <p id="212">if df2&gt;0 then do;</p>
                </div>
                <div class="p1">
                    <p id="213">F_statistics= (eta/df1) / ( (1-eta) /df2) ;</p>
                </div>
                <div class="p1">
                    <p id="214">f_c=finv (1-alpha, df1, df2) ;lambda=df1*F_statistics;</p>
                </div>
                <div class="p1">
                    <p id="215">pw= (1-probf (f_c, df1, df2, lambda) ) *100; sum_n=n[&lt;&gt;, +];</p>
                </div>
                <div class="p1">
                    <p id="216">end;</p>
                </div>
                <div class="p1">
                    <p id="217">else pw=0;</p>
                </div>
                <div class="p1">
                    <p id="218">end;</p>
                </div>
                <div class="p1">
                    <p id="219">end;</p>
                </div>
                <div class="p1">
                    <p id="220">if method=3 then do;</p>
                </div>
                <div class="p1">
                    <p id="221">test="Hotelling-Lawley Trace";</p>
                </div>
                <div class="p1">
                    <p id="222">do until (pw&gt;=&amp;pw_exp.) ;</p>
                </div>
                <div class="p1">
                    <p id="223">n=n+n_orig;xx=t (n) #I (q) ;E=sigma * (n[&lt;&gt;, +]-q) ;</p>
                </div>
                <div class="p1">
                    <p id="224">theta=&amp;C.* m; H=t (theta) *inv ( (&amp;C.*inv (XX) *t (&amp;C.) ) ) *theta;</p>
                </div>
                <div class="p1">
                    <p id="225">T=H+E;df1=a*p;</p>
                </div>
                <div class="p1">
                    <p id="226">he=h*inv (E) ;hlt=trace (he) ;</p>
                </div>
                <div class="p1">
                    <p id="227">s=min (a, p) ;eta= (hlt/s) / (1+hlt/s) ;</p>
                </div>
                <div class="p1">
                    <p id="228">df2=s* ( (n[&lt;&gt;, +]-q) -p-1) +2;</p>
                </div>
                <div class="p1">
                    <p id="229">if df2&gt;0 then do;</p>
                </div>
                <div class="p1">
                    <p id="230">F_statistics= (eta/df1) / ( (1-eta) /df2) ;</p>
                </div>
                <div class="p1">
                    <p id="231">f_c=finv (1-alpha, df1, df2) ;lambda=df1*F_statistics;</p>
                </div>
                <div class="p1">
                    <p id="232">pw= (1-probf (f_c, df1, df2, lambda) ) *100; sum_n=n[&lt;&gt;, +];</p>
                </div>
                <div class="p1">
                    <p id="233">end;</p>
                </div>
                <div class="p1">
                    <p id="234">else pw=0;</p>
                </div>
                <div class="p1">
                    <p id="235">end;</p>
                </div>
                <div class="p1">
                    <p id="236">end;</p>
                </div>
                <div class="p1">
                    <p id="237">end;</p>
                </div>
                <div class="p1">
                    <p id="238">else do; pw=.; sum_n=0; end;</p>
                </div>
                <div class="p1">
                    <p id="239">%mend;</p>
                </div>
                <div class="p1">
                    <p id="240">/*compute total sample size*/</p>
                </div>
                <div class="p1">
                    <p id="241">a=&amp;f_level.[1]-1; %pw (C_A, power_a) ;sum_n_a=sum_n;Smp_size=sum_n_a;</p>
                </div>
                <div class="p1">
                    <p id="242">if f&gt;1 then do;</p>
                </div>
                <div class="p1">
                    <p id="243">a=&amp;f_level.[2]-1;%pw (C_B, power_b) ;sum_n_b=sum_n;</p>
                </div>
                <div class="p1">
                    <p id="244">a= (&amp;f_level.[1]-1) * (&amp;f_level.[2]-1) ;%pw (C_AB, power_ab) ;</p>
                </div>
                <div class="p1">
                    <p id="245">sum_n_ab=sum_n;</p>
                </div>
                <div class="p1">
                    <p id="246">Smp_size=j (3, 1, .) ;</p>
                </div>
                <div class="p1">
                    <p id="247">Smp_size[1]=sum_n_a;</p>
                </div>
                <div class="p1">
                    <p id="248">Smp_size[2]=sum_n_b;</p>
                </div>
                <div class="p1">
                    <p id="249">Smp_size[3]=sum_n_ab;</p>
                </div>
                <div class="p1">
                    <p id="250">end;</p>
                </div>
                <div class="p1">
                    <p id="251">if f&gt;2 then do;</p>
                </div>
                <div class="p1">
                    <p id="252">a=&amp;f_level.[3]-1;%pw (C_C, power_c) ;pw_c=pw;sum_n_c=sum_n;</p>
                </div>
                <div class="p1">
                    <p id="253">a= (&amp;f_level.[1]-1) * (&amp;f_level.[3]-1) ;</p>
                </div>
                <div class="p1">
                    <p id="254">%pw (C_AC, power_ac) ;sum_n_ac=sum_n;</p>
                </div>
                <div class="p1">
                    <p id="255">a= (&amp;f_level.[2]-1) * (&amp;f_level.[3]-1) ;</p>
                </div>
                <div class="p1">
                    <p id="256">%pw (C_BC, power_bc) ;sum_n_bc=sum_n;</p>
                </div>
                <div class="p1">
                    <p id="257">a= (&amp;f_level.[1]-1) * (&amp;f_level.[2]-1) * (&amp;f_level.[3]-1) ;</p>
                </div>
                <div class="p1">
                    <p id="258">%pw (C_ABC, power_abc) ;sum_n_abc=sum_n;</p>
                </div>
                <div class="p1">
                    <p id="259">Smp_size=j (7, 1, .) ;</p>
                </div>
                <div class="p1">
                    <p id="260">Smp_size[1]=sum_n_a;</p>
                </div>
                <div class="p1">
                    <p id="261">Smp_size[2]=sum_n_b;</p>
                </div>
                <div class="p1">
                    <p id="262">Smp_size[3]=sum_n;</p>
                </div>
                <div class="p1">
                    <p id="263">Smp_size[4]=sum_n_ab;</p>
                </div>
                <div class="p1">
                    <p id="264">Smp_size[5]=sum_n_ac;</p>
                </div>
                <div class="p1">
                    <p id="265">Smp_size[6]=sum_n_bc;</p>
                </div>
                <div class="p1">
                    <p id="266">Smp_size[7]=sum_n_abc;</p>
                </div>
                <div class="p1">
                    <p id="267">end;</p>
                </div>
                <div class="p1">
                    <p id="268">Total_n=Smp_size[&lt;&gt;, ];grp_size=Total_n/q;</p>
                </div>
                <div class="p1">
                    <p id="269">/*compute power for total sample size*/</p>
                </div>
                <div class="p1">
                    <p id="270">%macro pw2 (c, pw_exp) ;</p>
                </div>
                <div class="p1">
                    <p id="271">if &amp;pw_exp.^=.then do;</p>
                </div>
                <div class="p1">
                    <p id="272">n=j (1, q, grp_size) ;xx=t (n) #I (q) ;E=sigma * (n[&lt;&gt;, +]-q) ;</p>
                </div>
                <div class="p1">
                    <p id="273">theta=&amp;C.* m; H=t (theta) *inv ( (&amp;C.*inv (XX) *t (&amp;C.) ) ) *theta;</p>
                </div>
                <div class="p1">
                    <p id="274">T=H+E;df1=a*p;</p>
                </div>
                <div class="p1">
                    <p id="275">if method=1 then do;</p>
                </div>
                <div class="p1">
                    <p id="276">W=det (E*inv (T) ) ;fmm=a**2+p**2-5;</p>
                </div>
                <div class="p1">
                    <p id="277">if fmm&gt;0 then g=sqrt ( (a**2*p**2-4) / (a**2+p**2-5) ) ; else g=1;</p>
                </div>
                <div class="p1">
                    <p id="278">eta=1-W**inv (g) ;</p>
                </div>
                <div class="p1">
                    <p id="279">df2=g* ( (n[&lt;&gt;, +]-q) - (p-a+1) /2) - (a*p-2) /2;</p>
                </div>
                <div class="p1">
                    <p id="280">F_statistics= (eta/df1) / ( (1-eta) /df2) ;</p>
                </div>
                <div class="p1">
                    <p id="281">end;</p>
                </div>
                <div class="p1">
                    <p id="282">if method=2 then do;</p>
                </div>
                <div class="p1">
                    <p id="283">ht=h*inv (t) ;PBT=trace (ht) ;s=min (a, p) ;</p>
                </div>
                <div class="p1">
                    <p id="284">eta=pbt/s;df2=s* ( (n[&lt;&gt;, +]-q) -p+s) ;</p>
                </div>
                <div class="p1">
                    <p id="285">F_statistics= (eta/df1) / ( (1-eta) /df2) ;</p>
                </div>
                <div class="p1">
                    <p id="286">end;</p>
                </div>
                <div class="p1">
                    <p id="287">if method=3 then do;</p>
                </div>
                <div class="p1">
                    <p id="288">he=h*inv (E) ;hlt=trace (he) ;s=min (a, p) ;</p>
                </div>
                <div class="p1">
                    <p id="289">eta= (hlt/s) / (1+hlt/s) ;df2=s* ( (n[&lt;&gt;, +]-q) -p-1) +2;</p>
                </div>
                <div class="p1">
                    <p id="290">F_statistics= (eta/df1) / ( (1-eta) /df2) ;</p>
                </div>
                <div class="p1">
                    <p id="291">end;</p>
                </div>
                <div class="p1">
                    <p id="292">f_c=finv (1-alpha, df1, df2) ;lambda=df1*F_statistics;</p>
                </div>
                <div class="p1">
                    <p id="293">pw= (1-probf (f_c, df1, df2, lambda) ) *100;</p>
                </div>
                <div class="p1">
                    <p id="294">end;</p>
                </div>
                <div class="p1">
                    <p id="295">else pw=.;</p>
                </div>
                <div class="p1">
                    <p id="296">%mend;</p>
                </div>
                <div class="p1">
                    <p id="297">Level= &amp;f_Level.;</p>
                </div>
                <div class="p1">
                    <p id="298">factor="Factor A";</p>
                </div>
                <div class="p1">
                    <p id="299">a=&amp;f_level.[1]-1; %pw2 (C_A, power_a) ; pw_a=pw;power=pw_a;Alpha1=alpha;</p>
                </div>
                <div class="p1">
                    <p id="300">if f&gt;1 then do;</p>
                </div>
                <div class="p1">
                    <p id="301">factor={"Factor A", "FactorB", "Factor AB"};</p>
                </div>
                <div class="p1">
                    <p id="302">a=&amp;f_level.[2]-1; %pw2 (C_B, power_b) ; pw_b=pw;</p>
                </div>
                <div class="p1">
                    <p id="303">a= (&amp;f_level.[1]-1) * (&amp;f_level.[2]-1) ; %pw2 (C_AB, power_ab) ; pw_ab=pw;</p>
                </div>
                <div class="p1">
                    <p id="304">power=j (3, 1, .) ;power[1]=pw_a; power[2]=pw_b;power[3]=pw_ab;</p>
                </div>
                <div class="p1">
                    <p id="305">Alpha1=j (3, 1, alpha) ;</p>
                </div>
                <div class="p1">
                    <p id="306">end;</p>
                </div>
                <div class="p1">
                    <p id="307">if f&gt;2 then do;</p>
                </div>
                <div class="p1">
                    <p id="308">factor={"Factor A", "FactorB", "FactorC", "FactorAB", "FactorAC", "FactorBC", "Factor ABC"};</p>
                </div>
                <div class="p1">
                    <p id="309">a=&amp;f_level.[3]-1; %pw2 (C_C, power_c) ; pw_c=pw;</p>
                </div>
                <div class="p1">
                    <p id="310">a= (&amp;f_level.[1]-1) * (&amp;f_level.[3]-1) ; %pw2 (C_AC, power_ac) ; pw_ac=pw;</p>
                </div>
                <div class="p1">
                    <p id="311">a= (&amp;f_level.[2]-1) * (&amp;f_level.[3]-1) ; %pw2 (C_BC, power_bc) ; pw_bc=pw;</p>
                </div>
                <div class="p1">
                    <p id="312">a= (&amp;f_level.[1]-1) * (&amp;f_level.[2]-1) * (&amp;f_level.[3]-1) ;</p>
                </div>
                <div class="p1">
                    <p id="313">%pw2 (C_ABC, power_abc) ;pw_abc=pw;</p>
                </div>
                <div class="p1">
                    <p id="314">power=j (7, 1, .) ;power[1]=pw_a; power[2]=pw_b;power[3]=pw_c;</p>
                </div>
                <div class="p1">
                    <p id="315">power[4]=pw_ab;power[5]=pw_ac;power[6]=pw_bc;power[7]=pw_abc;</p>
                </div>
                <div class="p1">
                    <p id="316">Alpha1=j (7, 1, alpha) ;</p>
                </div>
                <div class="p1">
                    <p id="317">end;</p>
                </div>
                <div class="p1">
                    <p id="318">Mean_Matrix=&amp;m.;</p>
                </div>
                <div class="p1">
                    <p id="319">end;</p>
                </div>
                <div class="p1">
                    <p id="320">print test[Label="Test"]</p>
                </div>
                <div class="p1">
                    <p id="321">p[Label="Number of Response Variables"]</p>
                </div>
                <div class="p1">
                    <p id="322">sd[Label="Common Standard Deviation"]</p>
                </div>
                <div class="p1">
                    <p id="323">rho[Label="Correlation"]</p>
                </div>
                <div class="p1">
                    <p id="324">grp_size[Label="Group Size"]</p>
                </div>
                <div class="p1">
                    <p id="325">Total_n[Label="Total Sample Size"];</p>
                </div>
                <div class="p1">
                    <p id="326">Print Factor [label="Factor"]</p>
                </div>
                <div class="p1">
                    <p id="327">Level [Label="Level"]</p>
                </div>
                <div class="p1">
                    <p id="328">Alpha1 [Label="Alpha"]</p>
                </div>
                <div class="p1">
                    <p id="329">Power [Label="Power (%) "];</p>
                </div>
                <div class="p1">
                    <p id="330">Print Mean_Matrix;</p>
                </div>
                <div class="p1">
                    <p id="331">Print sigma[label="Covariance Matrix"];</p>
                </div>
                <div class="p1">
                    <p id="332">finish MGT3;</p>
                </div>
                <div class="p1">
                    <p id="333">%let sigma1={3.641 1.274 2.641 4.555, 1.274 2.623 1.947 2.722, 2.641 1.947 9.548 7.001, 4.555 2.722 7.001 15.914};</p>
                </div>
                <div class="p1">
                    <p id="334">%let power={80};</p>
                </div>
                <div class="p1">
                    <p id="335">run MGT3 (0.05, &amp;power., 4, 1, ., ., &amp;sigma1., 1) ;</p>
                </div>
                <div class="p1">
                    <p id="336">quit;</p>
                </div>
                <div class="p1">
                    <p id="337">SAS 9.4运行结果:</p>
                </div>
                <div class="area_img" id="338">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/ZGWT201902043_338.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJtNEYxa3hESGJHemFFMEVVb1VEa0hsL0w5az0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图1-68 SAS 9.4关于例1-28样本量估计的参数设置与计算结果" src="Detail/GetImg?filename=images/ZGWT201902043_338.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJtNEYxa3hESGJHemFFMEVVb1VEa0hsL0w5az0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit"><b>图1-68</b> SAS 9.4关于例1-28样本量估计的参数设置与计算结果  <a class="btn-zoomin" href="Detail/GetImg?filename=images/ZGWT201902043_338.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJtNEYxa3hESGJHemFFMEVVb1VEa0hsL0w5az0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>

        <!--brief end-->
        
        <!--conten left  end-->
        <!--增强附件-->
        

        <!--reference start-->
            <div class="reference anchor-tag" id="a_bibliography">
                    <h3>参考文献</h3>
                                        <p id="392">
                            <a id="bibliography_1" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Design and Analysis-A Researcher&amp;#39;&amp;#39;s Handbook">

                                <b>[1]</b> Keppel G. Design and Analysis-A Researcher's Handbook. Third Edition. Prentice Hall:1991.
                            </a>
                        </p>
                        <p id="394">
                            <a id="bibliography_2" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=ZGWT201504058&amp;v=MTc4OTdJUUtESDg0dlI0VDZqNTRPM3pxcUJ0R0ZyQ1VSN3FmWnVabkZ5N21WcnZPUHlyY2VyRzRIOVRNcTQ5QWI=&amp;uid=WEEvREcwSlJHSldRa1FhdkJtNEYxa3hESGJHemFFMEVVb1VEa0hsL0w5az0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[2]</b>陈平雁.临床试验中样本量确定的统计学考虑.中国卫生统计, 2015, 32 (4) :727-731.
                            </a>
                        </p>
                        <p id="396">
                            <a id="bibliography_3" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Approximate Power for Repeated-Measures ANOVA Lacking Sphericity">

                                <b>[3]</b> Muller KE, Barton CN. Approximate Power for Repeated-Measures ANOVA Lacking Sphericity. Publications of the American Statistical Association, 1989, 84 (406) :549-555.
                            </a>
                        </p>
                        <p id="398">
                            <a id="bibliography_4" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Power calculations for general linear multivariatemodels including repeated measures applications">

                                <b>[4]</b> Muller KE, Lavange LM, Ramey SL, et al. Power Calculations for General Linear M ultivariate M odels Including Repeated M easures Applications. Journal of the American Statistical Association, 1992, 87 (420) :1209-1226.
                            </a>
                        </p>
            </div>
        <!--reference end-->
        <!--footnote start-->
        <!--footnote end-->



    </div>

        <input id="fileid" type="hidden" value="ZGWT201902043" />
        <input id="dpi" type="hidden" value="300" />
    </div>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?6e967eb120601ea41b9d312166416aa6";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
</script>

    


<input id="hid_uid" name="hid_uid" type="hidden" value="WEEvREcwSlJHSldRa1FhdkJtNEYxa3hESGJHemFFMEVVb1VEa0hsL0w5az0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
<input id="hid_kLogin_headerUrl" name="hid_kLogin_headerUrl" type="hidden" value="/KLogin/Request/GetKHeader.ashx%3Fcallback%3D%3F" />
<input id="hid_kLogin_footerUrl" name="hid_kLogin_footerUrl" type="hidden" value="/KLogin/Request/GetKFooter.ashx%3Fcallback%3D%3F" />
<div class="btn-link" style="display: none"><a target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=ZGWT201902043&amp;v=MjQxOTc0UUtESDg0dlI0VDZqNTRPM3pxcUJ0R0ZyQ1VSN3FmWnVabkZ5N21WcnZPUHlyY2VyRzRIOWpNclk5Qlo=&amp;uid=WEEvREcwSlJHSldRa1FhdkJtNEYxa3hESGJHemFFMEVVb1VEa0hsL0w5az0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">知网节</a></div>
<div class="popflow" id="popupTips" style="display: none;">
    <div class="popflowArr"></div>
    <div class="popflowCot">
        <div class="hd"><a href="javascript:void(0);" onclick="$('#popupTips').hide();$('#popupmsg').html('')" class="close">X</a></div>
        <div class="bd">
            <p class="mes" id="popupmsg" name="popupmsg"></p>
          
        </div>
    </div>
</div>
<input type="hidden" id="myexport" value="//kns.cnki.net" />

<input type="hidden" id="KPCAPIPATH" value="//ishufang.cnki.net" />
<input type="hidden" id="CitedTimes" value="" />
<div class="link" id="GLSearch" style="display: none;">
    <i class="icon-trangle"></i>
    <div class="inner">
        <a class="icon" id="copytext">复制</a>
        <a class="icon" target="_blank" onclick="searchCRFD(this)">工具书搜索</a>
    </div>
</div>




<input id="hidVirtualPath" name="hidVirtualPath" type="hidden" value="/kxreader" />
<script src="/kxreader/bundles/detail?v=842_VlRz_g1CMCLi-M0twVw-4EOFG_noWyi_OsMnrAg1"></script>

<script src="/kxreader/Scripts/layer.min.js" type="text/javascript"></script>

<div id="footerBox" class="rootw footer">
</div>
<script>
    if (typeof FlushLogin == 'function') {
        FlushLogin();
    }
    modifyEcpHeader(true);
</script>

<!--图片放大功能 start-->
<script src="/kxreader/bundles/imagebox?v=W4phPu9SNkGcuPeJclikuVE3PpRyIW_gnfjm_19nynI1"></script>

<script type="text/javascript">
    $(function () {
        var j = $.noConflict();
        j(function () {
            j(".zoom-in,.btn-zoomin").imgbox({
                'alignment': 'center',
                'allowMultiple': false,
                'overlayShow': true
            });
        })
    });
</script>
<!--图片放大功能 end-->
<div class="fixedbar">
    <div class="backtop hiddenV" id="backtop">
        <a id="backTopSide" href="javascript:scroll(0,0);" title=""></a>
    </div>
</div>
<script type="text/javascript" src="/kxreader/Scripts/MathJax-2.6-latest/MathJax.js?config=MML_HTMLorMML-full"></script>

</body>
</html>
