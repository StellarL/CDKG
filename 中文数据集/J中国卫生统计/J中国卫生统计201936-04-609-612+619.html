<!DOCTYPE html>
<html>
<head>
    <title>全文阅读--XML全文阅读--中国知网</title>
    <link rel="icon" href="/kxreader/favicon.ico" />
    <link rel="shortcut Icon" href="/kxreader/favicon.ico" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="keywords" content="文献 XML KBASE CNKI 中国知网" />
    <meta name="description" content="XML文献检索" />
    <link href="/kxreader/Content/css/detail?v=NOOK-mvTMnxl11s6oPYV0boPXN3iP4N7Rc-A56nk4KI1" rel="stylesheet"/>

    <script type="text/javascript">
        var APPPATH = '/kxreader';
    </script>
</head>

<body>
    
<script type="text/javascript" src="//login.cnki.net/TopLogin/api/loginapi/get?type=top&amp;localCSS=&amp;returnurl=%2f%2fkns.cnki.net%2fKXReader%2fDetail%3fTIMESTAMP%3d637141083179350000%26DBCODE%3dCJFD%26TABLEName%3dCJFDLAST2019%26FileName%3dZGWT201904038%26RESULT%3d1%26SIGN%3dk2jdq69v7S5%252fkzVAb0AP7%252bBtcSQ%253d"></script>

<div id="headerBox" class="header">
    <div class="topbar">
        <div class="textalign">
            <a href="/kxreader/Detail?dbcode=CJFD&amp;filename=ZGWT201904038&amp;align=md">
                <i class="icon-cen active" title="居中对齐"></i>
            </a>
            <a href="/kxreader/Detail?dbcode=CJFD&amp;filename=ZGWT201904038&amp;align=lt">
                <i class="icon-left " title="左对齐"></i>
            </a>
        </div>
        <h6 class="free-tip"><i class="icon"></i>HTML阅读开放试用阶段，欢迎体验！</h6>
    </div>
</div>

    



<div class="btn-link" style="display: none"><a target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=ZGWT201904038&amp;v=MjA3NzlLREg4NHZSNFQ2ajU0TzN6cXFCdEdGckNVUjdxZlp1Wm5GeURtVjcvTVB5cmNlckc0SDlqTXE0OUdiSVE=&amp;uid=WEEvREcwSlJHSldRa1FhdXNzY2Z1OVRsbWlROEJvNUc5VFdtU3JEQUFDdz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">知网节</a></div>

    <div class="main">

        

    <div class="sidebar-a">
        <!--sidebar start-->
        <div class="sidenav">
            <div class="arrow"><span></span></div>
            <!--sidebar_list start-->
            <dl class="sidenav-list">
                    <dt class="tit">目录结构</dt>
                            <dd class="guide">
                                    <p><a href="#28" data-title="方法与原理 ">方法与原理</a><i></i></p>
                                                                    <ul class="contentbox">
                                                <li><a href="#29" data-title="1.基于Copula函数法">1.基于Copula函数法</a></li>
                                                <li><a href="#71" data-title="2.混合指数模型法">2.混合指数模型法</a></li>
                                                <li><a href="#101" data-title="3.混合Bayes模型法">3.混合Bayes模型法</a></li>
                                    </ul>
                            </dd>
                            <dd class="guide">
                                    <p><a href="#137" data-title="讨  论 ">讨  论</a><i></i></p>
                                                            </dd>
                            <dd class="guide">
                                    <p><a href="#" data-title="文内图表 ">文内图表</a><i></i></p>
                                                                    <ul class="contentbox">
                                                <li><a href="#73" data-title="&lt;b&gt;图1&lt;/b&gt; 肿瘤患者疾病进展示意"><b>图1</b> 肿瘤患者疾病进展示意</a></li>
                                                <li><a href="#88" data-title="&lt;b&gt;图2&lt;/b&gt; PFS与OS在不同参数组合下相关关系情况(lamda2=1)"><b>图2</b> PFS与OS在不同参数组合下相关关系情况(lamda2=1)</a></li>
                                                <li><a href="#136" data-title="&lt;b&gt;表1&lt;/b&gt; 三种模拟产生具有相关关系生存时间数据方法的优缺点"><b>表1</b> 三种模拟产生具有相关关系生存时间数据方法的优缺点</a></li>
                                    </ul>
                            </dd>
                                    <dd class="guide">
                                        <h6>
                                            <p><a href="#a_bibliography">参考文献</a> </p>
                                        </h6>
                                    </dd>

            </dl>
        </div>
        <!--sidebar end-->
        &nbsp;
        <!--此处有一空格符 勿删-->
    </div>

                <div class="sidebar-b three-collumn" style="width:0;">
            <div class="refer" style="width: 0;">
                <div class="arrow off" title="参考文献"><span></span></div>
                <div class="js-scrollbox" >
                    
                    <div class="subbox active">
                        <h4>
                            <span class="tit">参考文献</span>
                            <a class="close" href="javascript:void(0)">x</a>
                        </h4>
                        <div class="side-scroller">
                            <ul class="refer-list">
                                <li id="2">


                                    <a id="bibliography_1" title=" Sargent DJ,Wieand HS,Haller DG,et al.Disease-free survival versus overall survival as a primary end point for adjuvant colon cancer studies:individual patient data from 20,898 patients on 18 randomized trials.J Clin Oncol,2005,23(34):8664-8670." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Disease-free survival versus overall survival as a primary end point for adjuvant colon cancer studies: individual patient data from 20,898 patients on 18 randomized trials">
                                        <b>[1]</b>
                                         Sargent DJ,Wieand HS,Haller DG,et al.Disease-free survival versus overall survival as a primary end point for adjuvant colon cancer studies:individual patient data from 20,898 patients on 18 randomized trials.J Clin Oncol,2005,23(34):8664-8670.
                                    </a>
                                </li>
                                <li id="4">


                                    <a id="bibliography_2" title=" Buyse M,Burzykowski T,Carroll K,et al.Progression-free survival is a surrogate for survival in advanced colorectal cancer.J Clin Oncol,2007,25(33):5218-5224." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Progression-Free Survival Is a Surrogate for Survival in Advanced Colorectal Cancer">
                                        <b>[2]</b>
                                         Buyse M,Burzykowski T,Carroll K,et al.Progression-free survival is a surrogate for survival in advanced colorectal cancer.J Clin Oncol,2007,25(33):5218-5224.
                                    </a>
                                </li>
                                <li id="6">


                                    <a id="bibliography_3" title=" Liu LY,Yu H,Bai JL,et al.Verification of the Correlation between Progression-free Survival and Overall Survival Considering Magnitudes of Survival Post-progression in the Treatment of Four Types of Cancer.Asian Pac J Cancer Prev,2015,16(3):1001-1006." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Verification of the Correlation between Progression-free Survival and Overall Survival Considering Magnitudes of Survival Post-progression in the Treatment of Four Types of Cancer">
                                        <b>[3]</b>
                                         Liu LY,Yu H,Bai JL,et al.Verification of the Correlation between Progression-free Survival and Overall Survival Considering Magnitudes of Survival Post-progression in the Treatment of Four Types of Cancer.Asian Pac J Cancer Prev,2015,16(3):1001-1006.
                                    </a>
                                </li>
                                <li id="8">


                                    <a id="bibliography_4" title=" Liu L,Yu H,Huang L,et al.Progression-free survival as a surrogate endpoint for overall survival in patients with third-line or later-line chemotherapy for advanced gastric cancer.Onco Targets Ther,2015,8:921-928." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Progression-free survival as a surrogate endpoint for overall survival in patients with thirdline or later-line chemotherapy for advanced gastric cancer">
                                        <b>[4]</b>
                                         Liu L,Yu H,Huang L,et al.Progression-free survival as a surrogate endpoint for overall survival in patients with third-line or later-line chemotherapy for advanced gastric cancer.Onco Targets Ther,2015,8:921-928.
                                    </a>
                                </li>
                                <li id="10">


                                    <a id="bibliography_5" title=" Sridhara R,Johnson JR,Justice R,et al.Review of oncology and hematology drug product approvals at the US Food and Drug Administration between July 2005 and December 2007.J Natl Cancer Inst,2010,102(4):230-243." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Review of Oncology and Hematology Drug Product Approvals at the US Food and Drug Administration Between July 2005 and December 2007">
                                        <b>[5]</b>
                                         Sridhara R,Johnson JR,Justice R,et al.Review of oncology and hematology drug product approvals at the US Food and Drug Administration between July 2005 and December 2007.J Natl Cancer Inst,2010,102(4):230-243.
                                    </a>
                                </li>
                                <li id="12">


                                    <a id="bibliography_6" title=" 刘丽亚,于浩,柏建岭,等.基于短期结局预测概率剂量筛选的Ⅱ/Ⅲ期无缝设计研究.中国卫生统计,2015,32(2):243-247." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=ZGWT201502016&amp;v=MjgzOTdvUUtESDg0dlI0VDZqNTRPM3pxcUJ0R0ZyQ1VSN3FmWnVabkZ5RG1WNy9NUHlyY2VyRzRIOVRNclk5RVk=&amp;uid=WEEvREcwSlJHSldRa1FhdXNzY2Z1OVRsbWlROEJvNUc5VFdtU3JEQUFDdz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[6]</b>
                                         刘丽亚,于浩,柏建岭,等.基于短期结局预测概率剂量筛选的Ⅱ/Ⅲ期无缝设计研究.中国卫生统计,2015,32(2):243-247.
                                    </a>
                                </li>
                                <li id="14">


                                    <a id="bibliography_7" title=" R Development Core Team.R:A Language and Environment for Statistical Computing.Vienna,Austria:the R Foundation for Statistical Computing.http://www.R-project.org/.2012." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=R: A Language and Envi-ronment for Statistical Computing">
                                        <b>[7]</b>
                                         R Development Core Team.R:A Language and Environment for Statistical Computing.Vienna,Austria:the R Foundation for Statistical Computing.http://www.R-project.org/.2012.
                                    </a>
                                </li>
                                <li id="16">


                                    <a id="bibliography_8" title=" Sklar A.Distribution functions of n dimensions and margins.Public Institute Statistical University,1959,8." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Distribution functions of n dimensions and margins">
                                        <b>[8]</b>
                                         Sklar A.Distribution functions of n dimensions and margins.Public Institute Statistical University,1959,8.
                                    </a>
                                </li>
                                <li id="18">


                                    <a id="bibliography_9" title=" Fu H,Wang Y,Liu J,et al.Joint modeling of progression-free survival and overall survival by a Bayesian normal induced copula estimation model.Stat Med,2013,32(2):240-254." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=SJWD&amp;filename=SJWD121229000563&amp;v=MDM4NTg0SkR4TTh6eFVTbURkOVNIN24zeEU5ZmJ2bktyaWZaZVp2Rnluc1U3ZkxKRjRRTmlmY2FySzZIOVBPcG85RlpP&amp;uid=WEEvREcwSlJHSldRa1FhdXNzY2Z1OVRsbWlROEJvNUc5VFdtU3JEQUFDdz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[9]</b>
                                         Fu H,Wang Y,Liu J,et al.Joint modeling of progression-free survival and overall survival by a Bayesian normal induced copula estimation model.Stat Med,2013,32(2):240-254.
                                    </a>
                                </li>
                                <li id="20">


                                    <a id="bibliography_10" title=" Chang M.Adaptive Design Theory and Implementation Using SAS and R:Chapman and Hall/CRC,2007." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Adaptive Design Theory and Implementation Using SAS and R">
                                        <b>[10]</b>
                                         Chang M.Adaptive Design Theory and Implementation Using SAS and R:Chapman and Hall/CRC,2007.
                                    </a>
                                </li>
                                <li id="22">


                                    <a id="bibliography_11" title=" Fleischer F,Gaschler-Markefski B,Bluhmki E.A statistical model for the dependence between progression-free survival and overall survival.Stat Med,2009,28(21):2669-2686." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=A statistical model for the dependence between progression-free survival and overall survival">
                                        <b>[11]</b>
                                         Fleischer F,Gaschler-Markefski B,Bluhmki E.A statistical model for the dependence between progression-free survival and overall survival.Stat Med,2009,28(21):2669-2686.
                                    </a>
                                </li>
                                <li id="24">


                                    <a id="bibliography_12" title=" Michael JR,Inc S,Schucany WR.The Mixture Approach for Simulating Bivariate Distributions With Specified Correlations.Am Stat,2002,56(1):48-54." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=STJD&amp;filename=STJD13062800002991&amp;v=MDcxODllWnRGaW5sVXJiSUtGMFFhaFk9TmpuQmFySzdIdGZPcDQ5RlpPc05CWFU0b0JNVDZUNFBRSC9pclJkR2VycVFUTW53Wg==&amp;uid=WEEvREcwSlJHSldRa1FhdXNzY2Z1OVRsbWlROEJvNUc5VFdtU3JEQUFDdz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[12]</b>
                                         Michael JR,Inc S,Schucany WR.The Mixture Approach for Simulating Bivariate Distributions With Specified Correlations.Am Stat,2002,56(1):48-54.
                                    </a>
                                </li>
                            </ul>
                            <div style='display: none;' class="zqscroller" >
                                <h4 class="">附加材料</h4>
                                <ul></ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            &nbsp;
            <!--此处有一空格符 勿删-->
        </div>

        
    <div class="content">



        <!--tips start-->
                            <div class="tips">
                    <a href="http://navi.cnki.net/KNavi/JournalDetail?pcode=CJFD&amp;pykm=ZGWT" target="_blank">中国卫生统计</a>
                2019,36(04),609-612+619             </div>
        <!--tips end-->
            <div class="top-title">
                <h1 class="title">
                    <span class="vm"><b>模拟产生具有相关关系的终点指标数据及</b>R<b>软件实现</b></span>
                                    </h1>

            </div>
                        <h2>
                                <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=au&amp;skey=%E5%BC%A0%E7%8E%B2%E4%BA%91&amp;code=42823067&amp;uid=WEEvREcwSlJHSldRa1FhdXNzY2Z1OVRsbWlROEJvNUc5VFdtU3JEQUFDdz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">张玲云</a>
                                <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=au&amp;skey=%E5%BC%A0%E6%99%93%E6%95%8F&amp;code=14200968&amp;uid=WEEvREcwSlJHSldRa1FhdXNzY2Z1OVRsbWlROEJvNUc5VFdtU3JEQUFDdz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">张晓敏</a>
                                <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=au&amp;skey=%E5%8D%93%E4%BB%81%E6%9D%B0&amp;code=08120813&amp;uid=WEEvREcwSlJHSldRa1FhdXNzY2Z1OVRsbWlROEJvNUc5VFdtU3JEQUFDdz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">卓仁杰</a>
                                <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=au&amp;skey=%E5%88%98%E4%B8%BD%E4%BA%9A&amp;code=40045729&amp;uid=WEEvREcwSlJHSldRa1FhdXNzY2Z1OVRsbWlROEJvNUc5VFdtU3JEQUFDdz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">刘丽亚</a>
                </h2>
                    <h2>
                    <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=in&amp;skey=%E5%AE%81%E6%B3%A2%E5%A4%A7%E5%AD%A6%E5%8C%BB%E5%AD%A6%E9%99%A2&amp;code=0160135&amp;uid=WEEvREcwSlJHSldRa1FhdXNzY2Z1OVRsbWlROEJvNUc5VFdtU3JEQUFDdz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">宁波大学医学院</a>
                    <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=in&amp;skey=%E5%AE%81%E6%B3%A2%E5%A4%A7%E5%AD%A6%E7%90%86%E5%AD%A6%E9%99%A2&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhdXNzY2Z1OVRsbWlROEJvNUc5VFdtU3JEQUFDdz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">宁波大学理学院</a>
            </h2>

        
<div class="link">
    <a id="aexport" class="icon icon-output"  onclick="" href="javascript:void(0);"><i></i>导出/参考文献</a>
    
    <span class="shareBoard" onmouseover="$('#sharedet').show();$('#this').addClass('shareBoardCUR')" onmouseout="$('#sharedet').hide();$('#this').removeClass('shareBoardCUR')">
        <a class="icon icon-share" href="#"><i></i>分享<em></em></a>
        <ul class="shareHide" id="sharedet" style="display: none;">
            <li><a title="复制链接" class="copy" onclick="" href="#"><i></i>复制链接</a></li>
            <li><a title="分享到新浪微博" class="xl" onclick="" href="javascript:common.ShareAction('xl');"><i></i>新浪微博</a></li>
            <li>
                <a title="分享到微信" class="wx" onclick="" href="#"><i></i>微信扫一扫</a>
                <div class="qrcode"><img src='' alt='' /></div>
            </li>
        </ul>

    </span>
    
    <a id="RefTrack" title="创建引文跟踪" class="icon icon-track" onclick="" href="javascript:void(0);"> <i></i>创建引文跟踪 </a>
    <a id="ashoucang" title="收藏" class="icon icon-favor" onclick="" href="javascript:void(0);"><i></i>收藏</a>
    <a class="icon icon-print" onclick="window.print();" href="javascript:void(0);"><i></i>打印</a>
    
    <!--版本切换 end-->
</div>
                                
        <!--brief start-->
        
            <div class="brief">
                    <p>
                            <b>作者简介：</b>
                                                        <span>
                                    *刘丽亚,E-mail:liuliya@nbu.edu.cn;
                                </span>
                    </p>
                
                    <p>

                            <b>基金：</b>
                                                        <span>国家自然科学基金青年基金(81602940);</span>
                                <span>宁波市自然科学基金项目(2017A610267; 2016A610077);</span>
                    </p>
            </div>
                                                        

        <!--brief start-->
                        <div class="p1">
                    <p id="26">肿瘤药物疗效的金标准评价指标为总生存期(overall survival,OS),但是应用该指标作为"最终"临床研究终点会使整个研发周期延长、研发成本提高。实际工作中,常常考虑应用有效的短期替代终点代替总生存期作为肿瘤药物疗效评价的"最终"临床研究终点。常见肿瘤临床试验替代终点包括肿瘤大小,无进展生存期(progression-free survival,PFS),至疾病进展生存期(time-to progression,TTP)及无病生存期(disease-free survival,DFS)等<citation id="150" type="reference"><link href="2" rel="bibliography" /><link href="4" rel="bibliography" /><sup>[<a class="sup">1</a>,<a class="sup">2</a>]</sup></citation>。目前,关于如何验证替代终点是否能够有效替代真实终点仍存在许多争议,但是,毋庸置疑的是替代终点与总生存期具有强相关关系是替代终点有效的必要条件<citation id="151" type="reference"><link href="6" rel="bibliography" /><link href="8" rel="bibliography" /><sup>[<a class="sup">3</a>,<a class="sup">4</a>]</sup></citation>。一项研究表明,2005年到2007美国食品药品监督管理局(the U.S.Food and Drug administration,FDA)批准通过的53种肿瘤新药中有9种(17%)肿瘤临床试验的研究终点指标为PFS<citation id="148" type="reference"><link href="10" rel="bibliography" /><sup>[<a class="sup">5</a>]</sup></citation>。由此可知肿瘤药物临床试验研究当中不同结局变量间普遍存在相关关系<citation id="149" type="reference"><link href="12" rel="bibliography" /><sup>[<a class="sup">6</a>]</sup></citation>。因此,关于如何模拟产生具有相关关系的生存时间数据是肿瘤临床试验模拟研究亟待解决的问题之一。</p>
                </div>
                <div class="p1">
                    <p id="27">本文介绍并讨论了三种模拟产生具有相关关系生存时间数据的方法,并通过实例介绍其R软件实现<citation id="152" type="reference"><link href="14" rel="bibliography" /><sup>[<a class="sup">7</a>]</sup></citation>。</p>
                </div>
                <h3 id="28" name="28" class="anchor-tag">方法与原理</h3>
                <h4 class="anchor-tag" id="29" name="29">1.基于Copula函数法</h4>
                <div class="p1">
                    <p id="30">目前,快速发展的Copula理论是构建具有相关非正态变量联合分布函数的有效手段之一,Copula函数实际上是一类将联合分布函数与它们各自的边缘分布函数连接在一起的函数,因此也有人将它称为连接函数。Copula函数的提出最早可以追溯到1959年,SKlar通过定理形式将多元分布与Copula函数联系起来<citation id="153" type="reference"><link href="16" rel="bibliography" /><sup>[<a class="sup">8</a>]</sup></citation>。</p>
                </div>
                <div class="p1">
                    <p id="31">Copula函数种类很多,如Gaussian,<i>t</i>,Clayton,Frank,Gumbel,Plackett Copula等,其中由于Gaussian Copula函数可根据变量边缘分布及相关系数矩阵唯一确定变量的联合分布函数,故采用Gaussian Copula函数产生具有相关关系的生存时间数据可以根据实际情况设定相关系数<i>ρ</i><citation id="154" type="reference"><link href="18" rel="bibliography" /><sup>[<a class="sup">9</a>]</sup></citation>。</p>
                </div>
                <div class="p1">
                    <p id="32">以相关的二元分布为例介绍如何应用Gaussian Copula函数构建具有相关关系的二元非正态变量<i>x</i><sub>1</sub>和<i>x</i><sub>2</sub>的联合分布函数。</p>
                </div>
                <div class="p1">
                    <p id="33">(1)模拟产生样本量为<i>N</i>相关系数为<i>ρ</i>的二元正态分布</p>
                </div>
                <div class="p1">
                    <p id="34" class="code-formula">
                        <mathml id="34"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtable columnalign="left"><mtr><mtd><mo stretchy="false">(</mo><mi>Ζ</mi><msub><mrow></mrow><mn>1</mn></msub><mo>,</mo><mi>Ζ</mi><msub><mrow></mrow><mn>2</mn></msub><mo stretchy="false">)</mo><mo>,</mo></mtd></mtr><mtr><mtd><mrow><mo>[</mo><mtable columnalign="left"><mtr><mtd><mi>Ζ</mi><msub><mrow></mrow><mn>1</mn></msub></mtd></mtr><mtr><mtd><mi>Ζ</mi><msub><mrow></mrow><mn>2</mn></msub></mtd></mtr></mtable><mo>]</mo></mrow><mo>∼</mo><mi>Ν</mi><mrow><mo>(</mo><mrow><mrow><mo>[</mo><mtable columnalign="left"><mtr><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd></mtr></mtable><mo>]</mo></mrow><mo>,</mo><mrow><mo>[</mo><mtable columnalign="left"><mtr><mtd><mn>1</mn><mtext> </mtext><mi>ρ</mi></mtd></mtr><mtr><mtd><mi>ρ</mi><mtext> </mtext><mn>1</mn></mtd></mtr></mtable><mo>]</mo></mrow></mrow><mo>)</mo></mrow><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mrow><mtext> </mtext><mtext> </mtext><mtext> </mtext></mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mtd></mtr></mtable></math></mathml>
                    </p>
                </div>
                <div class="p1">
                    <p id="35">(2)分别计算两变量<i>Z</i><sub>1</sub>和<i>Z</i><sub>2</sub>的累积分布用<i>U</i><sub>1</sub>和 <i>U</i><sub>2</sub>表示,</p>
                </div>
                <div class="p1">
                    <p id="36"><i>U</i><sub>1</sub>=<i>Φ</i>(<i>Z</i><sub>1</sub>)</p>
                </div>
                <div class="p1">
                    <p id="37"><i>U</i><sub>2</sub>=<i>Φ</i>(<i>Z</i><sub>2</sub>)      (2)</p>
                </div>
                <div class="p1">
                    <p id="38">(<i>U</i><sub>1</sub>,<i>U</i><sub>2</sub>)表示具有相关关系的二元均匀分布,范围分别为(0,1)。</p>
                </div>
                <div class="p1">
                    <p id="39">(3)假定待估计具有相关关系的二元非正态变量<i>X</i><sub>1</sub>和<i>X</i><sub>2</sub>的边际分布函数分别为,<i>F</i><sub>1</sub>(·),<i>F</i><sub>2</sub>(·)则</p>
                </div>
                <div class="p1">
                    <p id="40"><i>X</i><sub>1</sub>=<i>F</i><mathml id="141"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msubsup><mrow></mrow><mn>1</mn><mrow><mo>-</mo><mn>1</mn></mrow></msubsup></mrow></math></mathml>(<i>U</i><sub>1</sub>)</p>
                </div>
                <div class="p1">
                    <p id="41"><i>X</i><sub>2</sub>=<i>F</i><mathml id="142"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msubsup><mrow></mrow><mn>2</mn><mrow><mo>-</mo><mn>1</mn></mrow></msubsup></mrow></math></mathml>(<i>U</i><sub>2</sub>)      (3)</p>
                </div>
                <div class="p1">
                    <p id="42">假定生存时间服从指数分布,同时考虑截尾时间变量,则根据Gaussian Copula函数模拟产生具有相关关系的生存时间变量的具体步骤如下,</p>
                </div>
                <div class="p1">
                    <p id="43">(1)模拟产生样本量为<i>N</i>相关系数为<i>ρ</i>的二元正态分布(<i>Z</i><sub>1</sub>,<i>Z</i><sub>2</sub>);</p>
                </div>
                <div class="p1">
                    <p id="44">(2)依次计算二元正态分布(<i>Z</i><sub>1</sub>,<i>Z</i><sub>2</sub>)每个变量的累积分布,用(<i>U</i><sub>1</sub>,<i>U</i><sub>2</sub>)表示,即二元均匀分布,范围是(0,1);</p>
                </div>
                <div class="p1">
                    <p id="45">(3)生存时间服从指数分布,则生存时间<i>X</i>的分布函数及其反函数分别为<i>F</i>(<i>t</i>)=1-<i>e</i><sup>-</sup><sup><i>θt</i></sup>,<i>F</i><sup>-1</sup>(<i>t</i>)=-ln(1-<i>F</i><sub>1</sub>(<i>t</i>))/<i>θ</i><sub>1</sub>。将<i>U</i><sub>1</sub>看作是1-<i>F</i><sub>1</sub>(<i>t</i>)代入变量分布函数的反函数估计生存时间<i>X</i>。同理,估计生存时间<i>Y</i>;</p>
                </div>
                <div class="p1">
                    <p id="46">(4)模拟产生截尾时间变量<i>C</i> ,<i>C</i>～Uniform[0,<i>a</i>];</p>
                </div>
                <div class="p1">
                    <p id="47">(5)根据上述步骤模拟产生的(<i>X</i>,<i>Y</i>,<i>C</i>)及公式<i>Z</i><sub><i>x</i></sub>=min(<i>X</i>,<i>Y</i>,<i>C</i>),<i>Z</i><sub><i>y</i></sub>=min(<i>Y</i>,<i>C</i>),<i>δ</i><sub><i>x</i></sub>=<i>I</i>(<i>X</i>≤min(<i>Y</i>,<i>C</i>))、<i>δ</i><sub><i>y</i></sub>=<i>I</i>(<i>Y</i>≤<i>C</i>)产生TTP(即<i>Z</i><sub><i>x</i></sub>)与OS(即<i>Z</i><sub><i>y</i></sub>)变量以及相应截尾变量,<i>I</i>表示指示函数。</p>
                </div>
                <div class="p1">
                    <p id="48">另假定生存时间服从Weibull分布,考虑截尾时间变量,根据Gaussian Copula函数模拟产生具有相关关系的生存时间变量的具体步骤除第(3)步以外其余同上一致,其中第(3)步为生存时间服从Weibull分布,则生存时间<i>X</i>的分布函数及其反函数分别为,<i>F</i>(<i>t</i>)=1-<i>e</i><sup>-(</sup><sup><i>t</i></sup><sup>/</sup><sup><i>λ</i></sup><sup>)</sup><sup><i>k</i></sup>,<i>F</i><mathml id="143"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msubsup><mrow></mrow><mn>1</mn><mrow><mo>-</mo><mn>1</mn></mrow></msubsup></mrow></math></mathml>(<i>t</i>)=<i>λ</i>(-ln(1-<i>F</i><sub>1</sub>(<i>t</i>))<sup>1/</sup><sup><i>k</i></sup>。将<i>U</i><sub>1</sub>看作是1-<i>F</i><sub>1</sub>(<i>t</i>)代入变量分布函数的反函数估计生存时间<i>X</i>。同理,估计生存时间<i>Y</i>;</p>
                </div>
                <div class="p1">
                    <p id="49">例1 生成1000个相关关系为0.5的TTP与OS,要求TTP与OS的中位生存时间分别为2个月、4.5个月且截尾时间变量服从均匀分布[0,36]。</p>
                </div>
                <div class="p1">
                    <p id="50">说明:题目设定的相关系数是Copula函数指定的二元正态分布相关系数,而非TTP与OS相关系数。</p>
                </div>
                <div class="p1">
                    <p id="51">程序如下:</p>
                </div>
                <div class="area_img" id="160">
                                <img alt="" src="Detail/GetImg?filename=images/ZGWT201904038_16000.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdXNzY2Z1OVRsbWlROEJvNUc5VFdtU3JEQUFDdz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                            <p class="img_tit"></p>

                </div>
                <div class="area_img" id="160">
                                <img alt="" src="Detail/GetImg?filename=images/ZGWT201904038_16001.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdXNzY2Z1OVRsbWlROEJvNUc5VFdtU3JEQUFDdz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                            <p class="img_tit"></p>

                </div>
                <div class="p1">
                    <p id="68">另上述程序假定生存时间均服从指数分布,如生存时间服从Weibull分布的,上述生成TTP0、OS0的步骤可修改为,</p>
                </div>
                <div class="p1">
                    <p id="69">TTP0=qweibull(p1,1,2/log(2),lower.tail=TRUE,log.p=FALSE) #TTP服从中位生存时间为2的Weibull分布</p>
                </div>
                <div class="p1">
                    <p id="70">OS0=qweibull(p2,1,4.5/log(2),lower.tail=TRUE,log.p=FALSE) #OS服从中位生存时间为4.5的Weibull分布。</p>
                </div>
                <h4 class="anchor-tag" id="71" name="71">2.混合指数模型法</h4>
                <div class="p1">
                    <p id="72">肿瘤病人在死亡前常经历数次疾病进展,如图1所示,然而疾病进展后的死亡风险一般高于疾病进展前,因此构建产生生存时间数据模型时应充分考虑疾病发生发展机制。采用混合指数模型法分别模拟产生疾病进展前、后生存时间,不同阶段的死亡风险可依据实际情况设定不同参数<citation id="155" type="reference"><link href="20" rel="bibliography" /><sup>[<a class="sup">10</a>]</sup></citation>。</p>
                </div>
                <div class="area_img" id="73">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/ZGWT201904038_073.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdXNzY2Z1OVRsbWlROEJvNUc5VFdtU3JEQUFDdz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图1 肿瘤患者疾病进展示意" src="Detail/GetImg?filename=images/ZGWT201904038_073.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdXNzY2Z1OVRsbWlROEJvNUc5VFdtU3JEQUFDdz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit"><b>图1</b> 肿瘤患者疾病进展示意  <a class="btn-zoomin" href="Detail/GetImg?filename=images/ZGWT201904038_073.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdXNzY2Z1OVRsbWlROEJvNUc5VFdtU3JEQUFDdz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="p1">
                    <p id="74">假定<i>n</i>个独立随机变量均服从参数<i>λ</i><sub><i>i</i></sub>为的指数分布,<i>τ</i><sub><i>i</i></sub>～<i>f</i><sub><i>i</i></sub>(<i>τ</i><sub><i>i</i></sub>)=<i>λ</i><sub><i>i</i></sub><i>e</i><sup>-</sup><sup><i>λ</i></sup><sub><sup><i>i</i></sup></sub><sup><i>τ</i></sup><sub><sup><i>i</i></sup></sub>,(<i>τ</i><sub><i>i</i></sub>≥0),则<i>t</i>=∑<mathml id="144"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msubsup><mrow></mrow><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup></mrow></math></mathml><i>τ</i><sub><i>i</i></sub>的概率密度函数为混合Gamma分布,公式为:</p>
                </div>
                <div class="p1">
                    <p id="75"><i>f</i>(<i>t</i>;<mathml id="145"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mstyle displaystyle="true"><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow><mfrac><mrow><mi>λ</mi><msub><mrow></mrow><mi>i</mi></msub><mi>e</mi><msup><mrow></mrow><mrow><mo>-</mo><mi>λ</mi><msub><mrow></mrow><mi>i</mi></msub><mi>t</mi></mrow></msup></mrow><mrow><mstyle displaystyle="true"><msubsup><mo>∏</mo><mrow><mtable columnalign="left" rowspacing="-0.1"><mtr><mtd><mi>k</mi><mo>=</mo><mn>1</mn></mtd></mtr><mtr><mtd><mi>k</mi><mo>≠</mo><mi>i</mi></mtd></mtr></mtable></mrow><mi>n</mi></msubsup><mo stretchy="false">(</mo></mstyle><mn>1</mn><mo>-</mo><mfrac><mrow><mi>λ</mi><msub><mrow></mrow><mi>i</mi></msub></mrow><mrow><mi>λ</mi><msub><mrow></mrow><mi>k</mi></msub></mrow></mfrac><mo stretchy="false">)</mo></mrow></mfrac></mrow></mstyle><mo>,</mo><mi>t</mi><mo>&gt;</mo><mn>0</mn><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mrow><mtext> </mtext><mtext> </mtext><mtext> </mtext></mrow><mo stretchy="false">(</mo><mn>4</mn><mo stretchy="false">)</mo></mrow></math></mathml></p>
                </div>
                <div class="p1">
                    <p id="76">如果<i>k</i>≠<i>i</i>则<i>λ</i><sub><i>i</i></sub>≠<i>λ</i><sub><i>k</i></sub>。</p>
                </div>
                <div class="p1">
                    <p id="77">假定受试者只经历一次疾病进展后死亡,即<i>n</i>=2时,<i>t</i>的概率密度函数可表示为:</p>
                </div>
                <div class="p1">
                    <p id="78"><i>f</i>(<i>t</i>;<mathml id="146"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mn>2</mn><mo stretchy="false">)</mo><mo>=</mo><mfrac><mrow><mi>λ</mi><msub><mrow></mrow><mn>1</mn></msub><mi>e</mi><msup><mrow></mrow><mrow><mo>-</mo><mi>λ</mi><msub><mrow></mrow><mn>1</mn></msub><mi>t</mi></mrow></msup></mrow><mrow><mn>1</mn><mo>-</mo><mfrac><mrow><mi>λ</mi><msub><mrow></mrow><mn>1</mn></msub></mrow><mrow><mi>λ</mi><msub><mrow></mrow><mn>2</mn></msub></mrow></mfrac></mrow></mfrac><mo>+</mo><mfrac><mrow><mi>λ</mi><msub><mrow></mrow><mn>2</mn></msub><mi>e</mi><msup><mrow></mrow><mrow><mo>-</mo><mi>λ</mi><msub><mrow></mrow><mn>2</mn></msub><mi>t</mi></mrow></msup></mrow><mrow><mn>1</mn><mo>-</mo><mfrac><mrow><mi>λ</mi><msub><mrow></mrow><mn>2</mn></msub></mrow><mrow><mi>λ</mi><msub><mrow></mrow><mn>1</mn></msub></mrow></mfrac></mrow></mfrac><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mrow><mtext> </mtext><mtext> </mtext><mtext> </mtext></mrow><mo stretchy="false">(</mo><mn>5</mn><mo stretchy="false">)</mo></mrow></math></mathml></p>
                </div>
                <div class="p1">
                    <p id="79">则根据混合指数模型模拟产生具有相关关系生存时间数据的具体步骤如下:</p>
                </div>
                <div class="p1">
                    <p id="80">(1)模拟产生样本量为<i>N</i>,参数为<i>λ</i><sub>1</sub>的指数分布,TTP;</p>
                </div>
                <div class="p1">
                    <p id="81">(2)模拟产生样本量为<i>N</i>,参数为<i>λ</i><sub>2</sub>的指数分布,PPS;</p>
                </div>
                <div class="p1">
                    <p id="82">(3)OS=TTP+PPS,则将步骤(1)与步骤(2)产生的模拟数据相加得到OS。</p>
                </div>
                <div class="p1">
                    <p id="83">基于该法不能考虑受试者在疾病进展前发生死亡事件,<citation id="157" type="reference"><link href="22" rel="bibliography" />Fleischer等人于 2009</citation>年对该法进行了改进<citation id="156" type="reference"><link href="22" rel="bibliography" /><sup>[<a class="sup">11</a>]</sup></citation>。首先,假定TTP与OS存在相关关系,TTP服从参数为<i>λ</i><sub>1</sub>的指数分布。其次,引入<i>X</i>变量,表示未经历疾病进展的患者从随机化分组至死亡的时间,服从参数为<i>λ</i><sub>2</sub>的指数分布,<i>X</i>～Exp(<i>λ</i><sub>2</sub>)。由于TTP与<i>X</i>变量相互独立,设定PFS=min(TTP,<i>X</i>),则PFS仍服从指数分布,PFS～Exp(<i>λ</i><sub>1</sub>+<i>λ</i><sub>2</sub>)。最后,假定疾病进展后生存期(post-progression survival,PPS)仍服从参数为<i>λ</i><sub>3</sub>指数分布,PPS～Exp(<i>λ</i><sub>3</sub>)。因此,OS可表示为,</p>
                </div>
                <div class="p1">
                    <p id="84" class="code-formula">
                        <mathml id="84"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mtext>Ο</mtext><mtext>S</mtext><mo>=</mo><mrow><mo>{</mo><mrow><mtable columnalign="left" rowspacing="-0.1"><mtr><mtd><mtext>Ρ</mtext><mtext>F</mtext><mtext>S</mtext></mtd></mtr><mtr><mtd><mtext>Τ</mtext><mtext>Τ</mtext><mtext>Ρ</mtext><mo>+</mo><mtext>Ρ</mtext><mtext>Ρ</mtext><mtext>S</mtext></mtd></mtr></mtable><mtext> </mtext><mtable columnalign="left" rowspacing="-0.1"><mtr><mtd><mtext>i</mtext><mtext>f</mtext></mtd></mtr><mtr><mtd></mtd></mtr></mtable><mtext> </mtext><mtable columnalign="left" rowspacing="-0.1"><mtr><mtd><mtext>Ρ</mtext><mtext>F</mtext><mtext>S</mtext><mo>≠</mo><mtext>Τ</mtext><mtext>Τ</mtext><mtext>Ρ</mtext></mtd></mtr><mtr><mtd><mtext>o</mtext><mtext>t</mtext><mtext>h</mtext><mtext>e</mtext><mtext>r</mtext><mtext>w</mtext><mtext>i</mtext><mtext>s</mtext><mtext>e</mtext></mtd></mtr></mtable></mrow></mrow><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mrow><mtext> </mtext><mtext> </mtext><mtext> </mtext></mrow><mo stretchy="false">(</mo><mn>6</mn><mo stretchy="false">)</mo></mrow></math></mathml>
                    </p>
                </div>
                <div class="p1">
                    <p id="85">此时OS风险函数不再是一个常量,随着疾病进展而改变。一般来讲,疾病进展后的风险率高于进展前(<i>λ</i><sub>3</sub>&gt;<i>λ</i><sub>2</sub>,即疾病进展前死亡风险为<i>λ</i><sub>2</sub>,疾病进展后死亡风险为<i>λ</i><sub>3</sub>)。基于上述假定,PFS与OS的相关关系为:</p>
                </div>
                <div class="p1">
                    <p id="86">Corr(PFS,<mathml id="147"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mtext>Ο</mtext><mtext>S</mtext><mo stretchy="false">)</mo><mo>=</mo><mfrac><mrow><mi>λ</mi><msub><mrow></mrow><mn>3</mn></msub></mrow><mrow><msqrt><mrow><mi>λ</mi><msubsup><mrow></mrow><mn>1</mn><mn>2</mn></msubsup><mo>+</mo><mn>2</mn><mi>λ</mi><msub><mrow></mrow><mn>1</mn></msub><mi>λ</mi><msub><mrow></mrow><mn>2</mn></msub><mo>+</mo><mi>λ</mi><msubsup><mrow></mrow><mn>3</mn><mn>2</mn></msubsup></mrow></msqrt></mrow></mfrac><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mrow><mtext> </mtext><mtext> </mtext><mtext> </mtext></mrow><mo stretchy="false">(</mo><mn>7</mn><mo stretchy="false">)</mo></mrow></math></mathml></p>
                </div>
                <div class="p1">
                    <p id="87">在其他参数不变前提下,随着<i>λ</i><sub>1</sub>或<i>λ</i><sub>2</sub>的增加PFS与OS的相关关系下降,随着<i>λ</i><sub>3</sub>的增加PFS与OS的相关关系增加,见图2。</p>
                </div>
                <div class="area_img" id="88">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/ZGWT201904038_088.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdXNzY2Z1OVRsbWlROEJvNUc5VFdtU3JEQUFDdz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图2 PFS与OS在不同参数组合下相关关系情况(lamda2=1)" src="Detail/GetImg?filename=images/ZGWT201904038_088.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdXNzY2Z1OVRsbWlROEJvNUc5VFdtU3JEQUFDdz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit"><b>图2</b> PFS与OS在不同参数组合下相关关系情况(lamda2=1)  <a class="btn-zoomin" href="Detail/GetImg?filename=images/ZGWT201904038_088.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdXNzY2Z1OVRsbWlROEJvNUc5VFdtU3JEQUFDdz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>
                                <p class="img_note">*:lamda1,表示TTP服从参数为lamda1的指数分布;lamda2,表示未经历疾病进展患者从随机化分组至死亡的时间服从参数为lamda2的指数分布;lamda3,表示PPS服从参数为lamda3的指数分布;correlation表示PFS与OS相关系数。</p>

                </div>
                <div class="p1">
                    <p id="89">例2 模拟产生1000个具有相关关系的PFS与OS数据,要求TTP、PPS的中位时间分别为5个月及15个月,未经历疾病进展患者的中位生存时间为7.5个月。</p>
                </div>
                <div class="p1">
                    <p id="90">程序如下:</p>
                </div>
                <div class="area_img" id="161">
                                <img alt="" src="Detail/GetImg?filename=images/ZGWT201904038_16100.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdXNzY2Z1OVRsbWlROEJvNUc5VFdtU3JEQUFDdz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                            <p class="img_tit"></p>

                </div>
                <div class="area_img" id="161">
                                <img alt="" src="Detail/GetImg?filename=images/ZGWT201904038_16101.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdXNzY2Z1OVRsbWlROEJvNUc5VFdtU3JEQUFDdz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                            <p class="img_tit"></p>

                </div>
                <h4 class="anchor-tag" id="101" name="101">3.混合Bayes模型法</h4>
                <div class="p1">
                    <p id="102"><citation id="159" type="reference"><link href="24" rel="bibliography" />Michael等人于2002</citation>年提出一种能够精确模拟产生具有相关关系的多元分布新方法,称为混合Bayes模型法<citation id="158" type="reference"><link href="24" rel="bibliography" /><sup>[<a class="sup">12</a>]</sup></citation>。该法应用Bayes思想,易于推广,其本质是根据后验分布模拟产生与先验具有相同边际分布的样本,两个边际分布的相关关系由似然函数决定。</p>
                </div>
                <div class="p1">
                    <p id="103">假定随机变量<i>X</i><sub>1</sub>的先验分布为</p>
                </div>
                <div class="p1">
                    <p id="104"><i>g</i>(<i>x</i><sub>1</sub>;<i>θ</i>)      (8)</p>
                </div>
                <div class="p1">
                    <p id="105">参数<i>θ</i>表示多维变量;在<i>X</i><sub>1</sub>=<i>x</i>条件下,根据抽样分布<i>K</i>|(<i>X</i><sub>1</sub>=<i>x</i>)获得样本,构建似然函数可表示为</p>
                </div>
                <div class="p1">
                    <p id="106"><i>h</i>(<i>k</i>|<i>x</i><sub>1</sub>;<i>η</i>)      (9)</p>
                </div>
                <div class="p1">
                    <p id="107">将公式(8)与公式(9)相乘,得变量<i>X</i><sub>1</sub>和<i>K</i>联合分布</p>
                </div>
                <div class="p1">
                    <p id="108"><i>j</i>(<i>x</i><sub>1</sub>,<i>k</i>;<i>θ</i>,<i>η</i>)=<i>g</i>(<i>x</i><sub>1</sub>;<i>θ</i>)<i>h</i>(<i>k</i>|<i>x</i><sub>1</sub>;<i>η</i>)      (10)</p>
                </div>
                <div class="p1">
                    <p id="109">对<i>X</i><sub>1</sub>积分得<i>K</i>的边际分布</p>
                </div>
                <div class="p1">
                    <p id="110"><i>m</i>(<i>k</i>;<i>θ</i>,<i>η</i>)=∫<i>j</i>(<i>z</i>,<i>k</i>;<i>θ</i>,<i>η</i>)<i>dz</i>      (11)</p>
                </div>
                <div class="p1">
                    <p id="111">给定<i>K</i>=<i>k</i>条件下,估计<i>X</i><sub>2</sub>的后验分布</p>
                </div>
                <div class="p1">
                    <p id="112"><i>p</i>(<i>x</i><sub>2</sub>|<i>k</i>;<i>θ</i>,<i>η</i>)=<i>j</i>(<i>x</i><sub>2</sub>,<i>k</i>;<i>θ</i>,<i>η</i>)/<i>m</i>(<i>k</i>;<i>θ</i>,<i>η</i>)      (12)</p>
                </div>
                <div class="p1">
                    <p id="113">变量<i>X</i><sub>1</sub>与<i>X</i><sub>2</sub>有相同的边际分布,<i>X</i><sub>2</sub>分布为不同后验分布的加权平均,准确地再现了先验分布。假定生存时间满足Gamma分布,则变量<i>X</i><sub>1</sub>与<i>X</i><sub>2</sub>的边际分布均为Gamma分布。</p>
                </div>
                <div class="p1">
                    <p id="114">应用混合Bayes模型法模拟产生具有相关关系的生存时间变量的具体步骤如下:</p>
                </div>
                <div class="p1">
                    <p id="115">(1)确定先验分布<i>X</i><sub>1</sub>～<i>Γ</i>(<i>a</i>,<i>b</i>),根据先验分布模拟产生<i>X</i><sub>1</sub>,样本量为<i>N</i>;</p>
                </div>
                <div class="p1">
                    <p id="116">(2)由于Poisson分布的共轭先验分布是Gamma分布,因此条件抽样分布为<i>K</i>|(<i>X</i><sub>1</sub>=<i>x</i>)～Poisson(<i>τx</i>),据此分布抽样获得样本量为<i>N</i>的<i>K</i>;</p>
                </div>
                <div class="p1">
                    <p id="117">(3)根据先验以及抽样获得的<i>K</i>估计后验分布,<i>X</i><sub>2</sub>～<i>Γ</i>(<i>a</i>+<i>k</i>,<i>b</i>+<i>τ</i>);</p>
                </div>
                <div class="p1">
                    <p id="118">(4)根据每个后验分布依次模拟产生<i>X</i><sub>2</sub>,据此获得的二维随机变量(<i>X</i><sub>1</sub>,<i>X</i><sub>2</sub>)具有相关关系且边际分布均为Gamma分布,相关系数为</p>
                </div>
                <div class="p1">
                    <p id="119" class="code-formula">
                        <mathml id="119"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>ρ</mi><mo stretchy="false">(</mo><mi>x</mi><msub><mrow></mrow><mn>1</mn></msub><mo>,</mo><mi>x</mi><msub><mrow></mrow><mn>2</mn></msub><mo stretchy="false">)</mo><mo>=</mo><mfrac><mi>τ</mi><mrow><mi>b</mi><mo>+</mo><mi>τ</mi></mrow></mfrac><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mrow><mtext> </mtext><mtext> </mtext><mtext> </mtext></mrow><mo stretchy="false">(</mo><mn>1</mn><mn>3</mn><mo stretchy="false">)</mo></mrow></math></mathml>
                    </p>
                </div>
                <div class="p1">
                    <p id="120">(5)模拟产生截尾时间变量C,<i>C</i>～Uniform[0,<i>a</i>];</p>
                </div>
                <div class="p1">
                    <p id="121">(6)根据上述步骤模拟产生的(<i>X</i><sub>1</sub>,<i>X</i><sub>2</sub>,<i>C</i>)及公式<i>Z</i><sub><i>x</i></sub><sub>1</sub>=min(<i>X</i><sub>1</sub>,<i>X</i><sub>2</sub>,<i>C</i>),<i>Z</i><sub><i>x</i></sub><sub>2</sub>=min(<i>X</i><sub>2</sub>,<i>C</i>),<i>δ</i><sub><i>x</i></sub><sub>1</sub>=<i>I</i>(<i>X</i><sub>1</sub>≤min(<i>X</i><sub>2</sub>,<i>C</i>)),<i>δ</i><sub><i>x</i></sub><sub>2</sub>=<i>I</i>(<i>X</i><sub>2</sub>≤<i>C</i>)产生TTP(即<i>Z</i><sub><i>x</i></sub><sub>1</sub>)与OS(即<i>Z</i><sub><i>x</i></sub><sub>2</sub>)变量以及相应截尾变量,<i>I</i>表示指示函数。</p>
                </div>
                <div class="p1">
                    <p id="122">例3 模拟产生1000个相关系数为0.78的TTP与OS,要求TTP服从指数分布中位时间为5个月。</p>
                </div>
                <div class="p1">
                    <p id="123">说明:依据实际情况需要模拟产生生存时间数据需考虑截尾时间。本文介绍混合Bayes模型法模拟产生截尾时间变量的步骤同例1一致,故R程序一致,同时由于考虑截尾时间将会影响TTP与OS的相关关系,故本例未考虑截尾时间变量。本例模拟数据产生后可评估TTP与OS的相关系数与设定参数是否一致,从而检验模拟过程是否正确。</p>
                </div>
                <div class="p1">
                    <p id="124">程序如下:</p>
                </div>
                <div class="area_img" id="162">
                                <img alt="" src="Detail/GetImg?filename=images/ZGWT201904038_16200.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdXNzY2Z1OVRsbWlROEJvNUc5VFdtU3JEQUFDdz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                            <p class="img_tit"></p>

                </div>
                <div class="area_img" id="136">
                    <p class="img_tit"><b>表1</b> 三种模拟产生具有相关关系生存时间数据方法的优缺点 <a class="downexcel" onclick="DownLoadReportExcel(this)">导出到EXCEL</a></p>
                    <p class="img_tit"></p>
                    <p class="img_note"></p>
                    <table id="136" border="1"><tr><td><br />方法</td><td>设定相关系数</td><td>PPS</td><td>设定TTP/<br />OS中位时间</td><td>推广性</td></tr><tr><td><br />Copula函数</td><td>相关系数为Copula函数指定的二元正态分布相关系数</td><td>未考虑</td><td>设定</td><td>好</td></tr><tr><td><br />混合指数模型</td><td>相关系数受截尾数据的影响</td><td>考虑</td><td>设定</td><td>差</td></tr><tr><td><br />混合Bayes<br />模型法</td><td>相关系数受截尾数据的影响</td><td>未考虑</td><td>设定中位TTP,<br />未设定中位OS</td><td>好</td></tr></table>
                    <form name="form" action="/kxreader/Detail/DownloadReportExcel" method="POST" style="display:inline">
                        <input type="hidden" name="hidTable" value="" />
                        <input type="hidden" name="hidFileName" value="" />
                    </form>
                    <p class="img_note">*:PFS,progression-free survival,无进展生存期;TTP,time-to progression,至疾病进展生存期;PPS,post-progression survival,疾病进展后生存期。</p>
                    <p class="img_note"></p>
                </div>
                <h3 id="137" name="137" class="anchor-tag">讨  论</h3>
                <div class="p1">
                    <p id="138">关于如何模拟产生具有相关关系的生存时间数据广泛应用于研究与实践领域,主要用于评估统计分析方法的统计学性能。本文介绍了三种模拟产生具有相关系数生存时间数据的方法,其相关系数参数均能设定,但是由于截尾数据的存在,模拟设定的相关系数将会受到影响,且随截尾变量均匀分布上限的缩短而降低。</p>
                </div>
                <div class="p1">
                    <p id="139">在实际工作中应用三种方法产生模拟数据时需注意:(1)Copula函数法设定的相关系数是二元正态分布相关系数而非生存时间相关;(2)混合指数模型法可以控制PPS的长短,如果模拟试验研究考虑该变量作为研究的变化参数时,则只能采用该法产生模拟数据;(3)混合Bayes模型法不能设定中位生存时间;(4)Copula函数法和混合Bayes模型法除能模拟产生具有相关关系的生存时间变量外,也可推广应用至其他分布类型数据的模拟产生,但是应用混合Bayes模型法要求具有相关关系的先验与后验分布类型一致。</p>
                </div>
                <div class="p1">
                    <p id="140">本研究为建立一套科学、可行、又可操作的产生具有相关关系的模拟数据的方式提供依据,进而解决科研工作者在生存资料模拟研究中关于产生模拟数据的困惑。本研究的局限性在于产生截尾时间数据的方式均基于均匀分布且截尾类型仅考虑右侧截尾情况,因此在实际工作中产生模拟数据的方式需依据实际情况而定。</p>
                </div>

        <!--brief end-->
        
        <!--conten left  end-->
        <!--增强附件-->
        

        <!--reference start-->
            <div class="reference anchor-tag" id="a_bibliography">
                    <h3>参考文献</h3>
                                        <p id="2">
                            <a id="bibliography_1" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Disease-free survival versus overall survival as a primary end point for adjuvant colon cancer studies: individual patient data from 20,898 patients on 18 randomized trials">

                                <b>[1]</b> Sargent DJ,Wieand HS,Haller DG,et al.Disease-free survival versus overall survival as a primary end point for adjuvant colon cancer studies:individual patient data from 20,898 patients on 18 randomized trials.J Clin Oncol,2005,23(34):8664-8670.
                            </a>
                        </p>
                        <p id="4">
                            <a id="bibliography_2" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Progression-Free Survival Is a Surrogate for Survival in Advanced Colorectal Cancer">

                                <b>[2]</b> Buyse M,Burzykowski T,Carroll K,et al.Progression-free survival is a surrogate for survival in advanced colorectal cancer.J Clin Oncol,2007,25(33):5218-5224.
                            </a>
                        </p>
                        <p id="6">
                            <a id="bibliography_3" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Verification of the Correlation between Progression-free Survival and Overall Survival Considering Magnitudes of Survival Post-progression in the Treatment of Four Types of Cancer">

                                <b>[3]</b> Liu LY,Yu H,Bai JL,et al.Verification of the Correlation between Progression-free Survival and Overall Survival Considering Magnitudes of Survival Post-progression in the Treatment of Four Types of Cancer.Asian Pac J Cancer Prev,2015,16(3):1001-1006.
                            </a>
                        </p>
                        <p id="8">
                            <a id="bibliography_4" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Progression-free survival as a surrogate endpoint for overall survival in patients with thirdline or later-line chemotherapy for advanced gastric cancer">

                                <b>[4]</b> Liu L,Yu H,Huang L,et al.Progression-free survival as a surrogate endpoint for overall survival in patients with third-line or later-line chemotherapy for advanced gastric cancer.Onco Targets Ther,2015,8:921-928.
                            </a>
                        </p>
                        <p id="10">
                            <a id="bibliography_5" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Review of Oncology and Hematology Drug Product Approvals at the US Food and Drug Administration Between July 2005 and December 2007">

                                <b>[5]</b> Sridhara R,Johnson JR,Justice R,et al.Review of oncology and hematology drug product approvals at the US Food and Drug Administration between July 2005 and December 2007.J Natl Cancer Inst,2010,102(4):230-243.
                            </a>
                        </p>
                        <p id="12">
                            <a id="bibliography_6" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=ZGWT201502016&amp;v=MjQ0OTFNclk5RVlvUUtESDg0dlI0VDZqNTRPM3pxcUJ0R0ZyQ1VSN3FmWnVabkZ5RG1WNy9NUHlyY2VyRzRIOVQ=&amp;uid=WEEvREcwSlJHSldRa1FhdXNzY2Z1OVRsbWlROEJvNUc5VFdtU3JEQUFDdz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[6]</b> 刘丽亚,于浩,柏建岭,等.基于短期结局预测概率剂量筛选的Ⅱ/Ⅲ期无缝设计研究.中国卫生统计,2015,32(2):243-247.
                            </a>
                        </p>
                        <p id="14">
                            <a id="bibliography_7" target="_blank" href="http://scholar.cnki.net/result.aspx?q=R: A Language and Envi-ronment for Statistical Computing">

                                <b>[7]</b> R Development Core Team.R:A Language and Environment for Statistical Computing.Vienna,Austria:the R Foundation for Statistical Computing.http://www.R-project.org/.2012.
                            </a>
                        </p>
                        <p id="16">
                            <a id="bibliography_8" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Distribution functions of n dimensions and margins">

                                <b>[8]</b> Sklar A.Distribution functions of n dimensions and margins.Public Institute Statistical University,1959,8.
                            </a>
                        </p>
                        <p id="18">
                            <a id="bibliography_9" target="_blank" href="/kcms/detail/detail.aspx?dbcode=SJWD&amp;filename=SJWD121229000563&amp;v=MzE4MDBVN2ZMSkY0UU5pZmNhcks2SDlQT3BvOUZaTzRKRHhNOHp4VVNtRGQ5U0g3bjN4RTlmYnZuS3JpZlplWnZGeW5z&amp;uid=WEEvREcwSlJHSldRa1FhdXNzY2Z1OVRsbWlROEJvNUc5VFdtU3JEQUFDdz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[9]</b> Fu H,Wang Y,Liu J,et al.Joint modeling of progression-free survival and overall survival by a Bayesian normal induced copula estimation model.Stat Med,2013,32(2):240-254.
                            </a>
                        </p>
                        <p id="20">
                            <a id="bibliography_10" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Adaptive Design Theory and Implementation Using SAS and R">

                                <b>[10]</b> Chang M.Adaptive Design Theory and Implementation Using SAS and R:Chapman and Hall/CRC,2007.
                            </a>
                        </p>
                        <p id="22">
                            <a id="bibliography_11" target="_blank" href="http://scholar.cnki.net/result.aspx?q=A statistical model for the dependence between progression-free survival and overall survival">

                                <b>[11]</b> Fleischer F,Gaschler-Markefski B,Bluhmki E.A statistical model for the dependence between progression-free survival and overall survival.Stat Med,2009,28(21):2669-2686.
                            </a>
                        </p>
                        <p id="24">
                            <a id="bibliography_12" target="_blank" href="/kcms/detail/detail.aspx?dbcode=STJD&amp;filename=STJD13062800002991&amp;v=MTUxMjNUNlQ0UFFIL2lyUmRHZXJxUVRNbndaZVp0RmlubFVyYklLRjBRYWhZPU5qbkJhcks3SHRmT3A0OUZaT3NOQlhVNG9CTQ==&amp;uid=WEEvREcwSlJHSldRa1FhdXNzY2Z1OVRsbWlROEJvNUc5VFdtU3JEQUFDdz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[12]</b> Michael JR,Inc S,Schucany WR.The Mixture Approach for Simulating Bivariate Distributions With Specified Correlations.Am Stat,2002,56(1):48-54.
                            </a>
                        </p>
            </div>
        <!--reference end-->
        <!--footnote start-->
        <!--footnote end-->



    </div>

        <input id="fileid" type="hidden" value="ZGWT201904038" />
        <input id="dpi" type="hidden" value="300" />
    </div>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?6e967eb120601ea41b9d312166416aa6";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
</script>

    


<input id="hid_uid" name="hid_uid" type="hidden" value="WEEvREcwSlJHSldRa1FhdXNzY2Z1OVRsbWlROEJvNUc5VFdtU3JEQUFDdz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
<input id="hid_kLogin_headerUrl" name="hid_kLogin_headerUrl" type="hidden" value="/KLogin/Request/GetKHeader.ashx%3Fcallback%3D%3F" />
<input id="hid_kLogin_footerUrl" name="hid_kLogin_footerUrl" type="hidden" value="/KLogin/Request/GetKFooter.ashx%3Fcallback%3D%3F" />
<div class="btn-link" style="display: none"><a target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=ZGWT201904038&amp;v=MjA3NzlLREg4NHZSNFQ2ajU0TzN6cXFCdEdGckNVUjdxZlp1Wm5GeURtVjcvTVB5cmNlckc0SDlqTXE0OUdiSVE=&amp;uid=WEEvREcwSlJHSldRa1FhdXNzY2Z1OVRsbWlROEJvNUc5VFdtU3JEQUFDdz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">知网节</a></div>
<div class="popflow" id="popupTips" style="display: none;">
    <div class="popflowArr"></div>
    <div class="popflowCot">
        <div class="hd"><a href="javascript:void(0);" onclick="$('#popupTips').hide();$('#popupmsg').html('')" class="close">X</a></div>
        <div class="bd">
            <p class="mes" id="popupmsg" name="popupmsg"></p>
          
        </div>
    </div>
</div>
<input type="hidden" id="myexport" value="//kns.cnki.net" />

<input type="hidden" id="KPCAPIPATH" value="//ishufang.cnki.net" />
<input type="hidden" id="CitedTimes" value="" />
<div class="link" id="GLSearch" style="display: none;">
    <i class="icon-trangle"></i>
    <div class="inner">
        <a class="icon" id="copytext">复制</a>
        <a class="icon" target="_blank" onclick="searchCRFD(this)">工具书搜索</a>
    </div>
</div>




<input id="hidVirtualPath" name="hidVirtualPath" type="hidden" value="/kxreader" />
<script src="/kxreader/bundles/detail?v=842_VlRz_g1CMCLi-M0twVw-4EOFG_noWyi_OsMnrAg1"></script>

<script src="/kxreader/Scripts/layer.min.js" type="text/javascript"></script>

<div id="footerBox" class="rootw footer">
</div>
<script>
    if (typeof FlushLogin == 'function') {
        FlushLogin();
    }
    modifyEcpHeader(true);
</script>

<!--图片放大功能 start-->
<script src="/kxreader/bundles/imagebox?v=W4phPu9SNkGcuPeJclikuVE3PpRyIW_gnfjm_19nynI1"></script>

<script type="text/javascript">
    $(function () {
        var j = $.noConflict();
        j(function () {
            j(".zoom-in,.btn-zoomin").imgbox({
                'alignment': 'center',
                'allowMultiple': false,
                'overlayShow': true
            });
        })
    });
</script>
<!--图片放大功能 end-->
<div class="fixedbar">
    <div class="backtop hiddenV" id="backtop">
        <a id="backTopSide" href="javascript:scroll(0,0);" title=""></a>
    </div>
</div>
<script type="text/javascript" src="/kxreader/Scripts/MathJax-2.6-latest/MathJax.js?config=MML_HTMLorMML-full"></script>

</body>
</html>
