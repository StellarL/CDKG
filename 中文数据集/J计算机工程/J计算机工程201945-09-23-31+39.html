<!DOCTYPE html>
<html>
<head>
    <title>全文阅读--XML全文阅读--中国知网</title>
    <link rel="icon" href="/kxreader/favicon.ico" />
    <link rel="shortcut Icon" href="/kxreader/favicon.ico" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="keywords" content="文献 XML KBASE CNKI 中国知网" />
    <meta name="description" content="XML文献检索" />
    <link href="/kxreader/Content/css/detail?v=qX2z2KjRAEyQiNfAbKtl7dLnsqFoQ5Jdw3TZfDf0n1k1" rel="stylesheet"/>

    <script type="text/javascript">
        var APPPATH = '/kxreader';
    </script>
</head>

<body>
    
<script type="text/javascript" src="//login.cnki.net/TopLogin/api/loginapi/get?type=top&amp;localCSS=&amp;returnurl=%2f%2fkns.cnki.net%2f%2fKXReader%2fDetail%3fTIMESTAMP%3d637126275752583750%26DBCODE%3dCJFD%26TABLEName%3dCJFDLAST2019%26FileName%3dJSJC201909004%26RESULT%3d1%26SIGN%3dLPVkmILtqsxy0Biq8hmAB%252bOqp5I%253d"></script>

<div id="headerBox" class="header">
    <div class="topbar">
        <div class="textalign">
            <a href="/kxreader/Detail?dbcode=CJFD&amp;filename=JSJC201909004&amp;align=md">
                <i class="icon-cen active" title="居中对齐"></i>
            </a>
            <a href="/kxreader/Detail?dbcode=CJFD&amp;filename=JSJC201909004&amp;align=lt">
                <i class="icon-left " title="左对齐"></i>
            </a>
        </div>
        <h6 class="free-tip"><i class="icon"></i>HTML阅读开放试用阶段，欢迎体验！</h6>
    </div>
</div>

    



<div class="btn-link" style="display: none"><a target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JSJC201909004&amp;v=Mjg4NDRSTE9lWmVSdEZ5SGtVcnJJTHo3QmJiRzRIOWpNcG85RllJUUtESDg0dlI0VDZqNTRPM3pxcUJ0R0ZyQ1U=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU40eEVEZ0d2Qys0RlVmUWpwd0I5dz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">知网节</a></div>

    <div class="main">

        

    <div class="sidebar-a">
        <!--sidebar start-->
        <div class="sidenav">
            <div class="arrow"><span></span></div>
            <!--sidebar_list start-->
            <dl class="sidenav-list">
                    <dt class="tit">目录结构</dt>
                            <dd class="guide">
                                    <p><a href="#49" data-title="0 概述 ">0 概述</a><i></i></p>
                                                            </dd>
                            <dd class="guide">
                                    <p><a href="#54" data-title="1 相关理论及技术 ">1 相关理论及技术</a><i></i></p>
                                                                    <ul class="contentbox">
                                                <li><a href="#55" data-title="1.1 PageRank算法">1.1 PageRank算法</a></li>
                                                <li><a href="#65" data-title="1.2 数据并行原语">1.2 数据并行原语</a></li>
                                                <li><a href="#70" data-title="1.3 稀疏矩阵压缩存储格式">1.3 稀疏矩阵压缩存储格式</a></li>
                                    </ul>
                            </dd>
                            <dd class="guide">
                                    <p><a href="#88" data-title="2 基于BRCP的SpMV计算 ">2 基于BRCP的SpMV计算</a><i></i></p>
                                                                    <ul class="contentbox">
                                                <li><a href="#92" data-title="2.1 BRCP分块策略">2.1 BRCP分块策略</a></li>
                                                <li><a href="#122" data-title="2.2 基于BRCP的SpMV内核线程执行">2.2 基于BRCP的SpMV内核线程执行</a></li>
                                    </ul>
                            </dd>
                            <dd class="guide">
                                    <p><a href="#160" data-title="3 实验结果与分析 ">3 实验结果与分析</a><i></i></p>
                                                                    <ul class="contentbox">
                                                <li><a href="#164" data-title="3.1 SpMV计算耗时">3.1 SpMV计算耗时</a></li>
                                                <li><a href="#172" data-title="3.2 SpMV结果向量的相对误差">3.2 SpMV结果向量的相对误差</a></li>
                                                <li><a href="#177" data-title="3.3 PageRank排序耗时">3.3 PageRank排序耗时</a></li>
                                                <li><a href="#184" data-title="3.4 PageRank排序结果准确率">3.4 PageRank排序结果准确率</a></li>
                                    </ul>
                            </dd>
                            <dd class="guide">
                                    <p><a href="#189" data-title="4 结束语 ">4 结束语</a><i></i></p>
                                                            </dd>
                            <dd class="guide">
                                    <p><a href="#" data-title="文内图表 ">文内图表</a><i></i></p>
                                                                    <ul class="contentbox">
                                                <li><a href="#87" data-title="&lt;b&gt;图1 BRC格式的内存布局&lt;/b&gt;"><b>图1 BRC格式的内存布局</b></a></li>
                                                <li><a href="#90" data-title="&lt;b&gt;图2 基于BRC格式的SpMV内核线程执行结果&lt;/b&gt;"><b>图2 基于BRC格式的SpMV内核线程执行结果</b></a></li>
                                                <li><a href="#94" data-title="&lt;b&gt;图3 BRCP格式的内存布局&lt;/b&gt;"><b>图3 BRCP格式的内存布局</b></a></li>
                                                <li><a href="#125" data-title="&lt;b&gt;图4 基于BRCP格式的SpMV内核线程执行结果&lt;/b&gt;"><b>图4 基于BRCP格式的SpMV内核线程执行结果</b></a></li>
                                                <li><a href="#142" data-title="&lt;b&gt;图5 快速分段求和算法&lt;/b&gt;"><b>图5 快速分段求和算法</b></a></li>
                                                <li><a href="#162" data-title="&lt;b&gt;表1 GPU各项性能指标&lt;/b&gt;"><b>表1 GPU各项性能指标</b></a></li>
                                                <li><a href="#167" data-title="&lt;b&gt;表2 SpMV稀疏矩阵集&lt;/b&gt;"><b>表2 SpMV稀疏矩阵集</b></a></li>
                                                <li><a href="#169" data-title="&lt;b&gt;图6 GeForce GT 650M平台上BRC与BRCP的SpMV耗时比较&lt;/b&gt;"><b>图6 GeForce GT 650M平台上BRC与BRCP的SpMV耗时比较</b></a></li>
                                                <li><a href="#170" data-title="&lt;b&gt;图7 GeForce GTX 1080Ti平台上BRC与BRCP的SpMV耗时比较&lt;/b&gt;"><b>图7 GeForce GTX 1080Ti平台上BRC与BRCP的SpMV耗时比较</b></a></li>
                                                <li><a href="#176" data-title="&lt;b&gt;表3 BRC与BRCP的SpMV相对误差比较&lt;/b&gt;"><b>表3 BRC与BRCP的SpMV相对误差比较</b></a></li>
                                                <li><a href="#179" data-title="&lt;b&gt;表4 PageRank稀疏矩阵集&lt;/b&gt;"><b>表4 PageRank稀疏矩阵集</b></a></li>
                                                <li><a href="#181" data-title="&lt;b&gt;图8 GeForce GT 650M平台上基于LightSpMV、BRC和BRCP格式的PageRank耗时比较&lt;/b&gt;"><b>图8 GeForce GT 650M平台上基于LightSpMV、BRC和BRCP格式的PageRank耗时比较</b></a></li>
                                                <li><a href="#182" data-title="&lt;b&gt;图9 GeForce GTX 1080Ti平台上基于LightSpMV、BRC和BRCP格式的PageRank耗时比较&lt;/b&gt;"><b>图9 GeForce GTX 1080Ti平台上基于LightSpMV、BRC和BRCP格式的PageRank耗时比较</b></a></li>
                                                <li><a href="#186" data-title="&lt;b&gt;图10 GeForce GT 650M平台上BRC与BRCP前100个结果向量的准确率比较&lt;/b&gt;"><b>图10 GeForce GT 650M平台上BRC与BRCP前100个结果向量的准确率比较</b></a></li>
                                                <li><a href="#187" data-title="&lt;b&gt;图11 GeForce GTX 1080Ti平台上BRC与BRCP前100个结果向量的准确率比较&lt;/b&gt;"><b>图11 GeForce GTX 1080Ti平台上BRC与BRCP前100个结果向量的准确率比较</b></a></li>
                                    </ul>
                            </dd>
                                    <dd class="guide">
                                        <h6>
                                            <p><a href="#a_bibliography">参考文献</a> </p>
                                        </h6>
                                    </dd>

            </dl>
        </div>
        <!--sidebar end-->
        &nbsp;
        <!--此处有一空格符 勿删-->
    </div>

                <div class="sidebar-b three-collumn" style="width:0;">
            <div class="refer" style="width: 0;">
                <div class="arrow off" title="参考文献"><span></span></div>
                <div class="js-scrollbox" >
                    
                    <div class="subbox active">
                        <h4>
                            <span class="tit">参考文献</span>
                            <a class="close" href="javascript:void(0)">x</a>
                        </h4>
                        <div class="side-scroller">
                            <ul class="refer-list">
                                <li id="231">


                                    <a id="bibliography_1" title=" 尹孟嘉,许先斌,何水兵,等.GPU稀疏矩阵向量乘的性能模型构造[J].计算机科学,2017,44(4):182-187." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JSJA201704041&amp;v=MjUyNjRiN0c0SDliTXE0OUJaWVFLREg4NHZSNFQ2ajU0TzN6cXFCdEdGckNVUkxPZVplUnRGeUhrVXJySUx6N0I=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU40eEVEZ0d2Qys0RlVmUWpwd0I5dz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[1]</b>
                                         尹孟嘉,许先斌,何水兵,等.GPU稀疏矩阵向量乘的性能模型构造[J].计算机科学,2017,44(4):182-187.
                                    </a>
                                </li>
                                <li id="233">


                                    <a id="bibliography_2" title=" BRIN S,PAGE L.The anatomy of a large-scale hypertextual Web search engine[J].Computer Networks and ISDN Systems,1998,30(1):107-117." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=The anatomy of a large-scale hypertextual web search engine">
                                        <b>[2]</b>
                                         BRIN S,PAGE L.The anatomy of a large-scale hypertextual Web search engine[J].Computer Networks and ISDN Systems,1998,30(1):107-117.
                                    </a>
                                </li>
                                <li id="235">


                                    <a id="bibliography_3" title=" TONG Hanghang,FALOUTSOS C,PAN Jiayu.Random walk with restart:fast solutions and applications[J].Knowledge and Information Systems,2008,14(3):327-346." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=SPQD&amp;filename=SPQD00000835797&amp;v=MDAzMDRidWR0RkN2bFdyN0pKVjQ9TmozYWFyTzRIdEhNcDR4QVkrSUlZM2s1ekJkaDRqOTlTWHFScnhveGNNSDdSN3Fl&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU40eEVEZ0d2Qys0RlVmUWpwd0I5dz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[3]</b>
                                         TONG Hanghang,FALOUTSOS C,PAN Jiayu.Random walk with restart:fast solutions and applications[J].Knowledge and Information Systems,2008,14(3):327-346.
                                    </a>
                                </li>
                                <li id="237">


                                    <a id="bibliography_4" title=" LANGR D,TVRD&#205;K P.Evaluation criteria for sparse matrix storage formats[J].IEEE Transactions on Parallel and Distributed Systems,2016,27(2):428-440." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Evaluation criteria for sparse matrix storage formats">
                                        <b>[4]</b>
                                         LANGR D,TVRD&#205;K P.Evaluation criteria for sparse matrix storage formats[J].IEEE Transactions on Parallel and Distributed Systems,2016,27(2):428-440.
                                    </a>
                                </li>
                                <li id="239">


                                    <a id="bibliography_5" title=" 李佳佳,张秀霞,谭光明,等.选择稀疏矩阵乘法最优存储格式的研究[J].计算机研究与发展,2014,51(4):882-894." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JFYZ201404019&amp;v=MjA3MjdUNmo1NE8zenFxQnRHRnJDVVJMT2VaZVJ0RnlIa1VycklMeXZTZExHNEg5WE1xNDlFYllRS0RIODR2UjQ=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU40eEVEZ0d2Qys0RlVmUWpwd0I5dz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[5]</b>
                                         李佳佳,张秀霞,谭光明,等.选择稀疏矩阵乘法最优存储格式的研究[J].计算机研究与发展,2014,51(4):882-894.
                                    </a>
                                </li>
                                <li id="241">


                                    <a id="bibliography_6" title=" 刘芳芳,杨超,袁欣辉,等.面向国产申威26010众核处理器的SpMV实现与优化[J].软件学报,2018,29(12):3921-3932." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=RJXB201812020&amp;v=MDEyNzZaSVFLREg4NHZSNFQ2ajU0TzN6cXFCdEdGckNVUkxPZVplUnRGeUhrVXJySU55ZlRiTEc0SDluTnJZOUg=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU40eEVEZ0d2Qys0RlVmUWpwd0I5dz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[6]</b>
                                         刘芳芳,杨超,袁欣辉,等.面向国产申威26010众核处理器的SpMV实现与优化[J].软件学报,2018,29(12):3921-3932.
                                    </a>
                                </li>
                                <li id="243">


                                    <a id="bibliography_7" title=" LINDHOLM E,NICKOLLS J,OBERMAN S,et al.NVIDIA Tesla:a unified graphics and computing architecture[J].IEEE Micro,2008,28(2):39-55." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=NVIDIA Tesla: A unified graphics and computing architecture">
                                        <b>[7]</b>
                                         LINDHOLM E,NICKOLLS J,OBERMAN S,et al.NVIDIA Tesla:a unified graphics and computing architecture[J].IEEE Micro,2008,28(2):39-55.
                                    </a>
                                </li>
                                <li id="245">


                                    <a id="bibliography_8" title=" MAGGIONI M,BERGER-WOLF T.Optimization techniques for sparse matrix-vector multiplication on GPUs[J].Journal of Parallel and Distributed Computing,2016,93(C):66-86." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Optimization techniques for sparse matrix-vector multiplication on GPUs">
                                        <b>[8]</b>
                                         MAGGIONI M,BERGER-WOLF T.Optimization techniques for sparse matrix-vector multiplication on GPUs[J].Journal of Parallel and Distributed Computing,2016,93(C):66-86.
                                    </a>
                                </li>
                                <li id="247">


                                    <a id="bibliography_9" title=" 张珩,张立波,武延军.基于Multi-GPU平台的大规模图数据处理[J].计算机研究与发展,2018,55(2):273-288." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JFYZ201802006&amp;v=MjAzMDY0VDZqNTRPM3pxcUJ0R0ZyQ1VSTE9lWmVSdEZ5SGtVcnJJTHl2U2RMRzRIOW5Nclk5RllvUUtESDg0dlI=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU40eEVEZ0d2Qys0RlVmUWpwd0I5dz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[9]</b>
                                         张珩,张立波,武延军.基于Multi-GPU平台的大规模图数据处理[J].计算机研究与发展,2018,55(2):273-288.
                                    </a>
                                </li>
                                <li id="249">


                                    <a id="bibliography_10" title=" 程凯,田瑾,马瑞琳.基于GPU的高效稀疏矩阵存储格式研究[J].计算机工程,2018,44(8):54-60." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JSJC201808010&amp;v=MDMwMjdUNmo1NE8zenFxQnRHRnJDVVJMT2VaZVJ0RnlIa1VycklMejdCYmJHNEg5bk1wNDlFWklRS0RIODR2UjQ=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU40eEVEZ0d2Qys0RlVmUWpwd0I5dz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[10]</b>
                                         程凯,田瑾,马瑞琳.基于GPU的高效稀疏矩阵存储格式研究[J].计算机工程,2018,44(8):54-60.
                                    </a>
                                </li>
                                <li id="251">


                                    <a id="bibliography_11" title=" LIU Yongchao,SCHMIDT B.LightSpMV:faster CUDA-compatible sparse matrix-vector multiplication using compressed sparse rows[J].Journal of Signal Processing Systems,2018,90(1):69-86." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=LightSpMV:faster CUDA-compatible sparse matrix-vector multiplication using compressed sparse rows">
                                        <b>[11]</b>
                                         LIU Yongchao,SCHMIDT B.LightSpMV:faster CUDA-compatible sparse matrix-vector multiplication using compressed sparse rows[J].Journal of Signal Processing Systems,2018,90(1):69-86.
                                    </a>
                                </li>
                                <li id="253">


                                    <a id="bibliography_12" title=" LIU Weifeng,VINTER B.CSR5:an efficient storage format for cross-platform sparse matrix-vector multiplication[C]//Proceedings of ACM International Conference on Supercomputing.New York,USA:ACM Press,2015:339-350." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=CSR5:An Efficient Storage Format for Cross-Platform Sparse Matrix-Vector Multiplication">
                                        <b>[12]</b>
                                         LIU Weifeng,VINTER B.CSR5:an efficient storage format for cross-platform sparse matrix-vector multiplication[C]//Proceedings of ACM International Conference on Supercomputing.New York,USA:ACM Press,2015:339-350.
                                    </a>
                                </li>
                                <li id="255">


                                    <a id="bibliography_13" title=" ASHARI A,SEDAGHATI N,EISENLOHR J,et al.An efficient two-dimensional blocking strategy for sparse matrix-vector multiplication on GPUs[M].Berlin,Germany:Springer,2014." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=An efficient two-dimensional blocking strategy for sparse matrix-vector multiplication on GPUs">
                                        <b>[13]</b>
                                         ASHARI A,SEDAGHATI N,EISENLOHR J,et al.An efficient two-dimensional blocking strategy for sparse matrix-vector multiplication on GPUs[M].Berlin,Germany:Springer,2014.
                                    </a>
                                </li>
                                <li id="257">


                                    <a id="bibliography_14" title=" ASHARI A,SEDAGHATI N,EISENLOHR J,et al.A model-driven blocking strategy for load balanced sparse matrix-vector multiplication on GPUs[J].Journal of Parallel and Distributed Computing,2015,76:3-15." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=SJES&amp;filename=SJES14121200056754&amp;v=MjI0NTBQTnJZOUZaTzRKQzNrOW9CTVQ2VDRQUUgvaXJSZEdlcnFRVE1ud1plWnVIeWptVUx6SUtWOFZieEk9TmlmT2ZiSzhIOQ==&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU40eEVEZ0d2Qys0RlVmUWpwd0I5dz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[14]</b>
                                         ASHARI A,SEDAGHATI N,EISENLOHR J,et al.A model-driven blocking strategy for load balanced sparse matrix-vector multiplication on GPUs[J].Journal of Parallel and Distributed Computing,2015,76:3-15.
                                    </a>
                                </li>
                                <li id="259">


                                    <a id="bibliography_15" title=" WILKINSON J H.Error analysis of floating-point computation[J].Numerische Mathematik,1960,2(1):319-340." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=SSJD&amp;filename=SSJD00002467916&amp;v=MTMzNDA0ajk5U1hxUnJ4b3hjTUg3UjdxZWJ1ZHRGQ3ZsV3I3SkpWND1OajdCYXJPNEh0SE9xNGxDYmVvSlkzazV6QmRo&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU40eEVEZ0d2Qys0RlVmUWpwd0I5dz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[15]</b>
                                         WILKINSON J H.Error analysis of floating-point computation[J].Numerische Mathematik,1960,2(1):319-340.
                                    </a>
                                </li>
                                <li id="261">


                                    <a id="bibliography_16" title=" HILLIS W D,STEELE G L.Data parallel algorithms[J].Communications of the ACM,1986,29(12):1170-1183." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=SJCM&amp;filename=SJCM13091000025778&amp;v=MjEwNTJlcnFRVE1ud1plWnVIeWptVUx6SUtWOFZieEk9TmlmSVk3SzdIdGpOcjQ5RlpPa0tDM3N4b0JNVDZUNFBRSC9pclJkRw==&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU40eEVEZ0d2Qys0RlVmUWpwd0I5dz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[16]</b>
                                         HILLIS W D,STEELE G L.Data parallel algorithms[J].Communications of the ACM,1986,29(12):1170-1183.
                                    </a>
                                </li>
                                <li id="263">


                                    <a id="bibliography_17" title=" HARRIS M,SENGUPTA S,OWENS J D.Parallel prefix sum(scan) with CUDA[M]//NGUYEN H.GPU Gems 3.New Jersey,USA:Addison Wesley,2007:851-876." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Parallel prefix sum (scan)with CUDA">
                                        <b>[17]</b>
                                         HARRIS M,SENGUPTA S,OWENS J D.Parallel prefix sum(scan) with CUDA[M]//NGUYEN H.GPU Gems 3.New Jersey,USA:Addison Wesley,2007:851-876.
                                    </a>
                                </li>
                                <li id="265">


                                    <a id="bibliography_18" title=" SENGUPTA S,HARRIS M,ZHANG Yao,et al.Scan primitives for GPU computing[C]//Proceedings of ACM SIGGRAPH/EUROGRAPHICS Symposium on Graphics Hardware.New York,USA:ACM Press,2007:97-106." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Scan primitives for gpu computing">
                                        <b>[18]</b>
                                         SENGUPTA S,HARRIS M,ZHANG Yao,et al.Scan primitives for GPU computing[C]//Proceedings of ACM SIGGRAPH/EUROGRAPHICS Symposium on Graphics Hardware.New York,USA:ACM Press,2007:97-106.
                                    </a>
                                </li>
                                <li id="267">


                                    <a id="bibliography_19" title=" FILIPPONE S,CARDELLINI V,BARBIERI D,et al.Sparse matrix-vector multiplication on GPGPUs[J].ACM Transactions on Mathematical Software,2017,43(4):1-49." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=SJCM&amp;filename=SJCM85EC429A7979D3512703E09658F8C844&amp;v=MTcyNjhhQnVIWWZPR1FsZkNwYlEzNU50aHpibSt4YWc9TmlmSVk3dTlhNkxJcllZMFkrSUlCUWc2eWhjUjdUOStQWC9ycWhjOUQ3cm5UYjZiQ09OdkZTaVdXcjdKSUZwbQ==&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU40eEVEZ0d2Qys0RlVmUWpwd0I5dz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[19]</b>
                                         FILIPPONE S,CARDELLINI V,BARBIERI D,et al.Sparse matrix-vector multiplication on GPGPUs[J].ACM Transactions on Mathematical Software,2017,43(4):1-49.
                                    </a>
                                </li>
                                <li id="269">


                                    <a id="bibliography_20" title=" BLELLOCH G E,HEROUX M A,ZAGHA M.Segmented operations for sparse matrix computation on vector multiprocessors:CMU-CS-93-173[R].Pittsburgh,USA:Carnegie Mellon University,1993:1-7." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Segmented Operations forSparse Matrix Computation on Vector Multiprocessors">
                                        <b>[20]</b>
                                         BLELLOCH G E,HEROUX M A,ZAGHA M.Segmented operations for sparse matrix computation on vector multiprocessors:CMU-CS-93-173[R].Pittsburgh,USA:Carnegie Mellon University,1993:1-7.
                                    </a>
                                </li>
                                <li id="271">


                                    <a id="bibliography_21" title=" CHENG J,GROSSMAN M,MCKERCHER T.Professional CUDA C Programming[M].[S.l.]:Wrox,2014." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Professional CUDA C Programming">
                                        <b>[21]</b>
                                         CHENG J,GROSSMAN M,MCKERCHER T.Professional CUDA C Programming[M].[S.l.]:Wrox,2014.
                                    </a>
                                </li>
                                <li id="273">


                                    <a id="bibliography_22" title=" NVIDIA.CUDA C programming guide[EB/OL].[2018-11-27].https://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=CUDA C programming guide">
                                        <b>[22]</b>
                                         NVIDIA.CUDA C programming guide[EB/OL].[2018-11-27].https://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html.
                                    </a>
                                </li>
                                <li id="275">


                                    <a id="bibliography_23" title=" DAVIS T A,HU Yifan.The university of florida sparse matrix collection[J].ACM Transactions on Mathematical Software,2011,38(1):1-25." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=SJCM&amp;filename=SJCM13091000001048&amp;v=MDcxNTlPREhneG9CTVQ2VDRQUUgvaXJSZEdlcnFRVE1ud1plWnVIeWptVUx6SUtWOFZieEk9TmlmSVk3SzdIdGpOcjQ5RlpPcw==&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU40eEVEZ0d2Qys0RlVmUWpwd0I5dz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[23]</b>
                                         DAVIS T A,HU Yifan.The university of florida sparse matrix collection[J].ACM Transactions on Mathematical Software,2011,38(1):1-25.
                                    </a>
                                </li>
                            </ul>
                            <div style='display: none;' class="zqscroller" >
                                <h4 class="">附加材料</h4>
                                <ul></ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            &nbsp;
            <!--此处有一空格符 勿删-->
        </div>

        
    <div class="content">



        <!--tips start-->
                            <div class="tips">
                    <a href="http://navi.cnki.net/KNavi/JournalDetail?pcode=CJFD&amp;pykm=JSJC" target="_blank">计算机工程</a>
                2019,45(09),23-31+39 DOI:10.19678/j.issn.1000-3428.0053513            </div>
        <!--tips end-->
            <div class="top-title">
                <h1 class="title">
                    <span class="vm"><b>基于GPU的稀疏矩阵存储格式优化研究</b></span>
                                    </h1>

            </div>
                        <h2>
                                <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=au&amp;skey=%E6%9D%A8%E4%B8%96%E4%BC%9F&amp;code=41121734&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU40eEVEZ0d2Qys0RlVmUWpwd0I5dz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">杨世伟</a>
                                <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=au&amp;skey=%E8%92%8B%E5%9B%BD%E5%B9%B3&amp;code=08770183&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU40eEVEZ0d2Qys0RlVmUWpwd0I5dz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">蒋国平</a>
                                <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=au&amp;skey=%E5%AE%8B%E7%8E%89%E8%93%89&amp;code=22449809&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU40eEVEZ0d2Qys0RlVmUWpwd0I5dz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">宋玉蓉</a>
                                <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=au&amp;skey=%E6%B6%82%E6%BD%87&amp;code=37968176&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU40eEVEZ0d2Qys0RlVmUWpwd0I5dz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">涂潇</a>
                </h2>
                    <h2>
                    <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=in&amp;skey=%E5%8D%97%E4%BA%AC%E9%82%AE%E7%94%B5%E5%A4%A7%E5%AD%A6%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%AD%A6%E9%99%A2&amp;code=0101257&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU40eEVEZ0d2Qys0RlVmUWpwd0I5dz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">南京邮电大学计算机学院</a>
                    <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=in&amp;skey=%E5%8D%97%E4%BA%AC%E9%82%AE%E7%94%B5%E5%A4%A7%E5%AD%A6%E8%87%AA%E5%8A%A8%E5%8C%96%E5%AD%A6%E9%99%A2&amp;code=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU40eEVEZ0d2Qys0RlVmUWpwd0I5dz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">南京邮电大学自动化学院</a>
            </h2>

        
<div class="link">
    <a id="aexport" class="icon icon-output"  onclick="" href="javascript:void(0);"><i></i>导出/参考文献</a>
    
    <span class="shareBoard" onmouseover="$('#sharedet').show();$('#this').addClass('shareBoardCUR')" onmouseout="$('#sharedet').hide();$('#this').removeClass('shareBoardCUR')">
        <a class="icon icon-share" href="#"><i></i>分享<em></em></a>
        <ul class="shareHide" id="sharedet" style="display: none;">
            <li><a title="复制链接" class="copy" onclick="" href="#"><i></i>复制链接</a></li>
            <li><a title="分享到新浪微博" class="xl" onclick="" href="javascript:common.ShareAction('xl');"><i></i>新浪微博</a></li>
            <li>
                <a title="分享到微信" class="wx" onclick="" href="#"><i></i>微信扫一扫</a>
                <div class="qrcode"><img src='' alt='' /></div>
            </li>
        </ul>

    </span>
    
    <a id="RefTrack" title="创建引文跟踪" class="icon icon-track" onclick="" href="javascript:void(0);"> <i></i>创建引文跟踪 </a>
    <a id="ashoucang" title="收藏" class="icon icon-favor" onclick="" href="javascript:void(0);"><i></i>收藏</a>
    <a class="icon icon-print" onclick="window.print();" href="javascript:void(0);"><i></i>打印</a>
    
    <!--版本切换 end-->
</div>
                            <div class="data" id="a_abstract">
                <span class="keys">摘<span style="font-family: 'Times New Roman';">&nbsp;&nbsp;&nbsp;&nbsp;</span>要：</span>
                <p>稀疏矩阵存储格式中的稀疏矩阵向量乘(SpMV)计算效率低下,且分块行列(BRC)存储格式的计算结果缺少再现性和确定性。为此,提出一种改进的BRCP存储格式。采用不同的二维分块策略,根据矩阵各行非零元素分布的统计特性自适应调节分块参数,提高SpMV在GPU平台上的并行性,并设计基于快速分段求和算法的GPU内核函数,保证计算结果的确定性及其在不同GPU平台上的再现性。实验结果表明,BRCP存储格式具有较高的计算效率,相比BRC存储格式可减少并行环境中的SpMV计算误差,并提高PageRank排序的准确率。</p>
            </div>
                    <div class="data" id="a_keywords">
                <span class="keys">关键词：</span>
                <p>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=%E7%A8%80%E7%96%8F%E7%9F%A9%E9%98%B5%E5%90%91%E9%87%8F%E4%B9%98&amp;code=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU40eEVEZ0d2Qys0RlVmUWpwd0I5dz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">稀疏矩阵向量乘;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=%E8%AE%A1%E7%AE%97%E7%BB%9F%E4%B8%80%E8%AE%BE%E5%A4%87%E6%9E%B6%E6%9E%84&amp;code=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU40eEVEZ0d2Qys0RlVmUWpwd0I5dz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">计算统一设备架构;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=%E5%9B%BE%E5%BD%A2%E5%A4%84%E7%90%86%E5%99%A8&amp;code=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU40eEVEZ0d2Qys0RlVmUWpwd0I5dz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">图形处理器;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=%E5%AD%98%E5%82%A8%E6%A0%BC%E5%BC%8F&amp;code=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU40eEVEZ0d2Qys0RlVmUWpwd0I5dz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">存储格式;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=%E6%B5%AE%E7%82%B9%E8%BF%90%E7%AE%97&amp;code=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU40eEVEZ0d2Qys0RlVmUWpwd0I5dz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">浮点运算;</a>
                </p>
            </div>
        
        <!--brief start-->
        
            <div class="brief">
                    <p>
                            <b>作者简介：</b>
                                                        <span>
                                    杨世伟(1994—),男,硕士研究生,主研方向为复杂网络、GPU并行计算;;
                                </span>
                                <span>
                                    蒋国平,教授、博士生导师;;
                                </span>
                                <span>
                                    宋玉蓉,教授、博士生导师;E-mail:songyr@ njupt. edu. cn;
                                </span>
                                <span>
                                    涂潇,博士。;
                                </span>
                    </p>
                                    <p><b>收稿日期：</b>2018-12-28</p>

                    <p>

                            <b>基金：</b>
                                                        <span>国家自然科学基金(61672298,61873326,61373136);</span>
                    </p>
            </div>
                    <h1><b>Research on Storage Format Optimization of Sparse Matrix Based on GPU</b></h1>
                    <h2>
                    <span>YANG Shiw ei</span>
                    <span>JIANG Guoping</span>
                    <span>SONG Yurong</span>
                    <span>TU Xiao</span>
            </h2>
                    <h2>
                    <span>School of Computer Science,Nanjing Utniversity of Posts and Telecommunications</span>
                    <span>School of Automation,Nanjing Utniversity of Posts and Telecommunications</span>
            </h2>
                            <div class="data" id="a_abstractEN">
                <span class="keys">Abstract：</span>
                <p>Sparse Matrix-Vector Multiplication(SpMV) calculation in sparse matrix storage format is inefficient,and the computing results of Blocked Row-Column(BRC) storage format lack reproducibility and certainty.To solve the problem,this paper proposes an improved Blocked Row-Column Plus(BRCP) storage format.The BRCP storage format adopts different two-dimensional blocking strategies,adaptively adjusts the blocking parameters according to the statistical characteristics of the distribution of non-zero elements of each row in the matrix,and improves the parallelism of SpMV on the GPU platform.A GPU kernel fuction based on fast segmented summation algorithm is designed to ensure the certainty of calculation results and their reproducibility on different GPU platforms.Experimental results show that the BRCP storage format has high computational efficiency,which reduces the SpMV calculation error in the parallel environment and improves the accuracy of PageRank sorting compared to the BRC storage format.</p>
            </div>
                    <div class="data" id="a_keywordsEN">
                <span class="keys">Keyword：</span>
                <p>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=Sparse%20Matrix-Vector%20Multiplication(SpMV)&amp;code=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU40eEVEZ0d2Qys0RlVmUWpwd0I5dz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">Sparse Matrix-Vector Multiplication(SpMV);</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=Compute%20Unified%20Device%20Architecture(CUDA)&amp;code=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU40eEVEZ0d2Qys0RlVmUWpwd0I5dz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">Compute Unified Device Architecture(CUDA);</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=Graphic%20Processing%20Unit(GPU)&amp;code=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU40eEVEZ0d2Qys0RlVmUWpwd0I5dz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">Graphic Processing Unit(GPU);</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=storage%20format&amp;code=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU40eEVEZ0d2Qys0RlVmUWpwd0I5dz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">storage format;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=floating-point%20operation&amp;code=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU40eEVEZ0d2Qys0RlVmUWpwd0I5dz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">floating-point operation;</a>
                </p>
            </div>
                    <div class="brief">
                
                    <p>
                                            </p>
                                    <p><b>Received：</b> 2018-12-28</p>
                                    <p>
                                            </p>
            </div>


        <!--brief start-->
                        <h3 id="49" name="49" class="anchor-tag">0 概述</h3>
                <div class="p1">
                    <p id="50">稀疏矩阵向量乘(Sparse Matrix-Vector Multiplication,SpMV)是科学计算中的核心算法之一<citation id="277" type="reference"><link href="231" rel="bibliography" /><sup>[<a class="sup">1</a>]</sup></citation>,广泛应用于信息检索<citation id="278" type="reference"><link href="233" rel="bibliography" /><sup>[<a class="sup">2</a>]</sup></citation>、数据挖掘<citation id="279" type="reference"><link href="235" rel="bibliography" /><sup>[<a class="sup">3</a>]</sup></citation>等领域。随着互联网时代数据量的快速增长,如何在大规模数据集上有效实现SpMV,已成为高性能计算领域的研究热点。稀疏矩阵具有多种存储格式,不同存储格式的SpMV存在较大性能差异<citation id="280" type="reference"><link href="237" rel="bibliography" /><sup>[<a class="sup">4</a>]</sup></citation>。文献<citation id="281" type="reference">[<a class="sup">5</a>]</citation>提出一个SpMV自动调优器,结合矩阵特征选择并返回最优的存储格式,从而得到性能提升。文献<citation id="282" type="reference">[<a class="sup">6</a>]</citation>针对申威处理器提出基于压缩稀疏行(Compressed Sparse Row,CSR)格式的通用异构众核并行SpMV算法,提升向量访存命中率,实现负载均衡。</p>
                </div>
                <div class="p1">
                    <p id="51">CPU由于体系结构的限制,性能很难进一步提升。NVIDIA公司推出的计算统一设备架构(Compute Unified Device Architecture,CUDA)<citation id="283" type="reference"><link href="243" rel="bibliography" /><sup>[<a class="sup">7</a>]</sup></citation>为GPU编程提供了无需借助图形学API的统一操作接口,高效利用GPU提供的强大浮点运算能力和高速数据传输能力,已成为高性能SpMV的主要研究方向<citation id="284" type="reference"><link href="245" rel="bibliography" /><sup>[<a class="sup">8</a>]</sup></citation>。文献<citation id="285" type="reference">[<a class="sup">9</a>]</citation>采用对图切分的压缩数据形式,设计基于多GPU平台的支持高效可扩展的大规模图数据处理系统GFlow。文献<citation id="286" type="reference">[<a class="sup">10</a>]</citation>结合ELL和CSR格式,提出HEC格式,提高了稀疏矩阵的存储效率。文献<citation id="287" type="reference">[<a class="sup">11</a>]</citation>设计的LightSpMV通过使用原子操作和warp shuffle指令,以及动态分配矩阵不同行的元素来提高效率。文献<citation id="288" type="reference">[<a class="sup">12</a>]</citation>扩展了CSR格式,提出转换开销较小的CSR5格式,并设计一种快速分段求和算法,提高SpMV的性能。</p>
                </div>
                <div class="p1">
                    <p id="52">文献<citation id="289" type="reference">[<a class="sup">13</a>]</citation>提出一种自适应分块行列(Blocked Row-Column,BRC)存储格式,利用矩阵的稀疏特性进行行列分块,减轻线程发散,实现负载均衡。然而,该分块策略无法保证结果的确定性和再现性。当使用基于BRC的SpMV时,编程人员无法控制GPU中线程束(<i>warp</i>)的调度顺序,每个<i>warp</i>可能在不同的系统上以不同的顺序对结果向量执行累加<citation id="290" type="reference"><link href="257" rel="bibliography" /><sup>[<a class="sup">14</a>]</sup></citation>。浮点数的舍入误差导致浮点加法不严格满足结合律,编译器优化也会导致浮点加法的重排序<citation id="291" type="reference"><link href="259" rel="bibliography" /><sup>[<a class="sup">15</a>]</sup></citation>,因此无法保证结果的复现。这种误差对于大多数应用来说是可接受的,但在某些情况下,例如用于评估节点重要性的PageRank计算中,保证结果向量的准确性十分必要。</p>
                </div>
                <div class="p1">
                    <p id="53">在此基础上,本文改进现有的BRC数据结构,提出BRCP(Blocked Row-Column Plus)存储格式,采用二维分块策略,根据稀疏矩阵的非零元素的分布特性自适应调节分块参数,并且设计基于BRCP格式的SpMV GPU内核,在维持BRC格式高效并行性的同时,优化计算结果的确定性,并保证在不同GPU平台上的再现性。</p>
                </div>
                <h3 id="54" name="54" class="anchor-tag">1 相关理论及技术</h3>
                <h4 class="anchor-tag" id="55" name="55">1.1 PageRank算法</h4>
                <div class="p1">
                    <p id="56">PageRank算法定义了网络中节点重要性的度量指标。该算法的基本思想是:一个网页的重要性取决于链接指向它的其他网页的数量和质量<citation id="292" type="reference"><link href="233" rel="bibliography" /><sup>[<a class="sup">2</a>]</sup></citation>。基于该假设,PageRank的计算公式为:</p>
                </div>
                <div class="p1">
                    <p id="57" class="code-formula">
                        <mathml id="57"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>r</mi><msub><mrow></mrow><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy="false">(</mo><mi>Ρ</mi><msub><mrow></mrow><mi>i</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mi>α</mi><mstyle displaystyle="true"><munder><mo>∑</mo><mrow><mi>Ρ</mi><msub><mrow></mrow><mi>j</mi></msub><mo>∈</mo><mi>B</mi><msub><mrow></mrow><mrow><mi>Ρ</mi><msub><mrow></mrow><mi>i</mi></msub></mrow></msub></mrow></munder><mrow><mfrac><mrow><mi>r</mi><msub><mrow></mrow><mi>k</mi></msub><mo stretchy="false">(</mo><mi>Ρ</mi><msub><mrow></mrow><mi>j</mi></msub><mo stretchy="false">)</mo></mrow><mrow><mrow><mo>|</mo><mrow><mi>Ρ</mi><msub><mrow></mrow><mi>j</mi></msub></mrow><mo>|</mo></mrow></mrow></mfrac></mrow></mstyle><mo>+</mo><mo stretchy="false">(</mo><mn>1</mn><mo>-</mo><mi>α</mi><mo stretchy="false">)</mo><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mrow><mtext> </mtext><mtext> </mtext><mtext> </mtext></mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></math></mathml>
                    </p>
                </div>
                <div class="p1">
                    <p id="58">其中,<i>r</i><sub><i>k</i></sub>(<i>P</i><sub><i>i</i></sub>)表示页面<i>P</i><sub><i>i</i></sub>在第<i>k</i>次迭代时的PageRank值,<i>B</i><sub><i>Pi</i></sub>是链接指向<i>P</i><sub><i>i</i></sub>的页面集合,<mathml id="191"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mrow><mo>|</mo><mrow><mi>Ρ</mi><msub><mrow></mrow><mi>j</mi></msub></mrow><mo>|</mo></mrow></mrow></math></mathml>是页面P<sub>j</sub>的出链数,α∈(0,1)是模拟用户浏览网页时点击超链接的阻尼因子。</p>
                </div>
                <div class="p1">
                    <p id="59">终止条件为:</p>
                </div>
                <div class="p1">
                    <p id="60">|r<sub>k+1</sub>(P<sub>i</sub>)-r<sub>k</sub>(P<sub>i</sub>)|&lt;ε</p>
                </div>
                <div class="p1">
                    <p id="61">基于式(1)的原理,可将页面视为马尔可夫链的状态并将页面排名建模为马尔可夫过程,其类似于一个“随机冲浪者”以特定的状态转移概率从一个页面随机移动到另一个页面。给定n个页面,定义<i><b>G</b></i>为<i>n</i>×<i>n</i>大小的邻接矩阵,矩阵中的每个元素<i>G</i><sub><i>ij</i></sub>为从页面<i>P</i><sub><i>i</i></sub>到页面<i>P</i><sub><i>j</i></sub>的转移概率,其中0≤<i>i</i>,<i>j</i>&lt;<i>n</i>。<i><b>R</b></i>表示长度为<i>n</i>的分值排名向量,计算公式为:</p>
                </div>
                <div class="p1">
                    <p id="62"><i><b>R</b></i>=<i>α</i><i><b>G</b></i><sup>T</sup><i><b>R</b></i>+(1-<i>α</i>)<i><b>E</b></i>      (2)</p>
                </div>
                <div class="p1">
                    <p id="63">其中,<i><b>E</b></i>是均匀分配给每个页面的初始分值向量,PageRank算法依据式(2)不断迭代更新各页面的分值直到收敛。</p>
                </div>
                <div class="p1">
                    <p id="64">PageRank算法的计算核心为SpMV,SpMV是一个内存带宽受限的算法,从内存中读取的每个矩阵元素在计算中仅使用一次。当矩阵是稀疏矩阵时,由于非直接和不规则的内存访问引发的内存开销,使问题更复杂,因此其性能很大程度上取决于稀疏矩阵的稀疏度以及每行非零值的分布。</p>
                </div>
                <h4 class="anchor-tag" id="65" name="65">1.2 数据并行原语</h4>
                <h4 class="anchor-tag" id="66" name="66">1.2.1 归约</h4>
                <div class="p1">
                    <p id="67">归约<citation id="293" type="reference"><link href="261" rel="bibliography" /><sup>[<a class="sup">16</a>]</sup></citation>是一类基本的数据并行原语,对<i>n</i>个元素的输入序列<mathml id="192"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mrow><mo>[</mo><mrow><mi>a</mi><msub><mrow></mrow><mn>0</mn></msub><mo>,</mo><mi>a</mi><msub><mrow></mrow><mn>1</mn></msub><mo>,</mo><mo>⋯</mo><mo>,</mo><mi>a</mi><msub><mrow></mrow><mrow><mi>n</mi><mo>-</mo><mn>1</mn></mrow></msub></mrow><mo>]</mo></mrow></mrow></math></mathml>进行二元可结合运算♁,生成一个归约结果a<sub>0</sub>♁a<sub>1</sub>♁…♁a<sub>n-1</sub>。</p>
                </div>
                <h4 class="anchor-tag" id="68" name="68">1.2.2 扫描</h4>
                <div class="p1">
                    <p id="69">扫描<citation id="294" type="reference">[<a class="sup">17</a>,<a class="sup">18</a>]</citation>,又称前缀扫描、前缀求和,是许多并行算法的基础,可分为闭扫描和开扫描。对于<i>n</i>个元素的输入序列[<i>a</i><sub>0</sub>,<i>a</i><sub>1</sub>,…,<i>a</i><sub><i>n</i></sub>-1],使用二元可结合运算⊕,返回序列[<i>a</i><sub>0</sub>,(<i>a</i><sub>0</sub>⊕<i>a</i><sub>1</sub>),…,(<i>a</i><sub>0</sub>⊕<i>a</i><sub>1</sub>⊕…⊕<i>a</i><sub><i>n</i></sub>-1)],即为闭扫描。使用标识值<i>I</i>,使得<i>I</i>⊕<i>a</i>=<i>a</i>,返回序列[<i>I</i>,<i>a</i><sub>0</sub>,(<i>a</i><sub>0</sub>⊕<i>a</i><sub>1</sub>),…,(<i>a</i><sub>0</sub>⊕<i>a</i><sub>1</sub>⊕…⊕<i>a</i><sub><i>n</i></sub>-2)],即为开扫描。</p>
                </div>
                <h4 class="anchor-tag" id="70" name="70">1.3 稀疏矩阵压缩存储格式</h4>
                <div class="p1">
                    <p id="71">对于大规模稀疏矩阵,由于内存限制,SpMV无法使用通用存储格式在GPU上进行处理。文献<citation id="295" type="reference">[<a class="sup">19</a>]</citation>总结了多种常用存储格式,如COO(Coordinate)格式、CSR格式、ELL格式优化用于特定体系结构的稀疏矩阵的计算。稀疏矩阵<i><b>A</b></i>作为本文中的示例,其大小为4×4,非零元素数量(Number of Non-Zero,NNZ)为6。</p>
                </div>
                <div class="p1">
                    <p id="72" class="code-formula">
                        <mathml id="72"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi mathvariant="bold-italic">A</mi><mo>=</mo><mrow><mo>(</mo><mrow><mtable><mtr><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>2</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>3</mn></mtd><mtd><mn>4</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>5</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>6</mn></mtd><mtd><mn>0</mn></mtd></mtr></mtable></mrow><mo>)</mo></mrow></mrow></math></mathml>
                    </p>
                </div>
                <h4 class="anchor-tag" id="73" name="73">1.3.1 COO存储格式</h4>
                <div class="p1">
                    <p id="74">COO格式是三元组(行、列、值)的简单存储方案。数组<i>row</i>、<i>col</i>、<i>value</i>分别存储矩阵中非零元素的行索引、列索引和非零值,数组长度均为<i>nnz</i>,其中<i>nnz</i>=6。</p>
                </div>
                <div class="p1">
                    <p id="75" class="code-formula">
                        <mathml id="75"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mtable><mtr><mtd><mi>r</mi><mi>o</mi><mi>w</mi><mo>=</mo><mrow><mo>(</mo><mrow><mtable><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>2</mn></mtd><mtd><mn>2</mn></mtd><mtd><mn>2</mn></mtd><mtd><mn>3</mn></mtd></mtr></mtable></mrow><mo>)</mo></mrow></mtd></mtr><mtr><mtd><mi>c</mi><mi>o</mi><mi>l</mi><mo>=</mo><mrow><mo>(</mo><mrow><mtable><mtr><mtd><mn>0</mn></mtd><mtd><mn>2</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd><mtd><mn>3</mn></mtd><mtd><mn>2</mn></mtd></mtr></mtable></mrow><mo>)</mo></mrow></mtd></mtr><mtr><mtd><mi>v</mi><mi>a</mi><mi>l</mi><mi>u</mi><mi>e</mi><mo>=</mo><mrow><mo>(</mo><mrow><mtable><mtr><mtd><mn>1</mn></mtd><mtd><mn>2</mn></mtd><mtd><mn>3</mn></mtd><mtd><mn>4</mn></mtd><mtd><mn>5</mn></mtd><mtd><mn>6</mn></mtd></mtr></mtable></mrow><mo>)</mo></mrow></mtd></mtr></mtable></mrow></math></mathml>
                    </p>
                </div>
                <div class="p1">
                    <p id="76">从示例稀疏矩阵<i><b>A</b></i>中可看出行索引为0、列索引为0的位置存放元素值1,行索引为0、列索引为2的位置存放元素值2,以此类推。</p>
                </div>
                <h4 class="anchor-tag" id="77" name="77">1.3.2 CSR存储格式</h4>
                <div class="p1">
                    <p id="78">CSR格式是一种主流的通用稀疏矩阵表示格式,将列索引和非零值存储在数组<i>col</i>和<i>value</i>中,这2个数组长度为<i>nnz</i>。第3个数组<i>rowPtr</i>表示<i>value</i>数组中每行的起始位置。</p>
                </div>
                <div class="p1">
                    <p id="79" class="code-formula">
                        <mathml id="79"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtable columnalign="left"><mtr><mtd><mi>v</mi><mi>a</mi><mi>l</mi><mi>u</mi><mi>e</mi><mo>=</mo><mrow><mo>(</mo><mrow><mtable><mtr><mtd><mn>1</mn></mtd><mtd><mn>2</mn></mtd><mtd><mn>3</mn></mtd><mtd><mn>4</mn></mtd><mtd><mn>5</mn></mtd><mtd><mn>6</mn></mtd></mtr></mtable></mrow><mo>)</mo></mrow></mtd></mtr><mtr><mtd><mi>c</mi><mi>o</mi><mi>l</mi><mo>=</mo><mrow><mo>(</mo><mrow><mtable><mtr><mtd><mn>0</mn></mtd><mtd><mn>2</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd><mtd><mn>3</mn></mtd><mtd><mn>2</mn></mtd></mtr></mtable></mrow><mo>)</mo></mrow></mtd></mtr><mtr><mtd><mi>r</mi><mi>o</mi><mi>w</mi><mi>Ρ</mi><mi>t</mi><mi>r</mi><mo>=</mo><mrow><mo>(</mo><mrow><mtable><mtr><mtd><mn>0</mn></mtd><mtd><mn>2</mn></mtd><mtd><mn>2</mn></mtd><mtd><mn>5</mn></mtd><mtd><mn>6</mn></mtd></mtr></mtable></mrow><mo>)</mo></mrow></mtd></mtr></mtable></math></mathml>
                    </p>
                </div>
                <div class="p1">
                    <p id="80">对于<i>n</i>×<i>m</i>矩阵(<i>n</i>=<i>m</i>=4),<i>rowPtr</i>具有<i>n</i>+1个元素,并且在<i>rowPtr</i>[<i>i</i>]中存储第<i>i</i>行的起始位置,最后一个元素的值是<i>nnz</i>。对于示例稀疏矩阵<i><b>A</b></i>,<i>rowPtr</i>[0]=0表示第0行的起始位置从<i>value</i>[]的第0号开始,<i>rowPtr</i>[1]=2表示第1行的起始位置从<i>value</i>[]的第2号开始,因此<i>value</i>[]的第0号～第2号之前存放了矩阵<i><b>A</b></i>第0行的元素值,以此类推。</p>
                </div>
                <h4 class="anchor-tag" id="81" name="81">1.3.3 ELL存储格式</h4>
                <div class="p1">
                    <p id="82">对于每行最多<i>k</i>个非零元素的<i>n</i>×<i>m</i>矩阵(<i>k</i>=3,因为矩阵<i><b>A</b></i>第2行有3个元素),ELL格式将非零值存储在稠密的<i>n</i>×<i>k value</i>数组中,具有少于<i>k</i>个非零值的行用0填充,例如矩阵<i><b>A</b></i>第0行只有2个元素,因此第3个位置<i>value</i>[0][2]用0填充。与<i>value</i>对应的列索引存储在<i>offset</i>数组中,数组大小同样是<i>n</i>×<i>k</i>,并有用于填充的标记值(填充值通常用-1或<i>k</i>表示,本文中用*表示),例如<i>offset</i>[2][2]=3,表示其相应元素值<i>value</i>[2][2]=5在原矩阵<i><b>A</b></i>中第2行的列偏移是3,即<i>A</i>[2][3]=5。</p>
                </div>
                <div class="p1">
                    <p id="83" class="code-formula">
                        <mathml id="83"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi mathvariant="bold-italic">v</mi><mi mathvariant="bold-italic">a</mi><mi mathvariant="bold-italic">l</mi><mi mathvariant="bold-italic">u</mi><mi mathvariant="bold-italic">e</mi><mo>=</mo><mrow><mo>(</mo><mrow><mtable><mtr><mtd><mn>1</mn></mtd><mtd><mn>2</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>3</mn></mtd><mtd><mn>4</mn></mtd><mtd><mn>5</mn></mtd></mtr><mtr><mtd><mn>6</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr></mtable></mrow><mo>)</mo></mrow><mo>,</mo><mi mathvariant="bold-italic">o</mi><mi mathvariant="bold-italic">f</mi><mi mathvariant="bold-italic">f</mi><mi mathvariant="bold-italic">s</mi><mi mathvariant="bold-italic">e</mi><mi mathvariant="bold-italic">t</mi><mo>=</mo><mrow><mo>(</mo><mrow><mtable><mtr><mtd><mn>0</mn></mtd><mtd><mn>2</mn></mtd><mtd><mo>*</mo></mtd></mtr><mtr><mtd><mo>*</mo></mtd><mtd><mo>*</mo></mtd><mtd><mo>*</mo></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd><mtd><mn>3</mn></mtd></mtr><mtr><mtd><mn>2</mn></mtd><mtd><mo>*</mo></mtd><mtd><mo>*</mo></mtd></mtr></mtable></mrow><mo>)</mo></mrow></mrow></math></mathml>
                    </p>
                </div>
                <h4 class="anchor-tag" id="84" name="84">1.3.4 BRC存储格式</h4>
                <div class="p1">
                    <p id="85">对于非零元素分布极不规则的稀疏矩阵,若采用一般的存储格式,并行效果较差。文献<citation id="302" type="reference">[<a class="sup">13</a>,<a class="sup">14</a>]</citation>提出基于二维分块机制的BRC格式。首先对行分块,并结合对行重新排序和零填充的思想,避免<i>warp</i>内的线程发散、冗余计算,并控制数据传输的成本。在对行分块的基础上,对列分块,通过将各行划分为更小的块实现负载均衡,使不同的<i>warp</i>执行相同的工作量。此外,设计一种自调整参数策略,根据矩阵稀疏特性合理选择块大小。</p>
                </div>
                <div class="p1">
                    <p id="86">图1展示了将示例矩阵<i><b>A</b></i>转换为BRC格式矩阵后的内存布局。<i>value</i>数组包含非零元素,<i>col</i>包含相应的列索引,<i>rowPerm</i>保留了行重新排序后的原始行下标,其中填充元素标为灰色。<i>H</i>代表一个块中的行数,设为所使用的处理器的SIMD执行单元(CUDA中即<i>warp</i>)的大小。<i>V</i>代表一个块中的列数,取决于原矩阵每行非零元素的统计特性。在构建所有块后,将<i>value</i>和<i>col</i>分别放入列优先的一维数组中。因此,使用<i>blockBegin</i>数组表示每个块的偏移量,<i>nzPerBlock</i>数组表示每个块中的列数。</p>
                </div>
                <div class="area_img" id="87">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JSJC201909004_087.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU40eEVEZ0d2Qys0RlVmUWpwd0I5dz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图1 BRC格式的内存布局" src="Detail/GetImg?filename=images/JSJC201909004_087.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU40eEVEZ0d2Qys0RlVmUWpwd0I5dz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit"><b>图1 BRC格式的内存布局</b>  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JSJC201909004_087.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU40eEVEZ0d2Qys0RlVmUWpwd0I5dz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <h3 id="88" name="88" class="anchor-tag">2 基于BRCP的SpMV计算</h3>
                <div class="p1">
                    <p id="89">如图2所示,块0中的线程1、块2中的线程4和线程5分别进行其所属块中某一行的计算,并且它们所处理的行都是原矩阵中的第0行,在SpMV kernel的最后它们将各自的结果做原子加法(CUDA中的atomicAdd)到结果向量中下标0的位置。但是,在不同的系统上,各线程块的调度顺序不能确定,线程块中的各<i>warp</i>(分块行数设为32,每个块由1个<i>warp</i>处理)的调度顺序同样不能确定,因此此处无法知道线程1、线程4、线程5的3个部分结果以何种顺序添加到结果向量中。由于浮点数在进行每一次加法时,除了系统精度产生的表示误差外,还会产生一个由于舍入(对阶和向右规划操作)而产生的计算误差,因此浮点数不能严格满足加法结合律,浮点数累加过程中不同的结合顺序会使计算结果产生误差<citation id="303" type="reference"><link href="259" rel="bibliography" /><sup>[<a class="sup">15</a>]</sup></citation>。随着数据的增多,尤其对于原稀疏矩阵中非零元素数量较大的行,这类误差在并行计算中叠加、放大,该非确定性不仅产生了程序验证和调试的问题,而且最终会导致计算结果不准确甚至没有意义。对于一些对计算精确度有高要求的应用,该缺陷更加会被放大,例如在重要节点排序算法PageRank中,不同系统上排序结果的不确定性会导致算法失去其价值,那么使用GPU并行加速将没有意义。</p>
                </div>
                <div class="area_img" id="90">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JSJC201909004_090.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU40eEVEZ0d2Qys0RlVmUWpwd0I5dz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图2 基于BRC格式的SpMV内核线程执行结果" src="Detail/GetImg?filename=images/JSJC201909004_090.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU40eEVEZ0d2Qys0RlVmUWpwd0I5dz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit"><b>图2 基于BRC格式的SpMV内核线程执行结果</b>  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JSJC201909004_090.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU40eEVEZ0d2Qys0RlVmUWpwd0I5dz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="p1">
                    <p id="91">为达到计算结果的可再现性和确定性,本文改进BRC格式并提出BRCP格式的矩阵表示,结合原始二维分块机制和一些额外的步骤,并基于低开销的分段求和算法尽可能减少计算误差。</p>
                </div>
                <h4 class="anchor-tag" id="92" name="92">2.1 BRCP分块策略</h4>
                <div class="p1">
                    <p id="93">本文设计的BRCP数据结构继承了BRC格式的设计范式,沿用其在2个维度上分块的策略。对于原始稀疏矩阵,按照每行非零元素个数排序后,首先对行分块,一个块中的行数<i>H</i>=32,<i>warp</i>是GPU中流多处理器(Stream Multiprocessor,SM)的基本调度单位,目前CUDA的<i>warp</i>大小是32,这样保证了一个<i>warp</i>处理一个块中的数据,其中的32个线程分别进行每一行的计算,避免了线程发散。在具有幂律特征的稀疏矩阵中,排序后位于前面的行中的非零元素个数远多于后面的行,由于分配一个<i>warp</i>处理一个块,那么会造成各个<i>warp</i>之间负载不均衡。为解决该问题,对列进行分块,一个块的列数<i>V</i>取决于原矩阵每行非零元素的统计特性以及当前行剩余元素的个数。图3表示例矩阵<i><b>A</b></i>的BRCP表示方法的内存布局,为便于说明,设置分块大小为2×2。</p>
                </div>
                <div class="area_img" id="94">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JSJC201909004_094.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU40eEVEZ0d2Qys0RlVmUWpwd0I5dz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图3 BRCP格式的内存布局" src="Detail/GetImg?filename=images/JSJC201909004_094.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU40eEVEZ0d2Qys0RlVmUWpwd0I5dz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit"><b>图3 BRCP格式的内存布局</b>  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JSJC201909004_094.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU40eEVEZ0d2Qys0RlVmUWpwd0I5dz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="p1">
                    <p id="95">本文提出的BRCP格式与BRC格式不同,从第一行开始扫描稀疏矩阵(已按行进行排序),将矩阵元素按行优先的方式放入块中,取完一行的所有元素后才继续遍历下一行,这样改进的目的是避免BRC格式导致的SpMV计算结果的不确定性,为此引入另一个辅助数组<i>rowSegLen</i>。</p>
                </div>
                <div class="p1">
                    <p id="96">由于与BRC格式的分块方案不同,因此本文选择每个块的列数<i>V</i>的方法由式(3)决定。对于非零元素数量较多的行,这样做能够使这些行的计算结果更加准确(通常度较大的节点更加关键)。由于已对行进行排序,因此对于剩下的那些非零元素数目较少的行,需要关注扫描的当前行的剩余元素个数,如果不足<i>T</i>,则继续考虑下一行的非零元素个数。</p>
                </div>
                <div class="p1">
                    <p id="97" class="code-formula">
                        <mathml id="97"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>V</mi><mo>=</mo><mrow><mo>{</mo><mtable columnalign="left"><mtr><mtd><mi>c</mi><mi>e</mi><mi>i</mi><mi>l</mi><mo stretchy="false">(</mo><mi>n</mi><mi>n</mi><mi>z</mi><mo>/</mo><mn>6</mn><mn>4</mn><mo stretchy="false">)</mo><mo>,</mo><mtext>当</mtext><mtext>前</mtext><mtext>行</mtext><mtext>的</mtext><mi>n</mi><mi>n</mi><mi>z</mi><mtext>大</mtext><mtext>于</mtext><mn>6</mn><mn>4</mn><mi>Τ</mi></mtd></mtr><mtr><mtd><mi>min</mi><mo stretchy="false">(</mo><mi>Τ</mi><mo>,</mo><mi>max</mi><mo stretchy="false">(</mo><mtext>当</mtext><mtext>前</mtext><mtext>行</mtext><mtext>剩</mtext><mtext>余</mtext><mi>n</mi><mi>n</mi><mi>z</mi><mo>,</mo><mtext>下</mtext><mtext>一</mtext><mtext>行</mtext><mi>n</mi><mi>n</mi><mi>z</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>,</mo><mtext>其</mtext><mtext>他</mtext></mtd></mtr></mtable></mrow><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mrow><mtext> </mtext><mtext> </mtext><mtext> </mtext></mrow><mo stretchy="false">(</mo><mn>3</mn><mo stretchy="false">)</mo></mrow></math></mathml>
                    </p>
                </div>
                <div class="p1">
                    <p id="98">其中,<i>T</i>=<i>round</i>(<i>μ</i>+<i>σ</i>),<i>μ</i>和<i>σ</i>分别是该行非零元素数目的平均值和标准差,在此借鉴BRC格式的思想,使用矩阵稀疏性作为统一线程工作量的标准,达到根据稀疏矩阵特性调节参数的目的。</p>
                </div>
                <div class="p1">
                    <p id="99">对于大小为<i>H</i>×<i>V</i>的分块,该块后续每一行如果非零元素不足<i>V</i>,则按照ELL格式的机制填充0,如图3的左上部分所示。该方法能较好地适应各种类型的稀疏矩阵,本文的排序和分块策略基于稀疏矩阵中非零元素的分布特性,因此适用于具有幂律分布的真实世界网络。</p>
                </div>
                <div class="p1">
                    <p id="100">将原始稀疏矩阵分块后,剩下部分与BRC格式的处理类似,将分好块的矩阵元素及其下标按列优先的顺序存入2个一维数组中,<i>value</i>数组存放矩阵实际的非零元素和填充的0,<i>col</i>数组包含<i>value</i>相应的列下标,列优先的存放方式能使线程合并访问,充分利用GPU性能。<i>rowPerm</i>数组用于存储重新排序后该行在原始稀疏矩阵的行下标,<i>rowSegLen</i>数组通过<i>rowPerm</i>数组产生,表示行下标的分段长度,是实现本文SpMV计算确定性的核心。<i>blockWidth</i>数组用于存储每个块的列数,<i>blockPtr</i>数组采用CSR格式中<i>rowPtr</i>数组的思想,表示每个块在<i>value</i>数组中的起始下标位置,因此<i>blockPtr</i>的元素个数为分块个数加1,并且最后一个元素值与<i>value</i>和<i>col</i>数组的元素个数相同。在实际存储过程中,通过<i>blockPtr</i>数组可以得到每个块的列数,第<i>i</i>个分块的列数<i>blockWidth</i>[<i>i</i>]与<i>blockPtr</i>数组的关系为:<i>blockWidth</i>[<i>i</i>]×<i>H</i>=<i>blockPtr</i>[<i>i</i>+1]-<i>blockPtr</i>[<i>i</i>],从而节省存储空间,无需与BRC格式一样使用<i>blockBegin</i>数组。算法1给出了CSR格式的矩阵转换到BRCP格式的伪代码。</p>
                </div>
                <div class="p1">
                    <p id="101"><b>算法1</b> BRCP格式转换算法</p>
                </div>
                <div class="p1">
                    <p id="102"><b>输入</b> CSR矩阵(<i>rowPtr</i>,<i>col</i>,<i>value</i>)</p>
                </div>
                <div class="p1">
                    <p id="103"><b>输出</b> BRCP矩阵(<i>rowPerm</i>,<i>rowSegLen</i>,<i>col</i>,<i>value</i>,<i>blockPtr</i>)</p>
                </div>
                <div class="p1">
                    <p id="104">1.begin</p>
                </div>
                <div class="p1">
                    <p id="105">2.extract μ,σ and rowVec (a vector of struct containing index and nnz per row) from rowPtr;</p>
                </div>
                <div class="p1">
                    <p id="106">3.sort rowVec based on nnz per row;</p>
                </div>
                <div class="p1">
                    <p id="107">4.H=32,T=round(μ+σ);</p>
                </div>
                <div class="p1">
                    <p id="108">5.numBlocks=0,blockPtr[0]=0,idx=0;</p>
                </div>
                <div class="p1">
                    <p id="109">6.while idx &lt; rows and rowVec[idx].nnz do</p>
                </div>
                <div class="p1">
                    <p id="110">7.extract a block and add it to the list of blocks;</p>
                </div>
                <div class="p1">
                    <p id="111">8.determine blockWidth;</p>
                </div>
                <div class="p1">
                    <p id="112">9.for i=1:H do</p>
                </div>
                <div class="p1">
                    <p id="113">10.if idx=rows then</p>
                </div>
                <div class="p1">
                    <p id="114">11.add dummy rows;</p>
                </div>
                <div class="p1">
                    <p id="115">12.else</p>
                </div>
                <div class="p1">
                    <p id="116">13.add current row index to rowPerm;</p>
                </div>
                <div class="p1">
                    <p id="117">14.store value and col data of length of blockWidth to the next row of current block;</p>
                </div>
                <div class="p1">
                    <p id="118">15.update idx and currentPtr of rowVec;</p>
                </div>
                <div class="p1">
                    <p id="119">16.store data of current block to BRCP format in column order;</p>
                </div>
                <div class="p1">
                    <p id="120">17.blockPtr.push_back(blockPtr[numBlocks] + H * block_width[numBlocks]);</p>
                </div>
                <div class="p1">
                    <p id="121">18.set rowSegLen of current block according rowPerm;</p>
                </div>
                <h4 class="anchor-tag" id="122" name="122">2.2 基于BRCP的SpMV内核线程执行</h4>
                <div class="p1">
                    <p id="123">本文设计的BRCP格式采用分块策略的优势为:原始稀疏矩阵相同行的元素尽可能处于同一个分块,在每个块中可对块中所有行的部分结果先进行分段求和,将处于原矩阵同一行的中间值进行求和,再原子加到结果向量中,而不是像基于BRC格式的SpMV方案那样直接将块中每一行的计算结果原子加到结果向量中。并行的分段求和算法<citation id="304" type="reference"><link href="269" rel="bibliography" /><sup>[<a class="sup">20</a>]</sup></citation>已有成熟的算法思路和各种优化方法,其求和数值结合顺序能够确定,因此求和结果明确。</p>
                </div>
                <div class="p1">
                    <p id="124">图4展示了本文SpMV内核的线程执行过程。将一个块中的元素按其所在行分段,先在每个块中执行分段求和,例如块0中的线程0和线程1负责的元素都位于原始矩阵的第2行,先在块内将它们的计算结果相加,再由块中的第1个线程执行原子加法累加到结果向量中,那么块0中的线程0、线程1就不会因调度顺序不同产生误差。但是也存在此类情况,例如线程2、线程3在块1中,线程5在块2中,但它们都负责第0行元素的计算,最后线程2和线程5都会将其计算结果原子加到下标为0的位置,无法有效统一这一操作的执行顺序。不过浮点加法具有交换律,如果只有2个块中的线程进行累加,那么结果不会受到影响,如果存在3个或超过3个块的线程都负责同一行的计算,那么该行的累加结果无法保证确定性。因此,对于那些含有非零元素较多的行,在分块时应尽可能地保证负责该行的线程数不超过64个,虽然数量超过33个时线程就可能分布在3个块中,但出现这种情况的概率极小。为避免产生浮点数的舍入误差,对于非零元素较大的行,使负责该行的线程数小于等于64,即线程块的列数大于等于该行<i>nnz</i>/64,于是将当前块的实际列数<i>V</i>设计为<i>V</i>=<i>ceil</i>(<i>nnz</i>/64)。</p>
                </div>
                <div class="area_img" id="125">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JSJC201909004_125.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU40eEVEZ0d2Qys0RlVmUWpwd0I5dz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图4 基于BRCP格式的SpMV内核线程执行结果" src="Detail/GetImg?filename=images/JSJC201909004_125.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU40eEVEZ0d2Qys0RlVmUWpwd0I5dz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit"><b>图4 基于BRCP格式的SpMV内核线程执行结果</b>  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JSJC201909004_125.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU40eEVEZ0d2Qys0RlVmUWpwd0I5dz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="p1">
                    <p id="126">算法2给出了BRCP格式对应的CUDA kernel函数。在此kernel中,<i>i</i>循环的每次迭代都会处理大小为<i>H</i>×<i>V</i>的分块,其中调用了<i>warp</i>级的快速分段求和算法。在<i>j</i>循环中,每个线程处理块中的一行并执行<i>T</i>次计算,最后累加出部分结果,<i>T</i>=<i>blockWidth</i>[<i>cb</i>]=(<i>blockPtr</i>[<i>cb</i>+1]-<i>blockPtr</i>[<i>cb</i>])/<i>H</i>。</p>
                </div>
                <div class="p1">
                    <p id="127"><b>算法2</b> 基于BRCP格式的SpMV内核函数求解算法</p>
                </div>
                <div class="p1">
                    <p id="128">1.begin</p>
                </div>
                <div class="p1">
                    <p id="129">2.id=blockIdx.x * blockDim.x + threadIdx.x;</p>
                </div>
                <div class="p1">
                    <p id="130">3.b_row=id % H;</p>
                </div>
                <div class="p1">
                    <p id="131">4.for i=1:rep do</p>
                </div>
                <div class="p1">
                    <p id="132">5.cb=id / H;</p>
                </div>
                <div class="p1">
                    <p id="133">6.tmp=0;</p>
                </div>
                <div class="p1">
                    <p id="134">7.for j=0:T-1 do</p>
                </div>
                <div class="p1">
                    <p id="135">8.index=blockPtr[cb] + j * H + b_row;</p>
                </div>
                <div class="p1">
                    <p id="136">9.tmp += value[index] * x[col[index]];</p>
                </div>
                <div class="p1">
                    <p id="137">10.CALL FUNCTION &lt;Fast Segmented Sum&gt;;</p>
                </div>
                <div class="p1">
                    <p id="138">11.id += gridDim.x * blockDim.x;</p>
                </div>
                <div class="p1">
                    <p id="139">2.3 快速分段求和算法</p>
                </div>
                <div class="p1">
                    <p id="140">算法2中调用的快速分段求和算法是使BRCP格式稀疏矩阵实现精确计算SpMV的关键,核心思想是将块中的元素按其所在行分段,同一个行的计算结果先进行求和,这时的求和结果能够确定,而不是将每一行的结果分别单独加到结果向量的一个元素中,避免受到GPU线程调度顺序的不确定而发生变化。</p>
                </div>
                <div class="p1">
                    <p id="141">在预处理过程中产生的数组<i>rowSegLen</i>用于执行该分段求和算法。由于分段求和算法<citation id="305" type="reference"><link href="269" rel="bibliography" /><sup>[<a class="sup">20</a>]</sup></citation>比较复杂且效率不佳,因此文献<citation id="306" type="reference">[<a class="sup">12</a>]</citation>设计一种快速分段求和算法,使用辅助数组<i>seg</i>_<i>offset</i>表示段偏移,并结合前缀扫描<citation id="307" type="reference"><link href="265" rel="bibliography" /><sup>[<a class="sup">18</a>]</sup></citation>的思想实现分段求和。本文采用类似的策略,设计一种<i>warp</i>级的快速分段求和算法。与文献<citation id="308" type="reference">[<a class="sup">12</a>]</citation>算法不同,本文没有使用段偏移数组,因为如果<i>seg</i>_<i>offset</i>的一个元素是0,既有可能表示该元素未处于段首,又有可能是一个段长为1的分段段首,采用<i>seg</i>_<i>offset</i>不能较好地区分这2种情况,具有二义性。因此本文采用表示段长的<i>rowSegLen</i>作为辅助数组。图5给出了使用<i>rowSegLen</i>和前缀闭扫描相结合的快速分段求和算法。</p>
                </div>
                <div class="area_img" id="142">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JSJC201909004_142.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU40eEVEZ0d2Qys0RlVmUWpwd0I5dz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图5 快速分段求和算法" src="Detail/GetImg?filename=images/JSJC201909004_142.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU40eEVEZ0d2Qys0RlVmUWpwd0I5dz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit"><b>图5 快速分段求和算法</b>  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JSJC201909004_142.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU40eEVEZ0d2Qys0RlVmUWpwd0I5dz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="p1">
                    <p id="143">在图5中,<i>rowSegLen</i>数组表示各段的长度,要生成<i>rowSegLen</i>,只需遍历<i>rowPerm</i>,向后搜寻连续相同值的个数。例如,图5中<i>rowPerm</i>数组的前3个元素均为2,表示分块后该行元素位于原矩阵的第2行,则<i>rowSegLen</i>的第1个元素为3,标识当前位置是一个分段的段首,且段长为3。<i>in</i>[]为每行元素计算后的结果,对<i>in</i>[]并行前缀闭扫描后的结果存于共享内存进行后续操作,以实现快速的线程通信。为进一步提高效率,本文通过使用warp shuffle指令<citation id="309" type="reference"><link href="271" rel="bibliography" /><sup>[<a class="sup">21</a>]</sup></citation>实现<i>warp</i>级的前缀闭扫描。CUDA 9.0引入一组内建函数<citation id="310" type="reference"><link href="273" rel="bibliography" /><sup>[<a class="sup">22</a>]</sup></citation>(例如<i>shfl</i>_<i>up</i>和<i>shfl</i>_<i>down</i>),能够在一次操作中完成<i>warp</i>级下标的广播,而不需要通过共享内存执行数据交换,这种更加轻量级的操作使得同一<i>warp</i>内的线程可实现更快通信。最后每个线程查看其<i>rowSegLen</i>,<i>rowSegLen</i>非零则标识了段首,其值标识了段尾位置,例如图5中的第1个线程0,其<i>rowSegLen</i>[0]=3,表明线程0负责的元素为段首元素,则<i>out</i>[0]=<i>sh</i>_<i>mem</i>[0+3-1]-<i>sh</i>_<i>mem</i>[0]+<i>in</i>[0]=6,即为该段的和。算法3给出了快速分段求和算法的伪代码。</p>
                </div>
                <div class="p1">
                    <p id="144"><b>算法3</b> 快速分段求和算法</p>
                </div>
                <div class="p1">
                    <p id="145">1.begin</p>
                </div>
                <div class="p1">
                    <p id="146">2.id=blockIdx.x * blockDim.x + threadIdx.x;</p>
                </div>
                <div class="p1">
                    <p id="147">3.tid=threadIdx.x;</p>
                </div>
                <div class="p1">
                    <p id="148">4.laneId=threadIdx.x % 32;</p>
                </div>
                <div class="p1">
                    <p id="149">5.__share__ space[1 024];</p>
                </div>
                <div class="p1">
                    <p id="150">6.tmp=in;</p>
                </div>
                <div class="p1">
                    <p id="151">7.for offset=1;offset &lt; 32;offset *= 2 do</p>
                </div>
                <div class="p1">
                    <p id="152">8.t=in;</p>
                </div>
                <div class="p1">
                    <p id="153">9.t += warp.shfl_up(t,offset);</p>
                </div>
                <div class="p1">
                    <p id="154">10.if laneId &gt;= offset then</p>
                </div>
                <div class="p1">
                    <p id="155">11.in=t;</p>
                </div>
                <div class="p1">
                    <p id="156">12.space[tid]=in;</p>
                </div>
                <div class="p1">
                    <p id="157">13.if rowSegLen[id] &gt; 0 then</p>
                </div>
                <div class="p1">
                    <p id="158">14.in=tmp + space[tid + rowSegLen [id]-1]-in;</p>
                </div>
                <div class="p1">
                    <p id="159">15.atomicAdd(out + rowPerm[id],in);</p>
                </div>
                <h3 id="160" name="160" class="anchor-tag">3 实验结果与分析</h3>
                <div class="p1">
                    <p id="161">实验选取2种测试环境:1)Intel(R) Core(TM) i5-3210M CPU @ 2.50 GHz 4核,8.00 GB内存,Windows 10操作系统,NVIDIA GeForce GT 650M显卡;2)Intel(R) Xeon(R) Gold 5122 CPU @ 3.60 GHz 8核,Ubuntu 16.04操作系统,GeForce GTX 1080Ti显卡。CUDA版本均为9.0。GPU各项性能指标如表1所示。</p>
                </div>
                <div class="area_img" id="162">
                    <p class="img_tit"><b>表1 GPU各项性能指标</b> <a class="downexcel" onclick="DownLoadReportExcel(this)">导出到EXCEL</a></p>
                    <p class="img_tit"></p>
                    <p class="img_note"></p>
                    <table id="162" border="1"><tr><td><br />性能指标</td><td>GeForce GT 650M</td><td>GeForce GTX 1080Ti</td></tr><tr><td><br />计算架构</td><td>Kepler</td><td>Pascal</td></tr><tr><td><br />计算能力</td><td>3.0</td><td>6.1</td></tr><tr><td><br />流多处理器数</td><td>2(384 Cores)</td><td>28(3 584 Cores)</td></tr><tr><td><br />线程块/流多处理器的<br />最大线程数</td><td>1 024/2 048</td><td>1 024/2 048</td></tr><tr><td><br />线程块的共享存储器/KB</td><td>48</td><td>48</td></tr><tr><td><br />L2缓存/KB</td><td>48</td><td>2 816</td></tr><tr><td><br />全局存储器/MB</td><td>2 048</td><td>11 168</td></tr><tr><td><br />峰值带宽/(GB·s<sup>-1</sup>)</td><td>64</td><td>484.44</td></tr></table>
                    <form name="form" action="/kxreader/Detail/DownloadReportExcel" method="POST" style="display:inline">
                        <input type="hidden" name="hidTable" value="" />
                        <input type="hidden" name="hidFileName" value="" />
                    </form>
                    <p class="img_note"></p>
                    <p class="img_note"></p>
                </div>
                <div class="p1">
                    <p id="163">为评估基于BRCP格式的SpMV性能,本文从以下4个方面进行实验:1)与BRC格式比较SpMV操作的计算耗时;2)与BRC格式比较SpMV得出的结果向量与准确值的相对误差;3)与BRC格式以及LightSpMV格式比较PageRank的加速性能;4)与BRC格式比较PageRank排序结果的准确率。</p>
                </div>
                <h4 class="anchor-tag" id="164" name="164">3.1 SpMV计算耗时</h4>
                <div class="p1">
                    <p id="165">本文选择10个稀疏矩阵评估SpMV的性能,前4个来自NVIDIA Research,剩下的来自UF Sparse Matrix Collection<citation id="312" type="reference"><link href="275" rel="bibliography" /><sup>[<a class="sup">23</a>]</sup></citation>,即佛罗里达大学稀疏矩阵集。这10个矩阵均是带权稀疏矩阵,本文避免设置矩阵数值,使实验结论更具信服力。表2给出矩阵特征,包括矩阵行列数、非零元素总数、各行非零元素的最小值/最大值、平均值/标准差(<i>μ</i>/<i>σ</i>)。</p>
                </div>
                <div class="p1">
                    <p id="166">实验统计BRC和BRCP进行一次SpMV操作的计算耗时,排除主机和设备之间数据传输耗时以及在主机端执行的一次数据结构转换的开销,避免受到CPU性能和内存带宽的影响,只统计在GPU中的计算时间。每次实验进行20次SpMV计算,并记录耗时的算术平均值。</p>
                </div>
                <div class="area_img" id="167">
                    <p class="img_tit"><b>表2 SpMV稀疏矩阵集</b> <a class="downexcel" onclick="DownLoadReportExcel(this)">导出到EXCEL</a></p>
                    <p class="img_tit"></p>
                    <p class="img_note"></p>
                    <table id="167" border="1"><tr><td>稀疏矩阵</td><td>行列数</td><td>非零元<br />素总数</td><td>各行非零元素的<br />最小值/最大值</td><td colspan="2">各行非零元素的<br />平均值/标准差</td></tr><tr><td>cant</td><td>62 451</td><td>2 034 917</td><td>1/40</td><td>7</td><td>/33</td></tr><tr><td><br />consph</td><td>83 334</td><td>3 046 907</td><td>1/66</td><td>37</td><td>/11</td></tr><tr><td><br />rma10</td><td>46 835</td><td>2 374 001</td><td>4/145</td><td>51</td><td>/28</td></tr><tr><td><br />webbase-1M</td><td>1 000 005</td><td>3 105 536</td><td>1/4 700</td><td>3</td><td>/25</td></tr><tr><td><br />Belcastro/human_gene1</td><td>22 283</td><td>24 691 926</td><td>2/7 940</td><td>1 108</td><td>/1 409</td></tr><tr><td><br />Belcastro/mouse_gene</td><td>45 101</td><td>29 012 392</td><td>2/8 033</td><td>643</td><td>/857</td></tr><tr><td><br />DIMACS10/fl2010</td><td>484 481</td><td>2 346 294</td><td>1/177</td><td>5</td><td>/3</td></tr><tr><td><br />DIMACS10/il2010</td><td>451 554</td><td>2 164 464</td><td>1/90</td><td>5</td><td>/2</td></tr><tr><td><br />vanHeukelum/cage13</td><td>445 315</td><td>7 479 343</td><td>3/39</td><td>17</td><td>/5</td></tr><tr><td><br />vanHeukelum/cage14</td><td>1 505 785</td><td>27 130 349</td><td>5/41</td><td>18</td><td>/5</td></tr></table>
                    <form name="form" action="/kxreader/Detail/DownloadReportExcel" method="POST" style="display:inline">
                        <input type="hidden" name="hidTable" value="" />
                        <input type="hidden" name="hidFileName" value="" />
                    </form>
                    <p class="img_note"></p>
                    <p class="img_note"></p>
                </div>
                <div class="p1">
                    <p id="168">BRC和BRCP格式在2种平台下进行一次SpMV计算的执行时间如图6、图7所示。</p>
                </div>
                <div class="area_img" id="169">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JSJC201909004_169.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU40eEVEZ0d2Qys0RlVmUWpwd0I5dz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图6 GeForce GT 650M平台上BRC与BRCP的SpMV耗时比较" src="Detail/GetImg?filename=images/JSJC201909004_169.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU40eEVEZ0d2Qys0RlVmUWpwd0I5dz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit"><b>图6 GeForce GT 650M平台上BRC与BRCP的SpMV耗时比较</b>  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JSJC201909004_169.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU40eEVEZ0d2Qys0RlVmUWpwd0I5dz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="area_img" id="170">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JSJC201909004_170.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU40eEVEZ0d2Qys0RlVmUWpwd0I5dz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图7 GeForce GTX 1080Ti平台上BRC与BRCP的SpMV耗时比较" src="Detail/GetImg?filename=images/JSJC201909004_170.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU40eEVEZ0d2Qys0RlVmUWpwd0I5dz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit"><b>图7 GeForce GTX 1080Ti平台上BRC与BRCP的SpMV耗时比较</b>  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JSJC201909004_170.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU40eEVEZ0d2Qys0RlVmUWpwd0I5dz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="p1">
                    <p id="171">BRCP格式相比BRC的GPU kernel多出一个分段求和的步骤,因此大部分情况下基于BRCP的SpMV耗时更多,BRC格式在GT 650M GPU平台上耗时平均为BRC的1.25倍,在GTX 1080Ti GPU平台上耗时平均为BRC的1.1倍,可见BRCP格式在大部分SpMV计算中牺牲了一定的计算效率。</p>
                </div>
                <h4 class="anchor-tag" id="172" name="172">3.2 SpMV结果向量的相对误差</h4>
                <div class="p1">
                    <p id="173">将表2中的带权稀疏矩阵与一个全1向量相乘,分别用BRC格式和BRCP格式进行SpMV计算,并将得到的结果向量(<i>x</i><sub>1</sub>,<i>x</i><sub>2</sub>,…,<i>x</i><sub><i>n</i></sub>)与真值向量(<i>μ</i><sub>1</sub>,<i>μ</i><sub>2</sub>,…,<i>μ</i><sub><i>n</i></sub>)按式(4)计算出相对误差。</p>
                </div>
                <div class="p1">
                    <p id="174" class="code-formula">
                        <mathml id="174"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>R</mi><mi>E</mi><mo>=</mo><mstyle displaystyle="true"><munder><mo>∑</mo><mi>i</mi></munder><mrow><mfrac><mrow><mi>x</mi><msub><mrow></mrow><mi>i</mi></msub><mo>-</mo><mi>μ</mi><msub><mrow></mrow><mi>i</mi></msub></mrow><mrow><mi>μ</mi><msub><mrow></mrow><mi>i</mi></msub></mrow></mfrac></mrow></mstyle><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mrow><mtext> </mtext><mtext> </mtext><mtext> </mtext></mrow><mo stretchy="false">(</mo><mn>4</mn><mo stretchy="false">)</mo></mrow></math></mathml>
                    </p>
                </div>
                <div class="p1">
                    <p id="175">BRC与BRCP的SpMV相对误差比较如表3所示。对于矩阵cant的SpMV,BRC格式在2种GPU上表现均优于BRCP。对于矩阵consph,BRCP在GeForce GT 650M上的误差比BRC小,而在GeForce GTX1080 Ti上误差较大。在其余大部分情况下,本文提出的BRCP格式相对于BRC格式,与准确值之间的误差较小。BRC格式在矩阵consph和webbase-1M的计算中,受到不同平台线程调度不确定性的影响,在2种GPU平台下的计算结果误差差距较大,而BRCP格式在不同平台下的结果表现出更好的再现性。</p>
                </div>
                <div class="area_img" id="176">
                    <p class="img_tit"><b>表3 BRC与BRCP的SpMV相对误差比较</b> <a class="downexcel" onclick="DownLoadReportExcel(this)">导出到EXCEL</a></p>
                    <p class="img_tit"></p>
                    <p class="img_note"></p>
                    <table id="176" border="1"><tr><td rowspan="3"><br />稀疏矩阵</td><td colspan="2"><br />GeForce GT 650M</td><td colspan="2">GeForce GTX 1080Ti</td></tr><tr><td colspan="2"><br /></td><td colspan="2"></td></tr><tr></tr><tr><td>cant</td><td>0.006 353</td><td>0.071 345</td><td>0.005 989</td><td>0.064 358</td></tr><tr><td><br />consph</td><td>6.898 257</td><td>0.201 417</td><td>0.022 777</td><td>0.091 067</td></tr><tr><td><br />rma10</td><td>5.461 187</td><td>0.000 000</td><td>5.461 187</td><td>0.000 000</td></tr><tr><td><br />webbase-1M</td><td>1.726 860</td><td>0.446 535</td><td>4.442 622</td><td>0.362 778</td></tr><tr><td><br />Belcastro/human_gene1</td><td>7.471 732</td><td>0.011 107</td><td>7.471 729</td><td>0.011 107</td></tr><tr><td><br />Belcastro/mouse_gene</td><td>9.278 843</td><td>0.020 003</td><td>9.278 842</td><td>0.020 003</td></tr><tr><td><br />DIMACS10/fl2010</td><td>12.187 372</td><td>0.001 693</td><td>12.187 372</td><td>0.001 693</td></tr><tr><td><br />DIMACS10/il2010</td><td>9.107 744</td><td>0.001 344</td><td>9.107 744</td><td>0.001 344</td></tr><tr><td><br />vanHeukelum/cage13</td><td>7.196 009</td><td>0.169 302</td><td>7.196 009</td><td>0.169 302</td></tr><tr><td><br />vanHeukelum/cage14</td><td>1.528 160</td><td>0.569 980</td><td>1.528 160</td><td>0.569 980</td></tr></table>
                    <form name="form" action="/kxreader/Detail/DownloadReportExcel" method="POST" style="display:inline">
                        <input type="hidden" name="hidTable" value="" />
                        <input type="hidden" name="hidFileName" value="" />
                    </form>
                    <p class="img_note"></p>
                    <p class="img_note"></p>
                </div>
                <h4 class="anchor-tag" id="177" name="177">3.3 PageRank排序耗时</h4>
                <div class="p1">
                    <p id="178">为衡量基于BRCP SpMV的PageRank性能,本文选取表4给出的10个来自不同领域的真实网络数据集,其中real1～real4分别表示自治系统网络、Internet网络、道路网络和社交网络(http://www.dcjingsai.com/),其余6个网络检索自UF Sparse Matrix Collection<citation id="313" type="reference"><link href="275" rel="bibliography" /><sup>[<a class="sup">23</a>]</sup></citation>。</p>
                </div>
                <div class="area_img" id="179">
                    <p class="img_tit"><b>表4 PageRank稀疏矩阵集</b> <a class="downexcel" onclick="DownLoadReportExcel(this)">导出到EXCEL</a></p>
                    <p class="img_tit"></p>
                    <p class="img_note"></p>
                    <table id="179" border="1"><tr><td><br />稀疏矩阵</td><td>行列数</td><td>非零元素总数</td></tr><tr><td><br />real1</td><td>1 694 616</td><td>22 188 418</td></tr><tr><td><br />real2</td><td>1 957 027</td><td>5 520 776</td></tr><tr><td><br />real3</td><td>426 485</td><td>17 086 642</td></tr><tr><td><br />real4</td><td>855 802</td><td>8 582 704</td></tr><tr><td><br />LAW/eu-2005</td><td>862 664</td><td>19 235 140</td></tr><tr><td><br />LAW/in-2004</td><td>1 382 908</td><td>16 917 053</td></tr><tr><td><br />SNAP/as-skitter</td><td>1 696 415</td><td>22 190 596</td></tr><tr><td><br />SNAP/higgs-twitter</td><td>456 626</td><td>14 855 842</td></tr><tr><td><br />SNAP/sx-stackoverflow</td><td>2 601 977</td><td>36 233 450</td></tr><tr><td><br />SNAP/wiki-topcats</td><td>1 791 489</td><td>28 511 807</td></tr></table>
                    <form name="form" action="/kxreader/Detail/DownloadReportExcel" method="POST" style="display:inline">
                        <input type="hidden" name="hidTable" value="" />
                        <input type="hidden" name="hidFileName" value="" />
                    </form>
                    <p class="img_note"></p>
                    <p class="img_note"></p>
                </div>
                <div class="p1">
                    <p id="180">实验将PageRank算法中的阻尼系数<i>α</i>设为0.85,收敛约束<i>ε</i>设为10<sup>-5</sup>。根据式(2),GPU中PageRank的每轮迭代包含一次并行的SpMV和一次并行向量加法,将计算结果与上一轮迭代结果的误差向量做规约得到误差值,若小于<i>ε</i>则终止迭代。不同矩阵格式的PageRank只在SpMV操作中有所不同,其余操作均不受矩阵格式影响。本文统计在GPU中PageRank所有迭代过程的时间,每个实验重复20次并记录平均值。本文引入基于CSR格式的SpMV方法LightSpMV<citation id="314" type="reference"><link href="251" rel="bibliography" /><sup>[<a class="sup">11</a>]</sup></citation>作为性能基准,该算法的执行效率优于CUSP、ViennaCL和cuSPARSE等,同时使用基于BRC格式的SpMV方法,并与本文提出的BRCP算法做比较,执行时间如图8、图9所示。</p>
                </div>
                <div class="area_img" id="181">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JSJC201909004_181.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU40eEVEZ0d2Qys0RlVmUWpwd0I5dz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图8 GeForce GT 650M平台上基于LightSpMV、BRC和BRCP格式的PageRank耗时比较" src="Detail/GetImg?filename=images/JSJC201909004_181.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU40eEVEZ0d2Qys0RlVmUWpwd0I5dz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit"><b>图8 GeForce GT 650M平台上基于LightSpMV、BRC和BRCP格式的PageRank耗时比较</b>  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JSJC201909004_181.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU40eEVEZ0d2Qys0RlVmUWpwd0I5dz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="area_img" id="182">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JSJC201909004_182.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU40eEVEZ0d2Qys0RlVmUWpwd0I5dz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图9 GeForce GTX 1080Ti平台上基于LightSpMV、BRC和BRCP格式的PageRank耗时比较" src="Detail/GetImg?filename=images/JSJC201909004_182.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU40eEVEZ0d2Qys0RlVmUWpwd0I5dz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit"><b>图9 GeForce GTX 1080Ti平台上基于LightSpMV、BRC和BRCP格式的PageRank耗时比较</b>  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JSJC201909004_182.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU40eEVEZ0d2Qys0RlVmUWpwd0I5dz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="p1">
                    <p id="183">可以看出,基于BRCP的PageRank执行时间在每种情况下都优于LightSpMV,在GT 650M GPU上平均加速比为1.87,最高加速比达到2.31;在GTX 1080Ti GPU上平均加速比为2.91,最高加速比为4.29。在GT 650M GPU上,基于BRCP的PageRank比BRC格式总体稍慢一些,速度仅为BRC的89%;而在GTX 1080Ti GPU上,BRCP格式与BRC格式的执行效率大体一致,平均获得了1.05倍的加速。可见,基于BRCP格式的SpMV在实际应用于PageRank算法时,不仅充分利用了GPU的并行计算能力,而且在修复BRC格式漏洞的同时,也保持了原有计算效率。</p>
                </div>
                <h4 class="anchor-tag" id="184" name="184">3.4 PageRank排序结果准确率</h4>
                <div class="p1">
                    <p id="185">实验分别基于BRC格式和BRCP格式的SpMV进行PageRank计算,得到每个节点的分值,并根据分值按照重要性从大到小的顺序对节点排序,最后将2种排序结果与准确的排序结果相比较,得到2种方法执行PageRank的准确率。例如有3个节点<i>A</i>、<i>B</i>、<i>C</i>,节点重要性的正确顺序是<i>A</i>&gt;<i>B</i>&gt;<i>C</i>,若得出的顺序是<i>A</i>&gt;<i>C</i>&gt;<i>B</i>,则排序正确的节点数为1;若得出的顺序是<i>B</i>&gt;<i>C</i>&gt;<i>A</i>,则排序正确的节点数为0。在节点重要性排序中,重要程度越高的节点是否准确排序更为关键,因此本文统计了结果向量的前100个,比较其与正确结果的相同排名数量,如图10、图11所示。</p>
                </div>
                <div class="area_img" id="186">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JSJC201909004_186.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU40eEVEZ0d2Qys0RlVmUWpwd0I5dz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图10 GeForce GT 650M平台上BRC与BRCP前100个结果向量的准确率比较" src="Detail/GetImg?filename=images/JSJC201909004_186.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU40eEVEZ0d2Qys0RlVmUWpwd0I5dz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit"><b>图10 GeForce GT 650M平台上BRC与BRCP前100个结果向量的准确率比较</b>  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JSJC201909004_186.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU40eEVEZ0d2Qys0RlVmUWpwd0I5dz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="area_img" id="187">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JSJC201909004_187.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU40eEVEZ0d2Qys0RlVmUWpwd0I5dz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图11 GeForce GTX 1080Ti平台上BRC与BRCP前100个结果向量的准确率比较" src="Detail/GetImg?filename=images/JSJC201909004_187.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU40eEVEZ0d2Qys0RlVmUWpwd0I5dz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit"><b>图11 GeForce GTX 1080Ti平台上BRC与BRCP前100个结果向量的准确率比较</b>  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JSJC201909004_187.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU40eEVEZ0d2Qys0RlVmUWpwd0I5dz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="p1">
                    <p id="188">虽然实验中BRC格式SpMV的误差在数值上较小,但从中可以发现,当其应用于PageRank算法时,微小的误差也会导致无法准确地对网络节点进行排名,而修复了BRC缺陷的BRCP几乎能够得到与正确答案相同的结果。</p>
                </div>
                <h3 id="189" name="189" class="anchor-tag">4 结束语</h3>
                <div class="p1">
                    <p id="190">本文在支持CUDA的GPU上提出可用于PageRank等数据挖掘算法的SpMV方法。该方法基于BRCP数据结构,使用分块策略表示稀疏矩阵,适用于各种稀疏矩阵,如各行非零元素分布较平均或者是各行非零元素标准差远高于均值、波动较大的矩阵,尤其是具有幂律特征的稀疏矩阵。BRCP存储格式在并行环境中具有较高的计算准确率,并保证了不同系统中计算结果的再现性,最终通过实验验证了该方法的有效性和可行性。随着网络规模的扩大,单GPU已经难以处理超大规模的数据,因此将基于单GPU的算法扩展到单机多GPU以及分布式环境的多机多GPU中将是下一步的研究方向。</p>
                </div>

        <!--brief end-->
        
        <!--conten left  end-->
        <!--增强附件-->
        

        <!--reference start-->
            <div class="reference anchor-tag" id="a_bibliography">
                    <h3>参考文献</h3>
                                        <p id="231">
                            <a id="bibliography_1" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JSJA201704041&amp;v=MDg0NzdZUUtESDg0dlI0VDZqNTRPM3pxcUJ0R0ZyQ1VSTE9lWmVSdEZ5SGtVcnJJTHo3QmI3RzRIOWJNcTQ5Qlo=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU40eEVEZ0d2Qys0RlVmUWpwd0I5dz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[1]</b> 尹孟嘉,许先斌,何水兵,等.GPU稀疏矩阵向量乘的性能模型构造[J].计算机科学,2017,44(4):182-187.
                            </a>
                        </p>
                        <p id="233">
                            <a id="bibliography_2" target="_blank" href="http://scholar.cnki.net/result.aspx?q=The anatomy of a large-scale hypertextual web search engine">

                                <b>[2]</b> BRIN S,PAGE L.The anatomy of a large-scale hypertextual Web search engine[J].Computer Networks and ISDN Systems,1998,30(1):107-117.
                            </a>
                        </p>
                        <p id="235">
                            <a id="bibliography_3" target="_blank" href="/kcms/detail/detail.aspx?dbcode=SPQD&amp;filename=SPQD00000835797&amp;v=Mjc2NjE0eEFZK0lJWTNrNXpCZGg0ajk5U1hxUnJ4b3hjTUg3UjdxZWJ1ZHRGQ3ZsV3I3SkpWND1OajNhYXJPNEh0SE1w&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU40eEVEZ0d2Qys0RlVmUWpwd0I5dz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[3]</b> TONG Hanghang,FALOUTSOS C,PAN Jiayu.Random walk with restart:fast solutions and applications[J].Knowledge and Information Systems,2008,14(3):327-346.
                            </a>
                        </p>
                        <p id="237">
                            <a id="bibliography_4" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Evaluation criteria for sparse matrix storage formats">

                                <b>[4]</b> LANGR D,TVRDÍK P.Evaluation criteria for sparse matrix storage formats[J].IEEE Transactions on Parallel and Distributed Systems,2016,27(2):428-440.
                            </a>
                        </p>
                        <p id="239">
                            <a id="bibliography_5" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JFYZ201404019&amp;v=MTA0MzVrVXJySUx5dlNkTEc0SDlYTXE0OUViWVFLREg4NHZSNFQ2ajU0TzN6cXFCdEdGckNVUkxPZVplUnRGeUg=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU40eEVEZ0d2Qys0RlVmUWpwd0I5dz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[5]</b> 李佳佳,张秀霞,谭光明,等.选择稀疏矩阵乘法最优存储格式的研究[J].计算机研究与发展,2014,51(4):882-894.
                            </a>
                        </p>
                        <p id="241">
                            <a id="bibliography_6" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=RJXB201812020&amp;v=MjE1MDM0dlI0VDZqNTRPM3pxcUJ0R0ZyQ1VSTE9lWmVSdEZ5SGtVcnJJTnlmVGJMRzRIOW5Oclk5SFpJUUtESDg=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU40eEVEZ0d2Qys0RlVmUWpwd0I5dz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[6]</b> 刘芳芳,杨超,袁欣辉,等.面向国产申威26010众核处理器的SpMV实现与优化[J].软件学报,2018,29(12):3921-3932.
                            </a>
                        </p>
                        <p id="243">
                            <a id="bibliography_7" target="_blank" href="http://scholar.cnki.net/result.aspx?q=NVIDIA Tesla: A unified graphics and computing architecture">

                                <b>[7]</b> LINDHOLM E,NICKOLLS J,OBERMAN S,et al.NVIDIA Tesla:a unified graphics and computing architecture[J].IEEE Micro,2008,28(2):39-55.
                            </a>
                        </p>
                        <p id="245">
                            <a id="bibliography_8" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Optimization techniques for sparse matrix-vector multiplication on GPUs">

                                <b>[8]</b> MAGGIONI M,BERGER-WOLF T.Optimization techniques for sparse matrix-vector multiplication on GPUs[J].Journal of Parallel and Distributed Computing,2016,93(C):66-86.
                            </a>
                        </p>
                        <p id="247">
                            <a id="bibliography_9" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JFYZ201802006&amp;v=MTY0NzlHRnJDVVJMT2VaZVJ0RnlIa1VycklMeXZTZExHNEg5bk1yWTlGWW9RS0RIODR2UjRUNmo1NE8zenFxQnQ=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU40eEVEZ0d2Qys0RlVmUWpwd0I5dz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[9]</b> 张珩,张立波,武延军.基于Multi-GPU平台的大规模图数据处理[J].计算机研究与发展,2018,55(2):273-288.
                            </a>
                        </p>
                        <p id="249">
                            <a id="bibliography_10" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JSJC201808010&amp;v=MTQ5NjR2UjRUNmo1NE8zenFxQnRHRnJDVVJMT2VaZVJ0RnlIa1VycklMejdCYmJHNEg5bk1wNDlFWklRS0RIODQ=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU40eEVEZ0d2Qys0RlVmUWpwd0I5dz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[10]</b> 程凯,田瑾,马瑞琳.基于GPU的高效稀疏矩阵存储格式研究[J].计算机工程,2018,44(8):54-60.
                            </a>
                        </p>
                        <p id="251">
                            <a id="bibliography_11" target="_blank" href="http://scholar.cnki.net/result.aspx?q=LightSpMV:faster CUDA-compatible sparse matrix-vector multiplication using compressed sparse rows">

                                <b>[11]</b> LIU Yongchao,SCHMIDT B.LightSpMV:faster CUDA-compatible sparse matrix-vector multiplication using compressed sparse rows[J].Journal of Signal Processing Systems,2018,90(1):69-86.
                            </a>
                        </p>
                        <p id="253">
                            <a id="bibliography_12" target="_blank" href="http://scholar.cnki.net/result.aspx?q=CSR5:An Efficient Storage Format for Cross-Platform Sparse Matrix-Vector Multiplication">

                                <b>[12]</b> LIU Weifeng,VINTER B.CSR5:an efficient storage format for cross-platform sparse matrix-vector multiplication[C]//Proceedings of ACM International Conference on Supercomputing.New York,USA:ACM Press,2015:339-350.
                            </a>
                        </p>
                        <p id="255">
                            <a id="bibliography_13" target="_blank" href="http://scholar.cnki.net/result.aspx?q=An efficient two-dimensional blocking strategy for sparse matrix-vector multiplication on GPUs">

                                <b>[13]</b> ASHARI A,SEDAGHATI N,EISENLOHR J,et al.An efficient two-dimensional blocking strategy for sparse matrix-vector multiplication on GPUs[M].Berlin,Germany:Springer,2014.
                            </a>
                        </p>
                        <p id="257">
                            <a id="bibliography_14" target="_blank" href="/kcms/detail/detail.aspx?dbcode=SJES&amp;filename=SJES14121200056754&amp;v=MTI4NzA0SkMzazlvQk1UNlQ0UFFIL2lyUmRHZXJxUVRNbndaZVp1SHlqbVVMeklLVjhWYnhJPU5pZk9mYks4SDlQTnJZOUZaTw==&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU40eEVEZ0d2Qys0RlVmUWpwd0I5dz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[14]</b> ASHARI A,SEDAGHATI N,EISENLOHR J,et al.A model-driven blocking strategy for load balanced sparse matrix-vector multiplication on GPUs[J].Journal of Parallel and Distributed Computing,2015,76:3-15.
                            </a>
                        </p>
                        <p id="259">
                            <a id="bibliography_15" target="_blank" href="/kcms/detail/detail.aspx?dbcode=SSJD&amp;filename=SSJD00002467916&amp;v=MjgwNDdDYmVvSlkzazV6QmRoNGo5OVNYcVJyeG94Y01IN1I3cWVidWR0RkN2bFdyN0pKVjQ9Tmo3QmFyTzRIdEhPcTRs&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU40eEVEZ0d2Qys0RlVmUWpwd0I5dz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[15]</b> WILKINSON J H.Error analysis of floating-point computation[J].Numerische Mathematik,1960,2(1):319-340.
                            </a>
                        </p>
                        <p id="261">
                            <a id="bibliography_16" target="_blank" href="/kcms/detail/detail.aspx?dbcode=SJCM&amp;filename=SJCM13091000025778&amp;v=MDUyODd1SHlqbVVMeklLVjhWYnhJPU5pZklZN0s3SHRqTnI0OUZaT2tLQzNzeG9CTVQ2VDRQUUgvaXJSZEdlcnFRVE1ud1plWg==&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU40eEVEZ0d2Qys0RlVmUWpwd0I5dz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[16]</b> HILLIS W D,STEELE G L.Data parallel algorithms[J].Communications of the ACM,1986,29(12):1170-1183.
                            </a>
                        </p>
                        <p id="263">
                            <a id="bibliography_17" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Parallel prefix sum (scan)with CUDA">

                                <b>[17]</b> HARRIS M,SENGUPTA S,OWENS J D.Parallel prefix sum(scan) with CUDA[M]//NGUYEN H.GPU Gems 3.New Jersey,USA:Addison Wesley,2007:851-876.
                            </a>
                        </p>
                        <p id="265">
                            <a id="bibliography_18" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Scan primitives for gpu computing">

                                <b>[18]</b> SENGUPTA S,HARRIS M,ZHANG Yao,et al.Scan primitives for GPU computing[C]//Proceedings of ACM SIGGRAPH/EUROGRAPHICS Symposium on Graphics Hardware.New York,USA:ACM Press,2007:97-106.
                            </a>
                        </p>
                        <p id="267">
                            <a id="bibliography_19" target="_blank" href="/kcms/detail/detail.aspx?dbcode=SJCM&amp;filename=SJCM85EC429A7979D3512703E09658F8C844&amp;v=MDQzMzkwWStJSUJRZzZ5aGNSN1Q5K1BYL3JxaGM5RDdyblRiNmJDT052RlNpV1dyN0pJRnBtYUJ1SFlmT0dRbGZDcGJRMzVOdGh6Ym0reGFnPU5pZklZN3U5YTZMSXJZWQ==&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU40eEVEZ0d2Qys0RlVmUWpwd0I5dz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[19]</b> FILIPPONE S,CARDELLINI V,BARBIERI D,et al.Sparse matrix-vector multiplication on GPGPUs[J].ACM Transactions on Mathematical Software,2017,43(4):1-49.
                            </a>
                        </p>
                        <p id="269">
                            <a id="bibliography_20" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Segmented Operations forSparse Matrix Computation on Vector Multiprocessors">

                                <b>[20]</b> BLELLOCH G E,HEROUX M A,ZAGHA M.Segmented operations for sparse matrix computation on vector multiprocessors:CMU-CS-93-173[R].Pittsburgh,USA:Carnegie Mellon University,1993:1-7.
                            </a>
                        </p>
                        <p id="271">
                            <a id="bibliography_21" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Professional CUDA C Programming">

                                <b>[21]</b> CHENG J,GROSSMAN M,MCKERCHER T.Professional CUDA C Programming[M].[S.l.]:Wrox,2014.
                            </a>
                        </p>
                        <p id="273">
                            <a id="bibliography_22" target="_blank" href="http://scholar.cnki.net/result.aspx?q=CUDA C programming guide">

                                <b>[22]</b> NVIDIA.CUDA C programming guide[EB/OL].[2018-11-27].https://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html.
                            </a>
                        </p>
                        <p id="275">
                            <a id="bibliography_23" target="_blank" href="/kcms/detail/detail.aspx?dbcode=SJCM&amp;filename=SJCM13091000001048&amp;v=MDQ2MTR6SUtWOFZieEk9TmlmSVk3SzdIdGpOcjQ5RlpPc09ESGd4b0JNVDZUNFBRSC9pclJkR2VycVFUTW53WmVadUh5am1VTA==&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU40eEVEZ0d2Qys0RlVmUWpwd0I5dz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[23]</b> DAVIS T A,HU Yifan.The university of florida sparse matrix collection[J].ACM Transactions on Mathematical Software,2011,38(1):1-25.
                            </a>
                        </p>
            </div>
        <!--reference end-->
        <!--footnote start-->
        <!--footnote end-->



    </div>

        <input id="fileid" type="hidden" value="JSJC201909004" />
        <input id="dpi" type="hidden" value="600" />
    </div>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?6e967eb120601ea41b9d312166416aa6";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
</script>

    


<input id="hid_uid" name="hid_uid" type="hidden" value="WEEvREcwSlJHSldRa1Fhb09jT0lPUU40eEVEZ0d2Qys0RlVmUWpwd0I5dz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
<input id="hid_kLogin_headerUrl" name="hid_kLogin_headerUrl" type="hidden" value="/KLogin/Request/GetKHeader.ashx%3Fcallback%3D%3F" />
<input id="hid_kLogin_footerUrl" name="hid_kLogin_footerUrl" type="hidden" value="/KLogin/Request/GetKFooter.ashx%3Fcallback%3D%3F" />
<div class="btn-link" style="display: none"><a target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JSJC201909004&amp;v=Mjg4NDRSTE9lWmVSdEZ5SGtVcnJJTHo3QmJiRzRIOWpNcG85RllJUUtESDg0dlI0VDZqNTRPM3pxcUJ0R0ZyQ1U=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU40eEVEZ0d2Qys0RlVmUWpwd0I5dz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">知网节</a></div>
<div class="popflow" id="popupTips" style="display: none;">
    <div class="popflowArr"></div>
    <div class="popflowCot">
        <div class="hd"><a href="javascript:void(0);" onclick="$('#popupTips').hide();$('#popupmsg').html('')" class="close">X</a></div>
        <div class="bd">
            <p class="mes" id="popupmsg" name="popupmsg"></p>
          
        </div>
    </div>
</div>
<input type="hidden" id="myexport" value="//kns.cnki.net" />

<input type="hidden" id="KPCAPIPATH" value="//ishufang.cnki.net" />
<input type="hidden" id="CitedTimes" value="" />
<div class="link" id="GLSearch" style="display: none;">
    <i class="icon-trangle"></i>
    <div class="inner">
        <a class="icon" id="copytext">复制</a>
        <a class="icon" target="_blank" onclick="searchCRFD(this)">工具书搜索</a>
    </div>
</div>




<input id="hidVirtualPath" name="hidVirtualPath" type="hidden" value="/kxreader" />
<script src="/kxreader/bundles/detail?v=-ULdk-c6FkZHtJA2KAXPgHnyA8mtgyPnBde_C2VZ2BY1"></script>

<script src="/kxreader/Scripts/layer.min.js" type="text/javascript"></script>

<div id="footerBox" class="rootw footer">
</div>
<script>
    if (typeof FlushLogin == 'function') {
        FlushLogin();
    }
    modifyEcpHeader(true);
</script>

<!--图片放大功能 start-->
<script src="/kxreader/bundles/imagebox?v=W4phPu9SNkGcuPeJclikuVE3PpRyIW_gnfjm_19nynI1"></script>

<script type="text/javascript">
    $(function () {
        var j = $.noConflict();
        j(function () {
            j(".zoom-in,.btn-zoomin").imgbox({
                'alignment': 'center',
                'allowMultiple': false,
                'overlayShow': true
            });
        })
    });
</script>
<!--图片放大功能 end-->
<div class="fixedbar">
    <div class="backtop hiddenV" id="backtop">
        <a id="backTopSide" href="javascript:scroll(0,0);" title=""></a>
    </div>
</div>
<script type="text/javascript" src="/kxreader/Scripts/MathJax-2.6-latest/MathJax.js?config=MML_HTMLorMML-full"></script>

</body>
</html>
