<!DOCTYPE html>
<html>
<head>
    <title>全文阅读--XML全文阅读--中国知网</title>
    <link rel="icon" href="/kxreader/favicon.ico" />
    <link rel="shortcut Icon" href="/kxreader/favicon.ico" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="keywords" content="文献 XML KBASE CNKI 中国知网" />
    <meta name="description" content="XML文献检索" />
    <link href="/kxreader/Content/css/detail?v=qX2z2KjRAEyQiNfAbKtl7dLnsqFoQ5Jdw3TZfDf0n1k1" rel="stylesheet"/>

    <script type="text/javascript">
        var APPPATH = '/kxreader';
    </script>
</head>

<body>
    
<script type="text/javascript" src="//login.cnki.net/TopLogin/api/loginapi/get?type=top&amp;localCSS=&amp;returnurl=%2f%2fkns.cnki.net%2f%2fKXReader%2fDetail%3fTIMESTAMP%3d637130589510587500%26DBCODE%3dCJFD%26TABLEName%3dCJFDLAST2019%26FileName%3dJSJC201904002%26RESULT%3d1%26SIGN%3drm8%252fUJke7VnyxsxqvKKjEPavKzs%253d"></script>

<div id="headerBox" class="header">
    <div class="topbar">
        <div class="textalign">
            <a href="/kxreader/Detail?dbcode=CJFD&amp;filename=JSJC201904002&amp;align=md">
                <i class="icon-cen active" title="居中对齐"></i>
            </a>
            <a href="/kxreader/Detail?dbcode=CJFD&amp;filename=JSJC201904002&amp;align=lt">
                <i class="icon-left " title="左对齐"></i>
            </a>
        </div>
        <h6 class="free-tip"><i class="icon"></i>HTML阅读开放试用阶段，欢迎体验！</h6>
    </div>
</div>

    



<div class="btn-link" style="display: none"><a target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JSJC201904002&amp;v=MjYyNDY0VDZqNTRPM3pxcUJ0R0ZyQ1VSTE9lWmVSb0Z5emhWN3JQTHo3QmJiRzRIOWpNcTQ5RlpvUUtESDg0dlI=&amp;uid=WEEvREcwSlJHSldRa1FhcTdWa2FjcW9vRlJTQ2JLUmN2amRwVFpsWThsTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">知网节</a></div>

    <div class="main">

        

    <div class="sidebar-a">
        <!--sidebar start-->
        <div class="sidenav">
            <div class="arrow"><span></span></div>
            <!--sidebar_list start-->
            <dl class="sidenav-list">
                    <dt class="tit">目录结构</dt>
                            <dd class="guide">
                                    <p><a href="#37" data-title="0 概述 ">0 概述</a><i></i></p>
                                                            </dd>
                            <dd class="guide">
                                    <p><a href="#41" data-title="1 背景知识 ">1 背景知识</a><i></i></p>
                                                                    <ul class="contentbox">
                                                <li><a href="#42" data-title="1.1 ARM TrustZone技术">1.1 ARM TrustZone技术</a></li>
                                                <li><a href="#51" data-title="1.2 TOPPERS/FMP内核">1.2 TOPPERS/FMP内核</a></li>
                                    </ul>
                            </dd>
                            <dd class="guide">
                                    <p><a href="#54" data-title="2 相关工作 ">2 相关工作</a><i></i></p>
                                                                    <ul class="contentbox">
                                                <li><a href="#55" data-title="2.1 ARM TrustZone技术的应用">2.1 ARM TrustZone技术的应用</a></li>
                                                <li><a href="#60" data-title="2.2 嵌入式双操作系统现有方案">2.2 嵌入式双操作系统现有方案</a></li>
                                    </ul>
                            </dd>
                            <dd class="guide">
                                    <p><a href="#69" data-title="3 系统架构 ">3 系统架构</a><i></i></p>
                                                                    <ul class="contentbox">
                                                <li><a href="#71" data-title="3.1 整体架构">3.1 整体架构</a></li>
                                                <li><a href="#85" data-title="3.2 调度策略">3.2 调度策略</a></li>
                                    </ul>
                            </dd>
                            <dd class="guide">
                                    <p><a href="#89" data-title="4 系统实现 ">4 系统实现</a><i></i></p>
                                                                    <ul class="contentbox">
                                                <li><a href="#91" data-title="4.1 内存隔离">4.1 内存隔离</a></li>
                                                <li><a href="#93" data-title="4.2 TOPPERS/FMP修改">4.2 TOPPERS/FMP修改</a></li>
                                                <li><a href="#107" data-title="4.3 Linux修改">4.3 Linux修改</a></li>
                                    </ul>
                            </dd>
                            <dd class="guide">
                                    <p><a href="#111" data-title="5 系统实时性评估 ">5 系统实时性评估</a><i></i></p>
                                                                    <ul class="contentbox">
                                                <li><a href="#114" data-title="5.1 任务切换时间">5.1 任务切换时间</a></li>
                                                <li><a href="#124" data-title="5.2 中断响应时间">5.2 中断响应时间</a></li>
                                    </ul>
                            </dd>
                            <dd class="guide">
                                    <p><a href="#133" data-title="6 结束语 ">6 结束语</a><i></i></p>
                                                            </dd>
                            <dd class="guide">
                                    <p><a href="#" data-title="文内图表 ">文内图表</a><i></i></p>
                                                                    <ul class="contentbox">
                                                <li><a href="#48" data-title="&lt;b&gt;图1 ARM TrustZone模型&lt;/b&gt;"><b>图1 ARM TrustZone模型</b></a></li>
                                                <li><a href="#73" data-title="&lt;b&gt;图2 嵌入式双操作系统整体架构&lt;/b&gt;"><b>图2 嵌入式双操作系统整体架构</b></a></li>
                                                <li><a href="#77" data-title="&lt;b&gt;图3 世界切换过程及对中断的响应方式&lt;/b&gt;"><b>图3 世界切换过程及对中断的响应方式</b></a></li>
                                                <li><a href="#87" data-title="&lt;b&gt;图4 系统调度&lt;/b&gt;"><b>图4 系统调度</b></a></li>
                                                <li><a href="#88" data-title="&lt;b&gt;图5 任务全局优先级&lt;/b&gt;"><b>图5 任务全局优先级</b></a></li>
                                                <li><a href="#117" data-title="&lt;b&gt;图6 TOPPERS/FMP任务切换时间代码示例&lt;/b&gt;"><b>图6 TOPPERS/FMP任务切换时间代码示例</b></a></li>
                                                <li><a href="#119" data-title="&lt;b&gt;表1 实时任务切换时间&lt;/b&gt;"><b>表1 实时任务切换时间</b></a></li>
                                                <li><a href="#120" data-title="&lt;b&gt;图7 实时任务切换时间实验数据&lt;/b&gt;"><b>图7 实时任务切换时间实验数据</b></a></li>
                                                <li><a href="#122" data-title="&lt;b&gt;表2 非实时任务切换时间&lt;/b&gt;"><b>表2 非实时任务切换时间</b></a></li>
                                                <li><a href="#123" data-title="&lt;b&gt;图8 非实时任务切换时间实验数据&lt;/b&gt;"><b>图8 非实时任务切换时间实验数据</b></a></li>
                                                <li><a href="#128" data-title="&lt;b&gt;表3 实时任务中断响应时间&lt;/b&gt;"><b>表3 实时任务中断响应时间</b></a></li>
                                                <li><a href="#129" data-title="&lt;b&gt;图9 实时任务中断响应时间实验数据&lt;/b&gt;"><b>图9 实时任务中断响应时间实验数据</b></a></li>
                                                <li><a href="#131" data-title="&lt;b&gt;表4 非实时任务中断响应时间&lt;/b&gt; μs"><b>表4 非实时任务中断响应时间</b> μs</a></li>
                                                <li><a href="#132" data-title="&lt;b&gt;图10 非实时任务中断响应时间实验数据&lt;/b&gt;"><b>图10 非实时任务中断响应时间实验数据</b></a></li>
                                    </ul>
                            </dd>
                                    <dd class="guide">
                                        <h6>
                                            <p><a href="#a_bibliography">参考文献</a> </p>
                                        </h6>
                                    </dd>

            </dl>
        </div>
        <!--sidebar end-->
        &nbsp;
        <!--此处有一空格符 勿删-->
    </div>

                <div class="sidebar-b three-collumn" style="width:0;">
            <div class="refer" style="width: 0;">
                <div class="arrow off" title="参考文献"><span></span></div>
                <div class="js-scrollbox" >
                    
                    <div class="subbox active">
                        <h4>
                            <span class="tit">参考文献</span>
                            <a class="close" href="javascript:void(0)">x</a>
                        </h4>
                        <div class="side-scroller">
                            <ul class="refer-list">
                                <li id="3">


                                    <a id="bibliography_1" title=" MEIER L, HONEGGER D, POLLEFEYS M.PX4:a node-based multithreaded open source robotics framework for deeply embedded platforms[C]//Proceedings of 2015 IEEE International Conference on Robotics and Automation.Washington D.C., USA:IEEE Press, 2015:6235-6240." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=PX4:A node-based multithreaded open source robotics framework for deeply embedded platforms">
                                        <b>[1]</b>
                                         MEIER L, HONEGGER D, POLLEFEYS M.PX4:a node-based multithreaded open source robotics framework for deeply embedded platforms[C]//Proceedings of 2015 IEEE International Conference on Robotics and Automation.Washington D.C., USA:IEEE Press, 2015:6235-6240.
                                    </a>
                                </li>
                                <li id="5">


                                    <a id="bibliography_2" title=" WIKIPEDIA.RT PREEMPT HOWTO[EB/OL].[2017-12-15].https://rt.wiki.kernel.org/index.php/RT_PREEMPT_HOWTO." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=RT PREEMPT HOWTO">
                                        <b>[2]</b>
                                         WIKIPEDIA.RT PREEMPT HOWTO[EB/OL].[2017-12-15].https://rt.wiki.kernel.org/index.php/RT_PREEMPT_HOWTO.
                                    </a>
                                </li>
                                <li id="7">


                                    <a id="bibliography_3" title=" SYSGO.PikeOS hypervisor[EB/OL].[2017-12-15].https://www.sysgo.com/products/pikeos-hypervisor/." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=PikeOS hypervisor">
                                        <b>[3]</b>
                                         SYSGO.PikeOS hypervisor[EB/OL].[2017-12-15].https://www.sysgo.com/products/pikeos-hypervisor/.
                                    </a>
                                </li>
                                <li id="9">


                                    <a id="bibliography_4" title=" HEISER G, LESLIE B.The OKL4 microvisor:convergence point of microkernels and hypervisors[C]//Proceedings of the 1st ACM Asia-Pacific Workshop on Systems.New York, USA:ACM Press, 2010:19-24." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=The OKL4 microvisor:convergence point of microkernels and hypervisors">
                                        <b>[4]</b>
                                         HEISER G, LESLIE B.The OKL4 microvisor:convergence point of microkernels and hypervisors[C]//Proceedings of the 1st ACM Asia-Pacific Workshop on Systems.New York, USA:ACM Press, 2010:19-24.
                                    </a>
                                </li>
                                <li id="11">


                                    <a id="bibliography_5" title=" YODAIKEN V.The RT-Linux approach to hard real-time[EB/OL].[2017-12-15].http://luz.cs.nmt.edu/rtlinux/whitepaper/short." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=The RT-Linux approach to hard real-time">
                                        <b>[5]</b>
                                         YODAIKEN V.The RT-Linux approach to hard real-time[EB/OL].[2017-12-15].http://luz.cs.nmt.edu/rtlinux/whitepaper/short.
                                    </a>
                                </li>
                                <li id="13">


                                    <a id="bibliography_6" title=" RTAI-Lab.RTAI—the realtime application interface for Linux[EB/OL].[2017-12-15].https://www.rtai.org/?Homepage." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=RTAI—the realtime application interface for Linux">
                                        <b>[6]</b>
                                         RTAI-Lab.RTAI—the realtime application interface for Linux[EB/OL].[2017-12-15].https://www.rtai.org/?Homepage.
                                    </a>
                                </li>
                                <li id="15">


                                    <a id="bibliography_7" title=" GERUM P.Xenomai-implementing a RTOS emulation framework on GNU/Linux[EB/OL].[2017-12-15].http://www.cs.ru.nl/lab/xenomai/xenomai_whitepap er.pdf." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Xenomai-implementing a RTOS emulation framework on GNU/Linux">
                                        <b>[7]</b>
                                         GERUM P.Xenomai-implementing a RTOS emulation framework on GNU/Linux[EB/OL].[2017-12-15].http://www.cs.ru.nl/lab/xenomai/xenomai_whitepap er.pdf.
                                    </a>
                                </li>
                                <li id="17">


                                    <a id="bibliography_8" title=" WEI H, HUANG Z, YU Q, et al.RGMP-ROS:a real-time ROS architecture of hybrid RTOS and GPOS on multi-core processor[C]//Proceedings of 2014 IEEE International Conference on Robotics and Automation.Washington D.C., USA:IEEE Press, 2014:2482-2487." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=RGMP-ROS:a real-time ROS architecture of hybrid RTOS and GPOS on multi-core processor">
                                        <b>[8]</b>
                                         WEI H, HUANG Z, YU Q, et al.RGMP-ROS:a real-time ROS architecture of hybrid RTOS and GPOS on multi-core processor[C]//Proceedings of 2014 IEEE International Conference on Robotics and Automation.Washington D.C., USA:IEEE Press, 2014:2482-2487.
                                    </a>
                                </li>
                                <li id="19">


                                    <a id="bibliography_9" title=" ARM.ARM technical white paper:ARM security technology——building a secure system using TrustZone technology[R/OL].[2017-12-15].https://developer.arm.com/docs/genc009492/c." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=ARM technical white paper:ARM security technology——building a secure system using TrustZone technology[R/OL]">
                                        <b>[9]</b>
                                         ARM.ARM technical white paper:ARM security technology——building a secure system using TrustZone technology[R/OL].[2017-12-15].https://developer.arm.com/docs/genc009492/c.
                                    </a>
                                </li>
                                <li id="21">


                                    <a id="bibliography_10" title=" TOMIYAMA H, HONDA S, TAKADA H.Real-time operating systems for multicore embedded systems[C]//Proceedings of ISOCC’08.Washington D.C., USA:IEEE Press, 2008:62-67." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Real-time operating systems for multicore embedded systems">
                                        <b>[10]</b>
                                         TOMIYAMA H, HONDA S, TAKADA H.Real-time operating systems for multicore embedded systems[C]//Proceedings of ISOCC’08.Washington D.C., USA:IEEE Press, 2008:62-67.
                                    </a>
                                </li>
                                <li id="23">


                                    <a id="bibliography_11" title=" LARRY M, CARL S.LMbench-tools for performance analysis[EB/OL].[2017-12-15].http://www.bitmover.com/lmbench/." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=LMbench-tools for performance analysis">
                                        <b>[11]</b>
                                         LARRY M, CARL S.LMbench-tools for performance analysis[EB/OL].[2017-12-15].http://www.bitmover.com/lmbench/.
                                    </a>
                                </li>
                                <li id="25">


                                    <a id="bibliography_12" title=" The Linux Foundation.RT-tests[EB/OL].[2017-12-15].https://wiki.linuxfoundation.org/realtime/documentation/ howto/tools/rt-tests#compile-and-install." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=RT-tests">
                                        <b>[12]</b>
                                         The Linux Foundation.RT-tests[EB/OL].[2017-12-15].https://wiki.linuxfoundation.org/realtime/documentation/ howto/tools/rt-tests#compile-and-install.
                                    </a>
                                </li>
                                <li id="27">


                                    <a id="bibliography_13" title=" OP-TEE.Open portable trusted execution environment[EB/OL].[2017-12-15].https://www.op-tee.org/." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Open portable trusted execution environment">
                                        <b>[13]</b>
                                         OP-TEE.Open portable trusted execution environment[EB/OL].[2017-12-15].https://www.op-tee.org/.
                                    </a>
                                </li>
                                <li id="29">


                                    <a id="bibliography_14" title=" ANDREAS F.Development of an ARM TrustZone aware operating system ANDIX OS[D].Graz, Austria:Graz University of Technology, 2014." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Development of an ARM TrustZone aware operating system ANDIX OS">
                                        <b>[14]</b>
                                         ANDREAS F.Development of an ARM TrustZone aware operating system ANDIX OS[D].Graz, Austria:Graz University of Technology, 2014.
                                    </a>
                                </li>
                                <li id="31">


                                    <a id="bibliography_15" title=" SANGORRIN D, HONDA S, TAKADA H.Dual operating system architecture for real-time embedded systems[C]//Proceedings of the 6th International Workshop on Operating Systems Platforms for Embedded Real-Time Applications.Washington D.C., USA:IEEE Press, 2010:6-15." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Dual ope-rating system architecture for real-time embedded systems">
                                        <b>[15]</b>
                                         SANGORRIN D, HONDA S, TAKADA H.Dual operating system architecture for real-time embedded systems[C]//Proceedings of the 6th International Workshop on Operating Systems Platforms for Embedded Real-Time Applications.Washington D.C., USA:IEEE Press, 2010:6-15.
                                    </a>
                                </li>
                                <li id="33">


                                    <a id="bibliography_16" title=" 董艳雪, 韩卫光.基于多核 ARM 的 Linux 操作系统的实时性研究[J].小型微型计算机系统, 2017, 38 (6) :1262-1266." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=XXWX201706017&amp;v=MzEzMTN5emhWN3JQUFRYY2RyRzRIOWJNcVk5RVk0UUtESDg0dlI0VDZqNTRPM3pxcUJ0R0ZyQ1VSTE9lWmVSb0Y=&amp;uid=WEEvREcwSlJHSldRa1FhcTdWa2FjcW9vRlJTQ2JLUmN2amRwVFpsWThsTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[16]</b>
                                         董艳雪, 韩卫光.基于多核 ARM 的 Linux 操作系统的实时性研究[J].小型微型计算机系统, 2017, 38 (6) :1262-1266.
                                    </a>
                                </li>
                                <li id="35">


                                    <a id="bibliography_17" title=" 王蕾, 朴希望, 李世群, 等.嵌入式实时操作系统的时间性能测试[J].内蒙古大学学报 (自然科学版) , 2011, 42 (5) :547-551." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=NMGX201105010&amp;v=MTQ1MDNVUkxPZVplUm9GeXpoVjdyUEt5RE1kckc0SDlETXFvOUVaSVFLREg4NHZSNFQ2ajU0TzN6cXFCdEdGckM=&amp;uid=WEEvREcwSlJHSldRa1FhcTdWa2FjcW9vRlJTQ2JLUmN2amRwVFpsWThsTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[17]</b>
                                         王蕾, 朴希望, 李世群, 等.嵌入式实时操作系统的时间性能测试[J].内蒙古大学学报 (自然科学版) , 2011, 42 (5) :547-551.
                                    </a>
                                </li>
                            </ul>
                            <div style='display: none;' class="zqscroller" >
                                <h4 class="">附加材料</h4>
                                <ul></ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            &nbsp;
            <!--此处有一空格符 勿删-->
        </div>

        
    <div class="content">



        <!--tips start-->
                            <div class="tips">
                    <a href="http://navi.cnki.net/KNavi/JournalDetail?pcode=CJFD&amp;pykm=JSJC" target="_blank">计算机工程</a>
                2019,45(04),6-12 DOI:10.19678/j.issn.1000-3428.0050084            </div>
        <!--tips end-->
            <div class="top-title">
                <h1 class="title">
                    <span class="vm"><b>基于可信执行环境的嵌入式双操作系统架构研究</b></span>
 <span class="shoufa"></span>                                     </h1>

            </div>
                        <h2>
                                <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=au&amp;skey=%E5%AD%9F%E5%AD%90%E7%90%AA&amp;code=38854235&amp;uid=WEEvREcwSlJHSldRa1FhcTdWa2FjcW9vRlJTQ2JLUmN2amRwVFpsWThsTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">孟子琪</a>
                                <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=au&amp;skey=%E5%BC%A0%E5%80%A9%E9%A2%96&amp;code=33407365&amp;uid=WEEvREcwSlJHSldRa1FhcTdWa2FjcW9vRlJTQ2JLUmN2amRwVFpsWThsTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">张倩颖</a>
                                <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=au&amp;skey=%E6%96%BD%E6%99%BA%E5%B9%B3&amp;code=27562939&amp;uid=WEEvREcwSlJHSldRa1FhcTdWa2FjcW9vRlJTQ2JLUmN2amRwVFpsWThsTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">施智平</a>
                                <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=au&amp;skey=%E5%85%B3%E6%B0%B8&amp;code=08710923&amp;uid=WEEvREcwSlJHSldRa1FhcTdWa2FjcW9vRlJTQ2JLUmN2amRwVFpsWThsTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">关永</a>
                </h2>
                    <h2>
                    <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=in&amp;skey=%E9%A6%96%E9%83%BD%E5%B8%88%E8%8C%83%E5%A4%A7%E5%AD%A6%E4%BF%A1%E6%81%AF%E5%B7%A5%E7%A8%8B%E5%AD%A6%E9%99%A2&amp;code=0044636&amp;uid=WEEvREcwSlJHSldRa1FhcTdWa2FjcW9vRlJTQ2JLUmN2amRwVFpsWThsTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">首都师范大学信息工程学院</a>
                    <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=in&amp;skey=%E5%8C%97%E4%BA%AC%E6%88%90%E5%83%8F%E7%90%86%E8%AE%BA%E4%B8%8E%E6%8A%80%E6%9C%AF%E9%AB%98%E7%B2%BE%E5%B0%96%E5%88%9B%E6%96%B0%E4%B8%AD%E5%BF%83&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhcTdWa2FjcW9vRlJTQ2JLUmN2amRwVFpsWThsTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">北京成像理论与技术高精尖创新中心</a>
                    <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=in&amp;skey=%E8%BD%BB%E5%9E%8B%E5%B7%A5%E4%B8%9A%E6%9C%BA%E5%99%A8%E4%BA%BA%E4%B8%8E%E5%AE%89%E5%85%A8%E9%AA%8C%E8%AF%81%E5%8C%97%E4%BA%AC%E5%B8%82%E9%87%8D%E7%82%B9%E5%AE%9E%E9%AA%8C%E5%AE%A4&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhcTdWa2FjcW9vRlJTQ2JLUmN2amRwVFpsWThsTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">轻型工业机器人与安全验证北京市重点实验室</a>
                    <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=in&amp;skey=%E7%94%B5%E5%AD%90%E7%B3%BB%E7%BB%9F%E5%8F%AF%E9%9D%A0%E6%80%A7%E6%8A%80%E6%9C%AF%E5%8C%97%E4%BA%AC%E5%B8%82%E9%87%8D%E7%82%B9%E5%AE%9E%E9%AA%8C%E5%AE%A4&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhcTdWa2FjcW9vRlJTQ2JLUmN2amRwVFpsWThsTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">电子系统可靠性技术北京市重点实验室</a>
            </h2>

        
<div class="link">
    <a id="aexport" class="icon icon-output"  onclick="" href="javascript:void(0);"><i></i>导出/参考文献</a>
    
    <span class="shareBoard" onmouseover="$('#sharedet').show();$('#this').addClass('shareBoardCUR')" onmouseout="$('#sharedet').hide();$('#this').removeClass('shareBoardCUR')">
        <a class="icon icon-share" href="#"><i></i>分享<em></em></a>
        <ul class="shareHide" id="sharedet" style="display: none;">
            <li><a title="复制链接" class="copy" onclick="" href="#"><i></i>复制链接</a></li>
            <li><a title="分享到新浪微博" class="xl" onclick="" href="javascript:common.ShareAction('xl');"><i></i>新浪微博</a></li>
            <li>
                <a title="分享到微信" class="wx" onclick="" href="#"><i></i>微信扫一扫</a>
                <div class="qrcode"><img src='' alt='' /></div>
            </li>
        </ul>

    </span>
    
    <a id="RefTrack" title="创建引文跟踪" class="icon icon-track" onclick="" href="javascript:void(0);"> <i></i>创建引文跟踪 </a>
    <a id="ashoucang" title="收藏" class="icon icon-favor" onclick="" href="javascript:void(0);"><i></i>收藏</a>
    <a class="icon icon-print" onclick="window.print();" href="javascript:void(0);"><i></i>打印</a>
    
    <!--版本切换 end-->
</div>
                            <div class="data" id="a_abstract">
                <span class="keys">摘<span style="font-family: 'Times New Roman';">&nbsp;&nbsp;&nbsp;&nbsp;</span>要：</span>
                <p>针对嵌入式系统对功能性与实时性的需求, 提出一种双操作系统架构。基于ARM TrustZone提供的可信执行环境, 构建双操作系统架构, 实现通用操作系统 (GPOS) 与实时操作系统 (RTOS) 同时运行。将嵌入式系统中的任务划分为实时任务与非实时任务, 使实时任务在RTOS中运行, 非实时任务在GPOS中运行。在物理开发板上实现原型系统, 并使用实时性测试工具对该系统进行性能评估。结果表明, 该架构在提供GPOS功能性的基础上, 保证了系统的实时性。</p>
            </div>
                    <div class="data" id="a_keywords">
                <span class="keys">关键词：</span>
                <p>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=ARM%20TrustZone%E6%8A%80%E6%9C%AF&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhcTdWa2FjcW9vRlJTQ2JLUmN2amRwVFpsWThsTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">ARM TrustZone技术;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=%E5%8F%AF%E4%BF%A1%E6%89%A7%E8%A1%8C%E7%8E%AF%E5%A2%83&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhcTdWa2FjcW9vRlJTQ2JLUmN2amRwVFpsWThsTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">可信执行环境;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=%E5%8F%8C%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhcTdWa2FjcW9vRlJTQ2JLUmN2amRwVFpsWThsTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">双操作系统;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=%E5%B5%8C%E5%85%A5%E5%BC%8F%E7%B3%BB%E7%BB%9F&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhcTdWa2FjcW9vRlJTQ2JLUmN2amRwVFpsWThsTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">嵌入式系统;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=%E5%AE%9E%E6%97%B6%E6%80%A7&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhcTdWa2FjcW9vRlJTQ2JLUmN2amRwVFpsWThsTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">实时性;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=%E5%8A%9F%E8%83%BD%E6%80%A7&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhcTdWa2FjcW9vRlJTQ2JLUmN2amRwVFpsWThsTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">功能性;</a>
                </p>
            </div>
        
        <!--brief start-->
        
            <div class="brief">
                    <p>
                            <b>作者简介：</b>
                                                        <span>
                                    孟子琪 (1991—) , 女, 硕士研究生, 主研方向为实时操作系统;;
                                </span>
                                <span>
                                    *张倩颖 (通信作者) , 讲师, E-mail:qyzhang@cnu.edu.cn;;
                                </span>
                                <span>
                                    施智平, 教授;;
                                </span>
                                <span>
                                    关永, 教授、博士生导师。;
                                </span>
                    </p>
                                    <p><b>收稿日期：</b>2018-01-12</p>

                    <p>

                            <b>基金：</b>
                                                        <span>国家重点研发计划 (2017YFB1301100);</span>
                                <span>国家自然科学基金 (61602325, 61802375, 61876111, 61877040);</span>
                                <span>北京市教委科技计划一般项目 (KM20190028005);</span>
                    </p>
            </div>
                    <h1><b>Research on Embedded Dual Operating System Architecture Based on Trusted Execution Environment</b></h1>
                    <h2>
                    <span>MENG Ziqi</span>
                    <span>ZHANG Qianying</span>
                    <span>SHI Zhiping</span>
                    <span>GUAN Yong</span>
            </h2>
                    <h2>
                    <span>College of Information Engineering, Capital Normal University</span>
                    <span>Beijing Advanced Innovation Center for Imaging Theory and Technology</span>
                    <span>Beijing Key Laboratory of Light Industrial Robot and Safety Verification</span>
                    <span>Beijing Key Laboratory of Electronic System Reliability Technology</span>
            </h2>
                            <div class="data" id="a_abstractEN">
                <span class="keys">Abstract：</span>
                <p>To address the requirements of the embedded systems for functionality and real-time performance, this paper presents a dual operating system architecture.Based on the trusted execution environment provided by ARM TrustZone, the dual operating system architecture is built to run the General Purpose Operating System (GPOS) and the Real-time Operating System (RTOS) on the same platform.The tasks in the embedded system are divided into real-time tasks and non-real-time tasks.Real-time tasks run on the RTOS and non-real-time tasks run on the GPOS.Finally, a prototype system is implemented on a physical development board and the performance of the system is evaluated using real-time test tools.Experimental results show that the proposed architecture guarantees not only the functionality of GPOS but also the real-time performance of the system.</p>
            </div>
                    <div class="data" id="a_keywordsEN">
                <span class="keys">Keyword：</span>
                <p>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=ARM%20TrustZone%20technology&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhcTdWa2FjcW9vRlJTQ2JLUmN2amRwVFpsWThsTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">ARM TrustZone technology;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=trusted%20execution%20environment&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhcTdWa2FjcW9vRlJTQ2JLUmN2amRwVFpsWThsTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">trusted execution environment;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=dual%20operating%20system&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhcTdWa2FjcW9vRlJTQ2JLUmN2amRwVFpsWThsTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">dual operating system;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=embedded%20system&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhcTdWa2FjcW9vRlJTQ2JLUmN2amRwVFpsWThsTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">embedded system;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=real-time%20performance&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhcTdWa2FjcW9vRlJTQ2JLUmN2amRwVFpsWThsTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">real-time performance;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=functionality&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhcTdWa2FjcW9vRlJTQ2JLUmN2amRwVFpsWThsTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">functionality;</a>
                </p>
            </div>
                    <div class="brief">
                
                    <p>
                                            </p>
                                    <p><b>Received：</b> 2018-01-12</p>
                                    <p>
                                            </p>
            </div>


        <!--brief start-->
                        <h3 id="37" name="37" class="anchor-tag">0 概述</h3>
                <div class="p1">
                    <p id="38">随着科学技术的发展, 嵌入式系统在工业、农业、军事、服务业等领域的应用越来越广泛。在以智能制造和物联网为主导的“工业4.0”被提出后, 各领域对嵌入式系统也有了更高的要求。在无人驾驶汽车中, 车载系统需要实时处理汽车中各传感器产生的数据, 保证汽车正常运行, 同时也需要为车内的乘客提供如车载多媒体等娱乐服务。在智能家居中, 嵌入式系统需要对住宅环境进行实时监测并对接收到的数据进行处理, 也需要为家庭成员提供如网络通信等丰富的功能。从上述应用场景可知, 以实时性为主要目标的传统嵌入式系统已无法满足新的需求。</p>
                </div>
                <div class="p1">
                    <p id="39">为了使嵌入式系统在具有丰富功能的同时保证实时性, 学术界和产业界提出3类不同的解决方法。第1类方法是在嵌入式实时操作系统 (Real-time Operating System, RTOS) 中开发丰富的应用<citation id="135" type="reference"><link href="3" rel="bibliography" /><sup>[<a class="sup">1</a>]</sup></citation>。这类系统规模较小, 支持的功能有限, 并且由于多数嵌入式RTOS具有自己的结构, 需要针对其结构开发特定的应用, 应用的可移植性较差。第2类方法是修改通用操作系统 (General Purpose Operating System, GPOS) 内核<citation id="136" type="reference"><link href="5" rel="bibliography" /><sup>[<a class="sup">2</a>]</sup></citation>, 使其具备实时性。该方法实现的实时性为软实时。第3类方法是构建双操作系统架构。双操作系统架构的实现主要有3种方式。第1种方式是在单处理器下, 在操作系统与硬件之间建立虚拟中间件运行RTOS与GPOS<citation id="138" type="reference"><link href="7" rel="bibliography" /><link href="9" rel="bibliography" /><sup>[<a class="sup">3</a>,<a class="sup">4</a>]</sup></citation>。该方式由于引入虚拟中间件而产生开销, 影响系统实时性。第2种方式是混合操作系统<citation id="139" type="reference"><link href="11" rel="bibliography" /><link href="13" rel="bibliography" /><link href="15" rel="bibliography" /><sup>[<a class="sup">5</a>,<a class="sup">6</a>,<a class="sup">7</a>]</sup></citation>, 将GPOS当做RTOS的一个进程。然而当RTOS负载较重时, GPOS可分得的CPU时间较短, 混合系统的功能性降低。第3种方式是基于多核处理器构建双操作系统<citation id="137" type="reference"><link href="17" rel="bibliography" /><sup>[<a class="sup">8</a>]</sup></citation>, 其实现需要多核处理器甚至多个硬件处理器芯片来支持, 硬件成本较高。</p>
                </div>
                <div class="p1">
                    <p id="40">为确保嵌入式系统同时具有实时性与功能性, 本文提出基于可信执行环境的嵌入式双操作系统架构。该架构在单一硬件平台上同时运行GPOS和RTOS。根据任务对实时性的要求, 任务被划分为非实时任务与实时任务。GPOS处理各类功能性的非实时任务, RTOS则处理实时任务。利用ARM TrustZone技术<citation id="140" type="reference"><link href="19" rel="bibliography" /><sup>[<a class="sup">9</a>]</sup></citation>实现硬件隔离, 使得该架构不受处理器核心数量的约束。本文基于ARM TrustZone技术完成GPOS与RTOS运行环境的隔离, GPOS选择Linux, RTOS选择TOPPERS/FMP<citation id="141" type="reference"><link href="21" rel="bibliography" /><sup>[<a class="sup">10</a>]</sup></citation>, 在物理开发板上实现了本文架构, 并使用LMbench<citation id="142" type="reference"><link href="23" rel="bibliography" /><sup>[<a class="sup">11</a>]</sup></citation>和RT-Tests<citation id="143" type="reference"><link href="25" rel="bibliography" /><sup>[<a class="sup">12</a>]</sup></citation>等实时性测试工具对系统进行测试。</p>
                </div>
                <h3 id="41" name="41" class="anchor-tag">1 背景知识</h3>
                <h4 class="anchor-tag" id="42" name="42">1.1 ARM TrustZone技术</h4>
                <div class="p1">
                    <p id="43">ARM TrustZone技术是高端ARM嵌入式处理器的一组安全硬件扩展机制, 被集成在芯片上, 不需要再附加其他安全硬件设备, 为处理器、系统总线以及系统外设提供安全支持。</p>
                </div>
                <h4 class="anchor-tag" id="44" name="44">1.1.1 虚拟处理器</h4>
                <div class="p1">
                    <p id="45">ARM TrustZone技术将1个物理处理器划分为2个虚拟处理器, 一个作为安全世界, 另一个作为普通世界。同时, 它将硬件与软件资源都分离为2个部分, 使其分属于2个世界中的1个。安全世界中的组件可以访问全部资源, 而普通世界中的组件只能访问普通世界的资源。</p>
                </div>
                <h4 class="anchor-tag" id="46" name="46">1.1.2 监视器模式</h4>
                <div class="p1">
                    <p id="47">ARM TrustZone技术在ARM处理器原有的7种工作模式基础上增加了1种模式, 称为监视器模式, 用于实现安全世界与普通世界之间的切换。进入监视器模式的方式有多种, 包括以软件的方式利用SMC (Secure Monitor Call) 指令进入监视器模式和通过硬件异常机制进入, 例如IRQ (Interrupt Request) 、FIQ (Fast Interrupt Request) 、外部数据异常以及外部预取异常等。运行于监视器模式下的监视器负责保存当前世界的上下文, 并载入另一个世界的上下文。ARM TrustZone技术的简要模型如图1所示。</p>
                </div>
                <div class="area_img" id="48">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JSJC201904002_048.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdWa2FjcW9vRlJTQ2JLUmN2amRwVFpsWThsTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图1 ARM TrustZone模型" src="Detail/GetImg?filename=images/JSJC201904002_048.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdWa2FjcW9vRlJTQ2JLUmN2amRwVFpsWThsTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit"><b>图1 ARM TrustZone模型</b>  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JSJC201904002_048.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdWa2FjcW9vRlJTQ2JLUmN2amRwVFpsWThsTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <h4 class="anchor-tag" id="49" name="49">1.1.3 中断</h4>
                <div class="p1">
                    <p id="50">ARM TrustZone允许IRQ和FIQ等硬件中断在监视器模式下被处理。ARM推荐将IRQ作为普通世界的中断源, 将FIQ作为安全世界的中断源。这是因为大多数的操作系统都将IRQ作为中断源使用, 所以将FIQ用作安全世界的中断源可以最大程度地减少对已有软件的修改。当中断到来时, 如果处理器正运行在相应的世界, 则不会进入监视器模式, 中断在当前世界得到响应;如果处理器运行在另一个世界, 则会先进入到监视器模式, 在执行完上下文切换后跳转到对应的世界响应中断。</p>
                </div>
                <h4 class="anchor-tag" id="51" name="51">1.2 TOPPERS/FMP内核</h4>
                <div class="p1">
                    <p id="52">TOPPERS/FMP是日本TOPPERS项目组开发的一款遵循μITRON规范的RTOS内核, 是TOPPERS/ASP内核针对多核处理器的扩展, 主要用于对称性多核处理器系统, 所有核心共用同一个内核镜像。</p>
                </div>
                <div class="p1">
                    <p id="53">在TOPPERS/FMP中, 诸如任务等内核对象到处理器的分配被静态定义。属于同一个处理器的一组内核对象被称为类, 每个类具有对应的ID号, 在调用内核对象时使用。TOPPERS/FMP内核基于优先级抢占原则进行任务调度, 每个处理器独立调度分配在该处理器上的任务。为了保证TOPPERS/FMP的强实时性, 被静态分配的任务不会自动在处理器间进行迁移。但是TOPPERS/FMP为开发者提供了一组用于实现动态任务迁移的系统调用API, 开发者可以根据自己的需求, 设计合理的算法来实现处理器负载均衡。</p>
                </div>
                <h3 id="54" name="54" class="anchor-tag">2 相关工作</h3>
                <h4 class="anchor-tag" id="55" name="55">2.1 ARM TrustZone技术的应用</h4>
                <div class="p1">
                    <p id="56">意法半导体与Linaro公司合作开发了一款基于ARM TrustZone的可信执行环境OP-TEE<citation id="144" type="reference"><link href="27" rel="bibliography" /><sup>[<a class="sup">13</a>]</sup></citation>, 其包含3个部分:普通世界用户空间的客户端, Linux内核TEE设备驱动, 安全世界的可信操作系统。OP-TEE为开源项目, 支持标准接口, 为研究机构进行安全应用研究提供便利。</p>
                </div>
                <div class="p1">
                    <p id="57">奥地利格拉茨技术大学开发了一款基于ARM TrustZone的开源操作系统ANSIX OS<citation id="145" type="reference"><link href="29" rel="bibliography" /><sup>[<a class="sup">14</a>]</sup></citation>。ANSIX OS在安全世界中运行, 普通世界可以运行Linux或者Android。ANSIX OS为可信应用程序提供了可信执行环境, 使得可信应用程序的资源不会受到来自普通世界的攻击, 安全世界与普通世界利用远程过程调用机制进行通信。</p>
                </div>
                <div class="p1">
                    <p id="58">日本名古屋大学开发了一款可靠双操作系统SafeG<citation id="146" type="reference"><link href="31" rel="bibliography" /><sup>[<a class="sup">15</a>]</sup></citation>。利用ARM TrustZone技术, SafeG实现了RTOS与GPOS在单核处理器上并行运行, 并且能够保证RTOS的内存不会受到GPOS的攻击。同时, 由于ARM TrustZone技术的支持, SafeG中的RTOS能够保证任务的硬实时性。</p>
                </div>
                <div class="p1">
                    <p id="59">目前, ARM TrustZone技术主要被应用于实现和改善系统的安全性, 较少用于提高系统的实时性能。</p>
                </div>
                <h4 class="anchor-tag" id="60" name="60">2.2 嵌入式双操作系统现有方案</h4>
                <h4 class="anchor-tag" id="61" name="61">2.2.1 虚拟化技术</h4>
                <div class="p1">
                    <p id="62">德国SYSGO AG公司开发的PikeOS<citation id="147" type="reference"><link href="7" rel="bibliography" /><sup>[<a class="sup">3</a>]</sup></citation>利用一个分离内核实现了对上级访客环境的隔离。该虚拟机允许在同一个平台上使用各种虚拟环境, 并且能更新新的应用程序。Open Kernel Labs开发了开源的OKL4 microvisor<citation id="148" type="reference"><link href="9" rel="bibliography" /><sup>[<a class="sup">4</a>]</sup></citation>, 利用安全超分区技术, 将操作系统、设备驱动等分配在分区中, 而OKL4 microvisor运行在操作系统原本运行的特权内核空间。Motorola Evoke QA4手机利用OKL4 microvisor实现了虚拟化和2个并发运行的操作系统。</p>
                </div>
                <div class="p1">
                    <p id="63">基于虚拟化技术实现的双操作系统, 由于虚拟机引入了开销, 影响了系统的实时性能。</p>
                </div>
                <h4 class="anchor-tag" id="64" name="64">2.2.2 混合操作系统</h4>
                <div class="p1">
                    <p id="65">美国墨西哥理工学院开发了RT-Linux<citation id="149" type="reference"><link href="11" rel="bibliography" /><sup>[<a class="sup">5</a>]</sup></citation>。RT-Linux在硬件层与标准Linux之间增加了一个实时内核, 在实时内核中有一个固定优先级的调度器, 将标准Linux作为一个实时任务进行调度。意大利米兰理工学院在RT-Linux的基础上开发了RTAI<citation id="150" type="reference"><link href="13" rel="bibliography" /><sup>[<a class="sup">6</a>]</sup></citation>。RTAI在标准Linux上定义了实时硬件抽象层, 该抽象层将RTAI需要在Linux中修改的部分定义成一组程序界面, 而RTAI利用该界面与Linux通信。由Philippe Gerum发起的Xenomai<citation id="151" type="reference"><link href="15" rel="bibliography" /><sup>[<a class="sup">7</a>]</sup></citation>项目是一个为标准Linux添加实时支持的软件框架。在Xenomai中, 运行一个实时内核, 并将修改过的Linux任务作为该实时内核的空闲任务进行调度。</p>
                </div>
                <div class="p1">
                    <p id="66">混合操作系统实现的双操作系统架构, 由于GPOS只有在RTOS空闲时才会被调用, 因此当RTOS中实时任务负载较重时, GPOS分得的CPU时间较短, 对系统的功能性有较大的影响。</p>
                </div>
                <h4 class="anchor-tag" id="67" name="67">2.2.3 多核技术</h4>
                <div class="p1">
                    <p id="68">北京航天航空大学模块化机器人研究所提出了一套基于多核处理器架构的双操作系统软件框架RGMP (RTOS and GPOS on Multi-Processor) <citation id="152" type="reference"><link href="17" rel="bibliography" /><sup>[<a class="sup">8</a>]</sup></citation>。该框架将Linux作为GPOS平台, 在Linux启动后, 放弃对其中一个核心的控制权, 使该核心用于运行RTOS。RTOS和GPOS分别占有着各自的CPU, 彼此相互独立。用户可以在正常使用Linux的几乎所有功能的同时, 利用RTOS完成实时任务。RGMP充分利用SMP体系架构计算机的中断路由机制, 将来自不同设备的中断根据具体的需要分配到相应的CPU, 然后交由各自的操作系统进行管理。2个操作系统之间通过共享内存的方式进行数据交互。然而, 实现多核混合操作系统架构, 需要具有多个核心的硬件平台为其作支持。并且, 该架构的核心控制权由GPOS掌握, 当GPOS受到攻击者控制, 无法放弃需要运行RTOS的核心时, 会严重影响系统的实时性。</p>
                </div>
                <h3 id="69" name="69" class="anchor-tag">3 系统架构</h3>
                <div class="p1">
                    <p id="70">本文提出基于可信执行环境的嵌入式双操作系统架构, 将实时任务与非实时任务分别运行于RTOS与GPOS中。通过对硬件资源进行分配, 使得GPOS无法访问RTOS的专属资源, 保证了运行在RTOS中的实时任务不会受到来自GPOS的攻击。利用FIQ与IRQ 2种中断, 实现了由RTOS掌握系统控制权, 从而保证实时任务的实时响应。</p>
                </div>
                <h4 class="anchor-tag" id="71" name="71">3.1 整体架构</h4>
                <div class="p1">
                    <p id="72">基于可信执行环境的嵌入式双操作系统架构如图2所示。</p>
                </div>
                <div class="area_img" id="73">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JSJC201904002_073.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdWa2FjcW9vRlJTQ2JLUmN2amRwVFpsWThsTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图2 嵌入式双操作系统整体架构" src="Detail/GetImg?filename=images/JSJC201904002_073.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdWa2FjcW9vRlJTQ2JLUmN2amRwVFpsWThsTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit"><b>图2 嵌入式双操作系统整体架构</b>  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JSJC201904002_073.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdWa2FjcW9vRlJTQ2JLUmN2amRwVFpsWThsTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="p1">
                    <p id="74">根据任务对实时性的要求, 将运行在该架构上的任务分为2种:非实时任务与实时任务。非实时任务由GPOS进行处理, 而实时任务分配给RTOS进行处理。GPOS运行在普通世界中, RTOS和监视器在安全世界中运行。监视器运行在监视器模式下, 负责2个世界之间的切换, 并处理CPU硬件中断。该架构利用ARM TrustZone技术, 实现了RTOS与GPOS的并行运行。</p>
                </div>
                <div class="p1">
                    <p id="75">监视器加载结束后, 会在初始化阶段对内存、外设等资源进行分配。与系统可靠性、实时性相关的设备会被分配给运行在安全世界中的RTOS, 同时会将一块内存作为安全内存划分给RTOS, 用于存储RTOS中的数据, 这些资源只能由RTOS访问。如果GPOS访问这些资源, 则会引起异常, 从而可以防止RTOS的地址空间受到GPOS中潜在的恶意攻击。剩余的资源则由RTOS与GPOS共享, 即RTOS与GPOS都可以对这部分资源进行访问。由于TrustZone保护控制器可以在运行时进行动态设置, 因此被GPOS与RTOS共享的外设的安全特性是变化的。例如, 键盘在输入密码时被动态配置为安全设备, 只能由RTOS进行访问, 而平时被配置为非安全的输入设备。</p>
                </div>
                <div class="p1">
                    <p id="76">RTOS需要拥有系统的控制权。当实时任务需要运行时, 应该立刻恢复RTOS的运行状态, 保证实时任务的实时性。由RTOS对系统进行控制, 可以有效地防止GPOS被篡改后, 一直占用CPU导致RTOS无法运行, 从而使实时任务错过截止时间, 产生严重后果。利用ARM处理器中的FIQ和IRQ 2种中断可以实现RTOS对系统的控制。通过配置中断控制器GIC, 将属于安全世界的RTOS的设备产生的中断配置为FIQ, 将属于普通世界的GPOS的设备产生的中断配置为IRQ。当RTOS运行时, 设置IRQ为被屏蔽状态。若此时产生IRQ, GPOS不能对IRQ进行处理, 从而不会中断RTOS正在运行的任务, 这使得RTOS中任务的实时性得到保证。而在GPOS运行时, 设置FIQ为开启状态。此时若产生FIQ, 则会中断GPOS正在运行的任务, 通过监视器切换到RTOS, 恢复RTOS对处理器的控制, 对FIQ进行处理, 进入相应的中断处理程序, 从而保证RTOS中实时任务的实时性。世界切换过程与对中断的响应方式如图3所示。</p>
                </div>
                <div class="area_img" id="77">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JSJC201904002_077.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdWa2FjcW9vRlJTQ2JLUmN2amRwVFpsWThsTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图3 世界切换过程及对中断的响应方式" src="Detail/GetImg?filename=images/JSJC201904002_077.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdWa2FjcW9vRlJTQ2JLUmN2amRwVFpsWThsTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit"><b>图3 世界切换过程及对中断的响应方式</b>  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JSJC201904002_077.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdWa2FjcW9vRlJTQ2JLUmN2amRwVFpsWThsTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="p1">
                    <p id="78">当处于安全世界的RTOS运行时, 有3种情况可能发生:</p>
                </div>
                <div class="p1">
                    <p id="79">1) IRQ中断。由于安全世界屏蔽了IRQ, 因此GPOS不会响应该中断。</p>
                </div>
                <div class="p1">
                    <p id="80">2) FIQ中断。由于此时RTOS正在运行, 因此直接响应该中断, 调用相关中断处理程序进行处理, 不需要进行世界切换。</p>
                </div>
                <div class="p1">
                    <p id="81">3) 当在RTOS中的实时任务运行完成后, 就会运行优先级最低的SMC任务, 执行SMC调用, 进行世界切换, 由GPOS对其任务进行处理。</p>
                </div>
                <div class="p1">
                    <p id="82">当处于普通世界的GPOS运行时, 有2种情况可能发生:</p>
                </div>
                <div class="p1">
                    <p id="83">1) IRQ中断。由于此时GPOS正在运行, 因此可以响应IRQ中断。GPOS对该中断进行处理, 不需要进行世界切换。</p>
                </div>
                <div class="p1">
                    <p id="84">2) FIQ中断。由于此时GPOS处于运行状态, 当FIQ中断到来时, 会中断在GPOS中的任务, 进入监视器模式, 运行在监视器模式下的监视器会保存GPOS的上下文, 恢复RTOS的上下文, 并切换到RTOS使其继续运行。当RTOS恢复运行后, 对FIQ进行处理, 执行对应的中断处理程序。</p>
                </div>
                <h4 class="anchor-tag" id="85" name="85">3.2 调度策略</h4>
                <div class="p1">
                    <p id="86">系统整体使用基于优先级的调度策略。如图4所示, 将RTOS的调度器作为系统的调度器, 由RTOS负责整个系统的调度。在该系统架构中, 把GPOS整体作为RTOS的一个任务进行调度, 称该任务为SMC任务。该任务的优先级最低, 即只有在RTOS中没有实时任务运行的情况下, 才会运行该任务, 从而保证RTOS中任务的实时性。该任务通过调用SMC指令使系统进入监视器模式, 将CPU上下文切换为GPOS, 使得GPOS恢复运行。在GPOS中的任务按照GPOS原有的调度策略对其进行调度, RTOS不负责对这些任务进行调度。系统任务全局优先级设置如图5所示。</p>
                </div>
                <div class="area_img" id="87">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JSJC201904002_087.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdWa2FjcW9vRlJTQ2JLUmN2amRwVFpsWThsTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图4 系统调度" src="Detail/GetImg?filename=images/JSJC201904002_087.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdWa2FjcW9vRlJTQ2JLUmN2amRwVFpsWThsTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit"><b>图4 系统调度</b>  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JSJC201904002_087.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdWa2FjcW9vRlJTQ2JLUmN2amRwVFpsWThsTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="area_img" id="88">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JSJC201904002_088.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdWa2FjcW9vRlJTQ2JLUmN2amRwVFpsWThsTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图5 任务全局优先级" src="Detail/GetImg?filename=images/JSJC201904002_088.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdWa2FjcW9vRlJTQ2JLUmN2amRwVFpsWThsTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit"><b>图5 任务全局优先级</b>  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JSJC201904002_088.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdWa2FjcW9vRlJTQ2JLUmN2amRwVFpsWThsTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <h3 id="89" name="89" class="anchor-tag">4 系统实现</h3>
                <div class="p1">
                    <p id="90">本文架构选用TOPPERS/FMP作为RTOS, Linux作为GPOS。物理硬件平台选用支持ARM TrustZone的Freescale i.MX6Quad SABRE开发板, 在该开发板上实现了双操作系统架构。</p>
                </div>
                <h4 class="anchor-tag" id="91" name="91">4.1 内存隔离</h4>
                <div class="p1">
                    <p id="92">由于TOPPERS/FMP、Linux以及监视器的存储空间不可以混叠, 因此将内存区域划分为3个部分对其分别存储, 其中0x00000000-0x4EFFFFFF由Linux使用, 0x4F000000-0x4F0FFFFF由监视器使用, 0x4F100000-0x4F700000由TOPPERS/FMP使用。</p>
                </div>
                <h4 class="anchor-tag" id="93" name="93">4.2 TOPPERS/FMP修改</h4>
                <div class="p1">
                    <p id="94">为了实现在TOPPERS/FMP空闲时切换到Linux中, 使得Linux继续运行, 在TOPPERS/FMP中设置一个SMC任务, 该任务的函数体主要为循环执行SMC调用, 伪代码具体如下:</p>
                </div>
                <div class="area_img" id="157">
                                <img alt="" src="Detail/GetImg?filename=images/JSJC201904002_15700.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdWa2FjcW9vRlJTQ2JLUmN2amRwVFpsWThsTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                            <p class="img_tit"></p>

                </div>
                <div class="p1">
                    <p id="105">由于TOPPERS/FMP运行在安全世界中, 因此在TOPPERS/FMP内核中的中断需要按照安全世界的规则进行设置, 即中断为安全模式且优先级必须小于-16。为了保证TOPPERS/FMP在安全世界中运行时不被IRQ中断, 需要将TOPPERS/FMP内核配置为始终禁止IRQ, 即默认情况下IRQ被禁止。当系统处于监视器模式时, FIQ和IRQ都被禁止。</p>
                </div>
                <div class="p1">
                    <p id="106">在该架构中, TOPPERS/FMP使用GlobalTimer作为内核时钟, 并且使用串口UART3作为信息传输端口。</p>
                </div>
                <h4 class="anchor-tag" id="107" name="107">4.3 Linux修改</h4>
                <div class="p1">
                    <p id="108">为了使Linux可以运行在普通世界, 需要对发行版本的Linux内核进行一些修改:</p>
                </div>
                <div class="p1">
                    <p id="109">1) 通过在内核文件system.c中增加监视器中用到的系统调用函数实现Linux对监视器的支持, 例如增加用于读写硬件设备寄存器的函数。</p>
                </div>
                <div class="p1">
                    <p id="110">2) 在移植Linux时, 需要避免其使用的关键外设与TOPPERS/FMP产生冲突, 例如内核时钟、串口等。因此, 在Linux中, PrivateTimer被配置为内核时钟, 并且使用串口UART1作为信息传输端口。</p>
                </div>
                <h3 id="111" name="111" class="anchor-tag">5 系统实时性评估</h3>
                <div class="p1">
                    <p id="112">任务切换时间与中断响应时间是影响系统实时性能的关键因素, 因此, 本文利用这2个指标对双操作系统架构进行实时性能评估。</p>
                </div>
                <div class="p1">
                    <p id="113">本文测试使用的硬件平台为Freescale公司的i.MX6Quad SABRE开发板, 处理器i.MX 6Quad的主频为1 GHz, 并且支持ARM TrustZone功能。测试使用Linux 操作系统作为GPOS, TOPPERS/FMP作为RTOS。</p>
                </div>
                <h4 class="anchor-tag" id="114" name="114">5.1 任务切换时间</h4>
                <div class="p1">
                    <p id="115">任务切换时间是指将CPU的控制权由当前运行中的任务转移到另一个已就绪任务所需要的时间<citation id="153" type="reference"><link href="33" rel="bibliography" /><link href="35" rel="bibliography" /><sup>[<a class="sup">16</a>,<a class="sup">17</a>]</sup></citation>, 包括保存当前任务上下文所使用的时间、任务调度的时间以及恢复就绪任务上下文所使用的时间。在多任务系统中, 由于系统需要对所有任务进行调度管理, 因此任务切换发生频率较高。任务切换时间反映了系统的调度速度, 直接影响实时任务的处理速度。</p>
                </div>
                <div class="p1">
                    <p id="116">本文分别对传统Linux操作系统的任务切换时间和双操作系统架构中的Linux操作系统的非实时任务切换时间以及TOPPERS/FMP的实时任务切换时间进行了测量。利用微型基准测试工具LMbench<citation id="154" type="reference"><link href="23" rel="bibliography" /><sup>[<a class="sup">11</a>]</sup></citation>对传统Linux操作系统与双操作系统中的Linux操作系统的任务切换时间进行测试。为了测量实时任务的切换时间, 本文在TOPPERS/FMP中设置2个任务:Task1与Task2。Task1的优先级为high_priority, Task2的优先级为mid_priority。在Task2中激活Task1。利用系统定时器, 分别记录激活Task1前的时间<i>t</i>1和进入Task1后运行第一条指令前的时间<i>t</i>2, 两者之差即为任务切换时间, 其代码示例如图6所示。</p>
                </div>
                <div class="area_img" id="117">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JSJC201904002_117.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdWa2FjcW9vRlJTQ2JLUmN2amRwVFpsWThsTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图6 TOPPERS/FMP任务切换时间代码示例" src="Detail/GetImg?filename=images/JSJC201904002_117.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdWa2FjcW9vRlJTQ2JLUmN2amRwVFpsWThsTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit"><b>图6 TOPPERS/FMP任务切换时间代码示例</b>  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JSJC201904002_117.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdWa2FjcW9vRlJTQ2JLUmN2amRwVFpsWThsTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="p1">
                    <p id="118">表1给出了双操作系统架构和传统Linux操作系统的实时任务切换时间, 从中可以看出, 传统Linux操作系统实时任务切换时间的最大值约为双操作系统架构实时任务切换时间最大值的12倍。在稳定性方面, 如图7所示, 双操作系统架构的实时任务切换时间最大值与最小值之差为0.008 μs, 波动较小, 比较稳定;传统Linux操作系统实时任务切换时间的最大值与最小值之差为2.26 μs, 波动较大。因此, 双操作系统架构比传统Linux操作系统的实时性强。</p>
                </div>
                <div class="area_img" id="119">
                    <p class="img_tit"><b>表1 实时任务切换时间</b> <a class="downexcel" onclick="DownLoadReportExcel(this)">导出到EXCEL</a></p>
                    <p class="img_tit"></p>
                    <p class="img_note">μs</p>
                    <table id="119" border="1"><tr><td>平台</td><td>最小值</td><td>最大值</td></tr><tr><td>双操作系统架构</td><td>0.859</td><td>0.867</td></tr><tr><td><br />传统Linux操作系统</td><td>7.740</td><td>10.000</td></tr></table>
                    <form name="form" action="/kxreader/Detail/DownloadReportExcel" method="POST" style="display:inline">
                        <input type="hidden" name="hidTable" value="" />
                        <input type="hidden" name="hidFileName" value="" />
                    </form>
                    <p class="img_note"></p>
                    <p class="img_note"></p>
                </div>
                <div class="area_img" id="120">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JSJC201904002_120.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdWa2FjcW9vRlJTQ2JLUmN2amRwVFpsWThsTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图7 实时任务切换时间实验数据" src="Detail/GetImg?filename=images/JSJC201904002_120.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdWa2FjcW9vRlJTQ2JLUmN2amRwVFpsWThsTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit"><b>图7 实时任务切换时间实验数据</b>  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JSJC201904002_120.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdWa2FjcW9vRlJTQ2JLUmN2amRwVFpsWThsTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="p1">
                    <p id="121">如表2与图8所示, 双操作系统架构的非实时任务切换时间最大值为10.50 μs, 传统Linux操作系统的非实时任务切换时间最大值为10.00 μs, 两者相差不大。因此, 双操作系统对于功能性非实时任务有较强的处理能力。</p>
                </div>
                <div class="area_img" id="122">
                    <p class="img_tit"><b>表2 非实时任务切换时间</b> <a class="downexcel" onclick="DownLoadReportExcel(this)">导出到EXCEL</a></p>
                    <p class="img_tit"></p>
                    <p class="img_note">μs</p>
                    <table id="122" border="1"><tr><td>平台</td><td>最小值</td><td>最大值</td></tr><tr><td>双操作系统架构</td><td>3.21</td><td>10.50</td></tr><tr><td><br />传统Linux操作系统</td><td>7.74</td><td>10.00</td></tr></table>
                    <form name="form" action="/kxreader/Detail/DownloadReportExcel" method="POST" style="display:inline">
                        <input type="hidden" name="hidTable" value="" />
                        <input type="hidden" name="hidFileName" value="" />
                    </form>
                    <p class="img_note"></p>
                    <p class="img_note"></p>
                </div>
                <div class="area_img" id="123">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JSJC201904002_123.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdWa2FjcW9vRlJTQ2JLUmN2amRwVFpsWThsTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图8 非实时任务切换时间实验数据" src="Detail/GetImg?filename=images/JSJC201904002_123.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdWa2FjcW9vRlJTQ2JLUmN2amRwVFpsWThsTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit"><b>图8 非实时任务切换时间实验数据</b>  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JSJC201904002_123.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdWa2FjcW9vRlJTQ2JLUmN2amRwVFpsWThsTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <h4 class="anchor-tag" id="124" name="124">5.2 中断响应时间</h4>
                <div class="p1">
                    <p id="125">中断响应时间是指从中断到达CPU到对应的中断处理程序执行第一条指令所使用的时间<citation id="155" type="reference"><link href="33" rel="bibliography" /><link href="35" rel="bibliography" /><sup>[<a class="sup">16</a>,<a class="sup">17</a>]</sup></citation>, 包括确定中断类型的时间、保存当前任务上下文的时间以及切换到对应中断处理程序并开始执行第一条指令的时间。</p>
                </div>
                <div class="p1">
                    <p id="126">本文分别对传统Linux操作系统和双操作系统架构的中断响应时间进行了测试。利用RT-Tests<citation id="156" type="reference"><link href="25" rel="bibliography" /><sup>[<a class="sup">12</a>]</sup></citation>测量传统Linux操作系统与双操作系统中的Linux操作系统的中断响应时间。为了对TOPPERS/FMP的中断响应时间进行测试, 本文利用其系统定时器作为中断源, 每100 ms产生一次定时器中断。当中断产生时, 定时器继续运行。当进入到中断处理程序时, 用全局静态变量记录当前定时器的值。利用在全局变量中的值与设定好的中断时刻的计数器的值, 计算出中断响应时间。</p>
                </div>
                <div class="p1">
                    <p id="127">表3给出了双操作系统架构和传统Linux操作系统的实时任务中断响应时间。从表3可以看出, 双操作系统架构的实时任务的中断响应时间远小于传统Linux操作系统的实时任务的中断响应时间, 从而保证中断响应时间的确定性。从图9可以看出, 传统Linux操作系统的实时任务的中断响应时间最大值与最小值相差31 μs, 波动较大, 无法保证所有中断能够在截止时间前得到响应;而双操作系统架构可以保证中断在截止时间前得到响应, 有较强的实时性能。</p>
                </div>
                <div class="area_img" id="128">
                    <p class="img_tit"><b>表3 实时任务中断响应时间</b> <a class="downexcel" onclick="DownLoadReportExcel(this)">导出到EXCEL</a></p>
                    <p class="img_tit"></p>
                    <p class="img_note">μs</p>
                    <table id="128" border="1"><tr><td>平台</td><td>最小值</td><td>最大值</td></tr><tr><td>双操作系统架构</td><td>1</td><td>4</td></tr><tr><td><br />传统Linux操作系统</td><td>6</td><td>37</td></tr></table>
                    <form name="form" action="/kxreader/Detail/DownloadReportExcel" method="POST" style="display:inline">
                        <input type="hidden" name="hidTable" value="" />
                        <input type="hidden" name="hidFileName" value="" />
                    </form>
                    <p class="img_note"></p>
                    <p class="img_note"></p>
                </div>
                <div class="area_img" id="129">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JSJC201904002_129.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdWa2FjcW9vRlJTQ2JLUmN2amRwVFpsWThsTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图9 实时任务中断响应时间实验数据" src="Detail/GetImg?filename=images/JSJC201904002_129.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdWa2FjcW9vRlJTQ2JLUmN2amRwVFpsWThsTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit"><b>图9 实时任务中断响应时间实验数据</b>  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JSJC201904002_129.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdWa2FjcW9vRlJTQ2JLUmN2amRwVFpsWThsTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="p1">
                    <p id="130">如表4与图10所示, 与传统Linux操作系统相比, 双操作系统架构对非实时任务的中断进行响应所使用的时间有所增加, 但处于可接受范围之内, 该架构可以较好地处理非实时任务。</p>
                </div>
                <div class="area_img" id="131">
                    <p class="img_tit"><b>表4 非实时任务中断响应时间</b> μs <a class="downexcel" onclick="DownLoadReportExcel(this)">导出到EXCEL</a></p>
                    <p class="img_tit"></p>
                    <p class="img_note"></p>
                    <table id="131" border="1"><tr><td>平台</td><td>最小值</td><td>最大值</td></tr><tr><td>双操作系统架构</td><td>13</td><td>71</td></tr><tr><td><br />传统Linux操作系统</td><td>6</td><td>37</td></tr></table>
                    <form name="form" action="/kxreader/Detail/DownloadReportExcel" method="POST" style="display:inline">
                        <input type="hidden" name="hidTable" value="" />
                        <input type="hidden" name="hidFileName" value="" />
                    </form>
                    <p class="img_note"></p>
                    <p class="img_note"></p>
                </div>
                <div class="area_img" id="132">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JSJC201904002_132.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdWa2FjcW9vRlJTQ2JLUmN2amRwVFpsWThsTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图10 非实时任务中断响应时间实验数据" src="Detail/GetImg?filename=images/JSJC201904002_132.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdWa2FjcW9vRlJTQ2JLUmN2amRwVFpsWThsTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit"><b>图10 非实时任务中断响应时间实验数据</b>  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JSJC201904002_132.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdWa2FjcW9vRlJTQ2JLUmN2amRwVFpsWThsTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <h3 id="133" name="133" class="anchor-tag">6 结束语</h3>
                <div class="p1">
                    <p id="134">本文提出利用基于可信执行环境的双操作系统架构实现嵌入式系统丰富功能性与硬实时性的方案。该方案由在双操作系统中的RTOS掌握系统控制权, 为运行在RTOS上的实时任务提供硬实时性保证, 同时利用GPOS处理功能性任务, 增强系统应用接口的重用性。本文方案不受硬件平台核心数的约束, 并且能够利用ARM TrustZone技术为RTOS提供更强的安全保证, 即使GPOS受到攻击, 也不会破坏RTOS的实时性。实验结果表明, 该方案既实现了系统的功能性, 又保证了系统的实时性。由于该架构运行在多核处理器上, 核心间的负载平衡影响着系统的实时性, 因此下一步的研究重点是核心间的任务迁移。</p>
                </div>

        <!--brief end-->
        
        <!--conten left  end-->
        <!--增强附件-->
        

        <!--reference start-->
            <div class="reference anchor-tag" id="a_bibliography">
                    <h3>参考文献</h3>
                                        <p id="3">
                            <a id="bibliography_1" target="_blank" href="http://scholar.cnki.net/result.aspx?q=PX4:A node-based multithreaded open source robotics framework for deeply embedded platforms">

                                <b>[1]</b> MEIER L, HONEGGER D, POLLEFEYS M.PX4:a node-based multithreaded open source robotics framework for deeply embedded platforms[C]//Proceedings of 2015 IEEE International Conference on Robotics and Automation.Washington D.C., USA:IEEE Press, 2015:6235-6240.
                            </a>
                        </p>
                        <p id="5">
                            <a id="bibliography_2" target="_blank" href="http://scholar.cnki.net/result.aspx?q=RT PREEMPT HOWTO">

                                <b>[2]</b> WIKIPEDIA.RT PREEMPT HOWTO[EB/OL].[2017-12-15].https://rt.wiki.kernel.org/index.php/RT_PREEMPT_HOWTO.
                            </a>
                        </p>
                        <p id="7">
                            <a id="bibliography_3" target="_blank" href="http://scholar.cnki.net/result.aspx?q=PikeOS hypervisor">

                                <b>[3]</b> SYSGO.PikeOS hypervisor[EB/OL].[2017-12-15].https://www.sysgo.com/products/pikeos-hypervisor/.
                            </a>
                        </p>
                        <p id="9">
                            <a id="bibliography_4" target="_blank" href="http://scholar.cnki.net/result.aspx?q=The OKL4 microvisor:convergence point of microkernels and hypervisors">

                                <b>[4]</b> HEISER G, LESLIE B.The OKL4 microvisor:convergence point of microkernels and hypervisors[C]//Proceedings of the 1st ACM Asia-Pacific Workshop on Systems.New York, USA:ACM Press, 2010:19-24.
                            </a>
                        </p>
                        <p id="11">
                            <a id="bibliography_5" target="_blank" href="http://scholar.cnki.net/result.aspx?q=The RT-Linux approach to hard real-time">

                                <b>[5]</b> YODAIKEN V.The RT-Linux approach to hard real-time[EB/OL].[2017-12-15].http://luz.cs.nmt.edu/rtlinux/whitepaper/short.
                            </a>
                        </p>
                        <p id="13">
                            <a id="bibliography_6" target="_blank" href="http://scholar.cnki.net/result.aspx?q=RTAI—the realtime application interface for Linux">

                                <b>[6]</b> RTAI-Lab.RTAI—the realtime application interface for Linux[EB/OL].[2017-12-15].https://www.rtai.org/?Homepage.
                            </a>
                        </p>
                        <p id="15">
                            <a id="bibliography_7" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Xenomai-implementing a RTOS emulation framework on GNU/Linux">

                                <b>[7]</b> GERUM P.Xenomai-implementing a RTOS emulation framework on GNU/Linux[EB/OL].[2017-12-15].http://www.cs.ru.nl/lab/xenomai/xenomai_whitepap er.pdf.
                            </a>
                        </p>
                        <p id="17">
                            <a id="bibliography_8" target="_blank" href="http://scholar.cnki.net/result.aspx?q=RGMP-ROS:a real-time ROS architecture of hybrid RTOS and GPOS on multi-core processor">

                                <b>[8]</b> WEI H, HUANG Z, YU Q, et al.RGMP-ROS:a real-time ROS architecture of hybrid RTOS and GPOS on multi-core processor[C]//Proceedings of 2014 IEEE International Conference on Robotics and Automation.Washington D.C., USA:IEEE Press, 2014:2482-2487.
                            </a>
                        </p>
                        <p id="19">
                            <a id="bibliography_9" target="_blank" href="http://scholar.cnki.net/result.aspx?q=ARM technical white paper:ARM security technology——building a secure system using TrustZone technology[R/OL]">

                                <b>[9]</b> ARM.ARM technical white paper:ARM security technology——building a secure system using TrustZone technology[R/OL].[2017-12-15].https://developer.arm.com/docs/genc009492/c.
                            </a>
                        </p>
                        <p id="21">
                            <a id="bibliography_10" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Real-time operating systems for multicore embedded systems">

                                <b>[10]</b> TOMIYAMA H, HONDA S, TAKADA H.Real-time operating systems for multicore embedded systems[C]//Proceedings of ISOCC’08.Washington D.C., USA:IEEE Press, 2008:62-67.
                            </a>
                        </p>
                        <p id="23">
                            <a id="bibliography_11" target="_blank" href="http://scholar.cnki.net/result.aspx?q=LMbench-tools for performance analysis">

                                <b>[11]</b> LARRY M, CARL S.LMbench-tools for performance analysis[EB/OL].[2017-12-15].http://www.bitmover.com/lmbench/.
                            </a>
                        </p>
                        <p id="25">
                            <a id="bibliography_12" target="_blank" href="http://scholar.cnki.net/result.aspx?q=RT-tests">

                                <b>[12]</b> The Linux Foundation.RT-tests[EB/OL].[2017-12-15].https://wiki.linuxfoundation.org/realtime/documentation/ howto/tools/rt-tests#compile-and-install.
                            </a>
                        </p>
                        <p id="27">
                            <a id="bibliography_13" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Open portable trusted execution environment">

                                <b>[13]</b> OP-TEE.Open portable trusted execution environment[EB/OL].[2017-12-15].https://www.op-tee.org/.
                            </a>
                        </p>
                        <p id="29">
                            <a id="bibliography_14" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Development of an ARM TrustZone aware operating system ANDIX OS">

                                <b>[14]</b> ANDREAS F.Development of an ARM TrustZone aware operating system ANDIX OS[D].Graz, Austria:Graz University of Technology, 2014.
                            </a>
                        </p>
                        <p id="31">
                            <a id="bibliography_15" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Dual ope-rating system architecture for real-time embedded systems">

                                <b>[15]</b> SANGORRIN D, HONDA S, TAKADA H.Dual operating system architecture for real-time embedded systems[C]//Proceedings of the 6th International Workshop on Operating Systems Platforms for Embedded Real-Time Applications.Washington D.C., USA:IEEE Press, 2010:6-15.
                            </a>
                        </p>
                        <p id="33">
                            <a id="bibliography_16" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=XXWX201706017&amp;v=MTI3MjNjZHJHNEg5Yk1xWTlFWTRRS0RIODR2UjRUNmo1NE8zenFxQnRHRnJDVVJMT2VaZVJvRnl6aFY3clBQVFg=&amp;uid=WEEvREcwSlJHSldRa1FhcTdWa2FjcW9vRlJTQ2JLUmN2amRwVFpsWThsTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[16]</b> 董艳雪, 韩卫光.基于多核 ARM 的 Linux 操作系统的实时性研究[J].小型微型计算机系统, 2017, 38 (6) :1262-1266.
                            </a>
                        </p>
                        <p id="35">
                            <a id="bibliography_17" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=NMGX201105010&amp;v=MDE3NTQ5RVpJUUtESDg0dlI0VDZqNTRPM3pxcUJ0R0ZyQ1VSTE9lWmVSb0Z5emhWN3JQS3lETWRyRzRIOURNcW8=&amp;uid=WEEvREcwSlJHSldRa1FhcTdWa2FjcW9vRlJTQ2JLUmN2amRwVFpsWThsTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[17]</b> 王蕾, 朴希望, 李世群, 等.嵌入式实时操作系统的时间性能测试[J].内蒙古大学学报 (自然科学版) , 2011, 42 (5) :547-551.
                            </a>
                        </p>
            </div>
        <!--reference end-->
        <!--footnote start-->
        <!--footnote end-->



    </div>

        <input id="fileid" type="hidden" value="JSJC201904002" />
        <input id="dpi" type="hidden" value="600" />
    </div>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?6e967eb120601ea41b9d312166416aa6";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
</script>

    


<input id="hid_uid" name="hid_uid" type="hidden" value="WEEvREcwSlJHSldRa1FhcTdWa2FjcW9vRlJTQ2JLUmN2amRwVFpsWThsTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
<input id="hid_kLogin_headerUrl" name="hid_kLogin_headerUrl" type="hidden" value="/KLogin/Request/GetKHeader.ashx%3Fcallback%3D%3F" />
<input id="hid_kLogin_footerUrl" name="hid_kLogin_footerUrl" type="hidden" value="/KLogin/Request/GetKFooter.ashx%3Fcallback%3D%3F" />
<div class="btn-link" style="display: none"><a target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JSJC201904002&amp;v=MjYyNDY0VDZqNTRPM3pxcUJ0R0ZyQ1VSTE9lWmVSb0Z5emhWN3JQTHo3QmJiRzRIOWpNcTQ5RlpvUUtESDg0dlI=&amp;uid=WEEvREcwSlJHSldRa1FhcTdWa2FjcW9vRlJTQ2JLUmN2amRwVFpsWThsTT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">知网节</a></div>
<div class="popflow" id="popupTips" style="display: none;">
    <div class="popflowArr"></div>
    <div class="popflowCot">
        <div class="hd"><a href="javascript:void(0);" onclick="$('#popupTips').hide();$('#popupmsg').html('')" class="close">X</a></div>
        <div class="bd">
            <p class="mes" id="popupmsg" name="popupmsg"></p>
          
        </div>
    </div>
</div>
<input type="hidden" id="myexport" value="//kns.cnki.net" />

<input type="hidden" id="KPCAPIPATH" value="//ishufang.cnki.net" />
<input type="hidden" id="CitedTimes" value="" />
<div class="link" id="GLSearch" style="display: none;">
    <i class="icon-trangle"></i>
    <div class="inner">
        <a class="icon" id="copytext">复制</a>
        <a class="icon" target="_blank" onclick="searchCRFD(this)">工具书搜索</a>
    </div>
</div>




<input id="hidVirtualPath" name="hidVirtualPath" type="hidden" value="/kxreader" />
<script src="/kxreader/bundles/detail?v=-ULdk-c6FkZHtJA2KAXPgHnyA8mtgyPnBde_C2VZ2BY1"></script>

<script src="/kxreader/Scripts/layer.min.js" type="text/javascript"></script>

<div id="footerBox" class="rootw footer">
</div>
<script>
    if (typeof FlushLogin == 'function') {
        FlushLogin();
    }
    modifyEcpHeader(true);
</script>

<!--图片放大功能 start-->
<script src="/kxreader/bundles/imagebox?v=W4phPu9SNkGcuPeJclikuVE3PpRyIW_gnfjm_19nynI1"></script>

<script type="text/javascript">
    $(function () {
        var j = $.noConflict();
        j(function () {
            j(".zoom-in,.btn-zoomin").imgbox({
                'alignment': 'center',
                'allowMultiple': false,
                'overlayShow': true
            });
        })
    });
</script>
<!--图片放大功能 end-->
<div class="fixedbar">
    <div class="backtop hiddenV" id="backtop">
        <a id="backTopSide" href="javascript:scroll(0,0);" title=""></a>
    </div>
</div>
<script type="text/javascript" src="/kxreader/Scripts/MathJax-2.6-latest/MathJax.js?config=MML_HTMLorMML-full"></script>

</body>
</html>
