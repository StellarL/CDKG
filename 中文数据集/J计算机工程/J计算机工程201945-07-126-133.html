<!DOCTYPE html>
<html>
<head>
    <title>全文阅读--XML全文阅读--中国知网</title>
    <link rel="icon" href="/kxreader/favicon.ico" />
    <link rel="shortcut Icon" href="/kxreader/favicon.ico" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="keywords" content="文献 XML KBASE CNKI 中国知网" />
    <meta name="description" content="XML文献检索" />
    <link href="/kxreader/Content/css/detail?v=qX2z2KjRAEyQiNfAbKtl7dLnsqFoQ5Jdw3TZfDf0n1k1" rel="stylesheet"/>

    <script type="text/javascript">
        var APPPATH = '/kxreader';
    </script>
</head>

<body>
    
<script type="text/javascript" src="//login.cnki.net/TopLogin/api/loginapi/get?type=top&amp;localCSS=&amp;returnurl=%2f%2fkns.cnki.net%2f%2fKXReader%2fDetail%3fTIMESTAMP%3d637129918672957500%26DBCODE%3dCJFD%26TABLEName%3dCJFDLAST2019%26FileName%3dJSJC201907020%26RESULT%3d1%26SIGN%3dGOIZWKEdietVOevyf5JBIw%252brT0U%253d"></script>

<div id="headerBox" class="header">
    <div class="topbar">
        <div class="textalign">
            <a href="/kxreader/Detail?dbcode=CJFD&amp;filename=JSJC201907020&amp;align=md">
                <i class="icon-cen active" title="居中对齐"></i>
            </a>
            <a href="/kxreader/Detail?dbcode=CJFD&amp;filename=JSJC201907020&amp;align=lt">
                <i class="icon-left " title="左对齐"></i>
            </a>
        </div>
        <h6 class="free-tip"><i class="icon"></i>HTML阅读开放试用阶段，欢迎体验！</h6>
    </div>
</div>

    



<div class="btn-link" style="display: none"><a target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JSJC201907020&amp;v=MTA0MTh0R0ZyQ1VSTE9lWmVScEZDamxWYnJCTHo3QmJiRzRIOWpNcUk5SFpJUUtESDg0dlI0VDZqNTRPM3pxcUI=&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQwam9BWm83cU5adCswdFNtUXRBUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">知网节</a></div>

    <div class="main">

        

    <div class="sidebar-a">
        <!--sidebar start-->
        <div class="sidenav">
            <div class="arrow"><span></span></div>
            <!--sidebar_list start-->
            <dl class="sidenav-list">
                    <dt class="tit">目录结构</dt>
                            <dd class="guide">
                                    <p><a href="#35" data-title="0 概述 ">0 概述</a><i></i></p>
                                                            </dd>
                            <dd class="guide">
                                    <p><a href="#40" data-title="1 问题描述 ">1 问题描述</a><i></i></p>
                                                            </dd>
                            <dd class="guide">
                                    <p><a href="#47" data-title="2 &lt;i&gt;BSMISRF&lt;/i&gt;算法 ">2 <i>BSMISRF</i>算法</a><i></i></p>
                                                                    <ul class="contentbox">
                                                <li><a href="#48" data-title="2.1 基于LCSD的状态相关字段识别">2.1 基于LCSD的状态相关字段识别</a></li>
                                                <li><a href="#87" data-title="2.2 基于邻接表的初始状态机构建">2.2 基于邻接表的初始状态机构建</a></li>
                                                <li><a href="#100" data-title="2.3 协议状态机化简">2.3 协议状态机化简</a></li>
                                    </ul>
                            </dd>
                            <dd class="guide">
                                    <p><a href="#116" data-title="3 实验结果与分析 ">3 实验结果与分析</a><i></i></p>
                                                                    <ul class="contentbox">
                                                <li><a href="#124" data-title="3.1 协议状态机推断结果">3.1 协议状态机推断结果</a></li>
                                                <li><a href="#129" data-title="3.2 VDV算法与LCSD算法性能比较">3.2 VDV算法与LCSD算法性能比较</a></li>
                                                <li><a href="#134" data-title="3.3 化简前后的协议状态机规模比较">3.3 化简前后的协议状态机规模比较</a></li>
                                                <li><a href="#139" data-title="3.4 协议状态机性能评估">3.4 协议状态机性能评估</a></li>
                                    </ul>
                            </dd>
                            <dd class="guide">
                                    <p><a href="#143" data-title="4 结束语 ">4 结束语</a><i></i></p>
                                                            </dd>
                            <dd class="guide">
                                    <p><a href="#" data-title="文内图表 ">文内图表</a><i></i></p>
                                                                    <ul class="contentbox">
                                                <li><a href="#44" data-title="&lt;b&gt;图1 二进制私有协议状态机推断流程&lt;/b&gt;"><b>图1 二进制私有协议状态机推断流程</b></a></li>
                                                <li><a href="#50" data-title="&lt;b&gt;图2 状态相关字段序列示意图&lt;/b&gt;"><b>图2 状态相关字段序列示意图</b></a></li>
                                                <li><a href="#63" data-title="&lt;b&gt;图3 同种类型协议会话集示意图&lt;/b&gt;"><b>图3 同种类型协议会话集示意图</b></a></li>
                                                <li><a href="#91" data-title="&lt;b&gt;表1 初始协议状态邻接表&lt;/b&gt;"><b>表1 初始协议状态邻接表</b></a></li>
                                                <li><a href="#92" data-title="&lt;b&gt;表2 协议状态邻接表1&lt;/b&gt;"><b>表2 协议状态邻接表1</b></a></li>
                                                <li><a href="#93" data-title="&lt;b&gt;表3 协议状态邻接表2&lt;/b&gt;"><b>表3 协议状态邻接表2</b></a></li>
                                                <li><a href="#95" data-title="&lt;b&gt;表4 协议状态邻接表3&lt;/b&gt;"><b>表4 协议状态邻接表3</b></a></li>
                                                <li><a href="#99" data-title="&lt;b&gt;图4 概率协议状态机示意图&lt;/b&gt;"><b>图4 概率协议状态机示意图</b></a></li>
                                                <li><a href="#104" data-title="&lt;b&gt;表5 协议状态邻接表4&lt;/b&gt;"><b>表5 协议状态邻接表4</b></a></li>
                                                <li><a href="#105" data-title="&lt;b&gt;表6 协议状态邻接表5&lt;/b&gt;"><b>表6 协议状态邻接表5</b></a></li>
                                                <li><a href="#109" data-title="&lt;b&gt;图5 存在相似状态的协议状态机示意图&lt;/b&gt;"><b>图5 存在相似状态的协议状态机示意图</b></a></li>
                                                <li><a href="#110" data-title="&lt;b&gt;图6 合并相似状态后的协议状态机示意图&lt;/b&gt;"><b>图6 合并相似状态后的协议状态机示意图</b></a></li>
                                                <li><a href="#112" data-title="&lt;b&gt;表7 协议状态邻接表6&lt;/b&gt;"><b>表7 协议状态邻接表6</b></a></li>
                                                <li><a href="#113" data-title="&lt;b&gt;表8 协议状态的入度、出度信息&lt;/b&gt;"><b>表8 协议状态的入度、出度信息</b></a></li>
                                                <li><a href="#114" data-title="&lt;b&gt;表9 协议状态邻接表7&lt;/b&gt;"><b>表9 协议状态邻接表7</b></a></li>
                                                <li><a href="#118" data-title="&lt;b&gt;表10 训练数据集信息&lt;/b&gt;"><b>表10 训练数据集信息</b></a></li>
                                                <li><a href="#119" data-title="&lt;b&gt;表11 测试数据集信息&lt;/b&gt;"><b>表11 测试数据集信息</b></a></li>
                                                <li><a href="#126" data-title="&lt;b&gt;图7 TCP协议状态机&lt;/b&gt;"><b>图7 TCP协议状态机</b></a></li>
                                                <li><a href="#127" data-title="&lt;b&gt;图8 SMB协议状态机&lt;/b&gt;"><b>图8 SMB协议状态机</b></a></li>
                                                <li><a href="#128" data-title="&lt;b&gt;表12 SMB协议命令码&lt;/b&gt;"><b>表12 SMB协议命令码</b></a></li>
                                                <li><a href="#132" data-title="&lt;b&gt;图9 TCP协议状态相关字段选取结果&lt;/b&gt;"><b>图9 TCP协议状态相关字段选取结果</b></a></li>
                                                <li><a href="#133" data-title="&lt;b&gt;图10 SMB协议状态相关字段选取结果&lt;/b&gt;"><b>图10 SMB协议状态相关字段选取结果</b></a></li>
                                                <li><a href="#136" data-title="&lt;b&gt;表13 TCP协议状态机规模统计&lt;/b&gt;"><b>表13 TCP协议状态机规模统计</b></a></li>
                                                <li><a href="#137" data-title="&lt;b&gt;表14 SMB协议状态机规模统计&lt;/b&gt;"><b>表14 SMB协议状态机规模统计</b></a></li>
                                                <li><a href="#138" data-title="&lt;b&gt;图11 2种协议的约简比例&lt;/b&gt;"><b>图11 2种协议的约简比例</b></a></li>
                                                <li><a href="#141" data-title="&lt;b&gt;表15 准确率统计结果&lt;/b&gt;"><b>表15 准确率统计结果</b></a></li>
                                                <li><a href="#142" data-title="&lt;b&gt;表16 召回率统计结果&lt;/b&gt;"><b>表16 召回率统计结果</b></a></li>
                                    </ul>
                            </dd>
                                    <dd class="guide">
                                        <h6>
                                            <p><a href="#a_bibliography">参考文献</a> </p>
                                        </h6>
                                    </dd>

            </dl>
        </div>
        <!--sidebar end-->
        &nbsp;
        <!--此处有一空格符 勿删-->
    </div>

                <div class="sidebar-b three-collumn" style="width:0;">
            <div class="refer" style="width: 0;">
                <div class="arrow off" title="参考文献"><span></span></div>
                <div class="js-scrollbox" >
                    
                    <div class="subbox active">
                        <h4>
                            <span class="tit">参考文献</span>
                            <a class="close" href="javascript:void(0)">x</a>
                        </h4>
                        <div class="side-scroller">
                            <ul class="refer-list">
                                <li id="163">


                                    <a id="bibliography_1" title=" 吴礼发, 洪征, 潘璠.网络协议逆向分析及应用[M].北京:国防工业出版社, 2016." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CBBD&amp;filename=9787118105742000&amp;v=MjQwOTg3bjN4RTlmYnZuS3JpZlp1OXVGQ3ZpVUwvSUpsc2RYRnF6R2JLNUZ0RE1xb2hCWnVzUERCTTh6eFVTbURkOVNI&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQwam9BWm83cU5adCswdFNtUXRBUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[1]</b>
                                         吴礼发, 洪征, 潘璠.网络协议逆向分析及应用[M].北京:国防工业出版社, 2016.
                                    </a>
                                </li>
                                <li id="165">


                                    <a id="bibliography_2" title=" 吴礼发, 王辰, 洪征, 等.协议状态机推断技术研究进展[J].计算机应用研究, 2015, 32 (7) :1931-1936." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JSYJ201507004&amp;v=MTY3ODhaZVJwRkNqbFZickJMejdTWkxHNEg5VE1xSTlGWUlRS0RIODR2UjRUNmo1NE8zenFxQnRHRnJDVVJMT2U=&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQwam9BWm83cU5adCswdFNtUXRBUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[2]</b>
                                         吴礼发, 王辰, 洪征, 等.协议状态机推断技术研究进展[J].计算机应用研究, 2015, 32 (7) :1931-1936.
                                    </a>
                                </li>
                                <li id="167">


                                    <a id="bibliography_3" title=" 王军.基于EDSM的二进制协议状态机逆向[D].哈尔滨:哈尔滨工业大学, 2016." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CMFD&amp;filename=1016774368.nh&amp;v=MjQ0OTFLcDVFYlBJUUtESDg0dlI0VDZqNTRPM3pxcUJ0R0ZyQ1VSTE9lWmVScEZDamxWYnJCVkYyNkdMUy9HdEw=&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQwam9BWm83cU5adCswdFNtUXRBUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[3]</b>
                                         王军.基于EDSM的二进制协议状态机逆向[D].哈尔滨:哈尔滨工业大学, 2016.
                                    </a>
                                </li>
                                <li id="169">


                                    <a id="bibliography_4" title=" TRIFILO A, BURSCHKA S, BIERSACK E.Traffic to protocol reverse engineering[C]//Proceedings of IEEE International Conference on Computational Intelligence for Security and Defense Applications.Washington D.C., USA:IEEE Press, 2009:1-8." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Traffic to protocol reverse engineering">
                                        <b>[4]</b>
                                         TRIFILO A, BURSCHKA S, BIERSACK E.Traffic to protocol reverse engineering[C]//Proceedings of IEEE International Conference on Computational Intelligence for Security and Defense Applications.Washington D.C., USA:IEEE Press, 2009:1-8.
                                    </a>
                                </li>
                                <li id="171">


                                    <a id="bibliography_5" title=" SHEVERTALOV M, MANCORIDIS S.A reverse engi-neering tool for extracting protocols of networked applications[C]//Proceedings of the 14th Working Conference on Reverse Engineering.Washington D.C., USA:IEEE Press, 2007:229-238." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=A reverse engineering tool for extracting protocols of networked applications">
                                        <b>[5]</b>
                                         SHEVERTALOV M, MANCORIDIS S.A reverse engi-neering tool for extracting protocols of networked applications[C]//Proceedings of the 14th Working Conference on Reverse Engineering.Washington D.C., USA:IEEE Press, 2007:229-238.
                                    </a>
                                </li>
                                <li id="173">


                                    <a id="bibliography_6" title=" WANG Yipeng, ZHANG Zhibin, YAO Danfeng, et al.Inferring protocol state machine from network traces:a probabilistic approach[C]//Proceedings of International Conference on Applied Cryptography and Network Security.Berlin, Germany:Springer, 2011:1-18." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Inferring protocol state machine from network traces:a probabilistic approach">
                                        <b>[6]</b>
                                         WANG Yipeng, ZHANG Zhibin, YAO Danfeng, et al.Inferring protocol state machine from network traces:a probabilistic approach[C]//Proceedings of International Conference on Applied Cryptography and Network Security.Berlin, Germany:Springer, 2011:1-18.
                                    </a>
                                </li>
                                <li id="175">


                                    <a id="bibliography_7" title=" DUNN J C.Well-separated clusters and optimal fuzzy partitions[J].Journal of Cybernetics, 1974, 4 (1) :95-104." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=STJD&amp;filename=STJD792192766&amp;v=Mjg5NDVSNFQ2ajU0TzN6cXFCdEdGckNVUkxPZVplUnBGQ2psVmJyQk5qbkJhclN4SE5ERnJZaERZb1FLREg4NHY=&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQwam9BWm83cU5adCswdFNtUXRBUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[7]</b>
                                         DUNN J C.Well-separated clusters and optimal fuzzy partitions[J].Journal of Cybernetics, 1974, 4 (1) :95-104.
                                    </a>
                                </li>
                                <li id="177">


                                    <a id="bibliography_8" title=" JACCARD P.The distribution of the flora in the alpine zone[J].New Phytologist, 1912, 11 (2) :37-50." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=The distribution of the flora in the alpine zone">
                                        <b>[8]</b>
                                         JACCARD P.The distribution of the flora in the alpine zone[J].New Phytologist, 1912, 11 (2) :37-50.
                                    </a>
                                </li>
                                <li id="179">


                                    <a id="bibliography_9" title=" KAUFMAN L, ROUSSEEUW P J.Finding groups in data:an introduction to cluster analysis[M].Washington D.C., USA:John Wiley and Sons, Inc., 2009." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Finding groups in data:an introduction to cluster analysis">
                                        <b>[9]</b>
                                         KAUFMAN L, ROUSSEEUW P J.Finding groups in data:an introduction to cluster analysis[M].Washington D.C., USA:John Wiley and Sons, Inc., 2009.
                                    </a>
                                </li>
                                <li id="181">


                                    <a id="bibliography_10" title=" 黄笑言, 陈性元, 祝宁, 等.基于状态标注的协议状态机逆向方法[J].计算机应用, 2013, 33 (12) :3486-3489." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JSJY201312042&amp;v=Mjc0MDhaZVJwRkNqbFZickJMejdCZDdHNEg5TE5yWTlCWm9RS0RIODR2UjRUNmo1NE8zenFxQnRHRnJDVVJMT2U=&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQwam9BWm83cU5adCswdFNtUXRBUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[10]</b>
                                         黄笑言, 陈性元, 祝宁, 等.基于状态标注的协议状态机逆向方法[J].计算机应用, 2013, 33 (12) :3486-3489.
                                    </a>
                                </li>
                                <li id="183">


                                    <a id="bibliography_11" title=" XIAO Mingming, YU Shunzheng, WANG Yu.Automatic network protocol automaton extraction[C]//Proceedings of the 3rd International Conference on Network and System Security.Washington D.C., USA:IEEE Press, 2009:336-343." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=&amp;quot;Automatic network protocol automation extraction&amp;quot;">
                                        <b>[11]</b>
                                         XIAO Mingming, YU Shunzheng, WANG Yu.Automatic network protocol automaton extraction[C]//Proceedings of the 3rd International Conference on Network and System Security.Washington D.C., USA:IEEE Press, 2009:336-343.
                                    </a>
                                </li>
                                <li id="185">


                                    <a id="bibliography_12" title=" 肖明明, 余顺争.基于文法推断的协议逆向工程[J].计算机研究与发展, 2013, 50 (10) :2044-2058." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JFYZ201310002&amp;v=MjQzMDVMRzRIOUxOcjQ5RlpvUUtESDg0dlI0VDZqNTRPM3pxcUJ0R0ZyQ1VSTE9lWmVScEZDamxWYnJCTHl2U2Q=&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQwam9BWm83cU5adCswdFNtUXRBUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[12]</b>
                                         肖明明, 余顺争.基于文法推断的协议逆向工程[J].计算机研究与发展, 2013, 50 (10) :2044-2058.
                                    </a>
                                </li>
                                <li id="187">


                                    <a id="bibliography_13" title=" TAO Siyu, YU Hongyi, LI Qing.Bit-oriented format extraction approach for automatic binary protocol reverse engineering[J].IET Communications, 2016, 10 (6) :709-716." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Bit-oriented format extraction approach for automatic binary protocol reverse engineering">
                                        <b>[13]</b>
                                         TAO Siyu, YU Hongyi, LI Qing.Bit-oriented format extraction approach for automatic binary protocol reverse engineering[J].IET Communications, 2016, 10 (6) :709-716.
                                    </a>
                                </li>
                                <li id="189">


                                    <a id="bibliography_14" title=" COMPARETTI P M, WONDRACEK G, KRUEGEL C, et al.Prospex:protocol specification extraction[C]//Proceedings of IEEE Symposium on Security and Privacy.Washington D.C., USA:IEEE Press, 2009:110-125." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Prospex:protocol specification extraction">
                                        <b>[14]</b>
                                         COMPARETTI P M, WONDRACEK G, KRUEGEL C, et al.Prospex:protocol specification extraction[C]//Proceedings of IEEE Symposium on Security and Privacy.Washington D.C., USA:IEEE Press, 2009:110-125.
                                    </a>
                                </li>
                                <li id="191">


                                    <a id="bibliography_15" >
                                        <b>[15]</b>
                                     张黎.基于Net-trace的网络协议逆向工程方法研究[D].武汉:华中科技大学, 2011.</a>
                                </li>
                                <li id="193">


                                    <a id="bibliography_16" title=" 肖明明, 余顺争, 张世龙.文法推断网络协议状态机[J].科学技术与工程, 2014, 14 (19) :100-105." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=KXJS201419020&amp;v=MjI2MjViRzRIOVhOcG85SFpJUUtESDg0dlI0VDZqNTRPM3pxcUJ0R0ZyQ1VSTE9lWmVScEZDamxWYnJCTGpYQmY=&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQwam9BWm83cU5adCswdFNtUXRBUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[16]</b>
                                         肖明明, 余顺争, 张世龙.文法推断网络协议状态机[J].科学技术与工程, 2014, 14 (19) :100-105.
                                    </a>
                                </li>
                            </ul>
                            <div style='display: none;' class="zqscroller" >
                                <h4 class="">附加材料</h4>
                                <ul></ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            &nbsp;
            <!--此处有一空格符 勿删-->
        </div>

        
    <div class="content">



        <!--tips start-->
                            <div class="tips">
                    <a href="http://navi.cnki.net/KNavi/JournalDetail?pcode=CJFD&amp;pykm=JSJC" target="_blank">计算机工程</a>
                2019,45(07),126-133 DOI:10.19678/j.issn.1000-3428.0050589            </div>
        <!--tips end-->
            <div class="top-title">
                <h1 class="title">
                    <span class="vm"><b>基于状态相关字段的二进制协议状态机推断</b></span>
 <span class="shoufa"></span>                                     </h1>

            </div>
                        <h2>
                                <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=au&amp;skey=%E9%97%AB%E5%B0%8F%E5%8B%87&amp;code=35649833&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQwam9BWm83cU5adCswdFNtUXRBUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">闫小勇</a>
                                <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=au&amp;skey=%E6%9D%8E%E9%9D%92&amp;code=20430097&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQwam9BWm83cU5adCswdFNtUXRBUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">李青</a>
                                <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=au&amp;skey=%E8%8E%AB%E6%9C%89%E6%9D%83&amp;code=20178533&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQwam9BWm83cU5adCswdFNtUXRBUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">莫有权</a>
                </h2>
                    <h2>
                    <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=in&amp;skey=%E4%BF%A1%E6%81%AF%E5%B7%A5%E7%A8%8B%E5%A4%A7%E5%AD%A6%E4%BF%A1%E6%81%AF%E7%B3%BB%E7%BB%9F%E5%B7%A5%E7%A8%8B%E5%AD%A6%E9%99%A2&amp;code=0199248&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQwam9BWm83cU5adCswdFNtUXRBUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">信息工程大学信息系统工程学院</a>
            </h2>

        
<div class="link">
    <a id="aexport" class="icon icon-output"  onclick="" href="javascript:void(0);"><i></i>导出/参考文献</a>
    
    <span class="shareBoard" onmouseover="$('#sharedet').show();$('#this').addClass('shareBoardCUR')" onmouseout="$('#sharedet').hide();$('#this').removeClass('shareBoardCUR')">
        <a class="icon icon-share" href="#"><i></i>分享<em></em></a>
        <ul class="shareHide" id="sharedet" style="display: none;">
            <li><a title="复制链接" class="copy" onclick="" href="#"><i></i>复制链接</a></li>
            <li><a title="分享到新浪微博" class="xl" onclick="" href="javascript:common.ShareAction('xl');"><i></i>新浪微博</a></li>
            <li>
                <a title="分享到微信" class="wx" onclick="" href="#"><i></i>微信扫一扫</a>
                <div class="qrcode"><img src='' alt='' /></div>
            </li>
        </ul>

    </span>
    
    <a id="RefTrack" title="创建引文跟踪" class="icon icon-track" onclick="" href="javascript:void(0);"> <i></i>创建引文跟踪 </a>
    <a id="ashoucang" title="收藏" class="icon icon-favor" onclick="" href="javascript:void(0);"><i></i>收藏</a>
    <a class="icon icon-print" onclick="window.print();" href="javascript:void(0);"><i></i>打印</a>
    
    <!--版本切换 end-->
</div>
                            <div class="data" id="a_abstract">
                <span class="keys">摘<span style="font-family: 'Times New Roman';">&nbsp;&nbsp;&nbsp;&nbsp;</span>要：</span>
                <p>在通信协议规范中, 报文的格式类型与状态类型不存在一一映射关系, 通过聚类较难将格式类型相同、状态类型不同的报文分离。为此, 提出一种基于状态相关字段的二进制私有协议状态机推断方法。根据最长公共子序列距离进行状态相关字段识别, 以获取协议会话的行为逻辑相似性。构建基于邻接表的初始状态机, 对其进行异常会话去除与相似状态合并, 从而降低协议状态机的规模。在TCP协议和SMB协议数据集上的测试结果表明, 该方法能够有效推断二进制私有协议状态机, 其准确率与召回率均较高。</p>
            </div>
                    <div class="data" id="a_keywords">
                <span class="keys">关键词：</span>
                <p>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=%E5%8D%8F%E8%AE%AE%E7%8A%B6%E6%80%81%E6%9C%BA&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQwam9BWm83cU5adCswdFNtUXRBUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">协议状态机;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=%E4%BA%8C%E8%BF%9B%E5%88%B6%E5%8D%8F%E8%AE%AE&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQwam9BWm83cU5adCswdFNtUXRBUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">二进制协议;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=%E6%9C%80%E9%95%BF%E5%85%AC%E5%85%B1%E5%AD%90%E5%BA%8F%E5%88%97%E8%B7%9D%E7%A6%BB&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQwam9BWm83cU5adCswdFNtUXRBUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">最长公共子序列距离;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=%E9%82%BB%E6%8E%A5%E8%A1%A8&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQwam9BWm83cU5adCswdFNtUXRBUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">邻接表;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=%E5%BC%82%E5%B8%B8%E4%BC%9A%E8%AF%9D%E5%8E%BB%E9%99%A4&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQwam9BWm83cU5adCswdFNtUXRBUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">异常会话去除;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=%E7%9B%B8%E4%BC%BC%E7%8A%B6%E6%80%81%E5%90%88%E5%B9%B6&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQwam9BWm83cU5adCswdFNtUXRBUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">相似状态合并;</a>
                </p>
            </div>
        
        <!--brief start-->
        
            <div class="brief">
                    <p>
                            <b>作者简介：</b>
                                                        <span>
                                    闫小勇 (1993—) , 男, 硕士研究生, 主研方向为协议逆向技术、数据挖掘, E-mail: yanxiaoyong2016@ 163. com;
                                </span>
                                <span>
                                    李青, 副教授;;
                                </span>
                                <span>
                                    莫有权, 副教授。;
                                </span>
                    </p>
                                    <p><b>收稿日期：</b>2018-03-05</p>

                    <p>

                            <b>基金：</b>
                                                        <span>国家自然科学基金“多天线无线携能通信系统中的物理层安全传输技术研究” (61601516);</span>
                    </p>
            </div>
                    <h1><b>State Machine Inference for Binary Protocol Based on State-related Field</b></h1>
                    <h2>
                    <span>YAN Xiaoyong</span>
                    <span>LI Qing</span>
                    <span>MO Youquan</span>
            </h2>
                    <h2>
                    <span>School of Information System and Engineering, Information Engineering University</span>
            </h2>
                            <div class="data" id="a_abstractEN">
                <span class="keys">Abstract：</span>
                <p>As the one-to-one mapping relationship does not exist between the message format type and the message status type in the communication protocol specification, it is difficult to separate messages with the same format type and different status type by clustering.Therefore, a state machine inference method for binary private protocol based on state-related field is proposed.State-related field are identified according to the Longest Common Subsequence Distance (LCSD) to obtain the logical similarity of protocol sessions.An initial state machine based on adjacency table is constructed, and its abnormal session is removed and similar state is merged to reduce the size of protocol state machine.Test results on TCP and SMB protocol datasets show that the proposed method can effectively infer the state machine of binary private protocol, and both its accuracy and recall rate are high.</p>
            </div>
                    <div class="data" id="a_keywordsEN">
                <span class="keys">Keyword：</span>
                <p>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=protocol%20state%20machine&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQwam9BWm83cU5adCswdFNtUXRBUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">protocol state machine;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=binary%20protocol&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQwam9BWm83cU5adCswdFNtUXRBUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">binary protocol;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=the%20Longest%20Common%20Subsequence%20Distance%20(LCSD)%20&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQwam9BWm83cU5adCswdFNtUXRBUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">the Longest Common Subsequence Distance (LCSD) ;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=adjacency%20table&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQwam9BWm83cU5adCswdFNtUXRBUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">adjacency table;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=abnormal%20session%20removal&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQwam9BWm83cU5adCswdFNtUXRBUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">abnormal session removal;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=similar%20state%20merging&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQwam9BWm83cU5adCswdFNtUXRBUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">similar state merging;</a>
                </p>
            </div>
                    <div class="brief">
                
                    <p>
                                            </p>
                                    <p><b>Received：</b> 2018-03-05</p>
                                    <p>
                                            </p>
            </div>


        <!--brief start-->
                        <h3 id="35" name="35" class="anchor-tag">0 概述</h3>
                <div class="p1">
                    <p id="36">协议状态机推断需要获取协议会话中的报文状态类型, 该状态类型标识了报文在会话中的逻辑顺序与功能<citation id="196" type="reference"><link href="163" rel="bibliography" /><link href="165" rel="bibliography" /><link href="167" rel="bibliography" /><sup>[<a class="sup">1</a>,<a class="sup">2</a>,<a class="sup">3</a>]</sup></citation>。例如, TCP协议报文中的6位控制代码:URG, ACK, PSH, RST, SYN, FIN, 其不同的取值组合代表了不同的状态类型。能够表征协议状态类型的字段称为状态相关字段<citation id="195" type="reference"><link href="169" rel="bibliography" /><sup>[<a class="sup">4</a>]</sup></citation>。</p>
                </div>
                <div class="p1">
                    <p id="37">根据获取报文状态类型方法的不同, 现有关于协议状态机推断的相关研究可以分为基于聚类和基于状态相关字段2种类型。文献<citation id="197" type="reference">[<a class="sup">5</a>]</citation>通过层次聚类为每条报文分配类别标签, 将协议会话报文序列转化为类别标签序列, 构建初始状态机并对其进行化简, 得到最小确定状态机。但是, 其将报文之间的格式相似性作为相似性度量标准, 对于格式相似但状态类型不同的报文, 该方法将无法进行区分。文献<citation id="198" type="reference">[<a class="sup">6</a>]</citation>采用Dunn指数<citation id="199" type="reference"><link href="175" rel="bibliography" /><sup>[<a class="sup">7</a>]</sup></citation>与Jaccard指数<citation id="200" type="reference"><link href="177" rel="bibliography" /><sup>[<a class="sup">8</a>]</sup></citation>分别确定聚类类别数与报文相似性, 最终利用PAM算法<citation id="201" type="reference"><link href="179" rel="bibliography" /><sup>[<a class="sup">9</a>]</sup></citation>实现报文聚类。但是, 其同样以聚类后的类别标签代替协议报文, 与文献<citation id="202" type="reference">[<a class="sup">5</a>]</citation>方法面临相同的问题。上述方法虽然易于实现, 但报文的格式类型与状态类型间不存在一一映射关系, 一些格式相似但状态类型不同的报文可能被聚为一类, 最终导致状态机推断错误。</p>
                </div>
                <div class="p1">
                    <p id="38">文献<citation id="203" type="reference">[<a class="sup">4</a>]</citation>认为同种协议的会话具有相似的逻辑, 协议的状态信息由状态相关字段唯一确定。该文将二进制协议会话报文序列转化为状态相关字段序列, 并构建初始状态机。文献<citation id="204" type="reference">[<a class="sup">10</a>]</citation>利用统计方法提取状态相关字段, 通过邻接矩阵表示协议报文间的时序关系。文献<citation id="205" type="reference">[<a class="sup">11</a>,<a class="sup">12</a>]</citation>基于指令序列划分协议字段, 从中选取状态相关字段用于协议状态机推断, 但文中并未详细说明状态相关字段的具体选取方法。上述研究利用状态相关字段的不同取值来表示协议报文的状态类型, 较符合实际情况, 得到的状态机准确性较高。但面向私有协议时, 因为缺少先验信息, 导致难以准确获取状态相关字段。</p>
                </div>
                <div class="p1">
                    <p id="39">在协议字段划分的基础上<citation id="206" type="reference"><link href="187" rel="bibliography" /><sup>[<a class="sup">13</a>]</sup></citation>, 筛选状态相关字段是推断二进制协议状态机的关键步骤。本文提出一种基于状态相关字段的二进制私有协议状态机推断方法BSMISRF。根据最长公共子序列距离 (the Longest Common Subsequence Distance, LCSD) 进行协议状态相关字段识别, 构建初始状态机并去除异常会话, 然后基于出度、入度进行相似状态合并, 在此基础上, 化简初始状态机以构建概率协议状态机。</p>
                </div>
                <h3 id="40" name="40" class="anchor-tag">1 问题描述</h3>
                <div class="p1">
                    <p id="41">不同于文本类协议, 二进制协议的字段不受字节长度的限制, 字段之间不存在明显的定界符, 导致其字段划分比文本类协议困难<citation id="207" type="reference"><link href="187" rel="bibliography" /><sup>[<a class="sup">13</a>]</sup></citation>。协议状态机只与协议的状态相关字段有关。状态相关字段的取值可变, 同种类型的协议字段中往往存在多个可变字段。在无先验知识的条件下, 状态相关字段极易与其他可变字段混淆, 从而给协议状态相关字段识别造成困难。</p>
                </div>
                <div class="p1">
                    <p id="42">文献<citation id="208" type="reference">[<a class="sup">14</a>,<a class="sup">15</a>,<a class="sup">16</a>]</citation>根据所得的状态相关字段, 构建状态相关字段序列, 由该序列生成APTA树, 然后化简状态机。在会话数量较多时, 构造的状态前缀树往往过于庞大, 状态机化简需要大量的比较操作。</p>
                </div>
                <div class="p1">
                    <p id="43">由训练集协议会话构建的状态机是一个特化的状态机, 只能接受训练集中的协议会话。异常报文序列的存在导致协议状态机中可能出现错误的状态转移。此外, 当协议状态类型较多时, 所构建的状态机过于复杂, 不易于理解。为构造正确、具有较小规模的协议状态机, 需要对初始状态机进行化简。因此, 进行二进制私有协议状态机推断需要解决协议字段划分、状态相关字段选取、初始状态机构建以及状态机化简等关键问题, 其流程如图1所示。</p>
                </div>
                <div class="area_img" id="44">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JSJC201907020_044.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQwam9BWm83cU5adCswdFNtUXRBUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图1 二进制私有协议状态机推断流程" src="Detail/GetImg?filename=images/JSJC201907020_044.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQwam9BWm83cU5adCswdFNtUXRBUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit"><b>图1 二进制私有协议状态机推断流程</b>  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JSJC201907020_044.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQwam9BWm83cU5adCswdFNtUXRBUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="p1">
                    <p id="45">假设输入的同种类型的协议报文集合为<i>X</i>={<i>x</i><sub>1</sub>, <i>x</i><sub>2</sub>, …, <i>x</i><sub><i>i</i></sub>, …, <i>x</i><sub><i>n</i></sub>}, <i>x</i><sub><i>i</i></sub>=<i>b</i><sub><i>i</i>1</sub><i>b</i><sub><i>i</i>2</sub>…<i>b</i><sub><i>ij</i></sub>…<i>b</i><sub><i>im</i></sub>表示第<i>i</i>条二进制协议报文, <i>b</i><sub><i>ij</i></sub>∈{＼0<i>b</i>0, ＼0<i>b</i>1}。经过协议字段划分后, 第<i>i</i>条二进制协议报文表示为<i>x</i>′<sub><i>i</i></sub>=<i>f</i><sub><i>i</i>1</sub>‖<i>f</i><sub><i>i</i>2</sub>‖…‖<i>f</i><sub><i>ik</i></sub>‖…‖<i>f</i><sub><i>ip</i></sub>, <i>f</i><sub><i>ik</i></sub>=<i>b</i><sub><i>ij</i><sub>1</sub></sub><i>b</i><sub><i>i</i> (<i>j</i><sub>1</sub>+1) </sub>…<i>b</i><sub><i>ij</i><sub>2</sub></sub>表示第<i>i</i>条协议报文的第<i>k</i>个字段, “‖”表示链接。由协议报文集合<i>X</i>重构的协议会话集为<i>S</i>= (<i>s</i><sub>1</sub>, <i>s</i><sub>2</sub>, …, <i>s</i><sub><i>i</i></sub>, …, <i>s</i><sub><i>N</i></sub>) , <i>s</i><sub><i>i</i></sub>= (<i>x</i><sub><i>i</i>1</sub>, <i>x</i><sub><i>i</i>2</sub>, …, <i>x</i><sub><i>ij</i></sub>, …, <i>x</i><sub><i>iM</i></sub>) 表示第<i>i</i>个协议会话, <i>x</i><sub><i>ij</i></sub>表示第<i>i</i>个协议会话的第<i>j</i>条协议报文。结合协议字段划分结果, 第<i>i</i>个协议会话为<i>s</i>′<sub><i>i</i></sub>= (<i>x</i>′<sub><i>i</i>1</sub>, <i>x</i>′<sub><i>i</i>2</sub>, …, <i>x</i>′<sub><i>ij</i></sub>, …, <i>x</i>′<sub><i>iM</i></sub>) , 第<i>i</i>个协议会话的第<i>j</i>个字段序列为<i>s</i>′<sub><i>ij</i></sub>= (<i>f</i><sub><i>i</i>1<i>j</i></sub>, <i>f</i><sub><i>i</i>2<i>j</i></sub>, …, <i>f</i><sub><i>ijj</i></sub>, …, <i>f</i><sub><i>iMj</i></sub>) , <i>f</i><sub><i>ijj</i></sub>表示第<i>i</i>个协议会话第<i>j</i>条协议报文的第<i>j</i>个字段。假定选取的状态相关字段为协议报文的第<i>k</i>个字段, 则与协议会话<i>s</i><sub><i>i</i></sub>相对应的状态相关字段序列为<mathml id="46"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>s</mi><msub><mrow></mrow><mrow><mi>i</mi><mi>f</mi></mrow></msub><mo>=</mo><mrow><mo> (</mo><mrow><mi>f</mi><msub><mrow></mrow><mrow><mi>i</mi><mn>1</mn><mi>k</mi></mrow></msub><mo>, </mo><mi>f</mi><msub><mrow></mrow><mrow><mi>i</mi><mn>2</mn><mi>k</mi></mrow></msub><mo>, </mo><mo>⋯</mo><mo>, </mo><mi>f</mi><msub><mrow></mrow><mrow><mi>i</mi><mi>j</mi><mi>k</mi></mrow></msub><mo>, </mo><mo>⋯</mo><mo>, </mo><mi>f</mi><msub><mrow></mrow><mrow><mi>i</mi><mi>Μ</mi><mi>k</mi></mrow></msub></mrow><mo>) </mo></mrow></mrow></math></mathml>。以s<sub>if</sub>作为输入, 构建初始状态机, 通过协议状态的删除、合并操作实现状态机化简。</p>
                </div>
                <h3 id="47" name="47" class="anchor-tag">2 <i>BSMISRF</i>算法</h3>
                <h4 class="anchor-tag" id="48" name="48">2.1 基于LCSD的状态相关字段识别</h4>
                <div class="p1">
                    <p id="49">在构建初始状态机时无法直接使用协议会话<i>s</i><sub><i>i</i></sub>= (<i>x</i><sub><i>i</i>1</sub>, <i>x</i><sub><i>i</i>2</sub>, …, <i>x</i><sub><i>ij</i></sub>, …, <i>x</i><sub><i>iM</i></sub>) , 需要将协议会话用状态相关字段进行表示, 构建与协议会话对应的状态相关字段序列<i>s</i><sub><i>if</i></sub>= (<i>f</i><sub><i>i</i>1<i>k</i></sub>, <i>f</i><sub><i>i</i>2<i>k</i></sub>, …, <i>f</i><sub><i>ijk</i></sub>, …, <i>f</i><sub><i>iMk</i></sub>) , 并作为初始状态机的输入, 如图2所示。在面向私有协议时, 先验信息未知, 无法直接获取协议的状态相关字段, 需要先进行字段划分, 将<i>s</i><sub><i>i</i></sub>转换为<i>s</i>′<sub><i>i</i></sub>= (<i>x</i>′<sub><i>i</i>1</sub>, <i>x</i>′<sub><i>i</i>2</sub>, …, <i>x</i>′<sub><i>ij</i></sub>, …, <i>x</i>′<sub><i>iM</i></sub>) , 再根据划分结果识别状态相关字段, 最终构建状态相关字段序列<i>s</i><sub><i>if</i></sub>。</p>
                </div>
                <div class="area_img" id="50">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JSJC201907020_050.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQwam9BWm83cU5adCswdFNtUXRBUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图2 状态相关字段序列示意图" src="Detail/GetImg?filename=images/JSJC201907020_050.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQwam9BWm83cU5adCswdFNtUXRBUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit"><b>图2 状态相关字段序列示意图</b>  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JSJC201907020_050.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQwam9BWm83cU5adCswdFNtUXRBUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="p1">
                    <p id="51">文献<citation id="209" type="reference">[<a class="sup">4</a>]</citation>总结出协议会话的特性:</p>
                </div>
                <div class="p1">
                    <p id="52">1) 同种协议的会话具有相似的行为逻辑。</p>
                </div>
                <div class="p1">
                    <p id="53">2) 协议行为逻辑由状态相关字段表示。</p>
                </div>
                <div class="p1">
                    <p id="54">因此, 同种协议会话的状态相关字段序列具有相似的行为逻辑。文献<citation id="210" type="reference">[<a class="sup">4</a>]</citation>首先计算同种协议中不同会话的各字节方差, 如式 (1) 所示。然后计算不同会话的同一字节方差分布的方差 (Variance of the Distribution of Variances, VDV) , 如式 (2) 所示。最终, 将VDV最小的字节作为状态相关字节。</p>
                </div>
                <div class="p1">
                    <p id="55" class="code-formula">
                        <mathml id="55"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>σ</mi><msubsup><mrow></mrow><mrow><mi>i</mi><mi>k</mi></mrow><mn>2</mn></msubsup><mo>=</mo><mfrac><mrow><mrow><mo stretchy="false"> (</mo><mi>f</mi><msub><mrow></mrow><mrow><mi>i</mi><mn>1</mn><mi>k</mi></mrow></msub><mo>-</mo><mover><mstyle mathsize="140%" displaystyle="true"><mi>f</mi></mstyle><mrow><mspace width="0.25em" /><mo>-</mo></mrow></mover><msub><mrow></mrow><mrow><mi>i</mi><mi>k</mi></mrow></msub><mo stretchy="false">) </mo></mrow><msup><mrow></mrow><mn>2</mn></msup><mo>+</mo><mo stretchy="false"> (</mo><mi>f</mi><msub><mrow></mrow><mrow><mi>i</mi><mn>2</mn><mi>k</mi></mrow></msub><mo>-</mo><mover><mstyle mathsize="140%" displaystyle="true"><mi>f</mi></mstyle><mrow><mspace width="0.25em" /><mo>-</mo></mrow></mover><msub><mrow></mrow><mrow><mi>i</mi><mi>k</mi></mrow></msub><mo stretchy="false">) </mo><msup><mrow></mrow><mn>2</mn></msup><mo>+</mo><mo>⋯</mo><mo>+</mo><mrow><mo stretchy="false"> (</mo><mi>f</mi><msub><mrow></mrow><mrow><mi>i</mi><mi>Μ</mi><mi>k</mi></mrow></msub><mo>-</mo><mover><mstyle mathsize="140%" displaystyle="true"><mi>f</mi></mstyle><mrow><mspace width="0.25em" /><mo>-</mo></mrow></mover><msub><mrow></mrow><mrow><mi>i</mi><mi>k</mi></mrow></msub><mo stretchy="false">) </mo></mrow><msup><mrow></mrow><mn>2</mn></msup></mrow><mi>Μ</mi></mfrac><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mrow><mtext> </mtext><mtext> </mtext><mtext> </mtext></mrow><mo stretchy="false"> (</mo><mn>1</mn><mo stretchy="false">) </mo></mrow></math></mathml>
                    </p>
                </div>
                <div class="p1">
                    <p id="56">其中, <i>σ</i><mathml id="57"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msubsup><mrow></mrow><mrow><mi>i</mi><mi>k</mi></mrow><mn>2</mn></msubsup></mrow></math></mathml>表示第i个会话第k个字节的方差, f<sub>i1k</sub>表示第i个会话第1个报文的第k个字节, f<sub>i1k</sub>=b<sub>i1j<sub>1</sub></sub>b<sub>i1 (j<sub>1</sub>+1) </sub>…b<sub>i1j<sub>2</sub></sub>, j<sub>1</sub>=8×k-7, j<sub>2</sub>=8×k, M表示会话中的报文数。</p>
                </div>
                <div class="p1">
                    <p id="58" class="code-formula">
                        <mathml id="58"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>σ</mi><msubsup><mrow></mrow><mi>k</mi><mn>2</mn></msubsup><mo>=</mo><mfrac><mrow><mrow><mo stretchy="false"> (</mo><mi>σ</mi><msubsup><mrow></mrow><mrow><mn>1</mn><mi>k</mi></mrow><mn>2</mn></msubsup><mo>-</mo><mover><mstyle mathsize="140%" displaystyle="true"><mi>σ</mi></mstyle><mrow><mspace width="0.25em" /><mo>-</mo></mrow></mover><msubsup><mrow></mrow><mi>k</mi><mn>2</mn></msubsup><mo stretchy="false">) </mo></mrow><msup><mrow></mrow><mn>2</mn></msup><mo>+</mo><mrow><mo stretchy="false"> (</mo><mi>σ</mi><msubsup><mrow></mrow><mrow><mn>2</mn><mi>k</mi></mrow><mn>2</mn></msubsup><mo>-</mo><mover><mstyle mathsize="140%" displaystyle="true"><mi>σ</mi></mstyle><mrow><mspace width="0.25em" /><mo>-</mo></mrow></mover><msubsup><mrow></mrow><mi>k</mi><mn>2</mn></msubsup><mo stretchy="false">) </mo></mrow><msup><mrow></mrow><mn>2</mn></msup><mo>+</mo><mo>⋯</mo><mo>+</mo><mrow><mo stretchy="false"> (</mo><mi>σ</mi><msubsup><mrow></mrow><mrow><mi>Ν</mi><mi>k</mi></mrow><mn>2</mn></msubsup><mo>-</mo><mover><mstyle mathsize="140%" displaystyle="true"><mi>σ</mi></mstyle><mrow><mspace width="0.25em" /><mo>-</mo></mrow></mover><msubsup><mrow></mrow><mi>k</mi><mn>2</mn></msubsup><mo stretchy="false">) </mo></mrow><msup><mrow></mrow><mn>2</mn></msup></mrow><mi>Ν</mi></mfrac><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mrow><mtext> </mtext><mtext> </mtext><mtext> </mtext></mrow><mo stretchy="false"> (</mo><mn>2</mn><mo stretchy="false">) </mo></mrow></math></mathml>
                    </p>
                </div>
                <div class="p1">
                    <p id="59">其中, σ<mathml id="60"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msubsup><mrow></mrow><mi>k</mi><mn>2</mn></msubsup></mrow></math></mathml>表示第k个字节的<i>VDV</i>, N表示会话数。</p>
                </div>
                <div class="p1">
                    <p id="61">文献<citation id="211" type="reference">[<a class="sup">4</a>]</citation>算法 (简称为<i>VDV</i>算法) 对于协议状态机推断有一定效果, 但方差仅能反映样本的离散程度, 很难体现样本间的顺序约束关系与行为逻辑。例如, 在某会话集中, 只有同种类型协议的2个会话:会话1与会话2, 会话的第2个字段序列如图3所示。采用<i>VDV</i>算法, 会话1和会话2的第2个字段序列相似, 因为会话1第2个字段序列的元素全部包含在会话2第2个字段序列中。根据式 (1) 、式 (2) 可知, σ<mathml id="62"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msubsup><mrow></mrow><mn>2</mn><mn>2</mn></msubsup></mrow></math></mathml>取值较小时, 第2个字段可能被识别为状态相关字段。但事实上, 会话1和会话2的第2个字段序列所包含的元素虽然相似, 但不同元素间的顺序差别较大, 即会话1和会话2的行为逻辑存在较大差异。由此可见, <i>VDV</i>算法仅能刻画序列所包含元素的相似性, 而无法体现序列元素的顺序相似性。</p>
                </div>
                <div class="area_img" id="63">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JSJC201907020_063.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQwam9BWm83cU5adCswdFNtUXRBUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图3 同种类型协议会话集示意图" src="Detail/GetImg?filename=images/JSJC201907020_063.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQwam9BWm83cU5adCswdFNtUXRBUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit"><b>图3 同种类型协议会话集示意图</b>  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JSJC201907020_063.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQwam9BWm83cU5adCswdFNtUXRBUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="p1">
                    <p id="64">为解决上述问题, 本文提出一种基于LCSD的协议状态相关字段识别算法。LCSD是基于最长公共子序列的一种距离, 对于一个序列<i>s</i>, 如果其分别是2个或多个已知序列的子序列, 且在所有符合此条件的序列中长度最长, 则称<i>s</i>为已知序列的最长公共子序列。最长公共子序列可以通过动态规划进行求解, 式 (3) 是LCSD的计算公式。</p>
                </div>
                <div class="p1">
                    <p id="65" class="code-formula">
                        <mathml id="65"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>d</mi><mo stretchy="false"> (</mo><msup><mi>s</mi><mo>′</mo></msup><msub><mrow></mrow><mrow><mi>i</mi><msub><mrow></mrow><mn>1</mn></msub><mi>j</mi></mrow></msub><mo>, </mo><msup><mi>s</mi><mo>′</mo></msup><msub><mrow></mrow><mrow><mi>i</mi><msub><mrow></mrow><mn>2</mn></msub><mi>j</mi></mrow></msub><mo stretchy="false">) </mo><mo>=</mo><mn>1</mn><mo>-</mo><mfrac><mrow><mrow><mo>|</mo><mrow><mi>L</mi><mi>C</mi><mi>S</mi><mo stretchy="false"> (</mo><msup><mi>s</mi><mo>′</mo></msup><msub><mrow></mrow><mrow><mi>i</mi><msub><mrow></mrow><mn>1</mn></msub><mi>j</mi></mrow></msub><mo>, </mo><msup><mi>s</mi><mo>′</mo></msup><msub><mrow></mrow><mrow><mi>i</mi><msub><mrow></mrow><mn>2</mn></msub><mi>j</mi></mrow></msub><mo stretchy="false">) </mo></mrow><mo>|</mo></mrow></mrow><mrow><mi>min</mi><mrow><mo> (</mo><mrow><mrow><mo>|</mo><mrow><msup><mi>s</mi><mo>′</mo></msup><msub><mrow></mrow><mrow><mi>i</mi><msub><mrow></mrow><mn>1</mn></msub><mi>j</mi></mrow></msub></mrow><mo>|</mo></mrow><mo>, </mo><mrow><mo>|</mo><mrow><msup><mi>s</mi><mo>′</mo></msup><msub><mrow></mrow><mrow><mi>i</mi><msub><mrow></mrow><mn>2</mn></msub><mi>j</mi></mrow></msub></mrow><mo>|</mo></mrow></mrow><mo>) </mo></mrow></mrow></mfrac><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mrow><mtext> </mtext><mtext> </mtext><mtext> </mtext></mrow><mo stretchy="false"> (</mo><mn>3</mn><mo stretchy="false">) </mo></mrow></math></mathml>
                    </p>
                </div>
                <div class="p1">
                    <p id="66">其中, <mathml id="67"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>d</mi><mrow><mo> (</mo><mrow><msup><mi>s</mi><mo>′</mo></msup><msub><mrow></mrow><mrow><mi>i</mi><msub><mrow></mrow><mn>1</mn></msub><mi>j</mi></mrow></msub><mo>, </mo><msup><mi>s</mi><mo>′</mo></msup><msub><mrow></mrow><mrow><mi>i</mi><msub><mrow></mrow><mn>2</mn></msub><mi>j</mi></mrow></msub></mrow><mo>) </mo></mrow></mrow></math></mathml>表示字段序列s′<sub>i<sub>1</sub>j</sub>和s′<sub>i<sub>2</sub>j</sub>之间的距离, <mathml id="68"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>L</mi><mi>C</mi><mi>S</mi><mrow><mo> (</mo><mrow><msup><mi>s</mi><mo>′</mo></msup><msub><mrow></mrow><mrow><mi>i</mi><msub><mrow></mrow><mn>1</mn></msub><mi>j</mi></mrow></msub><mo>, </mo><msup><mi>s</mi><mo>′</mo></msup><msub><mrow></mrow><mrow><mi>i</mi><msub><mrow></mrow><mn>2</mn></msub><mi>j</mi></mrow></msub></mrow><mo>) </mo></mrow></mrow></math></mathml>表示<i>s</i>′<sub><i>i</i><sub>1</sub><i>j</i></sub>和<i>s</i>′<sub><i>i</i><sub>2</sub><i>j</i></sub>的最长公共子序列, <mathml id="69"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mrow><mo>|</mo><mrow><mi>L</mi><mi>C</mi><mi>S</mi><mrow><mo> (</mo><mrow><msup><mi>s</mi><mo>′</mo></msup><msub><mrow></mrow><mrow><mi>i</mi><msub><mrow></mrow><mn>1</mn></msub><mi>j</mi></mrow></msub><mo>, </mo><msup><mi>s</mi><mo>′</mo></msup><msub><mrow></mrow><mrow><mi>i</mi><msub><mrow></mrow><mn>2</mn></msub><mi>j</mi></mrow></msub></mrow><mo>) </mo></mrow></mrow><mo>|</mo></mrow></mrow></math></mathml>表示最长公共子序列的长度, <mathml id="70"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mrow><mo>|</mo><mrow><msup><mi>s</mi><mo>′</mo></msup><msub><mrow></mrow><mrow><mi>i</mi><msub><mrow></mrow><mn>1</mn></msub><mi>j</mi></mrow></msub></mrow><mo>|</mo></mrow></mrow></math></mathml>和<mathml id="71"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mrow><mo>|</mo><mrow><msup><mi>s</mi><mo>′</mo></msup><msub><mrow></mrow><mrow><mi>i</mi><msub><mrow></mrow><mn>2</mn></msub><mi>j</mi></mrow></msub></mrow><mo>|</mo></mrow></mrow></math></mathml>分别表示s′<sub>i<sub>1</sub>j</sub>和s′<sub>i<sub>2</sub>j</sub>的长度。</p>
                </div>
                <div class="p1">
                    <p id="72">例如, 有状态相关字段序列<mathml id="73"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msup><mi>s</mi><mo>′</mo></msup><msub><mrow></mrow><mrow><mn>1</mn><mn>2</mn></mrow></msub><mo>=</mo><mrow><mo> (</mo><mrow><mn>1</mn><mo>, </mo><mn>2</mn><mo>, </mo><mn>3</mn><mo>, </mo><mn>4</mn><mo>, </mo><mn>5</mn><mo>, </mo><mn>6</mn></mrow><mo>) </mo></mrow></mrow></math></mathml>和<mathml id="74"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msup><mi>s</mi><mo>′</mo></msup><msub><mrow></mrow><mrow><mn>2</mn><mn>2</mn></mrow></msub><mo>=</mo><mrow><mo> (</mo><mrow><mn>1</mn><mo>, </mo><mn>2</mn><mo>, </mo><mn>3</mn><mo>, </mo><mn>4</mn><mo>, </mo><mn>6</mn><mo>, </mo><mn>5</mn></mrow><mo>) </mo></mrow><mo>, </mo><mi>L</mi><mi>C</mi><mi>S</mi><mrow><mo> (</mo><mrow><msup><mi>s</mi><mo>′</mo></msup><msub><mrow></mrow><mrow><mn>1</mn><mn>2</mn></mrow></msub><mo>, </mo><msup><mi>s</mi><mo>′</mo></msup><msub><mrow></mrow><mrow><mn>2</mn><mn>2</mn></mrow></msub></mrow><mo>) </mo></mrow><mo>=</mo><mrow><mo> (</mo><mrow><mn>1</mn><mo>, </mo><mn>2</mn><mo>, </mo><mn>3</mn><mo>, </mo><mn>4</mn><mo>, </mo><mn>5</mn></mrow><mo>) </mo></mrow><mo>, </mo><mrow><mi>d</mi><mo stretchy="false"> (</mo><msup><mi>s</mi><mo>′</mo></msup><msub><mrow></mrow><mrow><mn>1</mn><mn>2</mn></mrow></msub><mo>, </mo><msup><mi>s</mi><mo>′</mo></msup><msub><mrow></mrow><mrow><mn>2</mn><mn>2</mn></mrow></msub><mo stretchy="false">) </mo></mrow><mo>=</mo><mn>1</mn><mo>-</mo><mn>5</mn><mo>/</mo><mn>6</mn><mo>=</mo><mn>0</mn><mo>.</mo><mn>1</mn><mn>7</mn></mrow></math></mathml>, 因此, 序列<i>s</i>′<sub>12</sub>和<i>s</i>′<sub>22</sub>最长公共子序列距离为0.17。有序列<i>s</i>′<sub>12</sub>= (1, 2, 3, 4, 5, 6) 和序列<i>s</i>′<sub>32</sub>= (6, 5, 4, 3, 2, 1) , <i>LCS</i> (<i>s</i>′<sub>12</sub>, <i>s</i>′<sub>32</sub>) =∅, <i>d</i> (<i>s</i>′<sub>12</sub>, <i>s</i>′<sub>32</sub>) =1-0/6=1, 因此, 序列<i>s</i>′<sub>12</sub>和<i>s</i>′<sub>32</sub>最长公共子序列距离为1。由此可见, LCSD不仅能够刻画序列所包含元素的相似性, 同时能反映序列元素的顺序相似性, 即行为逻辑相似性。序列所包含的元素相似, 元素逻辑顺序也相似, 则LCSD较小。在会话集中, LCSD之和最小的字段序列为状态相关字段序列, LCSD之和的计算如式 (4) 所示。</p>
                </div>
                <div class="p1">
                    <p id="75" class="code-formula">
                        <mathml id="75"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>D</mi><msub><mrow></mrow><mi>j</mi></msub><mo>=</mo><mstyle displaystyle="true"><munder><mo>∑</mo><mrow><mtable><mtr><mtd><mi>i</mi><msub><mrow></mrow><mn>1</mn></msub><mo>, </mo><mi>i</mi><msub><mrow></mrow><mn>2</mn></msub><mo>∈</mo><mo stretchy="false"> (</mo><mn>1</mn><mo>, </mo><mrow><mo>|</mo><mi>S</mi><mo>|</mo></mrow><mo stretchy="false">) </mo><mo>, </mo><mi>i</mi><msub><mrow></mrow><mn>2</mn></msub><mo>&gt;</mo><mi>i</mi><msub><mrow></mrow><mn>1</mn></msub></mtd></mtr></mtable></mrow></munder><mi>d</mi></mstyle><mo stretchy="false"> (</mo><msup><mi>s</mi><mo>′</mo></msup><msub><mrow></mrow><mrow><mi>i</mi><msub><mrow></mrow><mn>1</mn></msub><mi>j</mi></mrow></msub><mo>, </mo><msup><mi>s</mi><mo>′</mo></msup><msub><mrow></mrow><mrow><mi>i</mi><msub><mrow></mrow><mn>2</mn></msub><mi>j</mi></mrow></msub><mo stretchy="false">) </mo><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mrow><mtext> </mtext><mtext> </mtext><mtext> </mtext></mrow><mo stretchy="false"> (</mo><mn>4</mn><mo stretchy="false">) </mo></mrow></math></mathml>
                    </p>
                </div>
                <div class="p1">
                    <p id="76">其中, <mathml id="77"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mrow><mo>|</mo><mi>S</mi><mo>|</mo></mrow></mrow></math></mathml>表示会话集中的会话数量, D<sub>j</sub>表示会话集中所有会话的第j个字段序列的<i>LCSD</i>之和。最小D<sub>j</sub>对应的字段为状态相关字段, 用f<sub>s</sub>来表示。</p>
                </div>
                <div class="p1">
                    <p id="78">基于<i>LCSD</i>进行状态相关字段识别的具体步骤如下:</p>
                </div>
                <div class="p1">
                    <p id="79"><b>步骤1</b> 获取同种协议的会话, 构造协议会话集<mathml id="80"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>S</mi><mo>=</mo><mrow><mo>{</mo><mrow><mi>s</mi><msub><mrow></mrow><mn>1</mn></msub><mo>, </mo><mi>s</mi><msub><mrow></mrow><mn>2</mn></msub><mo>, </mo><mo>⋯</mo><mo>, </mo><mi>s</mi><msub><mrow></mrow><mi>Ν</mi></msub></mrow><mo>}</mo></mrow></mrow></math></mathml>。</p>
                </div>
                <div class="p1">
                    <p id="81"><b>步骤2</b> 设置指针指向协议报文的第0个字段。</p>
                </div>
                <div class="p1">
                    <p id="82"><b>步骤3</b> 判断指针是否指向最后一个字段, 若是, 转到步骤5;否则, 指针指向下一个字段, 转到步骤4。</p>
                </div>
                <div class="p1">
                    <p id="83"><b>步骤4</b> 提取会话集中不同会话的第<i>j</i>个字段序列<mathml id="84"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mrow><mo>{</mo><mrow><mi>s</mi><msub><mrow></mrow><mrow><mn>1</mn><mi>j</mi></mrow></msub><mo>, </mo><mi>s</mi><msub><mrow></mrow><mrow><mn>2</mn><mi>j</mi></mrow></msub><mo>, </mo><mo>⋯</mo><mo>, </mo><mi>s</mi><msub><mrow></mrow><mrow><mo stretchy="false">|</mo><mi>S</mi><mo stretchy="false">|</mo><mi>j</mi></mrow></msub></mrow><mo>}</mo></mrow></mrow></math></mathml>, 计算<i>D</i><sub><i>j</i></sub>, 转到步骤3。</p>
                </div>
                <div class="p1">
                    <p id="85"><b>步骤5</b> 根据规则选取最小<i>D</i><sub><i>j</i></sub>对应的字段, 将其作为状态相关字段。</p>
                </div>
                <div class="p1">
                    <p id="86">识别出状态相关字段后, 将会话集中的所有会话用状态相关字段序列进行表示, 并作为初始状态机的输入, 如图2所示。</p>
                </div>
                <h4 class="anchor-tag" id="87" name="87">2.2 基于邻接表的初始状态机构建</h4>
                <div class="p1">
                    <p id="88">构建初始状态机的主流方法是构建APTA树, 然后接受所有状态相关字段序列并进行合并化简。该过程会导致初始构建的APTA树过于庞大, 需要大量的比较操作<citation id="212" type="reference"><link href="181" rel="bibliography" /><sup>[<a class="sup">10</a>]</sup></citation>。本文利用邻接表构建初始状态机, 省去APTA树的相关过程。假设协议会话用状态相关字段序列表示为:</p>
                </div>
                <div class="p1">
                    <p id="89">0001→0010→0011→0100→0101→0010</p>
                </div>
                <div class="p1">
                    <p id="90">初始协议状态邻接表如表1所示。状态0为起始状态, 没有对应的状态相关字段, 表示不存在一个状态在接受一个报文后能够转移到初始状态。输入状态相关字段序列的第1个值“0001”, 状态相关字段所在的列不存在“0001”, 因此, 添加“0001”到列表中, 同时添加状态1, 表示在接受到状态相关字段“0001”代表的报文后, 协议由之前的状态转移到状态1。在状态0对应的出度列中添加状态1, 表示状态0可以转移到状态1, 更新后的邻接表如表2所示。将整个状态相关字段序列输入到状态邻接表中, 结果如表3所示。最后一个值为“0010”, 已经在状态相关字段列中存在, 因此, 只需更新状态5的出度, 将状态2添加到状态5的出度列表中即可。</p>
                </div>
                <div class="area_img" id="91">
                    <p class="img_tit"><b>表1 初始协议状态邻接表</b> <a class="downexcel" onclick="DownLoadReportExcel(this)">导出到EXCEL</a></p>
                    <p class="img_tit"></p>
                    <p class="img_note"></p>
                    <table id="91" border="1"><tr><td><br />状态相关字段</td><td>状态</td><td>出度</td></tr><tr><td><br />—</td><td>0</td><td>—</td></tr></table>
                    <form name="form" action="/kxreader/Detail/DownloadReportExcel" method="POST" style="display:inline">
                        <input type="hidden" name="hidTable" value="" />
                        <input type="hidden" name="hidFileName" value="" />
                    </form>
                    <p class="img_note"></p>
                    <p class="img_note"></p>
                </div>
                <div class="area_img" id="92">
                    <p class="img_tit"><b>表2 协议状态邻接表1</b> <a class="downexcel" onclick="DownLoadReportExcel(this)">导出到EXCEL</a></p>
                    <p class="img_tit"></p>
                    <p class="img_note"></p>
                    <table id="92" border="1"><tr><td><br />状态相关字段</td><td>状态</td><td>出度</td></tr><tr><td><br />—</td><td>0</td><td>1</td></tr><tr><td><br />0001</td><td>1</td><td>—</td></tr></table>
                    <form name="form" action="/kxreader/Detail/DownloadReportExcel" method="POST" style="display:inline">
                        <input type="hidden" name="hidTable" value="" />
                        <input type="hidden" name="hidFileName" value="" />
                    </form>
                    <p class="img_note"></p>
                    <p class="img_note"></p>
                </div>
                <div class="area_img" id="93">
                    <p class="img_tit"><b>表3 协议状态邻接表2</b> <a class="downexcel" onclick="DownLoadReportExcel(this)">导出到EXCEL</a></p>
                    <p class="img_tit"></p>
                    <p class="img_note"></p>
                    <table id="93" border="1"><tr><td><br />状态相关字段</td><td>状态</td><td>出度</td></tr><tr><td><br />—</td><td>0</td><td>1</td></tr><tr><td><br />0001</td><td>1</td><td>2</td></tr><tr><td><br />0010</td><td>2</td><td>3</td></tr><tr><td><br />0011</td><td>3</td><td>4</td></tr><tr><td><br />0100</td><td>4</td><td>5</td></tr><tr><td><br />0101</td><td>5</td><td>2</td></tr></table>
                    <form name="form" action="/kxreader/Detail/DownloadReportExcel" method="POST" style="display:inline">
                        <input type="hidden" name="hidTable" value="" />
                        <input type="hidden" name="hidFileName" value="" />
                    </form>
                    <p class="img_note"></p>
                    <p class="img_note"></p>
                </div>
                <div class="p1">
                    <p id="94">协议状态机的终止状态往往不止一个, 为构建便于理解的协议状态机, 本文标识终止状态, 同时记录每个转移出现的次数, 最终构造概率协议状态机, 如表4所示。其中, 2 (T) 表示状态2可以作为终止状态, 1:1表示由状态0到状态1的转移出现了1次, 其余标识同上。将会话集中所有会话对应的状态相关字段序列添加到协议状态邻接表中, 当输入的状态相关字段已存在于状态邻接表中时, 只需更新出度列表;否则, 先添加新的状态再更新出度列表。</p>
                </div>
                <div class="area_img" id="95">
                    <p class="img_tit"><b>表4 协议状态邻接表3</b> <a class="downexcel" onclick="DownLoadReportExcel(this)">导出到EXCEL</a></p>
                    <p class="img_tit"></p>
                    <p class="img_note"></p>
                    <table id="95" border="1"><tr><td><br />状态相关字段</td><td>状态</td><td>出度</td></tr><tr><td><br />—</td><td>0</td><td>1:1</td></tr><tr><td><br />0001</td><td>1</td><td>2:1</td></tr><tr><td><br />0010</td><td>2 (T) </td><td>3:1</td></tr><tr><td><br />0011</td><td>3</td><td>4:1</td></tr><tr><td><br />0100</td><td>4</td><td>5:1</td></tr><tr><td><br />0101</td><td>5</td><td>2:1</td></tr></table>
                    <form name="form" action="/kxreader/Detail/DownloadReportExcel" method="POST" style="display:inline">
                        <input type="hidden" name="hidTable" value="" />
                        <input type="hidden" name="hidFileName" value="" />
                    </form>
                    <p class="img_note"></p>
                    <p class="img_note"></p>
                </div>
                <div class="p1">
                    <p id="96">由表4状态邻接表还原出的概率协议状态机如图4所示, 其中, 状态2可以作为终止状态, 用 2个同心圆表示, “50%”表示状态2有50%的概率成为终止状态, 转移弧线下方的百分比表示各出度的比例。例如, 状态1只有一个出度状态2, 该出度的概率如式 (5) 所示。</p>
                </div>
                <div class="p1">
                    <p id="97" class="code-formula">
                        <mathml id="97"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>p</mi><msub><mrow></mrow><mn>1</mn></msub><mo stretchy="false"> (</mo><mn>1</mn><mo>, </mo><mn>2</mn><mo stretchy="false">) </mo><mo>=</mo><mfrac><mrow><mi>n</mi><mo stretchy="false"> (</mo><mn>1</mn><mo>, </mo><mn>2</mn><mo stretchy="false">) </mo></mrow><mrow><mi>n</mi><mo stretchy="false"> (</mo><mn>1</mn><mo>, </mo><mo>:</mo><mo stretchy="false">) </mo></mrow></mfrac><mo>=</mo><mfrac><mrow><mi>n</mi><mo stretchy="false"> (</mo><mn>1</mn><mo>, </mo><mn>2</mn><mo stretchy="false">) </mo></mrow><mrow><mi>n</mi><mo stretchy="false"> (</mo><mn>1</mn><mo>, </mo><mn>2</mn><mo stretchy="false">) </mo></mrow></mfrac><mo>=</mo><mn>1</mn><mn>0</mn><mn>0</mn><mi>%</mi><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mrow><mtext> </mtext><mtext> </mtext><mtext> </mtext></mrow><mo stretchy="false"> (</mo><mn>5</mn><mo stretchy="false">) </mo></mrow></math></mathml>
                    </p>
                </div>
                <div class="p1">
                    <p id="98">其中, <i>p</i><sub>1</sub> (1, 2) 表示状态1的出度状态2出现的概率, <i>n</i> (1, 2) 表示状态1到状态2的转移出现的次数, <i>n</i> (1, :) 表示状态1的所有出度的总次数。</p>
                </div>
                <div class="area_img" id="99">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JSJC201907020_099.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQwam9BWm83cU5adCswdFNtUXRBUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图4 概率协议状态机示意图" src="Detail/GetImg?filename=images/JSJC201907020_099.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQwam9BWm83cU5adCswdFNtUXRBUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit"><b>图4 概率协议状态机示意图</b>  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JSJC201907020_099.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQwam9BWm83cU5adCswdFNtUXRBUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <h4 class="anchor-tag" id="100" name="100">2.3 协议状态机化简</h4>
                <h4 class="anchor-tag" id="101" name="101">2.3.1 基于概率统计的异常会话去除</h4>
                <div class="p1">
                    <p id="102">在真实环境中, 用户操作失误或者传输环境变化通常会导致不完整或错误会话的出现, 本文将其统称为异常会话。包含小概率转移的会话为异常会话, 异常会话在整个数据集中比例较小。利用含有异常会话的数据集推断的协议状态机会存在错误。本文统计各个转移出现的概率, 发现概率小的转移后定位转移所在的会话, 将该会话剔除, 然后在不包含异常会话的协议数据集上重新构建状态邻接表。</p>
                </div>
                <div class="p1">
                    <p id="103">表5所示为当前构建的状态邻接表, 输入状态相关字段序列0001→0011→0100→0101后, 状态邻接表如表6所示。其中, 状态1有2个出度, 分别为状态2和状态3, 状态1到状态3的概率如式 (6) 所示, 状态1到状态2的概率如式 (7) 所示。状态1到状态3的概率仅为1%, 为小概率事件, 设置阈值<i>θ</i><sub>th</sub>, 当转移概率小于<i>θ</i><sub>th</sub>时, 对应转移为异常转移, 对应会话为异常会话。如果直接删除异常转移, 不做其他处理, 则异常会话的剩余部分仍然存在于状态邻接表中。为彻底消除异常会话的影响, 本文在确定异常转移与异常会话后, 将所有的异常会话从原始数据集中进行消除, 再对剩余的会话重新构建新的状态邻接表。</p>
                </div>
                <div class="area_img" id="104">
                    <p class="img_tit"><b>表5 协议状态邻接表4</b> <a class="downexcel" onclick="DownLoadReportExcel(this)">导出到EXCEL</a></p>
                    <p class="img_tit"></p>
                    <p class="img_note"></p>
                    <table id="104" border="1"><tr><td><br />状态相关字段</td><td>状态</td><td>出度</td></tr><tr><td><br />—</td><td>0</td><td>1:100</td></tr><tr><td><br />0001</td><td>1</td><td>2:100</td></tr><tr><td><br />0010</td><td>2</td><td>3:100</td></tr><tr><td><br />0011</td><td>3</td><td>4:100</td></tr><tr><td><br />0100</td><td>4</td><td>5:100</td></tr><tr><td><br />0101</td><td>5 (T) </td><td>—</td></tr></table>
                    <form name="form" action="/kxreader/Detail/DownloadReportExcel" method="POST" style="display:inline">
                        <input type="hidden" name="hidTable" value="" />
                        <input type="hidden" name="hidFileName" value="" />
                    </form>
                    <p class="img_note"></p>
                    <p class="img_note"></p>
                </div>
                <div class="area_img" id="105">
                    <p class="img_tit"><b>表6 协议状态邻接表5</b> <a class="downexcel" onclick="DownLoadReportExcel(this)">导出到EXCEL</a></p>
                    <p class="img_tit"></p>
                    <p class="img_note"></p>
                    <table id="105" border="1"><tr><td><br />状态相关字段</td><td>状态</td><td>出度</td></tr><tr><td><br />—</td><td>0</td><td>1:101</td></tr><tr><td><br />0001</td><td>1</td><td>2:100, 3:1</td></tr><tr><td><br />0010</td><td>2</td><td>3:100</td></tr><tr><td><br />0011</td><td>3</td><td>4:101</td></tr><tr><td><br />0100</td><td>4</td><td>5:101</td></tr><tr><td><br />0101</td><td>5 (T) </td><td>—</td></tr></table>
                    <form name="form" action="/kxreader/Detail/DownloadReportExcel" method="POST" style="display:inline">
                        <input type="hidden" name="hidTable" value="" />
                        <input type="hidden" name="hidFileName" value="" />
                    </form>
                    <p class="img_note"></p>
                    <p class="img_note"></p>
                </div>
                <div class="p1">
                    <p id="106" class="code-formula">
                        <mathml id="106"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtable columnalign="left"><mtr><mtd><mi>p</mi><msub><mrow></mrow><mn>1</mn></msub><mo stretchy="false"> (</mo><mn>1</mn><mo>, </mo><mn>3</mn><mo stretchy="false">) </mo><mo>=</mo><mfrac><mrow><mi>n</mi><mo stretchy="false"> (</mo><mn>1</mn><mo>, </mo><mn>3</mn><mo stretchy="false">) </mo></mrow><mrow><mi>n</mi><mo stretchy="false"> (</mo><mn>1</mn><mo>, </mo><mo>:</mo><mo stretchy="false">) </mo></mrow></mfrac><mo>=</mo><mfrac><mrow><mi>n</mi><mo stretchy="false"> (</mo><mn>1</mn><mo>, </mo><mn>3</mn><mo stretchy="false">) </mo></mrow><mrow><mi>n</mi><mo stretchy="false"> (</mo><mn>1</mn><mo>, </mo><mn>3</mn><mo stretchy="false">) </mo><mo>+</mo><mi>n</mi><mo stretchy="false"> (</mo><mn>1</mn><mo>, </mo><mn>2</mn><mo stretchy="false">) </mo></mrow></mfrac><mo>=</mo><mn>1</mn><mi>%</mi><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mrow><mtext> </mtext><mtext> </mtext><mtext> </mtext></mrow><mo stretchy="false"> (</mo><mn>6</mn><mo stretchy="false">) </mo></mtd></mtr><mtr><mtd><mi>p</mi><msub><mrow></mrow><mn>2</mn></msub><mo stretchy="false"> (</mo><mn>1</mn><mo>, </mo><mn>2</mn><mo stretchy="false">) </mo><mo>=</mo><mfrac><mrow><mi>n</mi><mo stretchy="false"> (</mo><mn>1</mn><mo>, </mo><mn>2</mn><mo stretchy="false">) </mo></mrow><mrow><mi>n</mi><mo stretchy="false"> (</mo><mn>1</mn><mo>, </mo><mo>:</mo><mo stretchy="false">) </mo></mrow></mfrac><mo>=</mo><mfrac><mrow><mi>n</mi><mo stretchy="false"> (</mo><mn>1</mn><mo>, </mo><mn>2</mn><mo stretchy="false">) </mo></mrow><mrow><mi>n</mi><mo stretchy="false"> (</mo><mn>1</mn><mo>, </mo><mn>3</mn><mo stretchy="false">) </mo><mo>+</mo><mi>n</mi><mo stretchy="false"> (</mo><mn>1</mn><mo>, </mo><mn>2</mn><mo stretchy="false">) </mo></mrow></mfrac><mo>=</mo><mn>9</mn><mn>9</mn><mi>%</mi><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mrow><mtext> </mtext><mtext> </mtext><mtext> </mtext></mrow><mo stretchy="false"> (</mo><mn>7</mn><mo stretchy="false">) </mo></mtd></mtr></mtable></math></mathml>
                    </p>
                </div>
                <h4 class="anchor-tag" id="107" name="107">2.3.2 基于出度、入度的相似状态合并</h4>
                <div class="p1">
                    <p id="108">经过前文的处理, 协议状态邻接表中不存在相同的协议状态相关字段。虽然没有相同的状态, 但可能存在相似的状态。为最大限度地化简状态机, 需要将相似状态进行合并。协议状态之间存在2种关系:顺序和并列, 如图5所示。顺序关系指状态之间存在先后顺序, 例如状态1在状态0后, 两者是顺序关系。并列关系指状态之间没有先后顺序, 例如在状态2之后状态3～状态5都有可能出现, 状态3～状态5之间没有先后顺序, 属于并列关系。具有并列关系的状态属于相似状态, 可以合并, 图6所示为合并图5中相似状态后的状态机。</p>
                </div>
                <div class="area_img" id="109">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JSJC201907020_109.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQwam9BWm83cU5adCswdFNtUXRBUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图5 存在相似状态的协议状态机示意图" src="Detail/GetImg?filename=images/JSJC201907020_109.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQwam9BWm83cU5adCswdFNtUXRBUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit"><b>图5 存在相似状态的协议状态机示意图</b>  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JSJC201907020_109.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQwam9BWm83cU5adCswdFNtUXRBUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="area_img" id="110">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JSJC201907020_110.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQwam9BWm83cU5adCswdFNtUXRBUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图6 合并相似状态后的协议状态机示意图" src="Detail/GetImg?filename=images/JSJC201907020_110.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQwam9BWm83cU5adCswdFNtUXRBUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit"><b>图6 合并相似状态后的协议状态机示意图</b>  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JSJC201907020_110.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQwam9BWm83cU5adCswdFNtUXRBUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="p1">
                    <p id="111">相似状态在状态邻接表中表现为入度和出度均相同。表7所示为一个协议状态邻接表, 各状态相应的出度、入度如表8所示。状态3～状态5的入度均为状态2, 出度均为状态6, 因此, 状态3～状态5为相似状态, 可以合并。合并后的状态邻接表如表9所示, 状态3～状态5合并为状态3, 状态相关字段合并到状态3的相关字段, 包含状态4和状态5的出度列表统一更新为状态3, 并对相同出度对应的次数进行合并。</p>
                </div>
                <div class="area_img" id="112">
                    <p class="img_tit"><b>表7 协议状态邻接表6</b> <a class="downexcel" onclick="DownLoadReportExcel(this)">导出到EXCEL</a></p>
                    <p class="img_tit"></p>
                    <p class="img_note"></p>
                    <table id="112" border="1"><tr><td><br />状态相关字段</td><td>状态</td><td>出度</td></tr><tr><td><br />—</td><td>0</td><td>1:100</td></tr><tr><td><br />0001</td><td>1</td><td>2:100</td></tr><tr><td><br />0010</td><td>2</td><td>3:100, 4:100, 5:100</td></tr><tr><td><br />0011</td><td>3</td><td>6:100</td></tr><tr><td><br />0100</td><td>4</td><td>6:100</td></tr><tr><td><br />0101</td><td>5</td><td>6:100</td></tr><tr><td><br />0110</td><td>6</td><td>7:100</td></tr><tr><td><br />0111</td><td>7 (T) </td><td>—</td></tr></table>
                    <form name="form" action="/kxreader/Detail/DownloadReportExcel" method="POST" style="display:inline">
                        <input type="hidden" name="hidTable" value="" />
                        <input type="hidden" name="hidFileName" value="" />
                    </form>
                    <p class="img_note"></p>
                    <p class="img_note"></p>
                </div>
                <div class="area_img" id="113">
                    <p class="img_tit"><b>表8 协议状态的入度、出度信息</b> <a class="downexcel" onclick="DownLoadReportExcel(this)">导出到EXCEL</a></p>
                    <p class="img_tit"></p>
                    <p class="img_note"></p>
                    <table id="113" border="1"><tr><td><br />状态</td><td>入度</td><td>出度</td></tr><tr><td><br />0</td><td>—</td><td>1</td></tr><tr><td><br />1</td><td>0</td><td>2</td></tr><tr><td><br />2</td><td>1</td><td>3, 4, 5</td></tr><tr><td><br />3</td><td>2</td><td>6</td></tr><tr><td><br />4</td><td>2</td><td>6</td></tr><tr><td><br />5</td><td>2</td><td>6</td></tr><tr><td><br />6</td><td>3, 4, 5</td><td>7</td></tr><tr><td><br />7 (T) </td><td>6</td><td>—</td></tr></table>
                    <form name="form" action="/kxreader/Detail/DownloadReportExcel" method="POST" style="display:inline">
                        <input type="hidden" name="hidTable" value="" />
                        <input type="hidden" name="hidFileName" value="" />
                    </form>
                    <p class="img_note"></p>
                    <p class="img_note"></p>
                </div>
                <div class="area_img" id="114">
                    <p class="img_tit"><b>表9 协议状态邻接表7</b> <a class="downexcel" onclick="DownLoadReportExcel(this)">导出到EXCEL</a></p>
                    <p class="img_tit"></p>
                    <p class="img_note"></p>
                    <table id="114" border="1"><tr><td><br />状态相关字段</td><td>状态</td><td>出度</td></tr><tr><td><br />—</td><td>0</td><td>1:100</td></tr><tr><td><br />0001</td><td>1</td><td>2:100</td></tr><tr><td><br />0010</td><td>2</td><td>3:300</td></tr><tr><td><br />0011/0100/0101</td><td>3</td><td>6:300</td></tr><tr><td><br />0110</td><td>6</td><td>7:100</td></tr><tr><td><br />0111</td><td>7 (T) </td><td>—</td></tr></table>
                    <form name="form" action="/kxreader/Detail/DownloadReportExcel" method="POST" style="display:inline">
                        <input type="hidden" name="hidTable" value="" />
                        <input type="hidden" name="hidFileName" value="" />
                    </form>
                    <p class="img_note"></p>
                    <p class="img_note"></p>
                </div>
                <div class="p1">
                    <p id="115">基于概率统计的异常会话去除和基于出度、入度的相似状态合并, 可以分别看作从原数据集和初始状态机2个方面对协议状态机进行化简。</p>
                </div>
                <h3 id="116" name="116" class="anchor-tag">3 实验结果与分析</h3>
                <div class="p1">
                    <p id="117">为验证BSMISRF算法对二进制协议状态机推断的有效性, 选取TCP协议和SMB协议进行协议状态机推断。实验环境为一台PC (CPU i7-4720HQ, 内存8 GB) , 操作系统为Windows 7, 利用Python编程语言进行程序编写测试。通过Wireshark软件在校园骨干网上采集数据包, 再通过五元组实现TCP协议会话分割, 获取TCP协议会话集。在PC上设置共享文件夹, 在手持客户端上安装文件共享软件, 通过文件共享软件对共享文件夹进行操作, 如文件创建、删除等, 利用Wireshark软件采集操作过程中产生的SMB协议数据包, 再通过五元组实现SMB协议会话分割, 获取SMB协议会话集。实验中使用的训练数据集和测试数据集信息如表10、表11所示。</p>
                </div>
                <div class="area_img" id="118">
                    <p class="img_tit"><b>表10 训练数据集信息</b> <a class="downexcel" onclick="DownLoadReportExcel(this)">导出到EXCEL</a></p>
                    <p class="img_tit"></p>
                    <p class="img_note"></p>
                    <table id="118" border="1"><tr><td>协议</td><td>报文数量</td><td>会话数量</td><td>大小/MB</td></tr><tr><td><br />TCP</td><td>1 103</td><td>100</td><td>0.228</td></tr><tr><td><br />SMB</td><td>7 012</td><td>109</td><td>1.710</td></tr></table>
                    <form name="form" action="/kxreader/Detail/DownloadReportExcel" method="POST" style="display:inline">
                        <input type="hidden" name="hidTable" value="" />
                        <input type="hidden" name="hidFileName" value="" />
                    </form>
                    <p class="img_note"></p>
                    <p class="img_note"></p>
                </div>
                <div class="area_img" id="119">
                    <p class="img_tit"><b>表11 测试数据集信息</b> <a class="downexcel" onclick="DownLoadReportExcel(this)">导出到EXCEL</a></p>
                    <p class="img_tit"></p>
                    <p class="img_note"></p>
                    <table id="119" border="1"><tr><td>协议</td><td>报文数量</td><td>会话数量</td><td>大小/MB</td></tr><tr><td><br />TCP</td><td>1 971</td><td>200</td><td>0.438</td></tr><tr><td><br />SMB</td><td>6 066</td><td>100</td><td>1.470</td></tr></table>
                    <form name="form" action="/kxreader/Detail/DownloadReportExcel" method="POST" style="display:inline">
                        <input type="hidden" name="hidTable" value="" />
                        <input type="hidden" name="hidFileName" value="" />
                    </form>
                    <p class="img_note"></p>
                    <p class="img_note"></p>
                </div>
                <div class="p1">
                    <p id="120">在实验过程中, 仅涉及一个参数<i>θ</i><sub>th</sub>, 本文设定<i>θ</i><sub>th</sub>为0.01。评价指标采用协议逆向工程中常用的准确率和召回率, 如式 (8) 、式 (9) 所示。</p>
                </div>
                <div class="p1">
                    <p id="121" class="code-formula">
                        <mathml id="121"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtable columnalign="left"><mtr><mtd><mi>p</mi><mi>r</mi><mi>e</mi><mi>c</mi><mi>i</mi><mi>s</mi><mi>i</mi><mi>o</mi><mi>n</mi><msub><mrow></mrow><mi>p</mi></msub><mo>=</mo><mfrac><mrow><mi>n</mi><msubsup><mrow></mrow><mi>p</mi><mi>t</mi></msubsup></mrow><mrow><mi>n</mi><msub><mrow></mrow><mi>p</mi></msub></mrow></mfrac><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mrow><mtext> </mtext><mtext> </mtext><mtext> </mtext></mrow><mo stretchy="false"> (</mo><mn>8</mn><mo stretchy="false">) </mo></mtd></mtr><mtr><mtd><mi>r</mi><mi>e</mi><mi>c</mi><mi>a</mi><mi>l</mi><mi>l</mi><msub><mrow></mrow><mi>p</mi></msub><mo>=</mo><mfrac><mrow><mi>n</mi><msubsup><mrow></mrow><mi>p</mi><mi>t</mi></msubsup></mrow><mrow><mi>n</mi><msup><mrow></mrow><mi>p</mi></msup></mrow></mfrac><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mrow><mtext> </mtext><mtext> </mtext><mtext> </mtext></mrow><mo stretchy="false"> (</mo><mn>9</mn><mo stretchy="false">) </mo></mtd></mtr></mtable></math></mathml>
                    </p>
                </div>
                <div class="p1">
                    <p id="122">其中, <i>precision</i><sub><i>p</i></sub>和<i>recall</i><sub><i>p</i></sub>分别表示协议<i>p</i>的准确率和召回率, <i>n</i><sub><i>p</i></sub>表示测试集数据被识别为协议<i>p</i>的会话数, <i>n</i><sup><i>p</i></sup>表示测试集数据中真正属于协议<i>p</i>的会话数, <i>n</i><mathml id="123"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msubsup><mrow></mrow><mi>p</mi><mi>t</mi></msubsup></mrow></math></mathml>表示被识别为协议p且真正属于协议p的会话数。</p>
                </div>
                <h4 class="anchor-tag" id="124" name="124">3.1 协议状态机推断结果</h4>
                <div class="p1">
                    <p id="125">由BSMISRF算法推断的TCP和SMB协议状态机分别如图7、图8所示。在TCP协议状态机中, 路径0→1→2→3表示协议中3次握手建立连接的过程, 4→5→3→5→3和3→5→3→5→3均为TCP协议4次挥手关闭连接的过程。SMB协议状态相关字段对应的命令码如表12所示, 路径0→1→2→3表示SMB协议的会话建立过程。</p>
                </div>
                <div class="area_img" id="126">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JSJC201907020_126.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQwam9BWm83cU5adCswdFNtUXRBUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图7 TCP协议状态机" src="Detail/GetImg?filename=images/JSJC201907020_126.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQwam9BWm83cU5adCswdFNtUXRBUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit"><b>图7 TCP协议状态机</b>  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JSJC201907020_126.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQwam9BWm83cU5adCswdFNtUXRBUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="area_img" id="127">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JSJC201907020_127.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQwam9BWm83cU5adCswdFNtUXRBUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图8 SMB协议状态机" src="Detail/GetImg?filename=images/JSJC201907020_127.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQwam9BWm83cU5adCswdFNtUXRBUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit"><b>图8 SMB协议状态机</b>  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JSJC201907020_127.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQwam9BWm83cU5adCswdFNtUXRBUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="area_img" id="128">
                    <p class="img_tit"><b>表12 SMB协议命令码</b> <a class="downexcel" onclick="DownLoadReportExcel(this)">导出到EXCEL</a></p>
                    <p class="img_tit"></p>
                    <p class="img_note"></p>
                    <table id="128" border="1"><tr><td><br />符号</td><td>状态相关字段</td><td>Command字段</td></tr><tr><td><br /><i>a</i><sub>1</sub></td><td>72</td><td>NEGOTIATE</td></tr><tr><td><br /><i>a</i><sub>2</sub></td><td>73</td><td>SESSION SETUP ANDX</td></tr><tr><td><br /><i>a</i><sub>3</sub></td><td>75</td><td>TREE CONNECT ANDX</td></tr><tr><td><br /><i>a</i><sub>4</sub></td><td><i>a</i>2</td><td>NT CREATE ANDX</td></tr><tr><td><br /><i>a</i><sub>5</sub></td><td>25</td><td>TRANSACTION</td></tr><tr><td><br /><i>a</i><sub>6</sub></td><td>04</td><td>CLOSE</td></tr><tr><td><br /><i>a</i><sub>7</sub></td><td>32</td><td>TRANSACTION2</td></tr><tr><td><br /><i>a</i><sub>8</sub></td><td>34</td><td>FIND CLOSE2</td></tr><tr><td><br /><i>a</i><sub>9</sub></td><td>71</td><td>TREE DISCONNECT</td></tr><tr><td><br /><i>a</i><sub>10</sub></td><td>2<i>e</i></td><td>READ ANDX</td></tr><tr><td><br /><i>a</i><sub>11</sub></td><td>74</td><td>LOGOFF ANDX</td></tr><tr><td><br /><i>a</i><sub>12</sub></td><td>06</td><td>DELETE</td></tr><tr><td><br /><i>a</i><sub>13</sub></td><td>07</td><td>RENAME</td></tr><tr><td><br /><i>a</i><sub>14</sub></td><td>2<i>f</i></td><td>WRITE ANDX</td></tr><tr><td><br /><i>a</i><sub>15</sub></td><td>00</td><td>CREATE DIRECTORY</td></tr><tr><td><br /><i>a</i><sub>16</sub></td><td>01</td><td>DELETE DIRECTORY</td></tr></table>
                    <form name="form" action="/kxreader/Detail/DownloadReportExcel" method="POST" style="display:inline">
                        <input type="hidden" name="hidTable" value="" />
                        <input type="hidden" name="hidFileName" value="" />
                    </form>
                    <p class="img_note"></p>
                    <p class="img_note"></p>
                </div>
                <h4 class="anchor-tag" id="129" name="129">3.2 VDV算法与LCSD算法性能比较</h4>
                <div class="p1">
                    <p id="130">VDV算法和LCSD算法均是状态相关字段选取算法, 前者只能刻画序列元素的相似性, 后者既能体现序列元素的相似性, 又能反映序列元素行为逻辑的相似性。图9、图10所示分别为TCP协议和SMB协议的状态相关字节/段选取结果。其中, 纵坐标中的“log”表示对纵坐标值取以e为底的对数。VDV算法以<i>VDV</i>最小取值对应字节为协议状态相关字节 (<i>VDV</i>取值为0的是不可变字节) 。LCSD算法以<i>D</i>最小取值对应字段为协议状态相关字段 (<i>D</i>取值为0的是不可变字段) 。对于TCP协议, 能够表示协议状态的是6位控制代码:URG, ACK, PSH, RST, SYN, FIN, 在TCP协议报文的第14个字节第7个字段。VDV和LCSD均能找到TCP协议的状态相关字节/段, 如图9 (a) 和9 (b) 。对于SMB协议, 能够表示协议状态的是Command字段, 在SMB协议报文的第5个字节第2个字段。VDV算法无法找到SMB协议的状态字节, 如图10 (a) , LCSD算法能够找到SMB协议的状态相关字段, 如图10 (b) 。</p>
                </div>
                <div class="area_img" id="132">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JSJC201907020_132.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQwam9BWm83cU5adCswdFNtUXRBUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图9 TCP协议状态相关字段选取结果" src="Detail/GetImg?filename=images/JSJC201907020_132.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQwam9BWm83cU5adCswdFNtUXRBUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit"><b>图9 TCP协议状态相关字段选取结果</b>  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JSJC201907020_132.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQwam9BWm83cU5adCswdFNtUXRBUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="area_img" id="133">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JSJC201907020_133.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQwam9BWm83cU5adCswdFNtUXRBUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图10 SMB协议状态相关字段选取结果" src="Detail/GetImg?filename=images/JSJC201907020_133.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQwam9BWm83cU5adCswdFNtUXRBUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit"><b>图10 SMB协议状态相关字段选取结果</b>  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JSJC201907020_133.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQwam9BWm83cU5adCswdFNtUXRBUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <h4 class="anchor-tag" id="134" name="134">3.3 化简前后的协议状态机规模比较</h4>
                <div class="p1">
                    <p id="135">本文基于概率统计进行异常会话去除, 基于出度、入度实现相似状态合并, 以对初始状态机进行化简。化简前后的状态机规模如表13、表14所示。其中, <i>NS</i><sub>TCP</sub>和<i>NS</i><sub>SMB</sub>分别表示TCP和SMB协议的初始状态机, <i>S</i><sub>TCP</sub>和<i>S</i><sub>SMB</sub>分别表示TCP和SMB协议的最终状态机。TCP协议数据集中不包含相似状态, 但存在异常会话, 因此, 状态数和终止状态数没有变化, 只有状态转移数得到了约简。SMB协议数据集中存在相似状态, 也存在异常会话, 因此, 状态数、状态转移数以及终止状态数均得到了约简。2种协议的约简比例如图11所示。</p>
                </div>
                <div class="area_img" id="136">
                    <p class="img_tit"><b>表13 TCP协议状态机规模统计</b> <a class="downexcel" onclick="DownLoadReportExcel(this)">导出到EXCEL</a></p>
                    <p class="img_tit"></p>
                    <p class="img_note"></p>
                    <table id="136" border="1"><tr><td>协议状态机</td><td>状态数</td><td>状态转移数</td><td>终止状态数</td></tr><tr><td><br /><i>NS</i><sub>TCP</sub></td><td>6</td><td>12</td><td>1</td></tr><tr><td><br /><i>S</i><sub>TCP</sub></td><td>6</td><td>10</td><td>1</td></tr></table>
                    <form name="form" action="/kxreader/Detail/DownloadReportExcel" method="POST" style="display:inline">
                        <input type="hidden" name="hidTable" value="" />
                        <input type="hidden" name="hidFileName" value="" />
                    </form>
                    <p class="img_note"></p>
                    <p class="img_note"></p>
                </div>
                <div class="area_img" id="137">
                    <p class="img_tit"><b>表14 SMB协议状态机规模统计</b> <a class="downexcel" onclick="DownLoadReportExcel(this)">导出到EXCEL</a></p>
                    <p class="img_tit"></p>
                    <p class="img_note"></p>
                    <table id="137" border="1"><tr><td>协议状态机</td><td>状态数</td><td>状态转移数</td><td>终止状态数</td></tr><tr><td><br /><i>NS</i><sub>SMB</sub></td><td>17</td><td>62</td><td>5</td></tr><tr><td><br /><i>S</i><sub>SMB</sub></td><td>12</td><td>39</td><td>3</td></tr></table>
                    <form name="form" action="/kxreader/Detail/DownloadReportExcel" method="POST" style="display:inline">
                        <input type="hidden" name="hidTable" value="" />
                        <input type="hidden" name="hidFileName" value="" />
                    </form>
                    <p class="img_note"></p>
                    <p class="img_note"></p>
                </div>
                <div class="area_img" id="138">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JSJC201907020_138.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQwam9BWm83cU5adCswdFNtUXRBUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图11 2种协议的约简比例" src="Detail/GetImg?filename=images/JSJC201907020_138.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQwam9BWm83cU5adCswdFNtUXRBUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit"><b>图11 2种协议的约简比例</b>  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JSJC201907020_138.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQwam9BWm83cU5adCswdFNtUXRBUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <h4 class="anchor-tag" id="139" name="139">3.4 协议状态机性能评估</h4>
                <div class="p1">
                    <p id="140">将TCP协议和SMB协议的混合会话集作为测试数据集, 如表11所示, 利用推断的TCP协议状态机和SMB协议状态机分别对测试数据集中的会话进行识别, 准确率和召回率结果分别如表15、表16所示。由表15、表16可以看出, 本文协议状态机对测试数据集有较好的识别效果, 与真实协议状态机接近。</p>
                </div>
                <div class="area_img" id="141">
                    <p class="img_tit"><b>表15 准确率统计结果</b> <a class="downexcel" onclick="DownLoadReportExcel(this)">导出到EXCEL</a></p>
                    <p class="img_tit"></p>
                    <p class="img_note"></p>
                    <table id="141" border="1"><tr><td>协议状态机</td><td>识别的会话数</td><td>正确的会话数</td><td>准确率/%</td></tr><tr><td><i>S</i><sub>TCP</sub></td><td>198</td><td>198</td><td>100</td></tr><tr><td><br /><i>S</i><sub>SMB</sub></td><td>90</td><td>90</td><td>100</td></tr></table>
                    <form name="form" action="/kxreader/Detail/DownloadReportExcel" method="POST" style="display:inline">
                        <input type="hidden" name="hidTable" value="" />
                        <input type="hidden" name="hidFileName" value="" />
                    </form>
                    <p class="img_note"></p>
                    <p class="img_note"></p>
                </div>
                <div class="area_img" id="142">
                    <p class="img_tit"><b>表16 召回率统计结果</b> <a class="downexcel" onclick="DownLoadReportExcel(this)">导出到EXCEL</a></p>
                    <p class="img_tit"></p>
                    <p class="img_note"></p>
                    <table id="142" border="1"><tr><td>协议状态机</td><td>真实的会话数</td><td>正确的会话数</td><td>召回率/%</td></tr><tr><td><i>S</i><sub>TCP</sub></td><td>200</td><td>198</td><td>99</td></tr><tr><td><br /><i>S</i><sub>SMB</sub></td><td>100</td><td>90</td><td>90</td></tr></table>
                    <form name="form" action="/kxreader/Detail/DownloadReportExcel" method="POST" style="display:inline">
                        <input type="hidden" name="hidTable" value="" />
                        <input type="hidden" name="hidFileName" value="" />
                    </form>
                    <p class="img_note"></p>
                    <p class="img_note"></p>
                </div>
                <h3 id="143" name="143" class="anchor-tag">4 结束语</h3>
                <div class="p1">
                    <p id="144">本文提出一种基于状态相关字段的二进制私有协议状态机推断方法BSMISRF。在TCP协议和SMB协议数据集上进行测试, 结果验证了该方法良好的识别性能。在实际应用中, BSMISRF方法对字段划分的准确度要求较高, 因此, 对二进制协议字段格式提取进行分析并获取高准确度的字段划分结果, 将是下一步的研究方向。</p>
                </div>

        <!--brief end-->
        
        <!--conten left  end-->
        <!--增强附件-->
        

        <!--reference start-->
            <div class="reference anchor-tag" id="a_bibliography">
                    <h3>参考文献</h3>
                                        <p id="163">
                            <a id="bibliography_1" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CBBD&amp;filename=9787118105742000&amp;v=MTU1NjF0RE1xb2hCWnVzUERCTTh6eFVTbURkOVNIN24zeEU5ZmJ2bktyaWZadTl1RkN2aVVML0lKbHNkWEZxekdiSzVG&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQwam9BWm83cU5adCswdFNtUXRBUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[1]</b> 吴礼发, 洪征, 潘璠.网络协议逆向分析及应用[M].北京:国防工业出版社, 2016.
                            </a>
                        </p>
                        <p id="165">
                            <a id="bibliography_2" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JSYJ201507004&amp;v=MjgwNjFyQ1VSTE9lWmVScEZDamxWYnJCTHo3U1pMRzRIOVRNcUk5RllJUUtESDg0dlI0VDZqNTRPM3pxcUJ0R0Y=&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQwam9BWm83cU5adCswdFNtUXRBUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[2]</b> 吴礼发, 王辰, 洪征, 等.协议状态机推断技术研究进展[J].计算机应用研究, 2015, 32 (7) :1931-1936.
                            </a>
                        </p>
                        <p id="167">
                            <a id="bibliography_3" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CMFD&amp;filename=1016774368.nh&amp;v=MDQyMDM2R0xTL0d0TEtwNUViUElRS0RIODR2UjRUNmo1NE8zenFxQnRHRnJDVVJMT2VaZVJwRkNqbFZickJWRjI=&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQwam9BWm83cU5adCswdFNtUXRBUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[3]</b> 王军.基于EDSM的二进制协议状态机逆向[D].哈尔滨:哈尔滨工业大学, 2016.
                            </a>
                        </p>
                        <p id="169">
                            <a id="bibliography_4" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Traffic to protocol reverse engineering">

                                <b>[4]</b> TRIFILO A, BURSCHKA S, BIERSACK E.Traffic to protocol reverse engineering[C]//Proceedings of IEEE International Conference on Computational Intelligence for Security and Defense Applications.Washington D.C., USA:IEEE Press, 2009:1-8.
                            </a>
                        </p>
                        <p id="171">
                            <a id="bibliography_5" target="_blank" href="http://scholar.cnki.net/result.aspx?q=A reverse engineering tool for extracting protocols of networked applications">

                                <b>[5]</b> SHEVERTALOV M, MANCORIDIS S.A reverse engi-neering tool for extracting protocols of networked applications[C]//Proceedings of the 14th Working Conference on Reverse Engineering.Washington D.C., USA:IEEE Press, 2007:229-238.
                            </a>
                        </p>
                        <p id="173">
                            <a id="bibliography_6" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Inferring protocol state machine from network traces:a probabilistic approach">

                                <b>[6]</b> WANG Yipeng, ZHANG Zhibin, YAO Danfeng, et al.Inferring protocol state machine from network traces:a probabilistic approach[C]//Proceedings of International Conference on Applied Cryptography and Network Security.Berlin, Germany:Springer, 2011:1-18.
                            </a>
                        </p>
                        <p id="175">
                            <a id="bibliography_7" target="_blank" href="/kcms/detail/detail.aspx?dbcode=STJD&amp;filename=STJD792192766&amp;v=MjI5OThRS0RIODR2UjRUNmo1NE8zenFxQnRHRnJDVVJMT2VaZVJwRkNqbFZickJOam5CYXJTeEhOREZyWWhEWW8=&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQwam9BWm83cU5adCswdFNtUXRBUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[7]</b> DUNN J C.Well-separated clusters and optimal fuzzy partitions[J].Journal of Cybernetics, 1974, 4 (1) :95-104.
                            </a>
                        </p>
                        <p id="177">
                            <a id="bibliography_8" target="_blank" href="http://scholar.cnki.net/result.aspx?q=The distribution of the flora in the alpine zone">

                                <b>[8]</b> JACCARD P.The distribution of the flora in the alpine zone[J].New Phytologist, 1912, 11 (2) :37-50.
                            </a>
                        </p>
                        <p id="179">
                            <a id="bibliography_9" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Finding groups in data:an introduction to cluster analysis">

                                <b>[9]</b> KAUFMAN L, ROUSSEEUW P J.Finding groups in data:an introduction to cluster analysis[M].Washington D.C., USA:John Wiley and Sons, Inc., 2009.
                            </a>
                        </p>
                        <p id="181">
                            <a id="bibliography_10" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JSJY201312042&amp;v=MTMwNTh0R0ZyQ1VSTE9lWmVScEZDamxWYnJCTHo3QmQ3RzRIOUxOclk5QlpvUUtESDg0dlI0VDZqNTRPM3pxcUI=&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQwam9BWm83cU5adCswdFNtUXRBUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[10]</b> 黄笑言, 陈性元, 祝宁, 等.基于状态标注的协议状态机逆向方法[J].计算机应用, 2013, 33 (12) :3486-3489.
                            </a>
                        </p>
                        <p id="183">
                            <a id="bibliography_11" target="_blank" href="http://scholar.cnki.net/result.aspx?q=&amp;quot;Automatic network protocol automation extraction&amp;quot;">

                                <b>[11]</b> XIAO Mingming, YU Shunzheng, WANG Yu.Automatic network protocol automaton extraction[C]//Proceedings of the 3rd International Conference on Network and System Security.Washington D.C., USA:IEEE Press, 2009:336-343.
                            </a>
                        </p>
                        <p id="185">
                            <a id="bibliography_12" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JFYZ201310002&amp;v=MjYyMTNDamxWYnJCTHl2U2RMRzRIOUxOcjQ5RlpvUUtESDg0dlI0VDZqNTRPM3pxcUJ0R0ZyQ1VSTE9lWmVScEY=&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQwam9BWm83cU5adCswdFNtUXRBUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[12]</b> 肖明明, 余顺争.基于文法推断的协议逆向工程[J].计算机研究与发展, 2013, 50 (10) :2044-2058.
                            </a>
                        </p>
                        <p id="187">
                            <a id="bibliography_13" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Bit-oriented format extraction approach for automatic binary protocol reverse engineering">

                                <b>[13]</b> TAO Siyu, YU Hongyi, LI Qing.Bit-oriented format extraction approach for automatic binary protocol reverse engineering[J].IET Communications, 2016, 10 (6) :709-716.
                            </a>
                        </p>
                        <p id="189">
                            <a id="bibliography_14" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Prospex:protocol specification extraction">

                                <b>[14]</b> COMPARETTI P M, WONDRACEK G, KRUEGEL C, et al.Prospex:protocol specification extraction[C]//Proceedings of IEEE Symposium on Security and Privacy.Washington D.C., USA:IEEE Press, 2009:110-125.
                            </a>
                        </p>
                        <p id="191">
                            <a id="bibliography_15" >
                                    <b>[15]</b>
                                 张黎.基于Net-trace的网络协议逆向工程方法研究[D].武汉:华中科技大学, 2011.
                            </a>
                        </p>
                        <p id="193">
                            <a id="bibliography_16" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=KXJS201419020&amp;v=MTI3OTNvOUhaSVFLREg4NHZSNFQ2ajU0TzN6cXFCdEdGckNVUkxPZVplUnBGQ2psVmJyQkxqWEJmYkc0SDlYTnA=&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQwam9BWm83cU5adCswdFNtUXRBUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[16]</b> 肖明明, 余顺争, 张世龙.文法推断网络协议状态机[J].科学技术与工程, 2014, 14 (19) :100-105.
                            </a>
                        </p>
            </div>
        <!--reference end-->
        <!--footnote start-->
        <!--footnote end-->



    </div>

        <input id="fileid" type="hidden" value="JSJC201907020" />
        <input id="dpi" type="hidden" value="600" />
    </div>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?6e967eb120601ea41b9d312166416aa6";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
</script>

    


<input id="hid_uid" name="hid_uid" type="hidden" value="WEEvREcwSlJHSldRa1FhdXNXaEhoRFQwam9BWm83cU5adCswdFNtUXRBUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
<input id="hid_kLogin_headerUrl" name="hid_kLogin_headerUrl" type="hidden" value="/KLogin/Request/GetKHeader.ashx%3Fcallback%3D%3F" />
<input id="hid_kLogin_footerUrl" name="hid_kLogin_footerUrl" type="hidden" value="/KLogin/Request/GetKFooter.ashx%3Fcallback%3D%3F" />
<div class="btn-link" style="display: none"><a target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JSJC201907020&amp;v=MTA0MTh0R0ZyQ1VSTE9lWmVScEZDamxWYnJCTHo3QmJiRzRIOWpNcUk5SFpJUUtESDg0dlI0VDZqNTRPM3pxcUI=&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQwam9BWm83cU5adCswdFNtUXRBUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">知网节</a></div>
<div class="popflow" id="popupTips" style="display: none;">
    <div class="popflowArr"></div>
    <div class="popflowCot">
        <div class="hd"><a href="javascript:void(0);" onclick="$('#popupTips').hide();$('#popupmsg').html('')" class="close">X</a></div>
        <div class="bd">
            <p class="mes" id="popupmsg" name="popupmsg"></p>
          
        </div>
    </div>
</div>
<input type="hidden" id="myexport" value="//kns.cnki.net" />

<input type="hidden" id="KPCAPIPATH" value="//ishufang.cnki.net" />
<input type="hidden" id="CitedTimes" value="" />
<div class="link" id="GLSearch" style="display: none;">
    <i class="icon-trangle"></i>
    <div class="inner">
        <a class="icon" id="copytext">复制</a>
        <a class="icon" target="_blank" onclick="searchCRFD(this)">工具书搜索</a>
    </div>
</div>




<input id="hidVirtualPath" name="hidVirtualPath" type="hidden" value="/kxreader" />
<script src="/kxreader/bundles/detail?v=-ULdk-c6FkZHtJA2KAXPgHnyA8mtgyPnBde_C2VZ2BY1"></script>

<script src="/kxreader/Scripts/layer.min.js" type="text/javascript"></script>

<div id="footerBox" class="rootw footer">
</div>
<script>
    if (typeof FlushLogin == 'function') {
        FlushLogin();
    }
    modifyEcpHeader(true);
</script>

<!--图片放大功能 start-->
<script src="/kxreader/bundles/imagebox?v=W4phPu9SNkGcuPeJclikuVE3PpRyIW_gnfjm_19nynI1"></script>

<script type="text/javascript">
    $(function () {
        var j = $.noConflict();
        j(function () {
            j(".zoom-in,.btn-zoomin").imgbox({
                'alignment': 'center',
                'allowMultiple': false,
                'overlayShow': true
            });
        })
    });
</script>
<!--图片放大功能 end-->
<div class="fixedbar">
    <div class="backtop hiddenV" id="backtop">
        <a id="backTopSide" href="javascript:scroll(0,0);" title=""></a>
    </div>
</div>
<script type="text/javascript" src="/kxreader/Scripts/MathJax-2.6-latest/MathJax.js?config=MML_HTMLorMML-full"></script>

</body>
</html>
