<!DOCTYPE html>
<html>
<head>
    <title>全文阅读--XML全文阅读--中国知网</title>
    <link rel="icon" href="/kxreader/favicon.ico" />
    <link rel="shortcut Icon" href="/kxreader/favicon.ico" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="keywords" content="文献 XML KBASE CNKI 中国知网" />
    <meta name="description" content="XML文献检索" />
    <link href="/kxreader/Content/css/detail?v=qX2z2KjRAEyQiNfAbKtl7dLnsqFoQ5Jdw3TZfDf0n1k1" rel="stylesheet"/>

    <script type="text/javascript">
        var APPPATH = '/kxreader';
    </script>
</head>

<body>
    
<script type="text/javascript" src="//login.cnki.net/TopLogin/api/loginapi/get?type=top&amp;localCSS=&amp;returnurl=%2f%2fkns.cnki.net%2f%2fKXReader%2fDetail%3fTIMESTAMP%3d637129055477306250%26DBCODE%3dCJFD%26TABLEName%3dCJFDLAST2019%26FileName%3dJSJC201908046%26RESULT%3d1%26SIGN%3d9LmZ2xuEj6XHXMfSMNEl%252fLPBRJY%253d"></script>

<div id="headerBox" class="header">
    <div class="topbar">
        <div class="textalign">
            <a href="/kxreader/Detail?dbcode=CJFD&amp;filename=JSJC201908046&amp;align=md">
                <i class="icon-cen active" title="居中对齐"></i>
            </a>
            <a href="/kxreader/Detail?dbcode=CJFD&amp;filename=JSJC201908046&amp;align=lt">
                <i class="icon-left " title="左对齐"></i>
            </a>
        </div>
        <h6 class="free-tip"><i class="icon"></i>HTML阅读开放试用阶段，欢迎体验！</h6>
    </div>
</div>

    



<div class="btn-link" style="display: none"><a target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JSJC201908046&amp;v=MTEzMjNVUkxPZVplUnFGQ2psVzc3TUx6N0JiYkc0SDlqTXA0OUJZb1FLREg4NHZSNFQ2ajU0TzN6cXFCdEdGckM=&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYyTTc5ZU1kSFJvVW1uVU9FL1g5cz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">知网节</a></div>

    <div class="main">

        

    <div class="sidebar-a">
        <!--sidebar start-->
        <div class="sidenav">
            <div class="arrow"><span></span></div>
            <!--sidebar_list start-->
            <dl class="sidenav-list">
                    <dt class="tit">目录结构</dt>
                            <dd class="guide">
                                    <p><a href="#39" data-title="0 概述 ">0 概述</a><i></i></p>
                                                            </dd>
                            <dd class="guide">
                                    <p><a href="#43" data-title="1 恶意代码文件特征提取 ">1 恶意代码文件特征提取</a><i></i></p>
                                                                    <ul class="contentbox">
                                                <li><a href="#45" data-title="1.1 Opcode N-gram">1.1 Opcode N-gram</a></li>
                                                <li><a href="#57" data-title="1.2 灰度图纹理特征提取">1.2 灰度图纹理特征提取</a></li>
                                                <li><a href="#68" data-title="1.3 颜色直方图特征">1.3 颜色直方图特征</a></li>
                                    </ul>
                            </dd>
                            <dd class="guide">
                                    <p><a href="#74" data-title="2 分类模型 ">2 分类模型</a><i></i></p>
                                                            </dd>
                            <dd class="guide">
                                    <p><a href="#89" data-title="3 实验结果与分析 ">3 实验结果与分析</a><i></i></p>
                                                                    <ul class="contentbox">
                                                <li><a href="#90" data-title="3.1 实验环境">3.1 实验环境</a></li>
                                                <li><a href="#93" data-title="3.2 Microsoft数据集">3.2 Microsoft数据集</a></li>
                                                <li><a href="#96" data-title="3.3 单一特征分类性能比较">3.3 单一特征分类性能比较</a></li>
                                                <li><a href="#110" data-title="3.4 特征融合分类性能比较">3.4 特征融合分类性能比较</a></li>
                                                <li><a href="#119" data-title="3.5 性能比较与评价">3.5 性能比较与评价</a></li>
                                    </ul>
                            </dd>
                            <dd class="guide">
                                    <p><a href="#123" data-title="4 结束语 ">4 结束语</a><i></i></p>
                                                            </dd>
                            <dd class="guide">
                                    <p><a href="#" data-title="文内图表 ">文内图表</a><i></i></p>
                                                                    <ul class="contentbox">
                                                <li><a href="#60" data-title="&lt;b&gt;图1 二进制文件转化为无灰度压缩图的过程&lt;/b&gt;"><b>图1 二进制文件转化为无灰度压缩图的过程</b></a></li>
                                                <li><a href="#65" data-title="&lt;b&gt;图2 不同恶意代码家族的图像纹理&lt;/b&gt;"><b>图2 不同恶意代码家族的图像纹理</b></a></li>
                                                <li><a href="#92" data-title="&lt;b&gt;表1 实验软硬件环境&lt;/b&gt;"><b>表1 实验软硬件环境</b></a></li>
                                                <li><a href="#95" data-title="&lt;b&gt;表2 恶意代码数据集&lt;/b&gt;"><b>表2 恶意代码数据集</b></a></li>
                                                <li><a href="#102" data-title="&lt;b&gt;图3 N-gram不同元组的分类性能&lt;/b&gt;"><b>图3 N-gram不同元组的分类性能</b></a></li>
                                                <li><a href="#106" data-title="&lt;b&gt;表3 图像纹理特征的分类效果&lt;/b&gt;"><b>表3 图像纹理特征的分类效果</b></a></li>
                                                <li><a href="#112" data-title="&lt;b&gt;表4 恶意代码家族分类混淆矩阵&lt;/b&gt;"><b>表4 恶意代码家族分类混淆矩阵</b></a></li>
                                                <li><a href="#117" data-title="&lt;b&gt;图4 模型预测类别与实际类别的混淆矩阵&lt;/b&gt;"><b>图4 模型预测类别与实际类别的混淆矩阵</b></a></li>
                                                <li><a href="#121" data-title="&lt;b&gt;表5 不同分类器在不同组合特征上的分类准确率&lt;/b&gt;"><b>表5 不同分类器在不同组合特征上的分类准确率</b></a></li>
                                                <li><a href="#122" data-title="&lt;b&gt;表6 算法分类性能对比结果&lt;/b&gt;"><b>表6 算法分类性能对比结果</b></a></li>
                                    </ul>
                            </dd>
                                    <dd class="guide">
                                        <h6>
                                            <p><a href="#a_bibliography">参考文献</a> </p>
                                        </h6>
                                    </dd>

            </dl>
        </div>
        <!--sidebar end-->
        &nbsp;
        <!--此处有一空格符 勿删-->
    </div>

                <div class="sidebar-b three-collumn" style="width:0;">
            <div class="refer" style="width: 0;">
                <div class="arrow off" title="参考文献"><span></span></div>
                <div class="js-scrollbox" >
                    
                    <div class="subbox active">
                        <h4>
                            <span class="tit">参考文献</span>
                            <a class="close" href="javascript:void(0)">x</a>
                        </h4>
                        <div class="side-scroller">
                            <ul class="refer-list">
                                <li id="157">


                                    <a id="bibliography_1" title=" LEE J, JEONG K, LEE H.Detecting metamorphic malwares using code graphs[C]//Proceedings of ACM Symposium on Applied Computing.New York, USA:ACM Press, 2010:1970-1977." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Detecting metamorphic malwares using code graphs">
                                        <b>[1]</b>
                                         LEE J, JEONG K, LEE H.Detecting metamorphic malwares using code graphs[C]//Proceedings of ACM Symposium on Applied Computing.New York, USA:ACM Press, 2010:1970-1977.
                                    </a>
                                </li>
                                <li id="159">


                                    <a id="bibliography_2" title=" TIAN R, BATTEN L, VERSTEEG S, et al.Function length as a tool for malware classification[C]//Proceedings of the 3rd International Conference on Malicious and Unwanted Software.Washington D.C., USA:IEEE Press, 2008:369-378." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Function Length as a Tool for Malware Classification">
                                        <b>[2]</b>
                                         TIAN R, BATTEN L, VERSTEEG S, et al.Function length as a tool for malware classification[C]//Proceedings of the 3rd International Conference on Malicious and Unwanted Software.Washington D.C., USA:IEEE Press, 2008:369-378.
                                    </a>
                                </li>
                                <li id="161">


                                    <a id="bibliography_3" title=" 王蕊, 冯登国, 杨轶, 等.基于语义的恶意代码行为特征提取及检测方法[J].软件学报, 2012, 23 (2) :378-393." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=RJXB201202018&amp;v=MDU1MzdJUUtESDg0dlI0VDZqNTRPM3pxcUJ0R0ZyQ1VSTE9lWmVScUZDamxXNzdNTnlmVGJMRzRIOVBNclk5RWI=&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYyTTc5ZU1kSFJvVW1uVU9FL1g5cz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[3]</b>
                                         王蕊, 冯登国, 杨轶, 等.基于语义的恶意代码行为特征提取及检测方法[J].软件学报, 2012, 23 (2) :378-393.
                                    </a>
                                </li>
                                <li id="163">


                                    <a id="bibliography_4" title=" 朱克楠, 尹宝林, 冒亚明, 等.基于有效窗口和朴素贝叶斯的恶意代码分类[J].计算机研究与发展, 2014, 51 (2) :373-381." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JFYZ201402014&amp;v=MjE1Mzg3TUx5dlNkTEc0SDlYTXJZOUVZSVFLREg4NHZSNFQ2ajU0TzN6cXFCdEdGckNVUkxPZVplUnFGQ2psVzc=&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYyTTc5ZU1kSFJvVW1uVU9FL1g5cz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[4]</b>
                                         朱克楠, 尹宝林, 冒亚明, 等.基于有效窗口和朴素贝叶斯的恶意代码分类[J].计算机研究与发展, 2014, 51 (2) :373-381.
                                    </a>
                                </li>
                                <li id="165">


                                    <a id="bibliography_5" title=" 韩晓光, 曲武, 姚宣霞, 等.基于纹理指纹的恶意代码变种检测方法研究[J].通信学报, 2014, 35 (8) :125-136." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=TXXB201408016&amp;v=MTYxMTh0R0ZyQ1VSTE9lWmVScUZDamxXNzdNTVRYVGJMRzRIOVhNcDQ5RVlvUUtESDg0dlI0VDZqNTRPM3pxcUI=&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYyTTc5ZU1kSFJvVW1uVU9FL1g5cz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[5]</b>
                                         韩晓光, 曲武, 姚宣霞, 等.基于纹理指纹的恶意代码变种检测方法研究[J].通信学报, 2014, 35 (8) :125-136.
                                    </a>
                                </li>
                                <li id="167">


                                    <a id="bibliography_6" title=" ISLAM R, TIAN R H, BATTEN L M, et al.Classification of malware based on integrated static and dynamic features[J].Journal of Network and Computer Applications, 2013, 36 (2) :646-656." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=SJES&amp;filename=SJES13011301043334&amp;v=MDIwODJxUVRNbndaZVp1SHlqbVVMdkxJRjRjYXhZPU5pZk9mYks3SHRETnJJOUVaTzhNRDM4OW9CTVQ2VDRQUUgvaXJSZEdlcg==&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYyTTc5ZU1kSFJvVW1uVU9FL1g5cz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[6]</b>
                                         ISLAM R, TIAN R H, BATTEN L M, et al.Classification of malware based on integrated static and dynamic features[J].Journal of Network and Computer Applications, 2013, 36 (2) :646-656.
                                    </a>
                                </li>
                                <li id="169">


                                    <a id="bibliography_7" title=" PARK Y, REEVES D, MULUKUTLA V, et al.Fast malware classification by automated behavioral graph matching[C]//Proceedings of the 6th Annual Workshop on Cyber Security and Information Intelligent Research.New York, USA:ACM Press, 2010:156-165." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Fast Malware Classification by Automated Behavioral Graph Matching">
                                        <b>[7]</b>
                                         PARK Y, REEVES D, MULUKUTLA V, et al.Fast malware classification by automated behavioral graph matching[C]//Proceedings of the 6th Annual Workshop on Cyber Security and Information Intelligent Research.New York, USA:ACM Press, 2010:156-165.
                                    </a>
                                </li>
                                <li id="171">


                                    <a id="bibliography_8" title=" 王卫红, 朱雨辰.基于N-Gram与加权分类器集成的恶意代码检测[J].浙江工业大学学报, 2017, 45 (6) :604-632." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=ZJGD201706003&amp;v=MjI5Mjk5Yk1xWTlGWjRRS0RIODR2UjRUNmo1NE8zenFxQnRHRnJDVVJMT2VaZVJxRkNqbFc3N01QeWZNYXJHNEg=&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYyTTc5ZU1kSFJvVW1uVU9FL1g5cz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[8]</b>
                                         王卫红, 朱雨辰.基于N-Gram与加权分类器集成的恶意代码检测[J].浙江工业大学学报, 2017, 45 (6) :604-632.
                                    </a>
                                </li>
                                <li id="173">


                                    <a id="bibliography_9" title=" 张东, 张尧, 刘刚, 等.基于机器学习算法的主机恶意代码检测技术研究[J].网络与信息安全学报, 2017, 3 (7) :25-31." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=WXAQ201707003&amp;v=MTY1NDFyQ1VSTE9lWmVScUZDamxXNzdNTWpYS2Y3RzRIOWJNcUk5Rlo0UUtESDg0dlI0VDZqNTRPM3pxcUJ0R0Y=&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYyTTc5ZU1kSFJvVW1uVU9FL1g5cz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[9]</b>
                                         张东, 张尧, 刘刚, 等.基于机器学习算法的主机恶意代码检测技术研究[J].网络与信息安全学报, 2017, 3 (7) :25-31.
                                    </a>
                                </li>
                                <li id="175">


                                    <a id="bibliography_10" title=" 任卓君, 陈光.熵可视化方法在恶意代码分类中的应用[J].计算机工程, 2017, 43 (9) :167-171." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JSJC201709031&amp;v=MDQ4MzMzenFxQnRHRnJDVVJMT2VaZVJxRkNqbFc3N01MejdCYmJHNEg5Yk1wbzlHWllRS0RIODR2UjRUNmo1NE8=&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYyTTc5ZU1kSFJvVW1uVU9FL1g5cz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[10]</b>
                                         任卓君, 陈光.熵可视化方法在恶意代码分类中的应用[J].计算机工程, 2017, 43 (9) :167-171.
                                    </a>
                                </li>
                                <li id="177">


                                    <a id="bibliography_11" title=" BAT-ERDENE M, PARK H, LI H, et al.Entropy analysis to classify unknown packing algorithms for malware detection[J].International Journal of Information Security, 2016, 16 (3) :1-22." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Entropy analysis to classify unknown packing algorithms for malware detection">
                                        <b>[11]</b>
                                         BAT-ERDENE M, PARK H, LI H, et al.Entropy analysis to classify unknown packing algorithms for malware detection[J].International Journal of Information Security, 2016, 16 (3) :1-22.
                                    </a>
                                </li>
                                <li id="179">


                                    <a id="bibliography_12" title=" DING Yuxin, DAI Wei, YAN Shengli, et al.Control flowbased opcode behavior analysis for malware detection[J].Computers and Security, 2014, 44:65-74." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=SJES&amp;filename=SJES14061600101545&amp;v=MzExMTVHZXJxUVRNbndaZVp1SHlqbVVMdkxJRjRjYXhZPU5pZk9mYks4SHRmTnFZOUZaZXNPQ1hnOG9CTVQ2VDRQUUgvaXJSZA==&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYyTTc5ZU1kSFJvVW1uVU9FL1g5cz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[12]</b>
                                         DING Yuxin, DAI Wei, YAN Shengli, et al.Control flowbased opcode behavior analysis for malware detection[J].Computers and Security, 2014, 44:65-74.
                                    </a>
                                </li>
                                <li id="181">


                                    <a id="bibliography_13" title=" OJALA T, PIETIKINEN M, MAENPAA T.Multiresolution gray-scale and rotation invariant texture classifacation with local binary patterns[J].IEEE Transactions on Pattern Analysis and Machine Intelligence, 2002, 24 (7) :971-987." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Multiresolution gray-scale and rotation invariant texture classification with local binary patterns">
                                        <b>[13]</b>
                                         OJALA T, PIETIKINEN M, MAENPAA T.Multiresolution gray-scale and rotation invariant texture classifacation with local binary patterns[J].IEEE Transactions on Pattern Analysis and Machine Intelligence, 2002, 24 (7) :971-987.
                                    </a>
                                </li>
                                <li id="183">


                                    <a id="bibliography_14" title=" NATARAJ L, KARTHIKEYAN S, JACOB G, et al.Malware images:visualization and automatic classification[C]//Proceedings of the 8th International Symposium on visualization for Cyber Security.New York, USA:ACM Press, 2011:4-10." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Malware images:visualization and automatic classification">
                                        <b>[14]</b>
                                         NATARAJ L, KARTHIKEYAN S, JACOB G, et al.Malware images:visualization and automatic classification[C]//Proceedings of the 8th International Symposium on visualization for Cyber Security.New York, USA:ACM Press, 2011:4-10.
                                    </a>
                                </li>
                                <li id="185">


                                    <a id="bibliography_15" title=" CONTI G, SHUBINA B S.A visual study of primitive binary fragment types[EB/OL].[2018-05-07].https://www.researchgate.net/publication/265356241_A_Visual_Study_of_Primitive_Binary_Fragment_Types." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=A visual study of primitive binary fragment types">
                                        <b>[15]</b>
                                         CONTI G, SHUBINA B S.A visual study of primitive binary fragment types[EB/OL].[2018-05-07].https://www.researchgate.net/publication/265356241_A_Visual_Study_of_Primitive_Binary_Fragment_Types.
                                    </a>
                                </li>
                                <li id="187">


                                    <a id="bibliography_16" title=" 崔鸿雁, 徐帅, 张利锋, 等.机器学习中的特征选择方法研究及展望[J].北京邮电大学学报, 2018, 41 (1) :1-9." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=DKFX&amp;filename=BJYD201801001&amp;v=MDQ2MzlLREg4NHZSNFQ2ajU0TzN6cXFCdEdGckNVUkxPZVplUnFGQ2psVzc3TUp5ZlNhckc0SDluTXJvOUZaWVE=&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYyTTc5ZU1kSFJvVW1uVU9FL1g5cz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[16]</b>
                                         崔鸿雁, 徐帅, 张利锋, 等.机器学习中的特征选择方法研究及展望[J].北京邮电大学学报, 2018, 41 (1) :1-9.
                                    </a>
                                </li>
                                <li id="189">


                                    <a id="bibliography_17" title=" Kaggle.Microsoft malware classification challenge (BIG 2015) [EB/OL].[2018-05-07].https://kaggle.com/c/maleware classification/." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Microsoft malware classification challenge (BIG 2015)">
                                        <b>[17]</b>
                                         Kaggle.Microsoft malware classification challenge (BIG 2015) [EB/OL].[2018-05-07].https://kaggle.com/c/maleware classification/.
                                    </a>
                                </li>
                                <li id="191">


                                    <a id="bibliography_18" title=" YANG Y, PEDERSEN J O.A comparative study on feature selection in text categorization[C]//Proceedings of International Conference on Machine Learning.New York, USA:ACM Press, 1997:412-420." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=A comparative study on feature selection in text categorization">
                                        <b>[18]</b>
                                         YANG Y, PEDERSEN J O.A comparative study on feature selection in text categorization[C]//Proceedings of International Conference on Machine Learning.New York, USA:ACM Press, 1997:412-420.
                                    </a>
                                </li>
                            </ul>
                            <div style='display: none;' class="zqscroller" >
                                <h4 class="">附加材料</h4>
                                <ul></ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            &nbsp;
            <!--此处有一空格符 勿删-->
        </div>

        
    <div class="content">



        <!--tips start-->
                            <div class="tips">
                    <a href="http://navi.cnki.net/KNavi/JournalDetail?pcode=CJFD&amp;pykm=JSJC" target="_blank">计算机工程</a>
                2019,45(08),281-286+295 DOI:10.19678/j.issn.1000-3428.0051790            </div>
        <!--tips end-->
            <div class="top-title">
                <h1 class="title">
                    <span class="vm"><b>基于特征融合的恶意代码分类研究</b></span>
 <span class="shoufa"></span>                                     </h1>

            </div>
                        <h2>
                                <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=au&amp;skey=%E5%BC%A0%E6%99%AF%E8%8E%B2&amp;code=39853428&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYyTTc5ZU1kSFJvVW1uVU9FL1g5cz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">张景莲</a>
                                <a href="javascript:;">彭艳兵</a>
                </h2>
                    <h2>
                    <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=in&amp;skey=%E6%AD%A6%E6%B1%89%E9%82%AE%E7%94%B5%E7%A7%91%E5%AD%A6%E7%A0%94%E7%A9%B6%E9%99%A2&amp;code=0197167&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYyTTc5ZU1kSFJvVW1uVU9FL1g5cz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">武汉邮电科学研究院</a>
                    <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=in&amp;skey=%E5%8D%97%E4%BA%AC%E7%83%BD%E7%81%AB%E5%A4%A9%E5%9C%B0%E9%80%9A%E4%BF%A1%E7%A7%91%E6%8A%80%E6%9C%89%E9%99%90%E5%85%AC%E5%8F%B8&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYyTTc5ZU1kSFJvVW1uVU9FL1g5cz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">南京烽火天地通信科技有限公司</a>
            </h2>

        
<div class="link">
    <a id="aexport" class="icon icon-output"  onclick="" href="javascript:void(0);"><i></i>导出/参考文献</a>
    
    <span class="shareBoard" onmouseover="$('#sharedet').show();$('#this').addClass('shareBoardCUR')" onmouseout="$('#sharedet').hide();$('#this').removeClass('shareBoardCUR')">
        <a class="icon icon-share" href="#"><i></i>分享<em></em></a>
        <ul class="shareHide" id="sharedet" style="display: none;">
            <li><a title="复制链接" class="copy" onclick="" href="#"><i></i>复制链接</a></li>
            <li><a title="分享到新浪微博" class="xl" onclick="" href="javascript:common.ShareAction('xl');"><i></i>新浪微博</a></li>
            <li>
                <a title="分享到微信" class="wx" onclick="" href="#"><i></i>微信扫一扫</a>
                <div class="qrcode"><img src='' alt='' /></div>
            </li>
        </ul>

    </span>
    
    <a id="RefTrack" title="创建引文跟踪" class="icon icon-track" onclick="" href="javascript:void(0);"> <i></i>创建引文跟踪 </a>
    <a id="ashoucang" title="收藏" class="icon icon-favor" onclick="" href="javascript:void(0);"><i></i>收藏</a>
    <a class="icon icon-print" onclick="window.print();" href="javascript:void(0);"><i></i>打印</a>
    
    <!--版本切换 end-->
</div>
                            <div class="data" id="a_abstract">
                <span class="keys">摘<span style="font-family: 'Times New Roman';">&nbsp;&nbsp;&nbsp;&nbsp;</span>要：</span>
                <p>基于特征码匹配的静态分析方法提取的特征滞后于病毒发展, 且不能检测出未知病毒。为此, 从病毒反编译文件及其灰度图出发进行特征提取及融合, 采用机器学习中的随机森林 (RF) 算法对恶意代码家族进行分类, 提取恶意代码的操作码指令和灰度图纹理2个局部特征, 并将颜色直方图作为恶意代码的全局特征。实验结果表明, 融合恶意代码特征与RF算法可实现恶意代码家族的有效分类, 平均准确率达到99.59%。</p>
            </div>
                    <div class="data" id="a_keywords">
                <span class="keys">关键词：</span>
                <p>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYyTTc5ZU1kSFJvVW1uVU9FL1g5cz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">恶意代码;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYyTTc5ZU1kSFJvVW1uVU9FL1g5cz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">机器学习;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=%E7%81%B0%E5%BA%A6%E5%9B%BE%E7%BA%B9%E7%90%86&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYyTTc5ZU1kSFJvVW1uVU9FL1g5cz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">灰度图纹理;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=%E9%A2%9C%E8%89%B2%E7%9B%B4%E6%96%B9%E5%9B%BE&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYyTTc5ZU1kSFJvVW1uVU9FL1g5cz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">颜色直方图;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=%E9%9A%8F%E6%9C%BA%E6%A3%AE%E6%9E%97&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYyTTc5ZU1kSFJvVW1uVU9FL1g5cz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">随机森林;</a>
                </p>
            </div>
        
        <!--brief start-->
        
            <div class="brief">
                    <p>
                            <b>作者简介：</b>
                                                        <span>
                                    张景莲 (1992—) , 女, 硕士研究生, 主研方向为网络安全、计算机视觉;;
                                </span>
                                <span>
                                    彭艳兵, 高级工程师、博士。;
                                </span>
                    </p>
                                    <p><b>收稿日期：</b>2018-06-12</p>

                    <p>

                            <b>基金：</b>
                                                        <span>国家重点研发计划“现代服务业共性关键技术研发及应用示范” (2017YFB1400704);</span>
                    </p>
            </div>
                    <h1><b>Research on Malware Code Classification Based on Features Fusion</b></h1>
                    <h2>
                    <span>ZHANG Jinglian</span>
                    <span>PENG Yanbing</span>
            </h2>
                    <h2>
                    <span>Wuhan Research Institute of Posts and Telecommunications</span>
                    <span>Nanjing Fiberhome World Communication Technology Co., Ltd.</span>
            </h2>
                            <div class="data" id="a_abstractEN">
                <span class="keys">Abstract：</span>
                <p>The features extracted by the static analysis method based on feature code matching often lag behind the development of the virus and cannot detect unknown viruses.Therefore, the feature extraction and fusion are carried out from the virus decompilation file and theirs grayscale image.The Random Forest (RF) algorithm in machine learning is used to classify the malware code family, extract the two local features of the opcode instructions and grayscale texture of the malware code, and use the color histogram as the global feature of the malware code.Experimental results show that the fusion of malware code features and RF algorithm can achieve effective classification of malware code families, and the average accuracy rate is 99.59%.</p>
            </div>
                    <div class="data" id="a_keywordsEN">
                <span class="keys">Keyword：</span>
                <p>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=malware%20code&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYyTTc5ZU1kSFJvVW1uVU9FL1g5cz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">malware code;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=machine%20learning&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYyTTc5ZU1kSFJvVW1uVU9FL1g5cz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">machine learning;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=grayscale%20texture&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYyTTc5ZU1kSFJvVW1uVU9FL1g5cz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">grayscale texture;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=color%20histogram&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYyTTc5ZU1kSFJvVW1uVU9FL1g5cz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">color histogram;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=Random%20Forest%20(RF)%20&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYyTTc5ZU1kSFJvVW1uVU9FL1g5cz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">Random Forest (RF) ;</a>
                </p>
            </div>
                    <div class="brief">
                
                    <p>
                                            </p>
                                    <p><b>Received：</b> 2018-06-12</p>
                                    <p>
                                            </p>
            </div>


        <!--brief start-->
                        <h3 id="39" name="39" class="anchor-tag">0 概述</h3>
                <div class="p1">
                    <p id="40">据微软统计, 2007年全球约三分之一的计算机被安装了木马、后门等各种恶意软件, 恶意代码的快速变种及混淆手段<citation id="193" type="reference"><link href="157" rel="bibliography" /><sup>[<a class="sup">1</a>]</sup></citation>使其越来越难以识别, 对网络安全造成重大威胁<citation id="194" type="reference"><link href="159" rel="bibliography" /><sup>[<a class="sup">2</a>]</sup></citation>。2017年全球爆发的大规模勒索病毒感染事件, 用户只要上网就可被攻击, 需支付赎金才能解密恢复文件, 攻击活动使得大量高科技设施、大型企业机构的正常活动遭到严重破坏, 甚至导致校园教学系统瘫痪。恶意代码变种的检测技术成为目前网络信息安全领域研究的热点<citation id="195" type="reference"><link href="161" rel="bibliography" /><sup>[<a class="sup">3</a>]</sup></citation>。当前的病毒分析方法主要有基于内容的静态分析方法和基于行为的动态分析方法<citation id="196" type="reference"><link href="157" rel="bibliography" /><link href="163" rel="bibliography" /><sup>[<a class="sup">1</a>,<a class="sup">4</a>]</sup></citation>, 检测技术包括基于规则、基于特征码和基于算法的检测技术。</p>
                </div>
                <div class="p1">
                    <p id="41">静态分析方法通过查看病毒二进制文件或反编译文件, 确定其特征码进行准确查杀<citation id="203" type="reference"><link href="161" rel="bibliography" /><link href="163" rel="bibliography" /><sup>[<a class="sup">3</a>,<a class="sup">4</a>]</sup></citation>, 然而恶意代码的各种变形使得反病毒软件很难再提取出一段代码作为恶意代码的特征码<citation id="197" type="reference"><link href="157" rel="bibliography" /><sup>[<a class="sup">1</a>]</sup></citation>, 一些复杂加壳<citation id="198" type="reference"><link href="161" rel="bibliography" /><sup>[<a class="sup">3</a>]</sup></citation>的样本不容易做反汇编, 而且精准的特征码匹配需要定期更新病毒库<citation id="199" type="reference"><link href="161" rel="bibliography" /><sup>[<a class="sup">3</a>]</sup></citation>, 无法应对迅速变种的代码, 因此静态方法的局限较大。动态分析方法需在实际或虚拟环境 (如沙箱) 下执行恶意代码<citation id="200" type="reference"><link href="157" rel="bibliography" /><sup>[<a class="sup">1</a>]</sup></citation>, 通过考察代码执行过程中样本对操作系统中各种资源的操作来构建并分析特征<citation id="201" type="reference"><link href="165" rel="bibliography" /><sup>[<a class="sup">5</a>]</sup></citation>, 其关键是保证恶意代码的有效执行, 而恶意代码的各种反检测技术使其具有反沙箱、反调试功能, 病毒在沙箱内运行时间短, 导致其行为不能被完全激发。基于规则的方法根据病毒行为编写规则, 与基于算法的检测方法存在共同的缺陷:行为特征少, 需要混合动态和静态特征来构建检测系统<citation id="202" type="reference"><link href="167" rel="bibliography" /><sup>[<a class="sup">6</a>]</sup></citation>。</p>
                </div>
                <div class="p1">
                    <p id="42">目前, 机器学习理论被越来越多地运用于检测未知恶意代码的研究中。以恶意代码行为序列报告为基础, 采用朴素贝叶斯和操作相似度窗口进行自动化恶意代码分类<citation id="204" type="reference"><link href="163" rel="bibliography" /><sup>[<a class="sup">4</a>]</sup></citation>以及基于恶意代码静态特征与栈式自编码分类模型结合的方法<citation id="205" type="reference"><link href="169" rel="bibliography" /><sup>[<a class="sup">7</a>]</sup></citation>均取得了不错的结果。在恶意代码检测中, 特征描述算法是影响变种检测能力和检测效率的核心技术<citation id="206" type="reference"><link href="161" rel="bibliography" /><link href="165" rel="bibliography" /><sup>[<a class="sup">3</a>,<a class="sup">5</a>]</sup></citation>。本文利用恶意代码反汇编文件提取不同层次的特征, 基于恶意代码特征与机器学习算法对恶意代码进行分类研究。</p>
                </div>
                <h3 id="43" name="43" class="anchor-tag">1 恶意代码文件特征提取</h3>
                <div class="p1">
                    <p id="44">本文从病毒反编译文件中提取恶意代码2种局部特征:Opcode N-gram和灰度图纹理, 并将颜色直方图作为恶意代码的全局特征。</p>
                </div>
                <h4 class="anchor-tag" id="45" name="45">1.1 Opcode N-gram</h4>
                <div class="p1">
                    <p id="46">Opcode N-gram在先前的恶意代码分类研究中已被证明是非常有效的特征<citation id="208" type="reference"><link href="171" rel="bibliography" /><link href="173" rel="bibliography" /><sup>[<a class="sup">8</a>,<a class="sup">9</a>]</sup></citation>。N-gram模型被称为一阶马尔科夫链, 通过长度为<i>N</i>的滑动窗口收集一系列重叠的子字符串。模型基于以下假设:第<i>n</i>个词的出现只与它前面<i>n</i>-1个词有关。整句的概率就是各个词出现概率的乘积<citation id="207" type="reference"><link href="171" rel="bibliography" /><sup>[<a class="sup">8</a>]</sup></citation>。</p>
                </div>
                <div class="p1">
                    <p id="47">恶意代码经IDA Pro反编译生成PE可执行文件 (.asm文件) 和16进制字节码构成的字节文件 (.bytes文件) 。PE文件的节表程序段包括代码段 (.text, 有些文件是.CODE) 、数据段 (.data) 、资源段 (.rsrc) 等<citation id="210" type="reference"><link href="175" rel="bibliography" /><link href="177" rel="bibliography" /><sup>[<a class="sup">10</a>,<a class="sup">11</a>]</sup></citation>。代码段包含恶意代码的操作指令。从软件层面看, 这些Opcode<citation id="209" type="reference"><link href="179" rel="bibliography" /><sup>[<a class="sup">12</a>]</sup></citation>汇编指令及其组合是组成一个逻辑函数的最小单元, 代表恶意代码的核心。已有研究结果表明, Opcode N-gram比Byte N-gram能够更直观地描述二进制样本的功能性特征。基于此, 本文选择对PE文件Opcode操作指令进行N-gram特征提取, 并将其作为区分不同恶意代码家族的特征之一, 算法具体如下:</p>
                </div>
                <div class="p1">
                    <p id="48"><b>算法1</b> Opcode N-gram特征提取</p>
                </div>
                <div class="p1">
                    <p id="49"><b>输入</b> 恶意代码.asm文件, 样本总数<i>M</i></p>
                </div>
                <div class="p1">
                    <p id="50"><b>输出</b> Opcode N-gram特征向量<b><i>X</i></b><sub><i>ij</i></sub>表示第<i>i</i>个恶意代码文件的第<i>j</i>个元组权重, <i>i</i>≤<i>M</i></p>
                </div>
                <div class="p1">
                    <p id="51">1.提取M个.asm文件程序段.text或.CODE中的所有操作码指令, 形成序列。</p>
                </div>
                <div class="p1">
                    <p id="52">2.提取N-gram特征, 如长度为k=4的序列[mov, push, test, jnz]经n=3的窗口滑动后得到 (k-n) +1个元组{mov, push, test}, {push, test, jnz}。</p>
                </div>
                <div class="p1">
                    <p id="53">3.统计所有元组出现的次数, 进一步特征选择选出特征集元组。</p>
                </div>
                <div class="p1">
                    <p id="54">4.for ∀m∈M do</p>
                </div>
                <div class="p1">
                    <p id="55">统计m个文件特征集元组在文件中出现的频次</p>
                </div>
                <div class="p1">
                    <p id="56">end for</p>
                </div>
                <h4 class="anchor-tag" id="57" name="57">1.2 灰度图纹理特征提取</h4>
                <h4 class="anchor-tag" id="58" name="58">1.2.1 恶意代码可视化</h4>
                <div class="p1">
                    <p id="59">文献<citation id="211" type="reference">[<a class="sup">13</a>]</citation>利用B2M算法将恶意代码二进制文件转化为无压缩灰度图的原理如图1所示。</p>
                </div>
                <div class="area_img" id="60">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JSJC201908046_060.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYyTTc5ZU1kSFJvVW1uVU9FL1g5cz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图1 二进制文件转化为无灰度压缩图的过程" src="Detail/GetImg?filename=images/JSJC201908046_060.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYyTTc5ZU1kSFJvVW1uVU9FL1g5cz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit"><b>图1 二进制文件转化为无灰度压缩图的过程</b>  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JSJC201908046_060.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYyTTc5ZU1kSFJvVW1uVU9FL1g5cz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="p1">
                    <p id="61">B2M算法具体描述为:以二进制比特流<citation id="212" type="reference"><link href="183" rel="bibliography" /><sup>[<a class="sup">14</a>]</sup></citation>的方式读取恶意代码文件, 将其转化为以字节为单元的十六进制向量, 设定固定宽度<i>width</i> (一般是2<sup><i>n</i></sup>) , 长度<i>length</i>由文件大小和宽度自动获得 (<i>length</i>=文件长度/<i>width</i>) , 将向量排列为二维矩阵的形式, 每个矩阵元素取值范围为0～255。</p>
                </div>
                <div class="p1">
                    <p id="62">灰度图像是无色彩的记录明亮信息的2D图像, 灰度指黑白图像中点的颜色深度, 范围为0～255, 黑色为0, 白色为255。因此, 由恶意代码文件转化而来的矩阵中每个元素都可以当作灰度图中的像素点, 映射成如图1所示的无压缩灰度图像。</p>
                </div>
                <h4 class="anchor-tag" id="63" name="63">1.2.2 灰度图纹理特征</h4>
                <div class="p1">
                    <p id="64">尽管反检测技术使得恶意代码产生了大量变种, 但变种的恶意代码很大程度上共用了祖先的大部分源代码<citation id="213" type="reference"><link href="165" rel="bibliography" /><sup>[<a class="sup">5</a>]</sup></citation>, 同一家族的核心代码变化微小, 恶意软件在代码结构上大同小异。利用B2M算法将不同家族的恶意代码文件转化为对应的灰度图像, 结果如图2所示。</p>
                </div>
                <div class="area_img" id="65">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JSJC201908046_065.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYyTTc5ZU1kSFJvVW1uVU9FL1g5cz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图2 不同恶意代码家族的图像纹理" src="Detail/GetImg?filename=images/JSJC201908046_065.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYyTTc5ZU1kSFJvVW1uVU9FL1g5cz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit"><b>图2 不同恶意代码家族的图像纹理</b>  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JSJC201908046_065.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYyTTc5ZU1kSFJvVW1uVU9FL1g5cz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="p1">
                    <p id="66">可以看出, 同一家族的恶意代码图像整体上呈现相似性, 不同家族代码呈现不同的纹理结构, 有较明显的差别, 恶意代码文件转化来的灰度图能够有效取代恶意代码文件本身, 成为其另一种表达形式。</p>
                </div>
                <div class="p1">
                    <p id="67">恶意代码PE文件不同程序段在其转化来的灰度图像中对应不同的纹理表现<citation id="214" type="reference"><link href="185" rel="bibliography" /><sup>[<a class="sup">15</a>]</sup></citation>, 纹理特征由像素值排列分布反映差别。文献<citation id="215" type="reference">[<a class="sup">14</a>]</citation>中的图2详细描述了PE文件转换为图像后各程序段的对应位置, 核心特征操作码所在的代码段 (.text) 在灰度图像结构的前段位置, 本文经反复交叉验证选择一个合适的<i>M</i>值使其所在位置包含核心代码区, 以灰度矩阵<i>M</i>个像素值的排列向量表征灰度图像的纹理特征, 在进行训练时将该二维矩阵转换成一维向量的形式作为恶意代码的特征向量之一。</p>
                </div>
                <h4 class="anchor-tag" id="68" name="68">1.3 颜色直方图特征</h4>
                <div class="p1">
                    <p id="69">Opcode N-gram特征和灰度图纹理特征的前提是忽略文件中其他结构, 从不同家族恶意代码的核心特征出发, 依据.text段包含可执行代码, 在已有的恶意代码检测研究中通常只重视核心代码部分而不考虑全局信息<citation id="217" type="reference"><link href="169" rel="bibliography" /><link href="171" rel="bibliography" /><link href="175" rel="bibliography" /><sup>[<a class="sup">7</a>,<a class="sup">8</a>,<a class="sup">10</a>]</sup></citation>, 分析PE文件结构其他程序段 (如.rsrc) 囊括了恶意代码执行模块的所有资源数据, 如应用执行时需要的图表、菜单、位图等资源, .data块包含其他外来DLL函数及数据信息、输入表等, 不同的程序段携带恶意代码文件的不同信息, 这些程序段属于恶意代码的非关键区, 非关键区变异虽不会产生新的恶意代码变种, 但会使恶意代码的识别更复杂从而导致杀毒软件漏查<citation id="216" type="reference"><link href="165" rel="bibliography" /><sup>[<a class="sup">5</a>]</sup></citation>, 仅靠单一的局部特征势必造成信息的丢失而导致分类性能受到限制, 因此找到一种能够充分表达恶意代码全局信息的方法尤为重要。</p>
                </div>
                <div class="p1">
                    <p id="70">在图像领域的研究中, 图像颜色特征属于全局特征之一, RGB颜色空间中R、G、B分别代表图像红绿蓝三通道, 而灰度图只有一个通道, 即传统的RGB中的R、G、B统一用Gray代替, 形成新的颜色 (Gray, Gray, Gray) 。颜色直方图是描述颜色特征的基本表示方法之一, 反映图像场景的颜色组成, 即图像包含哪些颜色及这些颜色的概率。基于图2中不同恶意代码家族图像像素亮度的分布特性表现出明显的差别, 采用颜色直方图作为恶意代码全局特征并验证其在分类中的表现。</p>
                </div>
                <div class="p1">
                    <p id="71">颜色直方图在特征提取时首先对颜色空间进行量化, 本文将灰度图以像素点为基本单元划分灰度子空间, 分割为0～255共256个像素单元, 遍历整幅图像统计落在每个单元像素点的像素数, 表达式为:</p>
                </div>
                <div class="p1">
                    <p id="72" class="code-formula">
                        <mathml id="72"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>Η</mi><mo stretchy="false"> (</mo><mi>Κ</mi><mo stretchy="false">) </mo><mo>=</mo><mfrac><mrow><mi>n</mi><msub><mrow></mrow><mi>k</mi></msub></mrow><mi>Ν</mi></mfrac><mrow><mo> (</mo><mrow><mi>Κ</mi><mo>=</mo><mn>0</mn><mo>, </mo><mn>1</mn><mo>, </mo><mo>⋯</mo><mo>, </mo><mi>L</mi></mrow><mo>) </mo></mrow><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mrow><mtext> </mtext><mtext> </mtext><mtext> </mtext></mrow><mo stretchy="false"> (</mo><mn>1</mn><mo stretchy="false">) </mo></mrow></math></mathml>
                    </p>
                </div>
                <div class="p1">
                    <p id="73">其中, <i>K</i>表示图像像素点取值, <i>L</i>表示图像特征维数, <i>n</i><sub><i>k</i></sub>表示特征维数<i>L</i>取值为第<i>k</i>维时的像素个数, <i>N</i>是图像像素总数。</p>
                </div>
                <h3 id="74" name="74" class="anchor-tag">2 分类模型</h3>
                <div class="p1">
                    <p id="75">在机器学习中分类器分为基于距离和基于决策。基于距离的分类器包括K近邻 (K Nearest Neighbor, KNN) 、支持向量机 (Support Vector Machine, SVM) 等, 基于决策的分类器包括梯度提升分类器 (Gradient Boost Classifier, GBC) 和随机森林 (Random Forest, RF) 等, 其中RF分类器是当前恶意代码检测中的热门算法<citation id="218" type="reference"><link href="171" rel="bibliography" /><sup>[<a class="sup">8</a>]</sup></citation>, 其实际上是一个基于Bagging算法的集成模型<citation id="219" type="reference"><link href="187" rel="bibliography" /><sup>[<a class="sup">16</a>]</sup></citation>:通过Bootstrap方式抽取数据独立训练多个基础模型 (决策树 (Decision Tree, DT) ) , 由列采样随机使用一定的量特征值训练得到决策树, 每棵树的分类能力不强, 但在各自领域分类能力很强, 多棵决策树组合起来对一个样本从各个角度进行分类, 并将这些预测结果通过平均投票的方式给出最终结果, 由弱分类器组合成强分类器, 其分类性能通常高于单个分类器。</p>
                </div>
                <div class="p1">
                    <p id="76">决策树分裂或特征选择的依据是:基尼系数和信息增益。基尼系数用来度量数据的不纯度, 其公式为:</p>
                </div>
                <div class="p1">
                    <p id="77" class="code-formula">
                        <mathml id="77"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>G</mi><mi>i</mi><mi>n</mi><mi>i</mi><mo stretchy="false"> (</mo><mi>D</mi><mo stretchy="false">) </mo><mo>=</mo><mn>1</mn><mo>-</mo><mstyle displaystyle="true"><munderover><mo>∑</mo><mi>i</mi><mi>c</mi></munderover><mi>p</mi></mstyle><msubsup><mrow></mrow><mi>i</mi><mn>2</mn></msubsup><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mrow><mtext> </mtext><mtext> </mtext><mtext> </mtext></mrow><mo stretchy="false"> (</mo><mn>2</mn><mo stretchy="false">) </mo></mrow></math></mathml>
                    </p>
                </div>
                <div class="p1">
                    <p id="78">其中, <i>c</i>表示数据集类别数量, <i>p</i><sub><i>i</i></sub>表示类别<i>i</i>的样本数量占所有样本的比例, 数据混合程度越高, 基尼系数也越高。若数据集<i>D</i>被特征<i>A</i>分成<i>k</i>个<i>D</i><sub><i>j</i></sub>子集, 则分裂后属性<i>A</i>划分子集的基尼系数为:</p>
                </div>
                <div class="p1">
                    <p id="79" class="code-formula">
                        <mathml id="79"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>G</mi><mi>i</mi><mi>n</mi><mi>i</mi><msub><mrow></mrow><mi>A</mi></msub><mo stretchy="false"> (</mo><mi>D</mi><mo stretchy="false">) </mo><mo>=</mo><mstyle displaystyle="true"><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>k</mi></munderover><mrow><mfrac><mrow><mrow><mo>|</mo><mrow><mi>D</mi><msub><mrow></mrow><mi>j</mi></msub></mrow><mo>|</mo></mrow></mrow><mrow><mrow><mo>|</mo><mi>D</mi><mo>|</mo></mrow></mrow></mfrac></mrow></mstyle><mi>G</mi><mi>i</mi><mi>n</mi><mi>i</mi><mo stretchy="false"> (</mo><mi>D</mi><msub><mrow></mrow><mi>j</mi></msub><mo stretchy="false">) </mo><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mrow><mtext> </mtext><mtext> </mtext><mtext> </mtext></mrow><mo stretchy="false"> (</mo><mn>3</mn><mo stretchy="false">) </mo></mrow></math></mathml>
                    </p>
                </div>
                <div class="p1">
                    <p id="80">基尼系数增益<citation id="220" type="reference"><link href="187" rel="bibliography" /><sup>[<a class="sup">16</a>]</sup></citation>为:</p>
                </div>
                <div class="p1">
                    <p id="81">Δ<i>Gini</i> (<i>A</i>) =<i>Gini</i> (<i>D</i>) -<i>Gini</i><sub><i>A</i></sub> (<i>D</i>)      (4) </p>
                </div>
                <div class="p1">
                    <p id="82">选择基尼系数增益值最大时的特征作为该节点的分裂条件。信息熵评价了信息的混乱程度, 熵值越大信息的不确定性越大。节点信息熵为:</p>
                </div>
                <div class="p1">
                    <p id="83" class="code-formula">
                        <mathml id="83"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>Ι</mi><mi>n</mi><mi>f</mi><mi>o</mi><mo stretchy="false"> (</mo><mi>D</mi><mo stretchy="false">) </mo><mo>=</mo><mo>-</mo><mstyle displaystyle="true"><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><mi>p</mi></mstyle><msub><mrow></mrow><mi>i</mi></msub><mtext>l</mtext><mtext>b</mtext><mspace width="0.25em" /><mi>p</mi><msub><mrow></mrow><mi>i</mi></msub><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mrow><mtext> </mtext><mtext> </mtext><mtext> </mtext></mrow><mo stretchy="false"> (</mo><mn>5</mn><mo stretchy="false">) </mo></mrow></math></mathml>
                    </p>
                </div>
                <div class="p1">
                    <p id="84">信息增益的计算公式与基尼系数大致类似, 属性<i>A</i>划分子集的期望信息:</p>
                </div>
                <div class="p1">
                    <p id="85" class="code-formula">
                        <mathml id="85"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>Ι</mi><mi>n</mi><mi>f</mi><mi>o</mi><msub><mrow></mrow><mi>A</mi></msub><mo stretchy="false"> (</mo><mi>D</mi><mo stretchy="false">) </mo><mo>=</mo><mstyle displaystyle="true"><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>v</mi></munderover><mrow><mfrac><mrow><mrow><mo>|</mo><mrow><mi>D</mi><msub><mrow></mrow><mi>j</mi></msub></mrow><mo>|</mo></mrow></mrow><mrow><mrow><mo>|</mo><mi>D</mi><mo>|</mo></mrow></mrow></mfrac></mrow></mstyle><mi>Ι</mi><mi>n</mi><mi>f</mi><mi>o</mi><mo stretchy="false"> (</mo><mi>D</mi><msub><mrow></mrow><mi>j</mi></msub><mo stretchy="false">) </mo><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mrow><mtext> </mtext><mtext> </mtext><mtext> </mtext></mrow><mo stretchy="false"> (</mo><mn>6</mn><mo stretchy="false">) </mo></mrow></math></mathml>
                    </p>
                </div>
                <div class="p1">
                    <p id="86">属性<i>A</i>划分子集的信息增益:</p>
                </div>
                <div class="p1">
                    <p id="87"><i>Gain</i> (<i>A</i>) =<i>Info</i> (<i>D</i>) -<i>Info</i><sub><i>A</i></sub> (<i>D</i>)      (7) </p>
                </div>
                <div class="p1">
                    <p id="88">选择具有最大信息增益的属性作为分裂属性。RF需要考虑:1) 基于距离的分类器如SVM、KNN对具有复杂分布的特征难以进行线性划分;2) RF可处理多特征的高维数据且不进行特征选择, 依赖于RF的2个采样随机性, 即随机有放回地从训练集中提取样本 (bootstrap有放回取样<citation id="221" type="reference"><link href="187" rel="bibliography" /><sup>[<a class="sup">16</a>]</sup></citation>) 和随机无放回地从特征集中选取特征子集, 从<i>M</i>个特征中选择<i>m</i>个特征 (<i>m</i>&lt;&lt;<i>M</i>) , 在每棵树进行分裂时, 从这<i>m</i>个特征中选择最优特征, 且这2种随机性可有效减小过拟合程度;3) 模型完成训练后能给出特征重要性评价, 并且在训练过程中能够检测到特征间的影响。在实际训练中特征数量多, 各个特征间可能不相关也可能相互依赖, 在分类和预测时容易造成模型训练时间长、模型复杂、推广能力下降等问题, 了解特征间的影响从而剔除不相关和多余特征, 可达到减少特征数量, 提高模型精度, 减少运行时间的目的<citation id="222" type="reference"><link href="187" rel="bibliography" /><sup>[<a class="sup">16</a>]</sup></citation>;4) 特征遗失仍可以维持准确度。Opcode N-gram和灰度图纹理特征都是对恶意代码局部的描述, 会遗失其他信息, 并且各种混淆技术会导致代码不全, 但由于RF具有模型训练对缺失值不敏感的特点, 因此对恶意代码特征有较好的包容性, 可对抗部分混淆。</p>
                </div>
                <h3 id="89" name="89" class="anchor-tag">3 实验结果与分析</h3>
                <h4 class="anchor-tag" id="90" name="90">3.1 实验环境</h4>
                <div class="p1">
                    <p id="91">实验软硬件环境如表1所示, 其中机器学习框架选择Scikit-learn是因为其具有广泛可靠的机器学习算法和良好的训练模型。</p>
                </div>
                <div class="area_img" id="92">
                    <p class="img_tit"><b>表1 实验软硬件环境</b> <a class="downexcel" onclick="DownLoadReportExcel(this)">导出到EXCEL</a></p>
                    <p class="img_tit"></p>
                    <p class="img_note"></p>
                    <table id="92" border="1"><tr><td><br />硬件环境</td><td>软件环境</td></tr><tr><td><br />CPU:Intel (R) Xeon (R) <br />E5620 2.4 GHz<br />RAM:32 GB</td><td>操作系统:Linux 64<br />框架:Scikit-learn<br />语言:Python 3.6</td></tr></table>
                    <form name="form" action="/kxreader/Detail/DownloadReportExcel" method="POST" style="display:inline">
                        <input type="hidden" name="hidTable" value="" />
                        <input type="hidden" name="hidFileName" value="" />
                    </form>
                    <p class="img_note"></p>
                    <p class="img_note"></p>
                </div>
                <h4 class="anchor-tag" id="93" name="93">3.2 Microsoft数据集</h4>
                <div class="p1">
                    <p id="94">本文数据集为微软公司在Kaggle微软恶意代码分类大赛中提供的数据集<citation id="223" type="reference"><link href="189" rel="bibliography" /><sup>[<a class="sup">17</a>]</sup></citation>, Microsoft数据集包含9个恶意代码家族, 每个恶意代码去除PE头, 分别包含2个文件, IDA反编译工具得到的.asm文件和16进制表示的.bytes文件。本文采用反编译工具生成的.asm文件, 共10 868个样本, 约136 GB, 详细信息如表2所示。</p>
                </div>
                <div class="area_img" id="95">
                    <p class="img_tit"><b>表2 恶意代码数据集</b> <a class="downexcel" onclick="DownLoadReportExcel(this)">导出到EXCEL</a></p>
                    <p class="img_tit"></p>
                    <p class="img_note"></p>
                    <table id="95" border="1"><tr><td><br />恶意代码家族类别</td><td>样本数量</td></tr><tr><td><br />Ramnit</td><td>1 541</td></tr><tr><td><br />Lollipop</td><td>2 478</td></tr><tr><td><br />Kelihos_ver3</td><td>2 942</td></tr><tr><td><br />Vundo</td><td>475</td></tr><tr><td><br />Simda</td><td>42</td></tr><tr><td><br />Tracur</td><td>751</td></tr><tr><td><br />Kelihos_ver1</td><td>398</td></tr><tr><td><br />Obfuscator.ACY</td><td>1 228</td></tr><tr><td><br />Gatak</td><td>1 013</td></tr></table>
                    <form name="form" action="/kxreader/Detail/DownloadReportExcel" method="POST" style="display:inline">
                        <input type="hidden" name="hidTable" value="" />
                        <input type="hidden" name="hidFileName" value="" />
                    </form>
                    <p class="img_note"></p>
                    <p class="img_note"></p>
                </div>
                <h4 class="anchor-tag" id="96" name="96">3.3 单一特征分类性能比较</h4>
                <div class="p1">
                    <p id="97">将3种特征的特征向量分别传输到RF分类器进行训练, 数据集训练时均采用Cross-Validation交叉验证以避免陷入局部最小值造成过拟合的情形。随机按比例抽取60%数据作为训练集, 其余作为测试集。</p>
                </div>
                <h4 class="anchor-tag" id="98" name="98">3.3.1 Opcode N-gram分类表现</h4>
                <div class="p1">
                    <p id="99">数据集中不同恶意代码文件大小不一, 从全部的恶意代码数据集中提取所有操作指令的N-gram数量过大, 本文对此做了特征选择。文献<citation id="224" type="reference">[<a class="sup">18</a>]</citation>提出多种特征选择方法, 在提取的所有特征中选择少量相关特征组成相关特征集, 解决特征集过大的问题, 在本文中选取所有恶意代码样本中操作码N-gram出现频次高于500次作为相关特征并对特征进行降维, 分别选取<i>N</i>值为{2, 3, 4, 5, 6}进行不同元组的分类准确率对比, 准确率公式为:</p>
                </div>
                <div class="p1">
                    <p id="100"><i>Accuracy</i>=<i>TP</i>/<i>N</i>      (8) </p>
                </div>
                <div class="p1">
                    <p id="101">其中, <i>TP</i>表示给定的测试数据集中, 每一类恶意代码被正确分类的数目总和, <i>N</i>表示恶意代码测试样本总数。N-gram不同元组的分类性能结果如图3所示。</p>
                </div>
                <div class="area_img" id="102">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JSJC201908046_102.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYyTTc5ZU1kSFJvVW1uVU9FL1g5cz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图3 N-gram不同元组的分类性能" src="Detail/GetImg?filename=images/JSJC201908046_102.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYyTTc5ZU1kSFJvVW1uVU9FL1g5cz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit"><b>图3 N-gram不同元组的分类性能</b>  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JSJC201908046_102.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYyTTc5ZU1kSFJvVW1uVU9FL1g5cz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="p1">
                    <p id="103">由图3可知, <i>N</i>在取值为{2, 3, 4}时分类准确率在97.5%以上, <i>N</i>=2时的Bi-gram效果达到最佳, 平均准确率达到98.10%, 高于4元组后分类准确率降低。</p>
                </div>
                <h4 class="anchor-tag" id="104" name="104">3.3.2 灰度图纹理分类表现</h4>
                <div class="p1">
                    <p id="105">本文选取像素点数目<i>M</i>值为{1 000, 1 500, 2 000, 2 500, 2 700, 3 000}进行不同实验的准确率对比, 结果如表3所示。</p>
                </div>
                <div class="area_img" id="106">
                    <p class="img_tit"><b>表3 图像纹理特征的分类效果</b> <a class="downexcel" onclick="DownLoadReportExcel(this)">导出到EXCEL</a></p>
                    <p class="img_tit"></p>
                    <p class="img_note"></p>
                    <table id="106" border="1"><tr><td><br />像素点数目</td><td>准确率</td></tr><tr><td><br />1 000</td><td>0.809 9</td></tr><tr><td><br />1 500</td><td>0.980 8</td></tr><tr><td><br />2 000</td><td>0.981 4</td></tr><tr><td><br />2 500</td><td>0.986 6</td></tr><tr><td><br />2 700</td><td>0.984 4</td></tr><tr><td><br />3 000</td><td>0.983 7</td></tr></table>
                    <form name="form" action="/kxreader/Detail/DownloadReportExcel" method="POST" style="display:inline">
                        <input type="hidden" name="hidTable" value="" />
                        <input type="hidden" name="hidFileName" value="" />
                    </form>
                    <p class="img_note"></p>
                    <p class="img_note"></p>
                </div>
                <div class="p1">
                    <p id="107">像素值个数<i>M</i>取值在2 000～3 000的范围内分类准确率处于平稳状态, 最佳取值点是<i>M</i>=2 500的像素点位置, 平均准确率达到98.66%, 可以推测这个范围包含了恶意代码的核心代码区。</p>
                </div>
                <h4 class="anchor-tag" id="108" name="108">3.3.3 颜色直方图分类表现</h4>
                <div class="p1">
                    <p id="109">为每个恶意代码图像构建颜色直方图, 经过多次的训练得出平均准确率为98.66%, 与Opcode N-gram和灰度图纹理特征有相当的分类性能, 此结果表明本文提出的颜色直方图特征可以较好地描述恶意代码的全局信息并在家族分类上具有较好的表现。</p>
                </div>
                <h4 class="anchor-tag" id="110" name="110">3.4 特征融合分类性能比较</h4>
                <div class="p1">
                    <p id="111">本文融合3个特征对恶意代码进行局部和全局不同层面的描述, 其中各个单一特征的参数取多次训练的最佳点{<i>N</i>=2, <i>M</i>=2 500}, 特征向量合并成新的特征向量输入RF分类器, 进行多次训练后分类平均准确率达到99.59%, 并且最高准确率达到99.79%, 采用混淆矩阵和对数损失函数对该分类系统性能进行综合评估, 混淆矩阵展示了本文分类系统下每个恶意代码家族被误判的情况, 如表4所示。</p>
                </div>
                <div class="area_img" id="112">
                    <p class="img_tit"><b>表4 恶意代码家族分类混淆矩阵</b> <a class="downexcel" onclick="DownLoadReportExcel(this)">导出到EXCEL</a></p>
                    <p class="img_tit"></p>
                    <p class="img_note"></p>
                    <table id="112" border="1"><tr><td>恶意代码<br />家族类别</td><td>Ramnit</td><td>Lollipop</td><td>Kelihos_ver3</td><td>Vundo</td><td>Simda</td><td>Tracur</td><td>Kelihos<br />_ver1</td><td>Obfuscator.<br />ACY</td><td>Gatak</td><td>误判率</td></tr><tr><td>Ramnit</td><td>604</td><td>0</td><td>0</td><td>1</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0.001 65</td></tr><tr><td><br />Lollipop</td><td>0</td><td>999</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0.000 00</td></tr><tr><td><br />Kelihos_ver3</td><td>0</td><td>0</td><td>1 189</td><td>0</td><td>0</td><td>0</td><td>1</td><td>0</td><td>0</td><td>0.000 84</td></tr><tr><td><br />Vundo</td><td>1</td><td>0</td><td>0</td><td>189</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0.005 26</td></tr><tr><td><br />Simda</td><td>1</td><td>0</td><td>0</td><td>0</td><td>16</td><td>3</td><td>0</td><td>0</td><td>0</td><td>0.200 00</td></tr><tr><td><br />Tracur</td><td>6</td><td>0</td><td>0</td><td>0</td><td>0</td><td>301</td><td>0</td><td>0</td><td>0</td><td>0.019 54</td></tr><tr><td><br />Kelihos_ver1</td><td>1</td><td>0</td><td>3</td><td>0</td><td>0</td><td>0</td><td>166</td><td>0</td><td>0</td><td>0.023 52</td></tr><tr><td><br />Obfuscator.ACY</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>495</td><td>0</td><td>0.000 00</td></tr><tr><td><br />Gatak</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>6</td><td>366</td><td>0.016 12</td></tr></table>
                    <form name="form" action="/kxreader/Detail/DownloadReportExcel" method="POST" style="display:inline">
                        <input type="hidden" name="hidTable" value="" />
                        <input type="hidden" name="hidFileName" value="" />
                    </form>
                    <p class="img_note"></p>
                    <p class="img_note"></p>
                </div>
                <div class="p1">
                    <p id="113">对数损失函数是衡量分类算法对于各类别恶意代码是否有较高的分类准确率的函数, 定义为:</p>
                </div>
                <div class="p1">
                    <p id="114" class="code-formula">
                        <mathml id="114"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mtext>l</mtext><mtext>b</mtext><mspace width="0.25em" /><mi>l</mi><mi>o</mi><mi>s</mi><mi>s</mi><mo>=</mo><mo>-</mo><mfrac><mn>1</mn><mi>Ν</mi></mfrac><mstyle displaystyle="true"><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>Ν</mi></munderover><mrow><mstyle displaystyle="true"><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>Μ</mi></munderover><mi>y</mi></mstyle></mrow></mstyle><msub><mrow></mrow><mrow><mi>i</mi><mi>j</mi></mrow></msub><mtext>l</mtext><mtext>b</mtext><mspace width="0.25em" /><mi>p</mi><msub><mrow></mrow><mrow><mi>i</mi><mi>j</mi></mrow></msub><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mrow><mtext> </mtext><mtext> </mtext><mtext> </mtext></mrow><mo stretchy="false"> (</mo><mn>9</mn><mo stretchy="false">) </mo></mrow></math></mathml>
                    </p>
                </div>
                <div class="p1">
                    <p id="115">其中, <i>N</i>是恶意代码样本总数, <i>M</i>是恶意代码类别数, <i>y</i><sub><i>ij</i></sub>是样本<i>i</i>预测为第<i>j</i>类, 预测值与实际相符时为1, 否则为0, <i>p</i><sub><i>ij</i></sub>表示样本<i>i</i>属于第<i>j</i>类的概率。</p>
                </div>
                <div class="p1">
                    <p id="116">从表4可知, 组合特征+RF算法对恶意代码家族具有较好的区分能力, 除了样本数较少的第5类, 算法对每一类恶意代码家族误判率都较低 (&lt;3%) 。通过对9个类别的样本进行交叉验证, 分类平均准确率达到99.59%, 对数损失只有0.025 33, 与3个单一特征分类平均准确率相比, 平均分类准确率提高了1.12%, 实验结果说明全局和局部特征结合可以有效地对不同恶意代码家族进行特征描述和分类。随机选取该算法的测试结果, 混淆矩阵图如图4所示。</p>
                </div>
                <div class="area_img" id="117">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JSJC201908046_117.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYyTTc5ZU1kSFJvVW1uVU9FL1g5cz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图4 模型预测类别与实际类别的混淆矩阵" src="Detail/GetImg?filename=images/JSJC201908046_117.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYyTTc5ZU1kSFJvVW1uVU9FL1g5cz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit"><b>图4 模型预测类别与实际类别的混淆矩阵</b>  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JSJC201908046_117.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYyTTc5ZU1kSFJvVW1uVU9FL1g5cz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="p1">
                    <p id="118">在图4中, 纵轴代表9个恶意代码家族的实际类别, 横轴代表预测类别。颜色越深表示预测为此类的概率越大, 图中每一类的分类结果大部分都在对角线位置, 表明实际类别被预测正确的概率较高, 说明应用组合特征+RF算法使得每一类恶意代码家族都能被正确预测和归类。</p>
                </div>
                <h4 class="anchor-tag" id="119" name="119">3.5 性能比较与评价</h4>
                <div class="p1">
                    <p id="120">为验证RF、GBC、DT、逻辑回归 (Logistic Regression, LR) 分类器与不同特征组合算法的分类性能, 将不同组合的特征向量传输到不同的分类器进行多次训练, 结果如表5所示, 与其他算法的结果对比如表6所示。由表5可知, RF分类器在不同组合的特征上都有较好的分类表现, 组合特征比单个特征有更好的分类效果。从所有特征组合来看, 基于决策的分类器平均准确率高于基于距离的分类器, 说明了基于距离的分类器对于分布复杂的特征难以进行线性划分, KNN分类器在对组合有灰度直方图的特征训练时反而比单个特征分类效果差, 说明灰度直方图具有较复杂的分布, 主要原因是灰度直方图只取了颜色信息而忽视了位置信息导致特征向量的复杂分布, 而RF因为2个随机性使得其能够处理高维数据且无需做特征选择, 对复杂分布的特征集依然能够进行较好的训练和分类, 组合特征能够获得更高的准确率。从表5和表6的对比结果可知, “颜色直方图+Opcode N-gram+灰度图纹理+RF”的组合有最佳的分类效果, 证明了本文提出的组合特征能够更加全面描述恶意代码的信息。</p>
                </div>
                <div class="area_img" id="121">
                    <p class="img_tit"><b>表5 不同分类器在不同组合特征上的分类准确率</b> <a class="downexcel" onclick="DownLoadReportExcel(this)">导出到EXCEL</a></p>
                    <p class="img_tit"></p>
                    <p class="img_note"></p>
                    <table id="121" border="1"><tr><td>特征</td><td>RF</td><td>GBC</td><td>DT</td><td>KNN</td><td>LR</td></tr><tr><td><br />颜色直方图</td><td>0.986 6</td><td>0.986 1</td><td>0.977 3</td><td>0.967 4</td><td>0.975 8</td></tr><tr><td><br />Opcode N-gram</td><td>0.981 0</td><td>0.982 4</td><td>0.975 2</td><td>0.963 7</td><td>0.968 7</td></tr><tr><td><br />灰度图纹理</td><td>0.986 6</td><td>0.983 9</td><td>0.967 4</td><td>0.959 5</td><td>0.892 8</td></tr><tr><td><br />颜色直方图+Opcode N-gram</td><td>0.990 4</td><td>0.992 7</td><td>0.985 5</td><td>0.961 7</td><td>0.895 8</td></tr><tr><td><br />颜色直方图+灰度图纹理</td><td>0.994 3</td><td>0.992 4</td><td>0.986 7</td><td>0.957 6</td><td>0.897 2</td></tr><tr><td><br />Opcode N-gram+灰度图纹理</td><td>0.994 5</td><td>0.995 8</td><td>0.991 3</td><td>0.978 1</td><td>0.988 1</td></tr><tr><td><br />颜色直方图+Opcode N-gram+灰度图纹理</td><td>0.995 9</td><td>0.994 7</td><td>0.992 2</td><td>0.959 7</td><td>0.889 7</td></tr><tr><td><br />平均值</td><td>0.992 3</td><td>0.989 7</td><td>0.982 2</td><td>0.963 9</td><td>0.929 7</td></tr></table>
                    <form name="form" action="/kxreader/Detail/DownloadReportExcel" method="POST" style="display:inline">
                        <input type="hidden" name="hidTable" value="" />
                        <input type="hidden" name="hidFileName" value="" />
                    </form>
                    <p class="img_note"></p>
                    <p class="img_note"></p>
                </div>
                <div class="area_img" id="122">
                    <p class="img_tit"><b>表6 算法分类性能对比结果</b> <a class="downexcel" onclick="DownLoadReportExcel(this)">导出到EXCEL</a></p>
                    <p class="img_tit"></p>
                    <p class="img_note"></p>
                    <table id="122" border="1"><tr><td>算法</td><td>特征</td><td>分类器</td><td>准确率</td></tr><tr><td><br />文献[7]算法</td><td>.bytes文件+.asm文件</td><td>SAE</td><td>0.987 7</td></tr><tr><td><br />文献[8]算法</td><td>N-gram</td><td>RF</td><td>0.886 0</td></tr><tr><td><br />本文算法</td><td>颜色直方图+Opcode N-gram+灰度图纹理</td><td>RF</td><td>0.995 6</td></tr></table>
                    <form name="form" action="/kxreader/Detail/DownloadReportExcel" method="POST" style="display:inline">
                        <input type="hidden" name="hidTable" value="" />
                        <input type="hidden" name="hidFileName" value="" />
                    </form>
                    <p class="img_note"></p>
                    <p class="img_note"></p>
                </div>
                <h3 id="123" name="123" class="anchor-tag">4 结束语</h3>
                <div class="p1">
                    <p id="124">本文从恶意代码反编译文件的核心代码出发, 提取了Opcode N-gram和灰度图像纹理2个局部特征, 并提取颜色直方图描述病毒文件的全局特征, 算法由特征提取、训练特征集、聚类三部分组成。实验结果表明, 融合后的特征可以有效描述恶意代码的局部和全局特征, 实现恶意代码的家族分类, 从而证明合理提取和选择有效特征是机器学习算法在实际应用中的关键, 此外验证了恶意代码转化为图像是一个有效的形式。目前深度学习的推进使得神经网络在图像领域得到快速的发展, 通过各级神经元对特征进行层层抽象, 无需人为干预即可提取和筛选特征并挖掘隐藏特征, 因此下一步将利用深度学习的神经网络对恶意代码的灰度图像进行训练, 实现恶意代码特征的自动提取及分类。</p>
                </div>

        <!--brief end-->
        
        <!--conten left  end-->
        <!--增强附件-->
        

        <!--reference start-->
            <div class="reference anchor-tag" id="a_bibliography">
                    <h3>参考文献</h3>
                                        <p id="157">
                            <a id="bibliography_1" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Detecting metamorphic malwares using code graphs">

                                <b>[1]</b> LEE J, JEONG K, LEE H.Detecting metamorphic malwares using code graphs[C]//Proceedings of ACM Symposium on Applied Computing.New York, USA:ACM Press, 2010:1970-1977.
                            </a>
                        </p>
                        <p id="159">
                            <a id="bibliography_2" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Function Length as a Tool for Malware Classification">

                                <b>[2]</b> TIAN R, BATTEN L, VERSTEEG S, et al.Function length as a tool for malware classification[C]//Proceedings of the 3rd International Conference on Malicious and Unwanted Software.Washington D.C., USA:IEEE Press, 2008:369-378.
                            </a>
                        </p>
                        <p id="161">
                            <a id="bibliography_3" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=RJXB201202018&amp;v=Mjk2NThRS0RIODR2UjRUNmo1NE8zenFxQnRHRnJDVVJMT2VaZVJxRkNqbFc3N01OeWZUYkxHNEg5UE1yWTlFYkk=&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYyTTc5ZU1kSFJvVW1uVU9FL1g5cz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[3]</b> 王蕊, 冯登国, 杨轶, 等.基于语义的恶意代码行为特征提取及检测方法[J].软件学报, 2012, 23 (2) :378-393.
                            </a>
                        </p>
                        <p id="163">
                            <a id="bibliography_4" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JFYZ201402014&amp;v=MjI3MDR2UjRUNmo1NE8zenFxQnRHRnJDVVJMT2VaZVJxRkNqbFc3N01MeXZTZExHNEg5WE1yWTlFWUlRS0RIODQ=&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYyTTc5ZU1kSFJvVW1uVU9FL1g5cz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[4]</b> 朱克楠, 尹宝林, 冒亚明, 等.基于有效窗口和朴素贝叶斯的恶意代码分类[J].计算机研究与发展, 2014, 51 (2) :373-381.
                            </a>
                        </p>
                        <p id="165">
                            <a id="bibliography_5" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=TXXB201408016&amp;v=MDk5MzA1NE8zenFxQnRHRnJDVVJMT2VaZVJxRkNqbFc3N01NVFhUYkxHNEg5WE1wNDlFWW9RS0RIODR2UjRUNmo=&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYyTTc5ZU1kSFJvVW1uVU9FL1g5cz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[5]</b> 韩晓光, 曲武, 姚宣霞, 等.基于纹理指纹的恶意代码变种检测方法研究[J].通信学报, 2014, 35 (8) :125-136.
                            </a>
                        </p>
                        <p id="167">
                            <a id="bibliography_6" target="_blank" href="/kcms/detail/detail.aspx?dbcode=SJES&amp;filename=SJES13011301043334&amp;v=MTM5NzdSZEdlcnFRVE1ud1plWnVIeWptVUx2TElGNGNheFk9TmlmT2ZiSzdIdEROckk5RVpPOE1EMzg5b0JNVDZUNFBRSC9pcg==&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYyTTc5ZU1kSFJvVW1uVU9FL1g5cz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[6]</b> ISLAM R, TIAN R H, BATTEN L M, et al.Classification of malware based on integrated static and dynamic features[J].Journal of Network and Computer Applications, 2013, 36 (2) :646-656.
                            </a>
                        </p>
                        <p id="169">
                            <a id="bibliography_7" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Fast Malware Classification by Automated Behavioral Graph Matching">

                                <b>[7]</b> PARK Y, REEVES D, MULUKUTLA V, et al.Fast malware classification by automated behavioral graph matching[C]//Proceedings of the 6th Annual Workshop on Cyber Security and Information Intelligent Research.New York, USA:ACM Press, 2010:156-165.
                            </a>
                        </p>
                        <p id="171">
                            <a id="bibliography_8" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=ZJGD201706003&amp;v=MDIzMDY0VDZqNTRPM3pxcUJ0R0ZyQ1VSTE9lWmVScUZDamxXNzdNUHlmTWFyRzRIOWJNcVk5Rlo0UUtESDg0dlI=&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYyTTc5ZU1kSFJvVW1uVU9FL1g5cz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[8]</b> 王卫红, 朱雨辰.基于N-Gram与加权分类器集成的恶意代码检测[J].浙江工业大学学报, 2017, 45 (6) :604-632.
                            </a>
                        </p>
                        <p id="173">
                            <a id="bibliography_9" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=WXAQ201707003&amp;v=MzE2NzNDamxXNzdNTWpYS2Y3RzRIOWJNcUk5Rlo0UUtESDg0dlI0VDZqNTRPM3pxcUJ0R0ZyQ1VSTE9lWmVScUY=&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYyTTc5ZU1kSFJvVW1uVU9FL1g5cz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[9]</b> 张东, 张尧, 刘刚, 等.基于机器学习算法的主机恶意代码检测技术研究[J].网络与信息安全学报, 2017, 3 (7) :25-31.
                            </a>
                        </p>
                        <p id="175">
                            <a id="bibliography_10" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JSJC201709031&amp;v=MjIzODZHNEg5Yk1wbzlHWllRS0RIODR2UjRUNmo1NE8zenFxQnRHRnJDVVJMT2VaZVJxRkNqbFc3N01MejdCYmI=&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYyTTc5ZU1kSFJvVW1uVU9FL1g5cz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[10]</b> 任卓君, 陈光.熵可视化方法在恶意代码分类中的应用[J].计算机工程, 2017, 43 (9) :167-171.
                            </a>
                        </p>
                        <p id="177">
                            <a id="bibliography_11" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Entropy analysis to classify unknown packing algorithms for malware detection">

                                <b>[11]</b> BAT-ERDENE M, PARK H, LI H, et al.Entropy analysis to classify unknown packing algorithms for malware detection[J].International Journal of Information Security, 2016, 16 (3) :1-22.
                            </a>
                        </p>
                        <p id="179">
                            <a id="bibliography_12" target="_blank" href="/kcms/detail/detail.aspx?dbcode=SJES&amp;filename=SJES14061600101545&amp;v=MDUwMjFMdkxJRjRjYXhZPU5pZk9mYks4SHRmTnFZOUZaZXNPQ1hnOG9CTVQ2VDRQUUgvaXJSZEdlcnFRVE1ud1plWnVIeWptVQ==&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYyTTc5ZU1kSFJvVW1uVU9FL1g5cz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[12]</b> DING Yuxin, DAI Wei, YAN Shengli, et al.Control flowbased opcode behavior analysis for malware detection[J].Computers and Security, 2014, 44:65-74.
                            </a>
                        </p>
                        <p id="181">
                            <a id="bibliography_13" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Multiresolution gray-scale and rotation invariant texture classification with local binary patterns">

                                <b>[13]</b> OJALA T, PIETIKINEN M, MAENPAA T.Multiresolution gray-scale and rotation invariant texture classifacation with local binary patterns[J].IEEE Transactions on Pattern Analysis and Machine Intelligence, 2002, 24 (7) :971-987.
                            </a>
                        </p>
                        <p id="183">
                            <a id="bibliography_14" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Malware images:visualization and automatic classification">

                                <b>[14]</b> NATARAJ L, KARTHIKEYAN S, JACOB G, et al.Malware images:visualization and automatic classification[C]//Proceedings of the 8th International Symposium on visualization for Cyber Security.New York, USA:ACM Press, 2011:4-10.
                            </a>
                        </p>
                        <p id="185">
                            <a id="bibliography_15" target="_blank" href="http://scholar.cnki.net/result.aspx?q=A visual study of primitive binary fragment types">

                                <b>[15]</b> CONTI G, SHUBINA B S.A visual study of primitive binary fragment types[EB/OL].[2018-05-07].https://www.researchgate.net/publication/265356241_A_Visual_Study_of_Primitive_Binary_Fragment_Types.
                            </a>
                        </p>
                        <p id="187">
                            <a id="bibliography_16" target="_blank" href="/kcms/detail/detail.aspx?dbcode=DKFX&amp;filename=BJYD201801001&amp;v=Mjg3NDVyRzRIOW5Ncm85RlpZUUtESDg0dlI0VDZqNTRPM3pxcUJ0R0ZyQ1VSTE9lWmVScUZDamxXNzdNSnlmU2E=&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYyTTc5ZU1kSFJvVW1uVU9FL1g5cz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[16]</b> 崔鸿雁, 徐帅, 张利锋, 等.机器学习中的特征选择方法研究及展望[J].北京邮电大学学报, 2018, 41 (1) :1-9.
                            </a>
                        </p>
                        <p id="189">
                            <a id="bibliography_17" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Microsoft malware classification challenge (BIG 2015)">

                                <b>[17]</b> Kaggle.Microsoft malware classification challenge (BIG 2015) [EB/OL].[2018-05-07].https://kaggle.com/c/maleware classification/.
                            </a>
                        </p>
                        <p id="191">
                            <a id="bibliography_18" target="_blank" href="http://scholar.cnki.net/result.aspx?q=A comparative study on feature selection in text categorization">

                                <b>[18]</b> YANG Y, PEDERSEN J O.A comparative study on feature selection in text categorization[C]//Proceedings of International Conference on Machine Learning.New York, USA:ACM Press, 1997:412-420.
                            </a>
                        </p>
            </div>
        <!--reference end-->
        <!--footnote start-->
        <!--footnote end-->



    </div>

        <input id="fileid" type="hidden" value="JSJC201908046" />
        <input id="dpi" type="hidden" value="600" />
    </div>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?6e967eb120601ea41b9d312166416aa6";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
</script>

    


<input id="hid_uid" name="hid_uid" type="hidden" value="WEEvREcwSlJHSldRa1FhdkJkVG5hVDYyTTc5ZU1kSFJvVW1uVU9FL1g5cz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
<input id="hid_kLogin_headerUrl" name="hid_kLogin_headerUrl" type="hidden" value="/KLogin/Request/GetKHeader.ashx%3Fcallback%3D%3F" />
<input id="hid_kLogin_footerUrl" name="hid_kLogin_footerUrl" type="hidden" value="/KLogin/Request/GetKFooter.ashx%3Fcallback%3D%3F" />
<div class="btn-link" style="display: none"><a target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JSJC201908046&amp;v=MTEzMjNVUkxPZVplUnFGQ2psVzc3TUx6N0JiYkc0SDlqTXA0OUJZb1FLREg4NHZSNFQ2ajU0TzN6cXFCdEdGckM=&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYyTTc5ZU1kSFJvVW1uVU9FL1g5cz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">知网节</a></div>
<div class="popflow" id="popupTips" style="display: none;">
    <div class="popflowArr"></div>
    <div class="popflowCot">
        <div class="hd"><a href="javascript:void(0);" onclick="$('#popupTips').hide();$('#popupmsg').html('')" class="close">X</a></div>
        <div class="bd">
            <p class="mes" id="popupmsg" name="popupmsg"></p>
          
        </div>
    </div>
</div>
<input type="hidden" id="myexport" value="//kns.cnki.net" />

<input type="hidden" id="KPCAPIPATH" value="//ishufang.cnki.net" />
<input type="hidden" id="CitedTimes" value="" />
<div class="link" id="GLSearch" style="display: none;">
    <i class="icon-trangle"></i>
    <div class="inner">
        <a class="icon" id="copytext">复制</a>
        <a class="icon" target="_blank" onclick="searchCRFD(this)">工具书搜索</a>
    </div>
</div>




<input id="hidVirtualPath" name="hidVirtualPath" type="hidden" value="/kxreader" />
<script src="/kxreader/bundles/detail?v=-ULdk-c6FkZHtJA2KAXPgHnyA8mtgyPnBde_C2VZ2BY1"></script>

<script src="/kxreader/Scripts/layer.min.js" type="text/javascript"></script>

<div id="footerBox" class="rootw footer">
</div>
<script>
    if (typeof FlushLogin == 'function') {
        FlushLogin();
    }
    modifyEcpHeader(true);
</script>

<!--图片放大功能 start-->
<script src="/kxreader/bundles/imagebox?v=W4phPu9SNkGcuPeJclikuVE3PpRyIW_gnfjm_19nynI1"></script>

<script type="text/javascript">
    $(function () {
        var j = $.noConflict();
        j(function () {
            j(".zoom-in,.btn-zoomin").imgbox({
                'alignment': 'center',
                'allowMultiple': false,
                'overlayShow': true
            });
        })
    });
</script>
<!--图片放大功能 end-->
<div class="fixedbar">
    <div class="backtop hiddenV" id="backtop">
        <a id="backTopSide" href="javascript:scroll(0,0);" title=""></a>
    </div>
</div>
<script type="text/javascript" src="/kxreader/Scripts/MathJax-2.6-latest/MathJax.js?config=MML_HTMLorMML-full"></script>

</body>
</html>
