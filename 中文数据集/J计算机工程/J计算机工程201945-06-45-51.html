<!DOCTYPE html>
<html>
<head>
    <title>全文阅读--XML全文阅读--中国知网</title>
    <link rel="icon" href="/kxreader/favicon.ico" />
    <link rel="shortcut Icon" href="/kxreader/favicon.ico" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="keywords" content="文献 XML KBASE CNKI 中国知网" />
    <meta name="description" content="XML文献检索" />
    <link href="/kxreader/Content/css/detail?v=qX2z2KjRAEyQiNfAbKtl7dLnsqFoQ5Jdw3TZfDf0n1k1" rel="stylesheet"/>

    <script type="text/javascript">
        var APPPATH = '/kxreader';
    </script>
</head>

<body>
    
<script type="text/javascript" src="//login.cnki.net/TopLogin/api/loginapi/get?type=top&amp;localCSS=&amp;returnurl=%2f%2fkns.cnki.net%2f%2fKXReader%2fDetail%3fTIMESTAMP%3d637130373652176250%26DBCODE%3dCJFD%26TABLEName%3dCJFDLAST2019%26FileName%3dJSJC201906008%26RESULT%3d1%26SIGN%3dGN3fR9f1VUVqKgk8T2In8wKhQac%253d"></script>

<div id="headerBox" class="header">
    <div class="topbar">
        <div class="textalign">
            <a href="/kxreader/Detail?dbcode=CJFD&amp;filename=JSJC201906008&amp;align=md">
                <i class="icon-cen active" title="居中对齐"></i>
            </a>
            <a href="/kxreader/Detail?dbcode=CJFD&amp;filename=JSJC201906008&amp;align=lt">
                <i class="icon-left " title="左对齐"></i>
            </a>
        </div>
        <h6 class="free-tip"><i class="icon"></i>HTML阅读开放试用阶段，欢迎体验！</h6>
    </div>
</div>

    



<div class="btn-link" style="display: none"><a target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JSJC201906008&amp;v=MDAwNDFyQ1VSTE9lWmVSb0Z5bmxVYjdPTHo3QmJiRzRIOWpNcVk5RmJJUUtESDg0dlI0VDZqNTRPM3pxcUJ0R0Y=&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQxQTZSZWp6VHBWMkMvWVdDaHZmUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">知网节</a></div>

    <div class="main">

        

    <div class="sidebar-a">
        <!--sidebar start-->
        <div class="sidenav">
            <div class="arrow"><span></span></div>
            <!--sidebar_list start-->
            <dl class="sidenav-list">
                    <dt class="tit">目录结构</dt>
                            <dd class="guide">
                                    <p><a href="#37" data-title="0 概述 ">0 概述</a><i></i></p>
                                                            </dd>
                            <dd class="guide">
                                    <p><a href="#40" data-title="1 背景介绍 ">1 背景介绍</a><i></i></p>
                                                                    <ul class="contentbox">
                                                <li><a href="#41" data-title="1.1 神威&#183;太湖之光">1.1 神威·太湖之光</a></li>
                                                <li><a href="#44" data-title="1.2 SW26010异构众核处理器">1.2 SW26010异构众核处理器</a></li>
                                    </ul>
                            </dd>
                            <dd class="guide">
                                    <p><a href="#53" data-title="2 相关工作 ">2 相关工作</a><i></i></p>
                                                            </dd>
                            <dd class="guide">
                                    <p><a href="#59" data-title="3 OpenFoam基础数据结构 ">3 OpenFoam基础数据结构</a><i></i></p>
                                                            </dd>
                            <dd class="guide">
                                    <p><a href="#64" data-title="4 众核并行排序算法 ">4 众核并行排序算法</a><i></i></p>
                                                                    <ul class="contentbox">
                                                <li><a href="#65" data-title="4.1 基本思想">4.1 基本思想</a></li>
                                                <li><a href="#73" data-title="4.2 算法结构">4.2 算法结构</a></li>
                                    </ul>
                            </dd>
                            <dd class="guide">
                                    <p><a href="#80" data-title="5 通量计算众核优化 ">5 通量计算众核优化</a><i></i></p>
                                                            </dd>
                            <dd class="guide">
                                    <p><a href="#131" data-title="6 实验结果与分析 ">6 实验结果与分析</a><i></i></p>
                                                                    <ul class="contentbox">
                                                <li><a href="#132" data-title="6.1 优化过程分析">6.1 优化过程分析</a></li>
                                                <li><a href="#141" data-title="6.2 不同算例优化效果对比">6.2 不同算例优化效果对比</a></li>
                                                <li><a href="#144" data-title="6.3 数据分块大小对算法性能的影响">6.3 数据分块大小对算法性能的影响</a></li>
                                                <li><a href="#149" data-title="6.4 众核并行优化的负载均衡效果">6.4 众核并行优化的负载均衡效果</a></li>
                                    </ul>
                            </dd>
                            <dd class="guide">
                                    <p><a href="#151" data-title="7 结束语 ">7 结束语</a><i></i></p>
                                                            </dd>
                            <dd class="guide">
                                    <p><a href="#" data-title="文内图表 ">文内图表</a><i></i></p>
                                                                    <ul class="contentbox">
                                                <li><a href="#43" data-title="&lt;b&gt;图1 神威&#183;太湖之光系统体系结构&lt;/b&gt;"><b>图1 神威·太湖之光系统体系结构</b></a></li>
                                                <li><a href="#46" data-title="&lt;b&gt;图2 SW26010异构众核处理器架构&lt;/b&gt;"><b>图2 SW26010异构众核处理器架构</b></a></li>
                                                <li><a href="#61" data-title="&lt;b&gt;图3 COO存储格式示意图&lt;/b&gt;"><b>图3 COO存储格式示意图</b></a></li>
                                                <li><a href="#63" data-title="&lt;b&gt;图4 OpenFoam稀疏对称矩阵数据存储方式&lt;/b&gt;"><b>图4 OpenFoam稀疏对称矩阵数据存储方式</b></a></li>
                                                <li><a href="#68" data-title="&lt;b&gt;图5 网格划分算法示意图&lt;/b&gt;"><b>图5 网格划分算法示意图</b></a></li>
                                                <li><a href="#75" data-title="&lt;b&gt;图6 众核并行排序算法结构&lt;/b&gt;"><b>图6 众核并行排序算法结构</b></a></li>
                                                <li><a href="#94" data-title="&lt;b&gt;图7 通量计算众核优化示意图&lt;/b&gt;"><b>图7 通量计算众核优化示意图</b></a></li>
                                                <li><a href="#140" data-title="&lt;b&gt;图8 通量计算众核优化的时间与加速比效果&lt;/b&gt;"><b>图8 通量计算众核优化的时间与加速比效果</b></a></li>
                                                <li><a href="#143" data-title="&lt;b&gt;表1 本文算法对不同网格规模的优化性能对比&lt;/b&gt;"><b>表1 本文算法对不同网格规模的优化性能对比</b></a></li>
                                                <li><a href="#148" data-title="&lt;b&gt;图9 数据块大小对算法性能的影响&lt;/b&gt;"><b>图9 数据块大小对算法性能的影响</b></a></li>
                                    </ul>
                            </dd>
                                    <dd class="guide">
                                        <h6>
                                            <p><a href="#a_bibliography">参考文献</a> </p>
                                        </h6>
                                    </dd>

            </dl>
        </div>
        <!--sidebar end-->
        &nbsp;
        <!--此处有一空格符 勿删-->
    </div>

                <div class="sidebar-b three-collumn" style="width:0;">
            <div class="refer" style="width: 0;">
                <div class="arrow off" title="参考文献"><span></span></div>
                <div class="js-scrollbox" >
                    
                    <div class="subbox active">
                        <h4>
                            <span class="tit">参考文献</span>
                            <a class="close" href="javascript:void(0)">x</a>
                        </h4>
                        <div class="side-scroller">
                            <ul class="refer-list">
                                <li id="5">


                                    <a id="bibliography_1" title=" ZHENG Fang, LI Hongliang, LV Hui, et al.Cooperative computing techniques for a deeply fused and hetero-geneous many-core processor architecture[J].Journal of Computer Science and Technology, 2015, 30 (1) :145-162." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=SSJD&amp;filename=SSJD15012800006244&amp;v=MTg0NjdHZXJxUVRNbndaZVp1SHlqbVVMbklJVjRXYXhRPU5qN0Jhcks5SHRET3A0OUZaT3NKRG5nOW9CTVQ2VDRQUUgvaXJSZA==&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQxQTZSZWp6VHBWMkMvWVdDaHZmUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[1]</b>
                                         ZHENG Fang, LI Hongliang, LV Hui, et al.Cooperative computing techniques for a deeply fused and hetero-geneous many-core processor architecture[J].Journal of Computer Science and Technology, 2015, 30 (1) :145-162.
                                    </a>
                                </li>
                                <li id="7">


                                    <a id="bibliography_2" title=" FU Haohuan, LIAO Junfeng, YANG Jinzhe, et al.The Sunway TaihuLight supercomputer:system and appli-cations[J].Science China (Information Sciences) , 2016, 59 (7) :072001." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JFXG201607011&amp;v=MDYzMzR6cXFCdEdGckNVUkxPZVplUm9GeW5sVWI3T0x5dlRhYkc0SDlmTXFJOUVaWVFLREg4NHZSNFQ2ajU0TzM=&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQxQTZSZWp6VHBWMkMvWVdDaHZmUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[2]</b>
                                         FU Haohuan, LIAO Junfeng, YANG Jinzhe, et al.The Sunway TaihuLight supercomputer:system and appli-cations[J].Science China (Information Sciences) , 2016, 59 (7) :072001.
                                    </a>
                                </li>
                                <li id="9">


                                    <a id="bibliography_3" title=" FU Haohuan, LIAO Junfeng, DING Nan, et al.Redesigning CAM-SE for peta-scale climate modeling performance and ultra-high resolution on Sunway TaihuLight[C]//Proceedings of International Conference for High Performance Computing, Networking, Torage and Analysis.New York, USA:ACM Press, 2017:25-36." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Redesigning CAM-SE for peta-scale climate modeling performance and ultra-high resolution on Sunway TaihuLight">
                                        <b>[3]</b>
                                         FU Haohuan, LIAO Junfeng, DING Nan, et al.Redesigning CAM-SE for peta-scale climate modeling performance and ultra-high resolution on Sunway TaihuLight[C]//Proceedings of International Conference for High Performance Computing, Networking, Torage and Analysis.New York, USA:ACM Press, 2017:25-36.
                                    </a>
                                </li>
                                <li id="11">


                                    <a id="bibliography_4" title=" 杨广文, 赵文来, 丁楠, 等.“神威&#183;太湖之光”及其应用系统[J].科学, 2017, 69 (3) :12-16." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=KXZZ201703005&amp;v=MjY1MDBGckNVUkxPZVplUm9GeW5sVWI3T0xqWFJkTEc0SDliTXJJOUZZWVFLREg4NHZSNFQ2ajU0TzN6cXFCdEc=&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQxQTZSZWp6VHBWMkMvWVdDaHZmUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[4]</b>
                                         杨广文, 赵文来, 丁楠, 等.“神威&#183;太湖之光”及其应用系统[J].科学, 2017, 69 (3) :12-16.
                                    </a>
                                </li>
                                <li id="13">


                                    <a id="bibliography_5" >
                                        <b>[5]</b>
                                     漆锋滨.“神威&#183;太湖之光”超级计算机[EB/OL].[2018-03-20].https://www.ccf.org.cn/c/2017-10-13/615850.shtml.</a>
                                </li>
                                <li id="15">


                                    <a id="bibliography_6" title=" ANDERSON W K, GROPP W D, KAUSHIK D K, et al.Achieving high sustained performance in an unstructured Mesh CFD application[C]//Proceedings of 1999 ACM/IEEE Conference on Supercomputing.Washington D.C., USA:IEEE Press, 1999:69-79." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Achieving high sustained performance in an unstructured mesh CFD application">
                                        <b>[6]</b>
                                         ANDERSON W K, GROPP W D, KAUSHIK D K, et al.Achieving high sustained performance in an unstructured Mesh CFD application[C]//Proceedings of 1999 ACM/IEEE Conference on Supercomputing.Washington D.C., USA:IEEE Press, 1999:69-79.
                                    </a>
                                </li>
                                <li id="17">


                                    <a id="bibliography_7" title=" BOLZ J, FARMER I, GRINSPUN E, et al.Sparse matrix solvers on the GPU:conjugate gradients and multi-grid[C]//Proceedings of SIGGRAPH’05.New York, USA:ACM Press, 2005:917-924." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Sparse matrix solvers on the GPU:conjugate gradients and multi-grid">
                                        <b>[7]</b>
                                         BOLZ J, FARMER I, GRINSPUN E, et al.Sparse matrix solvers on the GPU:conjugate gradients and multi-grid[C]//Proceedings of SIGGRAPH’05.New York, USA:ACM Press, 2005:917-924.
                                    </a>
                                </li>
                                <li id="19">


                                    <a id="bibliography_8" title=" KOZA Z, MATYKA M, ASZKODA S, et al.Compressed multirow storage format for sparse matrices on graphics processing units[J].SIAM Journal on Scientific Computing, 2014, 36 (2) :219-239." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Compressed multirow storage format for sparse matrices on graphics processing units">
                                        <b>[8]</b>
                                         KOZA Z, MATYKA M, ASZKODA S, et al.Compressed multirow storage format for sparse matrices on graphics processing units[J].SIAM Journal on Scientific Computing, 2014, 36 (2) :219-239.
                                    </a>
                                </li>
                                <li id="21">


                                    <a id="bibliography_9" title=" LI Changxi.Toward efficient spMv on Sunway many-core processors[EB/OL].[2018-03-20].http://ics2018.ict.ac.cn/essay/ics18-final141.pdf." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Toward efficient spMv on Sunway many-core processors">
                                        <b>[9]</b>
                                         LI Changxi.Toward efficient spMv on Sunway many-core processors[EB/OL].[2018-03-20].http://ics2018.ict.ac.cn/essay/ics18-final141.pdf.
                                    </a>
                                </li>
                                <li id="23">


                                    <a id="bibliography_10" title=" GREATHOUSE J L, DAGA M.Efficient sparse matrix-vector multiplication on GPUs using the CSR storage format[C]//Proceedings of International Conference for High Performance Computing, Networking, Storage and Analysis.Washington D.C., USA:IEEE Press, 2014:769-780." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Efficient sparse matrix-vector multiplication on GPUs using the CSR storage format">
                                        <b>[10]</b>
                                         GREATHOUSE J L, DAGA M.Efficient sparse matrix-vector multiplication on GPUs using the CSR storage format[C]//Proceedings of International Conference for High Performance Computing, Networking, Storage and Analysis.Washington D.C., USA:IEEE Press, 2014:769-780.
                                    </a>
                                </li>
                                <li id="25">


                                    <a id="bibliography_11" title=" ASHARI A, SEDAGHATI N, EISENLOHR J, et al.Fast sparse matrix-vector multiplication on GPUs for graph applications[C]//Proceedings of International Conference for High Performance Computing, Networking, Storage and Analysis.Washington D.C., USA:IEEE Press, 2014:781-792." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Fast sparse matrix-vector multiplication on GPUs for graph applications">
                                        <b>[11]</b>
                                         ASHARI A, SEDAGHATI N, EISENLOHR J, et al.Fast sparse matrix-vector multiplication on GPUs for graph applications[C]//Proceedings of International Conference for High Performance Computing, Networking, Storage and Analysis.Washington D.C., USA:IEEE Press, 2014:781-792.
                                    </a>
                                </li>
                                <li id="27">


                                    <a id="bibliography_12" >
                                        <b>[12]</b>
                                     王欣亮.关键稀疏数值计算核心在国产众核架构上的性能优化研究[D].北京:清华大学, 2018.</a>
                                </li>
                                <li id="29">


                                    <a id="bibliography_13" title=" MOUKALLED F, MANGANI L, DARWISH M.The finite volume method in computational fluid dynamics:an advanced introduction with OpenFOAM and Matlab[M].Berlin, Germany:Springer, 2015:173-207." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=The finite volume method in computational fluid dynamics:an advanced introduction with OpenFOAM and Matlab">
                                        <b>[13]</b>
                                         MOUKALLED F, MANGANI L, DARWISH M.The finite volume method in computational fluid dynamics:an advanced introduction with OpenFOAM and Matlab[M].Berlin, Germany:Springer, 2015:173-207.
                                    </a>
                                </li>
                                <li id="31">


                                    <a id="bibliography_14" title=" 刘鑫, 陆林生, 陈德训.非结构网格并行计算预处理方法研究[J].计算机科学, 2012, 39 (3) :308-311." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JSJA201203070&amp;v=MTkxNjlqNTRPM3pxcUJ0R0ZyQ1VSTE9lWmVSb0Z5bmxVYjdPTHo3QmI3RzRIOVBNckk5Q1pJUUtESDg0dlI0VDY=&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQxQTZSZWp6VHBWMkMvWVdDaHZmUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[14]</b>
                                         刘鑫, 陆林生, 陈德训.非结构网格并行计算预处理方法研究[J].计算机科学, 2012, 39 (3) :308-311.
                                    </a>
                                </li>
                                <li id="33">


                                    <a id="bibliography_15" title=" 李宗哲.非结构网格的并行多重网格算法研究[D].长沙:国防科技大学, 2012." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CDFD&amp;filename=1014048572.nh&amp;v=MTU3MjRHck84RnRUTHJaRWJQSVFLREg4NHZSNFQ2ajU0TzN6cXFCdEdGckNVUkxPZVplUm9GeW5sVWI3T1ZGMjY=&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQxQTZSZWp6VHBWMkMvWVdDaHZmUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[15]</b>
                                         李宗哲.非结构网格的并行多重网格算法研究[D].长沙:国防科技大学, 2012.
                                    </a>
                                </li>
                                <li id="35">


                                    <a id="bibliography_16" >
                                        <b>[16]</b>
                                     陈德训, 刘鑫.神威&#183;太湖之光并行程序设计与优化[EB/OL].[2018-03-20].http://www.nsccwx.cn/process.php?word=process&amp;amp;i=54.</a>
                                </li>
                            </ul>
                            <div style='display: none;' class="zqscroller" >
                                <h4 class="">附加材料</h4>
                                <ul></ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            &nbsp;
            <!--此处有一空格符 勿删-->
        </div>

        
    <div class="content">



        <!--tips start-->
                            <div class="tips">
                    <a href="http://navi.cnki.net/KNavi/JournalDetail?pcode=CJFD&amp;pykm=JSJC" target="_blank">计算机工程</a>
                2019,45(06),45-51 DOI:10.19678/j.issn.1000-3428.0051226            </div>
        <!--tips end-->
            <div class="top-title">
                <h1 class="title">
                    <span class="vm"><b>基于神威·太湖之光的非结构网格众核优化技术</b></span>
 <span class="shoufa"></span>                                     </h1>

            </div>
                        <h2>
                                <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=au&amp;skey=%E5%80%AA%E9%B8%BF&amp;code=40355298&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQxQTZSZWp6VHBWMkMvWVdDaHZmUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">倪鸿</a>
                                <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=au&amp;skey=%E5%88%98%E9%91%AB&amp;code=35076964&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQxQTZSZWp6VHBWMkMvWVdDaHZmUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">刘鑫</a>
                </h2>
                    <h2>
                    <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=in&amp;skey=%E5%9B%BD%E5%AE%B6%E5%B9%B6%E8%A1%8C%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%B7%A5%E7%A8%8B%E6%8A%80%E6%9C%AF%E7%A0%94%E7%A9%B6%E4%B8%AD%E5%BF%83&amp;code=0068310&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQxQTZSZWp6VHBWMkMvWVdDaHZmUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">国家并行计算机工程技术研究中心</a>
            </h2>

        
<div class="link">
    <a id="aexport" class="icon icon-output"  onclick="" href="javascript:void(0);"><i></i>导出/参考文献</a>
    
    <span class="shareBoard" onmouseover="$('#sharedet').show();$('#this').addClass('shareBoardCUR')" onmouseout="$('#sharedet').hide();$('#this').removeClass('shareBoardCUR')">
        <a class="icon icon-share" href="#"><i></i>分享<em></em></a>
        <ul class="shareHide" id="sharedet" style="display: none;">
            <li><a title="复制链接" class="copy" onclick="" href="#"><i></i>复制链接</a></li>
            <li><a title="分享到新浪微博" class="xl" onclick="" href="javascript:common.ShareAction('xl');"><i></i>新浪微博</a></li>
            <li>
                <a title="分享到微信" class="wx" onclick="" href="#"><i></i>微信扫一扫</a>
                <div class="qrcode"><img src='' alt='' /></div>
            </li>
        </ul>

    </span>
    
    <a id="RefTrack" title="创建引文跟踪" class="icon icon-track" onclick="" href="javascript:void(0);"> <i></i>创建引文跟踪 </a>
    <a id="ashoucang" title="收藏" class="icon icon-favor" onclick="" href="javascript:void(0);"><i></i>收藏</a>
    <a class="icon icon-print" onclick="window.print();" href="javascript:void(0);"><i></i>打印</a>
    
    <!--版本切换 end-->
</div>
                            <div class="data" id="a_abstract">
                <span class="keys">摘<span style="font-family: 'Times New Roman';">&nbsp;&nbsp;&nbsp;&nbsp;</span>要：</span>
                <p>为解决高性能计算中的非结构网格离散访存问题, 以神威·太湖之光国产超级计算机为平台, 根据异构众核处理器SW26010的体系结构特点, 提出一种基于排序思想的通用众核优化算法, 以减少非结构网格计算中的随机访存。基于网格划分原理, 在<i>O</i> (<i>n</i>) 时间内对生成的稀疏矩阵非零元素进行并行重排序。采用一种内部映射方式对计算向量实现扩展或变换, 将细粒度访存转化为无写冲突的粗粒度访存。对多个实际应用算例的通量计算进行众核优化, 结果表明, 相比主核上的串行算法, 该算法能够获得平均10倍以上的加速效果。</p>
            </div>
                    <div class="data" id="a_keywords">
                <span class="keys">关键词：</span>
                <p>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=%E7%A6%BB%E6%95%A3%E8%AE%BF%E5%AD%98&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQxQTZSZWp6VHBWMkMvWVdDaHZmUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">离散访存;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=%E9%9D%9E%E7%BB%93%E6%9E%84%E7%BD%91%E6%A0%BC&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQxQTZSZWp6VHBWMkMvWVdDaHZmUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">非结构网格;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=%E9%80%9A%E9%87%8F%E8%AE%A1%E7%AE%97&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQxQTZSZWp6VHBWMkMvWVdDaHZmUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">通量计算;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=%E5%BC%82%E6%9E%84%E4%BC%97%E6%A0%B8%E4%BC%98%E5%8C%96&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQxQTZSZWp6VHBWMkMvWVdDaHZmUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">异构众核优化;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=%E5%B9%B6%E8%A1%8C%E6%8E%92%E5%BA%8F&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQxQTZSZWp6VHBWMkMvWVdDaHZmUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">并行排序;</a>
                </p>
            </div>
        
        <!--brief start-->
        
            <div class="brief">
                    <p>
                            <b>作者简介：</b>
                                                        <span>
                                    倪鸿 (1989—) , 男, 工程师、硕士, 主研方向为并行算法及应用;;
                                </span>
                                <span>
                                    刘鑫, 副研究员、博士。;
                                </span>
                    </p>
                                    <p><b>收稿日期：</b>2018-04-16</p>

                    <p>

                            <b>基金：</b>
                                                        <span>国家重点研发计划“大规模多模式多过程地球系统模式耦合平台开发” (2016YFA0602200);</span>
                    </p>
            </div>
                    <h1><b>Multi-Core Optimization Technology of Unstructured Grid Based on Sunway TaihuLight</b></h1>
                    <h2>
                    <span>NI Hong</span>
                    <span>LIU Xin</span>
            </h2>
                    <h2>
                    <span>National Research Centre of Parallel Computer Engineering and Technology</span>
            </h2>
                            <div class="data" id="a_abstractEN">
                <span class="keys">Abstract：</span>
                <p>In order to solve discrete memory access problem of unstructured grid in high performance computing, this paper proposes a general multi-core optimization algorithm according to the architecture features of the heterogeneous multi-core processor SW26010.This algorithm takes the Chinese supercomputer, Sunway TaihuLight, as the platform, and is based on a sorting approach.Based on the principle of mesh generation, generated non-zero elements of the sparse matrix are reordered in <i>O</i> (<i>n</i>) time.An internal mapping method is used to extend or transform the computational vectors, and the fine-grained memory access is transformed into the coarse-grained access without writing conflicts.Multi-core optimization is carried out for the flux calculation in several practical examples.Experimental results show that compared with the serial algorithm on the main core, the proposed algorithm can achieve an average acceleration of more than 10 times.</p>
            </div>
                    <div class="data" id="a_keywordsEN">
                <span class="keys">Keyword：</span>
                <p>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=discrete%20memory%20access&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQxQTZSZWp6VHBWMkMvWVdDaHZmUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">discrete memory access;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=unstructured%20grid&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQxQTZSZWp6VHBWMkMvWVdDaHZmUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">unstructured grid;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=flux%20calculation&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQxQTZSZWp6VHBWMkMvWVdDaHZmUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">flux calculation;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=heterogeneous%20multi-core%20optimization&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQxQTZSZWp6VHBWMkMvWVdDaHZmUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">heterogeneous multi-core optimization;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=parallel%20sorting&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQxQTZSZWp6VHBWMkMvWVdDaHZmUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">parallel sorting;</a>
                </p>
            </div>
                    <div class="brief">
                
                    <p>
                                            </p>
                                    <p><b>Received：</b> 2018-04-16</p>
                                    <p>
                                            </p>
            </div>


        <!--brief start-->
                        <h3 id="37" name="37" class="anchor-tag">0 概述</h3>
                <div class="p1">
                    <p id="38">近年来, 非结构网格技术作为计算流体力学 (Computational Fluid Dynamics, CFD) 领域的重要研究内容之一, 被广泛应用于航空发动机模拟<citation id="153" type="reference"><link href="5" rel="bibliography" /><sup>[<a class="sup">1</a>]</sup></citation>、大型船舶建设、地震仿真<citation id="154" type="reference"><link href="7" rel="bibliography" /><sup>[<a class="sup">2</a>]</sup></citation>、气候变化模拟<citation id="155" type="reference"><link href="9" rel="bibliography" /><sup>[<a class="sup">3</a>]</sup></citation>等具有复杂外形或高精度要求的工程计算中。受几何形体与空间位置的影响, 非结构网格在求解中需要较多的内存空间来存储位置信息。同时, 数据存放的无序性也给非结构网格带来离散访存问题。随着网格规模的增加, 离散访存问题越来越突出, 对计算效率产生的负面影响也呈倍数增长, 在进行基于异构众核处理器的大规模计算时, 该问题甚至成为技术发展的主要性能瓶颈。</p>
                </div>
                <div class="p1">
                    <p id="39">本文基于国产超级计算机神威·太湖之光<citation id="156" type="reference"><link href="11" rel="bibliography" /><sup>[<a class="sup">4</a>]</sup></citation>平台, 在开源CFD应用软件OpenFoam框架下进行众核优化研究。在一般情况下, 受限于众核并行规模与高速缓存空间的大小, 普通的众核并行排序算法面向大规模数据时效率较低且难以实现。本文针对非结构网格的特点, 提出一种适应于任意网格规模的众核并行排序算法, 以解决高性能计算中的离散访存问题。</p>
                </div>
                <h3 id="40" name="40" class="anchor-tag">1 背景介绍</h3>
                <h4 class="anchor-tag" id="41" name="41">1.1 神威·太湖之光</h4>
                <div class="p1">
                    <p id="42">神威·太湖之光是目前世界排名第三的国产超级计算机 (2018年11月12日数据) , 峰值运算速度为125.436 PFlops, 持续运算速度为93.015 PFlops, 性能功耗比为6 051.131 MFlops/W, 访存总带宽为 4 473.16 TB/s, 采用基于高密度弹性超节点和高流量复合网络、面向多目标优化的高效能体系结构。神威·太湖之光系统采用40 960块SW26010异构众核处理器, 通过计算插件板、计算超节点和计算机仓等模块进行系统扩展, 由高速计算系统、辅助计算系统、高速计算互连网络、辅助计算互连网络、高速计算存储系统、辅助计算存储系统以及相应的软件系统组成。系统总体结构如图1所示。</p>
                </div>
                <div class="area_img" id="43">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JSJC201906008_043.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQxQTZSZWp6VHBWMkMvWVdDaHZmUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图1 神威&#183;太湖之光系统体系结构" src="Detail/GetImg?filename=images/JSJC201906008_043.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQxQTZSZWp6VHBWMkMvWVdDaHZmUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit"><b>图1 神威·太湖之光系统体系结构</b>  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JSJC201906008_043.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQxQTZSZWp6VHBWMkMvWVdDaHZmUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <h4 class="anchor-tag" id="44" name="44">1.2 SW26010异构众核处理器</h4>
                <div class="p1">
                    <p id="45">SW26010异构众核处理器<citation id="157" type="reference"><link href="13" rel="bibliography" /><sup>[<a class="sup">5</a>]</sup></citation>的具体结构如图2所示。该处理器集成了4个运算核组, 共 260个运算核心, 每个核组包括1个运算控制核心 (主核) 和1个运算核心阵列 (从核阵列) , 运算核心阵列由64个运算核心 (从核) 、阵列控制器、二级指令Cache构成, 运算控制核心和运算核心均可以访问芯片上的所有主存空间。</p>
                </div>
                <div class="area_img" id="46">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JSJC201906008_046.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQxQTZSZWp6VHBWMkMvWVdDaHZmUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图2 SW26010异构众核处理器架构" src="Detail/GetImg?filename=images/JSJC201906008_046.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQxQTZSZWp6VHBWMkMvWVdDaHZmUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit"><b>图2 SW26010异构众核处理器架构</b>  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JSJC201906008_046.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQxQTZSZWp6VHBWMkMvWVdDaHZmUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="p1">
                    <p id="47">SW26010异构众核处理器的工作频率为1.45 GHz, 理论内存带宽为130 GB/s。在内存结构中, 每个众核处理器内存配置为32 GB, 每个核组本地内存为8 GB, 从核可以通过Gload/Gstore直接离散访问主存, 也可以通过DMA (Direct Memory Access) 的方式批量访问主存。每个运算控制核心有32 KB一级数据缓存和256 KB二级指令数据缓存。每个运算核心拥有16 KB一级指令缓存和64 KB局部存储空间 (LDM) 。从核阵列按照8×8模式划分, 在从核阵列之间存在一个低延迟寄存器通信网络, 可以使从核阵列进行相互通信。目前, SW26010异构众核优化主要面临以下2个挑战:</p>
                </div>
                <div class="p1">
                    <p id="48">1) 内存带宽受限。与稠密矩阵运算相比, 稀疏矩阵求解性能较差, 通常只有稠密矩阵峰值运算性能的10%～20%<citation id="158" type="reference"><link href="15" rel="bibliography" /><sup>[<a class="sup">6</a>]</sup></citation>, 这也是多数超级计算机存在的问题。SW26010处理器有2种数据传输方式:</p>
                </div>
                <div class="p1">
                    <p id="49"> (1) 通过DMA方式在从核LDM与主存之间进行批量数据传输。</p>
                </div>
                <div class="p1">
                    <p id="50"> (2) 直接通过Gload/Gstore指令对主存进行随机访问。</p>
                </div>
                <div class="p1">
                    <p id="51">基准测试结果显示, 采用Gload/Gstore指令时访存带宽分别只有2.5 GB/s和1.0 GB/s, 而DMA方式的访存带宽则达26.0 GB/s。显然, 采用DMA方式进行数据传输具有更好的性能, 但需要解决离散数据批量传输的问题。</p>
                </div>
                <div class="p1">
                    <p id="52">2) LDM存储受限。非结构网格离散宽度 (在稀疏矩阵中, 表示非零元素值距离该行对角线的最大区间跨度) 很大, 即使对最后生成的网格进行重命名优化, 离散宽度仍约为网格规模的8%～10%。此外, 从核LDM空间受限于64 KB大小, 无法存储大量的冗余数据。因此, 如何提高LDM的利用率也是目前亟需解决的问题之一。</p>
                </div>
                <h3 id="53" name="53" class="anchor-tag">2 相关工作</h3>
                <div class="p1">
                    <p id="54">在非结构网格中, 离散访存所面临的困难主要体现在3个方面:数据局部性较差, 负载不均衡, 写冲突。目前, 有学者对在线程级并行中解决离散访存问题展开研究并取得了一定成果:</p>
                </div>
                <div class="p1">
                    <p id="55">1) 对于数据局部性差的问题, 需要对存储格式进行改进。在GPU架构上, 普遍采用行压缩存储 (CSR) 的存储格式<citation id="159" type="reference"><link href="17" rel="bibliography" /><sup>[<a class="sup">7</a>]</sup></citation>。文献<citation id="160" type="reference">[<a class="sup">8</a>]</citation>对CSR进行改进, 提出一种CSMR存储方法, 以提高数据的复用性。在申威众核处理器上, 文献<citation id="161" type="reference">[<a class="sup">9</a>]</citation>提出分块CSR格式存储。上述研究都对稀疏矩阵的存储格式进行了一定改进。</p>
                </div>
                <div class="p1">
                    <p id="56">2) 对于负载不均衡的问题, 文献<citation id="163" type="reference">[<a class="sup">10</a>,<a class="sup">11</a>]</citation>分别提出CSR-Adapter方法与ACSR方法, 2种方法都能够较好地解决负载均衡问题。在申威处理器上, 文献<citation id="162" type="reference">[<a class="sup">12</a>]</citation>采用缓冲判断策略结合二维负载均衡划分, 以解决负载均衡问题。</p>
                </div>
                <div class="p1">
                    <p id="57">3) 对于写冲突问题, 由于硬件原子操作的机制, 写冲突在GPU上可以通过硬件来避免, 但在申威处理器上, 并没有类似机制的原子操作, 传统解决写冲突的方法不能取得良好效果。为此, 文献<citation id="164" type="reference">[<a class="sup">12</a>]</citation>采用寄存器通信的方法来避免写冲突, 实验结果验证了该方法的有效性。</p>
                </div>
                <div class="p1">
                    <p id="58">本文基于网格划分算法原理, 提出一种适用于多数存储格式、无需对存储方式进行改动的众核优化方法。通过一种内部映射方式对计算向量进行扩展或变换, 从而避免写冲突。此外, 在任务并行划分时对向量块进行均匀划分, 以解决负载不均衡问题。</p>
                </div>
                <h3 id="59" name="59" class="anchor-tag">3 OpenFoam基础数据结构</h3>
                <div class="p1">
                    <p id="60">OpenFoam是一个面向对象的CFD类库, 受到CFD开发者和科研人员的广泛青睐。在OpenFoam中, 稀疏对称矩阵按照Coordinate (COO) 格式存储<citation id="165" type="reference"><link href="29" rel="bibliography" /><sup>[<a class="sup">13</a>]</sup></citation>, 矩阵上每个非零元素用一个三元组 (行号, 列号, 数值) 来表示。COO存储格式如图3所示。</p>
                </div>
                <div class="area_img" id="61">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JSJC201906008_061.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQxQTZSZWp6VHBWMkMvWVdDaHZmUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图3 COO存储格式示意图" src="Detail/GetImg?filename=images/JSJC201906008_061.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQxQTZSZWp6VHBWMkMvWVdDaHZmUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit"><b>图3 COO存储格式示意图</b>  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JSJC201906008_061.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQxQTZSZWp6VHBWMkMvWVdDaHZmUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="p1">
                    <p id="62">整个稀疏对称矩阵分为3个部分:对角部分 (<b><i>Diag</i></b>) , 上三角部分 (<b><i>Upper</i></b>) , 下三角部分 (<b><i>Lower</i>) 。<i>Diag</i></b>即网格单元数据, <b><i>Upper</i>、<i>Lower</i></b>即网格面数据, 如图4所示。在实际运算时, <b><i>Diag</i></b>向量按对角线存储对角部分元素, <b><i>Lower</i></b>向量按列存储下三角部分非零元素, <b><i>Upper</i></b>向量按行存储上三角部分非零元素。因此, 只观察这3个向量将无法获知这些值在矩阵中的分布, 需要参考对应行、列号来确定位置。由矩阵的对称性可知, 按照上述存储方式, <b><i>Lower</i></b>向量值与<b><i>Upper</i></b>向量值将一一对应相等。</p>
                </div>
                <div class="area_img" id="63">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JSJC201906008_063.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQxQTZSZWp6VHBWMkMvWVdDaHZmUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图4 OpenFoam稀疏对称矩阵数据存储方式" src="Detail/GetImg?filename=images/JSJC201906008_063.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQxQTZSZWp6VHBWMkMvWVdDaHZmUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit"><b>图4 OpenFoam稀疏对称矩阵数据存储方式</b>  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JSJC201906008_063.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQxQTZSZWp6VHBWMkMvWVdDaHZmUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <h3 id="64" name="64" class="anchor-tag">4 众核并行排序算法</h3>
                <h4 class="anchor-tag" id="65" name="65">4.1 基本思想</h4>
                <div class="p1">
                    <p id="66">通过上文可知, 离散访存问题的产生是由于部分上、下三角非零元素随机偏离对角线附近太远, 其根源是由目前多数非结构网格划分算法原理<citation id="166" type="reference"><link href="31" rel="bibliography" /><link href="33" rel="bibliography" /><sup>[<a class="sup">14</a>,<a class="sup">15</a>]</sup></citation>所导致的固有缺陷。</p>
                </div>
                <div class="p1">
                    <p id="67">如图5所示, 以不规则六面体为例分析网格划分算法, 可以看出, 这些偏离对角线的非零元素并非完全没有规律可循。在网格划分算法中, 网格单元与网格面编号按照如下规律进行排序:首先对网格进行划分并按照一定规则编号, 然后通过遍历网格单元周围的网格面得到网格面编号。在这种网格划分算法下, 对于单一的网格单元, 虽然其网格面并不连续 (如在图5中, 网格单元0的6个网格面编号依次是<i>a</i><sub>0</sub>、<i>a</i><sub>1</sub>、<i>b</i><sub>1</sub>、<i>c</i><sub>0</sub>、<i>d</i><sub>1</sub>、<i>e</i><sub>0</sub>) , 但是如果取连续编号的一段网格单元, 可以发现, 该段网格单元的所有网格面编号主要集中在<i>a</i>、<i>b</i>、<i>c</i>、<i>d</i>、<i>e</i> 5个连续的网格面块中 (实际算例测试结果表明, 只有约3%～8%的网格面编号不在其中) 。综上, 虽然网格面编号并不连续, 但却呈现局部连续性, 这种局部连续性与网格是否采用结构网格划分无关, 也与网格单元具体形状无关, 仅与网格划分算法有关。</p>
                </div>
                <div class="area_img" id="68">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JSJC201906008_068.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQxQTZSZWp6VHBWMkMvWVdDaHZmUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图5 网格划分算法示意图" src="Detail/GetImg?filename=images/JSJC201906008_068.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQxQTZSZWp6VHBWMkMvWVdDaHZmUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit"><b>图5 网格划分算法示意图</b>  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JSJC201906008_068.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQxQTZSZWp6VHBWMkMvWVdDaHZmUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="p1">
                    <p id="69">基于网格划分原理, 可以推导出如下2个结论 (本文称为相邻性规则) :</p>
                </div>
                <div class="p1">
                    <p id="70">1) 对于一段连续编号的网格面, 其影响的网格单元呈现局部集中性。</p>
                </div>
                <div class="p1">
                    <p id="71">2) 对于一段连续编号的网格单元, 其影响的网格面同样呈现局部集中性。</p>
                </div>
                <div class="p1">
                    <p id="72">编号连续的网格单元 (网格面) , 其影响的网格面 (网格单元) 在物理空间上是相邻的, 这种相邻性反映到矩阵位置上, 就会使得其影响的网格面 (网格单元) 在矩阵中呈现局部集中性, 即受到影响的网格面 (网格单元) 一定可以被有限且很少的若干个块所覆盖 (块与块之间的距离很可能非常远) 。非结构网格计算中的稀疏对称矩阵所呈现出的数据局部集中性, 是设计众核并行排序算法的基本依据。</p>
                </div>
                <h4 class="anchor-tag" id="73" name="73">4.2 算法结构</h4>
                <div class="p1">
                    <p id="74">离散访存问题由数据的随机访问所造成。反过来, 对数据按照随机访问的顺序进行重新整理, 将大幅减少随机访问的开销, 这在本质上也是对整个被访问数据进行的一次重排序。对于非结构网格生成的数据, 由相邻性规则可知, 仅采用64个从核且在有限的LDM空间中, 可以将任意规模大小的网格数据量进行并行重排序。本文众核并行排序算法结构如图6所示。</p>
                </div>
                <div class="area_img" id="75">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JSJC201906008_075.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQxQTZSZWp6VHBWMkMvWVdDaHZmUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图6 众核并行排序算法结构" src="Detail/GetImg?filename=images/JSJC201906008_075.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQxQTZSZWp6VHBWMkMvWVdDaHZmUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit"><b>图6 众核并行排序算法结构</b>  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JSJC201906008_075.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQxQTZSZWp6VHBWMkMvWVdDaHZmUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="p1">
                    <p id="76">众核并行排序算法结构如下:</p>
                </div>
                <div class="p1">
                    <p id="77">1) 数据分块。对网格单元数据和网格面数据进行分块, 分块大小<i>θ</i>以LDM存储空间为标准适当选取。假设数据量为<i>M</i>, 每个从核负责<i>M</i>/<i>θ</i>个块, 以此保证每个从核的负载平衡。</p>
                </div>
                <div class="p1">
                    <p id="78">2) 局部重排。对网格面 (网格单元) 块进行局部重排。以网格面数据重排为例, 在块内按照该数据所影响的网格单元所属块进行排序。通过这种重排, 实现如下目的:从施加影响的网格单元所属块的角度来看, 块内网格面数据是连续存放的。在局部重排的同时, 建立一个索引表, 该索引表记录所属不同网格单元块的网格面数据在块内的偏移与个数。</p>
                </div>
                <div class="p1">
                    <p id="79">3) 分段拷入。对重排后的网格面 (网格单元) 块数据按照施加影响的网格单元 (网格面) 所属块进行并行分段DMA拷入。由数据局部集中性可知, 需要拷入的段很少, 可以减少时间开销。同时, 在拷入的过程中没有冗余数据, 可以大幅提高数据的利用率并节约存储空间。</p>
                </div>
                <h3 id="80" name="80" class="anchor-tag">5 通量计算众核优化</h3>
                <div class="p1">
                    <p id="81">以OpenFoam中系数矩阵求解基础件lduMatrix的通量计算为例, 进一步阐述本文众核优化方法。在源代码中, 计算某个网格单元的通量值时需要对周围每个网格面通量值进行累加。通量计算的伪代码如下:</p>
                </div>
                <div class="p1">
                    <p id="82"><b>算法1</b> 基于COO格式的通量计算</p>
                </div>
                <div class="area_img" id="168">
                                <img alt="" src="Detail/GetImg?filename=images/JSJC201906008_16800.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQxQTZSZWp6VHBWMkMvWVdDaHZmUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                            <p class="img_tit"></p>

                </div>
                <div class="p1">
                    <p id="89">在算法1中, <i>L</i>和<i>U</i>刻画了每个网格面与网格单元的对应关系, <i>L</i>为COO存储格式中的行标, <i>U</i>为列标。上述伪代码表示在稀疏矩阵中, 将每一列非对角元素值累加到同一列的对角元素中, 由于<i>U</i>值按行存储, 随<i>face</i>值变化呈现不连续性, 从而对<b><i>Diag</i></b>值产生离散访存问题。由于<b><i>Lower</i></b>本身按列存储, 因此只需对<b><i>Upper</i></b>进行重排序即可, 优化过程如图7所示。根据第3节所述, 优化步骤如下:</p>
                </div>
                <div class="p1">
                    <p id="90"><b>步骤1</b> 向量<b><i>Diag</i></b>按对角线存储对角部分元素, 向量<b><i>Upper</i></b>按行存储矩阵上三角部分元素。</p>
                </div>
                <div class="p1">
                    <p id="91"><b>步骤2</b> 分块处理对角部分数据和上三角部分数据。</p>
                </div>
                <div class="p1">
                    <p id="92"><b>步骤3</b> 在上三角块中, 根据数据所属对角块编号进行块内排序。</p>
                </div>
                <div class="p1">
                    <p id="93"><b>步骤4</b> 按对角块进行并行计算, 获取<b><i>Diag</i></b>值所需的上三角数据通过分段拷入的方式参与计算。</p>
                </div>
                <div class="area_img" id="94">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JSJC201906008_094.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQxQTZSZWp6VHBWMkMvWVdDaHZmUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图7 通量计算众核优化示意图" src="Detail/GetImg?filename=images/JSJC201906008_094.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQxQTZSZWp6VHBWMkMvWVdDaHZmUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit"><b>图7 通量计算众核优化示意图</b>  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JSJC201906008_094.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQxQTZSZWp6VHBWMkMvWVdDaHZmUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="p1">
                    <p id="95">重排序后的数据 (称为<i>Upper</i>_<i>Sort</i>) 和生成的索引表由主存开辟额外空间存储, 所有从核共享该数据。局部排序伪代码如下:</p>
                </div>
                <div class="p1">
                    <p id="96"><b>算法2</b> 基于COO格式的局部排序</p>
                </div>
                <div class="area_img" id="169">
                                <img alt="" src="Detail/GetImg?filename=images/JSJC201906008_16900.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQxQTZSZWp6VHBWMkMvWVdDaHZmUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                            <p class="img_tit"></p>

                </div>
                <div class="area_img" id="169">
                                <img alt="" src="Detail/GetImg?filename=images/JSJC201906008_16901.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQxQTZSZWp6VHBWMkMvWVdDaHZmUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                            <p class="img_tit"></p>

                </div>
                <div class="p1">
                    <p id="108">非结构网格单元普遍采用四面体或六面体结构, 在这种结构下计算任意一个网格单元块, 参与运算的网格单元与网格面数据量比值大约为1∶6。因此, 可以预估足够空间存储其上限数据。分段拷入计算伪代码如下:</p>
                </div>
                <div class="p1">
                    <p id="109"><b>算法3</b> 基于COO格式的分段拷入计算</p>
                </div>
                <div class="area_img" id="170">
                                <img alt="" src="Detail/GetImg?filename=images/JSJC201906008_17000.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQxQTZSZWp6VHBWMkMvWVdDaHZmUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                            <p class="img_tit"></p>

                </div>
                <h3 id="131" name="131" class="anchor-tag">6 实验结果与分析</h3>
                <h4 class="anchor-tag" id="132" name="132">6.1 优化过程分析</h4>
                <div class="p1">
                    <p id="133">本次实验采用国产编译器<i>SW</i>5<i>CC</i>和<i>SW</i>453++编译<i>C</i>和<i>C</i>++程序。为验证本文算法的性能, 选取远景能源公司真实算例进行实验。该算例主要通过模拟复杂地形的风场数值来优化风电机组系统动力学模型和关键零件, 其网格单元数为12.4万, 网格面数为36.5万, 矩阵规模与非零元素比约为1∶7, 按512大小进行分块, 单核运行时间为8.087 <i>ms</i>。本文对该算例进行如下处理:</p>
                </div>
                <div class="p1">
                    <p id="134">1) 快速排序。算法主要的时间开销来自局部排序部分。快速排序是一种常用的高效排序方法, 其平均时间复杂度为O (n<i>lg</i> n) 。对数据块进行排序优化后, 整体运行时间减少为5.231 <i>ms</i>。</p>
                </div>
                <div class="p1">
                    <p id="135">2) 排序算法优化。在实际计算中, 块内数据无需保持严格有序, 只需相对有序即可, 因此, 本文将排序算法优化为计数排序与桶排序, 对数据块进行一次遍历, 时间复杂度为O (n) 。优化后, 整体运行时间减少为1.610 <i>ms</i>。</p>
                </div>
                <div class="p1">
                    <p id="136">3) 数据压缩。对索引表、矩阵非零元素位置信息等数据进行压缩, 减少从核大量数据的<i>DMA</i>拷入时间。优化后, 整体运行时间减少为1.087 <i>ms</i>。</p>
                </div>
                <div class="p1">
                    <p id="137">4) 中间不变量的预处理。由于网格结构在迭代过程中保持不变, 因此直接调用中间量即可, 以此可避免重复计算。优化后, 运行时间减少为 0.979 <i>ms</i>。</p>
                </div>
                <div class="p1">
                    <p id="138">5) 深度优化。采用<i>DMA</i>访存-计算隐藏、汇编指令嵌入、数学等价变换等优化策略, 进一步将运行时间减少为0.913 <i>ms</i>。</p>
                </div>
                <div class="p1">
                    <p id="139">通量计算众核优化中的运行时间与加速比变化如图8所示, 其中, 直方图表示运行时间, 曲线表示加速比。</p>
                </div>
                <div class="area_img" id="140">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JSJC201906008_140.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQxQTZSZWp6VHBWMkMvWVdDaHZmUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图8 通量计算众核优化的时间与加速比效果" src="Detail/GetImg?filename=images/JSJC201906008_140.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQxQTZSZWp6VHBWMkMvWVdDaHZmUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit"><b>图8 通量计算众核优化的时间与加速比效果</b>  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JSJC201906008_140.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQxQTZSZWp6VHBWMkMvWVdDaHZmUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <h4 class="anchor-tag" id="141" name="141">6.2 不同算例优化效果对比</h4>
                <div class="p1">
                    <p id="142">对比本文算法在不同网格规模下的加速优化效果, 结果如表1所示。由表1可以看出, 随着网格规模的增加, 算法加速效果基本保持稳定。由于所有操作均以块为基本单元, 数据传输均以DMA方式批量访问, 因此本文算法在理论上能够适用于任意网格规模大小进行并行优化, 即具有很强的通用性。此外, 该算法平均单核组的加速比为13.21, 最高加速比为14.71, 单核组加速倍数达到10倍以上。</p>
                </div>
                <div class="area_img" id="143">
                    <p class="img_tit"><b>表1 本文算法对不同网格规模的优化性能对比</b> <a class="downexcel" onclick="DownLoadReportExcel(this)">导出到EXCEL</a></p>
                    <p class="img_tit"></p>
                    <p class="img_note"></p>
                    <table id="143" border="1"><tr><td>网络规模<br />/10<sup>4</sup></td><td>单核组平均<br />时间/ms</td><td>单核组优化<br />平均时间/ms</td><td>单核组<br />加速比</td></tr><tr><td>12.4</td><td>8.087</td><td>0.913</td><td>8.85</td></tr><tr><td><br />19.5</td><td>16.280</td><td>1.180</td><td>13.80</td></tr><tr><td><br />39.1</td><td>31.060</td><td>2.320</td><td>13.39</td></tr><tr><td><br />50.0</td><td>42.240</td><td>2.940</td><td>14.37</td></tr><tr><td><br />52.1</td><td>45.160</td><td>3.070</td><td>14.71</td></tr><tr><td><br />156.2</td><td>128.760</td><td>9.100</td><td>14.15</td></tr></table>
                    <form name="form" action="/kxreader/Detail/DownloadReportExcel" method="POST" style="display:inline">
                        <input type="hidden" name="hidTable" value="" />
                        <input type="hidden" name="hidFileName" value="" />
                    </form>
                    <p class="img_note"></p>
                    <p class="img_note"></p>
                </div>
                <h4 class="anchor-tag" id="144" name="144">6.3 数据分块大小对算法性能的影响</h4>
                <div class="p1">
                    <p id="145">不同的数据分块大小对本文算法的性能影响如图9所示。由图9可以看出, 数据块按照256或512大小分块能达到相对最佳效果, 原因主要有2点:</p>
                </div>
                <div class="p1">
                    <p id="146">1) 按256或512大小分块进行DAM读取时访存带宽基本上能够达到最大<citation id="167" type="reference"><link href="35" rel="bibliography" /><sup>[<a class="sup">16</a>]</sup></citation>。</p>
                </div>
                <div class="p1">
                    <p id="147">2) 此时LDM空间利用率达到50%以上, 数据存储分布较合理。</p>
                </div>
                <div class="area_img" id="148">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JSJC201906008_148.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQxQTZSZWp6VHBWMkMvWVdDaHZmUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图9 数据块大小对算法性能的影响" src="Detail/GetImg?filename=images/JSJC201906008_148.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQxQTZSZWp6VHBWMkMvWVdDaHZmUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit"><b>图9 数据块大小对算法性能的影响</b>  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JSJC201906008_148.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQxQTZSZWp6VHBWMkMvWVdDaHZmUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <h4 class="anchor-tag" id="149" name="149">6.4 众核并行优化的负载均衡效果</h4>
                <div class="p1">
                    <p id="150">负载均衡是考察一个算法是否有效的关键因素, 但本文众核并行排序算法很好地规避了负载均衡问题。在优化过程中, 任务根据主-从加速模式按数据块 (而非矩阵块) 平均分配给各从核, 从统计角度来看, 各从核的计算任务量基本相当, 从而解决了负载不均衡的问题。</p>
                </div>
                <h3 id="151" name="151" class="anchor-tag">7 结束语</h3>
                <div class="p1">
                    <p id="152">本文针对非结构网格数据的结构特点, 提出一种解决离散访存问题的通用众核优化算法。基于神威·太湖之光平台, 该算法完成了OpenFoam求解器公用基础件的通量计算众核优化, 且不同网格规模算例的通量计算均得到较好的加速效果。本文算法适用于无数据依赖关系的离散访存问题, 对于有数据依赖关系的离散访存问题 (如ILU方法求解稀疏线性代数方程组类问题) , 其存在一定局限, 研究并解决该问题将是下一步的研究方向。</p>
                </div>

        <!--brief end-->
        
        <!--conten left  end-->
        <!--增强附件-->
        

        <!--reference start-->
            <div class="reference anchor-tag" id="a_bibliography">
                    <h3>参考文献</h3>
                                        <p id="5">
                            <a id="bibliography_1" target="_blank" href="/kcms/detail/detail.aspx?dbcode=SSJD&amp;filename=SSJD15012800006244&amp;v=MTE0NzhqbVVMbklJVjRXYXhRPU5qN0Jhcks5SHRET3A0OUZaT3NKRG5nOW9CTVQ2VDRQUUgvaXJSZEdlcnFRVE1ud1plWnVIeQ==&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQxQTZSZWp6VHBWMkMvWVdDaHZmUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[1]</b> ZHENG Fang, LI Hongliang, LV Hui, et al.Cooperative computing techniques for a deeply fused and hetero-geneous many-core processor architecture[J].Journal of Computer Science and Technology, 2015, 30 (1) :145-162.
                            </a>
                        </p>
                        <p id="7">
                            <a id="bibliography_2" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JFXG201607011&amp;v=MjkzNThRS0RIODR2UjRUNmo1NE8zenFxQnRHRnJDVVJMT2VaZVJvRnlubFViN09MeXZUYWJHNEg5Zk1xSTlFWlk=&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQxQTZSZWp6VHBWMkMvWVdDaHZmUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[2]</b> FU Haohuan, LIAO Junfeng, YANG Jinzhe, et al.The Sunway TaihuLight supercomputer:system and appli-cations[J].Science China (Information Sciences) , 2016, 59 (7) :072001.
                            </a>
                        </p>
                        <p id="9">
                            <a id="bibliography_3" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Redesigning CAM-SE for peta-scale climate modeling performance and ultra-high resolution on Sunway TaihuLight">

                                <b>[3]</b> FU Haohuan, LIAO Junfeng, DING Nan, et al.Redesigning CAM-SE for peta-scale climate modeling performance and ultra-high resolution on Sunway TaihuLight[C]//Proceedings of International Conference for High Performance Computing, Networking, Torage and Analysis.New York, USA:ACM Press, 2017:25-36.
                            </a>
                        </p>
                        <p id="11">
                            <a id="bibliography_4" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=KXZZ201703005&amp;v=MjY5NjI4NHZSNFQ2ajU0TzN6cXFCdEdGckNVUkxPZVplUm9GeW5sVWI3T0xqWFJkTEc0SDliTXJJOUZZWVFLREg=&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQxQTZSZWp6VHBWMkMvWVdDaHZmUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[4]</b> 杨广文, 赵文来, 丁楠, 等.“神威·太湖之光”及其应用系统[J].科学, 2017, 69 (3) :12-16.
                            </a>
                        </p>
                        <p id="13">
                            <a id="bibliography_5" >
                                    <b>[5]</b>
                                 漆锋滨.“神威·太湖之光”超级计算机[EB/OL].[2018-03-20].https://www.ccf.org.cn/c/2017-10-13/615850.shtml.
                            </a>
                        </p>
                        <p id="15">
                            <a id="bibliography_6" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Achieving high sustained performance in an unstructured mesh CFD application">

                                <b>[6]</b> ANDERSON W K, GROPP W D, KAUSHIK D K, et al.Achieving high sustained performance in an unstructured Mesh CFD application[C]//Proceedings of 1999 ACM/IEEE Conference on Supercomputing.Washington D.C., USA:IEEE Press, 1999:69-79.
                            </a>
                        </p>
                        <p id="17">
                            <a id="bibliography_7" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Sparse matrix solvers on the GPU:conjugate gradients and multi-grid">

                                <b>[7]</b> BOLZ J, FARMER I, GRINSPUN E, et al.Sparse matrix solvers on the GPU:conjugate gradients and multi-grid[C]//Proceedings of SIGGRAPH’05.New York, USA:ACM Press, 2005:917-924.
                            </a>
                        </p>
                        <p id="19">
                            <a id="bibliography_8" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Compressed multirow storage format for sparse matrices on graphics processing units">

                                <b>[8]</b> KOZA Z, MATYKA M, ASZKODA S, et al.Compressed multirow storage format for sparse matrices on graphics processing units[J].SIAM Journal on Scientific Computing, 2014, 36 (2) :219-239.
                            </a>
                        </p>
                        <p id="21">
                            <a id="bibliography_9" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Toward efficient spMv on Sunway many-core processors">

                                <b>[9]</b> LI Changxi.Toward efficient spMv on Sunway many-core processors[EB/OL].[2018-03-20].http://ics2018.ict.ac.cn/essay/ics18-final141.pdf.
                            </a>
                        </p>
                        <p id="23">
                            <a id="bibliography_10" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Efficient sparse matrix-vector multiplication on GPUs using the CSR storage format">

                                <b>[10]</b> GREATHOUSE J L, DAGA M.Efficient sparse matrix-vector multiplication on GPUs using the CSR storage format[C]//Proceedings of International Conference for High Performance Computing, Networking, Storage and Analysis.Washington D.C., USA:IEEE Press, 2014:769-780.
                            </a>
                        </p>
                        <p id="25">
                            <a id="bibliography_11" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Fast sparse matrix-vector multiplication on GPUs for graph applications">

                                <b>[11]</b> ASHARI A, SEDAGHATI N, EISENLOHR J, et al.Fast sparse matrix-vector multiplication on GPUs for graph applications[C]//Proceedings of International Conference for High Performance Computing, Networking, Storage and Analysis.Washington D.C., USA:IEEE Press, 2014:781-792.
                            </a>
                        </p>
                        <p id="27">
                            <a id="bibliography_12" >
                                    <b>[12]</b>
                                 王欣亮.关键稀疏数值计算核心在国产众核架构上的性能优化研究[D].北京:清华大学, 2018.
                            </a>
                        </p>
                        <p id="29">
                            <a id="bibliography_13" target="_blank" href="http://scholar.cnki.net/result.aspx?q=The finite volume method in computational fluid dynamics:an advanced introduction with OpenFOAM and Matlab">

                                <b>[13]</b> MOUKALLED F, MANGANI L, DARWISH M.The finite volume method in computational fluid dynamics:an advanced introduction with OpenFOAM and Matlab[M].Berlin, Germany:Springer, 2015:173-207.
                            </a>
                        </p>
                        <p id="31">
                            <a id="bibliography_14" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JSJA201203070&amp;v=MjQ0NjRSTE9lWmVSb0Z5bmxVYjdPTHo3QmI3RzRIOVBNckk5Q1pJUUtESDg0dlI0VDZqNTRPM3pxcUJ0R0ZyQ1U=&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQxQTZSZWp6VHBWMkMvWVdDaHZmUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[14]</b> 刘鑫, 陆林生, 陈德训.非结构网格并行计算预处理方法研究[J].计算机科学, 2012, 39 (3) :308-311.
                            </a>
                        </p>
                        <p id="33">
                            <a id="bibliography_15" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CDFD&amp;filename=1014048572.nh&amp;v=MDU3MDVyTzhGdFRMclpFYlBJUUtESDg0dlI0VDZqNTRPM3pxcUJ0R0ZyQ1VSTE9lWmVSb0Z5bmxVYjdPVkYyNkc=&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQxQTZSZWp6VHBWMkMvWVdDaHZmUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[15]</b> 李宗哲.非结构网格的并行多重网格算法研究[D].长沙:国防科技大学, 2012.
                            </a>
                        </p>
                        <p id="35">
                            <a id="bibliography_16" >
                                    <b>[16]</b>
                                 陈德训, 刘鑫.神威·太湖之光并行程序设计与优化[EB/OL].[2018-03-20].http://www.nsccwx.cn/process.php?word=process&amp;i=54.
                            </a>
                        </p>
            </div>
        <!--reference end-->
        <!--footnote start-->
        <!--footnote end-->



    </div>

        <input id="fileid" type="hidden" value="JSJC201906008" />
        <input id="dpi" type="hidden" value="300" />
    </div>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?6e967eb120601ea41b9d312166416aa6";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
</script>

    


<input id="hid_uid" name="hid_uid" type="hidden" value="WEEvREcwSlJHSldRa1FhdXNXaEhoRFQxQTZSZWp6VHBWMkMvWVdDaHZmUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
<input id="hid_kLogin_headerUrl" name="hid_kLogin_headerUrl" type="hidden" value="/KLogin/Request/GetKHeader.ashx%3Fcallback%3D%3F" />
<input id="hid_kLogin_footerUrl" name="hid_kLogin_footerUrl" type="hidden" value="/KLogin/Request/GetKFooter.ashx%3Fcallback%3D%3F" />
<div class="btn-link" style="display: none"><a target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JSJC201906008&amp;v=MDAwNDFyQ1VSTE9lWmVSb0Z5bmxVYjdPTHo3QmJiRzRIOWpNcVk5RmJJUUtESDg0dlI0VDZqNTRPM3pxcUJ0R0Y=&amp;uid=WEEvREcwSlJHSldRa1FhdXNXaEhoRFQxQTZSZWp6VHBWMkMvWVdDaHZmUT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">知网节</a></div>
<div class="popflow" id="popupTips" style="display: none;">
    <div class="popflowArr"></div>
    <div class="popflowCot">
        <div class="hd"><a href="javascript:void(0);" onclick="$('#popupTips').hide();$('#popupmsg').html('')" class="close">X</a></div>
        <div class="bd">
            <p class="mes" id="popupmsg" name="popupmsg"></p>
          
        </div>
    </div>
</div>
<input type="hidden" id="myexport" value="//kns.cnki.net" />

<input type="hidden" id="KPCAPIPATH" value="//ishufang.cnki.net" />
<input type="hidden" id="CitedTimes" value="" />
<div class="link" id="GLSearch" style="display: none;">
    <i class="icon-trangle"></i>
    <div class="inner">
        <a class="icon" id="copytext">复制</a>
        <a class="icon" target="_blank" onclick="searchCRFD(this)">工具书搜索</a>
    </div>
</div>




<input id="hidVirtualPath" name="hidVirtualPath" type="hidden" value="/kxreader" />
<script src="/kxreader/bundles/detail?v=-ULdk-c6FkZHtJA2KAXPgHnyA8mtgyPnBde_C2VZ2BY1"></script>

<script src="/kxreader/Scripts/layer.min.js" type="text/javascript"></script>

<div id="footerBox" class="rootw footer">
</div>
<script>
    if (typeof FlushLogin == 'function') {
        FlushLogin();
    }
    modifyEcpHeader(true);
</script>

<!--图片放大功能 start-->
<script src="/kxreader/bundles/imagebox?v=W4phPu9SNkGcuPeJclikuVE3PpRyIW_gnfjm_19nynI1"></script>

<script type="text/javascript">
    $(function () {
        var j = $.noConflict();
        j(function () {
            j(".zoom-in,.btn-zoomin").imgbox({
                'alignment': 'center',
                'allowMultiple': false,
                'overlayShow': true
            });
        })
    });
</script>
<!--图片放大功能 end-->
<div class="fixedbar">
    <div class="backtop hiddenV" id="backtop">
        <a id="backTopSide" href="javascript:scroll(0,0);" title=""></a>
    </div>
</div>
<script type="text/javascript" src="/kxreader/Scripts/MathJax-2.6-latest/MathJax.js?config=MML_HTMLorMML-full"></script>

</body>
</html>
