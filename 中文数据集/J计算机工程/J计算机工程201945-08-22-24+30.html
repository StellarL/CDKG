<!DOCTYPE html>
<html>
<head>
    <title>全文阅读--XML全文阅读--中国知网</title>
    <link rel="icon" href="/kxreader/favicon.ico" />
    <link rel="shortcut Icon" href="/kxreader/favicon.ico" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="keywords" content="文献 XML KBASE CNKI 中国知网" />
    <meta name="description" content="XML文献检索" />
    <link href="/kxreader/Content/css/detail?v=qX2z2KjRAEyQiNfAbKtl7dLnsqFoQ5Jdw3TZfDf0n1k1" rel="stylesheet"/>

    <script type="text/javascript">
        var APPPATH = '/kxreader';
    </script>
</head>

<body>
    
<script type="text/javascript" src="//login.cnki.net/TopLogin/api/loginapi/get?type=top&amp;localCSS=&amp;returnurl=%2f%2fkns.cnki.net%2f%2fKXReader%2fDetail%3fTIMESTAMP%3d637128889463738750%26DBCODE%3dCJFD%26TABLEName%3dCJFDLAST2019%26FileName%3dJSJC201908004%26RESULT%3d1%26SIGN%3d1qEWHzW87H%252butRbHiXkn8KUgKI0%253d"></script>

<div id="headerBox" class="header">
    <div class="topbar">
        <div class="textalign">
            <a href="/kxreader/Detail?dbcode=CJFD&amp;filename=JSJC201908004&amp;align=md">
                <i class="icon-cen active" title="居中对齐"></i>
            </a>
            <a href="/kxreader/Detail?dbcode=CJFD&amp;filename=JSJC201908004&amp;align=lt">
                <i class="icon-left " title="左对齐"></i>
            </a>
        </div>
        <h6 class="free-tip"><i class="icon"></i>HTML阅读开放试用阶段，欢迎体验！</h6>
    </div>
</div>

    



<div class="btn-link" style="display: none"><a target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JSJC201908004&amp;v=MzI2ODFyQ1VSTE9lWmVScUZ5L2dVTHpQTHo3QmJiRzRIOWpNcDQ5RllJUUtESDg0dlI0VDZqNTRPM3pxcUJ0R0Y=&amp;uid=WEEvREcwSlJHSldRa1FhcTdWa2FjcW9xck9nSjc1VXR3SDJsaTcyc24rQT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">知网节</a></div>

    <div class="main">

        

    <div class="sidebar-a">
        <!--sidebar start-->
        <div class="sidenav">
            <div class="arrow"><span></span></div>
            <!--sidebar_list start-->
            <dl class="sidenav-list">
                    <dt class="tit">目录结构</dt>
                            <dd class="guide">
                                    <p><a href="#33" data-title="0 概述 ">0 概述</a><i></i></p>
                                                            </dd>
                            <dd class="guide">
                                    <p><a href="#38" data-title="1 改进的PCFG模型 ">1 改进的PCFG模型</a><i></i></p>
                                                                    <ul class="contentbox">
                                                <li><a href="#41" data-title="1.1 PCFG模型">1.1 PCFG模型</a></li>
                                                <li><a href="#53" data-title="1.2 模型改进">1.2 模型改进</a></li>
                                                <li><a href="#65" data-title="1.3 参数训练">1.3 参数训练</a></li>
                                                <li><a href="#74" data-title="1.4 变量引用修正">1.4 变量引用修正</a></li>
                                    </ul>
                            </dd>
                            <dd class="guide">
                                    <p><a href="#76" data-title="2 实验结果与分析 ">2 实验结果与分析</a><i></i></p>
                                                            </dd>
                            <dd class="guide">
                                    <p><a href="#83" data-title="3 结束语 ">3 结束语</a><i></i></p>
                                                            </dd>
                            <dd class="guide">
                                    <p><a href="#" data-title="文内图表 ">文内图表</a><i></i></p>
                                                                    <ul class="contentbox">
                                                <li><a href="#40" data-title="&lt;b&gt;图1 模糊测试系统结构&lt;/b&gt;"><b>图1 模糊测试系统结构</b></a></li>
                                                <li><a href="#55" data-title="&lt;b&gt;图2 一个代码片段的语法树描述&lt;/b&gt;"><b>图2 一个代码片段的语法树描述</b></a></li>
                                                <li><a href="#56" data-title="&lt;b&gt;图3 JavaScript部分语法描述&lt;/b&gt;"><b>图3 JavaScript部分语法描述</b></a></li>
                                                <li><a href="#78" data-title="&lt;b&gt;图4 语法树类型的频度统计结果&lt;/b&gt;"><b>图4 语法树类型的频度统计结果</b></a></li>
                                                <li><a href="#79" data-title="&lt;b&gt;表1 最高频的5种语法结构占比情况&lt;/b&gt;"><b>表1 最高频的5种语法结构占比情况</b></a></li>
                                                <li><a href="#81" data-title="&lt;b&gt;表2 模糊测试生成样本的准确率结果&lt;/b&gt;"><b>表2 模糊测试生成样本的准确率结果</b></a></li>
                                    </ul>
                            </dd>
                                    <dd class="guide">
                                        <h6>
                                            <p><a href="#a_bibliography">参考文献</a> </p>
                                        </h6>
                                    </dd>

            </dl>
        </div>
        <!--sidebar end-->
        &nbsp;
        <!--此处有一空格符 勿删-->
    </div>

                <div class="sidebar-b three-collumn" style="width:0;">
            <div class="refer" style="width: 0;">
                <div class="arrow off" title="参考文献"><span></span></div>
                <div class="js-scrollbox" >
                    
                    <div class="subbox active">
                        <h4>
                            <span class="tit">参考文献</span>
                            <a class="close" href="javascript:void(0)">x</a>
                        </h4>
                        <div class="side-scroller">
                            <ul class="refer-list">
                                <li id="97">


                                    <a id="bibliography_1" title=" 李进东, 王韬, 吴杨, 等.基于协议分析与模糊测试的SIP漏洞挖掘研究[J].计算机工程, 2016, 42 (8) :117-122." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JSJC201608023&amp;v=MDcwNTJPM3pxcUJ0R0ZyQ1VSTE9lWmVScUZ5L2dVTHpPTHo3QmJiRzRIOWZNcDQ5SFo0UUtESDg0dlI0VDZqNTQ=&amp;uid=WEEvREcwSlJHSldRa1FhcTdWa2FjcW9xck9nSjc1VXR3SDJsaTcyc24rQT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[1]</b>
                                         李进东, 王韬, 吴杨, 等.基于协议分析与模糊测试的SIP漏洞挖掘研究[J].计算机工程, 2016, 42 (8) :117-122.
                                    </a>
                                </li>
                                <li id="99">


                                    <a id="bibliography_2" title=" 苏晓艳, 武东英, 刘龙, 等.基于Fuzzing的Cisco IOS漏洞挖掘方法[J].计算机工程, 2012, 38 (16) :117-120." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JSJC201216029&amp;v=MTEyOTFOcVk5SGJZUUtESDg0dlI0VDZqNTRPM3pxcUJ0R0ZyQ1VSTE9lWmVScUZ5L2dVTHpPTHo3QmJiRzRIOVA=&amp;uid=WEEvREcwSlJHSldRa1FhcTdWa2FjcW9xck9nSjc1VXR3SDJsaTcyc24rQT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[2]</b>
                                         苏晓艳, 武东英, 刘龙, 等.基于Fuzzing的Cisco IOS漏洞挖掘方法[J].计算机工程, 2012, 38 (16) :117-120.
                                    </a>
                                </li>
                                <li id="101">


                                    <a id="bibliography_3" title=" B&#214;HME M, PHAM V T, NGUYEN M D, et al.Directed greybox fuzzing[C]//Proceedings of 2017 ACM SIGSAC Conference on Computer and Communications Security.New York, USA:ACM Press, 2017:2329-2344." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Directed greybox fuzzing">
                                        <b>[3]</b>
                                         B&#214;HME M, PHAM V T, NGUYEN M D, et al.Directed greybox fuzzing[C]//Proceedings of 2017 ACM SIGSAC Conference on Computer and Communications Security.New York, USA:ACM Press, 2017:2329-2344.
                                    </a>
                                </li>
                                <li id="103">


                                    <a id="bibliography_4" title=" PHAM V T, ROYCHOUDHURY A.Coverage-based greybox fuzzing as Markov chain[C]//Proceedings of 2016 ACM SIGSAC Conference on Computer and Communications Security.New York, USA:ACM Press, 2016:1032-1043." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Coverage-based Greybox Fuzzing as Markov Chain">
                                        <b>[4]</b>
                                         PHAM V T, ROYCHOUDHURY A.Coverage-based greybox fuzzing as Markov chain[C]//Proceedings of 2016 ACM SIGSAC Conference on Computer and Communications Security.New York, USA:ACM Press, 2016:1032-1043.
                                    </a>
                                </li>
                                <li id="105">


                                    <a id="bibliography_5" title=" RAWAT S, JAIN V, KUMAR A, et al.VUzzer:application-aware evolutionary fuzzing[EB/OL].[2018-03-10].https://www.cs.vu.nl/～herbertb/download/papers/vuzzer_ndss17.pdf." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=VUzzer:application-aware evolutionary fuzzing">
                                        <b>[5]</b>
                                         RAWAT S, JAIN V, KUMAR A, et al.VUzzer:application-aware evolutionary fuzzing[EB/OL].[2018-03-10].https://www.cs.vu.nl/～herbertb/download/papers/vuzzer_ndss17.pdf.
                                    </a>
                                </li>
                                <li id="107">


                                    <a id="bibliography_6" title=" RUDERMAN J.Introducing JsFunfuzz[EB/OL].[2018-03-10].http://www.squarefree.com/2007/08/02/introducing-jsfunfuzz/." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Introducing jsfunfuzz">
                                        <b>[6]</b>
                                         RUDERMAN J.Introducing JsFunfuzz[EB/OL].[2018-03-10].http://www.squarefree.com/2007/08/02/introducing-jsfunfuzz/.
                                    </a>
                                </li>
                                <li id="109">


                                    <a id="bibliography_7" title=" HOLLER C, HERZIG K, ZELLER A.Fuzzing with code fragments[C]//Proceedings of the 21st USENIX Conference on Security Symposium.Berkeley, USA:USENIX Association, 2012:445-458." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Fuzzing with code fragments">
                                        <b>[7]</b>
                                         HOLLER C, HERZIG K, ZELLER A.Fuzzing with code fragments[C]//Proceedings of the 21st USENIX Conference on Security Symposium.Berkeley, USA:USENIX Association, 2012:445-458.
                                    </a>
                                </li>
                                <li id="111">


                                    <a id="bibliography_8" title=" GODEFROID P, PELEG H, SINGH R.Learn and fuzz:machine learning for input fuzzing[EB/OL].[2018-03-11].https://arxiv.org/pdf/1701.07232.pdf." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Learn and fuzz:machine learning for input fuzzing">
                                        <b>[8]</b>
                                         GODEFROID P, PELEG H, SINGH R.Learn and fuzz:machine learning for input fuzzing[EB/OL].[2018-03-11].https://arxiv.org/pdf/1701.07232.pdf.
                                    </a>
                                </li>
                                <li id="113">


                                    <a id="bibliography_9" title=" WANG Junjie, CHEN Bihuan, WEI Lei, et al.Skyfire:data-driven seed generation for fuzzing[C]//Proceedings of 2017 IEEE Symposium on Security and Privacy.Washington D.C., USA:IEEE Press, 2017:579-594." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=&amp;quot;Skyfire:Data-Driven Seed Generation for Fuzzing&amp;quot;">
                                        <b>[9]</b>
                                         WANG Junjie, CHEN Bihuan, WEI Lei, et al.Skyfire:data-driven seed generation for fuzzing[C]//Proceedings of 2017 IEEE Symposium on Security and Privacy.Washington D.C., USA:IEEE Press, 2017:579-594.
                                    </a>
                                </li>
                                <li id="115">


                                    <a id="bibliography_10" title=" VEGGALAM S, RAWAT S, HALLER I, et al.IFuzzer:an evolutionary interpreter fuzzer using genetic program-ming[C]//Proceedings of the 21st European Symposium on Research in Computer Security.Berlin, Germany:Springer, 2016:581-601." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Ifuzzer:An evolutionary interpreter fuzzer using genetic programming">
                                        <b>[10]</b>
                                         VEGGALAM S, RAWAT S, HALLER I, et al.IFuzzer:an evolutionary interpreter fuzzer using genetic program-ming[C]//Proceedings of the 21st European Symposium on Research in Computer Security.Berlin, Germany:Springer, 2016:581-601.
                                    </a>
                                </li>
                                <li id="117">


                                    <a id="bibliography_11" title=" RAYCHEV V, BIELIK P, VECHEV M, et al.Learning programs from noisy data[C]//Proceedings of ACM SIGPLAN-SIGACT Symposium on Principles of Programming Languages.New York, USA:ACM Press, 2016:761-774." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Learning programs from noisy data">
                                        <b>[11]</b>
                                         RAYCHEV V, BIELIK P, VECHEV M, et al.Learning programs from noisy data[C]//Proceedings of ACM SIGPLAN-SIGACT Symposium on Principles of Programming Languages.New York, USA:ACM Press, 2016:761-774.
                                    </a>
                                </li>
                                <li id="119">


                                    <a id="bibliography_12" title=" TU Zhaopeng, SU Zhengdong, DEVANBU P.On the localness of software[C]//Proceedings of ACM SIGSOFT International Symposium on Foundations of Software Engineering.New York, USA:ACM Press, 2014:269-280." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=On the Localness of Software">
                                        <b>[12]</b>
                                         TU Zhaopeng, SU Zhengdong, DEVANBU P.On the localness of software[C]//Proceedings of ACM SIGSOFT International Symposium on Foundations of Software Engineering.New York, USA:ACM Press, 2014:269-280.
                                    </a>
                                </li>
                                <li id="121">


                                    <a id="bibliography_13" title=" Learning from “big code”[EB/OL].[2018-03-10].http://learnbigcode.github.io/datasets/." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Learning from &amp;quot;big code&amp;quot;">
                                        <b>[13]</b>
                                         Learning from “big code”[EB/OL].[2018-03-10].http://learnbigcode.github.io/datasets/.
                                    </a>
                                </li>
                                <li id="123">


                                    <a id="bibliography_14" title=" MANNING C D, HINRICH S.Foundations of statistical natural language processing[M].Cambridge, USA:MIT Press, 1999." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Foundations of Statistical Natural Language Processing">
                                        <b>[14]</b>
                                         MANNING C D, HINRICH S.Foundations of statistical natural language processing[M].Cambridge, USA:MIT Press, 1999.
                                    </a>
                                </li>
                                <li id="125">


                                    <a id="bibliography_15" title=" VIRKAR Y, CLAUSET A.Power-law distributions in binned empirical data[J].SIAM Review, 2012, 51 (4) :661-703." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Power-law distributions in empirical data">
                                        <b>[15]</b>
                                         VIRKAR Y, CLAUSET A.Power-law distributions in binned empirical data[J].SIAM Review, 2012, 51 (4) :661-703.
                                    </a>
                                </li>
                            </ul>
                            <div style='display: none;' class="zqscroller" >
                                <h4 class="">附加材料</h4>
                                <ul></ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            &nbsp;
            <!--此处有一空格符 勿删-->
        </div>

        
    <div class="content">



        <!--tips start-->
                            <div class="tips">
                    <a href="http://navi.cnki.net/KNavi/JournalDetail?pcode=CJFD&amp;pykm=JSJC" target="_blank">计算机工程</a>
                2019,45(08),22-24+30 DOI:10.19678/j.issn.1000-3428.0051008            </div>
        <!--tips end-->
            <div class="top-title">
                <h1 class="title">
                    <span class="vm"><b>基于改进PCFG的语言解释器模糊测试</b></span>
 <span class="shoufa"></span>                                     </h1>

                <div class="btn-downloads  btn-downloads-new">

                        <a class="read read-btn-special" target="_blank" href=http://x.cnki.net/search/common/testlunbo?dbcode=CJFD&amp;tablename=CJFDLAST2019&amp;filename=JSJC201908004&amp;filesourcetype=1><i class="i-btn i-care"></i>精读</a>
                    <div class="read-btn-l">
                        <a class="caj" target="_blank" href="http://kns.cnki.net/kns/download.aspx?filename=wk0UGBDUUNWYIlkRyF2cWVkYXRDMvYHMEFFcyRVMSl1aEl2ZltkWwEEWV1mYxR2QElUZV92dJ90ZqFHTFVWORFlNLFVaNtmTlJlQ58UZFdDZLFzbmF2ZYtiQpFHWLJ1SwxmTPNUYvYjZ090LDFDaFNkYwJUTkV3L&tablename=CJFDLAST2019"><i class="i-btn i-caj"></i> CAJ下载</a>
                        <a class="pdf" target="_blank" href="http://kns.cnki.net/kns/download.aspx?filename=wk0UGBDUUNWYIlkRyF2cWVkYXRDMvYHMEFFcyRVMSl1aEl2ZltkWwEEWV1mYxR2QElUZV92dJ90ZqFHTFVWORFlNLFVaNtmTlJlQ58UZFdDZLFzbmF2ZYtiQpFHWLJ1SwxmTPNUYvYjZ090LDFDaFNkYwJUTkV3L&tablename=CJFDLAST2019&dflag=pdfdown"><i class="i-btn i-pdf"></i>PDF下载</a>

                        <p>永久保存本文,请下载至本地</p>
                    </div>

                </div>
            </div>
                        <h2>
                                <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=au&amp;skey=%E5%88%98%E5%BF%97%E6%98%8A&amp;code=40355642&amp;uid=WEEvREcwSlJHSldRa1FhcTdWa2FjcW9xck9nSjc1VXR3SDJsaTcyc24rQT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">刘志昊</a>
                                <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=au&amp;skey=%E5%AD%99%E6%99%93%E5%B1%B1&amp;code=38854312&amp;uid=WEEvREcwSlJHSldRa1FhcTdWa2FjcW9xck9nSjc1VXR3SDJsaTcyc24rQT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">孙晓山</a>
                                <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=au&amp;skey=%E5%BC%A0%E9%98%B3&amp;code=22259537&amp;uid=WEEvREcwSlJHSldRa1FhcTdWa2FjcW9xck9nSjc1VXR3SDJsaTcyc24rQT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">张阳</a>
                </h2>
                    <h2>
                    <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=in&amp;skey=%E4%B8%AD%E5%9B%BD%E7%A7%91%E5%AD%A6%E9%99%A2%E8%BD%AF%E4%BB%B6%E7%A0%94%E7%A9%B6%E6%89%80&amp;code=0046920&amp;uid=WEEvREcwSlJHSldRa1FhcTdWa2FjcW9xck9nSjc1VXR3SDJsaTcyc24rQT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">中国科学院软件研究所</a>
            </h2>

        
<div class="link">
    <a id="aexport" class="icon icon-output"  onclick="" href="javascript:void(0);"><i></i>导出/参考文献</a>
    
    <span class="shareBoard" onmouseover="$('#sharedet').show();$('#this').addClass('shareBoardCUR')" onmouseout="$('#sharedet').hide();$('#this').removeClass('shareBoardCUR')">
        <a class="icon icon-share" href="#"><i></i>分享<em></em></a>
        <ul class="shareHide" id="sharedet" style="display: none;">
            <li><a title="复制链接" class="copy" onclick="" href="#"><i></i>复制链接</a></li>
            <li><a title="分享到新浪微博" class="xl" onclick="" href="javascript:common.ShareAction('xl');"><i></i>新浪微博</a></li>
            <li>
                <a title="分享到微信" class="wx" onclick="" href="#"><i></i>微信扫一扫</a>
                <div class="qrcode"><img src='' alt='' /></div>
            </li>
        </ul>

    </span>
    
    <a id="RefTrack" title="创建引文跟踪" class="icon icon-track" onclick="" href="javascript:void(0);"> <i></i>创建引文跟踪 </a>
    <a id="ashoucang" title="收藏" class="icon icon-favor" onclick="" href="javascript:void(0);"><i></i>收藏</a>
    <a class="icon icon-print" onclick="window.print();" href="javascript:void(0);"><i></i>打印</a>
    
    <!--版本切换 end-->
</div>
                            <div class="data" id="a_abstract">
                <span class="keys">摘<span style="font-family: 'Times New Roman';">&nbsp;&nbsp;&nbsp;&nbsp;</span>要：</span>
                <p>为在语言解释器的模糊测试中构造符合语言规范的样本, 并尽可能地得出异常测试结果以便发现漏洞, 采用改进的概率上下文无关语法模型控制样本的变异过程, 对变异结果中的未定义变量进行修正以提高符合语言规范的样本比率。在此基础上, 对语言解释器进行模糊测试, 结果表明, 该测试所生成样本中符合语法、语义规范的比率高达96%。</p>
            </div>
                    <div class="data" id="a_keywords">
                <span class="keys">关键词：</span>
                <p>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=%E6%A8%A1%E7%B3%8A%E6%B5%8B%E8%AF%95&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhcTdWa2FjcW9xck9nSjc1VXR3SDJsaTcyc24rQT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">模糊测试;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=%E9%A9%AC%E5%B0%94%E7%A7%91%E5%A4%AB%E6%A8%A1%E5%9E%8B&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhcTdWa2FjcW9xck9nSjc1VXR3SDJsaTcyc24rQT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">马尔科夫模型;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=%E6%A6%82%E7%8E%87%E4%B8%8A%E4%B8%8B%E6%96%87%E6%97%A0%E5%85%B3%E8%AF%AD%E6%B3%95&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhcTdWa2FjcW9xck9nSjc1VXR3SDJsaTcyc24rQT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">概率上下文无关语法;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhcTdWa2FjcW9xck9nSjc1VXR3SDJsaTcyc24rQT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">机器学习;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=%E8%AF%AD%E8%A8%80%E8%A7%A3%E9%87%8A%E5%99%A8&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhcTdWa2FjcW9xck9nSjc1VXR3SDJsaTcyc24rQT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">语言解释器;</a>
                </p>
            </div>
        
        <!--brief start-->
        
            <div class="brief">
                    <p>
                            <b>作者简介：</b>
                                                        <span>
                                    刘志昊 (1993—) , 男, 博士研究生, 主研方向为网络与系统安全;E-mail: lzhha2006@ 126. com;
                                </span>
                                <span>
                                    孙晓山, 助理研究员;;
                                </span>
                                <span>
                                    张阳, 副研究员。;
                                </span>
                    </p>
                                    <p><b>收稿日期：</b>2018-03-29</p>

                    <p>

                            <b>基金：</b>
                                                        <span>国家自然科学基金 (61471344);</span>
                    </p>
            </div>
                    <h1><b>Fuzzy Testing of Language Interpreter Based on Improved PCFG</b></h1>
                    <h2>
                    <span>LIU Zhihao</span>
                    <span>SUN Xiaoshan</span>
                    <span>ZHANG Yang</span>
            </h2>
                    <h2>
                    <span>Institute of Software, Chinese Academy of Sciences</span>
            </h2>
                            <div class="data" id="a_abstractEN">
                <span class="keys">Abstract：</span>
                <p>In order to construct samples that conform to language norms in fuzzy testing of language interpreter, and get abnormal test results as far as possible to find vulnerabilities, the improved Probabilistic Context Free Grammar (PCFG) model is used to control the variation process of samples, and the undefined variables in the variation results are modified to increase the ratio of samples that conform to language norms.On this basis, the language interpreter is tested by fuzzy testing.Results show that the ratio of samples generated by the test that conform to the grammatical and semantic norms is as high as 96%.</p>
            </div>
                    <div class="data" id="a_keywordsEN">
                <span class="keys">Keyword：</span>
                <p>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=fuzzing%20testing&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhcTdWa2FjcW9xck9nSjc1VXR3SDJsaTcyc24rQT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">fuzzing testing;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=Markov%20model&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhcTdWa2FjcW9xck9nSjc1VXR3SDJsaTcyc24rQT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">Markov model;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=Probabilistic%20Context%20Free%20Grammar%20(PCFG)%20&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhcTdWa2FjcW9xck9nSjc1VXR3SDJsaTcyc24rQT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">Probabilistic Context Free Grammar (PCFG) ;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=machine%20learning&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhcTdWa2FjcW9xck9nSjc1VXR3SDJsaTcyc24rQT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">machine learning;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=language%20interpreter&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhcTdWa2FjcW9xck9nSjc1VXR3SDJsaTcyc24rQT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">language interpreter;</a>
                </p>
            </div>
                    <div class="brief">
                
                    <p>
                                            </p>
                                    <p><b>Received：</b> 2018-03-29</p>
                                    <p>
                                            </p>
            </div>


        <!--brief start-->
                        <h3 id="33" name="33" class="anchor-tag">0 概述</h3>
                <div class="p1">
                    <p id="34">在网络安全领域, 浏览器中的漏洞通常被用来实现网络攻击。JavaScript解释器的漏洞是浏览器漏洞中的重要组成部分。由于JavaScript解释器存在于浏览器的底层, 较多应用 (包括手机应用) 都使用浏览器提供的引擎解析网页内容。因此, 挖掘JavaScript解释器中的漏洞得到研究者的广泛关注。目前, 模糊测试是发现该漏洞的主要方法<citation id="130" type="reference"><link href="97" rel="bibliography" /><link href="99" rel="bibliography" /><sup>[<a class="sup">1</a>,<a class="sup">2</a>]</sup></citation>。与针对二进制文件的模糊测试AFLGo<citation id="127" type="reference"><link href="101" rel="bibliography" /><sup>[<a class="sup">3</a>]</sup></citation>、AFLFast<citation id="128" type="reference"><link href="103" rel="bibliography" /><sup>[<a class="sup">4</a>]</sup></citation>、Vuzzer<citation id="129" type="reference"><link href="105" rel="bibliography" /><sup>[<a class="sup">5</a>]</sup></citation>相比, 由于解释器代码与输入结构更加复杂, 路径组合空间更大, 解释器模糊测试需要性能更高的策略。</p>
                </div>
                <div class="p1">
                    <p id="35">目前, 语言解释器模糊测试所采用的方法主要包括随机变异、随机组合、启发引导生成等。随机变异方法的典型代表是JsFunFuzz<citation id="131" type="reference"><link href="107" rel="bibliography" /><sup>[<a class="sup">6</a>]</sup></citation>, 其采用随机改变输入样本字符的方法生成一些既满足一部分规则同时有意违反另一部分规则的新样本。JsFunFuzz语言规则由人工编写, 维护成本较高。LangFuzz<citation id="132" type="reference"><link href="109" rel="bibliography" /><sup>[<a class="sup">7</a>]</sup></citation>针对多种语言的模糊测试需求以及复杂样本的构造特点, 采用语法解析器将样本解析为语法树形式, 然后对语法树的节点进行随机变换, 包括插入、交换等操作。文献<citation id="133" type="reference">[<a class="sup">8</a>]</citation>提出一种SampleFuzz方法, 其通过机器学习生成更可能导致解释器崩溃的样本。SampleFuzz利用大量样本对模型进行训练, 使模型可以生成较符合语言规范的样本。但是SampleFuzz在生成过程中, 并非选择概率最大的元素, 其思想是低概率的序列更可能覆盖新的未测试代码路径从而发现新的缺陷。Skyfire<citation id="134" type="reference"><link href="113" rel="bibliography" /><sup>[<a class="sup">9</a>]</sup></citation>采用上下文敏感语法描述语义特征, 通过大规模样本学习元素与语法规则的概率分布, 选择低概率的元素与规则, 从而提高发现缺陷的概率。Ifuzzer<citation id="135" type="reference"><link href="115" rel="bibliography" /><sup>[<a class="sup">10</a>]</sup></citation>通过遗传算法生成新样本, 遗传算法采用基于代码复杂度引导的适应函数, 以产生更加复杂的脚本。</p>
                </div>
                <div class="p1">
                    <p id="36">JavaScript语言具有复杂的语法规则与语义特征。由于常规脚本很难触发漏洞, 需要利用异常脚本提高模糊测试的效率。从统计学的角度分析, 异常脚本属于低概率脚本, 可以利用脚本语言的非均匀性特征<citation id="136" type="reference"><link href="117" rel="bibliography" /><link href="119" rel="bibliography" /><link href="121" rel="bibliography" /><sup>[<a class="sup">11</a>,<a class="sup">12</a>,<a class="sup">13</a>]</sup></citation>。</p>
                </div>
                <div class="p1">
                    <p id="37">脚本语言可以解析为语法树形式, 而概率上下文无关语法 (Probabilistic Context Free Grammar, PCFG) <citation id="137" type="reference"><link href="123" rel="bibliography" /><sup>[<a class="sup">14</a>]</sup></citation>适用于描述树形结构, 且其参数训练速度较快, 通常可以获得数G级的脚本库。因此, 本文基于改进的PCFG模型, 尽可能生成异常的脚本片段, 将其输入到解释器中以进行模糊测试。</p>
                </div>
                <h3 id="38" name="38" class="anchor-tag">1 改进的PCFG模型</h3>
                <div class="p1">
                    <p id="39">本文采用的模糊测试框架包括样本变异模块、执行测试模块等。样本变异模块从Mozilla的回归测试用例中随机选择脚本文件, 采用PCFG提供的信息随机选择语法树的节点进行变异, 并对变异结果中的未定义变量进行修正, 以获得新的样本, 然后观测执行结果, 如果发生解释器崩溃现象, 则记录结果并进行汇报。本文模糊测试系统结构如图1所示。</p>
                </div>
                <div class="area_img" id="40">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JSJC201908004_040.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdWa2FjcW9xck9nSjc1VXR3SDJsaTcyc24rQT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图1 模糊测试系统结构" src="Detail/GetImg?filename=images/JSJC201908004_040.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdWa2FjcW9xck9nSjc1VXR3SDJsaTcyc24rQT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit"><b>图1 模糊测试系统结构</b>  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JSJC201908004_040.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdWa2FjcW9xck9nSjc1VXR3SDJsaTcyc24rQT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <h4 class="anchor-tag" id="41" name="41">1.1 PCFG模型</h4>
                <div class="p1">
                    <p id="42">PCFG模型包括的元素可以用五元组 (<i>V</i>, <i>N</i>, <i>S</i>, <i>R</i>, <i>D</i>) 进行描述。各元素定义如下:</p>
                </div>
                <div class="p1">
                    <p id="43"><i>V</i>:一组终端元素, 包括字符串、整数以及变量等。</p>
                </div>
                <div class="p1">
                    <p id="44"><i>N</i>:一组非终端元素, 包括语句、循环结构等。</p>
                </div>
                <div class="p1">
                    <p id="45"><i>S</i>:程序的开始符号。</p>
                </div>
                <div class="p1">
                    <p id="46"><i>R</i>:一组形式规则<i>N</i><sub><i>i</i></sub>→<i>β</i><sub><i>m</i></sub>, 其中, <i>β</i><sub><i>m</i></sub>=<i>M</i><sub>1</sub><i>M</i><sub>2</sub>…<i>M</i><sub><i>n</i></sub>是由非终端元素和终端元素混合组成的序列。</p>
                </div>
                <div class="p1">
                    <p id="47"><i>D</i>:概率分布描述函数。</p>
                </div>
                <div class="p1">
                    <p id="48">因此, 有:</p>
                </div>
                <div class="p1">
                    <p id="49" class="code-formula">
                        <mathml id="49"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mstyle displaystyle="true"><munder><mo>∑</mo><mi>m</mi></munder><mi>D</mi></mstyle><mo stretchy="false"> (</mo><mi>Ν</mi><msub><mrow></mrow><mi>i</mi></msub><mo>→</mo><mi>β</mi><msub><mrow></mrow><mi>m</mi></msub><mo stretchy="false">) </mo><mo>=</mo><mn>1</mn><mo>, </mo><mo>∀</mo><mi>i</mi></mrow></math></mathml>
                    </p>
                </div>
                <div class="p1">
                    <p id="50">PCFG较早提出用于解析自然语言的结构。由于自然语言具有歧义, 因此一个句子可能存在2种及以上的语法树, PCFG通常被用来判断最可能的语法树。程序语言的语法树具有唯一性, 对于一个解析所得的语法树<i>t</i>, 本文定义其概率为:</p>
                </div>
                <div class="p1">
                    <p id="51" class="code-formula">
                        <mathml id="51"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>Ρ</mi><mo stretchy="false"> (</mo><mi>t</mi><mo stretchy="false">) </mo><mo>=</mo><mi>D</mi><mo stretchy="false"> (</mo><mi>Ν</mi><msub><mrow></mrow><mi>t</mi></msub><mo>→</mo><mi>β</mi><mo stretchy="false">) </mo><mstyle displaystyle="true"><munderover><mo>∏</mo><mn>1</mn><mi>k</mi></munderover><mi>Ρ</mi></mstyle><mo stretchy="false"> (</mo><mi>t</mi><msub><mrow></mrow><mrow><mi>Μ</mi><msub><mrow></mrow><mi>i</mi></msub></mrow></msub><mo stretchy="false">) </mo></mrow></math></mathml>
                    </p>
                </div>
                <div class="p1">
                    <p id="52">其中, <i>N</i><sub><i>t</i></sub>是语法树<i>t</i>的根节点, <i>t</i><sub><i>M</i><sub><i>i</i></sub></sub>是根为<i>M</i><sub><i>i</i></sub>的子树的根节点。</p>
                </div>
                <h4 class="anchor-tag" id="53" name="53">1.2 模型改进</h4>
                <div class="p1">
                    <p id="54">规则<i>N</i><sub><i>i</i></sub>→<i>β</i><sub><i>m</i></sub>描述了<i>N</i><sub><i>i</i></sub>与<i>β</i><sub><i>m</i></sub>间的概率关系。<i>β</i><sub><i>m</i></sub>可能包含多个符号或者元素, 他们之间的依赖关系在模型中未得到反映, 但是该依赖关系为脚本片段概率的一部分。为引入这种依赖关系, 本文结合JavaScript的语法, 对PCFG模型进行改进。图2所示为一段脚本的语法树描述, 图3所示为JavaScript部分语法描述。</p>
                </div>
                <div class="area_img" id="55">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JSJC201908004_055.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdWa2FjcW9xck9nSjc1VXR3SDJsaTcyc24rQT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图2 一个代码片段的语法树描述" src="Detail/GetImg?filename=images/JSJC201908004_055.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdWa2FjcW9xck9nSjc1VXR3SDJsaTcyc24rQT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit"><b>图2 一个代码片段的语法树描述</b>  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JSJC201908004_055.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdWa2FjcW9xck9nSjc1VXR3SDJsaTcyc24rQT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="area_img" id="56">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JSJC201908004_056.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdWa2FjcW9xck9nSjc1VXR3SDJsaTcyc24rQT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图3 JavaScript部分语法描述" src="Detail/GetImg?filename=images/JSJC201908004_056.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdWa2FjcW9xck9nSjc1VXR3SDJsaTcyc24rQT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit"><b>图3 JavaScript部分语法描述</b>  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JSJC201908004_056.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdWa2FjcW9xck9nSjc1VXR3SDJsaTcyc24rQT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="p1">
                    <p id="57">图2中的stmt_list为不定长, 其对应的PCFG规则为<i>N</i><sub><i>i</i></sub>→<i>β</i><sub><i>m</i></sub>, 但<i>β</i><sub><i>m</i></sub>需要明确定义。因此, 如果采用原始PCFG定义程序语言, 则会引入大量的规则, 这将增加PCFG模型的参数量, 导致参数学习难度加大。例如, <i>β</i><sub><i>m</i></sub>的具体例子包括:fun_defassignif, iffun_defassignassign, whileifwhileassign assign。</p>
                </div>
                <div class="p1">
                    <p id="58">由于规则组合的数量极大, 语料库无法提供所有可能的组合方案, 这将导致对很多组合的频度估计偏差较大。该问题在自然语言处理中并不存在, 只来源于脚本等程序语言。本文通过马尔科夫模型直接对序列进行建模, 以处理上述问题。</p>
                </div>
                <div class="p1">
                    <p id="59">对于stmt_list语法规则生成的语句序列, 能够将其视为一个由马尔科夫过程生成的序列, 即可以使用马尔科夫模型对其进行建模。本文假设每个语句直接受上一个语句的影响 (此处的假设只是近似假设, 实际程序中的语句依赖关系较复杂) , 对于一个stmt_list, 其概率可以表示为:</p>
                </div>
                <div class="p1">
                    <p id="60" class="code-formula">
                        <mathml id="60"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>Ρ</mi><mo stretchy="false"> (</mo><mi>Μ</mi><msub><mrow></mrow><mn>1</mn></msub><mo stretchy="false">|</mo><mi>Ν</mi><msub><mrow></mrow><mi>t</mi></msub><mo stretchy="false">) </mo><mstyle displaystyle="true"><munderover><mo>∏</mo><mn>2</mn><mi>k</mi></munderover><mrow></mrow></mstyle><mi>Ρ</mi><mo stretchy="false"> (</mo><mi>Μ</mi><msub><mrow></mrow><mi>i</mi></msub><mo stretchy="false">|</mo><mi>Μ</mi><msub><mrow></mrow><mrow><mi>i</mi><mo>-</mo><mn>1</mn></mrow></msub><mo stretchy="false">) </mo></mrow></math></mathml>
                    </p>
                </div>
                <div class="p1">
                    <p id="61">因此, 整个<i>N</i><sub><i>t</i></sub>→<i>β</i><sub><i>k</i></sub>的概率可以描述为:</p>
                </div>
                <div class="p1">
                    <p id="62" class="code-formula">
                        <mathml id="62"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>D</mi><mo stretchy="false"> (</mo><mi>Ν</mi><msub><mrow></mrow><mi>t</mi></msub><mo stretchy="false">) </mo><mi>Ρ</mi><mo stretchy="false"> (</mo><mi>Μ</mi><msub><mrow></mrow><mn>1</mn></msub><mo stretchy="false">|</mo><mi>Ν</mi><msub><mrow></mrow><mi>t</mi></msub><mo stretchy="false">) </mo><mstyle displaystyle="true"><munderover><mo>∏</mo><mn>2</mn><mi>k</mi></munderover><mrow></mrow></mstyle><mi>Ρ</mi><mo stretchy="false"> (</mo><mi>Μ</mi><msub><mrow></mrow><mi>i</mi></msub><mo stretchy="false">|</mo><mi>Μ</mi><msub><mrow></mrow><mrow><mi>i</mi><mo>-</mo><mn>1</mn></mrow></msub><mo stretchy="false">) </mo></mrow></math></mathml>
                    </p>
                </div>
                <div class="p1">
                    <p id="63">在训练过程中, 只需计算相邻语句之间的转移概率即可, 而相邻语句的组合在较大语料库中出现的频率不会产生稀疏问题, 对于概率计算结果的影响较小。因此, 一个语法树的概率可以表示为:</p>
                </div>
                <div class="p1">
                    <p id="64" class="code-formula">
                        <mathml id="64"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>Ρ</mi><mo stretchy="false"> (</mo><mi>t</mi><mo stretchy="false">) </mo><mo>=</mo><mi>D</mi><mo stretchy="false"> (</mo><mi>Ν</mi><msub><mrow></mrow><mi>t</mi></msub><mo stretchy="false">) </mo><mi>Ρ</mi><mo stretchy="false"> (</mo><mi>Μ</mi><msub><mrow></mrow><mn>1</mn></msub><mo stretchy="false">|</mo><mi>Ν</mi><msub><mrow></mrow><mi>t</mi></msub><mo stretchy="false">) </mo><mstyle displaystyle="true"><munderover><mo>∏</mo><mn>2</mn><mi>k</mi></munderover><mrow></mrow></mstyle><mi>Ρ</mi><mo stretchy="false"> (</mo><mi>Μ</mi><msub><mrow></mrow><mi>i</mi></msub><mo stretchy="false">|</mo><mi>Μ</mi><msub><mrow></mrow><mrow><mi>i</mi><mo>-</mo><mn>1</mn></mrow></msub><mo stretchy="false">) </mo><mstyle displaystyle="true"><munderover><mo>∏</mo><mn>1</mn><mi>k</mi></munderover><mi>Ρ</mi></mstyle><mo stretchy="false"> (</mo><mi>t</mi><msub><mrow></mrow><mrow><mi>Μ</mi><msub><mrow></mrow><mi>i</mi></msub></mrow></msub><mo stretchy="false">) </mo></mrow></math></mathml>
                    </p>
                </div>
                <h4 class="anchor-tag" id="65" name="65">1.3 参数训练</h4>
                <div class="p1">
                    <p id="66">在<i>P</i> (<i>t</i>) 的计算公式中, 需要训练的参数包括<i>D</i> (<i>N</i><sub><i>t</i></sub>) 、<i>P</i> (<i>M</i><sub>1</sub>|<i>N</i><sub><i>t</i></sub>) 、<i>P</i> (<i>M</i><sub><i>i</i></sub>|<i>M</i><sub><i>i</i>-1</sub>) 等。本文利用语料库来确定参数值。解析语料库中的脚本片段, 获得语法树, 对语法树进行遍历, 可以得到如下的统计信息:每种语法树的数量#<i>N</i><sub><i>i</i></sub>, 每个stmt_list中相邻语句组合的数量#<i>M</i><sub><i>i</i>-1</sub><i>M</i><sub><i>i</i></sub>, 语法树中第1个元素的数量等。对于<i>D</i> (<i>N</i><sub><i>i</i></sub>) , 其频率估算为:</p>
                </div>
                <div class="p1">
                    <p id="67" class="code-formula">
                        <mathml id="67"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>D</mi><mo stretchy="false"> (</mo><mi>Ν</mi><msub><mrow></mrow><mi>i</mi></msub><mo stretchy="false">) </mo><mo>=</mo><mfrac><mrow><mo>#</mo><mi>Ν</mi><msub><mrow></mrow><mi>i</mi></msub></mrow><mrow><mo>#</mo><mi>Ν</mi></mrow></mfrac></mrow></math></mathml>
                    </p>
                </div>
                <div class="p1">
                    <p id="68">其中, #<i>N</i>是语料库中出现的语法树与子树的总数量。</p>
                </div>
                <div class="p1">
                    <p id="69" class="code-formula">
                        <mathml id="69"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>Ρ</mi><mo stretchy="false"> (</mo><mi>Μ</mi><msub><mrow></mrow><mi>i</mi></msub><mo stretchy="false">|</mo><mi>Μ</mi><msub><mrow></mrow><mrow><mi>i</mi><mo>-</mo><mn>1</mn></mrow></msub><mo stretchy="false">) </mo><mo>=</mo><mfrac><mrow><mo>#</mo><mi>Μ</mi><msub><mrow></mrow><mi>i</mi></msub></mrow><mrow><mo>#</mo><mi>Μ</mi><msub><mrow></mrow><mrow><mi>i</mi><mo>-</mo><mn>1</mn></mrow></msub><mi>Μ</mi><msub><mrow></mrow><mi>i</mi></msub></mrow></mfrac></mrow></math></mathml>
                    </p>
                </div>
                <div class="p1">
                    <p id="70">其中, #<i>M</i><sub><i>i</i></sub>是#<i>N</i><sub><i>t</i></sub>语法树中<i>M</i><sub><i>i</i></sub>出现的数量。</p>
                </div>
                <div class="p1">
                    <p id="71" class="code-formula">
                        <mathml id="71"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>Ρ</mi><mo stretchy="false"> (</mo><mi>Μ</mi><msub><mrow></mrow><mi>i</mi></msub><mo stretchy="false">|</mo><mi>Ν</mi><msub><mrow></mrow><mi>i</mi></msub><mo stretchy="false">) </mo><mo>=</mo><mfrac><mrow><mo>#</mo><mi>Μ</mi><msub><mrow></mrow><mn>1</mn></msub></mrow><mrow><mo>#</mo><mi>Ν</mi><msub><mrow></mrow><mi>i</mi></msub></mrow></mfrac></mrow></math></mathml>
                    </p>
                </div>
                <div class="p1">
                    <p id="72">其中, #<i>M</i><sub>1</sub>是<i>M</i><sub>1</sub>作为第1个元素出现的数量。</p>
                </div>
                <div class="p1">
                    <p id="73">因为可以快速实现语句的数量统计, 所以上述训练过程的速度较快。</p>
                </div>
                <h4 class="anchor-tag" id="74" name="74">1.4 变量引用修正</h4>
                <div class="p1">
                    <p id="75">由于脚本生成过程中会采用新的节点进行替换, 最终生成脚本中的变量可能没有定义, 且该现象是导致脚本被解释器拒绝的主要原因。本文通过对语法树进行遍历, 发现其中的未定义变量, 然后选择脚本中最近定义的变量名替代原未定义变量, 以提高脚本的准确率。本文通过栈保留变量定义域, 减少由于定义域问题导致的变量未定义现象。</p>
                </div>
                <h3 id="76" name="76" class="anchor-tag">2 实验结果与分析</h3>
                <div class="p1">
                    <p id="77">本文采用SpiderMonkey JavaScript引擎作为测试对象。从Gtihub上获取共50 000个JavaScript文件作为训练语料, 将SpiderMonkey中用于回归测试的脚本文件作为模糊测试的初始样本。实验中所使用的原型系统由Python语言开发, 代码规模大约为3 000行。其中, JavaScript语法通过Acorn进行解析, 结果存储于磁盘, 通过读取文件的方式重新被Python程序加载。实验环境为Intel i7-6700 CPU (频率3.40 GHz) , 内存8 GB, 操作系统是Ubuntu 16.04, 通过js命令行工具进行测试。实验结果如图4所示, 表1所示为不同类型的语法树出现的频度。可以看出, 每种语句的分布并不均匀, 具有特定的幂律分布规律<citation id="138" type="reference"><link href="125" rel="bibliography" /><sup>[<a class="sup">15</a>]</sup></citation>。其中, 最常见的子树类型是成员表达式、调用表达式等。这种分布规律是采用机器学习方法改进模糊测试的统计基础。</p>
                </div>
                <div class="area_img" id="78">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JSJC201908004_078.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdWa2FjcW9xck9nSjc1VXR3SDJsaTcyc24rQT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图4 语法树类型的频度统计结果" src="Detail/GetImg?filename=images/JSJC201908004_078.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdWa2FjcW9xck9nSjc1VXR3SDJsaTcyc24rQT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit"><b>图4 语法树类型的频度统计结果</b>  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JSJC201908004_078.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdWa2FjcW9xck9nSjc1VXR3SDJsaTcyc24rQT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="area_img" id="79">
                    <p class="img_tit"><b>表1 最高频的5种语法结构占比情况</b> <a class="downexcel" onclick="DownLoadReportExcel(this)">导出到EXCEL</a></p>
                    <p class="img_tit"></p>
                    <p class="img_note"> %</p>
                    <table id="79" border="1"><tr><td><br />语法树/子树类型</td><td>占比</td></tr><tr><td><br />MemberExpression</td><td>25.39</td></tr><tr><td><br />CallExpression</td><td>11.56</td></tr><tr><td><br />ExpressionStatement</td><td>10.43</td></tr><tr><td><br />BlockStatement</td><td>7.43</td></tr><tr><td><br />Property</td><td>6.40</td></tr></table>
                    <form name="form" action="/kxreader/Detail/DownloadReportExcel" method="POST" style="display:inline">
                        <input type="hidden" name="hidTable" value="" />
                        <input type="hidden" name="hidFileName" value="" />
                    </form>
                    <p class="img_note"></p>
                    <p class="img_note"></p>
                </div>
                <div class="p1">
                    <p id="80">本文的模糊测试需要对原样本进行变异。在随机修正的情况下, 生成样本中符合语法、语义规范的比率 (即样本准确率) 低于20% (变异率为15%) , 其余被解释器报告为存在语法、语义错误。因此, 生成样本是否存在语法、语义问题也是重要的性能评价指标。本文模糊测试准确率结果如表2所示。从表2可以看出, 加入修正后的模糊测试可以使准确率提升至96%。</p>
                </div>
                <div class="area_img" id="81">
                    <p class="img_tit"><b>表2 模糊测试生成样本的准确率结果</b> <a class="downexcel" onclick="DownLoadReportExcel(this)">导出到EXCEL</a></p>
                    <p class="img_tit"></p>
                    <p class="img_note"></p>
                    <table id="81" border="1"><tr><td>实验编号</td><td>生成样本数</td><td>准确样本数</td><td>准确率/%</td></tr><tr><td><br />1</td><td>10 000</td><td>9 622</td><td>96.22</td></tr><tr><td><br />2</td><td>10 000</td><td>9 608</td><td>96.08</td></tr><tr><td><br />3</td><td>10 000</td><td>9 613</td><td>96.13</td></tr></table>
                    <form name="form" action="/kxreader/Detail/DownloadReportExcel" method="POST" style="display:inline">
                        <input type="hidden" name="hidTable" value="" />
                        <input type="hidden" name="hidFileName" value="" />
                    </form>
                    <p class="img_note"></p>
                    <p class="img_note"></p>
                </div>
                <div class="p1">
                    <p id="82">在实际应用中, 经过一周的运行, 本文系统发现了一个SpiderMonkey漏洞, 报告给mozilla得到确认, 其编号为bugzilla1415291。产生该漏洞的原因是js::WasmTableObject::getImpl中存在缓冲区溢出问题。</p>
                </div>
                <h3 id="83" name="83" class="anchor-tag">3 结束语</h3>
                <div class="p1">
                    <p id="84">本文建立一种改进的PCFG模型, 以对语言解释器进行模糊测试。利用大规模开源代码中存在的概率分布特征, 启发模糊测试的样本生成, 并通过变量修正等措施提高样本中符合语法、语义规范的比率。实验结果表明, 该模糊测试系统的准确率高达96%, 并能够发现JavaScript解释器中的新漏洞。将本文模型应用于PHP等其他脚本语言解释器的模糊测试, 将是下一步的研究方向。</p>
                </div>

        <!--brief end-->
        
        <!--conten left  end-->
        <!--增强附件-->
        

        <!--reference start-->
            <div class="reference anchor-tag" id="a_bibliography">
                    <h3>参考文献</h3>
                                        <p id="97">
                            <a id="bibliography_1" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JSJC201608023&amp;v=MTUwMzMzenFxQnRHRnJDVVJMT2VaZVJxRnkvZ1VMek9MejdCYmJHNEg5Zk1wNDlIWjRRS0RIODR2UjRUNmo1NE8=&amp;uid=WEEvREcwSlJHSldRa1FhcTdWa2FjcW9xck9nSjc1VXR3SDJsaTcyc24rQT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[1]</b> 李进东, 王韬, 吴杨, 等.基于协议分析与模糊测试的SIP漏洞挖掘研究[J].计算机工程, 2016, 42 (8) :117-122.
                            </a>
                        </p>
                        <p id="99">
                            <a id="bibliography_2" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JSJC201216029&amp;v=MTgyMTlHRnJDVVJMT2VaZVJxRnkvZ1VMek9MejdCYmJHNEg5UE5xWTlIYllRS0RIODR2UjRUNmo1NE8zenFxQnQ=&amp;uid=WEEvREcwSlJHSldRa1FhcTdWa2FjcW9xck9nSjc1VXR3SDJsaTcyc24rQT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[2]</b> 苏晓艳, 武东英, 刘龙, 等.基于Fuzzing的Cisco IOS漏洞挖掘方法[J].计算机工程, 2012, 38 (16) :117-120.
                            </a>
                        </p>
                        <p id="101">
                            <a id="bibliography_3" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Directed greybox fuzzing">

                                <b>[3]</b> BÖHME M, PHAM V T, NGUYEN M D, et al.Directed greybox fuzzing[C]//Proceedings of 2017 ACM SIGSAC Conference on Computer and Communications Security.New York, USA:ACM Press, 2017:2329-2344.
                            </a>
                        </p>
                        <p id="103">
                            <a id="bibliography_4" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Coverage-based Greybox Fuzzing as Markov Chain">

                                <b>[4]</b> PHAM V T, ROYCHOUDHURY A.Coverage-based greybox fuzzing as Markov chain[C]//Proceedings of 2016 ACM SIGSAC Conference on Computer and Communications Security.New York, USA:ACM Press, 2016:1032-1043.
                            </a>
                        </p>
                        <p id="105">
                            <a id="bibliography_5" target="_blank" href="http://scholar.cnki.net/result.aspx?q=VUzzer:application-aware evolutionary fuzzing">

                                <b>[5]</b> RAWAT S, JAIN V, KUMAR A, et al.VUzzer:application-aware evolutionary fuzzing[EB/OL].[2018-03-10].https://www.cs.vu.nl/～herbertb/download/papers/vuzzer_ndss17.pdf.
                            </a>
                        </p>
                        <p id="107">
                            <a id="bibliography_6" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Introducing jsfunfuzz">

                                <b>[6]</b> RUDERMAN J.Introducing JsFunfuzz[EB/OL].[2018-03-10].http://www.squarefree.com/2007/08/02/introducing-jsfunfuzz/.
                            </a>
                        </p>
                        <p id="109">
                            <a id="bibliography_7" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Fuzzing with code fragments">

                                <b>[7]</b> HOLLER C, HERZIG K, ZELLER A.Fuzzing with code fragments[C]//Proceedings of the 21st USENIX Conference on Security Symposium.Berkeley, USA:USENIX Association, 2012:445-458.
                            </a>
                        </p>
                        <p id="111">
                            <a id="bibliography_8" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Learn and fuzz:machine learning for input fuzzing">

                                <b>[8]</b> GODEFROID P, PELEG H, SINGH R.Learn and fuzz:machine learning for input fuzzing[EB/OL].[2018-03-11].https://arxiv.org/pdf/1701.07232.pdf.
                            </a>
                        </p>
                        <p id="113">
                            <a id="bibliography_9" target="_blank" href="http://scholar.cnki.net/result.aspx?q=&amp;quot;Skyfire:Data-Driven Seed Generation for Fuzzing&amp;quot;">

                                <b>[9]</b> WANG Junjie, CHEN Bihuan, WEI Lei, et al.Skyfire:data-driven seed generation for fuzzing[C]//Proceedings of 2017 IEEE Symposium on Security and Privacy.Washington D.C., USA:IEEE Press, 2017:579-594.
                            </a>
                        </p>
                        <p id="115">
                            <a id="bibliography_10" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Ifuzzer:An evolutionary interpreter fuzzer using genetic programming">

                                <b>[10]</b> VEGGALAM S, RAWAT S, HALLER I, et al.IFuzzer:an evolutionary interpreter fuzzer using genetic program-ming[C]//Proceedings of the 21st European Symposium on Research in Computer Security.Berlin, Germany:Springer, 2016:581-601.
                            </a>
                        </p>
                        <p id="117">
                            <a id="bibliography_11" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Learning programs from noisy data">

                                <b>[11]</b> RAYCHEV V, BIELIK P, VECHEV M, et al.Learning programs from noisy data[C]//Proceedings of ACM SIGPLAN-SIGACT Symposium on Principles of Programming Languages.New York, USA:ACM Press, 2016:761-774.
                            </a>
                        </p>
                        <p id="119">
                            <a id="bibliography_12" target="_blank" href="http://scholar.cnki.net/result.aspx?q=On the Localness of Software">

                                <b>[12]</b> TU Zhaopeng, SU Zhengdong, DEVANBU P.On the localness of software[C]//Proceedings of ACM SIGSOFT International Symposium on Foundations of Software Engineering.New York, USA:ACM Press, 2014:269-280.
                            </a>
                        </p>
                        <p id="121">
                            <a id="bibliography_13" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Learning from &amp;quot;big code&amp;quot;">

                                <b>[13]</b> Learning from “big code”[EB/OL].[2018-03-10].http://learnbigcode.github.io/datasets/.
                            </a>
                        </p>
                        <p id="123">
                            <a id="bibliography_14" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Foundations of Statistical Natural Language Processing">

                                <b>[14]</b> MANNING C D, HINRICH S.Foundations of statistical natural language processing[M].Cambridge, USA:MIT Press, 1999.
                            </a>
                        </p>
                        <p id="125">
                            <a id="bibliography_15" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Power-law distributions in empirical data">

                                <b>[15]</b> VIRKAR Y, CLAUSET A.Power-law distributions in binned empirical data[J].SIAM Review, 2012, 51 (4) :661-703.
                            </a>
                        </p>
            </div>
        <!--reference end-->
        <!--footnote start-->
        <!--footnote end-->

            <div class="btn-downloads">
                <span>
                    <a class="caj" target="_blank" href="http://kns.cnki.net/kns/download.aspx?filename=wk0UGBDUUNWYIlkRyF2cWVkYXRDMvYHMEFFcyRVMSl1aEl2ZltkWwEEWV1mYxR2QElUZV92dJ90ZqFHTFVWORFlNLFVaNtmTlJlQ58UZFdDZLFzbmF2ZYtiQpFHWLJ1SwxmTPNUYvYjZ090LDFDaFNkYwJUTkV3L&tablename=CJFDLAST2019">CAJ下载</a>
                    <a class="pdf" target="_blank" href="http://kns.cnki.net/kns/download.aspx?filename=wk0UGBDUUNWYIlkRyF2cWVkYXRDMvYHMEFFcyRVMSl1aEl2ZltkWwEEWV1mYxR2QElUZV92dJ90ZqFHTFVWORFlNLFVaNtmTlJlQ58UZFdDZLFzbmF2ZYtiQpFHWLJ1SwxmTPNUYvYjZ090LDFDaFNkYwJUTkV3L&tablename=CJFDLAST2019&dflag=pdfdown">PDF下载</a>
                </span>
                <p>永久保存本文,请下载至本地</p>
            </div>


    </div>

        <input id="fileid" type="hidden" value="JSJC201908004" />
        <input id="dpi" type="hidden" value="600" />
    </div>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?6e967eb120601ea41b9d312166416aa6";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
</script>

    


<input id="hid_uid" name="hid_uid" type="hidden" value="WEEvREcwSlJHSldRa1FhcTdWa2FjcW9xck9nSjc1VXR3SDJsaTcyc24rQT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
<input id="hid_kLogin_headerUrl" name="hid_kLogin_headerUrl" type="hidden" value="/KLogin/Request/GetKHeader.ashx%3Fcallback%3D%3F" />
<input id="hid_kLogin_footerUrl" name="hid_kLogin_footerUrl" type="hidden" value="/KLogin/Request/GetKFooter.ashx%3Fcallback%3D%3F" />
<div class="btn-link" style="display: none"><a target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JSJC201908004&amp;v=MzI2ODFyQ1VSTE9lWmVScUZ5L2dVTHpQTHo3QmJiRzRIOWpNcDQ5RllJUUtESDg0dlI0VDZqNTRPM3pxcUJ0R0Y=&amp;uid=WEEvREcwSlJHSldRa1FhcTdWa2FjcW9xck9nSjc1VXR3SDJsaTcyc24rQT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">知网节</a></div>
<div class="popflow" id="popupTips" style="display: none;">
    <div class="popflowArr"></div>
    <div class="popflowCot">
        <div class="hd"><a href="javascript:void(0);" onclick="$('#popupTips').hide();$('#popupmsg').html('')" class="close">X</a></div>
        <div class="bd">
            <p class="mes" id="popupmsg" name="popupmsg"></p>
          
        </div>
    </div>
</div>
<input type="hidden" id="myexport" value="//kns.cnki.net" />

<input type="hidden" id="KPCAPIPATH" value="//ishufang.cnki.net" />
<input type="hidden" id="CitedTimes" value="" />
<div class="link" id="GLSearch" style="display: none;">
    <i class="icon-trangle"></i>
    <div class="inner">
        <a class="icon" id="copytext">复制</a>
            <a class="icon" id="copytext" target="_blank" href="http://x.cnki.net/search/common/testlunbo?dbcode=CJFD&amp;tablename=CJFDLAST2019&amp;filename=JSJC201908004&amp;filesourcetype=1">划线</a>
            <a class="icon" id="copytext" target="_blank" href="http://x.cnki.net/search/common/testlunbo?dbcode=CJFD&amp;tablename=CJFDLAST2019&amp;filename=JSJC201908004&amp;filesourcetype=1">笔记</a>
            <a class="icon" id="copytext" target="_blank" href="http://x.cnki.net/search/common/testlunbo?dbcode=CJFD&amp;tablename=CJFDLAST2019&amp;filename=JSJC201908004&amp;filesourcetype=1">文摘</a>
        <a class="icon" target="_blank" onclick="searchCRFD(this)">工具书搜索</a>
    </div>
</div>




<input id="hidVirtualPath" name="hidVirtualPath" type="hidden" value="/kxreader" />
<script src="/kxreader/bundles/detail?v=-ULdk-c6FkZHtJA2KAXPgHnyA8mtgyPnBde_C2VZ2BY1"></script>

<script src="/kxreader/Scripts/layer.min.js" type="text/javascript"></script>

<div id="footerBox" class="rootw footer">
</div>
<script>
    if (typeof FlushLogin == 'function') {
        FlushLogin();
    }
    modifyEcpHeader(true);
</script>

<!--图片放大功能 start-->
<script src="/kxreader/bundles/imagebox?v=W4phPu9SNkGcuPeJclikuVE3PpRyIW_gnfjm_19nynI1"></script>

<script type="text/javascript">
    $(function () {
        var j = $.noConflict();
        j(function () {
            j(".zoom-in,.btn-zoomin").imgbox({
                'alignment': 'center',
                'allowMultiple': false,
                'overlayShow': true
            });
        })
    });
</script>
<!--图片放大功能 end-->
<div class="fixedbar">
    <div class="backtop hiddenV" id="backtop">
        <a id="backTopSide" href="javascript:scroll(0,0);" title=""></a>
    </div>
</div>
<script type="text/javascript" src="/kxreader/Scripts/MathJax-2.6-latest/MathJax.js?config=MML_HTMLorMML-full"></script>

</body>
</html>
