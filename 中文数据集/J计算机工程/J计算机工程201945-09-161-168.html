<!DOCTYPE html>
<html>
<head>
    <title>全文阅读--XML全文阅读--中国知网</title>
    <link rel="icon" href="/kxreader/favicon.ico" />
    <link rel="shortcut Icon" href="/kxreader/favicon.ico" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="keywords" content="文献 XML KBASE CNKI 中国知网" />
    <meta name="description" content="XML文献检索" />
    <link href="/kxreader/Content/css/detail?v=qX2z2KjRAEyQiNfAbKtl7dLnsqFoQ5Jdw3TZfDf0n1k1" rel="stylesheet"/>

    <script type="text/javascript">
        var APPPATH = '/kxreader';
    </script>
</head>

<body>
    
<script type="text/javascript" src="//login.cnki.net/TopLogin/api/loginapi/get?type=top&amp;localCSS=&amp;returnurl=%2f%2fkns.cnki.net%2f%2fKXReader%2fDetail%3fTIMESTAMP%3d637128030995342500%26DBCODE%3dCJFD%26TABLEName%3dCJFDLAST2019%26FileName%3dJSJC201909026%26RESULT%3d1%26SIGN%3dr9IvVuOkp9QS6Ty7rRbkuvFan1c%253d"></script>

<div id="headerBox" class="header">
    <div class="topbar">
        <div class="textalign">
            <a href="/kxreader/Detail?dbcode=CJFD&amp;filename=JSJC201909026&amp;align=md">
                <i class="icon-cen active" title="居中对齐"></i>
            </a>
            <a href="/kxreader/Detail?dbcode=CJFD&amp;filename=JSJC201909026&amp;align=lt">
                <i class="icon-left " title="左对齐"></i>
            </a>
        </div>
        <h6 class="free-tip"><i class="icon"></i>HTML阅读开放试用阶段，欢迎体验！</h6>
    </div>
</div>

    



<div class="btn-link" style="display: none"><a target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JSJC201909026&amp;v=MjkwNjdUNmo1NE8zenFxQnRHRnJDVVJMT2VaZVJyRnkvaFU3ckxMejdCYmJHNEg5ak1wbzlIWW9RS0RIODR2UjQ=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4rdTg2cEF4V2xrZkdSczJ5ODhxaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">知网节</a></div>

    <div class="main">

        

    <div class="sidebar-a">
        <!--sidebar start-->
        <div class="sidenav">
            <div class="arrow"><span></span></div>
            <!--sidebar_list start-->
            <dl class="sidenav-list">
                    <dt class="tit">目录结构</dt>
                            <dd class="guide">
                                    <p><a href="#51" data-title="0 概述 ">0 概述</a><i></i></p>
                                                            </dd>
                            <dd class="guide">
                                    <p><a href="#55" data-title="1 相关工作 ">1 相关工作</a><i></i></p>
                                                                    <ul class="contentbox">
                                                <li><a href="#57" data-title="1.1 隐马尔可夫模型概述">1.1 隐马尔可夫模型概述</a></li>
                                                <li><a href="#65" data-title="1.2 隐马尔可夫模型中的基本问题">1.2 隐马尔可夫模型中的基本问题</a></li>
                                    </ul>
                            </dd>
                            <dd class="guide">
                                    <p><a href="#124" data-title="2 基于HMM的恶意域名检测 ">2 基于HMM的恶意域名检测</a><i></i></p>
                                                                    <ul class="contentbox">
                                                <li><a href="#125" data-title="2.1 恶意域名检测问题描述">2.1 恶意域名检测问题描述</a></li>
                                                <li><a href="#129" data-title="2.2 基于HMM的恶意域名检测问题描述">2.2 基于HMM的恶意域名检测问题描述</a></li>
                                                <li><a href="#133" data-title="2.3 基于HMM的恶意域名识别系统">2.3 基于HMM的恶意域名识别系统</a></li>
                                    </ul>
                            </dd>
                            <dd class="guide">
                                    <p><a href="#177" data-title="3 实验结果与分析 ">3 实验结果与分析</a><i></i></p>
                                                                    <ul class="contentbox">
                                                <li><a href="#178" data-title="3.1 实验准备">3.1 实验准备</a></li>
                                                <li><a href="#184" data-title="3.2 HMM模型下的分类效果测试">3.2 HMM模型下的分类效果测试</a></li>
                                    </ul>
                            </dd>
                            <dd class="guide">
                                    <p><a href="#214" data-title="4 结束语 ">4 结束语</a><i></i></p>
                                                            </dd>
                            <dd class="guide">
                                    <p><a href="#" data-title="文内图表 ">文内图表</a><i></i></p>
                                                                    <ul class="contentbox">
                                                <li><a href="#128" data-title="&lt;b&gt;表1 域名特征说明&lt;/b&gt;"><b>表1 域名特征说明</b></a></li>
                                                <li><a href="#131" data-title="&lt;b&gt;图1 恶意域名检测系统总体架构&lt;/b&gt;"><b>图1 恶意域名检测系统总体架构</b></a></li>
                                                <li><a href="#136" data-title="&lt;b&gt;图2 特征数据提取过程&lt;/b&gt;"><b>图2 特征数据提取过程</b></a></li>
                                                <li><a href="#176" data-title="&lt;b&gt;图3 基于HMM的恶意域名检测算法流程&lt;/b&gt;"><b>图3 基于HMM的恶意域名检测算法流程</b></a></li>
                                                <li><a href="#198" data-title="&lt;b&gt;表2 原始参数下的模型分类结果&lt;/b&gt;"><b>表2 原始参数下的模型分类结果</b></a></li>
                                                <li><a href="#199" data-title="&lt;b&gt;图4 原始参数下的模型准确率与召回率&lt;/b&gt;"><b>图4 原始参数下的模型准确率与召回率</b></a></li>
                                                <li><a href="#203" data-title="&lt;b&gt;图5 调优参数下的模型准确率与召回率&lt;/b&gt;"><b>图5 调优参数下的模型准确率与召回率</b></a></li>
                                                <li><a href="#211" data-title="&lt;b&gt;图6 2种模型的分类准确率对比&lt;/b&gt;"><b>图6 2种模型的分类准确率对比</b></a></li>
                                                <li><a href="#212" data-title="&lt;b&gt;图7 2种模型的分类召回率对比&lt;/b&gt;"><b>图7 2种模型的分类召回率对比</b></a></li>
                                    </ul>
                            </dd>
                                    <dd class="guide">
                                        <h6>
                                            <p><a href="#a_bibliography">参考文献</a> </p>
                                        </h6>
                                    </dd>

            </dl>
        </div>
        <!--sidebar end-->
        &nbsp;
        <!--此处有一空格符 勿删-->
    </div>

                <div class="sidebar-b three-collumn" style="width:0;">
            <div class="refer" style="width: 0;">
                <div class="arrow off" title="参考文献"><span></span></div>
                <div class="js-scrollbox" >
                    
                    <div class="subbox active">
                        <h4>
                            <span class="tit">参考文献</span>
                            <a class="close" href="javascript:void(0)">x</a>
                        </h4>
                        <div class="side-scroller">
                            <ul class="refer-list">
                                <li id="3">


                                    <a id="bibliography_1" >
                                        <b>[1]</b>
                                     中国互联网络信息中心.第41次中国互联网络发展状况统计报告[R/OL].[2018-04-20].http://www.cac.gov.cn/2018-01/31/c_1122347026.htm.</a>
                                </li>
                                <li id="5">


                                    <a id="bibliography_2" title=" YAN Yida,LIU Zhenyan,ZHONG Junwei,et al.Malicious domain detection based on machine learning[EB/OL].[2018-04-25].http://dpi-proceedings.com/index.php/dtcse/article/view/19866." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Malicious domain detection based on machine learning">
                                        <b>[2]</b>
                                         YAN Yida,LIU Zhenyan,ZHONG Junwei,et al.Malicious domain detection based on machine learning[EB/OL].[2018-04-25].http://dpi-proceedings.com/index.php/dtcse/article/view/19866.
                                    </a>
                                </li>
                                <li id="7">


                                    <a id="bibliography_3" title=" SHI Yong,CHEN Gong,LI Juntao.Malicious domain name detection based on extreme machine learning[J].Neural Processing Letters,2018,48(3):1347-1357." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Malicious domain name detection based on extreme machine learning">
                                        <b>[3]</b>
                                         SHI Yong,CHEN Gong,LI Juntao.Malicious domain name detection based on extreme machine learning[J].Neural Processing Letters,2018,48(3):1347-1357.
                                    </a>
                                </li>
                                <li id="9">


                                    <a id="bibliography_4" title=" ALIEYAN K,ALMOMANI A,MANASRAH A,et al.A survey of botnet detection based on DNS[J].Neural Computing and Applications,2017,28(7):1-18." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=SSJD&amp;filename=SSJDCB1A3C57B3D457D749F995631A0AF04A&amp;v=MTEyNTdYcmtyeE5FZWNQaVJiN3VDT052RlNpV1dyN0pJRnBtYUJ1SFlmT0dRbGZDcGJRMzVOMWh3N3kveGFzPU5qN0Jhc0RLSDZEUDNJcENGdWg3Q0hrK3V4RVg0MGwwUQ==&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4rdTg2cEF4V2xrZkdSczJ5ODhxaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[4]</b>
                                         ALIEYAN K,ALMOMANI A,MANASRAH A,et al.A survey of botnet detection based on DNS[J].Neural Computing and Applications,2017,28(7):1-18.
                                    </a>
                                </li>
                                <li id="11">


                                    <a id="bibliography_5" title=" POMOROVA O,SAVENKO O,LYSENKO S,et al.A technique for the botnet detection based on DNS-traffic analysis[C]//Proceedings of International Conference on Computer Networks.Berlin,Germany:Springer,2015:127-138." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=A Technique for the Botnet Detection Based on DNS-Traffic Analysis">
                                        <b>[5]</b>
                                         POMOROVA O,SAVENKO O,LYSENKO S,et al.A technique for the botnet detection based on DNS-traffic analysis[C]//Proceedings of International Conference on Computer Networks.Berlin,Germany:Springer,2015:127-138.
                                    </a>
                                </li>
                                <li id="13">


                                    <a id="bibliography_6" title=" 马旸,强小辉,蔡冰,等.大规模网络中基于集成学习的恶意域名检测[J].计算机工程,2016,42(11):170-176." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JSJC201611029&amp;v=Mjk2NDk5Zk5ybzlIYllRS0RIODR2UjRUNmo1NE8zenFxQnRHRnJDVVJMT2VaZVJyRnkvaFU3ckxMejdCYmJHNEg=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4rdTg2cEF4V2xrZkdSczJ5ODhxaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[6]</b>
                                         马旸,强小辉,蔡冰,等.大规模网络中基于集成学习的恶意域名检测[J].计算机工程,2016,42(11):170-176.
                                    </a>
                                </li>
                                <li id="15">


                                    <a id="bibliography_7" title=" SINGH K,GUNTUKU S C,THAKUR A,et al.Big data analytics framework for peer-to-peer botnet detection using random forests[J].Information Sciences,2014,278(19):488-497." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=SJES&amp;filename=SJES14061600033911&amp;v=MTQwOTdYMDRvQk1UNlQ0UFFIL2lyUmRHZXJxUVRNbndaZVp1SHlqbVVMcklKMW9VYnhFPU5pZk9mYks4SHRmTnFZOUZaT2dNQg==&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4rdTg2cEF4V2xrZkdSczJ5ODhxaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[7]</b>
                                         SINGH K,GUNTUKU S C,THAKUR A,et al.Big data analytics framework for peer-to-peer botnet detection using random forests[J].Information Sciences,2014,278(19):488-497.
                                    </a>
                                </li>
                                <li id="17">


                                    <a id="bibliography_8" title=" ZAHARIA M,CHOWDHURY M,FRANKLIN M J,et al.Spark:cluster computing with working sets[C]//Proceedings of USENIX Conference on Hot Topics in Cloud Computing.San Diego,USA:USENIX Association,2010:2-10." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Spark:Cluster Computing With Working Sets">
                                        <b>[8]</b>
                                         ZAHARIA M,CHOWDHURY M,FRANKLIN M J,et al.Spark:cluster computing with working sets[C]//Proceedings of USENIX Conference on Hot Topics in Cloud Computing.San Diego,USA:USENIX Association,2010:2-10.
                                    </a>
                                </li>
                                <li id="19">


                                    <a id="bibliography_9" title=" MENG X,BRADLEY J,YAVUZ B,et al.MLlib:machine learning in Apache spark[J].Journal of Machine Learning Research,2016,17(1):1235-1241." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=MLlib:Machine learning in apache spark">
                                        <b>[9]</b>
                                         MENG X,BRADLEY J,YAVUZ B,et al.MLlib:machine learning in Apache spark[J].Journal of Machine Learning Research,2016,17(1):1235-1241.
                                    </a>
                                </li>
                                <li id="21">


                                    <a id="bibliography_10" title=" VERMA A,MANSURI A H,JAIN N.Big data manage-ment processing with Hadoop MapReduce and spark technology:a comparison[C]//Proceedings of 2016 Symposium on Colossal Data Analysis and Networking.Washington D.C.,USA:IEEE Press,2016:1-4." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Big data management processing with Hadoop MapReduce and spark technology:A comparison">
                                        <b>[10]</b>
                                         VERMA A,MANSURI A H,JAIN N.Big data manage-ment processing with Hadoop MapReduce and spark technology:a comparison[C]//Proceedings of 2016 Symposium on Colossal Data Analysis and Networking.Washington D.C.,USA:IEEE Press,2016:1-4.
                                    </a>
                                </li>
                                <li id="23">


                                    <a id="bibliography_11" title=" BAUM L E,PETRIE T,SOULES G,et al.A maximization technique occurring in the statistical analysis of probabilistic functions of Markov chains[J].Annals of Mathematical Statistics,1970,41(1):164-171." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=SJST&amp;filename=SJST14112600634565&amp;v=MjM2NTVJSjFvVWJ4RT1OaWZZZXJLOEg5RE9xWTlGWXVnTENYbzhvQk1UNlQ0UFFIL2lyUmRHZXJxUVRNbndaZVp1SHlqbVVMcg==&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4rdTg2cEF4V2xrZkdSczJ5ODhxaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[11]</b>
                                         BAUM L E,PETRIE T,SOULES G,et al.A maximization technique occurring in the statistical analysis of probabilistic functions of Markov chains[J].Annals of Mathematical Statistics,1970,41(1):164-171.
                                    </a>
                                </li>
                                <li id="25">


                                    <a id="bibliography_12" title=" 朱明,郭春生.隐马尔可夫模型及其最新应用与发展[J].计算机系统应用,2010,19(7):255-259,216." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=XTYY201007062&amp;v=MDg0MDc0SDlITXFJOURab1FLREg4NHZSNFQ2ajU0TzN6cXFCdEdGckNVUkxPZVplUnJGeS9oVTdyTFBUblNkN0c=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4rdTg2cEF4V2xrZkdSczJ5ODhxaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[12]</b>
                                         朱明,郭春生.隐马尔可夫模型及其最新应用与发展[J].计算机系统应用,2010,19(7):255-259,216.
                                    </a>
                                </li>
                                <li id="27">


                                    <a id="bibliography_13" title=" 苏文胜,王奉涛,朱泓,等.双树复小波域隐Markov树模型降噪及在机械故障诊断中的应用[J].振动与冲击,2011,30(6):47-52." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=ZDCJ201106013&amp;v=Mjg5NjJDVVJMT2VaZVJyRnkvaFU3ckxQeW5JWkxHNEg5RE1xWTlFWjRRS0RIODR2UjRUNmo1NE8zenFxQnRHRnI=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4rdTg2cEF4V2xrZkdSczJ5ODhxaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[13]</b>
                                         苏文胜,王奉涛,朱泓,等.双树复小波域隐Markov树模型降噪及在机械故障诊断中的应用[J].振动与冲击,2011,30(6):47-52.
                                    </a>
                                </li>
                                <li id="29">


                                    <a id="bibliography_14" title=" 李航.统计学习方法[M].北京:清华大学出版社,2012." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CBBD&amp;filename=9787302275954001&amp;v=MTM5ODY3bjN4RTlmYnZuS3JpZlp1OXVGQ3ZnVTdqTUlGc1hYRnF6R2JDNEhOUExxb1pBWU9zUERSTTh6eFVTbURkOVNI&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4rdTg2cEF4V2xrZkdSczJ5ODhxaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[14]</b>
                                         李航.统计学习方法[M].北京:清华大学出版社,2012.
                                    </a>
                                </li>
                                <li id="31">


                                    <a id="bibliography_15" title=" 杨安驹,杨云,周嫒嫒,等.基于隐马尔科夫模型的融合推荐算法[J].计算机与现代化,2015(9):60-65." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JYXH201509013&amp;v=MjE4NjdUNmo1NE8zenFxQnRHRnJDVVJMT2VaZVJyRnkvaFU3ckxMelRUWnJHNEg5VE1wbzlFWjRRS0RIODR2UjQ=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4rdTg2cEF4V2xrZkdSczJ5ODhxaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[15]</b>
                                         杨安驹,杨云,周嫒嫒,等.基于隐马尔科夫模型的融合推荐算法[J].计算机与现代化,2015(9):60-65.
                                    </a>
                                </li>
                                <li id="33">


                                    <a id="bibliography_16" title=" SMYTH P.Hidden Markov models and neural networks for fault detection in dynamic systems[C]//Proceedings of 1993 IEEE-SP Workshop on Neural Networks for Signal Processing.Washington D.C.,USA:IEEE Press,1993:582-592." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Hidden Markov models and neural networks for faultdetection in dynamic systems">
                                        <b>[16]</b>
                                         SMYTH P.Hidden Markov models and neural networks for fault detection in dynamic systems[C]//Proceedings of 1993 IEEE-SP Workshop on Neural Networks for Signal Processing.Washington D.C.,USA:IEEE Press,1993:582-592.
                                    </a>
                                </li>
                                <li id="35">


                                    <a id="bibliography_17" title=" VITERBI A J.A personal history of the Viterbi algorithm[J].IEEE Signal Processing Magazine,2006,23(4):120-142." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=A personal history of the Viterbi algorithm">
                                        <b>[17]</b>
                                         VITERBI A J.A personal history of the Viterbi algorithm[J].IEEE Signal Processing Magazine,2006,23(4):120-142.
                                    </a>
                                </li>
                                <li id="37">


                                    <a id="bibliography_18" title=" JR G D F.The Viterbi algorithm[J].Proceedings of the IEEE,1973,61(3):268-278." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=The viterbi algorithm">
                                        <b>[18]</b>
                                         JR G D F.The Viterbi algorithm[J].Proceedings of the IEEE,1973,61(3):268-278.
                                    </a>
                                </li>
                                <li id="39">


                                    <a id="bibliography_19" title=" WELCH L R.Hidden Markov models and the Baum-Welch algorithm[J].IEEE Information Theory Society News Letter,2003,53(2):194-211." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Hidden Markov models and the Baum-Welch algorithm">
                                        <b>[19]</b>
                                         WELCH L R.Hidden Markov models and the Baum-Welch algorithm[J].IEEE Information Theory Society News Letter,2003,53(2):194-211.
                                    </a>
                                </li>
                                <li id="41">


                                    <a id="bibliography_20" title=" 张峻飞.Hadoop环境下的恶意域名检测方案研究[D].武汉:华中科技大学,2015." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CMFD&amp;filename=1015909384.nh&amp;v=MTMyODI4NHZSNFQ2ajU0TzN6cXFCdEdGckNVUkxPZVplUnJGeS9oVTdyTFZGMjZHN3E0RjlMRXE1RWJQSVFLREg=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4rdTg2cEF4V2xrZkdSczJ5ODhxaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[20]</b>
                                         张峻飞.Hadoop环境下的恶意域名检测方案研究[D].武汉:华中科技大学,2015.
                                    </a>
                                </li>
                                <li id="43">


                                    <a id="bibliography_21" title=" 赵成龙.一种检测恶意域名的增量并行SVM算法研究与实现[D].武汉:华中科技大学,2016." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CMFD&amp;filename=1016744958.nh&amp;v=MDM1NzlHRnJDVVJMT2VaZVJyRnkvaFU3ckxWRjI2R0xTOEd0akpwNUViUElRS0RIODR2UjRUNmo1NE8zenFxQnQ=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4rdTg2cEF4V2xrZkdSczJ5ODhxaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[21]</b>
                                         赵成龙.一种检测恶意域名的增量并行SVM算法研究与实现[D].武汉:华中科技大学,2016.
                                    </a>
                                </li>
                                <li id="45">


                                    <a id="bibliography_22" title=" MOLENBERGHS G,KENWARD M G.The expectation-maximization algorithm[M]//MOLENBERGHS G,KENWARD M G.Missing data in clinical studies.[S.l.]:Wiley-Blackwell,2007." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=The Expectation-Maximization Algorithm">
                                        <b>[22]</b>
                                         MOLENBERGHS G,KENWARD M G.The expectation-maximization algorithm[M]//MOLENBERGHS G,KENWARD M G.Missing data in clinical studies.[S.l.]:Wiley-Blackwell,2007.
                                    </a>
                                </li>
                                <li id="47">


                                    <a id="bibliography_23" title=" 夏丽莎.基于隐马尔可夫模型的故障诊断及相关算法研究[D].武汉:华中科技大学,2014." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CDFD&amp;filename=1014268606.nh&amp;v=MjgwMDZPZVplUnJGeS9oVTdyTFZGMjZHckcrRnRmTXFaRWJQSVFLREg4NHZSNFQ2ajU0TzN6cXFCdEdGckNVUkw=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4rdTg2cEF4V2xrZkdSczJ5ODhxaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[23]</b>
                                         夏丽莎.基于隐马尔可夫模型的故障诊断及相关算法研究[D].武汉:华中科技大学,2014.
                                    </a>
                                </li>
                                <li id="49">


                                    <a id="bibliography_24" title=" KANUNGO T,MOUNT D M,NETANYAHU N S,et al.An efficient k-means clustering algorithm:analysis and implementation[J].IEEE Transactions on Pattern Analysis and Machine Intelligence,2002,24(7):881-892." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=An efficient k-menas clustering algorithm: analysis and implementation">
                                        <b>[24]</b>
                                         KANUNGO T,MOUNT D M,NETANYAHU N S,et al.An efficient k-means clustering algorithm:analysis and implementation[J].IEEE Transactions on Pattern Analysis and Machine Intelligence,2002,24(7):881-892.
                                    </a>
                                </li>
                            </ul>
                            <div style='display: none;' class="zqscroller" >
                                <h4 class="">附加材料</h4>
                                <ul></ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            &nbsp;
            <!--此处有一空格符 勿删-->
        </div>

        
    <div class="content">



        <!--tips start-->
                            <div class="tips">
                    <a href="http://navi.cnki.net/KNavi/JournalDetail?pcode=CJFD&amp;pykm=JSJC" target="_blank">计算机工程</a>
                2019,45(09),161-168 DOI:10.19678/j.issn.1000-3428.0051486            </div>
        <!--tips end-->
            <div class="top-title">
                <h1 class="title">
                    <span class="vm"><b>隐马尔可夫模型在恶意域名检测中的应用</b></span>
 <span class="shoufa"></span>                                     </h1>

            </div>
                        <h2>
                                <a href="javascript:;">白玲玲</a>
                                <a href="javascript:;">宁振虎</a>
                                <a href="javascript:;">薛菲</a>
                                <a href="javascript:;">杨永丽</a>
                </h2>
                    <h2>

                    <span>北京工业大学信息学部</span>
                    <span>北京物资学院信息学院</span>
            </h2>

        
<div class="link">
    <a id="aexport" class="icon icon-output"  onclick="" href="javascript:void(0);"><i></i>导出/参考文献</a>
    
    <span class="shareBoard" onmouseover="$('#sharedet').show();$('#this').addClass('shareBoardCUR')" onmouseout="$('#sharedet').hide();$('#this').removeClass('shareBoardCUR')">
        <a class="icon icon-share" href="#"><i></i>分享<em></em></a>
        <ul class="shareHide" id="sharedet" style="display: none;">
            <li><a title="复制链接" class="copy" onclick="" href="#"><i></i>复制链接</a></li>
            <li><a title="分享到新浪微博" class="xl" onclick="" href="javascript:common.ShareAction('xl');"><i></i>新浪微博</a></li>
            <li>
                <a title="分享到微信" class="wx" onclick="" href="#"><i></i>微信扫一扫</a>
                <div class="qrcode"><img src='' alt='' /></div>
            </li>
        </ul>

    </span>
    
    <a id="RefTrack" title="创建引文跟踪" class="icon icon-track" onclick="" href="javascript:void(0);"> <i></i>创建引文跟踪 </a>
    <a id="ashoucang" title="收藏" class="icon icon-favor" onclick="" href="javascript:void(0);"><i></i>收藏</a>
    <a class="icon icon-print" onclick="window.print();" href="javascript:void(0);"><i></i>打印</a>
    
    <!--版本切换 end-->
</div>
                            <div class="data" id="a_abstract">
                <span class="keys">摘<span style="font-family: 'Times New Roman';">&nbsp;&nbsp;&nbsp;&nbsp;</span>要：</span>
                <p>提出一种基于隐马尔可夫模型(HMM)的恶意域名检测方法。分析善恶域名在DNS通信中的各类特征,利用Spark大数据处理平台的高效计算能力对属性特征进行统计,在此基础上,通过HMM中的Baum-Welch算法和Viterbi算法对恶意域名进行准确分类。实验结果表明,与随机森林模型相比,HMM对恶意域名分类的准确率与召回率均较高。</p>
            </div>
                    <div class="data" id="a_keywords">
                <span class="keys">关键词：</span>
                <p>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=%E6%81%B6%E6%84%8F%E5%9F%9F%E5%90%8D&amp;code=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4rdTg2cEF4V2xrZkdSczJ5ODhxaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">恶意域名;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=%E9%9A%90%E9%A9%AC%E5%B0%94%E5%8F%AF%E5%A4%AB%E6%A8%A1%E5%9E%8B&amp;code=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4rdTg2cEF4V2xrZkdSczJ5ODhxaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">隐马尔可夫模型;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=Baum-Welch%E7%AE%97%E6%B3%95&amp;code=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4rdTg2cEF4V2xrZkdSczJ5ODhxaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">Baum-Welch算法;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=Viterbi%E7%AE%97%E6%B3%95&amp;code=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4rdTg2cEF4V2xrZkdSczJ5ODhxaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">Viterbi算法;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=Spark%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86%E5%B9%B3%E5%8F%B0&amp;code=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4rdTg2cEF4V2xrZkdSczJ5ODhxaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">Spark大数据处理平台;</a>
                </p>
            </div>
        
        <!--brief start-->
        
            <div class="brief">
                    <p>
                            <b>作者简介：</b>
                                                        <span>
                                    白玲玲(1991—),女,硕士研究生,主研方向为信息安全;;
                                </span>
                                <span>
                                    *宁振虎(通信作者),讲师、博士;E-mail:nzh41034@ 163. com;
                                </span>
                                <span>
                                    薛菲,讲师、博士;;
                                </span>
                                <span>
                                    杨永丽,硕士研究生。;
                                </span>
                    </p>
                                    <p><b>收稿日期：</b>2018-05-08</p>

                    <p>

                            <b>基金：</b>
                                                        <span>北京市博士后工作经费项目(2017-22-030);</span>
                                <span>CCF-启明星辰“鸿雁”科研计划(CCF-VenustechRP2017008);</span>
                    </p>
            </div>
                    <h1><b>Application of Hidden Markov Model in Malicious Domain Name Detection</b></h1>
                    <h2>
                    <span>BAI Lingling</span>
                    <span>NING Zhenhu</span>
                    <span>XUE Fei</span>
                    <span>YANG Yongli</span>
            </h2>
                    <h2>
                    <span>Faculty of Information Technology,Beijing University of Technology</span>
                    <span>School of Information,Beijing Wuzi University</span>
            </h2>
                            <div class="data" id="a_abstractEN">
                <span class="keys">Abstract：</span>
                <p>A malicious domain name detection method based on Hidden Markov Model(HMM) is proposed.The characteristics of good and evil domain name in DNS communication are analyzed,and the attribute characteristics are counted by using the efficient computing power of Spark big data processing platform.On this basis,malicious domain name are accurately classified by Baum-Welch algorithm and Viterbi algorithm in HMM.Experimental results show that compared with the Random Forest(RF) model,the accuracy and recall rate of HMM for malicious domain name classification are both higher.</p>
            </div>
                    <div class="data" id="a_keywordsEN">
                <span class="keys">Keyword：</span>
                <p>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=malicious%20domain%20name&amp;code=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4rdTg2cEF4V2xrZkdSczJ5ODhxaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">malicious domain name;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=Hidden%20Markov%20Model%20(HMM)&amp;code=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4rdTg2cEF4V2xrZkdSczJ5ODhxaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">Hidden Markov Model (HMM);</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=Baum-Welch%20algorithm&amp;code=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4rdTg2cEF4V2xrZkdSczJ5ODhxaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">Baum-Welch algorithm;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=Viterbi%20algorithm&amp;code=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4rdTg2cEF4V2xrZkdSczJ5ODhxaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">Viterbi algorithm;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=Spark%20big%20data%20processing%20platform&amp;code=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4rdTg2cEF4V2xrZkdSczJ5ODhxaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">Spark big data processing platform;</a>
                </p>
            </div>
                    <div class="brief">
                
                    <p>
                                            </p>
                                    <p><b>Received：</b> 2018-05-08</p>
                                    <p>
                                            </p>
            </div>


        <!--brief start-->
                        <h3 id="51" name="51" class="anchor-tag">0 概述</h3>
                <div class="p1">
                    <p id="52">当前,以信息技术为代表的新一轮科技与产业革命正在兴起,随着互联网模式的不断创新以及线上线下服务融合的快速发展,截止2017年12月,我国网民规模达7.72亿,普及率为55.8%,并继续保持平稳增长趋势。与此同时,以网络钓鱼和僵尸网络为代表的恶意域名攻击以灵活多变的形式不断出现,中国互联网络信息中心(CNNIC)对各行业域名安全状况进行分析,结果表明,我国80%以上的域名解析服务存在安全风险。随着全球域名体系注册量、查询量以及系统部署规模的持续增长,针对域名系统的DDOS攻击规模和攻击技术复杂度也在显著提升<citation id="218" type="reference"><link href="3" rel="bibliography" /><sup>[<a class="sup">1</a>]</sup></citation>。因此,对域名安全检测方面进行研究成为信息安全领域广泛关注的热点之一。</p>
                </div>
                <div class="p1">
                    <p id="53">近年来,已有较多学者通过机器学习方法对恶意域名进行有效检测,主要包括支持向量机(Support Vector Machine,SVM)、随机森林(Random Forest,RF)和聚类等方法<citation id="219" type="reference"><link href="5" rel="bibliography" /><sup>[<a class="sup">2</a>]</sup></citation>。机器学习可通过分析善恶域名在网络行为特性与自身特性方面存在的差异,利用各种高效算法来实现域名分类<citation id="222" type="reference"><link href="7" rel="bibliography" /><link href="9" rel="bibliography" /><link href="11" rel="bibliography" /><sup>[<a class="sup">3</a>,<a class="sup">4</a>,<a class="sup">5</a>]</sup></citation>。但是,随着当今信息量和访问量的快速增长,域名在DNS通信中的日志记录量也在持续提升,需要通过大数据的高效统计分析技术来提升海量通信记录的分析速度,这将导致传统检测算法在数据计算与响应速度2个方面受到极大限制<citation id="220" type="reference"><link href="13" rel="bibliography" /><sup>[<a class="sup">6</a>]</sup></citation>。此外,在利用机器学习检测恶意域名时,分类模型大都选择RF分类器,尽管RF分类器不易发生过拟合现象,且在每次划分时只考虑很少的属性,速度比Bagging和Boosting分类器更快,但其难以处理某些噪声较大的分类和回归问题。同时,根据实际需要对多个不同级别的属性进行划分时,会使RF模型的建模结果产生较大的误差,导致属性权值不具有可信度<citation id="221" type="reference"><link href="15" rel="bibliography" /><sup>[<a class="sup">7</a>]</sup></citation>。</p>
                </div>
                <div class="p1">
                    <p id="54">恶意域名通常通过域名解析系统来实现攻击,因此,当黑客们通过恶意域名进行破坏活动时,相应的善恶域名数据及其特征行为模式会被记录到DNS服务器的日志中。本文通过分析DNS服务器中海量的域名日志解析记录及其相应特征,利用隐马尔可夫模型(Hidden Markov Model,HMM)及Spark大数据处理平台<citation id="223" type="reference"><link href="17" rel="bibliography" /><link href="19" rel="bibliography" /><link href="21" rel="bibliography" /><sup>[<a class="sup">8</a>,<a class="sup">9</a>,<a class="sup">10</a>]</sup></citation>,结合域名的自身特性、时间性(包括TTL平均值、域名生存期等)、对应IP的特征以及相关域名集,得到恶意域名特定的行为方式,在此基础上,对其进行检测与分类。</p>
                </div>
                <h3 id="55" name="55" class="anchor-tag">1 相关工作</h3>
                <div class="p1">
                    <p id="56">HMM在语音识别、机器学习等领域得到广泛应用<citation id="224" type="reference"><link href="23" rel="bibliography" /><sup>[<a class="sup">11</a>]</sup></citation>,其是马尔可夫模型的延伸与扩展。HMM在任一时刻的状态不可见,观察者无法通过一个状态序列推测转移概率等相关参数,但可通过HMM在每个时刻的观测值来对隐含状态进行预测,且该时刻的观测值仅与其隐含状态有关<citation id="225" type="reference"><link href="25" rel="bibliography" /><link href="27" rel="bibliography" /><link href="29" rel="bibliography" /><sup>[<a class="sup">12</a>,<a class="sup">13</a>,<a class="sup">14</a>]</sup></citation>。</p>
                </div>
                <h4 class="anchor-tag" id="57" name="57">1.1 隐马尔可夫模型概述</h4>
                <div class="p1">
                    <p id="58">在通常情况下,HMM的形式可表示为<citation id="226" type="reference"><link href="31" rel="bibliography" /><sup>[<a class="sup">15</a>]</sup></citation>:</p>
                </div>
                <div class="p1">
                    <p id="59"><i>λ</i>=(<i>π</i>,<i><b>A</b></i>,<i>B</i>)</p>
                </div>
                <div class="p1">
                    <p id="60">各元素定义为:</p>
                </div>
                <div class="p1">
                    <p id="61">1)<i>π</i>表示初始状态的概率分布,<i>π</i>={<i>π</i><sub>1</sub>,<i>π</i><sub>2</sub>,…,<i>π</i><sub><i>N</i></sub>},<i>π</i><sub><i>i</i></sub>=<i>P</i>(<i>Q</i><sub>1</sub>=<i>S</i><sub><i>i</i></sub>)(1≤<i>i</i>≤<i>N</i>)表示模型在初始状态<i>Q</i><sub>1</sub>时取<i>S</i><sub><i>i</i></sub>状态的概率。</p>
                </div>
                <div class="p1">
                    <p id="62">2)<i><b>A</b></i>表示状态之间的转移矩阵,<i><b>A</b></i>=[<i>a</i><sub><i>ij</i></sub>]<sub><i>N</i></sub>×<i>N</i>,<i>a</i><sub><i>ij</i></sub>=<i>P</i>(<i>Q</i><sub><i>t</i></sub>+1=<i>S</i><sub><i>j</i></sub>|<i>Q</i><sub><i>t</i></sub>=<i>S</i><sub><i>i</i></sub>)(1≤<i>i</i>,<i>j</i>≤<i>N</i>)表示在时刻<i>t</i>、状态<i>S</i><sub><i>i</i></sub>的条件下时刻<i>t</i>+1转移到状态<i>S</i><sub><i>j</i></sub>的概率。</p>
                </div>
                <div class="p1">
                    <p id="63">3)<i><b>B</b></i>表示观测概率矩阵,<i><b>B</b></i>=[<i>b</i><sub><i>jk</i></sub>]<sub><i>M</i></sub>×<i>N</i>,<i>b</i><sub><i>jk</i></sub>=<i>P</i>(<i>O</i><sub><i>t</i></sub>=<i>V</i><sub><i>k</i></sub>|<i>Q</i><sub><i>t</i></sub>=<i>S</i><sub><i>j</i></sub>)(1≤<i>j</i>≤<i>N</i>,1≤<i>k</i>≤<i>M</i>)表示在状态<i>S</i><sub><i>j</i></sub>出现时观测值<i>V</i><sub><i>k</i></sub>的概率。</p>
                </div>
                <div class="p1">
                    <p id="64">在HMM中,初始概率和状态转移概率决定状态序列,观测概率矩阵决定模型的观测序列,因此,HMM可简记为<i>λ</i>=(<i>π</i>,<i><b>A</b></i>,<i>B</i>)。</p>
                </div>
                <h4 class="anchor-tag" id="65" name="65">1.2 隐马尔可夫模型中的基本问题</h4>
                <div class="p1">
                    <p id="66">HMM涉及3个基本问题<citation id="227" type="reference"><link href="31" rel="bibliography" /><sup>[<a class="sup">15</a>]</sup></citation>:</p>
                </div>
                <div class="p1">
                    <p id="67">1)评估问题:已知观测序列<i>O</i>={<i>O</i><sub>1</sub>,<i>O</i><sub>2</sub>,…,<i>O</i><sub><i>T</i></sub>}及模型<i>λ</i>=(<i>π</i>,<i><b>A</b></i>,<i>B</i>),计算<i>P</i>(<i>O</i>|<i>λ</i>),即给定一个模型的观测序列,计算某个特定的输出序列的概率。解决评估问题主要采用前向算法和后向算法。</p>
                </div>
                <div class="p1">
                    <p id="68">(1)前向算法</p>
                </div>
                <div class="p1">
                    <p id="69"><b>输入</b> HMM模型<i>λ</i>,观测序列<i>O</i></p>
                </div>
                <div class="p1">
                    <p id="70"><b>输出</b> 观测序列概率<i>P</i>(<i>O</i>|<i>λ</i>)</p>
                </div>
                <div class="p1">
                    <p id="71">1.初始化</p>
                </div>
                <div class="p1">
                    <p id="72">α<sub>1</sub>(i)=π<sub>i</sub>b<sub>i</sub>(o<sub>1</sub>),i=1,2,…,N</p>
                </div>
                <div class="p1">
                    <p id="73">2.对t=1,2,…,T-1,有:</p>
                </div>
                <div class="p1">
                    <p id="74" class="code-formula">
                        <mathml id="74"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mtext>α</mtext><msub><mrow></mrow><mrow><mtext>t</mtext><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy="false">(</mo><mtext>i</mtext><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">[</mo><mstyle displaystyle="true"><munderover><mo>∑</mo><mrow><mtext>j</mtext><mo>=</mo><mn>1</mn></mrow><mtext>Ν</mtext></munderover><mtext>α</mtext></mstyle><msub><mrow></mrow><mtext>t</mtext></msub><mo stretchy="false">(</mo><mtext>j</mtext><mo stretchy="false">)</mo><mtext>α</mtext><msub><mrow></mrow><mrow><mtext>j</mtext><mtext>i</mtext></mrow></msub><mo stretchy="false">]</mo><mtext>b</mtext><msub><mrow></mrow><mtext>i</mtext></msub><mo stretchy="false">(</mo><mtext>o</mtext><msub><mrow></mrow><mrow><mtext>t</mtext><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo><mo>,</mo><mtext>i</mtext><mo>=</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mo>⋯</mo><mo>,</mo><mtext>Ν</mtext></mrow></math></mathml>
                    </p>
                </div>
                <div class="p1">
                    <p id="75">3.终止</p>
                </div>
                <div class="p1">
                    <p id="76" class="code-formula">
                        <mathml id="76"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mtext>Ρ</mtext><mo stretchy="false">(</mo><mtext>Ο</mtext><mo stretchy="false">|</mo><mtext>λ</mtext><mo stretchy="false">)</mo><mo>=</mo><mstyle displaystyle="true"><munderover><mo>∑</mo><mrow><mtext>i</mtext><mo>=</mo><mn>1</mn></mrow><mtext>Ν</mtext></munderover><mtext>α</mtext></mstyle><msub><mrow></mrow><mtext>Τ</mtext></msub><mo stretchy="false">(</mo><mtext>i</mtext><mo stretchy="false">)</mo></mrow></math></mathml>
                    </p>
                </div>
                <div class="p1">
                    <p id="77">前向算法的步骤1初始化前向概率,包括初始时刻的状态<i>i</i><sub>1</sub>=<i>q</i><sub><i>i</i></sub>和观测<i>o</i><sub>1</sub>的联合概率;步骤2是前向概率的递推公式,计算到<i>t</i>+1时刻观测序列为<i>o</i><sub>1</sub>,<i>o</i><sub>2</sub>,…,<i>o</i><sub><i>t</i></sub>,<i>o</i><sub><i>t</i></sub>+1且在<i>t</i>+1时刻模型处于状态<i>q</i><sub><i>i</i></sub>的前向概率;步骤3给出<i>P</i>(<i>O</i>|<i>λ</i>)的计算公式。</p>
                </div>
                <div class="p1">
                    <p id="78">(2)后向算法</p>
                </div>
                <div class="p1">
                    <p id="79"><b>输入</b> HMM模型<i>λ</i>,观测序列<i>O</i></p>
                </div>
                <div class="p1">
                    <p id="80"><b>输出</b> 观测序列概率<i>P</i>(<i>O</i>|<i>λ</i>)</p>
                </div>
                <div class="p1">
                    <p id="81">1.β<sub>t</sub>(i)=1,i=1,2,…,N</p>
                </div>
                <div class="p1">
                    <p id="82">2.对t=T-1,T-2,…,1,有:</p>
                </div>
                <div class="p1">
                    <p id="83" class="code-formula">
                        <mathml id="83"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtable columnalign="left"><mtr><mtd><mtext>β</mtext><msub><mrow></mrow><mtext>t</mtext></msub><mo stretchy="false">(</mo><mtext>i</mtext><mo stretchy="false">)</mo><mo>=</mo><mstyle displaystyle="true"><munderover><mo>∑</mo><mrow><mtext>j</mtext><mo>=</mo><mn>1</mn></mrow><mtext>Ν</mtext></munderover><mtext>α</mtext></mstyle><msub><mrow></mrow><mrow><mtext>i</mtext><mtext>j</mtext></mrow></msub><mtext>b</mtext><msub><mrow></mrow><mtext>j</mtext></msub><mo stretchy="false">(</mo><mtext>o</mtext><msub><mrow></mrow><mrow><mtext>t</mtext><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo><mtext>β</mtext><msub><mrow></mrow><mrow><mtext>t</mtext><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy="false">(</mo><mtext>j</mtext><mo stretchy="false">)</mo><mo>,</mo><mtext>i</mtext><mo>=</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mo>⋯</mo><mo>,</mo><mtext>Ν</mtext></mtd></mtr><mtr><mtd><mspace width="0.25em" /><mn>3</mn><mo>.</mo><mtext>Ρ</mtext><mo stretchy="false">(</mo><mtext>Ο</mtext><mo stretchy="false">|</mo><mtext>λ</mtext><mo stretchy="false">)</mo><mo>=</mo><mstyle displaystyle="true"><munderover><mo>∑</mo><mrow><mtext>i</mtext><mo>=</mo><mn>1</mn></mrow><mtext>Ν</mtext></munderover><mtext>π</mtext></mstyle><msub><mrow></mrow><mtext>i</mtext></msub><mtext>b</mtext><msub><mrow></mrow><mtext>i</mtext></msub><mo stretchy="false">(</mo><mtext>o</mtext><msub><mrow></mrow><mn>1</mn></msub><mo stretchy="false">)</mo><mtext>β</mtext><msub><mrow></mrow><mn>1</mn></msub><mo stretchy="false">(</mo><mtext>i</mtext><mo stretchy="false">)</mo></mtd></mtr></mtable></math></mathml>
                    </p>
                </div>
                <div class="p1">
                    <p id="84">步骤1初始化后向概率,即对模型最终时刻的所有状态<i>q</i><sub><i>i</i></sub>规定<i>β</i><sub><i>T</i></sub>(<i>i</i>)=1;步骤2对后向概率的计算公式进行递推,即在<i>t</i>时刻状态<i>q</i><sub><i>i</i></sub>条件下计算<i>t</i>+1之后模型观测序列为<i>o</i><sub><i>t</i></sub>+1,<i>o</i><sub><i>t</i></sub>+2,…,<i>o</i><sub><i>T</i></sub>的后向概率<i>β</i><sub><i>t</i></sub>(<i>i</i>),只需计算<i>t</i>+1时刻所有可能的<i>N</i>个状态<i>q</i><sub><i>j</i></sub>的转移概率和在此状态下的<i>o</i><sub><i>t</i></sub>+1的概率,再考虑状态<i>q</i><sub><i>j</i></sub>之后的观测序列的后向概率;步骤3求<i>P</i>(<i>O</i>|<i>λ</i>),其思路与步骤2一致,只是用初始概率<i>π</i><sub><i>i</i></sub>代替转移概率。</p>
                </div>
                <div class="p1">
                    <p id="85">2)解码问题,即在给定观测序列<i>O</i>={<i>O</i><sub>1</sub>,<i>O</i><sub>2</sub>,…,<i>O</i><sub><i>T</i></sub>}和模型<i>λ</i>=(<i>π</i>,<i><b>A</b></i>,<i>B</i>)的情况下,选择一个对应的状态<i>S</i>={<i>S</i><sub>1</sub>,<i>S</i><sub>2</sub>,…,<i>S</i><sub><i>N</i></sub>},使得由<i>S</i>生成观测序列<i>O</i>的概率最大。</p>
                </div>
                <div class="p1">
                    <p id="86">概率统计模型中最常用的标准是最大似然标准,即在给定模型和某个特定输出序列的情况下,选择概率最大的一个输出序列,此时常用算法为Viterbi算法,其是应用较广的动态规划算法<citation id="228" type="reference"><link href="33" rel="bibliography" /><link href="35" rel="bibliography" /><sup>[<a class="sup">16</a>,<a class="sup">17</a>]</sup></citation>,可利用动态规划的特性来求解相关概率的最大路径问题。其中,一条路径对应模型中的一个状态序列。Viterbi算法的思路为:从<i>t</i>=1时刻开始,不断向后递推,每次递推下一步时保留前一步所有选择的最大概率,在递推完成之后,利用回溯法从终点逐步倒退到起始点,即可得到所求模型的最佳状态路径。Viterbi算法描述如下:</p>
                </div>
                <div class="p1">
                    <p id="87"><b>输入</b> 模型参数<i>λ</i>=(<i>π</i>,<i><b>A</b></i>,<i>B</i>),观测序列<i>O</i>=(<i>o</i><sub>1</sub>,<i>o</i><sub>2</sub>,…,<i>o</i><sub><i>T</i></sub>)</p>
                </div>
                <div class="p1">
                    <p id="88"><b>输出</b> 最优隐状态路径<i>I</i><sup>*</sup>=(<i>i</i><sup>*</sup><sub>1</sub>,<i>i</i><sup>*</sup><sub>2</sub>,…,<i>i</i><sup>*</sup><sub><i>T</i></sub>)</p>
                </div>
                <div class="p1">
                    <p id="89">1.初始化</p>
                </div>
                <div class="p1">
                    <p id="90">δ<sub>1</sub>(i)=π<sub>i</sub>b<sub>i</sub>(o<sub>1</sub>),i=1,2,…,N</p>
                </div>
                <div class="p1">
                    <p id="91">ψ<sub>1</sub>(i)=0,i=1,2,…,N</p>
                </div>
                <div class="p1">
                    <p id="92">2.递推</p>
                </div>
                <div class="p1">
                    <p id="93">对t=2,3,…,T:</p>
                </div>
                <div class="p1">
                    <p id="94"><mathml id="216"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mtext>δ</mtext><msub><mrow></mrow><mtext>t</mtext></msub><mo stretchy="false">(</mo><mtext>i</mtext><mo stretchy="false">)</mo><mo>=</mo><munder><mstyle mathsize="140%" displaystyle="true"><mrow><mi>max</mi></mrow></mstyle><mrow><mn>1</mn><mo>≤</mo><mtext>j</mtext><mo>≤</mo><mtext>Ν</mtext></mrow></munder><mo stretchy="false">[</mo><mtext>δ</mtext><msub><mrow></mrow><mrow><mtext>t</mtext><mo>-</mo><mn>1</mn></mrow></msub><mo stretchy="false">(</mo><mtext>j</mtext><mo stretchy="false">)</mo><mtext>a</mtext><msub><mrow></mrow><mrow><mtext>j</mtext><mtext>i</mtext></mrow></msub><mo stretchy="false">]</mo><mtext>b</mtext><msub><mrow></mrow><mtext>i</mtext></msub><mo stretchy="false">(</mo><mtext>o</mtext><msub><mrow></mrow><mtext>t</mtext></msub><mo stretchy="false">)</mo><mo>,</mo><mtext>i</mtext><mo>=</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mo>⋯</mo><mo>,</mo><mtext>Ν</mtext><mo>/</mo><mo>/</mo></mrow></math></mathml>记录从初//始时刻递推到时刻t时,概率最大路径(即最优路径)经过//的所有节点的联合概率</p>
                </div>
                <div class="p1">
                    <p id="97"><mathml id="217"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mtext>ψ</mtext><msub><mrow></mrow><mtext>t</mtext></msub><mo stretchy="false">(</mo><mtext>i</mtext><mo stretchy="false">)</mo><mo>=</mo><munder><mstyle mathsize="140%" displaystyle="true"><mrow><mtext>a</mtext><mtext>r</mtext><mtext>g</mtext><mtext>m</mtext><mtext>a</mtext><mtext>x</mtext></mrow></mstyle><mrow><mn>1</mn><mo>≤</mo><mtext>j</mtext><mo>≤</mo><mtext>Ν</mtext></mrow></munder><mo stretchy="false">[</mo><mtext>δ</mtext><msub><mrow></mrow><mrow><mtext>t</mtext><mo>-</mo><mn>1</mn></mrow></msub><mo stretchy="false">(</mo><mtext>j</mtext><mo stretchy="false">)</mo><mtext>a</mtext><msub><mrow></mrow><mrow><mtext>j</mtext><mtext>i</mtext></mrow></msub><mo stretchy="false">]</mo><mo>,</mo><mtext>i</mtext><mo>=</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mo>⋯</mo><mo>,</mo><mtext>Ν</mtext><mo>/</mo><mo>/</mo></mrow></math></mathml>记录最终到//达的t时刻的隐状态</p>
                </div>
                <div class="p1">
                    <p id="99">3.终止</p>
                </div>
                <div class="p1">
                    <p id="100" class="code-formula">
                        <mathml id="100"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtable columnalign="left"><mtr><mtd><mtext>Ρ</mtext><msup><mrow></mrow><mo>*</mo></msup><mo>=</mo><munder><mstyle mathsize="140%" displaystyle="true"><mrow><mi>max</mi></mrow></mstyle><mrow><mn>1</mn><mo>≤</mo><mtext>i</mtext><mo>≤</mo><mtext>Ν</mtext></mrow></munder><mo stretchy="false">[</mo><mtext>δ</mtext><msub><mrow></mrow><mtext>Τ</mtext></msub><mo stretchy="false">(</mo><mtext>i</mtext><mo stretchy="false">)</mo><mo stretchy="false">]</mo></mtd></mtr><mtr><mtd><mtext>i</mtext><msubsup><mrow></mrow><mtext>Τ</mtext><mo>*</mo></msubsup><mo>=</mo><munder><mstyle mathsize="140%" displaystyle="true"><mrow><mtext>a</mtext><mtext>r</mtext><mtext>g</mtext><mtext>m</mtext><mtext>a</mtext><mtext>x</mtext></mrow></mstyle><mrow><mn>1</mn><mo>≤</mo><mtext>j</mtext><mo>≤</mo><mtext>Ν</mtext></mrow></munder><mo stretchy="false">[</mo><mtext>δ</mtext><msub><mrow></mrow><mtext>Τ</mtext></msub><mo stretchy="false">(</mo><mtext>i</mtext><mo stretchy="false">)</mo><mo stretchy="false">]</mo></mtd></mtr></mtable></math></mathml>
                    </p>
                </div>
                <div class="p1">
                    <p id="101">4.回溯最优路径</p>
                </div>
                <div class="p1">
                    <p id="102">对t= T-1,T-2,…,1:</p>
                </div>
                <div class="p1">
                    <p id="103">i<sup>*</sup><sub>t</sub>=ψ<sub>t+1</sub>(i<sup>*</sup><sub>t+1</sub>)</p>
                </div>
                <div class="p1">
                    <p id="104">求得最优路径I<sup>*</sup>=(i<sup>*</sup><sub>1</sub>,i<sup>*</sup><sub>2</sub>,…,i<sup>*</sup><sub>T</sub>)</p>
                </div>
                <div class="p1">
                    <p id="105">3)学习问题。对给定的观测序列<i>O</i>={<i>O</i><sub>1</sub>,<i>O</i><sub>2</sub>,…,<i>O</i><sub><i>T</i></sub>},估计HMM模型的参数<i>λ</i>=(<i>π</i>,<i><b>A</b></i>,<i>B</i>),使得<i>P</i>(<i>O</i>|<i>λ</i>)最大。该问题通过不断地输入观测序列,应用迭代法对模型参数进行调整与改进,继而使模型达到期望效果,常用算法为Baum-Welch算法。Baum-Welch是典型无监督学习HMM的方法,其利用期望极大(Expectation Maximization,EM)算法思想<citation id="229" type="reference"><link href="37" rel="bibliography" /><link href="39" rel="bibliography" /><sup>[<a class="sup">18</a>,<a class="sup">19</a>]</sup></citation>,通过反复迭代达到局部极大值,最后得出HMM的估计参数<i>λ</i>=(<i>π</i>,<i><b>A</b></i>,<i>B</i>)。</p>
                </div>
                <div class="p1">
                    <p id="106">Baum-Welch算法步骤如下:</p>
                </div>
                <div class="p1">
                    <p id="107">(1)随机设置初始模型<i>M</i><sub>0</sub>。</p>
                </div>
                <div class="p1">
                    <p id="108">(2)基于<i>M</i><sub>0</sub>以及观测序列<i>O</i>,训练新模型<i>M</i><sup>*</sup>。</p>
                </div>
                <div class="p1">
                    <p id="109">(3)若满足设定条件(如‖<i>M</i><sup>*</sup>-<i>M</i><sub>0</sub>‖&lt;<i>ε</i>),表明训练已达到预期效果,算法结束。</p>
                </div>
                <div class="p1">
                    <p id="110">(4)否则,令<i>M</i><sub>0</sub>=<i>M</i><sup>*</sup>,继续执行第2步。</p>
                </div>
                <div class="p1">
                    <p id="111">给定模型<i>λ</i>=(<i>π</i>,<i><b>A</b></i>,<i>B</i>),生成观测序列<i>O</i>的概率如下:</p>
                </div>
                <div class="area_img" id="112">
                            <div class="imgformula">
                                <img class="pFormula" alt="" src="Detail/GetImg?filename=images/JSJC201909026_11200.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4rdTg2cEF4V2xrZkdSczJ5ODhxaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                <p class="formula_seq"></p>
                            </div>

                </div>
                <div class="p1">
                    <p id="235">Baum-Welch算法的目标是找到使得观测序列<i>O</i>概率最大的模型:</p>
                </div>
                <div class="p1">
                    <p id="114" class="code-formula">
                        <mathml id="114"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>λ</mi><msup><mrow></mrow><mo>*</mo></msup><mo>=</mo><mrow><munder><mstyle mathsize="140%" displaystyle="true"><mrow><mtext>a</mtext><mtext>r</mtext><mtext>g</mtext><mtext>m</mtext><mtext>a</mtext><mtext>x</mtext></mrow></mstyle><mi>λ</mi></munder></mrow><mtext> </mtext><mi>Ρ</mi><mo stretchy="false">(</mo><mi>Ο</mi><mo stretchy="false">|</mo><mi>λ</mi><mo stretchy="false">)</mo></mrow></math></mathml>
                    </p>
                </div>
                <div class="p1">
                    <p id="115">针对上述最大化问题,得到全局最优解比较困难,但可通过EM算法得到局部最优解。EM算法步骤如下:</p>
                </div>
                <div class="p1">
                    <p id="116">(1)确定由观测序列<i>O</i>和状态数据<i>S</i>所构成的对数似然函数:</p>
                </div>
                <div class="p1">
                    <p id="117">lg <i>P</i>(<i>O</i>,<i>S</i>|<i>λ</i>)</p>
                </div>
                <div class="p1">
                    <p id="118">(2)E步,求<i>Q</i>函数:</p>
                </div>
                <div class="p1">
                    <p id="119" class="code-formula">
                        <mathml id="119"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>Q</mi><mo stretchy="false">(</mo><mi>λ</mi><mo>,</mo><mi>λ</mi><msup><mrow></mrow><mo>*</mo></msup><mo stretchy="false">)</mo><mo>=</mo><mstyle displaystyle="true"><munder><mo>∑</mo><mi>S</mi></munder><mi>Ρ</mi></mstyle><mo stretchy="false">(</mo><mi>S</mi><mo stretchy="false">|</mo><mi>Ο</mi><mo>,</mo><mi>λ</mi><mo stretchy="false">)</mo><mrow><mi>lg</mi></mrow><mtext> </mtext><mi>Ρ</mi><mo stretchy="false">(</mo><mi>Ο</mi><mo>,</mo><mi>S</mi><mo stretchy="false">|</mo><mi>λ</mi><msup><mrow></mrow><mo>*</mo></msup><mo stretchy="false">)</mo></mrow></math></mathml>
                    </p>
                </div>
                <div class="p1">
                    <p id="120">(3)M步,最大化<i>Q</i>函数以求解最新的模型参数:</p>
                </div>
                <div class="p1">
                    <p id="121" class="code-formula">
                        <mathml id="121"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mover><mstyle mathsize="140%" displaystyle="true"><mi>λ</mi></mstyle><mrow><mspace width="0.25em" /><mo>—</mo></mrow></mover><mo>=</mo><mrow><munder><mstyle mathsize="140%" displaystyle="true"><mrow><mtext>a</mtext><mtext>r</mtext><mtext>g</mtext><mtext>m</mtext><mtext>a</mtext><mtext>x</mtext></mrow></mstyle><mrow><mi>λ</mi><msup><mrow></mrow><mo>*</mo></msup></mrow></munder></mrow><mtext> </mtext><mi>Q</mi><mo stretchy="false">(</mo><mi>λ</mi><mo>,</mo><mi>λ</mi><msup><mrow></mrow><mo>*</mo></msup><mo stretchy="false">)</mo></mrow></math></mathml>
                    </p>
                </div>
                <div class="p1">
                    <p id="122">先对<i>λ</i>=(<i>π</i>,<i><b>A</b></i>,<i>B</i>)设置初值<i>λ</i><sub>0</sub>=(<i>π</i><sub>0</sub>,<i><b>A</b></i><sub>0</sub>,<i><b>B</b></i><sub>0</sub>),通过求解max <i>Q</i>(<i>λ</i><sub>0</sub>,<i>λ</i><sup>*</sup>),得到参数新的估计值<i>λ</i><sub>1</sub>,再利用<i>λ</i><sub>1</sub>求解max <i>Q</i>(<i>λ</i><sub>1</sub>,<i>λ</i><sup>*</sup>),得到新估值<i>λ</i><sub>2</sub>。反复迭代,直到所求参数值变化足够小。上述过程描述如下:</p>
                </div>
                <div class="p1">
                    <p id="123" class="code-formula">
                        <mathml id="123"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtable columnalign="left"><mtr><mtd><mi>λ</mi><msub><mrow></mrow><mn>0</mn></msub><mover><mo stretchy="true" symmetric="false">→</mo><mrow><mrow><munder><mstyle mathsize="140%" displaystyle="true"><mrow><mi>max</mi></mrow></mstyle><mrow><mi>λ</mi><mo>*</mo></mrow></munder></mrow><mtext> </mtext><mi>Q</mi><mo stretchy="false">(</mo><mi>λ</mi><msub><mrow></mrow><mn>0</mn></msub><mo>,</mo><mi>λ</mi><msup><mrow></mrow><mo>*</mo></msup><mo stretchy="false">)</mo></mrow></mover><mi>λ</mi><msub><mrow></mrow><mn>1</mn></msub><mover><mo stretchy="true" symmetric="false">→</mo><mrow><mrow><munder><mstyle mathsize="140%" displaystyle="true"><mrow><mi>max</mi></mrow></mstyle><mrow><mi>λ</mi><mo>*</mo></mrow></munder></mrow><mtext> </mtext><mi>Q</mi><mo stretchy="false">(</mo><mi>λ</mi><msub><mrow></mrow><mn>1</mn></msub><mo>,</mo><mi>λ</mi><msup><mrow></mrow><mo>*</mo></msup><mo stretchy="false">)</mo></mrow></mover><mi>λ</mi><msub><mrow></mrow><mn>2</mn></msub></mtd></mtr><mtr><mtd><mtext> </mtext><mrow><mtext> </mtext><mtext> </mtext></mrow><mover><mo stretchy="true" symmetric="false">→</mo><mrow><mrow><munder><mstyle mathsize="140%" displaystyle="true"><mrow><mi>max</mi></mrow></mstyle><mrow><mi>λ</mi><mo>*</mo></mrow></munder></mrow><mtext> </mtext><mi>Q</mi><mo stretchy="false">(</mo><mi>λ</mi><msub><mrow></mrow><mn>2</mn></msub><mo>,</mo><mi>λ</mi><msup><mrow></mrow><mo>*</mo></msup><mo stretchy="false">)</mo></mrow></mover><mi>λ</mi><msub><mrow></mrow><mn>3</mn></msub><mo>⋯</mo></mtd></mtr></mtable></math></mathml>
                    </p>
                </div>
                <h3 id="124" name="124" class="anchor-tag">2 基于HMM的恶意域名检测</h3>
                <h4 class="anchor-tag" id="125" name="125">2.1 恶意域名检测问题描述</h4>
                <div class="p1">
                    <p id="126">根据域名恶意程度的不同,从海量DNS日志中提取出的域名在不同时间序列中具有不同的属性特征,且这些域名状态不可观测。从海量DNS日志中提取出的相关域名属性,如域名的自身特性、时间性、对应IP的特征以及相关域名集等,可通过观察进行量化统计,且域名在不同时间序列中的可观测变量特征由域名所隐藏的恶意危害强度所决定,这种域名的恶意危害强度又由其所处的状态决定,因此,模型构建需要应用双重映射过程<citation id="230" type="reference"><link href="41" rel="bibliography" /><sup>[<a class="sup">20</a>]</sup></citation>。</p>
                </div>
                <div class="p1">
                    <p id="127">用作域名识别的观测变量应该具备区别善恶域名的能力,即在域名检测过程中,针对不存在恶意域名和存在恶意域名的情况,这些观测变量的值将存在很大差异。本文通过分析DNS日志记录中域名的相关特征信息,提取出5个类别中的12个特征属性值,详细信息如表1所示。</p>
                </div>
                <div class="area_img" id="128">
                    <p class="img_tit"><b>表1 域名特征说明</b> <a class="downexcel" onclick="DownLoadReportExcel(this)">导出到EXCEL</a></p>
                    <p class="img_tit"></p>
                    <p class="img_note"></p>
                    <table id="128" border="1"><tr><td><br />属性集     </td><td>属性名   </td></tr><tr><td rowspan="3"><br />域名字符特征</td><td><br />数字占总长度的比例</td></tr><tr><td><br />域名字符熵值</td></tr><tr><td><br />域名长度</td></tr><tr><td rowspan="3"><br />域名对应IP特征</td><td><br />域名对应IP的个数</td></tr><tr><td><br />域名对应IP的差异性</td></tr><tr><td><br />域名对应的国家个数</td></tr><tr><td rowspan="3"><br />TTL特征</td><td><br />TTL的平均值</td></tr><tr><td><br />TTL的变化次数</td></tr><tr><td><br />TTL的标准差</td></tr><tr><td rowspan="2"><br />NS记录特征</td><td><br />域名服务器变化次数</td></tr><tr><td><br />域名服务器平均变化时长</td></tr><tr><td><br />域名生存期特征</td><td>域名的生存周期</td></tr></table>
                    <form name="form" action="/kxreader/Detail/DownloadReportExcel" method="POST" style="display:inline">
                        <input type="hidden" name="hidTable" value="" />
                        <input type="hidden" name="hidFileName" value="" />
                    </form>
                    <p class="img_note"></p>
                    <p class="img_note"></p>
                </div>
                <h4 class="anchor-tag" id="129" name="129">2.2 基于HMM的恶意域名检测问题描述</h4>
                <div class="p1">
                    <p id="130">一种有效的恶意域名检测方法即对海量DNS日志的域名属性特征进行监控,获取该域名的自身特性、时间性、对应IP特征以及相关域名集等,分析这些海量的域名历史数据得出不同域名在特定时间序列中的HMM模型初始化参数,然后通过HMM模型中的Baum-Welch算法进行反复迭代并训练出最优的模型参数,在此基础上,通过Viterbi算法检测出相应属性特征下域名最可能的恶意隐藏状态行为。基于HMM的恶意域名检测系统总体框架如图1所示。</p>
                </div>
                <div class="area_img" id="131">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JSJC201909026_131.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4rdTg2cEF4V2xrZkdSczJ5ODhxaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图1 恶意域名检测系统总体架构" src="Detail/GetImg?filename=images/JSJC201909026_131.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4rdTg2cEF4V2xrZkdSczJ5ODhxaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit"><b>图1 恶意域名检测系统总体架构</b>  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JSJC201909026_131.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4rdTg2cEF4V2xrZkdSczJ5ODhxaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="p1">
                    <p id="132">在域名检测系统中,构建HMM最重要的步骤是确定三元组<i>λ</i>=(<i>π</i>,<i><b>A</b></i>,<i>B</i>)中各元素之间的映射关系,即模型中初始概率、转移概率和混淆矩阵最合适的数据组合。由于无法直接观测到域名在不同时间序列中的状态,因此本文将域名的状态作为HMM的隐状态,这些隐状态包括善意域名和恶意域名,根据恶意域名的不同类型又可划分为<i>N</i>个隐状态,观测变量的选取即从DNS日志中提取出5大类共12个属性特征。其中,初始概率、转移概率和混淆矩阵可通过分析DNS日志的历史记录并根据域名之间的实际分布情况进行参数初始化。</p>
                </div>
                <h4 class="anchor-tag" id="133" name="133">2.3 基于HMM的恶意域名识别系统</h4>
                <h4 class="anchor-tag" id="134" name="134">2.3.1 系统特征值提取</h4>
                <div class="p1">
                    <p id="135">为实现本文系统,需从域名的自身特性、时间性、对应IP特征和相关域名集中提取出12个特征值。为加快提取速度,利用Spark大数据处理平台中Transfromation算子的懒加载机制来避免产生中间数据,在Action操作时才进行特征提取。特征数据提取过程如图2所示。</p>
                </div>
                <div class="area_img" id="136">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JSJC201909026_136.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4rdTg2cEF4V2xrZkdSczJ5ODhxaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图2 特征数据提取过程" src="Detail/GetImg?filename=images/JSJC201909026_136.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4rdTg2cEF4V2xrZkdSczJ5ODhxaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit"><b>图2 特征数据提取过程</b>  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JSJC201909026_136.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4rdTg2cEF4V2xrZkdSczJ5ODhxaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="p1">
                    <p id="137">首先,Spark从hdfs文件系统中读取相关的域名数据,并在内存中将其表示为DataCollectionRDD;然后,使用Map算子提取出域名与TTL值、IP地址、访问时间、NS记录的组合对,再通过reduceByKey算子将相同域名的TTL值、IP地址、访问时间、NS记录进行聚合,并根据域名计算出数据所占的百分比,从聚合到的TTL值中计算出TTL均值、TTL变化数和TTL标准差3个特征值,从聚合到的访问时间中得到域名生存期,从聚合到的IP地址中计算出域名对应的IP个数、域名对应国家数、域名对应IP的差异性3个特征值,从聚合到的NS记录特征中计算出域名服务器变化次数、域名服务器平均变化时长;最终,得到12个特征值并形成样本集,存入hdfs文件系统中。</p>
                </div>
                <h4 class="anchor-tag" id="138" name="138">2.3.2 DNS数据流实时获取</h4>
                <div class="p1">
                    <p id="139">本文采用建立在Spark上的实时计算框架Spark Streaming,从DNS日志中获取实时的数据流。Spark Streaming的处理机制是将持续不断输入的数据流根据一定的时间间隔拆分成多个批处理作业<citation id="231" type="reference"><link href="43" rel="bibliography" /><sup>[<a class="sup">21</a>]</sup></citation>,然后通过Spark Engine对这些数据进行处理。本文系统通过Spark Streaming从DNS获取实时数据流的主要步骤如下:</p>
                </div>
                <div class="p1">
                    <p id="140"><b>步骤1</b> Spark Streaming参数初始化。</p>
                </div>
                <div class="p1">
                    <p id="141"><b>步骤2</b> 从hdfs的数据源不断监听是否有新数据到达。</p>
                </div>
                <div class="p1">
                    <p id="142"><b>步骤3</b> 将接收的新数据以时间片为单位进行分批,利用Spark Engine处理这些数据。</p>
                </div>
                <div class="p1">
                    <p id="143"><b>步骤4</b> 将步骤3中经过各种Spark算子处理后的结果数据流DStream转化为对应的RDD。</p>
                </div>
                <h4 class="anchor-tag" id="144" name="144">2.3.3 HMM模型实现</h4>
                <div class="p1">
                    <p id="145">HMM模型的实现步骤具体如下:</p>
                </div>
                <div class="p1">
                    <p id="146"><b>步骤1</b> 对HMM的以下相关参数进行初始化:</p>
                </div>
                <div class="p1">
                    <p id="147">1)状态<i>S</i>。善恶域名在检测时间序列中进行访问操作时,域名的隐状态类型无法预知。因此,根据域名变换的多样性和灵活性,可通过试探法对域名模型的隐状态进行探测。在实验中,根据危害程度从弱到强将域名攻击暂分为<i>S</i><sub>1</sub>,<i>S</i><sub>2</sub>,…,<i>S</i><sub>5</sub>共5类,对应于HMM模型中的不同状态。</p>
                </div>
                <div class="p1">
                    <p id="148">2)观测值<i>V</i>。该值为海量DNS日志中相关域名的解析记录及其相应的特征行为模式。实验中使用的观测特征值共有12个,即<i>O</i>={<i>O</i><sub>1</sub>,<i>O</i><sub>2</sub>,…,<i>O</i><sub>12</sub>}。</p>
                </div>
                <div class="p1">
                    <p id="149">3)初始状态的概率分布<i>Π</i>={<i>π</i><sub><i>i</i></sub>},<i>π</i><sub><i>i</i></sub>=<i>P</i>(<i>Q</i><sub>1</sub>=<i>S</i><sub><i>i</i></sub>)表示系统中所有域名<i>S</i><sub><i>i</i></sub>初始出现的概率,其计算如下:</p>
                </div>
                <div class="p1">
                    <p id="150" class="code-formula">
                        <mathml id="150"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>π</mi><msub><mrow></mrow><mi>i</mi></msub><mo>=</mo><mfrac><mtable columnalign="left"><mtr><mtd><mtext>初</mtext><mtext>始</mtext><mtext>时</mtext><mtext>不</mtext><mtext>同</mtext><mtext>状</mtext><mtext>态</mtext><mtext>域</mtext><mtext>名</mtext><mi>S</mi><msub><mrow></mrow><mi>i</mi></msub><mtext>出</mtext><mtext>现</mtext><mtext>的</mtext><mtext>次</mtext><mtext>数</mtext></mtd></mtr><mtr><mtd></mtd></mtr></mtable><mrow><mstyle displaystyle="true"><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>Ν</mi></munderover><mtext>初</mtext></mstyle><mtext>始</mtext><mtext>时</mtext><mtext>不</mtext><mtext>同</mtext><mtext>状</mtext><mtext>态</mtext><mtext>域</mtext><mtext>名</mtext><mi>S</mi><msub><mrow></mrow><mi>j</mi></msub><mtext>出</mtext><mtext>现</mtext><mtext>的</mtext><mtext>次</mtext><mtext>数</mtext></mrow></mfrac><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mrow><mtext> </mtext><mtext> </mtext><mtext> </mtext></mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></math></mathml>
                    </p>
                </div>
                <div class="p1">
                    <p id="151">其中,1≤<i>i</i>≤<i>N</i>。</p>
                </div>
                <div class="p1">
                    <p id="152">4)状态转移概率矩阵:</p>
                </div>
                <div class="p1">
                    <p id="153"><i><b>A</b></i>=[<i>α</i><sub><i>ij</i></sub>]<sub><i>N</i></sub>×<i>N</i>,<i>α</i><sub><i>ij</i></sub>=<i>P</i>(<i>Q</i><sub><i>t</i></sub>+1=<i>S</i><sub><i>j</i></sub>|<i>Q</i><sub><i>t</i></sub>=<i>S</i><sub><i>i</i></sub>)(1≤<i>i</i>,<i>j</i>≤<i>N</i>)      (2)</p>
                </div>
                <div class="p1">
                    <p id="154">其中,<i>α</i><sub><i>ij</i></sub>表示系统中所有不同状态域名在某一时刻<i>t</i>处于<i>S</i><sub><i>i</i></sub>、在时刻<i>t</i>+1转移到<i>S</i><sub><i>j</i></sub>的概率,此处<i>t</i>只表示域名状态出现的先后顺序。<i>α</i><sub><i>ij</i></sub>计算如下:</p>
                </div>
                <div class="p1">
                    <p id="155" class="code-formula">
                        <mathml id="155"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>α</mi><msub><mrow></mrow><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mfrac><mrow><mtext>从</mtext><mi>S</mi><msub><mrow></mrow><mi>i</mi></msub><mtext>转</mtext><mtext>移</mtext><mtext>到</mtext><mi>S</mi><msub><mrow></mrow><mi>j</mi></msub><mtext>的</mtext><mtext>次</mtext><mtext>数</mtext></mrow><mrow><mstyle displaystyle="true"><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>Ν</mi></munderover><mtext>从</mtext></mstyle><mi>S</mi><msub><mrow></mrow><mi>i</mi></msub><mtext>转</mtext><mtext>移</mtext><mtext>到</mtext><mi>S</mi><msub><mrow></mrow><mi>k</mi></msub><mtext>的</mtext><mtext>次</mtext><mtext>数</mtext></mrow></mfrac><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mrow><mtext> </mtext><mtext> </mtext><mtext> </mtext></mrow><mo stretchy="false">(</mo><mn>3</mn><mo stretchy="false">)</mo></mrow></math></mathml>
                    </p>
                </div>
                <div class="p1">
                    <p id="156">其中,1≤<i>i</i>,<i>j</i>,<i>k</i>≤<i>N</i>。</p>
                </div>
                <div class="p1">
                    <p id="157">5)观测值的概率分布矩阵:</p>
                </div>
                <div class="p1">
                    <p id="158"><i><b>B</b></i>=[<i>b</i><sub><i>jk</i></sub>]<sub><i>M</i></sub>×<i>N</i></p>
                </div>
                <div class="p1">
                    <p id="159">其中,<i>b</i><sub><i>jk</i></sub>=<i>P</i>(<i>O</i><sub><i>t</i></sub>=<i>V</i><sub><i>k</i></sub>|<i>Q</i><sub><i>t</i></sub>=<i>S</i><sub><i>j</i></sub>)(1≤<i>j</i>≤<i>N</i>,1≤<i>k</i>≤<i>M</i>)表示不同状态域名<i>S</i><sub><i>j</i></sub>出现时域名解析记录的相应特征为<i>V</i><sub><i>k</i></sub>的概率。<i>b</i><sub><i>jk</i></sub>计算如下:</p>
                </div>
                <div class="p1">
                    <p id="160" class="code-formula">
                        <mathml id="160"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>b</mi><msub><mrow></mrow><mrow><mi>j</mi><mi>k</mi></mrow></msub><mo>=</mo><mfrac><mtable columnalign="left"><mtr><mtd><mtext>域</mtext><mtext>名</mtext><mtext>状</mtext><mtext>态</mtext><mtext>为</mtext><mi>S</mi><msub><mrow></mrow><mi>j</mi></msub><mtext>时</mtext><mtext>解</mtext><mtext>析</mtext><mtext>记</mtext><mtext>录</mtext><mtext>特</mtext><mtext>征</mtext><mtext>为</mtext><mi>V</mi><msub><mrow></mrow><mi>k</mi></msub><mtext>的</mtext><mtext>次</mtext><mtext>数</mtext></mtd></mtr><mtr><mtd></mtd></mtr></mtable><mrow><mtext>解</mtext><mtext>析</mtext><mtext>记</mtext><mtext>录</mtext><mtext>特</mtext><mtext>征</mtext><mtext>为</mtext><mi>V</mi><msub><mrow></mrow><mi>k</mi></msub><mtext>的</mtext><mtext>总</mtext><mtext>次</mtext><mtext>数</mtext></mrow></mfrac><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mrow><mtext> </mtext><mtext> </mtext><mtext> </mtext></mrow><mo stretchy="false">(</mo><mn>4</mn><mo stretchy="false">)</mo></mrow></math></mathml>
                    </p>
                </div>
                <div class="p1">
                    <p id="161">其中,1≤<i>j</i>≤<i>N</i>,1≤<i>k</i>≤<i>M</i>。</p>
                </div>
                <div class="p1">
                    <p id="162"><b>步骤2</b> 使用Baum-Welch算法,根据训练集中<i>T</i>时刻DNS服务器中域名解析记录的相应观测序列<i>O</i>={<i>O</i><sub>1</sub>,<i>O</i><sub>2</sub>,…,<i>O</i><sub><i>T</i></sub>}、隐状态序列<i>Q</i>={<i>Q</i><sub>1</sub>,<i>Q</i><sub>2</sub>,…,<i>Q</i><sub><i>T</i></sub>},对HMM模型中的参数进行训练,使得<i>P</i>(<i>O</i>|<i>λ</i>)最大。具体流程如下:</p>
                </div>
                <div class="p1">
                    <p id="163">1)确定由观测序列<i>O</i>和隐状态数据<i>S</i>构成的对数似然函数:</p>
                </div>
                <div class="p1">
                    <p id="164">lg <i>P</i>(<i>O</i>,<i>S</i>|<i>λ</i>)      (5)</p>
                </div>
                <div class="p1">
                    <p id="165">2)E步。求<i>Q</i>函数:</p>
                </div>
                <div class="p1">
                    <p id="166" class="code-formula">
                        <mathml id="166"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>Q</mi><mo stretchy="false">(</mo><mi>λ</mi><mo>,</mo><mi>λ</mi><msup><mrow></mrow><mo>*</mo></msup><mo stretchy="false">)</mo><mo>=</mo><mstyle displaystyle="true"><munder><mo>∑</mo><mi>S</mi></munder><mi>Ρ</mi></mstyle><mo stretchy="false">(</mo><mi>S</mi><mo stretchy="false">|</mo><mi>Ο</mi><mo>,</mo><mi>λ</mi><mo stretchy="false">)</mo><mrow><mi>lg</mi></mrow><mtext> </mtext><mi>Ρ</mi><mrow><mo stretchy="false">(</mo><mi>Ο</mi><mo>,</mo><mi>S</mi><mo stretchy="false">|</mo><mi>λ</mi><msup><mrow></mrow><mo>*</mo></msup><mo stretchy="false">)</mo></mrow><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mrow><mtext> </mtext><mtext> </mtext><mtext> </mtext></mrow><mo stretchy="false">(</mo><mn>6</mn><mo stretchy="false">)</mo></mrow></math></mathml>
                    </p>
                </div>
                <div class="p1">
                    <p id="167">3)M步。通过反复迭代使<i>Q</i>函数最大化,求解最优的模型参数:</p>
                </div>
                <div class="p1">
                    <p id="168" class="code-formula">
                        <mathml id="168"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtable columnalign="left"><mtr><mtd><mover><mstyle mathsize="140%" displaystyle="true"><mi>λ</mi></mstyle><mrow><mspace width="0.25em" /><mo>—</mo></mrow></mover><mo>=</mo><mrow><munder><mstyle mathsize="140%" displaystyle="true"><mrow><mtext>a</mtext><mtext>r</mtext><mtext>g</mtext><mtext>m</mtext><mtext>a</mtext><mtext>x</mtext></mrow></mstyle><mrow><mi>λ</mi><msup><mrow></mrow><mo>*</mo></msup></mrow></munder></mrow><mtext> </mtext><mi>Q</mi><mo stretchy="false">(</mo><mi>λ</mi><mo>,</mo><mi>λ</mi><msup><mrow></mrow><mo>*</mo></msup><mo stretchy="false">)</mo><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mrow><mtext> </mtext><mtext> </mtext><mtext> </mtext></mrow><mo stretchy="false">(</mo><mn>7</mn><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><mi>Q</mi><mo stretchy="false">(</mo><mi>λ</mi><mo>,</mo><mi>λ</mi><msup><mrow></mrow><mo>*</mo></msup><mo stretchy="false">)</mo><mo>=</mo><mstyle displaystyle="true"><munder><mo>∑</mo><mi>S</mi></munder><mi>Ρ</mi></mstyle><mo stretchy="false">(</mo><mi>S</mi><mo stretchy="false">|</mo><mi>Ο</mi><mo>,</mo><mi>λ</mi><mo stretchy="false">)</mo><mrow><mi>lg</mi></mrow><mtext> </mtext><mi>Ρ</mi><mo stretchy="false">(</mo><mi>Ο</mi><mo>,</mo><mi>S</mi><mo stretchy="false">|</mo><mi>λ</mi><msup><mrow></mrow><mo>*</mo></msup><mo stretchy="false">)</mo><mo>=</mo></mtd></mtr><mtr><mtd><mtext> </mtext><mrow><mtext> </mtext><mtext> </mtext></mrow><mstyle displaystyle="true"><munder><mo>∑</mo><mi>S</mi></munder><mrow><mfrac><mrow><mi>Ρ</mi><mo stretchy="false">(</mo><mi>Ο</mi><mo>,</mo><mi>S</mi><mo stretchy="false">|</mo><mi>λ</mi><mo stretchy="false">)</mo></mrow><mrow><mi>Ρ</mi><mo stretchy="false">(</mo><mi>Ο</mi><mo stretchy="false">|</mo><mi>λ</mi><mo stretchy="false">)</mo></mrow></mfrac></mrow></mstyle><mrow><mi>lg</mi></mrow><mtext> </mtext><mi>Ρ</mi><mo stretchy="false">(</mo><mi>Ο</mi><mo>,</mo><mi>S</mi><mo stretchy="false">|</mo><mi>λ</mi><msup><mrow></mrow><mo>*</mo></msup><mo stretchy="false">)</mo><mo>=</mo></mtd></mtr><mtr><mtd><mtext> </mtext><mrow><mtext> </mtext><mtext> </mtext></mrow><mfrac><mn>1</mn><mrow><mi>Ρ</mi><mo stretchy="false">(</mo><mi>Ο</mi><mo stretchy="false">|</mo><mi>λ</mi><mo stretchy="false">)</mo></mrow></mfrac><mstyle displaystyle="true"><munder><mo>∑</mo><mi>S</mi></munder><mi>Ρ</mi></mstyle><mo stretchy="false">(</mo><mi>Ο</mi><mo>,</mo><mi>S</mi><mo stretchy="false">|</mo><mi>λ</mi><mo stretchy="false">)</mo><mrow><mi>lg</mi></mrow><mtext> </mtext><mi>Ρ</mi><mo stretchy="false">(</mo><mi>Ο</mi><mo>,</mo><mi>S</mi><mo stretchy="false">|</mo><mi>λ</mi><msup><mrow></mrow><mo>*</mo></msup><mo stretchy="false">)</mo></mtd></mtr></mtable></math></mathml>
                    </p>
                </div>
                <div class="p1">
                    <p id="169">对于给定的参数<i>λ</i>,<i>P</i>(<i>O</i>|<i>λ</i>)是常量,故:</p>
                </div>
                <div class="p1">
                    <p id="170" class="code-formula">
                        <mathml id="170"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtable columnalign="left"><mtr><mtd><mrow><munder><mstyle mathsize="140%" displaystyle="true"><mrow><mi>max</mi></mrow></mstyle><mrow><mi>λ</mi><msup><mrow></mrow><mo>*</mo></msup></mrow></munder></mrow><mtext> </mtext><mi>Q</mi><mo stretchy="false">(</mo><mi>λ</mi><mo>,</mo><mi>λ</mi><msup><mrow></mrow><mo>*</mo></msup><mo stretchy="false">)</mo><mo>=</mo><mrow><munder><mstyle mathsize="140%" displaystyle="true"><mrow><mi>max</mi></mrow></mstyle><mrow><mi>λ</mi><msup><mrow></mrow><mo>*</mo></msup></mrow></munder></mrow><mtext> </mtext><mstyle displaystyle="true"><munder><mo>∑</mo><mi>S</mi></munder><mi>Ρ</mi></mstyle><mo stretchy="false">(</mo><mi>Ο</mi><mo>,</mo><mi>S</mi><mo stretchy="false">|</mo><mi>λ</mi><mo stretchy="false">)</mo><mrow><mi>lg</mi></mrow><mtext> </mtext><mi>Ρ</mi><mo stretchy="false">(</mo><mi>Ο</mi><mo>,</mo><mi>S</mi><mo>,</mo><mo stretchy="false">|</mo><mi>λ</mi><msup><mrow></mrow><mo>*</mo></msup><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><mi>Ρ</mi><mo stretchy="false">(</mo><mi>Ο</mi><mo>,</mo><mi>S</mi><mo stretchy="false">|</mo><mi>λ</mi><msup><mrow></mrow><mo>*</mo></msup><mo stretchy="false">)</mo><mo>=</mo><mover><mstyle mathsize="140%" displaystyle="true"><mi>π</mi></mstyle><mrow><mspace width="0.25em" /><mo>^</mo></mrow></mover><msub><mrow></mrow><mrow><mi>s</mi><msub><mrow></mrow><mn>1</mn></msub></mrow></msub><mover><mstyle mathsize="140%" displaystyle="true"><mi>b</mi></mstyle><mrow><mspace width="0.25em" /><mo>^</mo></mrow></mover><msub><mrow></mrow><mrow><mi>s</mi><msub><mrow></mrow><mn>1</mn></msub></mrow></msub><mo stretchy="false">(</mo><mi>o</mi><msub><mrow></mrow><mn>1</mn></msub><mo stretchy="false">)</mo><mover><mstyle mathsize="140%" displaystyle="true"><mi>α</mi></mstyle><mrow><mspace width="0.25em" /><mo>^</mo></mrow></mover><msub><mrow></mrow><mrow><mi>s</mi><msub><mrow></mrow><mn>1</mn></msub><mi>s</mi><msub><mrow></mrow><mn>2</mn></msub></mrow></msub><mover><mstyle mathsize="140%" displaystyle="true"><mi>b</mi></mstyle><mrow><mspace width="0.25em" /><mo>^</mo></mrow></mover><msub><mrow></mrow><mrow><mi>s</mi><msub><mrow></mrow><mn>2</mn></msub></mrow></msub><mo stretchy="false">(</mo><mi>o</mi><msub><mrow></mrow><mn>2</mn></msub><mo stretchy="false">)</mo><mo>⋯</mo><mover><mstyle mathsize="140%" displaystyle="true"><mi>α</mi></mstyle><mrow><mspace width="0.25em" /><mo>^</mo></mrow></mover><msub><mrow></mrow><mrow><mi>s</mi><msub><mrow></mrow><mrow><mi>Τ</mi><mo>-</mo><mn>1</mn></mrow></msub><mi>s</mi><msub><mrow></mrow><mi>Τ</mi></msub></mrow></msub><mover><mstyle mathsize="140%" displaystyle="true"><mi>b</mi></mstyle><mrow><mspace width="0.25em" /><mo>^</mo></mrow></mover><msub><mrow></mrow><mrow><mi>s</mi><msub><mrow></mrow><mi>Τ</mi></msub></mrow></msub><mo stretchy="false">(</mo><mi>o</mi><msub><mrow></mrow><mi>Τ</mi></msub><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><mi>Q</mi><mo stretchy="false">(</mo><mi>λ</mi><mo>,</mo><mi>λ</mi><msup><mrow></mrow><mo>*</mo></msup><mo stretchy="false">)</mo><mo>=</mo><mstyle displaystyle="true"><munder><mo>∑</mo><mi>S</mi></munder><mi>Ρ</mi></mstyle><mo stretchy="false">(</mo><mi>Ο</mi><mo>,</mo><mi>S</mi><mo stretchy="false">|</mo><mi>λ</mi><mo stretchy="false">)</mo><mrow><mi>lg</mi></mrow><mtext> </mtext><mi>Ρ</mi><mo stretchy="false">(</mo><mi>Ο</mi><mo>,</mo><mi>S</mi><mo stretchy="false">|</mo><mi>λ</mi><msup><mrow></mrow><mo>*</mo></msup><mo stretchy="false">)</mo><mo>=</mo></mtd></mtr><mtr><mtd><mtext> </mtext><mrow><mtext> </mtext><mtext> </mtext></mrow><mstyle displaystyle="true"><munder><mo>∑</mo><mi>S</mi></munder><mi>Ρ</mi></mstyle><mo stretchy="false">(</mo><mi>Ο</mi><mo>,</mo><mi>S</mi><mo stretchy="false">|</mo><mi>λ</mi><mo stretchy="false">)</mo><mrow><mi>lg</mi></mrow><mo stretchy="false">(</mo><mover><mstyle mathsize="140%" displaystyle="true"><mi>π</mi></mstyle><mrow><mspace width="0.25em" /><mo>^</mo></mrow></mover><msub><mrow></mrow><mrow><mi>s</mi><msub><mrow></mrow><mn>1</mn></msub></mrow></msub><mover><mstyle mathsize="140%" displaystyle="true"><mi>b</mi></mstyle><mrow><mspace width="0.25em" /><mo>^</mo></mrow></mover><msub><mrow></mrow><mrow><mi>s</mi><msub><mrow></mrow><mn>1</mn></msub></mrow></msub><mo stretchy="false">(</mo><mi>o</mi><msub><mrow></mrow><mn>1</mn></msub><mo stretchy="false">)</mo><mover><mstyle mathsize="140%" displaystyle="true"><mi>α</mi></mstyle><mrow><mspace width="0.25em" /><mo>^</mo></mrow></mover><msub><mrow></mrow><mrow><mi>s</mi><msub><mrow></mrow><mn>1</mn></msub><mi>s</mi><msub><mrow></mrow><mn>2</mn></msub></mrow></msub><mover><mstyle mathsize="140%" displaystyle="true"><mi>b</mi></mstyle><mrow><mspace width="0.25em" /><mo>^</mo></mrow></mover><msub><mrow></mrow><mrow><mi>s</mi><msub><mrow></mrow><mn>2</mn></msub></mrow></msub><mo stretchy="false">(</mo><mi>o</mi><msub><mrow></mrow><mn>2</mn></msub><mo stretchy="false">)</mo><mo>⋯</mo></mtd></mtr><mtr><mtd><mtext> </mtext><mrow><mtext> </mtext><mtext> </mtext></mrow><mover><mstyle mathsize="140%" displaystyle="true"><mi>α</mi></mstyle><mrow><mspace width="0.25em" /><mo>^</mo></mrow></mover><msub><mrow></mrow><mrow><mi>s</mi><msub><mrow></mrow><mrow><mi>Τ</mi><mo>-</mo><mn>1</mn></mrow></msub><mi>S</mi><msub><mrow></mrow><mi>Τ</mi></msub></mrow></msub><mover><mstyle mathsize="140%" displaystyle="true"><mi>b</mi></mstyle><mrow><mspace width="0.25em" /><mo>^</mo></mrow></mover><msub><mrow></mrow><mrow><mi>s</mi><msub><mrow></mrow><mi>Τ</mi></msub></mrow></msub><mo stretchy="false">(</mo><mi>o</mi><msub><mrow></mrow><mi>Τ</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>=</mo></mtd></mtr><mtr><mtd><mtext> </mtext><mrow><mtext> </mtext><mtext> </mtext></mrow><mstyle displaystyle="true"><munder><mo>∑</mo><mi>S</mi></munder><mi>Ρ</mi></mstyle><mo stretchy="false">(</mo><mi>Ο</mi><mo>,</mo><mi>S</mi><mo stretchy="false">|</mo><mi>λ</mi><mo stretchy="false">)</mo><mrow><mi>lg</mi></mrow><mtext> </mtext><mover><mstyle mathsize="140%" displaystyle="true"><mi>π</mi></mstyle><mrow><mspace width="0.25em" /><mo>^</mo></mrow></mover><msub><mrow></mrow><mrow><mi>s</mi><msub><mrow></mrow><mn>1</mn></msub></mrow></msub><mo>+</mo></mtd></mtr><mtr><mtd><mtext> </mtext><mrow><mtext> </mtext><mtext> </mtext></mrow><mstyle displaystyle="true"><munder><mo>∑</mo><mi>S</mi></munder><mi>Ρ</mi></mstyle><mo stretchy="false">(</mo><mi>Ο</mi><mo>,</mo><mi>S</mi><mo stretchy="false">|</mo><mi>λ</mi><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mstyle displaystyle="true"><munderover><mo>∑</mo><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>Τ</mi><mo>-</mo><mn>1</mn></mrow></munderover><mrow><mi>lg</mi></mrow></mstyle><mtext> </mtext><mover><mstyle mathsize="140%" displaystyle="true"><mi>α</mi></mstyle><mrow><mspace width="0.25em" /><mo>^</mo></mrow></mover><msub><mrow></mrow><mrow><mi>s</mi><msub><mrow></mrow><mi>t</mi></msub><mi>s</mi><msub><mrow></mrow><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow></msub><mo stretchy="false">)</mo><mo>+</mo></mtd></mtr><mtr><mtd><mtext> </mtext><mrow><mtext> </mtext><mtext> </mtext></mrow><mstyle displaystyle="true"><munder><mo>∑</mo><mi>S</mi></munder><mi>Ρ</mi></mstyle><mo stretchy="false">(</mo><mi>Ο</mi><mo>,</mo><mi>S</mi><mo stretchy="false">|</mo><mi>λ</mi><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mstyle displaystyle="true"><munderover><mo>∑</mo><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mi>Τ</mi></munderover><mrow><mi>lg</mi></mrow></mstyle><mtext> </mtext><mover><mstyle mathsize="140%" displaystyle="true"><mi>b</mi></mstyle><mrow><mspace width="0.25em" /><mo>^</mo></mrow></mover><msub><mrow></mrow><mrow><mi>s</mi><msub><mrow></mrow><mi>t</mi></msub></mrow></msub><mo stretchy="false">(</mo><mi>o</mi><msub><mrow></mrow><mi>t</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><mrow><mi>max</mi></mrow><mstyle displaystyle="true"><munder><mo>∑</mo><mi>S</mi></munder><mi>Ρ</mi></mstyle><mo stretchy="false">(</mo><mi>Ο</mi><mo>,</mo><mi>S</mi><mo stretchy="false">|</mo><mi>λ</mi><mo stretchy="false">)</mo><mrow><mi>lg</mi></mrow><mtext> </mtext><mover><mstyle mathsize="140%" displaystyle="true"><mi>π</mi></mstyle><mrow><mspace width="0.25em" /><mo>^</mo></mrow></mover><msub><mrow></mrow><mrow><mi>s</mi><msub><mrow></mrow><mn>1</mn></msub></mrow></msub><mo>,</mo><mstyle displaystyle="true"><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>Ν</mi></munderover><mrow><mover><mstyle mathsize="140%" displaystyle="true"><mi>π</mi></mstyle><mrow><mspace width="0.25em" /><mo>^</mo></mrow></mover></mrow></mstyle><msub><mrow></mrow><mi>i</mi></msub><mo>=</mo><mn>1</mn></mtd></mtr><mtr><mtd><mrow><mi>max</mi></mrow><mstyle displaystyle="true"><munder><mo>∑</mo><mi>S</mi></munder><mi>Ρ</mi></mstyle><mo stretchy="false">(</mo><mi>Ο</mi><mo>,</mo><mi>S</mi><mo stretchy="false">|</mo><mi>λ</mi><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mstyle displaystyle="true"><munderover><mo>∑</mo><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>Τ</mi><mo>-</mo><mn>1</mn></mrow></munderover><mrow><mi>lg</mi></mrow></mstyle><mtext> </mtext><mover><mstyle mathsize="140%" displaystyle="true"><mi>α</mi></mstyle><mrow><mspace width="0.25em" /><mo>^</mo></mrow></mover><msub><mrow></mrow><mrow><mi>s</mi><msub><mrow></mrow><mi>t</mi></msub><mi>s</mi><msub><mrow></mrow><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow></msub><mo stretchy="false">)</mo><mo>,</mo><mstyle displaystyle="true"><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>Ν</mi></munderover><mrow><mover><mstyle mathsize="140%" displaystyle="true"><mi>α</mi></mstyle><mrow><mspace width="0.25em" /><mo>^</mo></mrow></mover></mrow></mstyle><msub><mrow></mrow><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mn>1</mn></mtd></mtr><mtr><mtd><mrow><mi>max</mi></mrow><mstyle displaystyle="true"><munder><mo>∑</mo><mi>S</mi></munder><mi>Ρ</mi></mstyle><mo stretchy="false">(</mo><mi>Ο</mi><mo>,</mo><mi>S</mi><mo stretchy="false">|</mo><mi>λ</mi><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mstyle displaystyle="true"><munderover><mo>∑</mo><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mi>Τ</mi></munderover><mrow><mi>lg</mi></mrow></mstyle><mtext> </mtext><mover><mstyle mathsize="140%" displaystyle="true"><mi>b</mi></mstyle><mrow><mspace width="0.25em" /><mo>^</mo></mrow></mover><msub><mrow></mrow><mrow><mi>s</mi><msub><mrow></mrow><mi>t</mi></msub></mrow></msub><mo stretchy="false">(</mo><mi>o</mi><msub><mrow></mrow><mi>t</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>,</mo><mstyle displaystyle="true"><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>Ν</mi></munderover><mrow><mover><mstyle mathsize="140%" displaystyle="true"><mi>b</mi></mstyle><mrow><mspace width="0.25em" /><mo>^</mo></mrow></mover></mrow></mstyle><msub><mrow></mrow><mi>j</mi></msub><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn></mtd></mtr></mtable></math></mathml>
                    </p>
                </div>
                <div class="p1">
                    <p id="171">迭代执行<i>n</i>=1,2,…,直到满足终止条件:</p>
                </div>
                <div class="p1">
                    <p id="172" class="code-formula">
                        <mathml id="172"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtable columnalign="left"><mtr><mtd><mi>π</mi><msubsup><mrow></mrow><mi>i</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msubsup><mo>=</mo><mfrac><mrow><mi>Ρ</mi><mo stretchy="false">(</mo><mi>Ο</mi><mo>,</mo><mi>s</mi><msub><mrow></mrow><mn>1</mn></msub><mo>=</mo><mi>i</mi><mo stretchy="false">|</mo><mi>λ</mi><msup><mrow></mrow><mi>n</mi></msup><mo stretchy="false">)</mo></mrow><mrow><mi>Ρ</mi><mo stretchy="false">(</mo><mi>Ο</mi><mo stretchy="false">|</mo><mi>λ</mi><msup><mrow></mrow><mi>n</mi></msup><mo stretchy="false">)</mo></mrow></mfrac><mo>,</mo><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mo>⋯</mo><mo>,</mo><mi>Ν</mi></mtd></mtr><mtr><mtd><mi>α</mi><msubsup><mrow></mrow><mrow><mi>i</mi><mi>j</mi></mrow><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msubsup><mo>=</mo><mfrac><mrow><mstyle displaystyle="true"><munderover><mo>∑</mo><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>Τ</mi><mo>-</mo><mn>1</mn></mrow></munderover><mi>Ρ</mi></mstyle><mo stretchy="false">(</mo><mi>Ο</mi><mo>,</mo><mi>s</mi><msub><mrow></mrow><mi>t</mi></msub><mo>=</mo><mi>i</mi><mo>,</mo><mi>s</mi><msub><mrow></mrow><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><mi>j</mi><mo stretchy="false">|</mo><mi>λ</mi><msup><mrow></mrow><mi>n</mi></msup><mo stretchy="false">)</mo></mrow><mrow><mstyle displaystyle="true"><munderover><mo>∑</mo><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>Τ</mi><mo>-</mo><mn>1</mn></mrow></munderover><mi>Ρ</mi></mstyle><mo stretchy="false">(</mo><mi>Ο</mi><mo>,</mo><mi>s</mi><msub><mrow></mrow><mi>t</mi></msub><mo>=</mo><mi>i</mi><mo stretchy="false">|</mo><mi>λ</mi><msup><mrow></mrow><mi>n</mi></msup><mo stretchy="false">)</mo></mrow></mfrac></mtd></mtr><mtr><mtd><mi>b</mi><msub><mrow></mrow><mi>j</mi></msub><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo><msup><mrow></mrow><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msup><mo>=</mo><mfrac><mrow><mstyle displaystyle="true"><munderover><mo>∑</mo><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mi>Τ</mi></munderover><mi>Ρ</mi></mstyle><mo stretchy="false">(</mo><mi>Ο</mi><mo>,</mo><mi>s</mi><msub><mrow></mrow><mi>t</mi></msub><mo>=</mo><mi>j</mi><mo stretchy="false">|</mo><mi>λ</mi><msup><mrow></mrow><mi>n</mi></msup><mo stretchy="false">)</mo><mi>δ</mi><msub><mrow></mrow><mrow><mi>t</mi><mo>,</mo><mi>k</mi></mrow></msub></mrow><mrow><mstyle displaystyle="true"><munderover><mo>∑</mo><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mi>Τ</mi></munderover><mi>Ρ</mi></mstyle><mo stretchy="false">(</mo><mi>Ο</mi><mo>,</mo><mi>s</mi><msub><mrow></mrow><mi>t</mi></msub><mo>=</mo><mi>j</mi><mo stretchy="false">|</mo><mi>λ</mi><msup><mrow></mrow><mi>n</mi></msup><mo stretchy="false">)</mo></mrow></mfrac><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mrow><mtext> </mtext><mtext> </mtext><mtext> </mtext></mrow><mo stretchy="false">(</mo><mn>8</mn><mo stretchy="false">)</mo></mtd></mtr><mtr><mtd><mi>λ</mi><msup><mrow></mrow><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msup><mo>=</mo><mo stretchy="false">(</mo><mi>π</mi><msup><mrow></mrow><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msup><mo>,</mo><mi mathvariant="bold-italic">A</mi><msup><mrow></mrow><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msup><mo>,</mo><mi mathvariant="bold-italic">B</mi><msup><mrow></mrow><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msup><mo stretchy="false">)</mo><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mrow><mtext> </mtext><mtext> </mtext><mtext> </mtext></mrow><mo stretchy="false">(</mo><mn>9</mn><mo stretchy="false">)</mo></mtd></mtr></mtable></math></mathml>
                    </p>
                </div>
                <div class="p1">
                    <p id="173">输出最终模型:</p>
                </div>
                <div class="p1">
                    <p id="174" class="code-formula">
                        <mathml id="174"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>λ</mi><msup><mrow></mrow><mo>*</mo></msup><mo>=</mo><mo stretchy="false">(</mo><mover><mstyle mathsize="140%" displaystyle="true"><mi>π</mi></mstyle><mrow><mspace width="0.25em" /><mo>^</mo></mrow></mover><mo>,</mo><mover><mstyle mathsize="140%" displaystyle="true"><mi mathvariant="bold-italic">A</mi></mstyle><mrow><mspace width="0.25em" /><mo>^</mo></mrow></mover><mo>,</mo><mover><mstyle mathsize="140%" displaystyle="true"><mi mathvariant="bold-italic">B</mi></mstyle><mrow><mspace width="0.25em" /><mo>^</mo></mrow></mover><mo stretchy="false">)</mo></mrow></math></mathml>
                    </p>
                </div>
                <div class="p1">
                    <p id="175">基于HMM的恶意域名检测算法具体流程如图3所示。</p>
                </div>
                <div class="area_img" id="176">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JSJC201909026_176.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4rdTg2cEF4V2xrZkdSczJ5ODhxaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图3 基于HMM的恶意域名检测算法流程" src="Detail/GetImg?filename=images/JSJC201909026_176.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4rdTg2cEF4V2xrZkdSczJ5ODhxaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit"><b>图3 基于HMM的恶意域名检测算法流程</b>  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JSJC201909026_176.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4rdTg2cEF4V2xrZkdSczJ5ODhxaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <h3 id="177" name="177" class="anchor-tag">3 实验结果与分析</h3>
                <h4 class="anchor-tag" id="178" name="178">3.1 实验准备</h4>
                <div class="p1">
                    <p id="179">实验准备工作主要包括:从DNS服务器中获取DNS日志,从不同数据源搜集善恶域名集,部署Hadoop和Spark集群。本文选取准确率和召回率2个指标来评估基于HMM的恶意域名识别系统的检测效果。其中,准确率指所有正确被检索的域名占所有实际被检索的域名比例,召回率指所有正确被检索的域名占所有应该被检索的域名比例。</p>
                </div>
                <h4 class="anchor-tag" id="180" name="180">3.1.1 善恶域名集获取</h4>
                <div class="p1">
                    <p id="181">在域名检测系统中,为形成高质量的训练集并提高检测算法的效果,需要搜集一个包含范围较广且数量较多的善恶域名集。本文从malware.com、Malware Domain List等不同类型的数据源搜集大量的恶意域名,另外选取一些为逃避域名黑名单检测而利用随机字符生成的C &amp; C域名。善意域名来自于Alexa网站中几乎涵盖各行业、各种类中排名靠前的可信赖域名。</p>
                </div>
                <h4 class="anchor-tag" id="182" name="182">3.1.2 测试环境</h4>
                <div class="p1">
                    <p id="183">由于Spark平台没有存储大文件的能力,但本文系统的检测需要处理海量数据,因此引入Hadoop的分布式文件系统hdfs。同时,利用Hadoop YARN使集群具备良好的扩展性。综上,本次实验需要搭建一个Spark集群和一个Hadoop集群,在Spark集群下,一台PC作为master节点,负责集群的资源管理,另外3台PC作为Slave节点,用于执行检测模型的计算任务。</p>
                </div>
                <h4 class="anchor-tag" id="184" name="184">3.2 HMM模型下的分类效果测试</h4>
                <h4 class="anchor-tag" id="185" name="185">3.2.1 HMM模型参数初始化</h4>
                <div class="p1">
                    <p id="186">在实验中利用HMM模型进行域名检测时,根据域名的不同恶意类型,将其初始隐状态划分为5类,主要包括:基于网络钓鱼,基于Domain-Flux,基于Fast-Flux,基于混合Domain-Flux和Fast-Flux,基于善意域名,分别用<i>e</i><sub>1</sub>～<i>e</i><sub>5</sub>进行表示。观测序列为12个从DNS日志中提取出的域名特征值。对HMM模型进行参数训练时,初始值的选取非常重要,其能大幅提高模型的计算准确性和效率,本文根据域名的危害程度给出HMM模型的初始化参数。域名隐状态转移概率矩阵为:</p>
                </div>
                <div class="p1">
                    <p id="187" class="code-formula">
                        <mathml id="187"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi mathvariant="bold-italic">A</mi><mo>=</mo><mrow><mo>(</mo><mrow><mtable><mtr><mtd><mn>0</mn><mo>.</mo><mn>7</mn><mn>2</mn><mn>0</mn></mtd><mtd><mn>0</mn><mo>.</mo><mn>2</mn><mn>1</mn><mn>0</mn></mtd><mtd><mn>0</mn><mo>.</mo><mn>0</mn><mn>3</mn><mn>0</mn></mtd><mtd><mn>0</mn><mo>.</mo><mn>0</mn><mn>0</mn><mn>2</mn></mtd><mtd><mn>0</mn><mo>.</mo><mn>0</mn><mn>0</mn><mn>1</mn></mtd></mtr><mtr><mtd><mn>0</mn><mo>.</mo><mn>0</mn><mn>0</mn><mn>1</mn></mtd><mtd><mn>0</mn><mo>.</mo><mn>7</mn><mn>0</mn><mn>0</mn></mtd><mtd><mn>0</mn><mo>.</mo><mn>1</mn><mn>0</mn><mn>0</mn></mtd><mtd><mn>0</mn><mo>.</mo><mn>0</mn><mn>1</mn><mn>0</mn></mtd><mtd><mn>0</mn><mo>.</mo><mn>0</mn><mn>0</mn><mn>8</mn></mtd></mtr><mtr><mtd><mn>0</mn><mo>.</mo><mn>0</mn><mn>0</mn><mn>0</mn></mtd><mtd><mn>0</mn><mo>.</mo><mn>0</mn><mn>0</mn><mn>0</mn></mtd><mtd><mn>0</mn><mo>.</mo><mn>7</mn><mn>3</mn><mn>0</mn></mtd><mtd><mn>0</mn><mo>.</mo><mn>0</mn><mn>5</mn><mn>0</mn></mtd><mtd><mn>0</mn><mo>.</mo><mn>0</mn><mn>1</mn><mn>9</mn></mtd></mtr><mtr><mtd><mn>0</mn><mo>.</mo><mn>0</mn><mn>0</mn><mn>0</mn></mtd><mtd><mn>0</mn><mo>.</mo><mn>0</mn><mn>0</mn><mn>0</mn></mtd><mtd><mn>0</mn><mo>.</mo><mn>0</mn><mn>0</mn><mn>0</mn></mtd><mtd><mn>0</mn><mo>.</mo><mn>7</mn><mn>5</mn><mn>0</mn></mtd><mtd><mn>0</mn><mo>.</mo><mn>1</mn><mn>6</mn><mn>9</mn></mtd></mtr><mtr><mtd><mn>0</mn><mo>.</mo><mn>0</mn><mn>0</mn><mn>0</mn></mtd><mtd><mn>0</mn><mo>.</mo><mn>0</mn><mn>0</mn><mn>0</mn></mtd><mtd><mn>0</mn><mo>.</mo><mn>0</mn><mn>0</mn><mn>0</mn></mtd><mtd><mn>0</mn><mo>.</mo><mn>0</mn><mn>0</mn><mn>0</mn></mtd><mtd><mn>0</mn><mo>.</mo><mn>9</mn><mn>9</mn><mn>9</mn></mtd></mtr></mtable></mrow><mo>)</mo></mrow></mrow></math></mathml>
                    </p>
                </div>
                <div class="p1">
                    <p id="188">从状态转移概率矩阵<i><b>A</b></i>可以看出,当前域名危害状态向低危险状态转移的概率非常低,向相邻较高级别危害状态转移的概率较高,维持在本状态的概率最大。混淆矩阵概率分布为:</p>
                </div>
                <div class="p1">
                    <p id="189" class="code-formula">
                        <mathml id="189"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtable columnalign="left"><mtr><mtd><mi mathvariant="bold-italic">B</mi><mo>=</mo><mrow><mo>(</mo><mrow><mtable><mtr><mtd><mn>0</mn><mo>.</mo><mn>2</mn><mn>1</mn></mtd><mtd><mn>0</mn><mo>.</mo><mn>2</mn><mn>0</mn></mtd><mtd><mn>0</mn><mo>.</mo><mn>2</mn><mn>3</mn></mtd><mtd><mn>0</mn><mo>.</mo><mn>1</mn><mn>0</mn></mtd><mtd><mn>0</mn><mo>.</mo><mn>0</mn><mn>7</mn></mtd><mtd><mn>0</mn><mo>.</mo><mn>0</mn><mn>4</mn></mtd><mtd><mn>0</mn><mo>.</mo><mn>0</mn><mn>6</mn></mtd><mtd><mn>0</mn><mo>.</mo><mn>0</mn><mn>2</mn></mtd><mtd><mn>0</mn><mo>.</mo><mn>0</mn><mn>1</mn></mtd><mtd><mn>0</mn><mo>.</mo><mn>1</mn><mn>2</mn></mtd><mtd><mn>0</mn><mo>.</mo><mn>0</mn><mn>8</mn></mtd><mtd><mn>0</mn><mo>.</mo><mn>1</mn><mn>6</mn></mtd></mtr><mtr><mtd><mn>0</mn><mo>.</mo><mn>0</mn><mn>8</mn></mtd><mtd><mn>0</mn><mo>.</mo><mn>1</mn><mn>3</mn></mtd><mtd><mn>0</mn><mo>.</mo><mn>2</mn><mn>1</mn></mtd><mtd><mn>0</mn><mo>.</mo><mn>1</mn><mn>8</mn></mtd><mtd><mn>0</mn><mo>.</mo><mn>1</mn><mn>6</mn></mtd><mtd><mn>0</mn><mo>.</mo><mn>1</mn><mn>2</mn></mtd><mtd><mn>0</mn><mo>.</mo><mn>0</mn><mn>3</mn></mtd><mtd><mn>0</mn><mo>.</mo><mn>1</mn><mn>5</mn></mtd><mtd><mn>0</mn><mo>.</mo><mn>0</mn><mn>7</mn></mtd><mtd><mn>0</mn><mo>.</mo><mn>1</mn><mn>2</mn></mtd><mtd><mn>0</mn><mo>.</mo><mn>1</mn><mn>0</mn></mtd><mtd><mn>0</mn><mo>.</mo><mn>2</mn><mn>1</mn></mtd></mtr><mtr><mtd><mn>0</mn><mo>.</mo><mn>0</mn><mn>1</mn></mtd><mtd><mn>0</mn><mo>.</mo><mn>0</mn><mn>2</mn></mtd><mtd><mn>0</mn><mo>.</mo><mn>0</mn><mn>1</mn></mtd><mtd><mn>0</mn><mo>.</mo><mn>0</mn><mn>5</mn></mtd><mtd><mn>0</mn><mo>.</mo><mn>2</mn><mn>1</mn></mtd><mtd><mn>0</mn><mo>.</mo><mn>1</mn><mn>5</mn></mtd><mtd><mn>0</mn><mo>.</mo><mn>1</mn><mn>2</mn></mtd><mtd><mn>0</mn><mo>.</mo><mn>1</mn><mn>0</mn></mtd><mtd><mn>0</mn><mo>.</mo><mn>2</mn><mn>0</mn></mtd><mtd><mn>0</mn><mo>.</mo><mn>1</mn><mn>3</mn></mtd><mtd><mn>0</mn><mo>.</mo><mn>1</mn><mn>0</mn></mtd><mtd><mn>0</mn><mo>.</mo><mn>0</mn><mn>6</mn></mtd></mtr><mtr><mtd><mn>0</mn><mo>.</mo><mn>0</mn><mn>1</mn></mtd><mtd><mn>0</mn><mo>.</mo><mn>0</mn><mn>1</mn></mtd><mtd><mn>0</mn><mo>.</mo><mn>1</mn><mn>5</mn></mtd><mtd><mn>0</mn><mo>.</mo><mn>0</mn><mn>3</mn></mtd><mtd><mn>0</mn><mo>.</mo><mn>0</mn><mn>8</mn></mtd><mtd><mn>0</mn><mo>.</mo><mn>1</mn><mn>3</mn></mtd><mtd><mn>0</mn><mo>.</mo><mn>0</mn><mn>7</mn></mtd><mtd><mn>0</mn><mo>.</mo><mn>1</mn><mn>8</mn></mtd><mtd><mn>0</mn><mo>.</mo><mn>1</mn><mn>2</mn></mtd><mtd><mn>0</mn><mo>.</mo><mn>0</mn><mn>8</mn></mtd><mtd><mn>0</mn><mo>.</mo><mn>2</mn><mn>1</mn></mtd><mtd><mn>0</mn><mo>.</mo><mn>0</mn><mn>3</mn></mtd></mtr><mtr><mtd><mn>0</mn><mo>.</mo><mn>0</mn><mn>2</mn></mtd><mtd><mn>0</mn><mo>.</mo><mn>0</mn><mn>1</mn></mtd><mtd><mn>0</mn><mo>.</mo><mn>0</mn><mn>3</mn></mtd><mtd><mn>0</mn><mo>.</mo><mn>0</mn><mn>5</mn></mtd><mtd><mn>0</mn><mo>.</mo><mn>0</mn><mn>4</mn></mtd><mtd><mn>0</mn><mo>.</mo><mn>1</mn><mn>0</mn></mtd><mtd><mn>0</mn><mo>.</mo><mn>0</mn><mn>6</mn></mtd><mtd><mn>0</mn><mo>.</mo><mn>1</mn><mn>2</mn></mtd><mtd><mn>0</mn><mo>.</mo><mn>0</mn><mn>7</mn></mtd><mtd><mn>0</mn><mo>.</mo><mn>1</mn><mn>1</mn></mtd><mtd><mn>0</mn><mo>.</mo><mn>2</mn><mn>0</mn></mtd><mtd><mn>0</mn><mo>.</mo><mn>1</mn><mn>2</mn></mtd></mtr></mtable></mrow><mo>)</mo></mrow></mtd></mtr><mtr><mtd></mtd></mtr><mtr><mtd></mtd></mtr></mtable></math></mathml>
                    </p>
                </div>
                <div class="p1">
                    <p id="190">混淆矩阵概率分布表示在已知域名隐状态的情况下观测序列出现的概率。</p>
                </div>
                <div class="p1">
                    <p id="191">初始化状态概率分布为:</p>
                </div>
                <div class="p1">
                    <p id="192"><i>π</i>={<i>π</i><sub><i>e</i></sub><sub>1</sub>,<i>π</i><sub><i>e</i></sub><sub>2</sub>,<i>π</i><sub><i>e</i></sub><sub>3</sub>,<i>π</i><sub><i>e</i></sub><sub>4</sub>,<i>π</i><sub><i>e</i></sub><sub>5</sub>}=</p>
                </div>
                <div class="p1">
                    <p id="193">{0.42,0.21,0.13,0.07,0.01}</p>
                </div>
                <div class="p1">
                    <p id="194">从初始概率分布可以看出,域名危害强度最高的状态<i>e</i><sub>5</sub>出现的概率很低,而危害强度最低的<i>e</i><sub>1</sub>状态出现的概率相对较高,说明大部分域名最初均处于比较安全的状态。</p>
                </div>
                <div class="p1">
                    <p id="195">在模型初始化后,将初始概率<i>π</i>、转移概率矩阵<i><b>A</b></i>、混淆矩阵<i><b>B</b></i>带入Baum-Welch算法(式(6)～式(8))中进行反复迭代,求解出最优的模型参数,然后通过Viterbi算法计算出域名最可能的隐状态。</p>
                </div>
                <h4 class="anchor-tag" id="196" name="196">3.2.2 原始参数下的分类器效果测试</h4>
                <div class="p1">
                    <p id="197">Baum-Welch算法利用EM算法的思想,通过反复迭代使其达到局部最优<citation id="232" type="reference"><link href="45" rel="bibliography" /><sup>[<a class="sup">22</a>]</sup></citation>。若能将<i>λ</i>=(<i>π</i>,<i><b>A</b></i>,<i>B</i>)进行较好的参数初始化,就能得到使观测数据概率最大的全局最优解。经研究分析,初始概率<i>π</i>和转移概率矩阵<i><b>A</b></i>的初值对模型的影响较小,可通过随机选取的方法进行初始化,影响较大的是混淆矩阵<i><b>B</b></i>的初始概率值选取。因此,本文首先利用K-means方法进行归类划分<citation id="233" type="reference"><link href="47" rel="bibliography" /><link href="49" rel="bibliography" /><sup>[<a class="sup">23</a>,<a class="sup">24</a>]</sup></citation>,然后根据划分结果计算出混淆矩阵<i><b>B</b></i>的初值。用Spark集群建立模型,记录下模型的检测次数以及分类结果的准确率、召回率。原始参数下的测试结果如表2、图4所示。</p>
                </div>
                <div class="area_img" id="198">
                    <p class="img_tit"><b>表2 原始参数下的模型分类结果</b> <a class="downexcel" onclick="DownLoadReportExcel(this)">导出到EXCEL</a></p>
                    <p class="img_tit"></p>
                    <p class="img_note"></p>
                    <table id="198" border="1"><tr><td>检测次数</td><td>数据量(域名数)</td><td>准确率/%</td><td>召回率/%</td></tr><tr><td>1</td><td>17 200</td><td>80.32</td><td>82.78</td></tr><tr><td><br />2</td><td>26 906</td><td>83.51</td><td>80.72</td></tr><tr><td><br />3</td><td>37 809</td><td>86.79</td><td>83.89</td></tr><tr><td><br />4</td><td>48 976</td><td>81.86</td><td>79.86</td></tr><tr><td><br />5</td><td>57 680</td><td>90.32</td><td>81.57</td></tr><tr><td><br />6</td><td>65 789</td><td>82.57</td><td>80.78</td></tr><tr><td><br />7</td><td>78 970</td><td>89.85</td><td>84.67</td></tr><tr><td><br />8</td><td>89 070</td><td>84.62</td><td>87.64</td></tr><tr><td><br />9</td><td>90 789</td><td>91.52</td><td>89.32</td></tr><tr><td><br />10</td><td>109 080</td><td>87.76</td><td>85.87</td></tr></table>
                    <form name="form" action="/kxreader/Detail/DownloadReportExcel" method="POST" style="display:inline">
                        <input type="hidden" name="hidTable" value="" />
                        <input type="hidden" name="hidFileName" value="" />
                    </form>
                    <p class="img_note"></p>
                    <p class="img_note"></p>
                </div>
                <div class="area_img" id="199">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JSJC201909026_199.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4rdTg2cEF4V2xrZkdSczJ5ODhxaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图4 原始参数下的模型准确率与召回率" src="Detail/GetImg?filename=images/JSJC201909026_199.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4rdTg2cEF4V2xrZkdSczJ5ODhxaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit"><b>图4 原始参数下的模型准确率与召回率</b>  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JSJC201909026_199.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4rdTg2cEF4V2xrZkdSczJ5ODhxaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="p1">
                    <p id="200">从表2、图4可以看出,原始参数下HMM模型在测试集中对恶意域名分类的准确率和召回率均基本达标,但并未达到理想效果。因此,有必要通过聚类方法对观测概率初始值进行调整,以提升准确率和召回率。</p>
                </div>
                <h4 class="anchor-tag" id="201" name="201">3.2.3 调优参数下的分类器效果测试</h4>
                <div class="p1">
                    <p id="202">通过K均值聚类方法对观测概率矩阵初始值进行划分,在初始值选取后,使用训练集和测试集分别进行模型训练和效果检测,结果如图5所示。从图5可以看出,进行参数优化后,模型的分类准确率和召回率均有显著提升。因此,可以初步判断HMM模型在经过观测概率矩阵的初始值调优后可以提高恶意域名的检测效果。</p>
                </div>
                <div class="area_img" id="203">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JSJC201909026_203.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4rdTg2cEF4V2xrZkdSczJ5ODhxaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图5 调优参数下的模型准确率与召回率" src="Detail/GetImg?filename=images/JSJC201909026_203.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4rdTg2cEF4V2xrZkdSczJ5ODhxaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit"><b>图5 调优参数下的模型准确率与召回率</b>  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JSJC201909026_203.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4rdTg2cEF4V2xrZkdSczJ5ODhxaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <h4 class="anchor-tag" id="204" name="204">3.2.4 HMM模型与RF模型的分类效果对比</h4>
                <div class="p1">
                    <p id="205">在完成观测值的初始参数调优后,本文HMM模型的分类效果得到提升。在机器学习领域存在众多优秀的分类模型,RF模型为其中的典型代表。利用RF模型训练分类器的具体步骤如下:</p>
                </div>
                <div class="p1">
                    <p id="206">1)从初始训练集中有放回地重复随机抽取<i>n</i>个训练样本集。</p>
                </div>
                <div class="p1">
                    <p id="207">2)根据从所有域名特征中随机抽取的<i>k</i>个特征,对新抽取的样本集建立决策树模型。</p>
                </div>
                <div class="p1">
                    <p id="208">3)循环进行以上操作步骤<i>m</i>次,最后生成由<i>m</i>棵决策树组成的随机森林。</p>
                </div>
                <div class="p1">
                    <p id="209">4)按照对森林中各决策树的投票数量来决定新数据分类。</p>
                </div>
                <div class="p1">
                    <p id="210">在保持检测次数和相应域名数据量不变的前提下,使用训练集和测试集分别进行模型训练和效果检测。HMM模型与RF模型的分类准确率和召回率对比结果分别如图6、图7所示。</p>
                </div>
                <div class="area_img" id="211">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JSJC201909026_211.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4rdTg2cEF4V2xrZkdSczJ5ODhxaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图6 2种模型的分类准确率对比" src="Detail/GetImg?filename=images/JSJC201909026_211.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4rdTg2cEF4V2xrZkdSczJ5ODhxaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit"><b>图6 2种模型的分类准确率对比</b>  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JSJC201909026_211.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4rdTg2cEF4V2xrZkdSczJ5ODhxaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="area_img" id="212">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JSJC201909026_212.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4rdTg2cEF4V2xrZkdSczJ5ODhxaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图7 2种模型的分类召回率对比" src="Detail/GetImg?filename=images/JSJC201909026_212.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4rdTg2cEF4V2xrZkdSczJ5ODhxaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit"><b>图7 2种模型的分类召回率对比</b>  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JSJC201909026_212.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4rdTg2cEF4V2xrZkdSczJ5ODhxaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="p1">
                    <p id="213">由图6、图7可以看出,HMM模型的准确率与召回率均优于RF模型,即HMM能够获得更加精确的检测结果。</p>
                </div>
                <h3 id="214" name="214" class="anchor-tag">4 结束语</h3>
                <div class="p1">
                    <p id="215">本文提出一种在Spark平台上通过HMM模型进行恶意域名分类的方法。利用Spark基于内存的运算速度优势和对实时数据流进行处理的特性,结合HMM模型中的Baum-Welch算法和Viterbi算法进行精确分类,以提升检测系统的识别效果。实验结果表明,该方法可以提高分类结果的准确率与召回率。</p>
                </div>

        <!--brief end-->
        
        <!--conten left  end-->
        <!--增强附件-->
        

        <!--reference start-->
            <div class="reference anchor-tag" id="a_bibliography">
                    <h3>参考文献</h3>
                                        <p id="3">
                            <a id="bibliography_1" >
                                    <b>[1]</b>
                                 中国互联网络信息中心.第41次中国互联网络发展状况统计报告[R/OL].[2018-04-20].http://www.cac.gov.cn/2018-01/31/c_1122347026.htm.
                            </a>
                        </p>
                        <p id="5">
                            <a id="bibliography_2" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Malicious domain detection based on machine learning">

                                <b>[2]</b> YAN Yida,LIU Zhenyan,ZHONG Junwei,et al.Malicious domain detection based on machine learning[EB/OL].[2018-04-25].http://dpi-proceedings.com/index.php/dtcse/article/view/19866.
                            </a>
                        </p>
                        <p id="7">
                            <a id="bibliography_3" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Malicious domain name detection based on extreme machine learning">

                                <b>[3]</b> SHI Yong,CHEN Gong,LI Juntao.Malicious domain name detection based on extreme machine learning[J].Neural Processing Letters,2018,48(3):1347-1357.
                            </a>
                        </p>
                        <p id="9">
                            <a id="bibliography_4" target="_blank" href="/kcms/detail/detail.aspx?dbcode=SSJD&amp;filename=SSJDCB1A3C57B3D457D749F995631A0AF04A&amp;v=MjM0MTBQaVJiN3VDT052RlNpV1dyN0pJRnBtYUJ1SFlmT0dRbGZDcGJRMzVOMWh3N3kveGFzPU5qN0Jhc0RLSDZEUDNJcENGdWg3Q0hrK3V4RVg0MGwwUVhya3J4TkVlYw==&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4rdTg2cEF4V2xrZkdSczJ5ODhxaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[4]</b> ALIEYAN K,ALMOMANI A,MANASRAH A,et al.A survey of botnet detection based on DNS[J].Neural Computing and Applications,2017,28(7):1-18.
                            </a>
                        </p>
                        <p id="11">
                            <a id="bibliography_5" target="_blank" href="http://scholar.cnki.net/result.aspx?q=A Technique for the Botnet Detection Based on DNS-Traffic Analysis">

                                <b>[5]</b> POMOROVA O,SAVENKO O,LYSENKO S,et al.A technique for the botnet detection based on DNS-traffic analysis[C]//Proceedings of International Conference on Computer Networks.Berlin,Germany:Springer,2015:127-138.
                            </a>
                        </p>
                        <p id="13">
                            <a id="bibliography_6" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JSJC201611029&amp;v=MTEyODc0SDlmTnJvOUhiWVFLREg4NHZSNFQ2ajU0TzN6cXFCdEdGckNVUkxPZVplUnJGeS9oVTdyTEx6N0JiYkc=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4rdTg2cEF4V2xrZkdSczJ5ODhxaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[6]</b> 马旸,强小辉,蔡冰,等.大规模网络中基于集成学习的恶意域名检测[J].计算机工程,2016,42(11):170-176.
                            </a>
                        </p>
                        <p id="15">
                            <a id="bibliography_7" target="_blank" href="/kcms/detail/detail.aspx?dbcode=SJES&amp;filename=SJES14061600033911&amp;v=MjczMThadUh5am1VTHJJSjFvVWJ4RT1OaWZPZmJLOEh0Zk5xWTlGWk9nTUJYMDRvQk1UNlQ0UFFIL2lyUmRHZXJxUVRNbndaZQ==&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4rdTg2cEF4V2xrZkdSczJ5ODhxaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[7]</b> SINGH K,GUNTUKU S C,THAKUR A,et al.Big data analytics framework for peer-to-peer botnet detection using random forests[J].Information Sciences,2014,278(19):488-497.
                            </a>
                        </p>
                        <p id="17">
                            <a id="bibliography_8" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Spark:Cluster Computing With Working Sets">

                                <b>[8]</b> ZAHARIA M,CHOWDHURY M,FRANKLIN M J,et al.Spark:cluster computing with working sets[C]//Proceedings of USENIX Conference on Hot Topics in Cloud Computing.San Diego,USA:USENIX Association,2010:2-10.
                            </a>
                        </p>
                        <p id="19">
                            <a id="bibliography_9" target="_blank" href="http://scholar.cnki.net/result.aspx?q=MLlib:Machine learning in apache spark">

                                <b>[9]</b> MENG X,BRADLEY J,YAVUZ B,et al.MLlib:machine learning in Apache spark[J].Journal of Machine Learning Research,2016,17(1):1235-1241.
                            </a>
                        </p>
                        <p id="21">
                            <a id="bibliography_10" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Big data management processing with Hadoop MapReduce and spark technology:A comparison">

                                <b>[10]</b> VERMA A,MANSURI A H,JAIN N.Big data manage-ment processing with Hadoop MapReduce and spark technology:a comparison[C]//Proceedings of 2016 Symposium on Colossal Data Analysis and Networking.Washington D.C.,USA:IEEE Press,2016:1-4.
                            </a>
                        </p>
                        <p id="23">
                            <a id="bibliography_11" target="_blank" href="/kcms/detail/detail.aspx?dbcode=SJST&amp;filename=SJST14112600634565&amp;v=MjMxMzZZdWdMQ1hvOG9CTVQ2VDRQUUgvaXJSZEdlcnFRVE1ud1plWnVIeWptVUxySUoxb1VieEU9TmlmWWVySzhIOURPcVk5Rg==&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4rdTg2cEF4V2xrZkdSczJ5ODhxaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[11]</b> BAUM L E,PETRIE T,SOULES G,et al.A maximization technique occurring in the statistical analysis of probabilistic functions of Markov chains[J].Annals of Mathematical Statistics,1970,41(1):164-171.
                            </a>
                        </p>
                        <p id="25">
                            <a id="bibliography_12" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=XTYY201007062&amp;v=MDQ0MTJPM3pxcUJ0R0ZyQ1VSTE9lWmVSckZ5L2hVN3JMUFRuU2Q3RzRIOUhNcUk5RFpvUUtESDg0dlI0VDZqNTQ=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4rdTg2cEF4V2xrZkdSczJ5ODhxaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[12]</b> 朱明,郭春生.隐马尔可夫模型及其最新应用与发展[J].计算机系统应用,2010,19(7):255-259,216.
                            </a>
                        </p>
                        <p id="27">
                            <a id="bibliography_13" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=ZDCJ201106013&amp;v=MDA0NTh0R0ZyQ1VSTE9lWmVSckZ5L2hVN3JMUHluSVpMRzRIOURNcVk5RVo0UUtESDg0dlI0VDZqNTRPM3pxcUI=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4rdTg2cEF4V2xrZkdSczJ5ODhxaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[13]</b> 苏文胜,王奉涛,朱泓,等.双树复小波域隐Markov树模型降噪及在机械故障诊断中的应用[J].振动与冲击,2011,30(6):47-52.
                            </a>
                        </p>
                        <p id="29">
                            <a id="bibliography_14" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CBBD&amp;filename=9787302275954001&amp;v=MTU1Mjlidm5LcmlmWnU5dUZDdmdVN2pNSUZzWFhGcXpHYkM0SE5QTHFvWkFZT3NQRFJNOHp4VVNtRGQ5U0g3bjN4RTlm&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4rdTg2cEF4V2xrZkdSczJ5ODhxaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[14]</b> 李航.统计学习方法[M].北京:清华大学出版社,2012.
                            </a>
                        </p>
                        <p id="31">
                            <a id="bibliography_15" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JYXH201509013&amp;v=MTcwNTc0UUtESDg0dlI0VDZqNTRPM3pxcUJ0R0ZyQ1VSTE9lWmVSckZ5L2hVN3JMTHpUVFpyRzRIOVRNcG85RVo=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4rdTg2cEF4V2xrZkdSczJ5ODhxaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[15]</b> 杨安驹,杨云,周嫒嫒,等.基于隐马尔科夫模型的融合推荐算法[J].计算机与现代化,2015(9):60-65.
                            </a>
                        </p>
                        <p id="33">
                            <a id="bibliography_16" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Hidden Markov models and neural networks for faultdetection in dynamic systems">

                                <b>[16]</b> SMYTH P.Hidden Markov models and neural networks for fault detection in dynamic systems[C]//Proceedings of 1993 IEEE-SP Workshop on Neural Networks for Signal Processing.Washington D.C.,USA:IEEE Press,1993:582-592.
                            </a>
                        </p>
                        <p id="35">
                            <a id="bibliography_17" target="_blank" href="http://scholar.cnki.net/result.aspx?q=A personal history of the Viterbi algorithm">

                                <b>[17]</b> VITERBI A J.A personal history of the Viterbi algorithm[J].IEEE Signal Processing Magazine,2006,23(4):120-142.
                            </a>
                        </p>
                        <p id="37">
                            <a id="bibliography_18" target="_blank" href="http://scholar.cnki.net/result.aspx?q=The viterbi algorithm">

                                <b>[18]</b> JR G D F.The Viterbi algorithm[J].Proceedings of the IEEE,1973,61(3):268-278.
                            </a>
                        </p>
                        <p id="39">
                            <a id="bibliography_19" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Hidden Markov models and the Baum-Welch algorithm">

                                <b>[19]</b> WELCH L R.Hidden Markov models and the Baum-Welch algorithm[J].IEEE Information Theory Society News Letter,2003,53(2):194-211.
                            </a>
                        </p>
                        <p id="41">
                            <a id="bibliography_20" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CMFD&amp;filename=1015909384.nh&amp;v=MTQ0NDdlWmVSckZ5L2hVN3JMVkYyNkc3cTRGOUxFcTVFYlBJUUtESDg0dlI0VDZqNTRPM3pxcUJ0R0ZyQ1VSTE8=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4rdTg2cEF4V2xrZkdSczJ5ODhxaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[20]</b> 张峻飞.Hadoop环境下的恶意域名检测方案研究[D].武汉:华中科技大学,2015.
                            </a>
                        </p>
                        <p id="43">
                            <a id="bibliography_21" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CMFD&amp;filename=1016744958.nh&amp;v=MzIxNTN5L2hVN3JMVkYyNkdMUzhHdGpKcDVFYlBJUUtESDg0dlI0VDZqNTRPM3pxcUJ0R0ZyQ1VSTE9lWmVSckY=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4rdTg2cEF4V2xrZkdSczJ5ODhxaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[21]</b> 赵成龙.一种检测恶意域名的增量并行SVM算法研究与实现[D].武汉:华中科技大学,2016.
                            </a>
                        </p>
                        <p id="45">
                            <a id="bibliography_22" target="_blank" href="http://scholar.cnki.net/result.aspx?q=The Expectation-Maximization Algorithm">

                                <b>[22]</b> MOLENBERGHS G,KENWARD M G.The expectation-maximization algorithm[M]//MOLENBERGHS G,KENWARD M G.Missing data in clinical studies.[S.l.]:Wiley-Blackwell,2007.
                            </a>
                        </p>
                        <p id="47">
                            <a id="bibliography_23" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CDFD&amp;filename=1014268606.nh&amp;v=MTY3MTZxQnRHRnJDVVJMT2VaZVJyRnkvaFU3ckxWRjI2R3JHK0Z0Zk1xWkViUElRS0RIODR2UjRUNmo1NE8zenE=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4rdTg2cEF4V2xrZkdSczJ5ODhxaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[23]</b> 夏丽莎.基于隐马尔可夫模型的故障诊断及相关算法研究[D].武汉:华中科技大学,2014.
                            </a>
                        </p>
                        <p id="49">
                            <a id="bibliography_24" target="_blank" href="http://scholar.cnki.net/result.aspx?q=An efficient k-menas clustering algorithm: analysis and implementation">

                                <b>[24]</b> KANUNGO T,MOUNT D M,NETANYAHU N S,et al.An efficient k-means clustering algorithm:analysis and implementation[J].IEEE Transactions on Pattern Analysis and Machine Intelligence,2002,24(7):881-892.
                            </a>
                        </p>
            </div>
        <!--reference end-->
        <!--footnote start-->
        <!--footnote end-->



    </div>

        <input id="fileid" type="hidden" value="JSJC201909026" />
        <input id="dpi" type="hidden" value="300" />
    </div>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?6e967eb120601ea41b9d312166416aa6";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
</script>

    


<input id="hid_uid" name="hid_uid" type="hidden" value="WEEvREcwSlJHSldRa1Fhb09jT0lPUU4rdTg2cEF4V2xrZkdSczJ5ODhxaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
<input id="hid_kLogin_headerUrl" name="hid_kLogin_headerUrl" type="hidden" value="/KLogin/Request/GetKHeader.ashx%3Fcallback%3D%3F" />
<input id="hid_kLogin_footerUrl" name="hid_kLogin_footerUrl" type="hidden" value="/KLogin/Request/GetKFooter.ashx%3Fcallback%3D%3F" />
<div class="btn-link" style="display: none"><a target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JSJC201909026&amp;v=MjkwNjdUNmo1NE8zenFxQnRHRnJDVVJMT2VaZVJyRnkvaFU3ckxMejdCYmJHNEg5ak1wbzlIWW9RS0RIODR2UjQ=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4rdTg2cEF4V2xrZkdSczJ5ODhxaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">知网节</a></div>
<div class="popflow" id="popupTips" style="display: none;">
    <div class="popflowArr"></div>
    <div class="popflowCot">
        <div class="hd"><a href="javascript:void(0);" onclick="$('#popupTips').hide();$('#popupmsg').html('')" class="close">X</a></div>
        <div class="bd">
            <p class="mes" id="popupmsg" name="popupmsg"></p>
          
        </div>
    </div>
</div>
<input type="hidden" id="myexport" value="//kns.cnki.net" />

<input type="hidden" id="KPCAPIPATH" value="//ishufang.cnki.net" />
<input type="hidden" id="CitedTimes" value="" />
<div class="link" id="GLSearch" style="display: none;">
    <i class="icon-trangle"></i>
    <div class="inner">
        <a class="icon" id="copytext">复制</a>
        <a class="icon" target="_blank" onclick="searchCRFD(this)">工具书搜索</a>
    </div>
</div>




<input id="hidVirtualPath" name="hidVirtualPath" type="hidden" value="/kxreader" />
<script src="/kxreader/bundles/detail?v=-ULdk-c6FkZHtJA2KAXPgHnyA8mtgyPnBde_C2VZ2BY1"></script>

<script src="/kxreader/Scripts/layer.min.js" type="text/javascript"></script>

<div id="footerBox" class="rootw footer">
</div>
<script>
    if (typeof FlushLogin == 'function') {
        FlushLogin();
    }
    modifyEcpHeader(true);
</script>

<!--图片放大功能 start-->
<script src="/kxreader/bundles/imagebox?v=W4phPu9SNkGcuPeJclikuVE3PpRyIW_gnfjm_19nynI1"></script>

<script type="text/javascript">
    $(function () {
        var j = $.noConflict();
        j(function () {
            j(".zoom-in,.btn-zoomin").imgbox({
                'alignment': 'center',
                'allowMultiple': false,
                'overlayShow': true
            });
        })
    });
</script>
<!--图片放大功能 end-->
<div class="fixedbar">
    <div class="backtop hiddenV" id="backtop">
        <a id="backTopSide" href="javascript:scroll(0,0);" title=""></a>
    </div>
</div>
<script type="text/javascript" src="/kxreader/Scripts/MathJax-2.6-latest/MathJax.js?config=MML_HTMLorMML-full"></script>

</body>
</html>
