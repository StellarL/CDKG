<!DOCTYPE html>
<html>
<head>
    <title>全文阅读--XML全文阅读--中国知网</title>
    <link rel="icon" href="/kxreader/favicon.ico" />
    <link rel="shortcut Icon" href="/kxreader/favicon.ico" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="keywords" content="文献 XML KBASE CNKI 中国知网" />
    <meta name="description" content="XML文献检索" />
    <link href="/kxreader/Content/css/detail?v=qX2z2KjRAEyQiNfAbKtl7dLnsqFoQ5Jdw3TZfDf0n1k1" rel="stylesheet"/>

    <script type="text/javascript">
        var APPPATH = '/kxreader';
    </script>
</head>

<body>
    
<script type="text/javascript" src="//login.cnki.net/TopLogin/api/loginapi/get?type=top&amp;localCSS=&amp;returnurl=%2f%2fkns.cnki.net%2f%2fKXReader%2fDetail%3fTIMESTAMP%3d637138994691510000%26DBCODE%3dCJFD%26TABLEName%3dCJFDLAST2019%26FileName%3dJSJY201903022%26RESULT%3d1%26SIGN%3dmdSbg1fGRcyvLvMpVoal%252bA3fwQI%253d"></script>

<div id="headerBox" class="header">
    <div class="topbar">
        <div class="textalign">
            <a href="/kxreader/Detail?dbcode=CJFD&amp;filename=JSJY201903022&amp;align=md">
                <i class="icon-cen active" title="居中对齐"></i>
            </a>
            <a href="/kxreader/Detail?dbcode=CJFD&amp;filename=JSJY201903022&amp;align=lt">
                <i class="icon-left " title="左对齐"></i>
            </a>
        </div>
        <h6 class="free-tip"><i class="icon"></i>HTML阅读开放试用阶段，欢迎体验！</h6>
    </div>
</div>

    



<div class="btn-link" style="display: none"><a target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JSJY201903022&amp;v=MDg1NTlHRnJDVVI3cWZadVpwRmlEbVZyekFMejdCZDdHNEg5ak1ySTlIWm9RS0RIODR2UjRUNmo1NE8zenFxQnQ=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZONFRYTUhIM2RrMzdIS2psYmhhZz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">知网节</a></div>

    <div class="main">

        

    <div class="sidebar-a">
        <!--sidebar start-->
        <div class="sidenav">
            <div class="arrow"><span></span></div>
            <!--sidebar_list start-->
            <dl class="sidenav-list">
                    <dt class="tit">目录结构</dt>
                            <dd class="guide">
                                    <p><a href="#41" data-title="0 引言 ">0 引言</a><i></i></p>
                                                            </dd>
                            <dd class="guide">
                                    <p><a href="#47" data-title="1 相关理论基础 ">1 相关理论基础</a><i></i></p>
                                                                    <ul class="contentbox">
                                                <li><a href="#48" data-title="1.1 &lt;b&gt;全同态加密&lt;/b&gt;">1.1 <b>全同态加密</b></a></li>
                                                <li><a href="#58" data-title="1.2 &lt;b&gt;分层身份加密&lt;/b&gt; (HIBE) ">1.2 <b>分层身份加密</b> (HIBE) </a></li>
                                                <li><a href="#65" data-title="1.3 LWE&lt;b&gt;问题&lt;/b&gt;">1.3 LWE<b>问题</b></a></li>
                                    </ul>
                            </dd>
                            <dd class="guide">
                                    <p><a href="#83" data-title="2 分层身份基多用户全同态加密方案 ">2 分层身份基多用户全同态加密方案</a><i></i></p>
                                                                    <ul class="contentbox">
                                                <li><a href="#84" data-title="2.1 &lt;b&gt;屏蔽系统&lt;/b&gt;">2.1 <b>屏蔽系统</b></a></li>
                                                <li><a href="#103" data-title="2.2 &lt;b&gt;本文身份基多用户全同态加密方案&lt;/b&gt;">2.2 <b>本文身份基多用户全同态加密方案</b></a></li>
                                                <li><a href="#148" data-title="2.3 &lt;b&gt;同态运算&lt;/b&gt;">2.3 <b>同态运算</b></a></li>
                                    </ul>
                            </dd>
                            <dd class="guide">
                                    <p><a href="#169" data-title="3 方案分析 ">3 方案分析</a><i></i></p>
                                                                    <ul class="contentbox">
                                                <li><a href="#170" data-title="3.1 &lt;b&gt;正确性分析&lt;/b&gt;">3.1 <b>正确性分析</b></a></li>
                                                <li><a href="#186" data-title="3.2 &lt;b&gt;安全性分析&lt;/b&gt;">3.2 <b>安全性分析</b></a></li>
                                                <li><a href="#272" data-title="3.3 &lt;b&gt;性能分析&lt;/b&gt;">3.3 <b>性能分析</b></a></li>
                                    </ul>
                            </dd>
                            <dd class="guide">
                                    <p><a href="#279" data-title="4 结语 ">4 结语</a><i></i></p>
                                                            </dd>
                            <dd class="guide">
                                    <p><a href="#" data-title="文内图表 ">文内图表</a><i></i></p>
                                                                    <ul class="contentbox">
                                                <li><a href="#277" data-title="&lt;b&gt;表&lt;/b&gt;1 &lt;b&gt;本文方案与&lt;/b&gt;[GSW13]&lt;b&gt;方案和&lt;/b&gt;[CHKP10]&lt;b&gt;方案的对比&lt;/b&gt;"><b>表</b>1 <b>本文方案与</b>[GSW13]<b>方案和</b>[CHKP10]<b>方案的对比</b></a></li>
                                                <li><a href="#278" data-title="&lt;b&gt;表&lt;/b&gt;2 &lt;b&gt;本文方案与&lt;/b&gt;[CM15]&lt;b&gt;方案的比较&lt;/b&gt;"><b>表</b>2 <b>本文方案与</b>[CM15]<b>方案的比较</b></a></li>
                                    </ul>
                            </dd>
                                    <dd class="guide">
                                        <h6>
                                            <p><a href="#a_bibliography">参考文献</a> </p>
                                        </h6>
                                    </dd>

            </dl>
        </div>
        <!--sidebar end-->
        &nbsp;
        <!--此处有一空格符 勿删-->
    </div>

                <div class="sidebar-b three-collumn" style="width:0;">
            <div class="refer" style="width: 0;">
                <div class="arrow off" title="参考文献"><span></span></div>
                <div class="js-scrollbox" >
                    
                    <div class="subbox active">
                        <h4>
                            <span class="tit">参考文献</span>
                            <a class="close" href="javascript:void(0)">x</a>
                        </h4>
                        <div class="side-scroller">
                            <ul class="refer-list">
                                <li id="5">


                                    <a id="bibliography_1" title=" GENTRY C. Fully homomorphic encryption using ideal lattices [C]// STOC 2009: Proceedings of the 41st Annual ACM Symposium on Symposium on Theory of Computing. New York: ACM, 2009: 169-178." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Fully homomorphic encryption using ideal lattices">
                                        <b>[1]</b>
                                         GENTRY C. Fully homomorphic encryption using ideal lattices [C]// STOC 2009: Proceedings of the 41st Annual ACM Symposium on Symposium on Theory of Computing. New York: ACM, 2009: 169-178.
                                    </a>
                                </li>
                                <li id="7">


                                    <a id="bibliography_2" title=" GENTRY C, HALEVI S. Implementing Gentry&#39;s fully-homomorphic encryption scheme [C]// EUROCRYPT 2011: Proceedings of the 2011 Annual International Conference on the Theory and Applications of Cryptographic Techniques, LNCS 6632. Berlin: Springer, 2011: 129-148." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Implementing Gentry&amp;#39;&amp;#39;s Fully-Homomorphic Encryption Scheme">
                                        <b>[2]</b>
                                         GENTRY C, HALEVI S. Implementing Gentry&#39;s fully-homomorphic encryption scheme [C]// EUROCRYPT 2011: Proceedings of the 2011 Annual International Conference on the Theory and Applications of Cryptographic Techniques, LNCS 6632. Berlin: Springer, 2011: 129-148.
                                    </a>
                                </li>
                                <li id="9">


                                    <a id="bibliography_3" title=" BRAKERSKI Z, GENTRY C, VAIKUNTANATHAN V. (Leveled) fully homomorphic encryption without bootstrapping [C]// ITCS &#39;12: Proceedings of the 3rd Innovations in Theoretical Computer Science Conference. New York: ACM, 2012: 309-325." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=(Leveled)Fully homomorphic encryption without bootstrapping">
                                        <b>[3]</b>
                                         BRAKERSKI Z, GENTRY C, VAIKUNTANATHAN V. (Leveled) fully homomorphic encryption without bootstrapping [C]// ITCS &#39;12: Proceedings of the 3rd Innovations in Theoretical Computer Science Conference. New York: ACM, 2012: 309-325.
                                    </a>
                                </li>
                                <li id="11">


                                    <a id="bibliography_4" title=" GENTRY C, SAHAI A, WATERS B. Homomorphic encryption from learning with errors: conceptually-simpler, asymptotically-faster, attribute-based [C]// CRYPTO 2013: Proceedings of the 2013 Advances in Cryptology, LNCS 8042. Berlin: Springer, 2013: 75-92." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Homomorphic encryption from learning with errors:onceptually-simpler,asymptotically-faster,attribute-based">
                                        <b>[4]</b>
                                         GENTRY C, SAHAI A, WATERS B. Homomorphic encryption from learning with errors: conceptually-simpler, asymptotically-faster, attribute-based [C]// CRYPTO 2013: Proceedings of the 2013 Advances in Cryptology, LNCS 8042. Berlin: Springer, 2013: 75-92.
                                    </a>
                                </li>
                                <li id="13">


                                    <a id="bibliography_5" title=" 陈智罡.基于格的全同态加密研究与设计[D].南京:南京航空航天大学, 2015:23. (CHEN Z G. Research and dedign of fully homomorphic encryption based on lattice [D]. Nanjing: Nanjing University of Aeronautics and Astronautics, 2015: 23.) " target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CDFD&amp;filename=1016752032.nh&amp;v=MDc3NDlOSFByWkViUElRS0RIODR2UjRUNmo1NE8zenFxQnRHRnJDVVI3cWZadVpwRmlEbVZyekFWRjI2R0xTOUg=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZONFRYTUhIM2RrMzdIS2psYmhhZz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[5]</b>
                                         陈智罡.基于格的全同态加密研究与设计[D].南京:南京航空航天大学, 2015:23. (CHEN Z G. Research and dedign of fully homomorphic encryption based on lattice [D]. Nanjing: Nanjing University of Aeronautics and Astronautics, 2015: 23.) 
                                    </a>
                                </li>
                                <li id="15">


                                    <a id="bibliography_6" title=" CLEAR M, McGOLDRICK C. Multi-identity and multi-key leveled FHE from learning with errors [C]// Proceedings of the 2015 Annual Cryptology Conference, LNCS 9216. Berlin: Springer, 2015: 630-656." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Multi-identity and multi-key leveled FHE from learning with errors">
                                        <b>[6]</b>
                                         CLEAR M, McGOLDRICK C. Multi-identity and multi-key leveled FHE from learning with errors [C]// Proceedings of the 2015 Annual Cryptology Conference, LNCS 9216. Berlin: Springer, 2015: 630-656.
                                    </a>
                                </li>
                                <li id="17">


                                    <a id="bibliography_7" title=" CASH D, HOFHEINZ D, KILTZ E, et al. Bonsai trees, or how to delegate a lattice basis [C]// Proceedings of the 2010 Annual International Conference on the Theory and Applications of Cryptographic Techniques, LNCS 6110. Berlin: Springer, 2010: 523-552." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Bonsai trees,or how to delegate a lattice basis">
                                        <b>[7]</b>
                                         CASH D, HOFHEINZ D, KILTZ E, et al. Bonsai trees, or how to delegate a lattice basis [C]// Proceedings of the 2010 Annual International Conference on the Theory and Applications of Cryptographic Techniques, LNCS 6110. Berlin: Springer, 2010: 523-552.
                                    </a>
                                </li>
                                <li id="19">


                                    <a id="bibliography_8" title=" GENTRY C, PEIKERT C, VAIKUNTANATHAN V. Trapdoors for hard lattices and new cryptographic constructions [C]// STOC &#39;08: Proceedings of the 40th Annual ACM Symposium on Theory of Computing. New York: ACM, 2008: 197-206." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Trapdoors for hard lattices and new cryptographic con-structions">
                                        <b>[8]</b>
                                         GENTRY C, PEIKERT C, VAIKUNTANATHAN V. Trapdoors for hard lattices and new cryptographic constructions [C]// STOC &#39;08: Proceedings of the 40th Annual ACM Symposium on Theory of Computing. New York: ACM, 2008: 197-206.
                                    </a>
                                </li>
                                <li id="21">


                                    <a id="bibliography_9" title=" 李增鹏, 马春光, 周红生.全同态加密研究[J].密码学报, 2017, 4 (6) :561-578. (LI Z P, MA C G, ZHOU H S. Overview on fully homomorphic encryption [J]. Journal of Cryptologic Research, 2017, 4 (6) : 561-578.) " target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=MMXB201706006&amp;v=MjMxMTBiTXFZOUZZb1FLREg4NHZSNFQ2ajU0TzN6cXFCdEdGckNVUjdxZlp1WnBGaURtVnJ6QUtDRFRiTEc0SDk=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZONFRYTUhIM2RrMzdIS2psYmhhZz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[9]</b>
                                         李增鹏, 马春光, 周红生.全同态加密研究[J].密码学报, 2017, 4 (6) :561-578. (LI Z P, MA C G, ZHOU H S. Overview on fully homomorphic encryption [J]. Journal of Cryptologic Research, 2017, 4 (6) : 561-578.) 
                                    </a>
                                </li>
                                <li id="23">


                                    <a id="bibliography_10" title=" MICCIANCIO D. Generalized compact knapsacks, cyclic lattices, and efficient one-way functions [J]. Computational Complexity, 2007, 16 (4) : 365-411." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=SSJD&amp;filename=SSJD00000652387&amp;v=MDA0ODhjTUg3UjdxZForWnVGaS9rVzd6TkkxWT1OajdCYXJPNEh0SE1xWXBIWitNSVkzazV6QmRoNGo5OVNYcVJyeG94&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZONFRYTUhIM2RrMzdIS2psYmhhZz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[10]</b>
                                         MICCIANCIO D. Generalized compact knapsacks, cyclic lattices, and efficient one-way functions [J]. Computational Complexity, 2007, 16 (4) : 365-411.
                                    </a>
                                </li>
                                <li id="25">


                                    <a id="bibliography_11" title=" BONEH D, FRANKLIN M. Identity-based encryption from the Weil pairing [C]// Proceedings of the 2001 Annual International Cryptology Conference, LNCS 2139. Berlin: Springer, 2001: 213-229." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Identity based encryption from the weil pairing">
                                        <b>[11]</b>
                                         BONEH D, FRANKLIN M. Identity-based encryption from the Weil pairing [C]// Proceedings of the 2001 Annual International Cryptology Conference, LNCS 2139. Berlin: Springer, 2001: 213-229.
                                    </a>
                                </li>
                                <li id="27">


                                    <a id="bibliography_12" title=" SHAMIR A. Identity-based cryptosystems and signature schemes [C]// Proceedings of the 1984 Workshop on the Theory and Application of Cryptographic Techniques, LNCS 196. Berlin: Springer, 1984: 47-53." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Identity-based cryptosystems and signature schemes">
                                        <b>[12]</b>
                                         SHAMIR A. Identity-based cryptosystems and signature schemes [C]// Proceedings of the 1984 Workshop on the Theory and Application of Cryptographic Techniques, LNCS 196. Berlin: Springer, 1984: 47-53.
                                    </a>
                                </li>
                                <li id="29">


                                    <a id="bibliography_13" title=" REGEV O. On lattices, learning with errors, random linear codes, and cryptography [C]// Proceedings of the 37th Annual ACM Symposium on Theory of Computing. New York: ACM, 2005: 84-93." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=On lattices,learning with errors,random linear codes,and cryptography">
                                        <b>[13]</b>
                                         REGEV O. On lattices, learning with errors, random linear codes, and cryptography [C]// Proceedings of the 37th Annual ACM Symposium on Theory of Computing. New York: ACM, 2005: 84-93.
                                    </a>
                                </li>
                                <li id="31">


                                    <a id="bibliography_14" title=" PEIKERT C. Public-key cryptosystems from the worst-case shortest vector problem: extended abstract [C]// STOC &#39;09: Proceedings of the 41st Annual ACM Symposium on Theory of Computing. New York: ACM, 2009: 333-342." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Public-key cryptosystems from the worst-case shortest vectorproblem: extended abstract">
                                        <b>[14]</b>
                                         PEIKERT C. Public-key cryptosystems from the worst-case shortest vector problem: extended abstract [C]// STOC &#39;09: Proceedings of the 41st Annual ACM Symposium on Theory of Computing. New York: ACM, 2009: 333-342.
                                    </a>
                                </li>
                                <li id="33">


                                    <a id="bibliography_15" title=" REGEV O. The learning with errors problem (invited survey) [C]// Proceedings of the 2010 IEEE 25th Annual Conference on Computational Complexity. Piscataway, NJ: IEEE, 2010: 191-204." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=The learning with errors problem">
                                        <b>[15]</b>
                                         REGEV O. The learning with errors problem (invited survey) [C]// Proceedings of the 2010 IEEE 25th Annual Conference on Computational Complexity. Piscataway, NJ: IEEE, 2010: 191-204.
                                    </a>
                                </li>
                                <li id="35">


                                    <a id="bibliography_16" >
                                        <b>[16]</b>
                                     周潭平.基于GLWE问题的密码体制研究与设计[D].西安:武警工程大学, 2014:13. (ZHOU T P. Research and design of cryptosystem based on GLWE problem [D]. Xi&#39;an: Engineering University of the Chinese People&#39;s Armed Police Force, 2014:13.) </a>
                                </li>
                                <li id="37">


                                    <a id="bibliography_17" title=" 石悦, 李相龙, 戴方芳.一种基于属性基加密的增强型软件定义网络安全框架[J].信息网络安全, 2018 (1) :15-22. (SHI Y, LI X L, DAI F F. An enhanced security framework of software defined network based on attribute-based encryption [J]. Netinfo Security, 2018 (1) : 15-22.) This work is partially supported by the National Key Research and Development Program of China (2017YFB0802000) , the National Natural Science Foundation of China (U1636114, 61772550, 61572521) , the National Cryptography Development Fund of China (MMJJ20170112) .TU Guangsheng, born in 1992, M. S. candidate. His research interests include information security, homomorphic cryptology.YANG Xiaoyuan, born in 1959, M. S., professor. His research interests include information security, cryptography.ZHOU Tanping, born in 1989, Ph. D. His research interests include information security, homomorphic cryptology." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=XXAQ201801003&amp;v=MjQxOTBuTXJvOUZaNFFLREg4NHZSNFQ2ajU0TzN6cXFCdEdGckNVUjdxZlp1WnBGaURtVnJ6QVBUWEtmN0c0SDk=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZONFRYTUhIM2RrMzdIS2psYmhhZz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[17]</b>
                                         石悦, 李相龙, 戴方芳.一种基于属性基加密的增强型软件定义网络安全框架[J].信息网络安全, 2018 (1) :15-22. (SHI Y, LI X L, DAI F F. An enhanced security framework of software defined network based on attribute-based encryption [J]. Netinfo Security, 2018 (1) : 15-22.) This work is partially supported by the National Key Research and Development Program of China (2017YFB0802000) , the National Natural Science Foundation of China (U1636114, 61772550, 61572521) , the National Cryptography Development Fund of China (MMJJ20170112) .TU Guangsheng, born in 1992, M. S. candidate. His research interests include information security, homomorphic cryptology.YANG Xiaoyuan, born in 1959, M. S., professor. His research interests include information security, cryptography.ZHOU Tanping, born in 1989, Ph. D. His research interests include information security, homomorphic cryptology.
                                    </a>
                                </li>
                            </ul>
                            <div style='display: none;' class="zqscroller" >
                                <h4 class="">附加材料</h4>
                                <ul></ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            &nbsp;
            <!--此处有一空格符 勿删-->
        </div>

        
    <div class="content">

    <div class="head-tag">   
            <p>
               <b> 网络首发时间: 2018-11-16 12:45</b>
            </p>     
    </div>


        <!--tips start-->
                            <div class="tips">
                    <a href="http://navi.cnki.net/KNavi/JournalDetail?pcode=CJFD&amp;pykm=JSJY" target="_blank">计算机应用</a>
                2019,39(03),750-755 DOI:10.11772/j.issn.1001-9081.2018081669            </div>
        <!--tips end-->
            <div class="top-title">
                <h1 class="title">
                    <span class="vm"><b>高效的身份基多用户全同态加密方案</b></span>
                                    </h1>

            </div>
                        <h2>
                                <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=au&amp;skey=%E6%B6%82%E5%B9%BF%E5%8D%87&amp;code=41190764&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZONFRYTUhIM2RrMzdIS2psYmhhZz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">涂广升</a>
                                <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=au&amp;skey=%E6%9D%A8%E6%99%93%E5%85%83&amp;code=27387750&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZONFRYTUhIM2RrMzdIS2psYmhhZz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">杨晓元</a>
                                <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=au&amp;skey=%E5%91%A8%E6%BD%AD%E5%B9%B3&amp;code=31477857&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZONFRYTUhIM2RrMzdIS2psYmhhZz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">周潭平</a>
                </h2>
                    <h2>
                    <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=in&amp;skey=%E7%BD%91%E7%BB%9C%E5%92%8C%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E6%AD%A6%E8%AD%A6%E9%83%A8%E9%98%9F%E9%87%8D%E7%82%B9%E5%AE%9E%E9%AA%8C%E5%AE%A4&amp;code=1694105&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZONFRYTUhIM2RrMzdIS2psYmhhZz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">网络和信息安全武警部队重点实验室</a>
                    <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=in&amp;skey=%E6%AD%A6%E8%AD%A6%E5%B7%A5%E7%A8%8B%E5%A4%A7%E5%AD%A6%E5%AF%86%E7%A0%81%E5%B7%A5%E7%A8%8B%E5%AD%A6%E9%99%A2&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZONFRYTUhIM2RrMzdIS2psYmhhZz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">武警工程大学密码工程学院</a>
            </h2>

        
<div class="link">
    <a id="aexport" class="icon icon-output"  onclick="" href="javascript:void(0);"><i></i>导出/参考文献</a>
    
    <span class="shareBoard" onmouseover="$('#sharedet').show();$('#this').addClass('shareBoardCUR')" onmouseout="$('#sharedet').hide();$('#this').removeClass('shareBoardCUR')">
        <a class="icon icon-share" href="#"><i></i>分享<em></em></a>
        <ul class="shareHide" id="sharedet" style="display: none;">
            <li><a title="复制链接" class="copy" onclick="" href="#"><i></i>复制链接</a></li>
            <li><a title="分享到新浪微博" class="xl" onclick="" href="javascript:common.ShareAction('xl');"><i></i>新浪微博</a></li>
            <li>
                <a title="分享到微信" class="wx" onclick="" href="#"><i></i>微信扫一扫</a>
                <div class="qrcode"><img src='' alt='' /></div>
            </li>
        </ul>

    </span>
    
    <a id="RefTrack" title="创建引文跟踪" class="icon icon-track" onclick="" href="javascript:void(0);"> <i></i>创建引文跟踪 </a>
    <a id="ashoucang" title="收藏" class="icon icon-favor" onclick="" href="javascript:void(0);"><i></i>收藏</a>
    <a class="icon icon-print" onclick="window.print();" href="javascript:void(0);"><i></i>打印</a>
    
    <!--版本切换 end-->
</div>
                            <div class="data" id="a_abstract">
                <span class="keys">摘<span style="font-family: 'Times New Roman';">&nbsp;&nbsp;&nbsp;&nbsp;</span>要：</span>
                <p>针对传统的身份基全同态加密 (IBFHE) 方案无法对不同身份标识 (ID) 下的密文进行同态运算的问题, 提出一个基于误差学习 (LWE) 问题的分层身份基多用户全同态加密方案。该方案利用Clear等 (CLEAR M, McGOLDRICK C. Multi-identity and multi-key leveled FHE from learning with errors. Proceedings of the 2015 Annual Cryptology Conference, LNCS 9216. Berlin:Springer, 2015:630-656) 在2015年提出的身份基多用户全同态加密方案 (方案) 的转化机制, 结合Cash等 (CASH D, HOFHEINZ D, KILTZ E, et al. Bonsai trees, or how to delegate a lattice basis. Proceedings of the 2010 Annual International Conference on the Theory and Applications of Cryptographic Techniques, LNCS 6110. Berlin:Springer, 2010:523-552) 在2010年提出的身份基加密 (IBE) 方案<mathml id="40"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo stretchy="false"> (</mo><menclose notation="longdiv"><mrow></mrow></menclose></mrow></math></mathml>方案) , 实现了不同身份标识下的密文同态运算, 应用前景更加广阔, 在随机预言机模型下为基于身份匿名的选择明文攻击下的不可区分性 (IND-ID-CPA) 安全。与方案相比, 该方案在公钥规模、私钥规模、密文尺寸、分层性质和密钥更新周期方面都具有优势。</p>
            </div>
                    <div class="data" id="a_keywords">
                <span class="keys">关键词：</span>
                <p>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=%E5%88%86%E5%B1%82%E8%BA%AB%E4%BB%BD%E5%9F%BA%E5%8A%A0%E5%AF%86&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZONFRYTUhIM2RrMzdIS2psYmhhZz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">分层身份基加密;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=%E5%A4%9A%E7%94%A8%E6%88%B7&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZONFRYTUhIM2RrMzdIS2psYmhhZz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">多用户;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=%E5%85%A8%E5%90%8C%E6%80%81%E5%8A%A0%E5%AF%86&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZONFRYTUhIM2RrMzdIS2psYmhhZz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">全同态加密;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=%E5%90%8C%E6%80%81%E8%BF%90%E7%AE%97&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZONFRYTUhIM2RrMzdIS2psYmhhZz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">同态运算;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=%E5%9F%BA%E4%BA%8E%E8%AF%AF%E5%B7%AE%E5%AD%A6%E4%B9%A0&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZONFRYTUhIM2RrMzdIS2psYmhhZz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">基于误差学习;</a>
                </p>
            </div>
        
        <!--brief start-->
        
            <div class="brief">
                    <p>
                            <b>作者简介：</b>
                                                        <span>
                                    涂广升 (1992—) , 男, 河南驻马店人, 硕士研究生, 主要研究方向:信息安全、同态密码;;
                                </span>
                                <span>
                                    *杨晓元 (1959—) , 男, 湖南湘潭人, 教授, 博士生导师, 硕士, 主要研究方向:信息安全、密码学;电子邮箱xyyangwj@126.com;
                                </span>
                                <span>
                                    周潭平 (1989—) , 男, 江西贵溪人, 博士, 主要研究方向:信息安全、同态密码。;
                                </span>
                    </p>
                                    <p><b>收稿日期：</b>2018-08-13</p>

                    <p>

                            <b>基金：</b>
                                                        <span>国家重点研发计划项目 (2017YFB0802000);</span>
                                <span>国家自然科学基金资助项目 (U1636114, 61772550, 61572521);</span>
                                <span>国家密码发展基金资助项目 (MMJJ20170112);</span>
                    </p>
            </div>
                    <h1><b>Efficient identity-based multi-identity fully homomorphic encryption scheme</b></h1>
                    <h2>
                    <span>TU Guangsheng</span>
                    <span>YANG Xiaoyuan</span>
                    <span>ZHOU Tanping</span>
            </h2>
                    <h2>
                    <span>Key Laboratory of Network and Information Security of the Chinese People's Armed Police Force</span>
                    <span>College of Cryptographic Engineering, Engineering University of the Chinese People's Armed Police Force</span>
            </h2>
                            <div class="data" id="a_abstractEN">
                <span class="keys">Abstract：</span>
                <p>Focusing on the issue that the traditional Identity-Based Fully Homomorphic Encryption scheme (IBFHE) cannot perform homomorphic operations on ciphertexts under different IDentities (ID) , a hierarchical identity-based multiidentity fully homomorphic encryption scheme based on Learning With Error (LWE) problem was proposed.In the proposed scheme, the transformation mechanism of identity-based multi-identity homomorphic encryption scheme ([CM15]scheme) proposed by Clear et al. (CLEAR M, McGOLDRICK C.Multi-identity and multi-key leveled FHE from learning with errors.Proceedings of the 2015 Annual Cryptology Conference, LNCS 9216.Berlin:Springer, 2015:630-656) in 2015 was combined with Identity-Based Encryption (IBE) scheme proposed by Cash et al. (CASH D, HOFHEINZ D, KILTZ E, et al.Bonsai trees, or how to delegate a lattice basis.Proceedings of the 2010 Annual International Conference on the Theory and Applications of Cryptographic Techniques, LNCS 6110.Berlin:Springer, 2010:523-552) in 2010 ([CHKP10]scheme) , guranteeing IND-ID-CPA (INDistinguishability of IDentity-based encryption under Chosen-Plaintext Attack) security in the random oracle model and realizing ciphertext homomorphic operation under different identities, so the application of this scheme was more promising.Compared with[CM15]scheme, the proposed scheme has advantages in terms of public key scale, private key scale, ciphertext size, and hierarchical properties, and has a wide application prospect.</p>
            </div>
                    <div class="data" id="a_keywordsEN">
                <span class="keys">Keyword：</span>
                <p>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=hierarchical%20identity-based%20encryption&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZONFRYTUhIM2RrMzdIS2psYmhhZz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">hierarchical identity-based encryption;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=multi-identity&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZONFRYTUhIM2RrMzdIS2psYmhhZz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">multi-identity;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=fully%20homomorphic%20encryption&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZONFRYTUhIM2RrMzdIS2psYmhhZz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">fully homomorphic encryption;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=homomorphic%20operation&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZONFRYTUhIM2RrMzdIS2psYmhhZz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">homomorphic operation;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=Learning%20With%20Error%20(LWE)%20&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZONFRYTUhIM2RrMzdIS2psYmhhZz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">Learning With Error (LWE) ;</a>
                </p>
            </div>
                    <div class="brief">
                
                    <p>
                            <b>Author：</b>
                                                        <span>
                                    TU Guangsheng, born in 1992, M. S. candidate. His research interests include information security, homomorphic cryptology.;
                                </span>
                                <span>
                                    YANG Xiaoyuan, born in 1959, M. S. , professor. His research interests include information security, cryptography.;
                                </span>
                                <span>
                                    ZHOU Tanping, born in 1989, Ph. D. His research interests include information security, homomorphic cryptology.;
                                </span>
                    </p>
                                    <p><b>Received：</b> 2018-08-13</p>
                                    <p>
                            <b>Fund：</b>
                                                        <span>supported by the National Key Research and Development Program of China (2017YFB0802000);</span>
                                <span>the National Natural Science Foundation of China (U1636114, 61772550, 61572521);</span>
                                <span>the National Cryptography Development Fund of China (MMJJ20170112);</span>
                    </p>
            </div>


        <!--brief start-->
                        <h3 id="41" name="41" class="anchor-tag">0 引言</h3>
                <div class="p1">
                    <p id="42">2009年, Gentry<citation id="282" type="reference"><link href="5" rel="bibliography" /><sup>[<a class="sup">1</a>]</sup></citation>提出了第一个基于理想格的全同态加密方案, 全同态加密得到了越来越多密码学家的关注。此后, 新的全同态加密方案相继出现, 其中基于理想格的全同态加密方案 (如[GH11b]方案<citation id="283" type="reference"><link href="7" rel="bibliography" /><sup>[<a class="sup">2</a>]</sup></citation>) 、基于环上的误差学习问题的全同态加密方案 (如[BGV12]方案<citation id="284" type="reference"><link href="9" rel="bibliography" /><sup>[<a class="sup">3</a>]</sup></citation>) 、运用特征向量法的全同态加密方案 (如[GSW13]方案<citation id="285" type="reference"><link href="11" rel="bibliography" /><sup>[<a class="sup">4</a>]</sup></citation>) 成为研究的热点, 同态加密的效率也在不断提高。</p>
                </div>
                <div class="p1">
                    <p id="43">全同态加密方案有多种分类方式, 如果以同态运算能够执行的电路深度为依据, 全同态加密方案可分为“纯”的全同态加密方案和层次型全同态加密方案<citation id="286" type="reference"><link href="13" rel="bibliography" /><sup>[<a class="sup">5</a>]</sup></citation>。前者可以对任意深度的电路作任意的运算。层次型全同态加密方案只能执行深度为 <i>L</i>的计算电路, 方案的参数选择依赖于 <i>L</i>。虽然它并不能达到任意深度电路的要求, 但对于多项式深度的电路, 在满足用户需求的同时, 更加高效实用。</p>
                </div>
                <div class="p1">
                    <p id="44">在身份基加密方案中, 身份信息作为用户的唯一标识, 用户的公钥可以从用户的身份信息字符串和系统的公共参数中获得, 对应的私钥为用户私有。2013年Gentry等<citation id="287" type="reference"><link href="11" rel="bibliography" /><sup>[<a class="sup">4</a>]</sup></citation>提出了一个新的层次型全同态加密方案。该方案允许计算方在不获得用户的计算密钥 (EValuation Key, EVK) , 而只需要知道系统公共参数信息的情况下, 实现对明文的加密和对密文的运算。利用此特性, 该方案构造了第一个身份基全同态加密方案;然而它只适用于单用户身份信息场景, 即只能对在同一身份信息下加密的密文进行运算。2015年, Clear等<citation id="288" type="reference"><link href="15" rel="bibliography" /><sup>[<a class="sup">6</a>]</sup></citation>通过构造屏蔽系统 (Masking System, MS) 的方法, 提出了第一个基于误差学习 (Learning With Error, LWE) 问题的身份基多用户全同态加密方案 (该方案称为[CM15]方案) , 并证明该方案在随机预言机模型下为IND-ID-CPA (INDistinguishability of IDentity-based encryption under Chosen-Plaintext Attack) 安全。</p>
                </div>
                <div class="p1">
                    <p id="45">身份基多用户全同态加密方案实现了不同用户密文之间的同态运算, 在密文计算领域有着广泛的应用。以两方的密文计算为例, 假设C为可信任的权威机构, Alice和Bob为C中的两个不同身份体或不同部门, 其身份信息分别为a, b。C为Alice和Bob产生公开的公钥信息, 并分配相应的私钥。公共用户可以分别使用Alice和Bob的公开身份信息和公共参数对个人信息进行加密, 而后将密文分别发送给Alice和Bob。C将数据上传到半透明的云服务器E, 在服务器端进行同态运算, 得到新的密文, 而后返回给C。权威机构C通过多方计算协议 (Multi-Party Computation, MPC) , 使用Alice和Bob的私钥对密文进行解密, 解密后的结果保持同态方案的性质。整个过程中既实现了不同身份信息下密文的同态运算, 也能保证用户之间的私钥信息的非交互性, 即Alice和Bob互相不知道对方的私钥。这里的实例场景表示不同身份信息的用户数<i>κ</i>=2, 对于更多不同身份信息用户的情况同样适用。</p>
                </div>
                <div class="p1">
                    <p id="46">本文利用文献<citation id="289" type="reference">[<a class="sup">6</a>]</citation>的转化机制, 结合Cash等<citation id="290" type="reference"><link href="17" rel="bibliography" /><sup>[<a class="sup">7</a>]</sup></citation>提出的分层身份基加密 (Hierarchical Identity-Based Encryption, HIBE) 方案 (该方案被称为[CHKP10]方案) , 将该方案转化为分层身份基多用户全同态加密方案。相比于传统的身份基全同态加密方案, 本方案实现了对不同身份信息下密文的同态运算, 能够更好地与其他技术结合 (如即时多方计算协议、奇点打孔陷门) , 应用场景更加广泛。相比于文献<citation id="291" type="reference">[<a class="sup">6</a>]</citation>中的身份基多用户全同态加密方案, 本方案虽然使用相同的转化机制, 但本方案采用随机预言机模型下的[CHKP10]方案, 文献<citation id="292" type="reference">[<a class="sup">6</a>]</citation>采用Gentry等<citation id="293" type="reference"><link href="19" rel="bibliography" /><sup>[<a class="sup">8</a>]</sup></citation>在2008年发表的利用陷门函数构造的身份基加密方案 (该方案被称为 [GPV08]方案) 。由于RO模型下的[CHKP10]方案相比[GPV08]方案在公钥规模、私钥规模、密文尺寸方面都有一定优势, 并且实现了分层功能, 因此, 在安全性相同 (都能达到随机预言机 (Random Oracle, RO) 模型下的选择安全) 的情况下, 本方案的密钥更新时间更短, 效率更高。</p>
                </div>
                <h3 id="47" name="47" class="anchor-tag">1 相关理论基础</h3>
                <h4 class="anchor-tag" id="48" name="48">1.1 <b>全同态加密</b></h4>
                <div class="p1">
                    <p id="49">全同态加密方案包含四个算法, 分别为密钥生成算法、加密算法、解密算法和密文计算算法<citation id="294" type="reference"><link href="5" rel="bibliography" /><link href="21" rel="bibliography" /><sup>[<a class="sup">1</a>,<a class="sup">9</a>]</sup></citation>。</p>
                </div>
                <div class="p1">
                    <p id="50">密钥生成算法 (KeyGen) 输入安全参数<i>λ</i>, 输出公钥<i>pk</i>和私钥<i>sk</i>。</p>
                </div>
                <div class="p1">
                    <p id="51">加密算法 (Enc) 输入公钥<i>pk</i>和明文消息<i>m</i>∈{0, 1}, 生成密文<i>c</i>。</p>
                </div>
                <div class="p1">
                    <p id="52">解密算法 (Dec) 输入密文<i>c</i>和密钥<i>sk</i>, 输出解密结果<i>m</i>′。</p>
                </div>
                <div class="p1">
                    <p id="53">同态计算算法 (Eval) 用于对加密后的密文进行同态操作, 这也是全同态加密中的关键算法。输入公钥<i>pk</i>, 运算电路<i>C</i>∈ℂ, 密文组 (<i>c</i><sub>1</sub>, <i>c</i><sub>2</sub>, …, <i>c</i><sub><i>t</i></sub>) , 输出新的密文<i>c</i>′。</p>
                </div>
                <div class="p1">
                    <p id="54">全同态加密方案应当具有以下几个性质<citation id="295" type="reference"><link href="21" rel="bibliography" /><sup>[<a class="sup">9</a>]</sup></citation>:</p>
                </div>
                <div class="p1">
                    <p id="55">正确性 对任意KeyGen (1<sup><i>λ</i></sup>) → (<i>pk</i>, <i>sk</i>) , <i>m</i>∈{0, 1}, 有Dec (<i>sk</i>, Enc (<i>pk</i>, <i>m</i>) ) = <i>m</i>成立。对任意KeyGen (1<sup><i>λ</i></sup>) → (<i>pk</i>, <i>sk</i>) , <i>m</i>∈{0, 1}, <i>C</i>∈ℂ表示一个功能函数, 有<i>C</i> (<i>m</i><sub>1</sub>, <i>m</i><sub>2</sub>, …, <i>m</i><sub><i>t</i></sub>) =Dec (<i>sk</i>, (Eval (<i>pk</i>, <i>C</i>, Enc (<i>pk</i>, <i>m</i><sub>1</sub>) , Enc (<i>pk</i>, <i>m</i><sub>2</sub>) , …, Enc (<i>pk</i>, <i>m</i><sub><i>t</i></sub>) ) ) 成立。</p>
                </div>
                <div class="p1">
                    <p id="56">紧凑性 解密电路的深度并不随着计算电路深度的增加而增加, 也就是说计算电路产生的密文大小并不取决于计算电路的大小。</p>
                </div>
                <div class="p1">
                    <p id="57"><b>定义</b>1 层次型全同态加密方案。对于任意<i>L</i>∈<b>Z</b><sup>+</sup>, 一个同态加密方案<i>ε</i><sup> (<i>L</i>) </sup>能够计算的电路深度为<i>L</i>, 并且满足上述的紧凑性。设电路大小用<i>z</i>表示, 紧凑计算的复杂度为<i>poly</i> (<i>λ</i>, <i>L</i>, <i>z</i>) , 则称该方案为层次型全同态方案<citation id="296" type="reference"><link href="23" rel="bibliography" /><sup>[<a class="sup">10</a>]</sup></citation>。</p>
                </div>
                <h4 class="anchor-tag" id="58" name="58">1.2 <b>分层身份加密</b> (HIBE) </h4>
                <div class="p1">
                    <p id="59">HIBE是在IBE的基础上发展起来的, 在密钥生成阶段能够很好地减轻私钥生成器 (Private Key Generator, PKG) 的工作负担。与IBE方案<citation id="297" type="reference"><link href="25" rel="bibliography" /><link href="27" rel="bibliography" /><sup>[<a class="sup">11</a>,<a class="sup">12</a>]</sup></citation> (由Setup、KeyGen、Enc、Dec这4个算法组成) 相比, HIBE方案有一个新的算法:Lower-level Setup算法。</p>
                </div>
                <div class="p1">
                    <p id="60">Setup 输入安全参数<i>k</i>, 输出主私钥 (MaSter Key, MSK) 和公共参数 (Public Parameters, PP) 。主密钥<i>MSK</i>为根PKG私有;<i>PP</i>为公共参数, 包含用于生成身份信息对应的公钥和密文空间描述等信息。</p>
                </div>
                <div class="p1">
                    <p id="61">Lower-level Setup 用户根据身份信息设置自己的低层密钥, 用于生成下一层身份信息对应的私钥。</p>
                </div>
                <div class="p1">
                    <p id="62">Key generation 输入 (<i>PP</i>, <i>MSK</i>, ID) , PKG生成身份信息对应的私钥<i>s</i><sub>ID</sub>。这里的PKG既可能是根PKG, 也可能是身份信息对应的上一层的PKG。</p>
                </div>
                <div class="p1">
                    <p id="63">Encryption 输入 (<i>PP</i>, ID, <i>m</i>) , 输出密文<i>c</i>。其中<i>PP</i>来自根PKG, ID为低层接收方的身份信息, 这样可保证发送方不必知道低层用户的密钥参数。</p>
                </div>
                <div class="p1">
                    <p id="64">Decryption 接收方根据来自根PKG的公共参数<i>PP</i>、用户自己的身份信息对应的私钥解密密文, 解密密文得到相应的<i>m</i>。</p>
                </div>
                <h4 class="anchor-tag" id="65" name="65">1.3 LWE<b>问题</b></h4>
                <div class="p1">
                    <p id="66">LWE问题最早由Regev<citation id="298" type="reference"><link href="29" rel="bibliography" /><sup>[<a class="sup">13</a>]</sup></citation>在2005年提出, 已经被证明为一个难解的多项式复杂程度的非确定性 (Non-deterministic Polynomial, NP) 问题。</p>
                </div>
                <div class="p1">
                    <p id="67"><b>定义</b>2 计算性LWE问题。设<i>λ</i>为安全参数, 参数<i>n</i>=<i>n</i> (<i>λ</i>) , <i>q</i>=<i>q</i> (<i>λ</i>) ≥2均为整数, <i>χ</i>是<i>Z</i><sub><i>q</i></sub>上的高斯分布, 选择<mathml id="68"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mrow><mi mathvariant="bold-italic">a</mi><msub><mrow></mrow><mi>i</mi></msub><mover><mo stretchy="true" symmetric="false">←</mo><mi>＄</mi></mover><mi>Ζ</mi><msubsup><mrow></mrow><mi>q</mi><mi>n</mi></msubsup></mrow><mo>, </mo><mi mathvariant="bold-italic">s</mi><mover><mo stretchy="true" symmetric="false">←</mo><mi>＄</mi></mover><mi>Ζ</mi><msubsup><mrow></mrow><mi>q</mi><mi>n</mi></msubsup><mo>, </mo><mi>e</mi><msub><mrow></mrow><mi>i</mi></msub><mover><mo stretchy="true" symmetric="false">←</mo><mrow></mrow></mover><mi>χ</mi></mrow></math></mathml>, 计算<i>b</i><sub><i>i</i></sub>=〈<b><i>a</i></b><sub><i>i</i></sub>·<b><i>s</i></b>〉+<i>e</i><sub><i>i</i></sub>∈<i>Z</i><sub><i>q</i></sub>, 得到分布A <sub><b><i>s</i></b>, <i>χ</i></sub>。在A <sub><b><i>s</i></b>, <i>χ</i></sub>中选取任意多的样本, 输出向量<b><i>s</i></b>。</p>
                </div>
                <div class="p1">
                    <p id="69"><b>定义</b>3 判定性LWE问题。设<i>λ</i>为安全参数, 参数<i>n</i>=<i>n</i> (<i>λ</i>) , <i>q</i>=<i>q</i> (<i>λ</i>) ≥2均为整数, <i>χ</i>是<i>Z</i><sub><i>q</i></sub>上的高斯分布, 判定性LWE问题就是要区分以下两个分布:</p>
                </div>
                <div class="p1">
                    <p id="70">D<sub>0</sub>= (<b><i>a</i></b><sub><i>i</i></sub>, <i>b</i><sub><i>i</i></sub>) ∈<i>Z</i><mathml id="71"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msubsup><mrow></mrow><mi>q</mi><mi>n</mi></msubsup></mrow></math></mathml>×<i>Z</i><sub><i>q</i></sub>, 其中<mathml id="72"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi mathvariant="bold-italic">a</mi><msub><mrow></mrow><mi>i</mi></msub><mover><mo stretchy="true" symmetric="false">←</mo><mi>＄</mi></mover><mi>Ζ</mi><msubsup><mrow></mrow><mi>q</mi><mi>n</mi></msubsup><mo>, </mo><mi>b</mi><msub><mrow></mrow><mi>i</mi></msub><mover><mo stretchy="true" symmetric="false">←</mo><mi>＄</mi></mover><mi>Ζ</mi><msub><mrow></mrow><mi>q</mi></msub></mrow></math></mathml>。D<sub>1</sub>= (<b><i>a</i></b><sub><i>i</i></sub>, <i>b</i><sub><i>i</i></sub>) = (<b><i>a</i></b><sub><i>i</i></sub>, &lt;<b><i>a</i></b><sub><i>i</i></sub>·<b><i>s</i></b>&gt;+<i>e</i><sub><i>i</i></sub>) , 其中<mathml id="73"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi mathvariant="bold-italic">a</mi><msub><mrow></mrow><mi>i</mi></msub><mover><mo stretchy="true" symmetric="false">←</mo><mi>＄</mi></mover><mi>Ζ</mi><msubsup><mrow></mrow><mi>q</mi><mi>n</mi></msubsup><mo>, </mo><mi mathvariant="bold-italic">s</mi><mover><mo stretchy="true" symmetric="false">←</mo><mi>＄</mi></mover><mi>Ζ</mi><msubsup><mrow></mrow><mi>q</mi><mi>n</mi></msubsup><mo>, </mo><mrow><mi>e</mi><msub><mrow></mrow><mi>i</mi></msub><mover><mo stretchy="true" symmetric="false">←</mo><mrow></mrow></mover></mrow><mi>χ</mi></mrow></math></mathml>。</p>
                </div>
                <div class="p1">
                    <p id="74"><b>定理</b>1 令<b><i>n</i></b>为格的维度, <b><i>q</i>=<i>q</i> (<i>n</i></b>) , <i>χ</i>为<b><i>B</i></b>有界的高斯分布, <mathml id="75"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi mathvariant="bold-italic">B</mi><mo>≥</mo><mi mathvariant="bold-italic">ω</mi><mo stretchy="false"> (</mo><mrow><mi mathvariant="bold">l</mi><mi mathvariant="bold">o</mi><mi mathvariant="bold">g</mi></mrow><mspace width="0.25em" /><mi mathvariant="bold-italic">n</mi><mo stretchy="false">) </mo><mo>⋅</mo><msqrt><mi mathvariant="bold-italic">n</mi></msqrt></mrow></math></mathml>, 如果存在一个有效的算法能够解决平均情况下的<b>LWE</b>问题, 那么<citation id="299" type="reference"><link href="31" rel="bibliography" /><sup>[<a class="sup">14</a>]</sup></citation>:</p>
                </div>
                <div class="p1">
                    <p id="76">1) 对于任意维度的格, 存在一个有效的量子算法, 能够解决近似因子为<mathml id="77"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mover accent="true"><mi mathvariant="bold-italic">Ο</mi><mo>˜</mo></mover><mo stretchy="false"> (</mo><mi mathvariant="bold-italic">n</mi><mi mathvariant="bold-italic">q</mi><mo>/</mo><mi mathvariant="bold-italic">B</mi><mo stretchy="false">) </mo></mrow></math></mathml>的具有间隙的最短向量 (<b>Gap Version of Shortest Vector Problem, GapSVP</b>) 问题。</p>
                </div>
                <div class="p1">
                    <p id="78">2) 对于任意维度的格, 如果<mathml id="79"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi mathvariant="bold-italic">q</mi><mo>=</mo><mi mathvariant="bold-italic">q</mi><mo stretchy="false"> (</mo><mi mathvariant="bold-italic">n</mi><mo stretchy="false">) </mo><mo>≥</mo><mover accent="true"><mi mathvariant="bold-italic">Ο</mi><mo>˜</mo></mover><mo stretchy="false"> (</mo><mn>2</mn><msup><mrow></mrow><mrow><mfrac><mi mathvariant="bold-italic">n</mi><mn>2</mn></mfrac></mrow></msup><mo stretchy="false">) </mo></mrow></math></mathml>, 就存在一个有效的经典算法, 能够解决近似因子为<mathml id="80"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mover accent="true"><mi mathvariant="bold-italic">Ο</mi><mo>˜</mo></mover><mo stretchy="false"> (</mo><mi mathvariant="bold-italic">n</mi><mi mathvariant="bold-italic">q</mi><mo>/</mo><mi mathvariant="bold-italic">B</mi><mo stretchy="false">) </mo></mrow></math></mathml>的<b>GapSVP</b>问题。</p>
                </div>
                <div class="p1">
                    <p id="81">利用量子归约和经典归约的方法, 将<b>LWE</b>问题归约到最坏情况下格上困难问题, 而格的困难问题已经被证明为难解的<b>NP</b>问题。</p>
                </div>
                <div class="p1">
                    <p id="82"><b>Regev</b><citation id="300" type="reference"><link href="33" rel="bibliography" /><sup>[<a class="sup">15</a>]</sup></citation>在2010年给出证明, 如果存在一个算法能够以指数级别接近于1的概率解决判定性<b>LWE</b>问题, 那么就存在一个更加高效的算法, 能以指数级别接近于1的概率解决计算性<b>LWE</b>问题。即解决判定性<b>LWE</b>问题的优势不大于解决<b>LWE</b>问题的优势<citation id="301" type="reference"><link href="35" rel="bibliography" /><sup>[<a class="sup">16</a>]</sup></citation>。</p>
                </div>
                <h3 id="83" name="83" class="anchor-tag">2 分层身份基多用户全同态加密方案</h3>
                <h4 class="anchor-tag" id="84" name="84">2.1 <b>屏蔽系统</b></h4>
                <div class="p1">
                    <p id="85">由文献<citation id="302" type="reference">[<a class="sup">4</a>]</citation>的转化机制可知, 一个IBE方案可以被转化为IBFHE方案, 如果满足以下三条性质<citation id="303" type="reference"><link href="11" rel="bibliography" /><sup>[<a class="sup">4</a>]</sup></citation>:</p>
                </div>
                <div class="p1">
                    <p id="86">性质1 身份信息ID对应的解密密钥为<b><i>s</i></b><sub>ID</sub>∈<i>Z</i><mathml id="87"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msubsup><mrow></mrow><mi>q</mi><msup><mi>m</mi><mo>′</mo></msup></msubsup></mrow></math></mathml>, 对应密文为<b><i>c</i></b><sub>ID</sub>∈<i>Z</i><mathml id="88"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msubsup><mrow></mrow><mi>q</mi><msup><mi>m</mi><mo>′</mo></msup></msubsup></mrow></math></mathml>, 并且向量<b><i>s</i></b><sub>ID</sub>的第一个系数为1。</p>
                </div>
                <div class="p1">
                    <p id="89">性质2 如果<b><i>c</i></b><sub>ID</sub>为加密0得到的密文, 则〈<b><i>c</i></b><sub>ID</sub>, <b><i>s</i></b><sub>ID</sub>〉=<i>e</i>, 结果为一个小的噪声。</p>
                </div>
                <div class="p1">
                    <p id="90">性质3 加密0得到的密文向量与<i>Z</i><mathml id="91"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msubsup><mrow></mrow><mi>q</mi><msup><mi>m</mi><mo>′</mo></msup></msubsup></mrow></math></mathml>上的均匀分布向量不可区分。</p>
                </div>
                <div class="p1">
                    <p id="92">为了将身份基全同态加密方案转化为身份基多用户全同态加密方案, 应当为IBE方案构造一个相应的屏蔽系统, 并满足其正确性和安全性。</p>
                </div>
                <div class="p1">
                    <p id="93"><b>定义</b>4 设<i>ε</i>为一个IBE方案, 满足上述三条性质, <i>ε</i>的屏蔽系统<i>MS</i><sub><i>ε</i></sub>由一对多项式时间算法组成 (GenUnivMask, DeriveMask) , 具体描述如下<citation id="304" type="reference"><link href="15" rel="bibliography" /><sup>[<a class="sup">6</a>]</sup></citation>:</p>
                </div>
                <div class="p1">
                    <p id="94">GenUnivMask (<i>PP</i>, ID, <i>μ</i>) :输入<i>ε</i>的公共参数<i>PP</i>, 身份信息<i>ID</i>和明文<i>μ</i>∈{0, 1}, 输出通用屏蔽<i>U</i>∈{0, 1}<sup>*</sup>。</p>
                </div>
                <div class="p1">
                    <p id="95">输入<i>ε</i>的公共参数<i>PP</i>, 身份信息ID′和通用屏蔽<b><i>U</i></b>∈{0, 1}<sup>*</sup>, 输出一对矩阵 (<b><i>X</i></b>, <b><i>Y</i></b>) ∈ (<i>Z</i><mathml id="96"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msubsup><mrow></mrow><mi mathvariant="bold-italic">q</mi><mrow><mi mathvariant="bold-italic">Ν</mi><mo>×</mo><mi mathvariant="bold-italic">Ν</mi></mrow></msubsup></mrow></math></mathml>) <sup>2</sup>。</p>
                </div>
                <div class="p1">
                    <p id="97">一个屏蔽系统<i>MS</i><sub><i>ε</i></sub>应当满足以下两条性质:</p>
                </div>
                <div class="p1">
                    <p id="98">正确性 设<i>λ</i>为安全参数, <i>ω</i>=<i>ω</i> (<i>λ</i>) 表示误差扩展因子, 为<i>λ</i>的多项式级别。对任意的 (<i>PP</i>, <i>MSK</i>) ←<i>ε</i>.Setup (1<sup><i>λ</i></sup>) , 任意的身份信息<i>ID</i>, <i>ID</i>′, 调用密钥生成函数得到<b><i>s</i></b><sub>ID</sub>, <b><i>s</i></b><sub>ID′</sub>, 令<b><i>v</i></b><sub>ID</sub>=Powersoft2 (<b><i>s</i></b><sub>ID</sub>) , <b><i>v</i></b><sub>ID′</sub>=Powersoft2 (<b><i>s</i></b><sub>ID′</sub>) , 明文空间<i>μ</i>∈{0, 1}, (<b><i>X</i></b>, <b><i>Y</i></b>) ∈ (<i>Z</i><mathml id="99"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msubsup><mrow></mrow><mi mathvariant="bold-italic">q</mi><mrow><mi mathvariant="bold-italic">Ν</mi><mo>×</mo><mi mathvariant="bold-italic">Ν</mi></mrow></msubsup></mrow></math></mathml>) <sup>2</sup>由以上算法得出, 则必须满足<b><i>X</i></b>·<b><i>v</i></b><sub>ID</sub>+<b><i>Y</i></b>·<b><i>v</i></b><sub>ID′</sub>=<i>μ</i>·<b><i>v</i></b><sub>ID′</sub>+<b><i>e</i></b>成立, 其中<mathml id="100"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo stretchy="false">∥</mo><mrow><mo>|</mo><mi mathvariant="bold-italic">e</mi><mo>|</mo></mrow><mo stretchy="false">∥</mo><msub><mrow></mrow><mi>∞</mi></msub><mo>≤</mo><mi>ω</mi><mo>⋅</mo><mi>B</mi></mrow></math></mathml>。</p>
                </div>
                <div class="p1">
                    <p id="101">安全性 如果对于所有的多项式时间敌手A, 给定公共参数及<b><i>U</i></b><sup>*</sup>←GenUnivMask (<i>PP</i>, ID<sup>*</sup>, <i>μ</i><sub><i>b</i></sub>) , 其中ID<sup>*</sup>为敌手的目标身份, <mathml id="102"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi mathvariant="bold-italic">b</mi><mover><mo stretchy="true" symmetric="false">←</mo><mi>＄</mi></mover><mo stretchy="false">{</mo><mn>0</mn><mo>, </mo><mn>1</mn><mo stretchy="false">}</mo></mrow></math></mathml>为挑战者随机选择的明文位, 攻击者在IND-ID-CPA (<i>X</i>∈{<b><i>s</i></b><sub>ID</sub>, ID}) 游戏中成功区分<i>μ</i><sub>0</sub>和<i>μ</i><sub>1</sub>的概率可以忽略不计, 则称该方案是选择性安全的。</p>
                </div>
                <h4 class="anchor-tag" id="103" name="103">2.2 <b>本文身份基多用户全同态加密方案</b></h4>
                <div class="p1">
                    <p id="104">利用文献<citation id="305" type="reference">[<a class="sup">6</a>]</citation>的转化机制, 对RO模型下的[CHKP10]方案构造相应的屏蔽系统<i>MS</i><sub>[CHKP10]</sub>, 从而得到一个新的身份基多用户全同态加密方案, 表示为mHIBFHE, 具体方案如下。</p>
                </div>
                <h4 class="anchor-tag" id="105" name="105">1) mHIBFHE.setup (<i>d</i>, <i>λ</i>) :</h4>
                <div class="p1">
                    <p id="106">设<i>d</i>表示身份信息向量的最大长度, <i>κ</i>为参与方不同身份信息个数的最大值, 则定义身份信息集合<i>I</i>= (ID<sub>1</sub>, ID<sub>2</sub>, …, ID<sub><i>κ</i></sub>) 。设ℓ<sub><i>q</i></sub>=⎣log <i>q</i>」+1, 调用文献<citation id="306" type="reference">[<a class="sup">8</a>]</citation>中的GenBasis (1<sup><i>n</i></sup>, 1<sup><i>m</i></sup>, <i>q</i>) 算法生成统计均匀的矩阵<b><i>A</i></b><sub>0 </sub>∈<i>Z</i><mathml id="107"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msubsup><mrow></mrow><mi>q</mi><mrow><mi>n</mi><mo>×</mo><mi>m</mi></mrow></msubsup></mrow></math></mathml>, 构造随机格∧<sup>⊥</sup> (<b><i>A</i></b><sub>0</sub>) ={<b><i>y</i></b>∈<i>Z</i><sup><i>n</i></sup>|<b><i>A</i></b><sub>0</sub>·<b><i>y</i></b>=0 mod <i>q</i>) , 在格中选择一组短的基<b><i>S</i></b><sub>0</sub>∈<i>Z</i><mathml id="108"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msubsup><mrow></mrow><mrow></mrow><mrow><mi>m</mi><mo>×</mo><mi>m</mi></mrow></msubsup></mrow></math></mathml>。对于任意 (<i>i</i>, <i>b</i>) ∈[<i>d</i>]×{0, 1}, 选取一组均匀、相互独立的矩阵<b><i>A</i></b><mathml id="109"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msubsup><mrow></mrow><mi>i</mi><mi>b</mi></msubsup></mrow></math></mathml>∈<i>Z</i><mathml id="110"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msubsup><mrow></mrow><mi>q</mi><mrow><mi>n</mi><mo>×</mo><mi>m</mi></mrow></msubsup></mrow></math></mathml>。随机均匀选取<b><i>z</i></b>∈<i>Z</i><mathml id="111"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msubsup><mrow></mrow><mi>q</mi><mi>n</mi></msubsup></mrow></math></mathml>, 输出<i>MPK</i>= (<b><i>A</i></b><sub>0</sub>, {<b><i>A</i></b><mathml id="112"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msubsup><mrow></mrow><mi>i</mi><mi>b</mi></msubsup></mrow></math></mathml>}, <i>z</i>, <i>d</i>) ;<i>MSK</i>=<b><i>S</i></b><sub>0</sub>。</p>
                </div>
                <h4 class="anchor-tag" id="113" name="113">2) mHIBFHE.KeyGen (<i>MSK</i>, ID) :</h4>
                <div class="p1">
                    <p id="114">设<i>t</i>≤<i>d</i>, 身份信息ID= (<i>id</i><sub>1</sub>, <i>id</i><sub>2</sub>, …, <i>id</i><sub><i>t</i></sub>) ∈{0, 1}<sup><i>t</i></sup>。定义<b><i>A</i></b><sub>ID</sub>={<b><i>A</i></b><sub>0</sub>‖<b><i>A</i></b><mathml id="115"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msubsup><mrow></mrow><mn>1</mn><mrow><mi>i</mi><mi>d</mi><msub><mrow></mrow><mn>1</mn></msub></mrow></msubsup></mrow></math></mathml>‖<b><i>A</i></b><mathml id="116"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msubsup><mrow></mrow><mn>2</mn><mrow><mi>i</mi><mi>d</mi><msub><mrow></mrow><mn>2</mn></msub></mrow></msubsup></mrow></math></mathml>‖…‖<b><i>A</i></b><mathml id="117"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msubsup><mrow></mrow><mi>t</mi><mrow><mi>i</mi><mi>d</mi><msub><mrow></mrow><mi>t</mi></msub></mrow></msubsup></mrow></math></mathml>) ∈<i>Z</i><mathml id="118"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msubsup><mrow></mrow><mi>q</mi><mrow><mi>n</mi><mo>×</mo><mo stretchy="false"> (</mo><mi>t</mi><mo>+</mo><mn>1</mn><mo stretchy="false">) </mo><mi>m</mi></mrow></msubsup></mrow></math></mathml>, 调用文献<citation id="307" type="reference">[<a class="sup">8</a>]</citation>中的函数ExtBasis (<i>S</i><sub>0</sub>, <b><i>A</i></b><sub>ID</sub>) 生成身份信息ID对应的<b><i>S</i></b><sub>ID</sub>, 作为格∧<sup>⊥</sup> (<b><i>A</i></b><sub>ID</sub>) ={<i>x</i>∈<i>Z</i><sup><i>n</i></sup>|<b><i>A</i></b><sub>ID</sub>·<b><i>x</i></b>=0 mod <i>q</i>) 的一组短基。调用文献<citation id="308" type="reference">[<a class="sup">8</a>]</citation>中的函数SampleD (<i>S</i><sub>ID</sub>, <b><i>A</i></b><sub>ID</sub>, <b><i>z</i></b><sub>ID</sub>) 生成<i>t</i><sub>ID</sub>, <b><i>s</i></b><sub>ID</sub>= (1, -<b><i>t</i></b><sub>ID</sub>) 。令<b><i>A</i></b><sub>ID</sub>′=<b><i>z</i></b><sub>ID</sub>‖<b><i>A</i></b><sub>ID</sub>, 满足<b><i>A</i></b><sub>ID</sub>·<b><i>t</i></b><sub>ID</sub>=<b><i>z</i></b><sub>ID</sub> mod <i>q</i>, <b><i>A</i></b><sub>ID</sub>′·<b><i>s</i></b><sub>ID</sub>=0 mod <i>q</i>。由以上可知, 身份ID对应的私钥为<b><i>s</i></b><sub>ID</sub>。</p>
                </div>
                <div class="p1">
                    <p id="119">设ID<sub><i>i</i></sub>= (<i>id</i><sub>1</sub>, <i>id</i><sub>2</sub>, …, <i>id</i><sub><i>t</i><sub><i>i</i></sub></sub>) ∈{0, 1}<sup><i>t</i><sub><i>i</i></sub></sup>为低层的身份信息, 由分层身份基方案的性质可知, ID<sub><i>i</i></sub>的前缀为ID, 即ID<sub><i>i</i></sub>= (ID<mathml id="120"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo stretchy="false">∥</mo><mover accent="true"><mrow><mtext>Ι</mtext><mtext>D</mtext></mrow><mo stretchy="true">¯</mo></mover><mo stretchy="false">) </mo><mo>, </mo><mspace width="0.25em" /><mi>t</mi><msub><mrow></mrow><mi>i</mi></msub><mo>≤</mo><mi>d</mi><mo>, </mo><mi mathvariant="bold-italic">A</mi><msub><mrow></mrow><mrow><mtext>Ι</mtext><mtext>D</mtext><msub><mrow></mrow><mi>i</mi></msub></mrow></msub><mo>=</mo><mi mathvariant="bold-italic">A</mi><msub><mrow></mrow><mrow><mtext>Ι</mtext><mtext>D</mtext></mrow></msub><mo stretchy="false">∥</mo><mi mathvariant="bold-italic">A</mi><msub><mrow></mrow><mrow><mover accent="true"><mrow><mtext>Ι</mtext><mtext>D</mtext></mrow><mo stretchy="true">¯</mo></mover></mrow></msub><mo>=</mo><mi mathvariant="bold-italic">A</mi><msub><mrow></mrow><mn>0</mn></msub><mo stretchy="false">∥</mo><mo>⋯</mo><mo stretchy="false">∥</mo><mi mathvariant="bold-italic">A</mi><msubsup><mrow></mrow><mi>t</mi><mrow><mi>i</mi><mi>d</mi><msub><mrow></mrow><mi>t</mi></msub></mrow></msubsup><mo stretchy="false">∥</mo><mo>⋯</mo><mo stretchy="false">∥</mo><mrow><mi mathvariant="bold-italic">A</mi><msubsup><mrow></mrow><mrow><mi>t</mi><msub><mrow></mrow><mi>i</mi></msub></mrow><mrow><mi>i</mi><mi>d</mi><msub><mrow></mrow><mrow><mi>t</mi><msub><mrow></mrow><mi>i</mi></msub></mrow></msub></mrow></msubsup><mo>∈</mo></mrow><mi>Ζ</mi><msubsup><mrow></mrow><mi>q</mi><mrow><mi>n</mi><mo>×</mo><mo stretchy="false"> (</mo><mi>t</mi><msub><mrow></mrow><mi>i</mi></msub><mo>+</mo><mn>1</mn><mo stretchy="false">) </mo><mi>m</mi></mrow></msubsup></mrow></math></mathml>。调用函数ExtBasis (<b><i>S</i></b><sub>ID</sub>, <b><i>A</i></b><sub>ID<sub><i>i</i></sub></sub>) 生成身份信息ID<sub><i>i</i></sub>对应的<b><i>S</i></b><sub>ID<sub><i>i</i></sub></sub>, 继续调用函数SampleD (<b><i>S</i></b><sub>ID<sub><i>i</i></sub></sub>, <b><i>A</i></b><sub>ID<sub><i>i</i></sub></sub>, <b><i>z</i></b><sub>ID<sub><i>i</i></sub></sub>) , 生成<b><i>t</i></b><sub>ID<sub><i>i</i></sub></sub>, <b><i>s</i></b><sub>ID<sub><i>i</i></sub></sub>= (1, -<b><i>t</i></b><sub>ID<sub><i>i</i></sub></sub>) , 得到低层身份ID<sub><i>i</i></sub>对应的私钥。</p>
                </div>
                <h4 class="anchor-tag" id="121" name="121">3) mHIBFHE.enc (<i>PP</i>, ID, <i>μ</i>) :</h4>
                <div class="p1">
                    <p id="122">为了在身份ID在下加密<i>μ</i>, 调用函数<i>MS</i><sub>[CM15]</sub>.GenUnivMask (<i>PP</i>, ID, <i>μ</i>) , 得到通用屏蔽信息<b><i>U</i></b>。输出密文组<i>CT</i>= (ID, <i>type</i>=0, <i>enc</i>=<b><i>U</i></b>) , <i>type</i>=0表示密文为“新鲜”密文。</p>
                </div>
                <h4 class="anchor-tag" id="123" name="123">4) mHIBFHE.eval (ℂ, <i>CT</i><sub>1</sub>, <i>CT</i><sub>2</sub>, …, <i>CT</i><sub>ℓ</sub>) :</h4>
                <div class="p1">
                    <p id="124">输入电路<i>C</i>∈ℂ和一组密文<i>CT</i><sub>1</sub>= (ID<sub>1</sub>, <i>type</i>=0, <i>enc</i>=<b><i>U</i></b><sub>1</sub>) , <i>CT</i><sub>2</sub>= (ID<sub>2</sub>, <i>type</i>=0, <i>enc</i>=<b><i>U</i></b><sub>2</sub>) , …, <i>CT</i><sub><i>l</i></sub>= (ID<sub><i>l</i></sub>, <i>type</i>=0, <i>enc</i>=<b><i>U</i></b><sub><i>l</i></sub>) 。</p>
                </div>
                <div class="p1">
                    <p id="125">为了能够对密文进行同态操作, 需要对已知新鲜密文<b><i>C</i></b>∈<i>Z</i><mathml id="126"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msubsup><mrow></mrow><mi mathvariant="bold-italic">q</mi><mrow><mi mathvariant="bold-italic">Ν</mi><mo>×</mo><mi mathvariant="bold-italic">Ν</mi></mrow></msubsup></mrow></math></mathml>进行处理, 得到相应的扩展密文<mathml id="127"><math xmlns="http://www.w3.org/1998/Math/MathML"><mover accent="true"><mi mathvariant="bold-italic">C</mi><mo>¯</mo></mover></math></mathml>∈<i>Z</i><mathml id="128"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msubsup><mrow></mrow><mi>q</mi><mrow><mi>κ</mi><mi>Ν</mi><mo>×</mo><mi>κ</mi><mi>Ν</mi></mrow></msubsup></mrow></math></mathml>。扩展密文从形式上可以表示为<i>κ</i>×<i>κ</i>的矩阵, <mathml id="129"><math xmlns="http://www.w3.org/1998/Math/MathML"><mover accent="true"><mi mathvariant="bold-italic">C</mi><mo>¯</mo></mover></math></mathml><sub><i>i</i>, <i>j</i></sub>表示第<i>i</i>行第<i>j</i>列的子块, 每个子块都是<i>Z</i><mathml id="130"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msubsup><mrow></mrow><mi>q</mi><mrow><mi>Ν</mi><mo>×</mo><mi>Ν</mi></mrow></msubsup></mrow></math></mathml>的矩阵, 得到扩展密文的过程如下:</p>
                </div>
                <div class="p1">
                    <p id="131" class="code-formula">
                        <mathml id="131"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mrow><mo>{</mo><mtable columnalign="left"><mtr><mtd><mo stretchy="false"> (</mo><mi mathvariant="bold-italic">X</mi><msub><mrow></mrow><mi>i</mi></msub><mo>, </mo><mi mathvariant="bold-italic">Y</mi><msub><mrow></mrow><mi>i</mi></msub><mo stretchy="false">) </mo><mo>←</mo><mi>Μ</mi><mi>S</mi><msub><mrow></mrow><mrow><mo stretchy="false">[</mo><mtext>C</mtext><mtext>Μ</mtext><mn>1</mn><mn>5</mn><mo stretchy="false">]</mo></mrow></msub><mo>.</mo><mtext>D</mtext><mtext>e</mtext><mtext>r</mtext><mtext>i</mtext><mtext>v</mtext><mtext>e</mtext><mtext>Μ</mtext><mtext>a</mtext><mtext>s</mtext><mtext>k</mtext><mo stretchy="false"> (</mo><mi>Ρ</mi><mi>Ρ</mi><mo>, </mo><mi>U</mi><mo>, </mo><mtext>Ι</mtext><mtext>D</mtext><msub><mrow></mrow><mi>i</mi></msub><mo stretchy="false">) </mo></mtd></mtr><mtr><mtd><mover accent="true"><mi mathvariant="bold-italic">C</mi><mo>¯</mo></mover><msub><mrow></mrow><mrow><mi>i</mi><mo>, </mo><mi>i</mi></mrow></msub><mo>←</mo><mi mathvariant="bold-italic">Y</mi><msub><mrow></mrow><mi>i</mi></msub></mtd></mtr><mtr><mtd><mtext>当</mtext><mi>i</mi><mo>=</mo><mi>r</mi><mtext>时</mtext><mo>, </mo><mtext>有</mtext><mover accent="true"><mi mathvariant="bold-italic">C</mi><mo>¯</mo></mover><msub><mrow></mrow><mrow><mi>i</mi><mo>, </mo><mi>r</mi></mrow></msub><mo>←</mo><mtext>F</mtext><mtext>l</mtext><mtext>a</mtext><mtext>t</mtext><mtext>t</mtext><mtext>e</mtext><mtext>n</mtext><mo stretchy="false"> (</mo><mover accent="true"><mi mathvariant="bold-italic">C</mi><mo>¯</mo></mover><msub><mrow></mrow><mrow><mi>i</mi><mo>, </mo><mi>r</mi></mrow></msub><mo>+</mo><mi mathvariant="bold-italic">X</mi><msub><mrow></mrow><mi>i</mi></msub><mo stretchy="false">) </mo></mtd></mtr></mtable></mrow></mrow></math></mathml>
                    </p>
                </div>
                <div class="p1">
                    <p id="132">设 (ID<sub><i>r</i></sub>, <i>type</i>=0, <i>enc</i>=<b><i>U</i></b>) 表示不同参与方中的第<i>r</i>个用户得到的新鲜密文, 则<mathml id="133"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mover accent="true"><mi mathvariant="bold-italic">C</mi><mo>¯</mo></mover><msup><mrow></mrow><mrow><mo stretchy="false"> (</mo><mi>r</mi><mo stretchy="false">) </mo></mrow></msup><mo>∈</mo><mi>Ζ</mi><msubsup><mrow></mrow><mi>q</mi><mrow><mi>κ</mi><mi>Ν</mi><mo>×</mo><mi>κ</mi><mi>Ν</mi></mrow></msubsup><mo stretchy="false"> (</mo><mi>κ</mi><mo>&gt;</mo><mn>2</mn><mo stretchy="false">) </mo></mrow></math></mathml>的形式如下:</p>
                </div>
                <div class="p1">
                    <p id="134" class="code-formula">
                        <mathml id="134"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mover accent="true"><mi mathvariant="bold-italic">C</mi><mo>¯</mo></mover><msup><mrow></mrow><mrow><mo stretchy="false"> (</mo><mi>r</mi><mo stretchy="false">) </mo></mrow></msup><mo>=</mo><mrow><mo>[</mo><mrow><mtable><mtr><mtd><mi mathvariant="bold-italic">Y</mi><msub><mrow></mrow><mn>1</mn></msub></mtd><mtd><mn>0</mn></mtd><mtd><mo>⋯</mo></mtd><mtd><mi mathvariant="bold-italic">X</mi><msub><mrow></mrow><mn>1</mn></msub></mtd><mtd><mspace width="0.25em" /><mo>⋯</mo></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mi mathvariant="bold-italic">Y</mi><msub><mrow></mrow><mn>2</mn></msub></mtd><mtd><mo>⋯</mo></mtd><mtd><mi mathvariant="bold-italic">X</mi><msub><mrow></mrow><mn>2</mn></msub></mtd><mtd><mo>⋯</mo></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mo>⋮</mo></mtd><mtd><mo>⋮</mo></mtd><mtd></mtd><mtd><mo>⋮</mo></mtd><mtd></mtd><mtd><mo>⋮</mo></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mo>⋯</mo></mtd><mtd><mtext>F</mtext><mtext>l</mtext><mtext>a</mtext><mtext>t</mtext><mtext>t</mtext><mtext>e</mtext><mtext>n</mtext><mo stretchy="false"> (</mo><mi mathvariant="bold-italic">X</mi><msub><mrow></mrow><mi>r</mi></msub><mo>+</mo><mi mathvariant="bold-italic">Y</mi><msub><mrow></mrow><mi>r</mi></msub><mo stretchy="false">) </mo></mtd><mtd><mo>⋯</mo></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mo>⋮</mo></mtd><mtd><mo>⋮</mo></mtd><mtd></mtd><mtd><mo>⋮</mo></mtd><mtd></mtd><mtd><mo>⋮</mo></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mi mathvariant="bold-italic">X</mi><msub><mrow></mrow><mi>κ</mi></msub></mtd><mtd><mo>⋯</mo></mtd><mtd><mi mathvariant="bold-italic">Y</mi><msub><mrow></mrow><mi>κ</mi></msub></mtd></mtr></mtable></mrow><mo>]</mo></mrow></mrow></math></mathml>
                    </p>
                </div>
                <div class="p1">
                    <p id="135">其中, <b><i>X</i></b><sub><i>i</i></sub>位于第<i>r</i>列。</p>
                </div>
                <div class="p1">
                    <p id="136">对每个输入密文<b><i>C</i></b>进行相应运算, 得到扩展密文<mathml id="137"><math xmlns="http://www.w3.org/1998/Math/MathML"><mover accent="true"><mi mathvariant="bold-italic">C</mi><mo>¯</mo></mover></math></mathml><sup> (<i>r</i>) </sup>。将扩展矩阵<mathml id="138"><math xmlns="http://www.w3.org/1998/Math/MathML"><mover accent="true"><mi mathvariant="bold-italic">C</mi><mo>¯</mo></mover></math></mathml>输入电路ℂ (由与非门电路构成) 进行同态运算, 得到新的扩展矩阵<mathml id="139"><math xmlns="http://www.w3.org/1998/Math/MathML"><mover accent="true"><mi mathvariant="bold-italic">C</mi><mo>¯</mo></mover></math></mathml>′, 对应明文为ℂ (<i>μ</i><sub>1</sub>, <i>μ</i><sub>2</sub>, …, <i>μ</i><sub><i>κ</i></sub>) , 输出结果为<i>CT</i>′= (ID<sub>1</sub>, ID<sub>2</sub>, …, ID<sub><i>κ</i></sub>;<i>type</i>=1;<mathml id="140"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>e</mi><mi>n</mi><mi>c</mi><mo>=</mo><msup><mover accent="true"><mi mathvariant="bold-italic">C</mi><mo>¯</mo></mover><mo>′</mo></msup><mo stretchy="false">) </mo><mo>, </mo><mi>t</mi><mi>y</mi><mi>p</mi><mi>e</mi><mo>=</mo><mn>1</mn></mrow></math></mathml>表示经过同态操作后得到的新密文。由式<b><i>X</i></b>·<b><i>v</i></b><sub>ID</sub>+<b><i>Y</i></b>·<b><i>v</i></b><sub>ID′</sub>=<i>μ</i>·<b><i>v</i></b><sub>ID′</sub>+<b><i>e</i></b>可知, <mathml id="141"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msup><mover accent="true"><mi mathvariant="bold-italic">C</mi><mo>¯</mo></mover><mo>′</mo></msup><mo>⋅</mo><mi mathvariant="bold-italic">v</mi><mo>=</mo><mi>ℂ</mi><mo stretchy="false"> (</mo><mi>μ</mi><msub><mrow></mrow><mn>1</mn></msub><mo>, </mo><mspace width="0.25em" /><mi>μ</mi><msub><mrow></mrow><mn>2</mn></msub><mo>, </mo><mo>⋯</mo><mo>, </mo><mspace width="0.25em" /><mi>μ</mi><msub><mrow></mrow><mi>κ</mi></msub><mo stretchy="false">) </mo><mo>⋅</mo><mi mathvariant="bold-italic">v</mi><mo>+</mo><mi mathvariant="bold-italic">e</mi><mo>´</mo></mrow></math></mathml>成立。</p>
                </div>
                <h4 class="anchor-tag" id="142" name="142">5) mHIBFHE.dec (<i>CT</i>, <b><i>v</i></b>) :</h4>
                <div class="p1">
                    <p id="143">分两种情况进行讨论:当<i>type</i>=0时, <i>CT</i>= (ID<sub>1</sub>;<i>type</i>=0;<i>enc</i>=<b><i>U</i></b>) , (<b><i>X</i></b>, <b><i>Y</i></b>) =<i>MS</i><sub>[CM15]</sub>.DeriveMask (<i>PP</i>, <b><i>U</i></b>, ID<sub>1</sub>) , 令<b><i>C</i></b>←<b><i>X</i></b>+<b><i>Y</i></b>, 有<i>C</i>·<b><i>v</i></b><sub>ID<sub>1</sub></sub>=<i>μ</i>·<b><i>v</i></b><sub>ID<sub>1</sub></sub>+<b><i>e</i></b>成立。</p>
                </div>
                <div class="p1">
                    <p id="144">当<i>type</i>=1时, <i>CT</i>= (ID<sub>1</sub>, ID<sub>2</sub>, …, ID<sub><i>κ</i></sub>;<i>type</i>=1;<mathml id="145"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi mathvariant="bold-italic">e</mi><mi mathvariant="bold-italic">n</mi><mi mathvariant="bold-italic">c</mi><mo>=</mo><mover accent="true"><mi mathvariant="bold-italic">C</mi><mo>¯</mo></mover><mo stretchy="false">) </mo></mrow></math></mathml>, 令<b><i>C</i></b>←<mathml id="146"><math xmlns="http://www.w3.org/1998/Math/MathML"><mover accent="true"><mi mathvariant="bold-italic">C</mi><mo>¯</mo></mover></math></mathml>, 由式<b><i>X</i></b>·<b><i>v</i></b><sub>ID</sub>+<b><i>Y</i></b>·<b><i>v</i></b><sub>ID′</sub>=<i>μ</i>·<b><i>v</i></b><sub>ID′</sub>+<b><i>e</i></b>可知, <b><i>C</i></b>·<b><i>v</i></b>=<i>μ</i>·<b><i>v</i></b>+<b><i>e</i></b>。</p>
                </div>
                <div class="p1">
                    <p id="147">令ℓ<sub><i>q</i></sub>=⎣log <i>q</i>」+1, <b><i>v</i></b>←Powersoft2 (<b><i>s</i></b><sub>ID</sub>) , 则<b><i>v</i></b>的前ℓ<sub><i>q</i></sub>个系数为 (2<sup>0</sup>, 2<sup>1</sup>, …, 2<sup>ℓ<sub><i>q</i></sub>-1</sup>) , 在前ℓ<sub><i>q</i></sub>个系数中选取, 选取<i>v</i><sub><i>j</i></sub>=2<sup><i>j</i></sup>∈ (<i>q</i>/4, <i>q</i>/2]为<b><i>C</i></b>的第<i>j</i>行, 计算<i>μ</i>′=〈<b><i>c</i></b><sub><i>i</i></sub>, <b><i>v</i></b>〉= (<i>μ</i>·<b><i>v</i></b><sub><i>i</i></sub>+<b><i>e</i></b>) , 对<i>μ</i>′进行取整, 得到解密值。</p>
                </div>
                <h4 class="anchor-tag" id="148" name="148">2.3 <b>同态运算</b></h4>
                <div class="p1">
                    <p id="149">设<b><i>C</i></b><sup>1</sup>、<b><i>C</i></b><sup>2</sup>分别为<i>μ</i><sub>1</sub>、 <i>μ</i><sub>2</sub>在ID<sub>1</sub>, ID<sub>2</sub>下加密得到的密文矩阵, 对应私钥分别为<b><i>s</i></b><sub>ID<sub>1</sub></sub>, <b><i>s</i></b><sub>ID<sub>2</sub></sub>, 令<b><i>v</i></b><sub>1</sub>←powersoft2 (<b><i>s</i></b><sub>ID<sub>1</sub></sub>) , <b><i>v</i></b><sub>2</sub>←powersoft2 (<b><i>s</i></b><sub>ID<sub>2</sub></sub>) , 则<b><i>C</i></b><sup>1</sup>·<b><i>v</i></b><sub>1</sub>=<i>μ</i><sub>1</sub>·<b><i>v</i></b><sub>1</sub>+<b><i>e</i></b><sub>1</sub>, <b><i>C</i></b><sup>2</sup>·<b><i>v</i></b><sub>2</sub>=<i>μ</i><sub>2</sub>·<b><i>v</i></b><sub>2</sub>+<b><i>e</i></b><sub>2</sub>成立。</p>
                </div>
                <div class="p1">
                    <p id="150">令<mathml id="151"><math xmlns="http://www.w3.org/1998/Math/MathML"><mover accent="true"><mi mathvariant="bold-italic">C</mi><mo>¯</mo></mover></math></mathml>表示密文矩阵的扩展矩阵, <b><i>v</i></b>是<b><i>v</i></b><sub>1</sub>, <b><i>v</i></b><sub>2</sub>, …, <b><i>v</i></b><sub><i>κ</i></sub>的垂直级联, 则有<mathml id="152"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mover accent="true"><mi mathvariant="bold-italic">C</mi><mo>¯</mo></mover><msup><mrow></mrow><mn>1</mn></msup><mo>⋅</mo><mi mathvariant="bold-italic">v</mi><mo>=</mo><mi>μ</mi><msub><mrow></mrow><mn>1</mn></msub><mo>⋅</mo><mi mathvariant="bold-italic">v</mi><mo>+</mo><mi mathvariant="bold-italic">e</mi><msub><mrow></mrow><mn>1</mn></msub><mo>, </mo><mover accent="true"><mi mathvariant="bold-italic">C</mi><mo>¯</mo></mover><msup><mrow></mrow><mn>2</mn></msup><mo>⋅</mo><mi mathvariant="bold-italic">v</mi><mo>=</mo><mi>μ</mi><msub><mrow></mrow><mn>2</mn></msub><mo>⋅</mo><mi mathvariant="bold-italic">v</mi><mo>+</mo><mi mathvariant="bold-italic">e</mi><msub><mrow></mrow><mn>2</mn></msub></mrow></math></mathml>成立。</p>
                </div>
                <div class="p1">
                    <p id="153">同态加法运算Add (<mathml id="154"><math xmlns="http://www.w3.org/1998/Math/MathML"><mover accent="true"><mi mathvariant="bold-italic">C</mi><mo>¯</mo></mover></math></mathml><sup>1</sup>, <mathml id="155"><math xmlns="http://www.w3.org/1998/Math/MathML"><mover accent="true"><mi mathvariant="bold-italic">C</mi><mo>¯</mo></mover></math></mathml><sup>2</sup>) :输入 (<mathml id="156"><math xmlns="http://www.w3.org/1998/Math/MathML"><mover accent="true"><mi mathvariant="bold-italic">C</mi><mo>¯</mo></mover></math></mathml><sup>1</sup>, <mathml id="157"><math xmlns="http://www.w3.org/1998/Math/MathML"><mover accent="true"><mi mathvariant="bold-italic">C</mi><mo>¯</mo></mover></math></mathml><sup>2</sup>) , 输出Flatten<mathml id="158"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo stretchy="false"> (</mo><mover accent="true"><mi mathvariant="bold-italic">C</mi><mo>¯</mo></mover><msup><mrow></mrow><mn>1</mn></msup><mo>+</mo><mover accent="true"><mi mathvariant="bold-italic">C</mi><mo>¯</mo></mover><msup><mrow></mrow><mn>2</mn></msup><mo stretchy="false">) </mo></mrow></math></mathml>, 有Add<mathml id="159"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo stretchy="false"> (</mo><mover accent="true"><mi mathvariant="bold-italic">C</mi><mo>¯</mo></mover><msup><mrow></mrow><mn>1</mn></msup><mo>, </mo><mover accent="true"><mi mathvariant="bold-italic">C</mi><mo>¯</mo></mover><msup><mrow></mrow><mn>2</mn></msup><mo stretchy="false">) </mo><mo>⋅</mo><mi mathvariant="bold-italic">v</mi><mo>=</mo><mo stretchy="false"> (</mo><mover accent="true"><mi mathvariant="bold-italic">C</mi><mo>¯</mo></mover><msup><mrow></mrow><mn>1</mn></msup><mo>+</mo><mover accent="true"><mi mathvariant="bold-italic">C</mi><mo>¯</mo></mover><msup><mrow></mrow><mn>2</mn></msup><mo stretchy="false">) </mo><mo>⋅</mo><mi mathvariant="bold-italic">v</mi><mo>=</mo><mo stretchy="false"> (</mo><mrow><mi>μ</mi><msub><mrow></mrow><mn>1</mn></msub><mo>+</mo></mrow><mi>μ</mi><msub><mrow></mrow><mn>2</mn></msub><mo stretchy="false">) </mo><mo>⋅</mo><mi mathvariant="bold-italic">v</mi><mo>+</mo><mo stretchy="false"> (</mo><mi mathvariant="bold-italic">e</mi><msub><mrow></mrow><mn>1</mn></msub><mo>+</mo><mi mathvariant="bold-italic">e</mi><msub><mrow></mrow><mn>2</mn></msub><mo stretchy="false">) </mo></mrow></math></mathml>成立。</p>
                </div>
                <div class="p1">
                    <p id="160">同态乘法运算Multi (<mathml id="161"><math xmlns="http://www.w3.org/1998/Math/MathML"><mover accent="true"><mi mathvariant="bold-italic">C</mi><mo>¯</mo></mover></math></mathml><sup>1</sup>, <mathml id="162"><math xmlns="http://www.w3.org/1998/Math/MathML"><mover accent="true"><mi mathvariant="bold-italic">C</mi><mo>¯</mo></mover></math></mathml><sup>2</sup>) :输入 (<mathml id="163"><math xmlns="http://www.w3.org/1998/Math/MathML"><mover accent="true"><mi mathvariant="bold-italic">C</mi><mo>¯</mo></mover></math></mathml><sup>1</sup>, <mathml id="164"><math xmlns="http://www.w3.org/1998/Math/MathML"><mover accent="true"><mi mathvariant="bold-italic">C</mi><mo>¯</mo></mover></math></mathml><sup>2</sup>) , 输出Flatten (<mathml id="165"><math xmlns="http://www.w3.org/1998/Math/MathML"><mover accent="true"><mi mathvariant="bold-italic">C</mi><mo>¯</mo></mover></math></mathml><sup>1</sup>·<mathml id="166"><math xmlns="http://www.w3.org/1998/Math/MathML"><mover accent="true"><mi mathvariant="bold-italic">C</mi><mo>¯</mo></mover></math></mathml><sup>2</sup>) , 有</p>
                </div>
                <div class="p1">
                    <p id="167"><mathml id="168"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mtext>Μ</mtext><mtext>u</mtext><mtext>l</mtext><mtext>t</mtext><mtext>i</mtext><mo stretchy="false"> (</mo><mover accent="true"><mi mathvariant="bold-italic">C</mi><mo>¯</mo></mover><msup><mrow></mrow><mn>1</mn></msup><mo>⋅</mo><mover accent="true"><mi mathvariant="bold-italic">C</mi><mo>¯</mo></mover><msup><mrow></mrow><mn>2</mn></msup><mo stretchy="false">) </mo><mo>⋅</mo><mi mathvariant="bold-italic">v</mi><mo>=</mo><mo stretchy="false"> (</mo><mover accent="true"><mi mathvariant="bold-italic">C</mi><mo>¯</mo></mover><msup><mrow></mrow><mn>1</mn></msup><mo>⋅</mo><mover accent="true"><mi mathvariant="bold-italic">C</mi><mo>¯</mo></mover><msup><mrow></mrow><mn>2</mn></msup><mo stretchy="false">) </mo><mo>⋅</mo><mi mathvariant="bold-italic">v</mi><mo>=</mo><mover accent="true"><mi mathvariant="bold-italic">C</mi><mo>¯</mo></mover><msup><mrow></mrow><mn>1</mn></msup><mo>⋅</mo><mo stretchy="false"> (</mo><mi>μ</mi><msub><mrow></mrow><mn>2</mn></msub><mo>⋅</mo><mi mathvariant="bold-italic">v</mi><mo>+</mo><mrow><mi mathvariant="bold-italic">e</mi><msub><mrow></mrow><mn>2</mn></msub><mo stretchy="false">) </mo><mo>=</mo></mrow><mi>μ</mi><msub><mrow></mrow><mn>2</mn></msub><mover accent="true"><mi mathvariant="bold-italic">C</mi><mo>¯</mo></mover><msup><mrow></mrow><mn>1</mn></msup><mo>⋅</mo><mi mathvariant="bold-italic">v</mi><mo>+</mo><mover accent="true"><mi mathvariant="bold-italic">C</mi><mo>¯</mo></mover><msup><mrow></mrow><mn>1</mn></msup><mi mathvariant="bold-italic">e</mi><msub><mrow></mrow><mn>2</mn></msub><mo>=</mo><mi>μ</mi><msub><mrow></mrow><mn>2</mn></msub><mo stretchy="false"> (</mo><mi>μ</mi><msub><mrow></mrow><mn>1</mn></msub><mo>⋅</mo><mi mathvariant="bold-italic">v</mi><mo>+</mo><mi mathvariant="bold-italic">e</mi><msub><mrow></mrow><mn>1</mn></msub><mo stretchy="false">) </mo><mo>+</mo><mover accent="true"><mi mathvariant="bold-italic">C</mi><mo>¯</mo></mover><msup><mrow></mrow><mn>1</mn></msup><mi mathvariant="bold-italic">e</mi><msub><mrow></mrow><mn>2</mn></msub><mo>=</mo><mi>μ</mi><msub><mrow></mrow><mn>1</mn></msub><mi>μ</mi><msub><mrow></mrow><mn>2</mn></msub><mo>⋅</mo><mi mathvariant="bold-italic">v</mi><mo>+</mo><mo stretchy="false"> (</mo><mi>μ</mi><msub><mrow></mrow><mn>2</mn></msub><mi mathvariant="bold-italic">e</mi><msub><mrow></mrow><mn>1</mn></msub><mo>+</mo><mover accent="true"><mi mathvariant="bold-italic">C</mi><mo>¯</mo></mover><msup><mrow></mrow><mn>1</mn></msup><mi mathvariant="bold-italic">e</mi><msub><mrow></mrow><mn>2</mn></msub><mo stretchy="false">) </mo></mrow></math></mathml>成立。</p>
                </div>
                <h3 id="169" name="169" class="anchor-tag">3 方案分析</h3>
                <h4 class="anchor-tag" id="170" name="170">3.1 <b>正确性分析</b></h4>
                <div class="p1">
                    <p id="171"><b>定义</b>5 <i>B</i>强有界矩阵。设<i>B</i>为小于<i>q</i>的整数, <b><i>C</i></b>为加密明文<i>μ</i>对应的密文矩阵, <b><i>v</i></b>为对应的私钥, 并且有<b><i>C</i></b>·<b><i>v</i></b>=<i>μ</i>·<b><i>v</i></b>+<b><i>e</i></b>成立。当|<i>μ</i>|≤1时, <mathml id="172"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo stretchy="false">∥</mo><mrow><mo>|</mo><mi mathvariant="bold-italic">e</mi><mo>|</mo></mrow><mo stretchy="false">∥</mo><mo>≤</mo><mi>B</mi></mrow></math></mathml>且<mathml id="173"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo stretchy="false">∥</mo><mrow><mo>|</mo><mrow><mi mathvariant="bold-italic">C</mi><msub><mrow></mrow><mrow><mi>i</mi><mo>, </mo><mspace width="0.25em" /><mi>j</mi></mrow></msub></mrow><mo>|</mo></mrow><mo stretchy="false">∥</mo><msub><mrow></mrow><mi>∞</mi></msub><mo>≤</mo><mn>1</mn></mrow></math></mathml>时, 称<b><i>C</i></b>为<i>B</i>强有界矩阵<citation id="309" type="reference"><link href="11" rel="bibliography" /><sup>[<a class="sup">4</a>]</sup></citation>。</p>
                </div>
                <div class="p1">
                    <p id="174">由文献<citation id="310" type="reference">[<a class="sup">4</a>]</citation>可知, 当密文矩阵<b><i>C</i></b><sub>1</sub>, <b><i>C</i></b><sub>2</sub>∈<i>Z</i><mathml id="175"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msubsup><mrow></mrow><mi>q</mi><mrow><mi>Ν</mi><mo>×</mo><mi>Ν</mi></mrow></msubsup></mrow></math></mathml>为<i>B</i>强有界矩阵时, 进行同态乘法运算 (<b><i>C</i></b><sub>1</sub>·<b><i>C</i></b><sub>2</sub>) ·<b><i>v</i></b>=<i>μ</i><sub>1</sub><i>μ</i><sub>2</sub>·<b><i>v</i></b>+ (<b><i>C</i></b><sub>1</sub><b><i>e</i></b><sub>2</sub>+<i>μ</i><sub>2</sub><b><i>e</i></b><sub>1</sub>) , 噪声增长为<mathml id="176"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo stretchy="false">∥</mo><mrow><mo>|</mo><msup><mi mathvariant="bold-italic">e</mi><mo>′</mo></msup><mo>|</mo></mrow><mo stretchy="false">∥</mo><msub><mrow></mrow><mi>∞</mi></msub><mo>≤</mo><mo stretchy="false"> (</mo><mi>Ν</mi><mo>+</mo><mn>1</mn><mo stretchy="false">) </mo><mi>B</mi></mrow></math></mathml>。利用NAND门电路和校平技术, 使新的密文为Flatten (<b><i>C</i></b><sub>3</sub>) =Flatten (<i>I</i><sub><i>N</i></sub>-<b><i>C</i></b><sub>1</sub>·<b><i>C</i></b><sub>2</sub>) 仍为强有界矩阵, 设置参数<i>q</i>/<i>B</i>为<i>N</i>的指数级, 则当电路深度为<i>L</i>时, 噪声增长为<mathml id="177"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo stretchy="false">∥</mo><mrow><mo>|</mo><msup><mi mathvariant="bold-italic">e</mi><mo>″</mo></msup><mo>|</mo></mrow><mo stretchy="false">∥</mo><msub><mrow></mrow><mi>∞</mi></msub><mo>≤</mo><mo stretchy="false"> (</mo><mi>Ν</mi><mo>+</mo><mn>1</mn><mo stretchy="false">) </mo><msup><mrow></mrow><mi>L</mi></msup><mi>B</mi></mrow></math></mathml>。当满足<mathml id="178"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo stretchy="false">∥</mo><mrow><mo>|</mo><msup><mi mathvariant="bold-italic">e</mi><mo>″</mo></msup><mo>|</mo></mrow><mo stretchy="false">∥</mo><msub><mrow></mrow><mi>∞</mi></msub><mo>≤</mo><mo stretchy="false"> (</mo><mi>Ν</mi><mo>+</mo><mn>1</mn><mo stretchy="false">) </mo><msup><mrow></mrow><mi>L</mi></msup><mi>B</mi><mo>≤</mo><mi>q</mi><mo>/</mo><mn>8</mn></mrow></math></mathml>时, 保证解密的正确性。</p>
                </div>
                <div class="p1">
                    <p id="179">本方案中, 扩展矩阵<mathml id="180"><math xmlns="http://www.w3.org/1998/Math/MathML"><mover accent="true"><mi mathvariant="bold-italic">C</mi><mo>¯</mo></mover></math></mathml>∈<i>Z</i><mathml id="181"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msubsup><mrow></mrow><mi>q</mi><mrow><mi>κ</mi><mo>×</mo><mi>κ</mi></mrow></msubsup></mrow></math></mathml>的每一部分都是<i>B</i>强有界矩阵, 由<b><i>X</i></b>·<b><i>v</i></b><sub>ID′</sub>+<b><i>Y</i></b>·<b><i>v</i></b><sub>ID″</sub>=<i>μ</i>·<b><i>v</i></b><sub>ID″</sub>+<b><i>e</i></b>知, <mathml id="182"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mover accent="true"><mi mathvariant="bold-italic">C</mi><mo>¯</mo></mover><mo>⋅</mo><mi mathvariant="bold-italic">v</mi><mo>=</mo><mi>μ</mi><mo>⋅</mo><mi mathvariant="bold-italic">v</mi><mo>+</mo><mi mathvariant="bold-italic">e</mi></mrow></math></mathml>, 扩展矩阵对应的噪声为<mathml id="183"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo stretchy="false">∥</mo><mrow><mo>|</mo><mi mathvariant="bold-italic">e</mi><mo>|</mo></mrow><mo stretchy="false">∥</mo><msub><mrow></mrow><mi>∞</mi></msub><mo>≤</mo><mi>ω</mi><mo>⋅</mo><mi>B</mi><mo>, </mo><mi>ω</mi><mo>=</mo><mi>η</mi><mo>+</mo><mn>1</mn><mo stretchy="false"> (</mo><mi>η</mi><mo>=</mo><mrow><mi>n</mi><mo>⋅</mo></mrow><mi>ℓ</mi><msub><mrow></mrow><mi>q</mi></msub><mo stretchy="false">) </mo></mrow></math></mathml>为噪声扩张因子。则当电路深度为<i>L</i>时, 噪声增长为<mathml id="184"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo stretchy="false">∥</mo><mrow><mo>|</mo><msup><mi mathvariant="bold-italic">e</mi><mo>″</mo></msup><mo>|</mo></mrow><mo stretchy="false">∥</mo><msub><mrow></mrow><mi>∞</mi></msub><mo>≤</mo><mi>ω</mi><mo stretchy="false"> (</mo><mi>κ</mi><mi>Ν</mi><mo>+</mo><mn>1</mn><mo stretchy="false">) </mo><msup><mrow></mrow><mi>L</mi></msup><mi>B</mi></mrow></math></mathml>。当满足<mathml id="185"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo stretchy="false">∥</mo><mrow><mo>|</mo><msup><mi mathvariant="bold-italic">e</mi><mo>″</mo></msup><mo>|</mo></mrow><mo stretchy="false">∥</mo><msub><mrow></mrow><mi>∞</mi></msub><mo>≤</mo><mi>ω</mi><mo stretchy="false"> (</mo><mi>κ</mi><mi>Ν</mi><mo>+</mo><mn>1</mn><mo stretchy="false">) </mo><msup><mrow></mrow><mi>L</mi></msup><mi>B</mi><mo>≤</mo><mi>q</mi><mo>/</mo><mn>8</mn></mrow></math></mathml>时, 选取<i>q</i>≥8<i>ωB</i> (<i>κN</i>+1) <sup><i>L</i></sup>, <i>m</i>=<i>O</i> (<i>n</i> log <i>q</i>) , <i>N</i> = O (<i>m</i>ℓ<sub><i>q</i></sub>) , 因此, 实例化<i>q</i>=<i>B</i>·2<sup><i>Ο</i> (<i>L</i> log <i>nκ</i>) </sup>, 满足<i>q</i>/<i>B</i>至多为亚指数级保证解密的正确性。</p>
                </div>
                <h4 class="anchor-tag" id="186" name="186">3.2 <b>安全性分析</b></h4>
                <div class="p1">
                    <p id="187"><b>定理</b>2 假设LWE问题是安全的, 对于所有的多项式时间攻击者A, 在IND-ID-CPA游戏中成功区分<i>μ</i><sub>0</sub>和<i>μ</i><sub>1</sub>的概率可以忽略不计, 那么<i>MS</i><sub>[CHKP10]</sub>方案可以达到IND-ID-CPA安全性。</p>
                </div>
                <div class="p1">
                    <p id="188"><b>定理</b>3 如果一个IBE方案<i>ε</i>和为该方案构造的屏蔽系统<i>MS</i><sub><i>ε</i></sub>在随机预言机下都可以达到IND-ID-CPA安全, 那么结合方案<i>ε</i>和屏蔽系统<i>MS</i><sub><i>ε</i></sub>得到的身份基多用户全同态加密方案也为随机预言机下的IND-ID-CPA安全<citation id="311" type="reference"><link href="15" rel="bibliography" /><sup>[<a class="sup">6</a>]</sup></citation>。</p>
                </div>
                <div class="p1">
                    <p id="189"><b>定理</b>4 由文献<citation id="312" type="reference">[<a class="sup">7</a>]</citation>可知, [CHKP10]方案在RO模型下为IND-ID-CPA安全。假设LWE问题是困难的, 那么上述身份基多用户全同态加密方案至少能够达到随机预言机模型下的IND-ID-CPA安全。</p>
                </div>
                <div class="p1">
                    <p id="190">证明 方案的安全性可通过以下攻击者A和挑战者C游戏来定义:</p>
                </div>
                <div class="p1">
                    <p id="191">1) 选定攻击目标身份ID<sup>*</sup>。</p>
                </div>
                <div class="p1">
                    <p id="192">2) 初始化参数设置:挑战者运行Setup算法, 得到系统公共参数, 并公开给攻击者A, 并保留主密钥。</p>
                </div>
                <div class="p1">
                    <p id="193">3) 训练1:攻击者A选择一定数量的身份ID<sub><i>i</i></sub> (ID<sub><i>i</i></sub>≠ID<sup>*</sup>) , 询问随机预言机, 得到对应的<b><i>s</i></b><sub>ID<sub><i>i</i></sub></sub>。</p>
                </div>
                <div class="p1">
                    <p id="194">4) 挑战:攻击者在询问预言机结束后, 选择<i>μ</i><sub>0</sub>, <i>μ</i><sub>1</sub>∈{0, 1}交给挑战者, 挑战者随机选择<mathml id="195"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>μ</mi><msub><mrow></mrow><mi>b</mi></msub><mo stretchy="false"> (</mo><mi>b</mi><mover><mo stretchy="true" symmetric="false">←</mo><mi>＄</mi></mover><mo stretchy="false">{</mo><mn>0</mn><mo>, </mo><mn>1</mn><mo stretchy="false">}</mo><mo stretchy="false">) </mo></mrow></math></mathml>, 并计算<b><i>U</i></b><sup>*</sup>←GenUnivMask (<i>PP</i>, ID<sup>*</sup>, <i>μ</i><sub><i>b</i></sub>) , 将结果返回给攻击者A。</p>
                </div>
                <div class="p1">
                    <p id="196">5) 训练2:攻击者A再次选择一定数量的身份ID<sub><i>i</i></sub> (ID<sub><i>i</i></sub>≠ID<sup>*</sup>) , 询问随机预言机, 得到对应的<b><i>s</i></b><sub>ID<sub><i>i</i></sub></sub>。</p>
                </div>
                <div class="p1">
                    <p id="197">6) 猜测:攻击者根据训练过程, 对<i>b</i>的值进行猜测, 得到<i>b</i>′, 如果<i>b</i>′=<i>b</i>, 则攻击成功。</p>
                </div>
                <div class="p1">
                    <p id="198">攻击者攻击成功的优势为<mathml id="199"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>A</mi><mi>D</mi><mi>V</mi><msubsup><mrow></mrow><mtext>A</mtext><mrow><mtext>Ι</mtext><mtext>Ν</mtext><mtext>D</mtext><mo>-</mo><mtext>Ι</mtext><mtext>D</mtext><mo>-</mo><mtext>C</mtext><mtext>Ρ</mtext><mtext>A</mtext></mrow></msubsup><mo>=</mo><mrow><mo>|</mo><mrow><mi>p</mi><mi>r</mi><mo stretchy="false"> (</mo><msup><mi>b</mi><mo>′</mo></msup><mo>=</mo><mi>b</mi><mo stretchy="false">) </mo><mo>-</mo><mn>1</mn><mo>/</mo><mn>2</mn></mrow><mo>|</mo></mrow></mrow></math></mathml>。</p>
                </div>
                <div class="p1">
                    <p id="200">设<i>n</i>为正整数, <i>q</i>为素数, <i>m</i>≥2<i>n</i> log <i>q</i>, <i>χ</i>为<i>B</i>有界的<i>B</i><sub><i>χ</i></sub>高斯分布。构造两个游戏G0和G1, 其中G0表示按照本方案描述的选择安全游戏, G1表示均匀分布下的选择安全游戏。根据<i>MS</i><sub>[CM15]</sub>的算法构造可知, 如果一个算法能够区分出G0和G1中的<i>b</i><sub><i>η</i></sub>、<i>b</i><sub><i>j</i></sub>, 那么就可以在得到<b><i>U</i></b>后, 利用随机预言机, 区分出<i>μ</i><sub>0</sub>或<i>μ</i><sub>1</sub>。</p>
                </div>
                <div class="area_img" id="315">
                                <img alt="" src="Detail/GetImg?filename=images/JSJY201903022_31500.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZONFRYTUhIM2RrMzdIS2psYmhhZz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                            <p class="img_tit"></p>

                </div>
                <div class="p1">
                    <p id="261">分析G0和G1, 可知:</p>
                </div>
                <div class="p1">
                    <p id="262">1) 由于采用GenBasis (1<sup><i>n</i></sup>, 1<sup><i>m</i></sup>, <i>q</i>) 算法生成的矩阵<b><i>A</i></b><sub>0</sub>统计上接近均匀分布;模拟随机预言机, 当ID≠ID<sup>*</sup>时, <i>H</i> (ID) 在统计上也接近于均匀分布;调用SampleD 函数生成的<b><i>t</i></b><sub>ID</sub>与随机预言机中满足条件<b><i>A</i></b><sub>ID</sub>·<b><i>t</i></b><sub>ID</sub>=<b><i>z</i></b><sub>ID</sub> mod <i>q</i>得到的<b><i>t</i></b><sub>ID</sub>在统计上接近均匀分布, 因此, G0和G1中的<b><i>s</i></b><sub>ID</sub>具有相同的分布。</p>
                </div>
                <div class="p1">
                    <p id="263">2) 假设有两个分布<b><i>D</i></b><sub>0</sub>={ (<b><i>a</i></b><sub><i>i</i></sub>, 〈<b><i>a</i></b><sub><i>i</i></sub>, <b><i>s</i></b>〉+<i>e</i><sub><i>i</i></sub>) :<mathml id="264"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi mathvariant="bold-italic">a</mi><msub><mrow></mrow><mi>i</mi></msub><mover><mo stretchy="true" symmetric="false">←</mo><mi>＄</mi></mover><mi>Ζ</mi><msubsup><mrow></mrow><mi>q</mi><mi>n</mi></msubsup><mo>, </mo><mi>e</mi><msub><mrow></mrow><mi>i</mi></msub><mover><mo stretchy="true" symmetric="false">←</mo><mi>＄</mi></mover><mi>χ</mi><mo stretchy="false">}</mo></mrow></math></mathml>和<b><i>D</i></b><sub>1</sub>={ (<b><i>a</i></b><sub><i>i</i></sub>, <i>b</i><sub><i>i</i></sub>) :<mathml id="265"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi mathvariant="bold-italic">a</mi><msub><mrow></mrow><mi>i</mi></msub><mover><mo stretchy="true" symmetric="false">←</mo><mi>＄</mi></mover><mi>Ζ</mi><msubsup><mrow></mrow><mi>q</mi><mi>n</mi></msubsup><mo>, </mo><mi>b</mi><msub><mrow></mrow><mi>i</mi></msub><mover><mo stretchy="true" symmetric="false">←</mo><mi>＄</mi></mover><mi>Ζ</mi><msub><mrow></mrow><mi>q</mi></msub><mo stretchy="false">}</mo><mo>, </mo><mi mathvariant="bold-italic">a</mi><msub><mrow></mrow><mi>i</mi></msub></mrow></math></mathml>被用来构造矩阵<b><i>A</i></b><sub>ID<sup>*</sup></sub>和向量<b><i>z</i></b><sub>ID<sup>*</sup></sub>。假设多项式时间算法B模拟上述的随机预言机, 执行<i>MS</i><sub>[CM15]</sub>.GenUnivMask函数, 得到<i>b</i><sub><i>η</i></sub>←</p>
                </div>
                <div class="p1">
                    <p id="266"><b><i>x</i></b>+ (<i>μ</i>·2<sup><i>i</i>-1</sup>, 0…0) ∈<i>Z</i><mathml id="267"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msubsup><mrow></mrow><mi>q</mi><msup><mi>m</mi><mo>′</mo></msup></msubsup></mrow></math></mathml>, 向量<b><i>x</i></b>=<b><i>A</i></b><sub>ID</sub>′·<b><i>r</i></b>+<b><i>e</i></b>或等于一个随机均匀向量。把<b><i>x</i></b>看作一个LWE问题的实例。则当<b><i>x</i></b>=<b><i>A</i></b><sub>ID</sub>′·<b><i>r</i></b>+<b><i>e</i></b>时, <b><i>b</i></b><sub><i>η</i></sub>=<b><i>A</i></b><sub>ID</sub>′·<b><i>r</i></b>+<b><i>e</i></b>+ (<i>μ</i>·2<sup><i>i</i>-1</sup>, 0…0) ∈<i>Z</i><mathml id="268"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msubsup><mrow></mrow><mi mathvariant="bold-italic">q</mi><msup><mi mathvariant="bold-italic">m</mi><mo>′</mo></msup></msubsup></mrow></math></mathml>对应G0的结果;当<b><i>x</i></b>为一个随机均匀向量时, <b><i>b</i></b><sub><i>η</i></sub>对应G1的结果。同理<b><i>b</i></b><sub><i>j</i></sub>也适用该游戏。</p>
                </div>
                <div class="p1">
                    <p id="269">3) 假设有一个判别器D, 以一个不可忽略的概率成功判别游戏G0和G1的分布, 那么存在一个算法B可以利用判别器的输出结果来解决一个实例化的判定性LWE问题。</p>
                </div>
                <div class="p1">
                    <p id="270">4) 由于解决判定性LWE问题是困难的, 因此, 攻击者无法区分游戏G0和G1的分布, 即攻击者无法区分<i>b</i><sub><i>η</i></sub>和<i>b</i><sub><i>j</i></sub>的两种分布。因此, 将通用信息<b><i>U</i></b>返回给攻击者, 攻击者即使询问随机预言机也无法区分<b><i>U</i></b>的分布, 无法得出任何关于<i>b</i>的有用信息。</p>
                </div>
                <div class="p1">
                    <p id="271">5) 由以上结论可知, <i>MS</i><sub>[CHKP10]</sub>在随机预言机模型下为IND-ID-CPA安全, 文献<citation id="313" type="reference">[<a class="sup">7</a>]</citation>已经证明[CHKP10]方案在随机预言机模型下为IND-ID-CPA安全, 因此, 本方案为随机预言机模型下IND-ID-CPA安全。</p>
                </div>
                <h4 class="anchor-tag" id="272" name="272">3.3 <b>性能分析</b></h4>
                <div class="p1">
                    <p id="273">本文构造了一个基于LWE问题的高效分层身份基多用户全同态加密方案, 与其他方案相比, 应用场景更广, 效率更高, 具体表现在以下几个方面:</p>
                </div>
                <div class="p1">
                    <p id="274">1) 与[CHKP10]方案相比, 将一个简单的HIBE方案扩展为multi-identity HIBFHE方案, 应用前景更加广阔, 实现功能更加多样。</p>
                </div>
                <div class="p1">
                    <p id="275">2) 与[GSW13]方案提出的HIBFHE方案相比, 将方案的应用场景由单用户扩展到多用户, 实现了不同用户之间密文的同态计算。同态加法和乘法可以通过<i>Z</i><sub><i>q</i></sub>上矩阵的平凡加法和乘法运算实现上的加法乘法运算, 效率更高, 密文运算后维度不变。并利用[GSW13]方案的校平技术, 将噪声控制在<i>ω</i> (<i>κN</i>+1) <sup><i>L</i></sup><i>B</i>之内, 保证了解密的正确性。</p>
                </div>
                <div class="p1">
                    <p id="276">3) 与[CM15]方案相比, 本方案虽然使用相同的转化机制, 但本方案采用的身份基方案为随机预言机模型下的[CHKP10]方案, 而[CM15]方案采用[GPV08]方案。由于RO模型下的[CHKP10]方案相比[GPV08]方案在公钥规模、私钥规模、密文尺寸方面都有一定优势, 并且实现了分层功能, 因此, 在安全性相同 (都能达到RO模型下的选择安全) 的情况下, 本方案的密钥更新时间相对更短、效率更高。具体分析见表1、表2。</p>
                </div>
                <div class="area_img" id="277">
                    <p class="img_tit"><b>表</b>1 <b>本文方案与</b>[GSW13]<b>方案和</b>[CHKP10]<b>方案的对比</b> <a class="downexcel" onclick="DownLoadReportExcel(this)">导出到EXCEL</a></p>
                    <p class="img_tit">Tab. 1 Comparison of the proposed scheme with scheme [CHKP10] and scheme [GSW13]</p>
                    <p class="img_note"></p>
                    <table id="277" border="1"><tr><td><br />方案</td><td>同态操作</td><td>分层性质</td><td>多用户</td></tr><tr><td><br />[GSW]方案</td><td>YES</td><td>YES</td><td>NO</td></tr><tr><td><br />[CHKP10]方案</td><td>NO</td><td>YES</td><td>NO</td></tr><tr><td><br />本文方案</td><td>YES</td><td>YES</td><td>YES</td></tr></table>
                    <form name="form" action="/kxreader/Detail/DownloadReportExcel" method="POST" style="display:inline">
                        <input type="hidden" name="hidTable" value="" />
                        <input type="hidden" name="hidFileName" value="" />
                    </form>
                    <p class="img_note"></p>
                    <p class="img_note"></p>
                </div>
                <div class="area_img" id="278">
                    <p class="img_tit"><b>表</b>2 <b>本文方案与</b>[CM15]<b>方案的比较</b> <a class="downexcel" onclick="DownLoadReportExcel(this)">导出到EXCEL</a></p>
                    <p class="img_tit">Tab. 2 Comparison of the proposed scheme with scheme [CM15]</p>
                    <p class="img_note"></p>
                    <table id="278" border="1"><tr><td>方案</td><td>公钥规模</td><td>私钥规模</td><td>密文尺寸</td><td>是否支持分层</td><td>密钥更新周期</td><td>困难性假设</td></tr><tr><td>[CM15]方案</td><td><i>O</i> (<i>n</i> (<i>m</i>+<i>n</i>) log <i>q</i>) </td><td><i>O</i> (<i>mn</i> log <i>q</i>) </td><td><i>O</i> (<i>κ</i><sup>2</sup><i>m</i> log<sup>2</sup><i>q</i>) </td><td>否</td><td>长</td><td>LWE问题</td></tr><tr><td><br />本文方案</td><td><i>O</i> (<i>n</i> (<i>m</i>+1) log <i>q</i>) </td><td><i>O</i> (<i>m</i> log <i>q</i>) </td><td><i>O</i> (<i>κ</i><sup>2</sup><i>n</i> log<sup>2</sup><i>q</i>) </td><td>是</td><td>短</td><td>LWE问题</td></tr></table>
                    <form name="form" action="/kxreader/Detail/DownloadReportExcel" method="POST" style="display:inline">
                        <input type="hidden" name="hidTable" value="" />
                        <input type="hidden" name="hidFileName" value="" />
                    </form>
                    <p class="img_note"></p>
                    <p class="img_note"></p>
                </div>
                <h3 id="279" name="279" class="anchor-tag">4 结语</h3>
                <div class="p1">
                    <p id="280">本文基于LWE问题, 利用[CM15]方案中的转化机制, 结合[CHKP10]方案, 构造了一个高效的分层身份基多用户全同态加密方案, 并证明了该方案为随机预言机模型下的IND-ID-CPA安全。通过对比分析, 本方案应用场景更广、效率更高。</p>
                </div>
                <div class="p1">
                    <p id="281">与身份加密相比, 属性加密 (ABE) 能够实现更细粒度的访问控制和一对多的加解密<citation id="314" type="reference"><link href="37" rel="bibliography" /><sup>[<a class="sup">17</a>]</sup></citation>。后续工作将研究多密钥全同态加密方案与属性加密的结合, 实现属性基多用户全同态加密方案。</p>
                </div>

        <!--brief end-->
        
        <!--conten left  end-->
        <!--增强附件-->
        

        <!--reference start-->
            <div class="reference anchor-tag" id="a_bibliography">
                    <h3>参考文献</h3>
                                        <p id="5">
                            <a id="bibliography_1" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Fully homomorphic encryption using ideal lattices">

                                <b>[1]</b> GENTRY C. Fully homomorphic encryption using ideal lattices [C]// STOC 2009: Proceedings of the 41st Annual ACM Symposium on Symposium on Theory of Computing. New York: ACM, 2009: 169-178.
                            </a>
                        </p>
                        <p id="7">
                            <a id="bibliography_2" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Implementing Gentry&amp;#39;&amp;#39;s Fully-Homomorphic Encryption Scheme">

                                <b>[2]</b> GENTRY C, HALEVI S. Implementing Gentry's fully-homomorphic encryption scheme [C]// EUROCRYPT 2011: Proceedings of the 2011 Annual International Conference on the Theory and Applications of Cryptographic Techniques, LNCS 6632. Berlin: Springer, 2011: 129-148.
                            </a>
                        </p>
                        <p id="9">
                            <a id="bibliography_3" target="_blank" href="http://scholar.cnki.net/result.aspx?q=(Leveled)Fully homomorphic encryption without bootstrapping">

                                <b>[3]</b> BRAKERSKI Z, GENTRY C, VAIKUNTANATHAN V. (Leveled) fully homomorphic encryption without bootstrapping [C]// ITCS '12: Proceedings of the 3rd Innovations in Theoretical Computer Science Conference. New York: ACM, 2012: 309-325.
                            </a>
                        </p>
                        <p id="11">
                            <a id="bibliography_4" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Homomorphic encryption from learning with errors:onceptually-simpler,asymptotically-faster,attribute-based">

                                <b>[4]</b> GENTRY C, SAHAI A, WATERS B. Homomorphic encryption from learning with errors: conceptually-simpler, asymptotically-faster, attribute-based [C]// CRYPTO 2013: Proceedings of the 2013 Advances in Cryptology, LNCS 8042. Berlin: Springer, 2013: 75-92.
                            </a>
                        </p>
                        <p id="13">
                            <a id="bibliography_5" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CDFD&amp;filename=1016752032.nh&amp;v=MjMyOTFQclpFYlBJUUtESDg0dlI0VDZqNTRPM3pxcUJ0R0ZyQ1VSN3FmWnVacEZpRG1WcnpBVkYyNkdMUzlITkg=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZONFRYTUhIM2RrMzdIS2psYmhhZz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[5]</b> 陈智罡.基于格的全同态加密研究与设计[D].南京:南京航空航天大学, 2015:23. (CHEN Z G. Research and dedign of fully homomorphic encryption based on lattice [D]. Nanjing: Nanjing University of Aeronautics and Astronautics, 2015: 23.) 
                            </a>
                        </p>
                        <p id="15">
                            <a id="bibliography_6" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Multi-identity and multi-key leveled FHE from learning with errors">

                                <b>[6]</b> CLEAR M, McGOLDRICK C. Multi-identity and multi-key leveled FHE from learning with errors [C]// Proceedings of the 2015 Annual Cryptology Conference, LNCS 9216. Berlin: Springer, 2015: 630-656.
                            </a>
                        </p>
                        <p id="17">
                            <a id="bibliography_7" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Bonsai trees,or how to delegate a lattice basis">

                                <b>[7]</b> CASH D, HOFHEINZ D, KILTZ E, et al. Bonsai trees, or how to delegate a lattice basis [C]// Proceedings of the 2010 Annual International Conference on the Theory and Applications of Cryptographic Techniques, LNCS 6110. Berlin: Springer, 2010: 523-552.
                            </a>
                        </p>
                        <p id="19">
                            <a id="bibliography_8" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Trapdoors for hard lattices and new cryptographic con-structions">

                                <b>[8]</b> GENTRY C, PEIKERT C, VAIKUNTANATHAN V. Trapdoors for hard lattices and new cryptographic constructions [C]// STOC '08: Proceedings of the 40th Annual ACM Symposium on Theory of Computing. New York: ACM, 2008: 197-206.
                            </a>
                        </p>
                        <p id="21">
                            <a id="bibliography_9" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=MMXB201706006&amp;v=MTg2MTlLREg4NHZSNFQ2ajU0TzN6cXFCdEdGckNVUjdxZlp1WnBGaURtVnJ6QUtDRFRiTEc0SDliTXFZOUZZb1E=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZONFRYTUhIM2RrMzdIS2psYmhhZz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[9]</b> 李增鹏, 马春光, 周红生.全同态加密研究[J].密码学报, 2017, 4 (6) :561-578. (LI Z P, MA C G, ZHOU H S. Overview on fully homomorphic encryption [J]. Journal of Cryptologic Research, 2017, 4 (6) : 561-578.) 
                            </a>
                        </p>
                        <p id="23">
                            <a id="bibliography_10" target="_blank" href="/kcms/detail/detail.aspx?dbcode=SSJD&amp;filename=SSJD00000652387&amp;v=MTg0MzhPNEh0SE1xWXBIWitNSVkzazV6QmRoNGo5OVNYcVJyeG94Y01IN1I3cWRaK1p1Rmkva1c3ek5JMVk9Tmo3QmFy&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZONFRYTUhIM2RrMzdIS2psYmhhZz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[10]</b> MICCIANCIO D. Generalized compact knapsacks, cyclic lattices, and efficient one-way functions [J]. Computational Complexity, 2007, 16 (4) : 365-411.
                            </a>
                        </p>
                        <p id="25">
                            <a id="bibliography_11" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Identity based encryption from the weil pairing">

                                <b>[11]</b> BONEH D, FRANKLIN M. Identity-based encryption from the Weil pairing [C]// Proceedings of the 2001 Annual International Cryptology Conference, LNCS 2139. Berlin: Springer, 2001: 213-229.
                            </a>
                        </p>
                        <p id="27">
                            <a id="bibliography_12" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Identity-based cryptosystems and signature schemes">

                                <b>[12]</b> SHAMIR A. Identity-based cryptosystems and signature schemes [C]// Proceedings of the 1984 Workshop on the Theory and Application of Cryptographic Techniques, LNCS 196. Berlin: Springer, 1984: 47-53.
                            </a>
                        </p>
                        <p id="29">
                            <a id="bibliography_13" target="_blank" href="http://scholar.cnki.net/result.aspx?q=On lattices,learning with errors,random linear codes,and cryptography">

                                <b>[13]</b> REGEV O. On lattices, learning with errors, random linear codes, and cryptography [C]// Proceedings of the 37th Annual ACM Symposium on Theory of Computing. New York: ACM, 2005: 84-93.
                            </a>
                        </p>
                        <p id="31">
                            <a id="bibliography_14" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Public-key cryptosystems from the worst-case shortest vectorproblem: extended abstract">

                                <b>[14]</b> PEIKERT C. Public-key cryptosystems from the worst-case shortest vector problem: extended abstract [C]// STOC '09: Proceedings of the 41st Annual ACM Symposium on Theory of Computing. New York: ACM, 2009: 333-342.
                            </a>
                        </p>
                        <p id="33">
                            <a id="bibliography_15" target="_blank" href="http://scholar.cnki.net/result.aspx?q=The learning with errors problem">

                                <b>[15]</b> REGEV O. The learning with errors problem (invited survey) [C]// Proceedings of the 2010 IEEE 25th Annual Conference on Computational Complexity. Piscataway, NJ: IEEE, 2010: 191-204.
                            </a>
                        </p>
                        <p id="35">
                            <a id="bibliography_16" >
                                    <b>[16]</b>
                                 周潭平.基于GLWE问题的密码体制研究与设计[D].西安:武警工程大学, 2014:13. (ZHOU T P. Research and design of cryptosystem based on GLWE problem [D]. Xi'an: Engineering University of the Chinese People's Armed Police Force, 2014:13.) 
                            </a>
                        </p>
                        <p id="37">
                            <a id="bibliography_17" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=XXAQ201801003&amp;v=MjMwMjU3cWZadVpwRmlEbVZyekFQVFhLZjdHNEg5bk1ybzlGWjRRS0RIODR2UjRUNmo1NE8zenFxQnRHRnJDVVI=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZONFRYTUhIM2RrMzdIS2psYmhhZz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[17]</b> 石悦, 李相龙, 戴方芳.一种基于属性基加密的增强型软件定义网络安全框架[J].信息网络安全, 2018 (1) :15-22. (SHI Y, LI X L, DAI F F. An enhanced security framework of software defined network based on attribute-based encryption [J]. Netinfo Security, 2018 (1) : 15-22.) This work is partially supported by the National Key Research and Development Program of China (2017YFB0802000) , the National Natural Science Foundation of China (U1636114, 61772550, 61572521) , the National Cryptography Development Fund of China (MMJJ20170112) .TU Guangsheng, born in 1992, M. S. candidate. His research interests include information security, homomorphic cryptology.YANG Xiaoyuan, born in 1959, M. S., professor. His research interests include information security, cryptography.ZHOU Tanping, born in 1989, Ph. D. His research interests include information security, homomorphic cryptology.
                            </a>
                        </p>
            </div>
        <!--reference end-->
        <!--footnote start-->
        <!--footnote end-->



    </div>

        <input id="fileid" type="hidden" value="JSJY201903022" />
        <input id="dpi" type="hidden" value="300" />
    </div>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?6e967eb120601ea41b9d312166416aa6";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
</script>

    


<input id="hid_uid" name="hid_uid" type="hidden" value="WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZONFRYTUhIM2RrMzdIS2psYmhhZz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
<input id="hid_kLogin_headerUrl" name="hid_kLogin_headerUrl" type="hidden" value="/KLogin/Request/GetKHeader.ashx%3Fcallback%3D%3F" />
<input id="hid_kLogin_footerUrl" name="hid_kLogin_footerUrl" type="hidden" value="/KLogin/Request/GetKFooter.ashx%3Fcallback%3D%3F" />
<div class="btn-link" style="display: none"><a target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JSJY201903022&amp;v=MDg1NTlHRnJDVVI3cWZadVpwRmlEbVZyekFMejdCZDdHNEg5ak1ySTlIWm9RS0RIODR2UjRUNmo1NE8zenFxQnQ=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZONFRYTUhIM2RrMzdIS2psYmhhZz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">知网节</a></div>
<div class="popflow" id="popupTips" style="display: none;">
    <div class="popflowArr"></div>
    <div class="popflowCot">
        <div class="hd"><a href="javascript:void(0);" onclick="$('#popupTips').hide();$('#popupmsg').html('')" class="close">X</a></div>
        <div class="bd">
            <p class="mes" id="popupmsg" name="popupmsg"></p>
          
        </div>
    </div>
</div>
<input type="hidden" id="myexport" value="//kns.cnki.net" />

<input type="hidden" id="KPCAPIPATH" value="//ishufang.cnki.net" />
<input type="hidden" id="CitedTimes" value="1" />
<div class="link" id="GLSearch" style="display: none;">
    <i class="icon-trangle"></i>
    <div class="inner">
        <a class="icon" id="copytext">复制</a>
        <a class="icon" target="_blank" onclick="searchCRFD(this)">工具书搜索</a>
    </div>
</div>




<input id="hidVirtualPath" name="hidVirtualPath" type="hidden" value="/kxreader" />
<script src="/kxreader/bundles/detail?v=-ULdk-c6FkZHtJA2KAXPgHnyA8mtgyPnBde_C2VZ2BY1"></script>

<script src="/kxreader/Scripts/layer.min.js" type="text/javascript"></script>

<div id="footerBox" class="rootw footer">
</div>
<script>
    if (typeof FlushLogin == 'function') {
        FlushLogin();
    }
    modifyEcpHeader(true);
</script>

<!--图片放大功能 start-->
<script src="/kxreader/bundles/imagebox?v=W4phPu9SNkGcuPeJclikuVE3PpRyIW_gnfjm_19nynI1"></script>

<script type="text/javascript">
    $(function () {
        var j = $.noConflict();
        j(function () {
            j(".zoom-in,.btn-zoomin").imgbox({
                'alignment': 'center',
                'allowMultiple': false,
                'overlayShow': true
            });
        })
    });
</script>
<!--图片放大功能 end-->
<div class="fixedbar">
    <div class="backtop hiddenV" id="backtop">
        <a id="backTopSide" href="javascript:scroll(0,0);" title=""></a>
    </div>
</div>
<script type="text/javascript" src="/kxreader/Scripts/MathJax-2.6-latest/MathJax.js?config=MML_HTMLorMML-full"></script>

</body>
</html>
