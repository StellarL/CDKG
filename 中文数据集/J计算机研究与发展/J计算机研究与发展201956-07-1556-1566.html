

<!DOCTYPE html>
<html>
<head>
    <title>全文阅读--XML全文阅读--中国知网</title>
    <link rel="icon" href="/kxreader/favicon.ico" />
    <link rel="shortcut Icon" href="/kxreader/favicon.ico" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="keywords" content="文献 XML KBASE CNKI 中国知网" />
    <meta name="description" content="XML文献检索" />
    <script type="text/javascript">
        var APPPATH = '/kxreader';
    </script>

</head>

<body>

    
<script type="text/javascript" src="//login.cnki.net/TopLogin/api/loginapi/get?type=top&amp;localCSS=&amp;returnurl=%2f%2fkns.cnki.net%2f%2fKXReader%2fDetail%3fTIMESTAMP%3d637127910085900000%26DBCODE%3dCJFD%26TABLEName%3dCJFDLAST2019%26FileName%3dJFYZ201907020%26RESULT%3d1%26SIGN%3d6D9GwRVZP9icYOX%252fp%252bZ3R04edzE%253d"></script>

<div id="headerBox" class="header">
    <div class="topbar">
        <div class="textalign">
            <a href="/kxreader/Detail?dbcode=CJFD&amp;filename=JFYZ201907020&amp;align=md">
                <i class="icon-cen active" title="居中对齐"></i>
            </a>
            <a href="/kxreader/Detail?dbcode=CJFD&amp;filename=JFYZ201907020&amp;align=lt">
                <i class="icon-left " title="左对齐"></i>
            </a>
        </div>
        <h6 class="free-tip"><i class="icon"></i>HTML阅读开放试用阶段，欢迎体验！</h6>
    </div>
</div>


    



<div class="btn-link" style="display: none"><a target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JFYZ201907020&amp;v=MTM3MDBESDg0dlI0VDZqNTRPM3pxcUJ0R0ZyQ1VSTE9lWmVSckZ5cm5VcjdPTHl2U2RMRzRIOWpNcUk5SFpJUUs=&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYzUnVBSW1mUVc1OGJzcUZ1WGdCaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">知网节</a></div>

    <div class="main">

        

    <div class="sidebar-a">
        <!--sidebar start-->
        <div class="sidenav">
            <div class="arrow"><span></span></div>
            <!--sidebar_list start-->
            <dl class="sidenav-list">
                    <dt class="tit">目录结构</dt>
                            <dd class="guide">
                                    <p><a href="#77" data-title="&lt;b&gt;1 相关工作&lt;/b&gt; "><b>1 相关工作</b></a><i></i></p>
                                                            </dd>
                            <dd class="guide">
                                    <p><a href="#81" data-title="&lt;b&gt;2&lt;/b&gt; “&lt;b&gt;神威&lt;/b&gt;&#183;&lt;b&gt;太湖之光”系统概述及POM性能分析&lt;/b&gt; "><b>2</b> “<b>神威</b>·<b>太湖之光”系统概述及POM性能分析</b></a><i></i></p>
                                                                    <ul class="contentbox">
                                                <li><a href="#82" data-title="&lt;b&gt;2.1&lt;/b&gt; “&lt;b&gt;神威&lt;/b&gt;&#183;&lt;b&gt;太湖之光&lt;/b&gt;”"><b>2.1</b> “<b>神威</b>·<b>太湖之光</b>”</a></li>
                                                <li><a href="#87" data-title="&lt;b&gt;2.2 区域海洋模式POM&lt;/b&gt;"><b>2.2 区域海洋模式POM</b></a></li>
                                    </ul>
                            </dd>
                            <dd class="guide">
                                    <p><a href="#90" data-title="&lt;b&gt;3 POM移植及性能分析&lt;/b&gt; "><b>3 POM移植及性能分析</b></a><i></i></p>
                                                            </dd>
                            <dd class="guide">
                                    <p><a href="#104" data-title="&lt;b&gt;4 面向异构众核处理器的并行优化方法&lt;/b&gt; "><b>4 面向异构众核处理器的并行优化方法</b></a><i></i></p>
                                                                    <ul class="contentbox">
                                                <li><a href="#105" data-title="&lt;b&gt;4.1 主从协同计算方案&lt;/b&gt;"><b>4.1 主从协同计算方案</b></a></li>
                                                <li><a href="#113" data-title="&lt;b&gt;4.2 从核访存优化方案&lt;/b&gt;"><b>4.2 从核访存优化方案</b></a></li>
                                                <li><a href="#123" data-title="&lt;b&gt;4.3 主从核异步数据交互方案&lt;/b&gt;"><b>4.3 主从核异步数据交互方案</b></a></li>
                                    </ul>
                            </dd>
                            <dd class="guide">
                                    <p><a href="#131" data-title="&lt;b&gt;5 面向“神威&lt;/b&gt;&#183;&lt;b&gt;太湖之光”大规模并行优化方法&lt;/b&gt; "><b>5 面向“神威</b>·<b>太湖之光”大规模并行优化方法</b></a><i></i></p>
                                                                    <ul class="contentbox">
                                                <li><a href="#132" data-title="&lt;b&gt;5.1 并行通信优化方案&lt;/b&gt;"><b>5.1 并行通信优化方案</b></a></li>
                                                <li><a href="#142" data-title="&lt;b&gt;5.2 并行I/O优化方案&lt;/b&gt;"><b>5.2 并行I/O优化方案</b></a></li>
                                    </ul>
                            </dd>
                            <dd class="guide">
                                    <p><a href="#147" data-title="&lt;b&gt;6 实验结果及分析&lt;/b&gt; "><b>6 实验结果及分析</b></a><i></i></p>
                                                                    <ul class="contentbox">
                                                <li><a href="#148" data-title="&lt;b&gt;6.1 面向异构众核处理器的并行优化方法结果分析&lt;/b&gt;"><b>6.1 面向异构众核处理器的并行优化方法结果分析</b></a></li>
                                                <li><a href="#158" data-title="&lt;b&gt;6.2 面向“神威&lt;/b&gt;&#183;&lt;b&gt;太湖之光”大规模并行优化方法的结果分析&lt;/b&gt;"><b>6.2 面向“神威</b>·<b>太湖之光”大规模并行优化方法的结果分析</b></a></li>
                                                <li><a href="#162" data-title="&lt;b&gt;6.3 与通用平台性能对比分析&lt;/b&gt;"><b>6.3 与通用平台性能对比分析</b></a></li>
                                    </ul>
                            </dd>
                            <dd class="guide">
                                    <p><a href="#166" data-title="&lt;b&gt;7 结束语&lt;/b&gt; "><b>7 结束语</b></a><i></i></p>
                                                            </dd>
                            <dd class="guide">
                                    <p><a href="#" data-title="文内图表 ">文内图表</a><i></i></p>
                                                                    <ul class="contentbox">
                                                <li><a href="#76" data-title="图1 异构众核处理器——申威26010">图1 异构众核处理器——申威26010</a></li>
                                                <li><a href="#85" data-title="图2 主从加速并行模式">图2 主从加速并行模式</a></li>
                                                <li><a href="#89" data-title="图3 POM程序运行流程图">图3 POM程序运行流程图</a></li>
                                                <li><a href="#95" data-title="图4 POM各模块耗时百分比">图4 POM各模块耗时百分比</a></li>
                                                <li><a href="#98" data-title="图5 POM在纯主核上的强扩展性">图5 POM在纯主核上的强扩展性</a></li>
                                                <li><a href="#103" data-title="图6 不同核数规模下通信在POM中的耗时占比">图6 不同核数规模下通信在POM中的耗时占比</a></li>
                                                <li><a href="#108" data-title="图7 众核并行伪代码示意图">图7 众核并行伪代码示意图</a></li>
                                                <li><a href="#122" data-title="图8 访存优化示意图">图8 访存优化示意图</a></li>
                                                <li><a href="#126" data-title="图9 主从核异步交互示意图">图9 主从核异步交互示意图</a></li>
                                                <li><a href="#135" data-title="图10 单进程halo区通信示意图">图10 单进程halo区通信示意图</a></li>
                                                <li><a href="#145" data-title="图11 原始模式I/O与使用CFIO进行I/O方式对比">图11 原始模式I/O与使用CFIO进行I/O方式对比</a></li>
                                                <li><a href="#150" data-title="&lt;b&gt;表1 swPOM v1.0与Original POM性能对比&lt;/b&gt;"><b>表1 swPOM v1.0与Original POM性能对比</b></a></li>
                                                <li><a href="#153" data-title="图12 swPOM v1.0在纯主核上的强扩展性">图12 swPOM v1.0在纯主核上的强扩展性</a></li>
                                                <li><a href="#155" data-title="&lt;b&gt;表2 swPOM v1.1与swPOM v1.0性能对比&lt;/b&gt;"><b>表2 swPOM v1.1与swPOM v1.0性能对比</b></a></li>
                                                <li><a href="#156" data-title="图13 swPOM v1.1与 v1.0在纯主核上的强扩展性对比">图13 swPOM v1.1与 v1.0在纯主核上的强扩展性对比</a></li>
                                                <li><a href="#161" data-title="&lt;b&gt;表3 正常I/O与CFIO对比&lt;/b&gt;"><b>表3 正常I/O与CFIO对比</b></a></li>
                                                <li><a href="#164" data-title="&lt;b&gt;表4 swPOM与Original POM (CESS) 性能对比&lt;/b&gt;"><b>表4 swPOM与Original POM (CESS) 性能对比</b></a></li>
                                    </ul>
                            </dd>
                                    <dd class="guide">
                                        <h6>
                                            <p><a href="#a_bibliography">参考文献</a> </p>
                                        </h6>
                                    </dd>

            </dl>
        </div>
        <!--sidebar end-->
        &nbsp;
        <!--此处有一空格符 勿删-->
    </div>

                <div class="sidebar-b three-collumn" style="width:0;">
            <div class="refer" style="width: 0;">
                <div class="arrow off" title="参考文献"><span></span></div>
                <div class="js-scrollbox" >
                    
                    <div class="subbox active">
                        <h4>
                            <span class="tit">参考文献</span>
                            <a class="close" href="javascript:void(0)">x</a>
                        </h4>
                        <div class="side-scroller">
                            <ul class="refer-list">
                                <li id="191">


                                    <a id="bibliography_1" title="Collins M, Minobe S, Barreiro M, et al.Challenges and opportunities for improved understanding of regional climate dynamics[J].Nature Climate Change, 2018, 8 (2) :101- 108" target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Challenges and opportunities for improved understanding of regional climate dynamics">
                                        <b>[1]</b>
                                        Collins M, Minobe S, Barreiro M, et al.Challenges and opportunities for improved understanding of regional climate dynamics[J].Nature Climate Change, 2018, 8 (2) :101- 108
                                    </a>
                                </li>
                                <li id="193">


                                    <a id="bibliography_2" title="Bonan G B, Doney S C.Climate, ecosystems, and planetary futures:The challenge to predict life in Earth system models[J].Science, 2018, 359 (6375) :533- 541" target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=SJRS&amp;filename=SJRS05C1D7BB988F2A0D423B95644A166167&amp;v=MTI0ODlmT0dRbGZDcGJRMzVOMWh4cnErd2E0PU5pZlpmYk85YmRDNHFQMDNiZU1IZW41SXoySVg2RHdQUVhya3FCWkVlTFNTUkx5WUNPTnZGU2lXV3I3SklGcG1hQnVIWQ==&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYzUnVBSW1mUVc1OGJzcUZ1WGdCaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[2]</b>
                                        Bonan G B, Doney S C.Climate, ecosystems, and planetary futures:The challenge to predict life in Earth system models[J].Science, 2018, 359 (6375) :533- 541
                                    </a>
                                </li>
                                <li id="195">


                                    <a id="bibliography_3" title="Bony S, Stevens B, Frierson D M W, et al.Clouds, circulation and climate sensitivity[J].Nature Geoscience, 2015, 8 (4) :261- 268" target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Clouds,circulation and climate sensitivity">
                                        <b>[3]</b>
                                        Bony S, Stevens B, Frierson D M W, et al.Clouds, circulation and climate sensitivity[J].Nature Geoscience, 2015, 8 (4) :261- 268
                                    </a>
                                </li>
                                <li id="197">


                                    <a id="bibliography_4" title="Marzocchi A, Hirschi J J M, Holliday N P, et al.The north Atlantic subpolar circulation in an eddy-resolving global ocean model[J].Journal of Marine Systems, 2015, 142:126- 143" target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=SJES&amp;filename=SJES14110700309199&amp;v=MjEzNzNYVXdvQk1UNlQ0UFFIL2lyUmRHZXJxUVRNbndaZVp1SHlqbVVMcklJbHdWYXhRPU5pZk9mYks4SDlETXFJOUZaK3NHRA==&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYzUnVBSW1mUVc1OGJzcUZ1WGdCaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[4]</b>
                                        Marzocchi A, Hirschi J J M, Holliday N P, et al.The north Atlantic subpolar circulation in an eddy-resolving global ocean model[J].Journal of Marine Systems, 2015, 142:126- 143
                                    </a>
                                </li>
                                <li id="199">


                                    <a id="bibliography_5" title="Alexander K, Easterbrook S M.The software architecture of climate models:A graphical comparison of CMIP5 and EMICAR5 configurations[J].Geoscientific Model Develop-ment, 2015, 8 (4) :1221- 1232" target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=The software architecture of climate models:A graphical comparison of CMIP5 and EMICAR5 configurations">
                                        <b>[5]</b>
                                        Alexander K, Easterbrook S M.The software architecture of climate models:A graphical comparison of CMIP5 and EMICAR5 configurations[J].Geoscientific Model Develop-ment, 2015, 8 (4) :1221- 1232
                                    </a>
                                </li>
                                <li id="201">


                                    <a id="bibliography_6" title="Jia Liwei, Yang Xiaosong, Vecchi G A, et al.Improved seasonal prediction of temperature and precipitation over land in a high-resolution GFDL climate model[J].Journal of Climate, 2015, 28 (5) :2044- 2062" target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=SPQD&amp;filename=SPQD15030600006849&amp;v=Mjc4NDhyUmRHZXJxUVRNbndaZVp1SHlqbVVMcklJbHdWYXhRPU5qM2Fhcks5SHRMTXFZOUZaT3NKQkhnd29CTVQ2VDRQUUgvaQ==&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYzUnVBSW1mUVc1OGJzcUZ1WGdCaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[6]</b>
                                        Jia Liwei, Yang Xiaosong, Vecchi G A, et al.Improved seasonal prediction of temperature and precipitation over land in a high-resolution GFDL climate model[J].Journal of Climate, 2015, 28 (5) :2044- 2062
                                    </a>
                                </li>
                                <li id="203">


                                    <a id="bibliography_7" title="S&#233;razin G, Penduff T, Gr&#233;gorio S, et al.Intrinsic variability of sea level from global ocean simulations:Spatiotemporal scales[J].Journal of Climate, 2015, 28 (10) :4279- 4292" target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=SPQD&amp;filename=SPQD15052100003349&amp;v=MDgxNjNhYXJLOUh0VE9ybzlGWk9zTUQzZ3dvQk1UNlQ0UFFIL2lyUmRHZXJxUVRNbndaZVp1SHlqbVVMcklJbHdWYXhRPU5qMw==&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYzUnVBSW1mUVc1OGJzcUZ1WGdCaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[7]</b>
                                        S&#233;razin G, Penduff T, Gr&#233;gorio S, et al.Intrinsic variability of sea level from global ocean simulations:Spatiotemporal scales[J].Journal of Climate, 2015, 28 (10) :4279- 4292
                                    </a>
                                </li>
                                <li id="205">


                                    <a id="bibliography_8" title="Rieck J K, B&#246;ning C W, Greatbatch R J, et al.Seasonal variability of eddy kinetic energy in a global high-resolution ocean model[J].Geophysical Research Letters, 2015, 42 (21) :9379- 9386" target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=SPQD&amp;filename=SPQD60547C578BF6ED5E14E5F844DF50BB37&amp;v=MTY0MDB5bU1TN2twNFBuZm1xR1pEZkxMbU43bVlDT052RlNpV1dyN0pJRnBtYUJ1SFlmT0dRbGZDcGJRMzVOMWh4cnErd2E0PU5qM2Fhclc0RzlYTDNJcENiSmw1Q2dsTg==&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYzUnVBSW1mUVc1OGJzcUZ1WGdCaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[8]</b>
                                        Rieck J K, B&#246;ning C W, Greatbatch R J, et al.Seasonal variability of eddy kinetic energy in a global high-resolution ocean model[J].Geophysical Research Letters, 2015, 42 (21) :9379- 9386
                                    </a>
                                </li>
                                <li id="207">


                                    <a id="bibliography_9" title="Rintoul S R.The global influence of localized dynamics in the Southern Ocean[J].Nature, 2018, 558 (7709) :209- 218" target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=The global influence of localized dynamics in the Southern Ocean">
                                        <b>[9]</b>
                                        Rintoul S R.The global influence of localized dynamics in the Southern Ocean[J].Nature, 2018, 558 (7709) :209- 218
                                    </a>
                                </li>
                                <li id="209">


                                    <a id="bibliography_10" title="Roberts M J, Hewitt H T, Hyder P, et al.Impact of ocean resolution on coupled air-sea fluxes and large-scale climate[J].Geophysical Research Letters, 2016, 43 (19) :10430- 10438" target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=SPQD&amp;filename=SPQD74982698A0732903814DF4420AF59AA0&amp;v=MjA0MTI1TjFoeHJxK3dhND1OajNhYXJTOEY5bk9xWVpORmVzSUQzNHd6eFViNnpzSlBudm1yaEpFRDdlZE5NdWZDT052RlNpV1dyN0pJRnBtYUJ1SFlmT0dRbGZDcGJRMw==&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYzUnVBSW1mUVc1OGJzcUZ1WGdCaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[10]</b>
                                        Roberts M J, Hewitt H T, Hyder P, et al.Impact of ocean resolution on coupled air-sea fluxes and large-scale climate[J].Geophysical Research Letters, 2016, 43 (19) :10430- 10438
                                    </a>
                                </li>
                                <li id="211">


                                    <a id="bibliography_11" title="Kalmykov V V, Ibrayev R A, Kaurkin M N, et al.Compact modeling framework v3.0 for high-resolution global ocean-ice-atmosphere models[J].Geoscientific Model Develop-ment, 2018, 11 (10) :3983- 3997" target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Compact modeling framework v3.0 for high-resolution global ocean-ice-atmosphere models">
                                        <b>[11]</b>
                                        Kalmykov V V, Ibrayev R A, Kaurkin M N, et al.Compact modeling framework v3.0 for high-resolution global ocean-ice-atmosphere models[J].Geoscientific Model Develop-ment, 2018, 11 (10) :3983- 3997
                                    </a>
                                </li>
                                <li id="213">


                                    <a id="bibliography_12" title="Slingo J, Inness P, Neale R, et al.Scale interactions on diurnal toseasonal timescales and their relevanceto model systematic errors[J].Annals of Geophysics, 2003, 46 (1) :139- 155" target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Scale interactions on diurnal toseasonal timescales and their relevanceto model systematic errors">
                                        <b>[12]</b>
                                        Slingo J, Inness P, Neale R, et al.Scale interactions on diurnal toseasonal timescales and their relevanceto model systematic errors[J].Annals of Geophysics, 2003, 46 (1) :139- 155
                                    </a>
                                </li>
                                <li id="215">


                                    <a id="bibliography_13" title="Chi Xuebin, Gu Beibei, Wu Hong, et al.The analysis of development on high performance computer system and platform[J].Computer Engineering &amp;amp; Science, 2013, 35 (11) :6- 13 (in Chinese) (迟学斌, 顾蓓蓓, 武虹, 等.高性能计算机系统及平台发展状况分析[J].计算机工程与科学, 2013, 35 (11) :6- 13) " target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JSJK201311002&amp;v=MTQ4NjZPZVplUnJGeXJuVXI3T0x6N0JaYkc0SDlMTnJvOUZab1FLREg4NHZSNFQ2ajU0TzN6cXFCdEdGckNVUkw=&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYzUnVBSW1mUVc1OGJzcUZ1WGdCaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[13]</b>
                                        Chi Xuebin, Gu Beibei, Wu Hong, et al.The analysis of development on high performance computer system and platform[J].Computer Engineering &amp;amp; Science, 2013, 35 (11) :6- 13 (in Chinese) (迟学斌, 顾蓓蓓, 武虹, 等.高性能计算机系统及平台发展状况分析[J].计算机工程与科学, 2013, 35 (11) :6- 13) 
                                    </a>
                                </li>
                                <li id="217">


                                    <a id="bibliography_14" title="Michalakes J, Vachharajani M.GPU acceleration of numerical weather prediction[J].Parallel Processing Letters, 2008, 18 (4) :531- 548" target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=GPU acceleration of numerical weather prediction">
                                        <b>[14]</b>
                                        Michalakes J, Vachharajani M.GPU acceleration of numerical weather prediction[J].Parallel Processing Letters, 2008, 18 (4) :531- 548
                                    </a>
                                </li>
                                <li id="219">


                                    <a id="bibliography_15" title="Song Zhenya, Liu Haixing, Lei Xiaoyan, et al.The application of GPU in ocean general circulation mode POP[J].Computer Applications and Software, 2010, 27 (10) :27- 29" target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JYRJ201010011&amp;v=MTI1OTFyRnlyblVyN09MelRaWkxHNEg5SE5yNDlFWllRS0RIODR2UjRUNmo1NE8zenFxQnRHRnJDVVJMT2VaZVI=&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYzUnVBSW1mUVc1OGJzcUZ1WGdCaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[15]</b>
                                        Song Zhenya, Liu Haixing, Lei Xiaoyan, et al.The application of GPU in ocean general circulation mode POP[J].Computer Applications and Software, 2010, 27 (10) :27- 29
                                    </a>
                                </li>
                                <li id="221">


                                    <a id="bibliography_16" title="Fu Haohuan, Liao Junfeng, Yang Jinzhe, et al.The Sunway TaihuLight supercomputer:System and applications[J].Science China Information Sciences, 2016, 59 (7) :072001:1- 072001:16" target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JFXG201607011&amp;v=MjUzMjNUYWJHNEg5Zk1xSTlFWllRS0RIODR2UjRUNmo1NE8zenFxQnRHRnJDVVJMT2VaZVJyRnlyblVyN09MeXY=&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYzUnVBSW1mUVc1OGJzcUZ1WGdCaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[16]</b>
                                        Fu Haohuan, Liao Junfeng, Yang Jinzhe, et al.The Sunway TaihuLight supercomputer:System and applications[J].Science China Information Sciences, 2016, 59 (7) :072001:1- 072001:16
                                    </a>
                                </li>
                                <li id="223">


                                    <a id="bibliography_17" title="Mellor G L.Users Guide for a Three Dimensional, Primitive Equation, Numerical Ocean Model[M].Princeton, NJ:Program in Atmospheric and Oceanic Sciences, Princeton University, 1998" target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Users guide for a three-dimensional, primitive equation, numerical ocean model">
                                        <b>[17]</b>
                                        Mellor G L.Users Guide for a Three Dimensional, Primitive Equation, Numerical Ocean Model[M].Princeton, NJ:Program in Atmospheric and Oceanic Sciences, Princeton University, 1998
                                    </a>
                                </li>
                                <li id="225">


                                    <a id="bibliography_18" title="Griffies S M, B&#246;ning C, Bryan F O, et al.Developments in ocean climate modelling[J].Ocean Modelling, 2000, 2 (3-4) :123- 192" target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=SJES&amp;filename=SJES13011300526805&amp;v=MDcyMTlOckk5Rllla0pCSHc4b0JNVDZUNFBRSC9pclJkR2VycVFUTW53WmVadUh5am1VTHJJSWx3VmF4UT1OaWZPZmJLN0h0RA==&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYzUnVBSW1mUVc1OGJzcUZ1WGdCaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[18]</b>
                                        Griffies S M, B&#246;ning C, Bryan F O, et al.Developments in ocean climate modelling[J].Ocean Modelling, 2000, 2 (3-4) :123- 192
                                    </a>
                                </li>
                                <li id="227">


                                    <a id="bibliography_19" title="Griffies S M.Elements of the modular ocean model (MOM) [OL].2012[2019-02-10].https://mom-ocean.github.io/assets/pdfs/MOM5_manual.pdf" target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Elements of the modular ocean model (MOM) [OL]">
                                        <b>[19]</b>
                                        Griffies S M.Elements of the modular ocean model (MOM) [OL].2012[2019-02-10].https://mom-ocean.github.io/assets/pdfs/MOM5_manual.pdf
                                    </a>
                                </li>
                                <li id="229">


                                    <a id="bibliography_20" title="Smith R D, Dukowicz J K, Malone R C.Parallel ocean general circulation modeling[J].Physica D:Nonlinear Phenomena, 1992, 60 (1/2/3/4) :38- 61" target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Parallel ocean general circulation modeling">
                                        <b>[20]</b>
                                        Smith R D, Dukowicz J K, Malone R C.Parallel ocean general circulation modeling[J].Physica D:Nonlinear Phenomena, 1992, 60 (1/2/3/4) :38- 61
                                    </a>
                                </li>
                                <li id="231">


                                    <a id="bibliography_21" title="Shchepetkin A F, McWilliams J C.The regional oceanic modeling system (ROMS) :A split-explicit, free-surface, topography-following-coordinate oceanic model[J].Ocean Modelling, 2005, 9 (4) :347- 404" target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=SJES&amp;filename=SJES13011300526688&amp;v=MDI1MTdpZk9mYks3SHRETnJJOUZZZWtKQ25ReG9CTVQ2VDRQUUgvaXJSZEdlcnFRVE1ud1plWnVIeWptVUxySUlsd1ZheFE9Tg==&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYzUnVBSW1mUVc1OGJzcUZ1WGdCaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[21]</b>
                                        Shchepetkin A F, McWilliams J C.The regional oceanic modeling system (ROMS) :A split-explicit, free-surface, topography-following-coordinate oceanic model[J].Ocean Modelling, 2005, 9 (4) :347- 404
                                    </a>
                                </li>
                                <li id="233">


                                    <a id="bibliography_22" title="Oey L Y.Geophysical fluid modeling with the MPI version of the Princeton ocean model (mpiPOM) [OL].2014[2018-11-01].ftp://profs.princeton.edu/leo/lecture-notes/OceanAtmosModeling/Notes/GFModellingUsingMpiPOM.pdf" target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Geophysical fluid modeling with the MPI version of the Princeton ocean model (mpiPOM) [OL]">
                                        <b>[22]</b>
                                        Oey L Y.Geophysical fluid modeling with the MPI version of the Princeton ocean model (mpiPOM) [OL].2014[2018-11-01].ftp://profs.princeton.edu/leo/lecture-notes/OceanAtmosModeling/Notes/GFModellingUsingMpiPOM.pdf
                                    </a>
                                </li>
                                <li id="235">


                                    <a id="bibliography_23" title="Xu Shizhen, Huang Xiaomeng, Oey L Y, et al.POM.gpu-v1.0:A GPU-based Princeton ocean model[J].Geoscientific Model Development, 2015, 8 (9) :2815- 2827" target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=POM.gpu-v1.0:A GPU-based princeton ocean model">
                                        <b>[23]</b>
                                        Xu Shizhen, Huang Xiaomeng, Oey L Y, et al.POM.gpu-v1.0:A GPU-based Princeton ocean model[J].Geoscientific Model Development, 2015, 8 (9) :2815- 2827
                                    </a>
                                </li>
                                <li id="237">


                                    <a id="bibliography_24" title="Zavatarielli M, Mellor G L.A numerical study of the Mediterranean sea circulation[J].Journal of Physical Oceanography, 1995, 25 (6) :1384- 1414" target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Numerical study of the mediterranean Sea circulation">
                                        <b>[24]</b>
                                        Zavatarielli M, Mellor G L.A numerical study of the Mediterranean sea circulation[J].Journal of Physical Oceanography, 1995, 25 (6) :1384- 1414
                                    </a>
                                </li>
                                <li id="239">


                                    <a id="bibliography_25" title="Kurihara Y, Bender M A, Tuleya R E, et al.Improvements in the GFDL hurricane prediction system[J].Monthly Weather Review, 1995, 123 (9) :2791- 2801" target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Improvements in the GFDL hurricane prediction system">
                                        <b>[25]</b>
                                        Kurihara Y, Bender M A, Tuleya R E, et al.Improvements in the GFDL hurricane prediction system[J].Monthly Weather Review, 1995, 123 (9) :2791- 2801
                                    </a>
                                </li>
                                <li id="241">


                                    <a id="bibliography_26" title="Kurihara Y, Tuleya R E, Bender M A.The GFDL hurricane prediction system and its performance in the 1995 hurricane season[J].Monthly Weather Review, 1998, 126 (5) :1306- 1322" target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=GFDL Hurricane Prediction System and its performance in the 1995 hurricane season">
                                        <b>[26]</b>
                                        Kurihara Y, Tuleya R E, Bender M A.The GFDL hurricane prediction system and its performance in the 1995 hurricane season[J].Monthly Weather Review, 1998, 126 (5) :1306- 1322
                                    </a>
                                </li>
                                <li id="243">


                                    <a id="bibliography_27" title="Gopalakrishnan S, Liu Qingfu, Marchok T, et al.Hurricane weather research and forecasting (HWRF) model:2011 scientific documentation[OL].2011[2018-11-01].https://dtcenter.org/HurrWRF/users/docs/scientific_documents/HWRFScientificDocumentation_August2011.pdf" target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Hurricane weather research and forecasting (HWRF) model:2011 scientific documentation[OL]">
                                        <b>[27]</b>
                                        Gopalakrishnan S, Liu Qingfu, Marchok T, et al.Hurricane weather research and forecasting (HWRF) model:2011 scientific documentation[OL].2011[2018-11-01].https://dtcenter.org/HurrWRF/users/docs/scientific_documents/HWRFScientificDocumentation_August2011.pdf
                                    </a>
                                </li>
                                <li id="245">


                                    <a id="bibliography_28" title="Tallapragada V, Bernardet L, Gopalakrishnan S, et al.Hurricane weather research and forecasting (HWRF) model:2015 scientific documentation[OL].2015[2018-11-01].https://dtcenter.org/HurrWRF/users/docs/scientific_documents/HWRF_v3.7a_SD.pdfs" target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Hurricane Weather Research and Forecasting (HWRF)Model">
                                        <b>[28]</b>
                                        Tallapragada V, Bernardet L, Gopalakrishnan S, et al.Hurricane weather research and forecasting (HWRF) model:2015 scientific documentation[OL].2015[2018-11-01].https://dtcenter.org/HurrWRF/users/docs/scientific_documents/HWRF_v3.7a_SD.pdfs
                                    </a>
                                </li>
                                <li id="247">


                                    <a id="bibliography_29" title="Oey L, Chang Yulin, Lin Yuchun, et al.ATOP-The advanced Taiwan ocean prediction system based on the mpiPOM.Part 1:Model descriptions, analyses and results[J].Terrestrial, Atmospheric &amp;amp; Oceanic Sciences, 2013, 24 (1) :137- 158" target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=ATOP-The advanced Taiwan ocean prediction system based on the mpiPOM.Part 1:Model descriptions,analyses and results">
                                        <b>[29]</b>
                                        Oey L, Chang Yulin, Lin Yuchun, et al.ATOP-The advanced Taiwan ocean prediction system based on the mpiPOM.Part 1:Model descriptions, analyses and results[J].Terrestrial, Atmospheric &amp;amp; Oceanic Sciences, 2013, 24 (1) :137- 158
                                    </a>
                                </li>
                                <li id="249">


                                    <a id="bibliography_30" title="Arakawa A, Lamb V R.Computational design of the basic dynamical processes of the UCLA general circulation model[J].General Circulation Models of The Atmosphere, 1977, 17:173- 265" target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Computational design of the basic dynamical processes of the UCLA general circulation model">
                                        <b>[30]</b>
                                        Arakawa A, Lamb V R.Computational design of the basic dynamical processes of the UCLA general circulation model[J].General Circulation Models of The Atmosphere, 1977, 17:173- 265
                                    </a>
                                </li>
                                <li id="251">


                                    <a id="bibliography_31" title="Huang Xiaomeng, Wang Wencan, Fu Haohuan, et al.A fast input/output library for high-resolution climate models[J].Geoscientific Model Development, 2014, 7 (1) :93- 103" target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=SJCO&amp;filename=SJCO14011600000015&amp;v=MDk2NDdJSWx3VmF4UT1OaWZJWWJLOEh0RE5xWTlGWk9zUERIMDhvQk1UNlQ0UFFIL2lyUmRHZXJxUVRNbndaZVp1SHlqbVVMcg==&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYzUnVBSW1mUVc1OGJzcUZ1WGdCaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[31]</b>
                                        Huang Xiaomeng, Wang Wencan, Fu Haohuan, et al.A fast input/output library for high-resolution climate models[J].Geoscientific Model Development, 2014, 7 (1) :93- 103
                                    </a>
                                </li>
                            </ul>
                            <div style='display: none;' class="zqscroller" >
                                <h4 class="">附加材料</h4>
                                <ul></ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            &nbsp;
            <!--此处有一空格符 勿删-->
        </div>

        
    <div class="content">



        <!--tips start-->
                            <div class="tips">
                    <a href="http://navi.cnki.net/KNavi/JournalDetail?pcode=CJFD&amp;pykm=JFYZ" target="_blank">计算机研究与发展</a>
                2019,56(07),1556-1566 DOI:10.7544/issn1000-1239.2019.20180791            </div>
        <!--tips end-->
            <div class="top-title">
                <h1 class="title">
                    <span class="vm"><b>基于“神威·太湖之光”的区域海洋模式并行优化</b></span>
                                    </h1>

            </div>
                        <h2>
                                <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=au&amp;skey=%E5%90%B4%E7%90%A6&amp;code=41804616&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYzUnVBSW1mUVc1OGJzcUZ1WGdCaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">吴琦</a>
                                <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=au&amp;skey=%E5%80%AA%E8%A3%95%E8%8A%B3&amp;code=42265076&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYzUnVBSW1mUVc1OGJzcUZ1WGdCaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">倪裕芳</a>
                                <a href="javascript:;">黄小猛</a>
                </h2>
                    <h2>
                    <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=in&amp;skey=%E5%9C%B0%E7%90%83%E7%B3%BB%E7%BB%9F%E6%95%B0%E5%80%BC%E6%A8%A1%E6%8B%9F%E6%95%99%E8%82%B2%E9%83%A8%E9%87%8D%E7%82%B9%E5%AE%9E%E9%AA%8C%E5%AE%A4(%E6%B8%85%E5%8D%8E%E5%A4%A7%E5%AD%A6%E5%9C%B0%E7%90%83%E7%B3%BB%E7%BB%9F%E7%A7%91%E5%AD%A6%E7%B3%BB)&amp;code=0187103&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYzUnVBSW1mUVc1OGJzcUZ1WGdCaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">地球系统数值模拟教育部重点实验室(清华大学地球系统科学系)</a>
                    <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=in&amp;skey=%E6%B8%85%E5%8D%8E%E5%A4%A7%E5%AD%A6%E5%9C%B0%E7%90%83%E7%B3%BB%E7%BB%9F%E7%A7%91%E5%AD%A6%E7%B3%BB&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYzUnVBSW1mUVc1OGJzcUZ1WGdCaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">清华大学地球系统科学系</a>
                    <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=in&amp;skey=%E5%9B%BD%E5%AE%B6%E8%B6%85%E7%BA%A7%E8%AE%A1%E7%AE%97%E6%97%A0%E9%94%A1%E4%B8%AD%E5%BF%83&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYzUnVBSW1mUVc1OGJzcUZ1WGdCaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">国家超级计算无锡中心</a>
            </h2>

        
<div class="link">
    <a id="aexport" class="icon icon-output"  onclick="" href="javascript:void(0);"><i></i>导出/参考文献</a>
    
    <span class="shareBoard" onmouseover="$('#sharedet').show();$('#this').addClass('shareBoardCUR')" onmouseout="$('#sharedet').hide();$('#this').removeClass('shareBoardCUR')">
        <a class="icon icon-share" href="#"><i></i>分享<em></em></a>
        <ul class="shareHide" id="sharedet" style="display: none;">
            <li><a title="复制链接" class="copy" onclick="" href="#"><i></i>复制链接</a></li>
            <li><a title="分享到新浪微博" class="xl" onclick="" href="javascript:common.ShareAction('xl');"><i></i>新浪微博</a></li>
            <li>
                <a title="分享到微信" class="wx" onclick="" href="#"><i></i>微信扫一扫</a>
                <div class="qrcode"><img src='' alt='' /></div>
            </li>
        </ul>

    </span>
    
    <a id="RefTrack" title="创建引文跟踪" class="icon icon-track" onclick="" href="javascript:void(0);"> <i></i>创建引文跟踪 </a>
    <a id="ashoucang" title="收藏" class="icon icon-favor" onclick="" href="javascript:void(0);"><i></i>收藏</a>
    <a class="icon icon-print" onclick="window.print();" href="javascript:void(0);"><i></i>打印</a>
    
    <!--版本切换 end-->
</div>
                            <div class="data" id="a_abstract">
                <span class="keys">摘<span style="font-family: 'Times New Roman';">&nbsp;&nbsp;&nbsp;&nbsp;</span>要：</span>
                <p>海洋模式作为地球数值模拟中重要的组成模块, 在很多领域都起到了至关重要的作用, 不仅是研究海洋、河口和海岸不可或缺的科研手段, 基于海洋模式搭建的预报系统还能够实时预测台风、海啸等现象.为了模拟更细粒度的海洋变化, 海洋模式朝着更高的分辨率和更多的物理参数化方案发展, 一般的计算机已无法满足其需求.随着散热和功耗成为通用处理器的主要瓶颈, 多核、众核以及由此导致的异构已成为下一代超级计算机的发展趋势, 这也为发展高分辨率海洋模式提供了坚实的基础平台.基于国产超级计算机“神威·太湖之光”, 利用其异构众核体系结构的优势对普林斯顿海洋模式 (Princeton ocean model, POM) 进行移植和优化, 从而充分发挥了国产异构众核平台的特点和优势.基于神威的高分辨率海洋模式swPOM (Sunway Princeton ocean model) 在主从核协作下运行效率达到纯主核的13倍, 是通用Intel平台的2.8倍左右, 可扩展到25万核上运行, 为实时预报系统提供了保障.</p>
            </div>
                    <div class="data" id="a_keywords">
                <span class="keys">关键词：</span>
                <p>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=%E6%99%AE%E6%9E%97%E6%96%AF%E9%A1%BF%E6%B5%B7%E6%B4%8B%E6%A8%A1%E5%BC%8F&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYzUnVBSW1mUVc1OGJzcUZ1WGdCaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">普林斯顿海洋模式;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=%E9%AB%98%E5%88%86%E8%BE%A8%E7%8E%87&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYzUnVBSW1mUVc1OGJzcUZ1WGdCaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">高分辨率;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=%E7%A5%9E%E5%A8%81%C2%B7%E5%A4%AA%E6%B9%96%E4%B9%8B%E5%85%89&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYzUnVBSW1mUVc1OGJzcUZ1WGdCaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">神威·太湖之光;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=%E5%BC%82%E6%9E%84&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYzUnVBSW1mUVc1OGJzcUZ1WGdCaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">异构;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=%E5%B9%B6%E8%A1%8C%E4%BC%98%E5%8C%96&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYzUnVBSW1mUVc1OGJzcUZ1WGdCaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">并行优化;</a>
                </p>
            </div>
        
        <!--brief start-->
        
            <div class="brief">
                    <p>
                            <b>作者简介：</b>
                                                        <span>
                                    Wu Qi, born in 1993.Master.His main research  interests  include  parallel computing and big data. wuq16@mails.tsinghua.edu.cn;
                                </span>
                                <span>
                                    Ni Yufang, born in 1990.Master.His main research interests include parallel computing and big data.;
                                </span>
                                <span>
                                    *Huang Xiaomeng, born in 1980.PhD, professor, PhD supervisor. His main research interests include ocean model, parallel computing, and big data. hxm@mail.tsinghua.edu.cn;
                                </span>
                    </p>
                                    <p><b>收稿日期：</b>2018-11-26</p>

                    <p>

                            <b>基金：</b>
                                                        <span>国家自然科学基金项目 (41776010);</span>
                                <span>国家重点研发计划项目 (2016YFB0201100, 2017YFC1502200, 2018YFB0505000);</span>
                                <span>青岛海洋科学与技术试点国家实验室基金项目 (QNLM2016ORP0108);</span>
                    </p>
            </div>
                    <h1><b>Regional Ocean Model Parallel Optimization in “Sunway TaihuLight</b>”</h1>
                    <h2>
                    <span>Wu Qi</span>
                    <span>Ni Yufang</span>
                    <span>Huang Xiaomeng</span>
            </h2>
                    <h2>
                    <span>Ministry of Education Key Laboratory for Earth System Modeling (Department of Earth System Science, Tsinghua University)</span>
                    <span>Department of Earth System Science, Tsinghua University</span>
                    <span>National Supercomputing Center in Wuxi</span>
            </h2>
                            <div class="data" id="a_abstractEN">
                <span class="keys">Abstract：</span>
                <p>As an important component of earth system modeling, the ocean model plays a vital role in many fields. It is not only an indispensable scientific research method for studying oceans, estuaries and coasts, but also the forecasting system based on the ocean model can predict typhoons and tsunami in real time. In order to simulate more fine-grained oceanic changes, the ocean model is moving toward higher resolution and more physical parameterization schemes, and general computers are no longer able to meet their needs. As heat dissipation and power consumption become the major bottlenecks of general-purpose processors, multi-core, many cores, and the resulting heterogeneous platform has become the main trend of next generation of supercomputers, which provides a solid foundation for developing high-resolution ocean models. Based on the domestic supercomputer “Sunway TaihuLight”, this paper takes the advantages of its heterogeneous many-core architecture to transplant and optimize the regional ocean model: Princeton ocean model (POM) , and fully utilizes the characteristics and advantages of the domestic heterogeneous many-core platform. By using master-slave core collaboration, the high-resolution ocean model swPOM increases the performance efficiency by about 13 times compared with the pure master core and about 2.8 times compared with the general Intel platform, and can scale up to 250 000 cores to provide sufficient support for real-time forecasting system.</p>
            </div>
                    <div class="data" id="a_keywordsEN">
                <span class="keys">Keyword：</span>
                <p>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=Princeton%20ocean%20model&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYzUnVBSW1mUVc1OGJzcUZ1WGdCaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">Princeton ocean model;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=high-resolution&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYzUnVBSW1mUVc1OGJzcUZ1WGdCaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">high-resolution;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=Sunway%20TaihuLight&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYzUnVBSW1mUVc1OGJzcUZ1WGdCaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">Sunway TaihuLight;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=heterogeneous&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYzUnVBSW1mUVc1OGJzcUZ1WGdCaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">heterogeneous;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=parallel%20optimization&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYzUnVBSW1mUVc1OGJzcUZ1WGdCaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">parallel optimization;</a>
                </p>
            </div>
                    <div class="brief">
                
                    <p>
                                            </p>
                                    <p><b>Received：</b> 2018-11-26</p>
                                    <p>
                            <b>Fund：</b>
                                                        <span>supported by the National Natural Science Foundation of China (41776010);</span>
                                <span>the National Key Research and Development Program of China (2016YFB0201100, 2017YFC1502200, 2018YFB0505000);</span>
                                <span>the Project of the Qingdao National Laboratory for Marine Science and Technology (QNLM2016ORP0108);</span>
                    </p>
            </div>


        <!--brief start-->
                        <div class="p1">
                    <p id="68">地球系统模拟作为研究全球变化的重要手段, 在很多领域都起到了至关重要的作用, 是国家经济、军事、农业等多方面发展的重要战略项目.以地球系统模拟中气候模式为例, 模式中气象预报的准确程度关乎着国家的农业、军事、经济、国家安全等众多方面, 与人民生活息息相关.因此, 如何提高模式的计算效率、精准率一直是国家重视的问题.且随着模式分辨率不断的提高, 模拟效果会愈加准确, 所以高分辨率地球系统模拟将是未来模式发展的必要趋势.</p>
                </div>
                <div class="p1">
                    <p id="69">海洋模式在地球系统模式中占有重要地位, 通过模拟海洋洋流、漩涡等现象, 不仅能够很好地表示海面温度和高度分布, 还能够实时预测台风、海啸等现象.尤其在沿海地带, 海洋模式在航海、渔业、台风预测等众多方面都有用武之地.除此之外, 海洋模式还是地球系统模式中计算量较大的模块, 且为海冰等其他模式提供驱动力.综上所述, 提高海洋模式的分辨率、计算效率, 能够大幅提高地球系统模拟的性能, 为国家建设保驾护航.</p>
                </div>
                <div class="p1">
                    <p id="70">近年来, 为了提高模拟的准确性以及更好地理解和预测海洋气候系统演变, 海洋模式变得越来越复杂<citation id="254" type="reference"><link href="191" rel="bibliography" /><link href="193" rel="bibliography" /><sup>[<a class="sup">1</a>,<a class="sup">2</a>]</sup></citation>.复杂性源于2个主要部分:1) 增加更多在之前的研究中未被考虑的物理过程<citation id="255" type="reference"><link href="195" rel="bibliography" /><link href="197" rel="bibliography" /><sup>[<a class="sup">3</a>,<a class="sup">4</a>]</sup></citation>.考虑到当前典型的海洋模型已经相当复杂, 具有数十万行代码<citation id="253" type="reference"><link href="199" rel="bibliography" /><sup>[<a class="sup">5</a>]</sup></citation>, 实现、调试和维护这些新增加的物理过程对于模式开发人员显然是一个极其沉重的负担.2) 对更高时空分辨率日益增长的需求, 这不仅源自更高的精确性要求, 也是模拟海洋动力学多尺度过程相互依赖的必要条件<citation id="256" type="reference"><link href="201" rel="bibliography" /><link href="203" rel="bibliography" /><link href="205" rel="bibliography" /><sup>[<a class="sup">6</a>,<a class="sup">7</a>,<a class="sup">8</a>]</sup></citation>.在更广泛的空间和时间尺度<citation id="257" type="reference"><link href="207" rel="bibliography" /><link href="209" rel="bibliography" /><link href="211" rel="bibliography" /><link href="213" rel="bibliography" /><sup>[<a class="sup">9</a>,<a class="sup">10</a>,<a class="sup">11</a>,<a class="sup">12</a>]</sup></citation>中对高分辨率海洋建模需要比之前更多的计算资源, 这些计算资源只能由超级计算机提供.</p>
                </div>
                <div class="p1">
                    <p id="71">超级计算机自出世以来, 在天气预报、军事、核业、航天等科技领域大展身手, 其性能已成为衡量国家科技能力的一个标准.随着散热和功耗成为通用处理器的主要瓶颈, 多核、众核以及由此导致的异构已成为下一代超级计算机的发展趋势<citation id="258" type="reference"><link href="215" rel="bibliography" /><sup>[<a class="sup">13</a>]</sup></citation>.近年来, 随着NVIDIA公司专门为浮点计算设计的GPU, Intel公司设计的MIC卡逐渐普及, 异构体系结构也逐步成为了超级计算机的主流方向.得益于高效率的计算以及并行机制的发展, 不少科学研究在超级计算机这个大平台上的取得了显著的效果.例如: 2008年, Michalakes等人<citation id="259" type="reference"><link href="217" rel="bibliography" /><sup>[<a class="sup">14</a>]</sup></citation>利用GPU将WRF模式中的一个计算密集型过程加速了25倍;2010年Song等人<citation id="260" type="reference"><link href="219" rel="bibliography" /><sup>[<a class="sup">15</a>]</sup></citation>利用OpenACC方式, 加速了POP (parallel ocean program) 中某些函数, 达到2.2倍加速效果.由此可见, 异构众核的超级计算机体系结构大幅度提高计算效率, 推动了模式的发展.</p>
                </div>
                <div class="p1">
                    <p id="72">综上所述, 为了提高海洋模式的分辨率、计算效率, 本文基于国产超级计算机“神威·太湖之光”<citation id="261" type="reference"><link href="221" rel="bibliography" /><sup>[<a class="sup">16</a>]</sup></citation>, 移植并优化了适用于异构众核体系结构的高分辨率区域海洋模式swPOM (Sunway Princeton ocean model) .这一模式充分发挥了国产异构众核平台的特点和优势, 能够进行高分辨率的区域海洋数值模拟, 并且在性能上与通用平台相比得到2.8倍左右的提升, 为实时预报平台提供了保障.本文主要贡献有3个方面:</p>
                </div>
                <div class="p1">
                    <p id="73">1) 在区域海洋模式POM<citation id="262" type="reference"><link href="223" rel="bibliography" /><sup>[<a class="sup">17</a>]</sup></citation> (Princeton ocean model) 的基础上, 基于异构众核超级计算机“神威·太湖之光”实现了高分辨率区域海洋模式swPOM.</p>
                </div>
                <div class="p1">
                    <p id="74">2) 充分利用众核优势和大规模并行优化技术, swPOM的性能达到传统超算平台的2.8倍以上, 并且能够扩展到25万核规模以上.</p>
                </div>
                <div class="p1">
                    <p id="75">3) swPOM集成了高效的I/O库, 使用计算进程与I/O进程相互屏蔽的方式, 在相同资源下性能比传统同步I/O方式提高了20%.</p>
                </div>
                <div class="area_img" id="76">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JFYZ201907020_076.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYzUnVBSW1mUVc1OGJzcUZ1WGdCaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图1 异构众核处理器——申威26010" src="Detail/GetImg?filename=images/JFYZ201907020_076.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYzUnVBSW1mUVc1OGJzcUZ1WGdCaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图1 异构众核处理器——申威26010  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JFYZ201907020_076.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYzUnVBSW1mUVc1OGJzcUZ1WGdCaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit">Fig. 1 Heterogeneous many-core processor — SW26010</p>

                </div>
                <h3 id="77" name="77" class="anchor-tag"><b>1 相关工作</b></h3>
                <div class="p1">
                    <p id="78">海洋模式自1967年诞生以来发展迅速, 至今已经有40多个海洋模式版本, 包括对不同区域和不同学科的海洋模式<citation id="263" type="reference"><link href="225" rel="bibliography" /><sup>[<a class="sup">18</a>]</sup></citation>.其中比较有代表性有全球海洋模式<citation id="264" type="reference"><link href="227" rel="bibliography" /><sup>[<a class="sup">19</a>]</sup></citation> (modular ocean model, MOM) , POP<citation id="265" type="reference"><link href="229" rel="bibliography" /><sup>[<a class="sup">20</a>]</sup></citation>, 区域海洋模式<citation id="266" type="reference"><link href="231" rel="bibliography" /><sup>[<a class="sup">21</a>]</sup></citation> (regional ocean model system, ROMS) , POM等.目前多数海洋模式已经能够较为精确地模拟海面温度和高度的分布、海流分布等过程, 而有些模式更是充分利用海洋资料同化系统开发海气耦合模式, 这些都是海洋模式发展的重要方向.海洋模式本质上是用数值方法来模拟和预测海洋未来变化趋势.而大规模模式低下的计算效率、海量的输出数据、频繁的通信以及高需求的存储空间使得高分辨率海洋模式发展成为了一个巨大的挑战.依赖于处理器性能的不断提升和超级计算机体系结构不断的演变与发展, 尤其是多核处理器、集成众核处理器等形式的诞生, 有越来越多的模式研究人员将模式调整后移植到超级计算机上, 计算效率得到了空前的提升.</p>
                </div>
                <div class="p1">
                    <p id="79">例如mpiPOM<citation id="267" type="reference"><link href="233" rel="bibliography" /><sup>[<a class="sup">22</a>]</sup></citation> (the message passing interface version of the POM) 在POM的基础上增加了MPI并行化, 在逻辑上采用2维剖分, 每个进程的划分模块包含4个方向的halo区, 用于与周边进程进行数据交互.2014年Huang等人<citation id="268" type="reference"><link href="235" rel="bibliography" /><sup>[<a class="sup">23</a>]</sup></citation>将POM移植到GPU平台, 利用4个K20 GPU进行数值模拟, 性能能够媲美408个CPU.除了通过并行提高计算效率之外, 针对模式中输出数据海量的特点, 美国大气研究协会特地开发了NetCDF (network common data form) 标准, 以便对输出数据进行格式统一.而基于该标准之上的高效并行I/O库PnetCDF (parallel NetCDF) 能够提高超级计算机I/O资源的利用率, 缩短模式I/O时间.</p>
                </div>
                <div class="p1">
                    <p id="80">综上所述, 在国产异构众核超算平台上设计发展高分辨率海洋模式具有深远意义, 不仅意味着可以模拟中小尺度、更加细致性的物理海洋现象, 而且也能保证模拟速度满足时间约束性极强的实时预报系统.</p>
                </div>
                <h3 id="81" name="81" class="anchor-tag"><b>2</b> “<b>神威</b>·<b>太湖之光”系统概述及POM性能分析</b></h3>
                <h4 class="anchor-tag" id="82" name="82"><b>2.1</b> “<b>神威</b>·<b>太湖之光</b>”</h4>
                <div class="p1">
                    <p id="83">“神威·太湖之光”超级计算机采用的处理器是我国自主研发设计的异构众核处理器——申威26010处理器.如图1所示, 神威众核处理器采用片上融合的异构体系结构, 每个芯片共有4个异构群和群间传输网络组成.每个异构群包括1个主核、64个从核簇以及存储器, 其中主核的工作频率为1.5 GHz, L1 Cache为32 KB, L2 Cache为256 KB.与一般Intel处理器不同, 由于神威众核处理器特殊的从核簇结构, CPU上不包含L3 Cache, 从核的工作频率也为1.5 GHz, 每个从核可用的独享存储空间 (local device memory, LDM) 为64 KB, 每个从核对其独享的LDM存储空间具有较高的数据读取速度.主核和从核簇通过异构群接口与存储器相连, 两者共享存储器存储空间.4个异构群和系统接口总线通过群间传输网络进行存储共享和通信.</p>
                </div>
                <div class="p1">
                    <p id="84">相比于一般的处理器, 神威众核处理器虽然舍弃了L3 Cache存储空间, 但由于其从核的特殊性, 若通过有效设计计算核心代码, 使其能在从核间并行运行, 能够达到比在一般处理器上更好的计算效果.理论上, 申威26010处理器的双精度浮点数峰值性能为3.06TFLOPS, “神威·太湖之光”的理论双精度浮点峰值运算速度可达到100PFLOPS.</p>
                </div>
                <div class="area_img" id="85">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JFYZ201907020_085.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYzUnVBSW1mUVc1OGJzcUZ1WGdCaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图2 主从加速并行模式" src="Detail/GetImg?filename=images/JFYZ201907020_085.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYzUnVBSW1mUVc1OGJzcUZ1WGdCaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图2 主从加速并行模式  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JFYZ201907020_085.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYzUnVBSW1mUVc1OGJzcUZ1WGdCaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit">Fig. 2 Master-slave collaborative acceleration parallel mode</p>

                </div>
                <div class="p1">
                    <p id="86">根据申威处理器异构众核的特性, 我们需要分析科学计算中不同计算核心的可并行性, 尽量将能够加速并行的计算核心段加载到从核簇上并行运行, 主核则完成不可以在从核上并行加速的计算段以及通信部分.如图2所示, 在模式中包括<i>A</i>, <i>B</i>, <i>C</i>这3个计算核心, 主核在完成计算核心<i>A</i>后, 将计算核心<i>B</i>加载到众核上进行并行加速, 在此期间主核进行等待, 计算完毕后返回主核继续计算计算核心<i>C</i>, 这种方式能够充分发挥众核的优势.比主从加速并行模式更理想的是主从异步并行模式, 即主核和从核同时计算不同的工作, 之后再进行数据同步等操作.但在真实科学计算中很难有如此之高的并行性, 尤其是复杂的海洋模式, 目前无法进行主从异步并行加速.</p>
                </div>
                <h4 class="anchor-tag" id="87" name="87"><b>2.2 区域海洋模式POM</b></h4>
                <div class="p1">
                    <p id="88">区域海洋模式POM是一种强大的海洋模型, 已广泛应用于模拟河流、江口、湖泊、半封闭海域以及开放的全球海洋中水流的循环和混合过程.同时也是很多实时海洋、台风预报系统的核心模块, 已经被运用于地中海预报系统<citation id="269" type="reference"><link href="237" rel="bibliography" /><sup>[<a class="sup">24</a>]</sup></citation>、GFDL (Geophysical Fluid Dynamics Laboratory) 飓风预报系统<citation id="272" type="reference"><link href="239" rel="bibliography" /><link href="241" rel="bibliography" /><sup>[<a class="sup">25</a>,<a class="sup">26</a>]</sup></citation>、美国飓风预报系统<citation id="273" type="reference"><link href="243" rel="bibliography" /><link href="245" rel="bibliography" /><sup>[<a class="sup">27</a>,<a class="sup">28</a>]</sup></citation>以及台湾海洋预报系统<citation id="270" type="reference"><link href="247" rel="bibliography" /><sup>[<a class="sup">29</a>]</sup></citation>等.POM的主要特征是:在垂直方向使用sigma坐标, 在水平方向使用Arakawa C<citation id="271" type="reference"><link href="249" rel="bibliography" /><sup>[<a class="sup">30</a>]</sup></citation>网格.为了有效地处理海洋的快速波动, 采用模式分裂方法处理快速表面重力波和其他慢波, 分别模拟正压 (外模态) 和斜压 (内模态) 模式并在一定时间步长后耦合在一起.整个模式的运行流程如图3所示.其中外模态循环迭代次数最多, 需要计算的量也多, 是POM中最为耗时的模块.</p>
                </div>
                <div class="area_img" id="89">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JFYZ201907020_089.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYzUnVBSW1mUVc1OGJzcUZ1WGdCaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图3 POM程序运行流程图" src="Detail/GetImg?filename=images/JFYZ201907020_089.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYzUnVBSW1mUVc1OGJzcUZ1WGdCaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图3 POM程序运行流程图  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JFYZ201907020_089.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYzUnVBSW1mUVc1OGJzcUZ1WGdCaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit">Fig. 3 The flowchart of POM</p>

                </div>
                <h3 id="90" name="90" class="anchor-tag"><b>3 POM移植及性能分析</b></h3>
                <div class="p1">
                    <p id="91">为了实现高分辨率区域海洋模式的高效模拟, 我们首先将mpiPOM从通用x86平台下移植到国产异构众核超级计算机上.而模式的运行效率受模式分辨率、模拟的总时间、程序的并行程度、模式的初始状态等多方面因素影响.因此, 设计1组基准实验版本对于后续的测试分析至关重要.我们规定后续的实验中, POM都以台湾海峡作为模拟场景, 统一模式的全局分辨率为11 522×5 186, 与“高分辨率海洋模式”契合, 模式的迭代步长为10 s, 一共迭代20步, 最后进行1次数据输出.在此基础上, 设计2组基准实验.</p>
                </div>
                <div class="p1">
                    <p id="92">1) 性能测试.固定全局分辨率 (11 522×5 186) 、每个进程的局部分辨率 (578×578) , 测试在180核规模下加速后不同版本的POM运行效率, 运行时间越短表明并行加速效果越好.</p>
                </div>
                <div class="p1">
                    <p id="93">2) 强扩展性测试.固定全局分辨率 (11 522×5 186) 、改变运行时投入的计算资源, 测试POM在不同核数规模下的运行效率, 从而反映出区域海洋模式的扩展性.一般情况下, 程序运行时间会随着核数规模的扩大而逐渐减小, 假如核数规模扩大了<i>k</i>倍, 加速后模式的运行时间越接近于原始版本运行时间的1/<i>k</i>倍, 表明扩展性越好.</p>
                </div>
                <div class="p1">
                    <p id="94">我们将移植后的程序视为基准版本, 对其进行2组基准实验测试, 对模式中的各个模块测试并进行性能分析.区域海洋模式POM移植前在通用Intel CPU的架构下进行性能测试实验大概需要55 s左右, 程序移植到“神威·太湖之光”上采用纯主核运行基准实验1大概需要241 s左右.</p>
                </div>
                <div class="area_img" id="95">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JFYZ201907020_095.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYzUnVBSW1mUVc1OGJzcUZ1WGdCaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图4 POM各模块耗时百分比" src="Detail/GetImg?filename=images/JFYZ201907020_095.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYzUnVBSW1mUVc1OGJzcUZ1WGdCaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图4 POM各模块耗时百分比  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JFYZ201907020_095.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYzUnVBSW1mUVc1OGJzcUZ1WGdCaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit">Fig. 4 The runtime percentage of each module</p>

                </div>
                <div class="p1">
                    <p id="96">在进行性能优化之前, 我们先对移植后的POM进行性能分析.首先进行热点分析.在基准实验1下, 我们分析POM中各个子模块耗时情况和特点, 能够帮助我们定位性能瓶颈并针对各个模块的特点找到可行的加速方法.如图4所示, 可以发现在180核的情况下, 主要是动力计算模块耗时较多, 占到了约93%的比例, 而通信和其他模块所占比例只有不到7%.动力过程的计算elf, uaf, vaf, pro, vort等模块都是经典的stencil过程.可以看到, POM各模块耗时非常平均, 基本没有主要的热点模块, 必须针对这些模块的特性进行特定的性能优化.</p>
                </div>
                <div class="p1">
                    <p id="97">在扩展性分析方面, 我们分别测试基准实验2在160, 180, 216, 288, 576, 720, 1 152, 1 620, 2 304, 2 880, 3 240, 3 840核数规模下POM的运行时间, 如图5所示.可以发现在同一全局分辨率下, 随着核数增加, 即每个进程内局部分辨率减小, POM的原始版本运行耗时会逐渐缩小, 在500核之前扩展性表现都不错.但在核数规模增大到一定规模后, 由于进程间通信变得愈加频繁, 进程初始化、回收等影响, 程序运行耗时变化趋势越来越平缓.此外, 在3 840核数规模下运行时间仅仅为8.91 s, 比160核规模下提高了高达31倍的运行效率, 由此可见扩大高分辨率海洋模式的核数规模能够满足众多实时预报系统对时间的约束性.</p>
                </div>
                <div class="area_img" id="98">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JFYZ201907020_098.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYzUnVBSW1mUVc1OGJzcUZ1WGdCaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图5 POM在纯主核上的强扩展性" src="Detail/GetImg?filename=images/JFYZ201907020_098.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYzUnVBSW1mUVc1OGJzcUZ1WGdCaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图5 POM在纯主核上的强扩展性  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JFYZ201907020_098.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYzUnVBSW1mUVc1OGJzcUZ1WGdCaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit">Fig. 5 The strong scalability of original POM</p>

                </div>
                <div class="p1">
                    <p id="99">图6展示了不同核数规模下通信在POM中的耗时占比的变化情况.在180核数规模下, 通信耗时占比为1.1%, 而随着核数规模的提升, 通信模块耗时占比逐渐上升.在3 840大规模核数下, 通信耗时比占到了24%.mpiPOM的通信目的是交换边界数据, 假设当前进程内的网格大小为<i>x</i>×<i>y</i>, 则需要进行通信的数据为该矩形网格的4个边界 (最外围网格除外) , 即通信部分数据量大小为2<i>x</i>+2<i>y</i>, 因此通信耗时占比公式可以简化为</p>
                </div>
                <div class="p1">
                    <p id="100"><mathml id="101"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>p</mi><mo>=</mo><mfrac><mrow><mi>a</mi><msub><mrow></mrow><mn>1</mn></msub><mo>×</mo><mo stretchy="false"> (</mo><mn>2</mn><mi>x</mi><mo>+</mo><mn>2</mn><mi>y</mi><mo stretchy="false">) </mo></mrow><mrow><mi>a</mi><msub><mrow></mrow><mn>2</mn></msub><mi>x</mi><mi>y</mi></mrow></mfrac></mrow></math></mathml>, (1) </p>
                </div>
                <div class="p1">
                    <p id="102">其中, <i>a</i><sub>1</sub>, <i>a</i><sub>2</sub>为相关系数, <i>a</i><sub>1</sub>表示通信效率, <i>a</i><sub>2</sub>表示计算效率.从式 (1) 能够发现, 随着<i>x</i>和<i>y</i> (即局部分辨率) 逐渐缩小, 通信耗时比<i>p</i>会逐渐增大.式 (1) 仅仅只考虑了通信量, 然而随着更多的计算资源投入其中, 大量的MPI初始化、回收等也会成为制约因素.鉴于核数规模上升到一定程度后, 通信部分会成为制约效率的关键因素, 因此盲目增加计算资源、大肆扩大运行核数所带来的运行效果提升是非常有限的, 有时甚至会适得其反.</p>
                </div>
                <div class="area_img" id="103">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JFYZ201907020_103.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYzUnVBSW1mUVc1OGJzcUZ1WGdCaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图6 不同核数规模下通信在POM中的耗时占比" src="Detail/GetImg?filename=images/JFYZ201907020_103.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYzUnVBSW1mUVc1OGJzcUZ1WGdCaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图6 不同核数规模下通信在POM中的耗时占比  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JFYZ201907020_103.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYzUnVBSW1mUVc1OGJzcUZ1WGdCaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit">Fig. 6 The proportion of communication time of POM  using different number of cores</p>

                </div>
                <h3 id="104" name="104" class="anchor-tag"><b>4 面向异构众核处理器的并行优化方法</b></h3>
                <h4 class="anchor-tag" id="105" name="105"><b>4.1 主从协同计算方案</b></h4>
                <div class="p1">
                    <p id="106">POM将区域海洋划分为2维网格, 每个网格之间具有天然并行性.而对于每一个网格内部, 则可以规约为求解每个时刻每个点的速度、位置等变量, 且这些变量只与上一步的迭代状态相关, 只影响下一步的迭代状态.因此我们可以挖掘更细粒度的并行性, 实现“基于MPI进程级并行+众核线程级并行”的两级并行方式.但由于从核中的LDM存储空间仅有64 KB, 难以存放计算核心中需要的所有变量, 因此我们采用在代码层面对耗时多的循环进行众核并行的方式.</p>
                </div>
                <div class="p1">
                    <p id="107">对循环的众核级并行方案如下:最外层循环进行众核加速, 由于每个从核簇有64个从核, 因此在划分网格时最好能够将外层循环对应的维度设置为64的整数倍, 以求最大程度得利用从核.内部循环的计算核心分为2个模块在从核运行:第1模块为所需要的数据访存通信, 即从核向主核发起通信读入或写出计算所需数据;第2模块为计算部分, 即计算核心在64个从核上并行的运行.众核级加速的伪代码如图7所示.</p>
                </div>
                <div class="area_img" id="108">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JFYZ201907020_108.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYzUnVBSW1mUVc1OGJzcUZ1WGdCaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图7 众核并行伪代码示意图" src="Detail/GetImg?filename=images/JFYZ201907020_108.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYzUnVBSW1mUVc1OGJzcUZ1WGdCaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图7 众核并行伪代码示意图  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JFYZ201907020_108.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYzUnVBSW1mUVc1OGJzcUZ1WGdCaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit">Fig. 7 The pseudo code of many-core parallelism</p>

                </div>
                <div class="p1">
                    <p id="109">根据上述众核并行加速方案, 假如一个任务在主核上运行的时间为<i>T</i>, 则用主从加速并行方法的总时间为从核的计算时间加上从核与主核的通信时间.由于“神威·太湖之光”的主从核频率相当, 通过<i>num</i>个从核并行计算, 该任务的运行时间为<i>T</i>/<i>num</i>.假设每次数据通信的开销为<i>cost</i>, 一共要进行<i>N</i>次主从核间通信, 故通信总时间为<i>cost</i>×<i>N</i>.由此可得众核加速比为</p>
                </div>
                <div class="p1">
                    <p id="110">众核加速比<mathml id="111"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo>=</mo><mfrac><mrow><mtext>单</mtext><mtext>核</mtext><mtext>开</mtext><mtext>销</mtext></mrow><mrow><mtext>众</mtext><mtext>核</mtext><mtext>总</mtext><mtext>开</mtext><mtext>销</mtext></mrow></mfrac><mo>=</mo><mfrac><mi>Τ</mi><mrow><mfrac><mi>Τ</mi><mrow><mi>n</mi><mi>u</mi><mi>m</mi></mrow></mfrac><mo>+</mo><mi>c</mi><mi>o</mi><mi>s</mi><mi>t</mi><mo>×</mo><mi>Ν</mi></mrow></mfrac></mrow></math></mathml>. (2) </p>
                </div>
                <div class="p1">
                    <p id="112">虽然从核的LDM存储空间仅有64 KB, 但在网格剖分时每个网格的分辨率也不会太大, 所以绝大部分计算核心都能够进行循环级并行.但模式中少数循环会有较为复杂的操作, 导致变量无法全部读进LDM空间, 因此还需要对内部循环进行分块处理.</p>
                </div>
                <h4 class="anchor-tag" id="113" name="113"><b>4.2 从核访存优化方案</b></h4>
                <div class="p1">
                    <p id="114">海洋模式在求解的离散偏微分方程中会使用大量的stencil操作, 往往涉及到多个方向上的差分.以POM中计算<i>elf</i>过程为例:</p>
                </div>
                <div class="area_img" id="281">
                                <img alt="" src="Detail/GetImg?filename=images/JFYZ201907020_28100.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYzUnVBSW1mUVc1OGJzcUZ1WGdCaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                            <p class="img_tit"></p>

                </div>
                <div class="p1">
                    <p id="120">在计算点 (<i>j</i>, <i>i</i>) 点上的物理量时, 需要相邻点 (<i>j</i>, <i>i</i>+1) 和 (<i>j</i>+1, <i>i</i>) 的值, 有些计算过程甚至需要更多相邻点参与计算.而计算机体系结构决定了多维数组在内存中只能有最低维的数据是相邻的, 如果要连续访问高维数组便不可避免有大量离散访存的行为, 对于cache的重用性极低.</p>
                </div>
                <div class="p1">
                    <p id="121">在POM的advave, vort, bcond模块中, 有大量跨步访问的方式.这也导致从核从主核读取数据时, 需要大量的跨步访问.针对这种现象, 我们采用图8所示的优化策略, 对计算核心进行调整.首先在主存中将离散访问的数组调整为能够连续访存的数组, 本质上就是开辟一块新的空间, 调整高低维顺序, 之后从核就能够在计算过程中连续访问数组内容.调整之后的访存效率远高于原先的方式, 从而大幅度提高计算效率.最后在计算结束后回写数据时再次将数组调整为原始状态.</p>
                </div>
                <div class="area_img" id="122">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JFYZ201907020_122.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYzUnVBSW1mUVc1OGJzcUZ1WGdCaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图8 访存优化示意图" src="Detail/GetImg?filename=images/JFYZ201907020_122.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYzUnVBSW1mUVc1OGJzcUZ1WGdCaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图8 访存优化示意图  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JFYZ201907020_122.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYzUnVBSW1mUVc1OGJzcUZ1WGdCaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit">Fig. 8 The diagram of memory access optimization</p>

                </div>
                <h4 class="anchor-tag" id="123" name="123"><b>4.3 主从核异步数据交互方案</b></h4>
                <div class="p1">
                    <p id="124">观察POM的程序, 我们发现在计算<i>uaf</i>, <i>pro</i>, <i>bcond</i>模块的时候, 对于从核LDM存储空间的利用率不高.因此我们引入双缓冲机制, 让主从核间实现数据的异步交互, 从而降低或隐藏从核通信开销.</p>
                </div>
                <div class="p1">
                    <p id="125">在对涉及变量较少的计算模块进行主从核加速时, 往往在从核的LDM存储空间上申请2倍于通信数据大小的存储空间, 用来存放2份同样大小且互相为对方缓冲的数据.原先的循环方式如图9 (a) 所示, 每次迭代的时候都先读入数据、进行计算, 最后写回数据.而双缓冲的具体过程如图9 (b) 所示, 除了第1次读入数据以及最后1次写回数据不与计算重叠, 其他的数据通信都与计算过程相重叠.在进行当前次计算的同时, 读入下一轮次的数据作为下一次迭代的基础, 同时在该轮次写回上一轮次已经计算好的数据, 通过该方式能够将计算核心和通信过程相互重叠, 从而达到加速的效果.</p>
                </div>
                <div class="area_img" id="126">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JFYZ201907020_126.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYzUnVBSW1mUVc1OGJzcUZ1WGdCaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图9 主从核异步交互示意图" src="Detail/GetImg?filename=images/JFYZ201907020_126.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYzUnVBSW1mUVc1OGJzcUZ1WGdCaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图9 主从核异步交互示意图  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JFYZ201907020_126.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYzUnVBSW1mUVc1OGJzcUZ1WGdCaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit">Fig. 9 Asynchronous interaction between master and slave cores</p>

                </div>
                <div class="p1">
                    <p id="127">假设每次读入、写回数据的通信开销为<i>cost</i>, <i>n</i>次读入、写回数据中一共有<i>n</i>-1次能够与计算模块重叠, 因此能够与计算模块重叠的最大通信开销为<i>cost</i>× (<i>n</i>-1) .其中第1次读入数据和最后1次写回数据无法与计算模块重叠, 这部分通信开销总和为<i>p</i>.而原先的计算模块在纯主核下消耗的时间为<i>T</i>, 通过<i>num</i>个从核的从核簇并行运行计算消耗的时间则为<i>T</i>/<i>num</i>.因此众核加速比为</p>
                </div>
                <div class="p1">
                    <p id="128">众核加速比<mathml id="129"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo>=</mo><mfrac><mi>Τ</mi><mrow><mi>max</mi><mrow><mo> (</mo><mrow><mfrac><mi>Τ</mi><mrow><mi>n</mi><mi>u</mi><mi>m</mi></mrow></mfrac><mo>, </mo><mi>c</mi><mi>o</mi><mi>s</mi><mi>t</mi><mo>×</mo><mo stretchy="false"> (</mo><mi>n</mi><mo>-</mo><mn>1</mn><mo stretchy="false">) </mo></mrow><mo>) </mo></mrow><mo>+</mo><mi>p</mi></mrow></mfrac></mrow></math></mathml>, (3) </p>
                </div>
                <div class="p1">
                    <p id="130">与主从核协同交互方法相比较, 主从核异步数据交互方法相当于在此基础上又将计算模块与访存通信模块相互隐藏, 提高了计算效率.可以发现当计算模块与访存通信模块耗时越相近时, 加速效果越好, 最多能够达到接近于2倍的加速效果.</p>
                </div>
                <h3 id="131" name="131" class="anchor-tag"><b>5 面向“神威</b>·<b>太湖之光”大规模并行优化方法</b></h3>
                <h4 class="anchor-tag" id="132" name="132"><b>5.1 并行通信优化方案</b></h4>
                <div class="p1">
                    <p id="133">当并行规模扩展到一定规模, 应用中通信占比也会随之增大, 应用的热点也会逐渐从核心计算转移到通信, 通信开销会成为整个海洋模式的性能瓶颈.</p>
                </div>
                <div class="p1">
                    <p id="134">POM中采用的是传统的阻塞型通信, 即计算与通信模式是串行的, 如图10所示:</p>
                </div>
                <div class="area_img" id="135">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JFYZ201907020_135.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYzUnVBSW1mUVc1OGJzcUZ1WGdCaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图10 单进程halo区通信示意图" src="Detail/GetImg?filename=images/JFYZ201907020_135.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYzUnVBSW1mUVc1OGJzcUZ1WGdCaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图10 单进程halo区通信示意图  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JFYZ201907020_135.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYzUnVBSW1mUVc1OGJzcUZ1WGdCaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit">Fig. 10 The halo region update pattern</p>

                </div>
                <div class="p1">
                    <p id="136">每一步迭代中每个进程先向其他进程发送边界数据, 同时接受周围进程的边界数据;然后再进行核心计算, 更新完数据进入下一轮迭代.可以将两者的串行逻辑解耦成计算与通信重叠的运算逻辑.主核在做边界通信的同时, 众核没有必要等待其通信结束后再进行计算, 而是去进行内部格点的核心计算, 从而达到计算与通信相互隐藏.计算与通信重叠的具体方法为:</p>
                </div>
                <div class="p1">
                    <p id="137">1) 每个进程首先采用异步方式 (非阻塞通信) 向周边进程发送其需要的数据;</p>
                </div>
                <div class="p1">
                    <p id="138">2) 每个进程发起异步接受req请求, 从周边进程接收本进程需要的数据;</p>
                </div>
                <div class="p1">
                    <p id="139">3) 每个进程通过从核并行计算内部inner区域并更新内部数据;</p>
                </div>
                <div class="p1">
                    <p id="140">4) 检查每个进程req请求是否完成, 通过完成后得到的边界数据进行边界的计算并更新边界数据.</p>
                </div>
                <div class="p1">
                    <p id="141">通过计算与通信重叠的方式, 能够有效地将通信消耗隐藏于计算中, 尤其是当核数规模上升后, 通信耗时占比增大的情况下, 该方法能够取得不错的效果.</p>
                </div>
                <h4 class="anchor-tag" id="142" name="142"><b>5.2 并行I/O优化方案</b></h4>
                <div class="p1">
                    <p id="143">当并行规模增大后, I/O也会成为整个海洋模式的瓶颈.当多个进程发起I/O请求后, 文件系统会处理这些请求, 并将数据从磁盘读出或写入磁盘.但当上千个进程同时发生请求, I/O的并发处理效率极低.因此我们引入了CFIO<citation id="274" type="reference"><link href="251" rel="bibliography" /><sup>[<a class="sup">31</a>]</sup></citation> (climate fast input/output) , 通过I/O转发的方式来重叠I/O过程, 并且大量减少I/O请求, 提高I/O性能.</p>
                </div>
                <div class="p1">
                    <p id="144">CFIO采用的方式是将所有的进程分为计算进程与I/O进程, 一个I/O进程对应于多个计算进程.计算进程将I/O请求通过CFIO接口转发I/O进程, I/O进程再调用成熟的PnetCDF库将数据写入文件.图11展示了接入CFIO后模式的运行顺序与原先顺序的对比.</p>
                </div>
                <div class="area_img" id="145">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JFYZ201907020_145.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYzUnVBSW1mUVc1OGJzcUZ1WGdCaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图11 原始模式I/O与使用CFIO进行I/O方式对比" src="Detail/GetImg?filename=images/JFYZ201907020_145.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYzUnVBSW1mUVc1OGJzcUZ1WGdCaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图11 原始模式I/O与使用CFIO进行I/O方式对比  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JFYZ201907020_145.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYzUnVBSW1mUVc1OGJzcUZ1WGdCaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit">Fig. 11 Original I/O mode vs CFIO I/O mode</p>

                </div>
                <div class="p1">
                    <p id="146">使用CFIO的swPOM运行方式与原有方式略微不同.方式1是原有运行模式, 先进行数值计算;然后所有进程进行I/O, 并等待I/O完成再进行下一步的数值计算, 依次循环.而CFIO中, 计算进程会把I/O请求转发给I/O进程, 待请求转发之后便进行下一步的数值计算, 从而实现I/O与计算的相互重叠.</p>
                </div>
                <h3 id="147" name="147" class="anchor-tag"><b>6 实验结果及分析</b></h3>
                <h4 class="anchor-tag" id="148" name="148"><b>6.1 面向异构众核处理器的并行优化方法结果分析</b></h4>
                <div class="p1">
                    <p id="149">在POM的不同模块中使用主从协同计算方案, 经过加速后的swPOM v1.0版本与Original POM版本在基准实验1的性能对比, 如表1所示.除了边界bcond模块与通信comm模块, 其他模块均取得了显著的加速比, 在180核下swPOM v1.0只需要运行45 s, 取得了5.3倍的加速比.</p>
                </div>
                <div class="area_img" id="150">
                    <p class="img_tit"><b>表1 swPOM v1.0与Original POM性能对比</b> <a class="downexcel" onclick="DownLoadReportExcel(this)">导出到EXCEL</a></p>
                    <p class="img_tit"><b>Table 1 Performance Comparison Between swPOM v1.0 and Original POM</b></p>
                    <p class="img_note"></p>
                    <table id="150" border="1"><tr><td rowspan="2"><br />Module</td><td colspan="2"><br />180 Master Cores<br />Original POM</td><td colspan="2">180 Master-slave<br />Cores swPOM v1.0</td></tr><tr><td>Runtime/s</td><td>Runtime Ratio/%</td><td>Runtime/s</td><td>Runtime Ratio/%</td></tr><tr><td>elf</td><td><b>18.146</b></td><td><b> 7.540</b></td><td><b> 1.432</b></td><td><b> 3.172</b></td></tr><tr><td><br />uaf</td><td><b>36.132</b></td><td><b>15.013</b></td><td><b>1.786</b></td><td><b>3.957</b></td></tr><tr><td><br />vaf</td><td><b>34.757</b></td><td><b>14.442</b></td><td><b>2.167</b></td><td><b>4.800</b></td></tr><tr><td><br />pro</td><td><b>24.072</b></td><td><b>10.002</b></td><td><b>1.890</b></td><td><b>4.188</b></td></tr><tr><td><br />egf</td><td><b>15.335</b></td><td><b>6.372</b></td><td><b>1.013</b></td><td><b>2.244</b></td></tr><tr><td><br />advave</td><td><b>36.161</b></td><td><b>15.025</b></td><td><b>5.673</b></td><td><b>12.568</b></td></tr><tr><td><br />vort</td><td><b>58.639</b></td><td><b>24.365</b></td><td><b>12.878</b></td><td><b>28.531</b></td></tr><tr><td><br />bcond</td><td>10.582</td><td>4.397</td><td>10.937</td><td>24.230</td></tr><tr><td><br />comm</td><td>2.732</td><td>1.135</td><td>1.229</td><td>2.723</td></tr><tr><td><br />others</td><td>4.113</td><td>1.709</td><td>6.133</td><td>13.587</td></tr><tr><td><br />All</td><td>240.669</td><td>100</td><td>45.138</td><td>100</td></tr></table>
                    <form name="form" action="/kxreader/Detail/DownloadReportExcel" method="POST" style="display:inline">
                        <input type="hidden" name="hidTable" value="" />
                        <input type="hidden" name="hidFileName" value="" />
                    </form>
                    <p class="img_note"></p>
                    <p class="img_note">Note: The bold cells in the table represent the modules accelerated by the master-slave collaboration.</p>
                </div>
                <div class="p1">
                    <p id="152">为了进一步验证swPOM v1.0在各个并行规模下的运行效率, 我们也对其进行了强扩展性测试, 结果如图12所示.与Original POM相比, 在不同的核数规模下均取得了2倍及以上的加速效果.</p>
                </div>
                <div class="area_img" id="153">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JFYZ201907020_153.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYzUnVBSW1mUVc1OGJzcUZ1WGdCaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图12 swPOM v1.0在纯主核上的强扩展性" src="Detail/GetImg?filename=images/JFYZ201907020_153.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYzUnVBSW1mUVc1OGJzcUZ1WGdCaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图12 swPOM v1.0在纯主核上的强扩展性  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JFYZ201907020_153.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYzUnVBSW1mUVc1OGJzcUZ1WGdCaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit">Fig. 12 The strong scalability of swPOM v1.0</p>

                </div>
                <div class="p1">
                    <p id="154">通过分析POM每个模块的代码, 我们发现advave, vort, bcond这3个模块中有大量的离散访问形式.表2中展示了对这3个模块进行访存优化的数据, 分别达到了2.2倍、4.5倍以及9.3倍的加速比.而swPOM v1.1版本整体运行效率也比swPOM v1.0加速了2倍左右, 该版本相较于通用Intel平台下55 s的运行效率也达到了2倍多的加速比, 这为实时预报系统提供了有效的保障.图13展示了swPOM v1.1相比v1.0版本的扩展性, 由于v1.1版本中引入了调整数组的过程, 3 840核相比160核下的加速比有所下降, 但绝对运行时间相比v1.0版有所提升.</p>
                </div>
                <div class="area_img" id="155">
                    <p class="img_tit"><b>表2 swPOM v1.1与swPOM v1.0性能对比</b> <a class="downexcel" onclick="DownLoadReportExcel(this)">导出到EXCEL</a></p>
                    <p class="img_tit"><b>Table 2 The Performance Comparison Between swPOM v1.1 and swPOM v1.0</b></p>
                    <p class="img_note"></p>
                    <table id="155" border="1"><tr><td rowspan="2"><br />Module</td><td colspan="2"><br />180 Master-slave<br />Cores swPOM v1.0</td><td colspan="2">180 Master-slave<br />Cores swPOM v1.1</td></tr><tr><td>Runtime/s</td><td>Runtime Ratio/%</td><td>Runtime/s</td><td>Runtime Ratio/%</td></tr><tr><td>advave</td><td><b>5.673</b></td><td><b> 12.568</b></td><td><b> 2.589</b></td><td><b> 11.157</b></td></tr><tr><td><br />vort</td><td><b>12.878</b></td><td><b>28.531</b></td><td><b>2.868</b></td><td><b>12.359</b></td></tr><tr><td><br />bcond</td><td><b>10.937</b></td><td><b>24.230</b></td><td><b>1.174</b></td><td><b>5.059</b></td></tr><tr><td><br />All</td><td>45.138</td><td>100</td><td>23.206</td><td>100</td></tr></table>
                    <form name="form" action="/kxreader/Detail/DownloadReportExcel" method="POST" style="display:inline">
                        <input type="hidden" name="hidTable" value="" />
                        <input type="hidden" name="hidFileName" value="" />
                    </form>
                    <p class="img_note"></p>
                    <p class="img_note">Note: The bold cells in the table represent the modules accelerated by thememory access optimization.</p>
                </div>
                <div class="area_img" id="156">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JFYZ201907020_156.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYzUnVBSW1mUVc1OGJzcUZ1WGdCaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图13 swPOM v1.1与 v1.0在纯主核上的强扩展性对比" src="Detail/GetImg?filename=images/JFYZ201907020_156.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYzUnVBSW1mUVc1OGJzcUZ1WGdCaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图13 swPOM v1.1与 v1.0在纯主核上的强扩展性对比  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JFYZ201907020_156.jpg&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYzUnVBSW1mUVc1OGJzcUZ1WGdCaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit">Fig. 13 The strong scalability comparison between swPOM v1.1 and swPOM v1.0</p>

                </div>
                <div class="p1">
                    <p id="157">主从异步数据交互方案的条件比较苛刻, 因此我们只在180核的基准测试实验下对uaf, pro, bcond模块采用了上述优化, 运行效率分别提升了20%, 95%和30%.其中pro模块95%的效率提升意味着该模块中计算与从核访存通信已经基本完全重叠, 相互隐藏.</p>
                </div>
                <h4 class="anchor-tag" id="158" name="158"><b>6.2 面向“神威</b>·<b>太湖之光”大规模并行优化方法的结果分析</b></h4>
                <div class="p1">
                    <p id="159">使用计算与通信重叠的优化方法后, 在180核规模下有43%的通信模块与计算重叠, 隐藏于计算过程中.而swPOM中还有些通信是一对多的求和收集、广播通知等, 无法与计算模块重叠, 因此通信模块达到1.8倍加速比已经比较理想.</p>
                </div>
                <div class="p1">
                    <p id="160">在I/O方面, 我们在swPOM v1.1的基础上, 仍然在180核的规模下进行I/O的测试, 一共模拟360步, 每60步进行一次I/O输出.接入CFIO库之后, 仍然采用同样的计算资源, 按照8:1的比例划分计算和I/O进程, 其中160核为计算进程, 20核为I/O进程.对应的结果如表3所示, 其中在正常的版本中, 非I/O占比为73.5%左右, 总时间为589 s.使用CFIO之后, 因为计算资源变少了, 所以计算的时间会增大, 但因为将I/O与计算进行了重叠, 所以总体时间只有497 s.由此可见异步I/O的方式能够提高高频率输出海洋模式的整体性能.</p>
                </div>
                <div class="area_img" id="161">
                    <p class="img_tit"><b>表3 正常I/O与CFIO对比</b> <a class="downexcel" onclick="DownLoadReportExcel(this)">导出到EXCEL</a></p>
                    <p class="img_tit"><b>Table 3 The Comparison Between Original I/O and CFIO</b></p>
                    <p class="img_note"></p>
                    <table id="161" border="1"><tr><td rowspan="2"><br />Module</td><td colspan="2"><br />180 Processes (I/O) </td><td colspan="2">180 Processes (CFIO) </td></tr><tr><td>Runtime/s</td><td>Runtime Ratio/%</td><td>Runtime/s</td><td>Runtime Ratio/%</td></tr><tr><td>Without I/O</td><td>433.282</td><td>73.537</td><td></td><td></td></tr><tr><td><br />I/O</td><td>155.921</td><td>26.463</td><td></td><td></td></tr><tr><td><br />All</td><td>589.203</td><td>100</td><td>497.216</td><td>100</td></tr></table>
                    <form name="form" action="/kxreader/Detail/DownloadReportExcel" method="POST" style="display:inline">
                        <input type="hidden" name="hidTable" value="" />
                        <input type="hidden" name="hidFileName" value="" />
                    </form>
                    <p class="img_note"></p>
                    <p class="img_note"></p>
                </div>
                <h4 class="anchor-tag" id="162" name="162"><b>6.3 与通用平台性能对比分析</b></h4>
                <div class="p1">
                    <p id="163">CESS是清华大学运行维护的一款通用x86计算平台, 由80台服务器组成;每台服务器包含有2个Intel处理器, 其中每个处理器的主频为2.1 GHz, 具有32 K L1 Cache, 256 K L2 Cache, 15369K L3 Cache.相比于“神威·太湖之光”, CESS具有更高的主核频率, 且具有L3 Cache.我们将最终版本swPOM与运行在CESS上的Original POM进行性能对比, 结果如表4所示:</p>
                </div>
                <div class="area_img" id="164">
                    <p class="img_tit"><b>表4 swPOM与Original POM (CESS) 性能对比</b> <a class="downexcel" onclick="DownLoadReportExcel(this)">导出到EXCEL</a></p>
                    <p class="img_tit"><b>Table 4 The Performance Comparison Between swPOM and Original POM (on CESS</b>) </p>
                    <p class="img_note"></p>
                    <table id="164" border="1"><tr><td rowspan="2"><br />Module</td><td colspan="2"><br />180 Cores CESS</td><td colspan="2">180 Master-slave<br />Cores swPOM</td></tr><tr><td><br />Runtime/s</td><td>Runtime Ratio/%</td><td>Runtime/s</td><td>Runtime Ratio/%</td></tr><tr><td>elf</td><td>4.303</td><td>7.839</td><td>1.443</td><td>7.609</td></tr><tr><td><br />uaf</td><td>4.532</td><td>8.256</td><td>1.518</td><td>8.004</td></tr><tr><td><br />vaf</td><td>6.530</td><td>11.897</td><td>2.230</td><td>11.759</td></tr><tr><td><br />pro</td><td>2.722</td><td>4.959</td><td>0.903</td><td>4.761</td></tr><tr><td><br />egf</td><td>3.131</td><td>5.704</td><td>1.120</td><td>5.906</td></tr><tr><td><br />advave</td><td>7.622</td><td>13.886</td><td>2.540</td><td>13.393</td></tr><tr><td><br />vort</td><td>8.471</td><td>15.433</td><td>2.817</td><td>14.854</td></tr><tr><td><br />bcond</td><td>2.426</td><td>4.419</td><td>0.934</td><td>4.925</td></tr><tr><td><br />comm</td><td>5.020</td><td>9.146</td><td>0.695</td><td>3.665</td></tr><tr><td><br />others</td><td>10.130</td><td>18.456</td><td>4.765</td><td>25.125</td></tr><tr><td><br />All</td><td>54.887</td><td>100</td><td>18.965</td><td>100</td></tr></table>
                    <form name="form" action="/kxreader/Detail/DownloadReportExcel" method="POST" style="display:inline">
                        <input type="hidden" name="hidTable" value="" />
                        <input type="hidden" name="hidFileName" value="" />
                    </form>
                    <p class="img_note"></p>
                    <p class="img_note"></p>
                </div>
                <div class="p1">
                    <p id="165">可以发现, 因为CESS的主核频率高且有L3 Cache, Original POM运行基准实验1只需要55 s.而“神威·太湖之光”的主核频率低, 且没有L3 Cache, 故Original POM在纯主核下运行基准实验1需要241 s.但经过上述一系列并行优化后, swPOM在众核并行下将运行基准实验1的时间缩短到了19 s内, 运行效率达到了纯主核的13倍, CESS通用Intel平台下的2.8倍以上, 将模拟时间整整缩短到原先的一半以下.这对于一些实时预报系统是强有力的保障, 为构建高分辨率海洋模式奠定了坚实的基础.</p>
                </div>
                <h3 id="166" name="166" class="anchor-tag"><b>7 结束语</b></h3>
                <div class="p1">
                    <p id="167">近年来发展高分辨率海洋模式已经成为必然趋势, 本文基于国产超级计算机“神威·太湖之光”, 利用其异构众核体系结构的优势对区域海洋模式POM进行移植并优化, 充分发挥了国产异构众核平台的特点和优势.不同于一些简单的科学计算, 只有唯一的热点函数, POM的热点模块很多而且耗时占比非常平均.swPOM基于POM各个模块的特点, 对其计算核心进行主从协同加速、数据访问优化、从核数据访问与计算重叠和计算通信异步屏蔽等, 将整体的模拟效率提升到传统超算平台的2.8倍以上, 同时能够扩展到25万核的规模.此外, swPOM还集成了高效的异步I/O库CFIO, 通过将资源合理分配成计算与I/O进程, 采用请求转发的方式将I/O过程与科学计算过程相互重叠.在相同资源下, 与180核同时进行计算与I/O的形式相比, 整体性能提升了约20%.</p>
                </div>
                <div class="p1">
                    <p id="168">在未来的研究工作中, 经过一系列优化之后原先占比很小的非热点模块成为了swPOM的主要热点, 这些模块后续还有继续优化的空间.此外我们在使用CFIO的时候, 通过对比实验选择了一个合适的计算与I/O的进程比, 而不同的分配比往往会影响程序的性能, 这一方面也有待进一步研究.</p>
                </div>

        <!--brief end-->
        
        <!--conten left  end-->
        <!--增强附件-->
                        <h3 class="anchor-tag">作者图片</h3>
                <div class="anchor-wrap">
                        <p>
                                    <div class="anchor-box">
                                        <span class="anchor-a"><image id="288" type="formula" href="images/JFYZ201907020_28800.jpg" display="inline" placement="inline"><alt></alt></image></span>
                                        <span class="anchor-a">吴琦</span>
                                    </div>
                                    <div class="anchor-box">
                                        <span class="anchor-a"><image id="289" type="formula" href="images/JFYZ201907020_28900.jpg" display="inline" placement="inline"><alt></alt></image></span>
                                        <span class="anchor-a">倪裕芳</span>
                                    </div>
                                    <div class="anchor-box">
                                        <span class="anchor-a"><image id="290" type="formula" href="images/JFYZ201907020_29000.jpg" display="inline" placement="inline"><alt></alt></image></span>
                                        <span class="anchor-a">黄小猛</span>
                                    </div>
                        </p>
                </div>


        <!--reference start-->
            <div class="reference anchor-tag" id="a_bibliography">
                    <h3>参考文献</h3>
                                        <p id="191">
                            <a id="bibliography_1" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Challenges and opportunities for improved understanding of regional climate dynamics">

                                <b>[1]</b>Collins M, Minobe S, Barreiro M, et al.Challenges and opportunities for improved understanding of regional climate dynamics[J].Nature Climate Change, 2018, 8 (2) :101- 108
                            </a>
                        </p>
                        <p id="193">
                            <a id="bibliography_2" target="_blank" href="/kcms/detail/detail.aspx?dbcode=SJRS&amp;filename=SJRS05C1D7BB988F2A0D423B95644A166167&amp;v=MjA1NjBSTHlZQ09OdkZTaVdXcjdKSUZwbWFCdUhZZk9HUWxmQ3BiUTM1TjFoeHJxK3dhND1OaWZaZmJPOWJkQzRxUDAzYmVNSGVuNUl6MklYNkR3UFFYcmtxQlpFZUxTUw==&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYzUnVBSW1mUVc1OGJzcUZ1WGdCaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[2]</b>Bonan G B, Doney S C.Climate, ecosystems, and planetary futures:The challenge to predict life in Earth system models[J].Science, 2018, 359 (6375) :533- 541
                            </a>
                        </p>
                        <p id="195">
                            <a id="bibliography_3" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Clouds,circulation and climate sensitivity">

                                <b>[3]</b>Bony S, Stevens B, Frierson D M W, et al.Clouds, circulation and climate sensitivity[J].Nature Geoscience, 2015, 8 (4) :261- 268
                            </a>
                        </p>
                        <p id="197">
                            <a id="bibliography_4" target="_blank" href="/kcms/detail/detail.aspx?dbcode=SJES&amp;filename=SJES14110700309199&amp;v=MDQyNDFCTVQ2VDRQUUgvaXJSZEdlcnFRVE1ud1plWnVIeWptVUxySUlsd1ZheFE9TmlmT2ZiSzhIOURNcUk5Rlorc0dEWFV3bw==&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYzUnVBSW1mUVc1OGJzcUZ1WGdCaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[4]</b>Marzocchi A, Hirschi J J M, Holliday N P, et al.The north Atlantic subpolar circulation in an eddy-resolving global ocean model[J].Journal of Marine Systems, 2015, 142:126- 143
                            </a>
                        </p>
                        <p id="199">
                            <a id="bibliography_5" target="_blank" href="http://scholar.cnki.net/result.aspx?q=The software architecture of climate models:A graphical comparison of CMIP5 and EMICAR5 configurations">

                                <b>[5]</b>Alexander K, Easterbrook S M.The software architecture of climate models:A graphical comparison of CMIP5 and EMICAR5 configurations[J].Geoscientific Model Develop-ment, 2015, 8 (4) :1221- 1232
                            </a>
                        </p>
                        <p id="201">
                            <a id="bibliography_6" target="_blank" href="/kcms/detail/detail.aspx?dbcode=SPQD&amp;filename=SPQD15030600006849&amp;v=MDgwMjF4UT1OajNhYXJLOUh0TE1xWTlGWk9zSkJIZ3dvQk1UNlQ0UFFIL2lyUmRHZXJxUVRNbndaZVp1SHlqbVVMcklJbHdWYQ==&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYzUnVBSW1mUVc1OGJzcUZ1WGdCaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[6]</b>Jia Liwei, Yang Xiaosong, Vecchi G A, et al.Improved seasonal prediction of temperature and precipitation over land in a high-resolution GFDL climate model[J].Journal of Climate, 2015, 28 (5) :2044- 2062
                            </a>
                        </p>
                        <p id="203">
                            <a id="bibliography_7" target="_blank" href="/kcms/detail/detail.aspx?dbcode=SPQD&amp;filename=SPQD15052100003349&amp;v=MDUyODVlWnVIeWptVUxySUlsd1ZheFE9TmozYWFySzlIdFRPcm85RlpPc01EM2d3b0JNVDZUNFBRSC9pclJkR2VycVFUTW53Wg==&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYzUnVBSW1mUVc1OGJzcUZ1WGdCaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[7]</b>Sérazin G, Penduff T, Grégorio S, et al.Intrinsic variability of sea level from global ocean simulations:Spatiotemporal scales[J].Journal of Climate, 2015, 28 (10) :4279- 4292
                            </a>
                        </p>
                        <p id="205">
                            <a id="bibliography_8" target="_blank" href="/kcms/detail/detail.aspx?dbcode=SPQD&amp;filename=SPQD60547C578BF6ED5E14E5F844DF50BB37&amp;v=MjQzOTZiSmw1Q2dsTnltTVM3a3A0UG5mbXFHWkRmTExtTjdtWUNPTnZGU2lXV3I3SklGcG1hQnVIWWZPR1FsZkNwYlEzNU4xaHhycSt3YTQ9TmozYWFyVzRHOVhMM0lwQw==&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYzUnVBSW1mUVc1OGJzcUZ1WGdCaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[8]</b>Rieck J K, Böning C W, Greatbatch R J, et al.Seasonal variability of eddy kinetic energy in a global high-resolution ocean model[J].Geophysical Research Letters, 2015, 42 (21) :9379- 9386
                            </a>
                        </p>
                        <p id="207">
                            <a id="bibliography_9" target="_blank" href="http://scholar.cnki.net/result.aspx?q=The global influence of localized dynamics in the Southern Ocean">

                                <b>[9]</b>Rintoul S R.The global influence of localized dynamics in the Southern Ocean[J].Nature, 2018, 558 (7709) :209- 218
                            </a>
                        </p>
                        <p id="209">
                            <a id="bibliography_10" target="_blank" href="/kcms/detail/detail.aspx?dbcode=SPQD&amp;filename=SPQD74982698A0732903814DF4420AF59AA0&amp;v=MDQ0MTQ0PU5qM2FhclM4RjluT3FZWk5GZXNJRDM0d3p4VWI2enNKUG52bXJoSkVEN2VkTk11ZkNPTnZGU2lXV3I3SklGcG1hQnVIWWZPR1FsZkNwYlEzNU4xaHhycSt3YQ==&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYzUnVBSW1mUVc1OGJzcUZ1WGdCaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[10]</b>Roberts M J, Hewitt H T, Hyder P, et al.Impact of ocean resolution on coupled air-sea fluxes and large-scale climate[J].Geophysical Research Letters, 2016, 43 (19) :10430- 10438
                            </a>
                        </p>
                        <p id="211">
                            <a id="bibliography_11" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Compact modeling framework v3.0 for high-resolution global ocean-ice-atmosphere models">

                                <b>[11]</b>Kalmykov V V, Ibrayev R A, Kaurkin M N, et al.Compact modeling framework v3.0 for high-resolution global ocean-ice-atmosphere models[J].Geoscientific Model Develop-ment, 2018, 11 (10) :3983- 3997
                            </a>
                        </p>
                        <p id="213">
                            <a id="bibliography_12" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Scale interactions on diurnal toseasonal timescales and their relevanceto model systematic errors">

                                <b>[12]</b>Slingo J, Inness P, Neale R, et al.Scale interactions on diurnal toseasonal timescales and their relevanceto model systematic errors[J].Annals of Geophysics, 2003, 46 (1) :139- 155
                            </a>
                        </p>
                        <p id="215">
                            <a id="bibliography_13" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JSJK201311002&amp;v=MjA2NDhIOUxOcm85RlpvUUtESDg0dlI0VDZqNTRPM3pxcUJ0R0ZyQ1VSTE9lWmVSckZ5cm5VcjdPTHo3QlpiRzQ=&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYzUnVBSW1mUVc1OGJzcUZ1WGdCaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[13]</b>Chi Xuebin, Gu Beibei, Wu Hong, et al.The analysis of development on high performance computer system and platform[J].Computer Engineering &amp; Science, 2013, 35 (11) :6- 13 (in Chinese) (迟学斌, 顾蓓蓓, 武虹, 等.高性能计算机系统及平台发展状况分析[J].计算机工程与科学, 2013, 35 (11) :6- 13) 
                            </a>
                        </p>
                        <p id="217">
                            <a id="bibliography_14" target="_blank" href="http://scholar.cnki.net/result.aspx?q=GPU acceleration of numerical weather prediction">

                                <b>[14]</b>Michalakes J, Vachharajani M.GPU acceleration of numerical weather prediction[J].Parallel Processing Letters, 2008, 18 (4) :531- 548
                            </a>
                        </p>
                        <p id="219">
                            <a id="bibliography_15" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JYRJ201010011&amp;v=MTI3NjdlWmVSckZ5cm5VcjdPTHpUWlpMRzRIOUhOcjQ5RVpZUUtESDg0dlI0VDZqNTRPM3pxcUJ0R0ZyQ1VSTE8=&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYzUnVBSW1mUVc1OGJzcUZ1WGdCaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[15]</b>Song Zhenya, Liu Haixing, Lei Xiaoyan, et al.The application of GPU in ocean general circulation mode POP[J].Computer Applications and Software, 2010, 27 (10) :27- 29
                            </a>
                        </p>
                        <p id="221">
                            <a id="bibliography_16" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JFXG201607011&amp;v=MDQ2ODBMeXZUYWJHNEg5Zk1xSTlFWllRS0RIODR2UjRUNmo1NE8zenFxQnRHRnJDVVJMT2VaZVJyRnlyblVyN08=&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYzUnVBSW1mUVc1OGJzcUZ1WGdCaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[16]</b>Fu Haohuan, Liao Junfeng, Yang Jinzhe, et al.The Sunway TaihuLight supercomputer:System and applications[J].Science China Information Sciences, 2016, 59 (7) :072001:1- 072001:16
                            </a>
                        </p>
                        <p id="223">
                            <a id="bibliography_17" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Users guide for a three-dimensional, primitive equation, numerical ocean model">

                                <b>[17]</b>Mellor G L.Users Guide for a Three Dimensional, Primitive Equation, Numerical Ocean Model[M].Princeton, NJ:Program in Atmospheric and Oceanic Sciences, Princeton University, 1998
                            </a>
                        </p>
                        <p id="225">
                            <a id="bibliography_18" target="_blank" href="/kcms/detail/detail.aspx?dbcode=SJES&amp;filename=SJES13011300526805&amp;v=MzIxNDVlWnVIeWptVUxySUlsd1ZheFE9TmlmT2ZiSzdIdEROckk5Rllla0pCSHc4b0JNVDZUNFBRSC9pclJkR2VycVFUTW53Wg==&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYzUnVBSW1mUVc1OGJzcUZ1WGdCaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[18]</b>Griffies S M, Böning C, Bryan F O, et al.Developments in ocean climate modelling[J].Ocean Modelling, 2000, 2 (3-4) :123- 192
                            </a>
                        </p>
                        <p id="227">
                            <a id="bibliography_19" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Elements of the modular ocean model (MOM) [OL]">

                                <b>[19]</b>Griffies S M.Elements of the modular ocean model (MOM) [OL].2012[2019-02-10].https://mom-ocean.github.io/assets/pdfs/MOM5_manual.pdf
                            </a>
                        </p>
                        <p id="229">
                            <a id="bibliography_20" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Parallel ocean general circulation modeling">

                                <b>[20]</b>Smith R D, Dukowicz J K, Malone R C.Parallel ocean general circulation modeling[J].Physica D:Nonlinear Phenomena, 1992, 60 (1/2/3/4) :38- 61
                            </a>
                        </p>
                        <p id="231">
                            <a id="bibliography_21" target="_blank" href="/kcms/detail/detail.aspx?dbcode=SJES&amp;filename=SJES13011300526688&amp;v=MDMwOThkR2VycVFUTW53WmVadUh5am1VTHJJSWx3VmF4UT1OaWZPZmJLN0h0RE5ySTlGWWVrSkNuUXhvQk1UNlQ0UFFIL2lyUg==&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYzUnVBSW1mUVc1OGJzcUZ1WGdCaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[21]</b>Shchepetkin A F, McWilliams J C.The regional oceanic modeling system (ROMS) :A split-explicit, free-surface, topography-following-coordinate oceanic model[J].Ocean Modelling, 2005, 9 (4) :347- 404
                            </a>
                        </p>
                        <p id="233">
                            <a id="bibliography_22" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Geophysical fluid modeling with the MPI version of the Princeton ocean model (mpiPOM) [OL]">

                                <b>[22]</b>Oey L Y.Geophysical fluid modeling with the MPI version of the Princeton ocean model (mpiPOM) [OL].2014[2018-11-01].ftp://profs.princeton.edu/leo/lecture-notes/OceanAtmosModeling/Notes/GFModellingUsingMpiPOM.pdf
                            </a>
                        </p>
                        <p id="235">
                            <a id="bibliography_23" target="_blank" href="http://scholar.cnki.net/result.aspx?q=POM.gpu-v1.0:A GPU-based princeton ocean model">

                                <b>[23]</b>Xu Shizhen, Huang Xiaomeng, Oey L Y, et al.POM.gpu-v1.0:A GPU-based Princeton ocean model[J].Geoscientific Model Development, 2015, 8 (9) :2815- 2827
                            </a>
                        </p>
                        <p id="237">
                            <a id="bibliography_24" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Numerical study of the mediterranean Sea circulation">

                                <b>[24]</b>Zavatarielli M, Mellor G L.A numerical study of the Mediterranean sea circulation[J].Journal of Physical Oceanography, 1995, 25 (6) :1384- 1414
                            </a>
                        </p>
                        <p id="239">
                            <a id="bibliography_25" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Improvements in the GFDL hurricane prediction system">

                                <b>[25]</b>Kurihara Y, Bender M A, Tuleya R E, et al.Improvements in the GFDL hurricane prediction system[J].Monthly Weather Review, 1995, 123 (9) :2791- 2801
                            </a>
                        </p>
                        <p id="241">
                            <a id="bibliography_26" target="_blank" href="http://scholar.cnki.net/result.aspx?q=GFDL Hurricane Prediction System and its performance in the 1995 hurricane season">

                                <b>[26]</b>Kurihara Y, Tuleya R E, Bender M A.The GFDL hurricane prediction system and its performance in the 1995 hurricane season[J].Monthly Weather Review, 1998, 126 (5) :1306- 1322
                            </a>
                        </p>
                        <p id="243">
                            <a id="bibliography_27" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Hurricane weather research and forecasting (HWRF) model:2011 scientific documentation[OL]">

                                <b>[27]</b>Gopalakrishnan S, Liu Qingfu, Marchok T, et al.Hurricane weather research and forecasting (HWRF) model:2011 scientific documentation[OL].2011[2018-11-01].https://dtcenter.org/HurrWRF/users/docs/scientific_documents/HWRFScientificDocumentation_August2011.pdf
                            </a>
                        </p>
                        <p id="245">
                            <a id="bibliography_28" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Hurricane Weather Research and Forecasting (HWRF)Model">

                                <b>[28]</b>Tallapragada V, Bernardet L, Gopalakrishnan S, et al.Hurricane weather research and forecasting (HWRF) model:2015 scientific documentation[OL].2015[2018-11-01].https://dtcenter.org/HurrWRF/users/docs/scientific_documents/HWRF_v3.7a_SD.pdfs
                            </a>
                        </p>
                        <p id="247">
                            <a id="bibliography_29" target="_blank" href="http://scholar.cnki.net/result.aspx?q=ATOP-The advanced Taiwan ocean prediction system based on the mpiPOM.Part 1:Model descriptions,analyses and results">

                                <b>[29]</b>Oey L, Chang Yulin, Lin Yuchun, et al.ATOP-The advanced Taiwan ocean prediction system based on the mpiPOM.Part 1:Model descriptions, analyses and results[J].Terrestrial, Atmospheric &amp; Oceanic Sciences, 2013, 24 (1) :137- 158
                            </a>
                        </p>
                        <p id="249">
                            <a id="bibliography_30" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Computational design of the basic dynamical processes of the UCLA general circulation model">

                                <b>[30]</b>Arakawa A, Lamb V R.Computational design of the basic dynamical processes of the UCLA general circulation model[J].General Circulation Models of The Atmosphere, 1977, 17:173- 265
                            </a>
                        </p>
                        <p id="251">
                            <a id="bibliography_31" target="_blank" href="/kcms/detail/detail.aspx?dbcode=SJCO&amp;filename=SJCO14011600000015&amp;v=MTk4NDlsd1ZheFE9TmlmSVliSzhIdEROcVk5RlpPc1BESDA4b0JNVDZUNFBRSC9pclJkR2VycVFUTW53WmVadUh5am1VTHJJSQ==&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYzUnVBSW1mUVc1OGJzcUZ1WGdCaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[31]</b>Huang Xiaomeng, Wang Wencan, Fu Haohuan, et al.A fast input/output library for high-resolution climate models[J].Geoscientific Model Development, 2014, 7 (1) :93- 103
                            </a>
                        </p>
            </div>
        <!--reference end-->
        <!--footnote start-->
        <!--footnote end-->



    </div>

        <input id="fileid" type="hidden" value="JFYZ201907020" />
        <input id="dpi" type="hidden" value="300" />
    </div>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?6e967eb120601ea41b9d312166416aa6";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
</script>


    


<input id="hid_uid" name="hid_uid" type="hidden" value="WEEvREcwSlJHSldRa1FhdkJkVG5hVDYzUnVBSW1mUVc1OGJzcUZ1WGdCaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
<input id="hid_kLogin_headerUrl" name="hid_kLogin_headerUrl" type="hidden" value="/KLogin/Request/GetKHeader.ashx%3Fcallback%3D%3F" />
<input id="hid_kLogin_footerUrl" name="hid_kLogin_footerUrl" type="hidden" value="/KLogin/Request/GetKFooter.ashx%3Fcallback%3D%3F" />
<div class="btn-link" style="display: none"><a target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JFYZ201907020&amp;v=MTM3MDBESDg0dlI0VDZqNTRPM3pxcUJ0R0ZyQ1VSTE9lWmVSckZ5cm5VcjdPTHl2U2RMRzRIOWpNcUk5SFpJUUs=&amp;uid=WEEvREcwSlJHSldRa1FhdkJkVG5hVDYzUnVBSW1mUVc1OGJzcUZ1WGdCaz0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">知网节</a></div>
<div class="popflow" id="popupTips" style="display: none;">
    <div class="popflowArr"></div>
    <div class="popflowCot">
        <div class="hd"><a href="javascript:void(0);" onclick="$('#popupTips').hide();$('#popupmsg').html('')" class="close">X</a></div>
        <div class="bd">
            <p class="mes" id="popupmsg" name="popupmsg"></p>
          
        </div>
    </div>
</div>
<input type="hidden" id="myexport" value="//kns.cnki.net" />

<input type="hidden" id="KPCAPIPATH" value="//ishufang.cnki.net" />
<input type="hidden" id="CitedTimes" value="" />
<div class="link" id="GLSearch" style="display: none;">
    <i class="icon-trangle"></i>
    <div class="inner">
        <a class="icon" id="copytext">复制</a>
        <a class="icon" target="_blank" onclick="searchCRFD(this)">工具书搜索</a>
    </div>
</div>




<input id="hidVirtualPath" name="hidVirtualPath" type="hidden" value="/kxreader" />
<script src="/kxreader/bundles/detail?v=-ULdk-c6FkZHtJA2KAXPgHnyA8mtgyPnBde_C2VZ2BY1"></script>

<script src="/kxreader/Scripts/layer.min.js" type="text/javascript"></script>

<div id="footerBox" class="rootw footer">
</div>
<script>
    if (typeof FlushLogin == 'function') {
        FlushLogin();
    }
    modifyEcpHeader(true);
</script>

<!--图片放大功能 start-->
<script src="/kxreader/bundles/imagebox?v=W4phPu9SNkGcuPeJclikuVE3PpRyIW_gnfjm_19nynI1"></script>

<script type="text/javascript">
    $(function () {
        var j = $.noConflict();
        j(function () {
            j(".zoom-in,.btn-zoomin").imgbox({
                'alignment': 'center',
                'allowMultiple': false,
                'overlayShow': true
            });
        })
    });
</script>
<!--图片放大功能 end-->
<div class="fixedbar">
    <div class="backtop hiddenV" id="backtop">
        <a id="backTopSide" href="javascript:scroll(0,0);" title=""></a>
    </div>
</div>
<script type="text/javascript" src="/kxreader/Scripts/MathJax-2.6-latest/MathJax.js?config=MML_HTMLorMML-full"></script>


    <link href="/kxreader/Content/css/LeftDetail?v=NLcKG8I1SJUaVFrQ0iGpF2klAT0OsmHRaVSZ1rKb5xg1" rel="stylesheet"/>

</body>
</html>

