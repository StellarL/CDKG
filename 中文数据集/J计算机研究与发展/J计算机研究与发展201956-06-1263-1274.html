

<!DOCTYPE html>
<html>
<head>
    <title>全文阅读--XML全文阅读--中国知网</title>
    <link rel="icon" href="/kxreader/favicon.ico" />
    <link rel="shortcut Icon" href="/kxreader/favicon.ico" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="keywords" content="文献 XML KBASE CNKI 中国知网" />
    <meta name="description" content="XML文献检索" />
    <script type="text/javascript">
        var APPPATH = '/kxreader';
    </script>

</head>

<body>

    
<script type="text/javascript" src="//login.cnki.net/TopLogin/api/loginapi/get?type=top&amp;localCSS=&amp;returnurl=%2f%2fkns.cnki.net%2f%2fKXReader%2fDetail%3fTIMESTAMP%3d637128630371525000%26DBCODE%3dCJFD%26TABLEName%3dCJFDLAST2019%26FileName%3dJFYZ201906014%26RESULT%3d1%26SIGN%3daoqXrOFs7mdjguhNIWxixA6nZl8%253d"></script>

<div id="headerBox" class="header">
    <div class="topbar">
        <div class="textalign">
            <a href="/kxreader/Detail?dbcode=CJFD&amp;filename=JFYZ201906014&amp;align=md">
                <i class="icon-cen active" title="居中对齐"></i>
            </a>
            <a href="/kxreader/Detail?dbcode=CJFD&amp;filename=JFYZ201906014&amp;align=lt">
                <i class="icon-left " title="左对齐"></i>
            </a>
        </div>
        <h6 class="free-tip"><i class="icon"></i>HTML阅读开放试用阶段，欢迎体验！</h6>
    </div>
</div>


    



<div class="btn-link" style="display: none"><a target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JFYZ201906014&amp;v=MTgyMzlPTHl2U2RMRzRIOWpNcVk5RVlJUUtESDg0dlI0VDZqNTRPM3pxcUJ0R0ZyQ1VSTE9lWmVScUZpRG5VcjM=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4vMkp4azg1TUxGcERuK01CZG1GRT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">知网节</a></div>

    <div class="main">

        

    <div class="sidebar-a">
        <!--sidebar start-->
        <div class="sidenav">
            <div class="arrow"><span></span></div>
            <!--sidebar_list start-->
            <dl class="sidenav-list">
                    <dt class="tit">目录结构</dt>
                            <dd class="guide">
                                    <p><a href="#75" data-title="&lt;b&gt;1 相关工作&lt;/b&gt; "><b>1 相关工作</b></a><i></i></p>
                                                            </dd>
                            <dd class="guide">
                                    <p><a href="#80" data-title="&lt;b&gt;2 CoDetector检测模型&lt;/b&gt; "><b>2 CoDetector检测模型</b></a><i></i></p>
                                                                    <ul class="contentbox">
                                                <li><a href="#87" data-title="&lt;b&gt;2.1 时空伴随域名序列提取&lt;/b&gt;"><b>2.1 时空伴随域名序列提取</b></a></li>
                                                <li><a href="#113" data-title="&lt;b&gt;2.2 特征学习&lt;/b&gt;"><b>2.2 特征学习</b></a></li>
                                                <li><a href="#133" data-title="&lt;b&gt;2.3 恶意域名检测模块&lt;/b&gt;"><b>2.3 恶意域名检测模块</b></a></li>
                                                <li><a href="#139" data-title="&lt;b&gt;2.4 模型时间复杂度分析&lt;/b&gt;"><b>2.4 模型时间复杂度分析</b></a></li>
                                    </ul>
                            </dd>
                            <dd class="guide">
                                    <p><a href="#149" data-title="&lt;b&gt;3 实  验&lt;/b&gt; "><b>3 实  验</b></a><i></i></p>
                                                                    <ul class="contentbox">
                                                <li><a href="#150" data-title="&lt;b&gt;3.1 数据集&lt;/b&gt;"><b>3.1 数据集</b></a></li>
                                                <li><a href="#155" data-title="&lt;b&gt;3.2 评价指标&lt;/b&gt;"><b>3.2 评价指标</b></a></li>
                                                <li><a href="#161" data-title="&lt;b&gt;3.3 域名伴随关系分析&lt;/b&gt;"><b>3.3 域名伴随关系分析</b></a></li>
                                                <li><a href="#167" data-title="&lt;b&gt;3.4 模型假设验证&lt;/b&gt;"><b>3.4 模型假设验证</b></a></li>
                                                <li><a href="#177" data-title="&lt;b&gt;3.5 模型检测效果&lt;/b&gt;"><b>3.5 模型检测效果</b></a></li>
                                    </ul>
                            </dd>
                            <dd class="guide">
                                    <p><a href="#185" data-title="&lt;b&gt;4 讨  论&lt;/b&gt; "><b>4 讨  论</b></a><i></i></p>
                                                            </dd>
                            <dd class="guide">
                                    <p><a href="#190" data-title="&lt;b&gt;5 结  论&lt;/b&gt; "><b>5 结  论</b></a><i></i></p>
                                                            </dd>
                            <dd class="guide">
                                    <p><a href="#" data-title="文内图表 ">文内图表</a><i></i></p>
                                                                    <ul class="contentbox">
                                                <li><a href="#77" data-title="图1 CoDetector模型工作流程图">图1 CoDetector模型工作流程图</a></li>
                                                <li><a href="#90" data-title="图2 10 min内部分DNS数据请求散点图">图2 10 min内部分DNS数据请求散点图</a></li>
                                                <li><a href="#112" data-title="图3 时空伴随域名序列生成说明图">图3 时空伴随域名序列生成说明图</a></li>
                                                <li><a href="#123" data-title="图4 基于滑动窗口 (&lt;i&gt;w&lt;/i&gt;=2) 的时空相似域名对生成示意图">图4 基于滑动窗口 (<i>w</i>=2) 的时空相似域名对生成示意图</a></li>
                                                <li><a href="#154" data-title="&lt;b&gt;表1 实验数据描述&lt;/b&gt;"><b>表1 实验数据描述</b></a></li>
                                                <li><a href="#164" data-title="&lt;b&gt;表2 不同参数下的香农熵统计结果&lt;/b&gt;"><b>表2 不同参数下的香农熵统计结果</b></a></li>
                                                <li><a href="#172" data-title="图5 伴随域名序列中恶意属性同态比例">图5 伴随域名序列中恶意属性同态比例</a></li>
                                                <li><a href="#175" data-title="图6 伴随域名对中恶意属性同态比例">图6 伴随域名对中恶意属性同态比例</a></li>
                                                <li><a href="#184" data-title="&lt;b&gt;表3 27组参数下CoDetector基于3种分类器算法10-fold 交叉验证的检测效果&lt;/b&gt;"><b>表3 27组参数下CoDetector基于3种分类器算法10-fold 交叉验证的检测效果</b></a></li>
                                    </ul>
                            </dd>
                                    <dd class="guide">
                                        <h6>
                                            <p><a href="#a_bibliography">参考文献</a> </p>
                                        </h6>
                                    </dd>

            </dl>
        </div>
        <!--sidebar end-->
        &nbsp;
        <!--此处有一空格符 勿删-->
    </div>

                <div class="sidebar-b three-collumn" style="width:0;">
            <div class="refer" style="width: 0;">
                <div class="arrow off" title="参考文献"><span></span></div>
                <div class="js-scrollbox" >
                    
                    <div class="subbox active">
                        <h4>
                            <span class="tit">参考文献</span>
                            <a class="close" href="javascript:void(0)">x</a>
                        </h4>
                        <div class="side-scroller">
                            <ul class="refer-list">
                                <li id="221">


                                    <a id="bibliography_1" title="Plohmann D, Yakdan K, Klatt M, et al.A comprehensive measurement study of domain generating malware[C]Proc of USENIX Security Symp.Berkeley, CA:USENIXAssociation, 2016:263-278" target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=A comprehensive measurement study of domain generating malware">
                                        <b>[1]</b>
                                        Plohmann D, Yakdan K, Klatt M, et al.A comprehensive measurement study of domain generating malware[C]Proc of USENIX Security Symp.Berkeley, CA:USENIXAssociation, 2016:263-278
                                    </a>
                                </li>
                                <li id="223">


                                    <a id="bibliography_2" title="Antonakakis M, Perdisci R, Nadji Y, et al.From throwaway traffic to bots:Detecting the rise of DGA-based malware[C]Proc of the 21st USENIX Security Symp.Berkeley, CA:USENIX Association, 2012:491-506" target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=From throwaway traffic to bots:Detecting the rise of DGA-based malware">
                                        <b>[2]</b>
                                        Antonakakis M, Perdisci R, Nadji Y, et al.From throwaway traffic to bots:Detecting the rise of DGA-based malware[C]Proc of the 21st USENIX Security Symp.Berkeley, CA:USENIX Association, 2012:491-506
                                    </a>
                                </li>
                                <li id="225">


                                    <a id="bibliography_3" title="Szurdi J, Kocso B, Cseh G, et al.The long“taile”of typosquatting domain names[C]Proc of the 23rd USENIXSecurity Symp.Berkeley, CA:USENIX Association, 2014:191-206" target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=The long&amp;quot;taile&amp;quot;of typosquatting domain names">
                                        <b>[3]</b>
                                        Szurdi J, Kocso B, Cseh G, et al.The long“taile”of typosquatting domain names[C]Proc of the 23rd USENIXSecurity Symp.Berkeley, CA:USENIX Association, 2014:191-206
                                    </a>
                                </li>
                                <li id="227">


                                    <a id="bibliography_4" title="Cisco.Cisco 2016 annual security report[R/OL].2016[2018-06-28].http:www.cisco.com/c/m/en_us/offers/sc04/2016-annual-security-report/index.html" target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Cisco 2016 annual security report[R/OL]">
                                        <b>[4]</b>
                                        Cisco.Cisco 2016 annual security report[R/OL].2016[2018-06-28].http:www.cisco.com/c/m/en_us/offers/sc04/2016-annual-security-report/index.html
                                    </a>
                                </li>
                                <li id="229">


                                    <a id="bibliography_5" title="Antonakakis M, Perdisci R, Dagon D, et al.Building a dynamic reputation system for DNS[C]Proc of the 19th USENIX Security Symp.Berkeley, CA:USENIXAssociation, 2010:273-290" target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Building a dynamic reputation system for DNS">
                                        <b>[5]</b>
                                        Antonakakis M, Perdisci R, Dagon D, et al.Building a dynamic reputation system for DNS[C]Proc of the 19th USENIX Security Symp.Berkeley, CA:USENIXAssociation, 2010:273-290
                                    </a>
                                </li>
                                <li id="231">


                                    <a id="bibliography_6" title="Bilge L, Sen S, Balzarotti D, et al.Exposure:A passive DNS analysis service to detect and report malicious domains[J].ACM Transactions on Information and System Security, 2014, 16 (4) :14" target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=SJCM&amp;filename=SJCM14061800001271&amp;v=MDk2ODQ2VDRQUUgvaXJSZEdlcnFRVE1ud1plWnVIeWptVUx2SktGd1ZhQlE9TmlmSVk3SzhIdGZOcDQ5RlpPc09EbnM0b0JNVA==&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4vMkp4azg1TUxGcERuK01CZG1GRT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[6]</b>
                                        Bilge L, Sen S, Balzarotti D, et al.Exposure:A passive DNS analysis service to detect and report malicious domains[J].ACM Transactions on Information and System Security, 2014, 16 (4) :14
                                    </a>
                                </li>
                                <li id="233">


                                    <a id="bibliography_7" title="Antonakakis M, Perdisci R, Lee W, et al.Detecting malware domains at the upper DNS hierarchy[C]Proc of the 20th USENIX Security Symp.Berkeley, CA:USENIXAssociation, 2011 (11) :1-16" target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Detecting Malware Domains at the U pper DNS Hierarchy">
                                        <b>[7]</b>
                                        Antonakakis M, Perdisci R, Lee W, et al.Detecting malware domains at the upper DNS hierarchy[C]Proc of the 20th USENIX Security Symp.Berkeley, CA:USENIXAssociation, 2011 (11) :1-16
                                    </a>
                                </li>
                                <li id="235">


                                    <a id="bibliography_8" title="Mikolov T, Sutskever I, Chen Kai, et al.Distributed representations of words and phrases and their compositionality[C]Proc of Advances in Neural Information Processing Systems.Cambridge, MA:MIT Press, 2013:3111-3119" target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Distributed representations of words and phrases and their compositionality">
                                        <b>[8]</b>
                                        Mikolov T, Sutskever I, Chen Kai, et al.Distributed representations of words and phrases and their compositionality[C]Proc of Advances in Neural Information Processing Systems.Cambridge, MA:MIT Press, 2013:3111-3119
                                    </a>
                                </li>
                                <li id="237">


                                    <a id="bibliography_9" title="Bojanowski P, Grave E, Joulin A, et al.Enriching word vectors with subword information[J].arXiv preprint arXiv:1607.04606, 2016" target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Enriching word vectors with subword information">
                                        <b>[9]</b>
                                        Bojanowski P, Grave E, Joulin A, et al.Enriching word vectors with subword information[J].arXiv preprint arXiv:1607.04606, 2016
                                    </a>
                                </li>
                                <li id="239">


                                    <a id="bibliography_10" title="Khalil I, Yu Ting, Guan Bei.Discovering malicious domains through passive DNS data graph analysis[C]Proc of the11th ACM on Asia Conf on Computer and Communications Security.New York:ACM, 2016:663-674" target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Discovering malicious domains through passive DNS data graph analysis">
                                        <b>[10]</b>
                                        Khalil I, Yu Ting, Guan Bei.Discovering malicious domains through passive DNS data graph analysis[C]Proc of the11th ACM on Asia Conf on Computer and Communications Security.New York:ACM, 2016:663-674
                                    </a>
                                </li>
                                <li id="241">


                                    <a id="bibliography_11" title="Peng Chengwei, Yun Xiaochun, Zhang Yongzheng, et al.Discovering malicious domains through alias-canonical graph[C]Proc of the 16th IEEE Int Conf on Trust, Security and Privacy in Computing and Communications.Piscataway, NJ:IEEE, 2017:225-232" target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Discovering malicious domains through alias-canonical graph">
                                        <b>[11]</b>
                                        Peng Chengwei, Yun Xiaochun, Zhang Yongzheng, et al.Discovering malicious domains through alias-canonical graph[C]Proc of the 16th IEEE Int Conf on Trust, Security and Privacy in Computing and Communications.Piscataway, NJ:IEEE, 2017:225-232
                                    </a>
                                </li>
                                <li id="243">


                                    <a id="bibliography_12" title="Manadhata P K, Yadav S, Rao P, et al.Detecting malicious domains via graph inference[G]LNCS 8712:Proc of European Symp on Research in Computer Security.Berlin:Springer, 2014:1-18" target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Detecting malicious domains via graph inference">
                                        <b>[12]</b>
                                        Manadhata P K, Yadav S, Rao P, et al.Detecting malicious domains via graph inference[G]LNCS 8712:Proc of European Symp on Research in Computer Security.Berlin:Springer, 2014:1-18
                                    </a>
                                </li>
                                <li id="245">


                                    <a id="bibliography_13" title="Rahbarinia B, Perdisci R, Antonakakis M.Segugio:Efficient behavior-based tracking of malware-control domains in large ISP networks[C]Proc of the 45th Annual IEEE/IFIP Int Conf on Dependable Systems and Networks (DSN) .Piscataway, NJ:IEEE, 2015:403-414" target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Segugio:Efficient behavior-based tracking of malware-control domains in large ISP networks">
                                        <b>[13]</b>
                                        Rahbarinia B, Perdisci R, Antonakakis M.Segugio:Efficient behavior-based tracking of malware-control domains in large ISP networks[C]Proc of the 45th Annual IEEE/IFIP Int Conf on Dependable Systems and Networks (DSN) .Piscataway, NJ:IEEE, 2015:403-414
                                    </a>
                                </li>
                                <li id="247">


                                    <a id="bibliography_14" title="Wang Xiaoqi, Li Qiang, Yan Guanghua, et al.Detection of covert and suspicious DNS behavior in advanced persistent threats[J].Journal of Computer Research and Development, 2017, 54 (10) :2334-2343 (in Chinese) (王晓琪, 李强, 闫广华, 等.高级持续性威胁中的隐蔽可以DNS行为的检测[J].计算机研究与发展, 2017, 54 (10) :2334-2343) " target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JFYZ201710020&amp;v=MjA2NjR2UjRUNmo1NE8zenFxQnRHRnJDVVJMT2VaZVJxRmlEblVyM09MeXZTZExHNEg5Yk5yNDlIWklRS0RIODQ=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4vMkp4azg1TUxGcERuK01CZG1GRT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[14]</b>
                                        Wang Xiaoqi, Li Qiang, Yan Guanghua, et al.Detection of covert and suspicious DNS behavior in advanced persistent threats[J].Journal of Computer Research and Development, 2017, 54 (10) :2334-2343 (in Chinese) (王晓琪, 李强, 闫广华, 等.高级持续性威胁中的隐蔽可以DNS行为的检测[J].计算机研究与发展, 2017, 54 (10) :2334-2343) 
                                    </a>
                                </li>
                                <li id="249">


                                    <a id="bibliography_15" title="Gao Hongyu, Yegneswaran V, Jiang Jian, et al.Reexamining DNS from a global recursive resolver perspective[J].IEEE/ACM Transactions on Networking, 2016, 24 (1) :43-57" target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=SJCM&amp;filename=SJCM6FFEF32754D1D1E946B4CF60B8517702&amp;v=MDM3OTA5N0RRZzR1aDhYN0UxNU93bmtyR0E5ZkxPVFFycWRDT052RlNpV1dyN0pJRnBtYUJ1SFlmT0dRbGZDcGJRMzVOeGd6THErd3E0PU5pZklZN1hPYUtTNnJJMUNZZQ==&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4vMkp4azg1TUxGcERuK01CZG1GRT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[15]</b>
                                        Gao Hongyu, Yegneswaran V, Jiang Jian, et al.Reexamining DNS from a global recursive resolver perspective[J].IEEE/ACM Transactions on Networking, 2016, 24 (1) :43-57
                                    </a>
                                </li>
                                <li id="251">


                                    <a id="bibliography_16" title="Kiefer J, Wolfowitz J.Stochastic estimation of the maximum of a regression function[J].The Annals of Mathematical Statistics, 1952, 23 (3) :462-466" target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=SJST&amp;filename=SJST14112600631510&amp;v=MDgyNTAwNW9CTVQ2VDRQUUgvaXJSZEdlcnFRVE1ud1plWnVIeWptVUx2SktGd1ZhQlE9TmlmWWVySzhIOURPcVk5Rll1Z09DWA==&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4vMkp4azg1TUxGcERuK01CZG1GRT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[16]</b>
                                        Kiefer J, Wolfowitz J.Stochastic estimation of the maximum of a regression function[J].The Annals of Mathematical Statistics, 1952, 23 (3) :462-466
                                    </a>
                                </li>
                                <li id="253">


                                    <a id="bibliography_17" title="DNS-BH.Malware domain blocklist by risk-analytics[EB/OL].[2017-01-03].http:www.malwaredomains.com" target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Malware domain blocklist by risk-analytics">
                                        <b>[17]</b>
                                        DNS-BH.Malware domain blocklist by risk-analytics[EB/OL].[2017-01-03].http:www.malwaredomains.com
                                    </a>
                                </li>
                                <li id="255">


                                    <a id="bibliography_18" title="OpenDNS.Phishtank[EB/OL].[2017-01-03].http:www.phishtank.com" target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Phishtank">
                                        <b>[18]</b>
                                        OpenDNS.Phishtank[EB/OL].[2017-01-03].http:www.phishtank.com
                                    </a>
                                </li>
                                <li id="257">


                                    <a id="bibliography_19" title="OpenPhish.Timely, accurate, relevant threat intelligence[EB/OL].[2017-01-03].https:openphish.com" target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Timely,accurate,relevant threat intelligence">
                                        <b>[19]</b>
                                        OpenPhish.Timely, accurate, relevant threat intelligence[EB/OL].[2017-01-03].https:openphish.com
                                    </a>
                                </li>
                                <li id="259">


                                    <a id="bibliography_20" title="AbuseList.Ransomware tracker[EB/OL].[2017-01-03].https:ransomwaretracker.abuse.ch" target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Ransomware tracker">
                                        <b>[20]</b>
                                        AbuseList.Ransomware tracker[EB/OL].[2017-01-03].https:ransomwaretracker.abuse.ch
                                    </a>
                                </li>
                                <li id="261">


                                    <a id="bibliography_21" title="Porras P A, Sa6di H, Yegneswaran V.A foray into conficker&#39;s logic and rendezvous points[EB/OL].[2017-01-03].https:www.usenix.org/legacy/event/leet09/tech/full_papers/porras/porras_html/" target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=A foray into conficker&amp;#39;&amp;#39;s logic and rendezvous points">
                                        <b>[21]</b>
                                        Porras P A, Sa6di H, Yegneswaran V.A foray into conficker&#39;s logic and rendezvous points[EB/OL].[2017-01-03].https:www.usenix.org/legacy/event/leet09/tech/full_papers/porras/porras_html/
                                    </a>
                                </li>
                                <li id="263">


                                    <a id="bibliography_22" title="Google.Google safe browsing[EB/OL].[2017-10-14].https:www.google.com/transparencyreport/safebrowsing/" target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Google safe browsing">
                                        <b>[22]</b>
                                        Google.Google safe browsing[EB/OL].[2017-10-14].https:www.google.com/transparencyreport/safebrowsing/
                                    </a>
                                </li>
                                <li id="265">


                                    <a id="bibliography_23" title="Alexa.Alexa top 1 million[EB/OL].[2017-03-05].http:s3.amazonaws.com/alexa-static/top-1m.csv.zip" target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Alexa top 1 million">
                                        <b>[23]</b>
                                        Alexa.Alexa top 1 million[EB/OL].[2017-03-05].http:s3.amazonaws.com/alexa-static/top-1m.csv.zip
                                    </a>
                                </li>
                                <li id="267">


                                    <a id="bibliography_24" >
                                        <b>[24]</b>
                                    Pedregosa F, Varoquaux G, Gramfort A, et al.Scikit-learn:Machine learning in python[J].Journal of Machine Learning Research, 2011 (12) :2825-2830</a>
                                </li>
                                <li id="269">


                                    <a id="bibliography_25" title="Chen Tianqi, Guestrin C.XGBoost:A scalable tree boosting system[C]Proc of the 22nd ACM SIGKDD Int Conf on Knowledge Discovery and Data Mining.New York:ACM, 2016:785-794" target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Xgboost:A scalable tree boosting system">
                                        <b>[25]</b>
                                        Chen Tianqi, Guestrin C.XGBoost:A scalable tree boosting system[C]Proc of the 22nd ACM SIGKDD Int Conf on Knowledge Discovery and Data Mining.New York:ACM, 2016:785-794
                                    </a>
                                </li>
                            </ul>
                            <div style='display: none;' class="zqscroller" >
                                <h4 class="">附加材料</h4>
                                <ul></ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            &nbsp;
            <!--此处有一空格符 勿删-->
        </div>

        
    <div class="content">



        <!--tips start-->
                            <div class="tips">
                    <a href="http://navi.cnki.net/KNavi/JournalDetail?pcode=CJFD&amp;pykm=JFYZ" target="_blank">计算机研究与发展</a>
                2019,56(06),1263-1274 DOI:10.7544/issn1000-1239.2019.20180481            </div>
        <!--tips end-->
            <div class="top-title">
                <h1 class="title">
                    <span class="vm"><b>一种基于域名请求伴随关系的恶意域名检测方法</b></span>
                                    </h1>

            </div>
                        <h2>
                                <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=au&amp;skey=%E5%BD%AD%E6%88%90%E7%BB%B4&amp;code=42095404&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4vMkp4azg1TUxGcERuK01CZG1GRT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">彭成维</a>
                                <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=au&amp;skey=%E4%BA%91%E6%99%93%E6%98%A5&amp;code=10748439&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4vMkp4azg1TUxGcERuK01CZG1GRT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">云晓春</a>
                                <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=au&amp;skey=%E5%BC%A0%E6%B0%B8%E9%93%AE&amp;code=36408946&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4vMkp4azg1TUxGcERuK01CZG1GRT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">张永铮</a>
                                <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=au&amp;skey=%E6%9D%8E%E4%B9%A6%E8%B1%AA&amp;code=42095406&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4vMkp4azg1TUxGcERuK01CZG1GRT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">李书豪</a>
                </h2>
                    <h2>
                    <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=in&amp;skey=%E4%B8%AD%E5%9B%BD%E7%A7%91%E5%AD%A6%E9%99%A2%E8%AE%A1%E7%AE%97%E6%8A%80%E6%9C%AF%E7%A0%94%E7%A9%B6%E6%89%80&amp;code=0142480&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4vMkp4azg1TUxGcERuK01CZG1GRT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">中国科学院计算技术研究所</a>
                    <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=in&amp;skey=%E4%B8%AD%E5%9B%BD%E7%A7%91%E5%AD%A6%E9%99%A2%E5%A4%A7%E5%AD%A6&amp;code=1698842&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4vMkp4azg1TUxGcERuK01CZG1GRT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">中国科学院大学</a>
                    <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=in&amp;skey=%E4%B8%AD%E5%9B%BD%E7%A7%91%E5%AD%A6%E9%99%A2%E4%BF%A1%E6%81%AF%E5%B7%A5%E7%A8%8B%E7%A0%94%E7%A9%B6%E6%89%80&amp;code=0142480&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4vMkp4azg1TUxGcERuK01CZG1GRT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">中国科学院信息工程研究所</a>
            </h2>

        
<div class="link">
    <a id="aexport" class="icon icon-output"  onclick="" href="javascript:void(0);"><i></i>导出/参考文献</a>
    
    <span class="shareBoard" onmouseover="$('#sharedet').show();$('#this').addClass('shareBoardCUR')" onmouseout="$('#sharedet').hide();$('#this').removeClass('shareBoardCUR')">
        <a class="icon icon-share" href="#"><i></i>分享<em></em></a>
        <ul class="shareHide" id="sharedet" style="display: none;">
            <li><a title="复制链接" class="copy" onclick="" href="#"><i></i>复制链接</a></li>
            <li><a title="分享到新浪微博" class="xl" onclick="" href="javascript:common.ShareAction('xl');"><i></i>新浪微博</a></li>
            <li>
                <a title="分享到微信" class="wx" onclick="" href="#"><i></i>微信扫一扫</a>
                <div class="qrcode"><img src='' alt='' /></div>
            </li>
        </ul>

    </span>
    
    <a id="RefTrack" title="创建引文跟踪" class="icon icon-track" onclick="" href="javascript:void(0);"> <i></i>创建引文跟踪 </a>
    <a id="ashoucang" title="收藏" class="icon icon-favor" onclick="" href="javascript:void(0);"><i></i>收藏</a>
    <a class="icon icon-print" onclick="window.print();" href="javascript:void(0);"><i></i>打印</a>
    
    <!--版本切换 end-->
</div>
                            <div class="data" id="a_abstract">
                <span class="keys">摘<span style="font-family: 'Times New Roman';">&nbsp;&nbsp;&nbsp;&nbsp;</span>要：</span>
                <p>恶意域名在网络非法攻击活动中承担重要的角色.恶意域名检测能够有效地减少攻击活动所带来的经济损失.提出CoDetector恶意域名检测模型, 通过挖掘域名请求之间潜在的时空伴随关系进行恶意域名检测.研究发现域名请求之间存在彼此伴随关系, 而并非相互独立.因此, 彼此伴随的域名之间存在紧密关联, 偏向于同时是正常域名或恶意域名.1) 利用域名请求的先后时间顺序对域名数据进行粗粒度的聚类操作, 将彼此伴随出现的域名划分到同一簇中;2) 采用嵌入学习构建映射函数, 在保留域名伴随关系的同时将每一个域名投影成低维空间的特性向量;3) 结合有标记的数据, 训练恶意域名检测分类器, 用于检测更多未知恶意域名.实验结果表明, CoDetector能够有效地检测恶意域名, 具有91.64%检测精度和96.04%召回率.</p>
            </div>
                    <div class="data" id="a_keywords">
                <span class="keys">关键词：</span>
                <p>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=%E5%9F%9F%E5%90%8D%E8%AF%B7%E6%B1%82&amp;code=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4vMkp4azg1TUxGcERuK01CZG1GRT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">域名请求;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=%E8%AF%B7%E6%B1%82%E4%BC%B4%E9%9A%8F&amp;code=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4vMkp4azg1TUxGcERuK01CZG1GRT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">请求伴随;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=%E6%81%B6%E6%84%8F%E5%9F%9F%E5%90%8D&amp;code=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4vMkp4azg1TUxGcERuK01CZG1GRT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">恶意域名;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97%E5%88%87%E5%89%B2&amp;code=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4vMkp4azg1TUxGcERuK01CZG1GRT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">时间序列切割;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=%E5%90%91%E9%87%8F%E5%8C%96%E8%A1%A8%E7%A4%BA&amp;code=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4vMkp4azg1TUxGcERuK01CZG1GRT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">向量化表示;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=%E5%9F%9F%E5%90%8D%E5%88%86%E7%B1%BB&amp;code=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4vMkp4azg1TUxGcERuK01CZG1GRT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">域名分类;</a>
                </p>
            </div>
        
        <!--brief start-->
        
            <div class="brief">
                    <p>
                            <b>作者简介：</b>
                                                        <span>
                                    彭成维, pengchengwei@iie.ac.cn, born in 1993. PhD candidate in the Institute of Computing Technology, Chinese Academy of Sciences, China.His main research interests include network and information security, inparticular DNS data mining.;
                                </span>
                                <span>
                                    *云晓春, yunxiaochun@iie.ac.cn, born in 1971. PhD, professor and PhD supervisor in the Institute of Information Engineering, Chinese Academy of Sciences, China.Hismain research interests include network and information security.;
                                </span>
                                <span>
                                    Zhang Yongzheng, born in 1979.PhD, professor and PhD supervisor in the Institute of Information Engineering, Chinese Academy of Sciences, China.Hismain research interests include network and information security, particularly cyberspace security situational awareness.;
                                </span>
                                <span>
                                    Li Shuhao, born in 1983.PhD, assistant professor in the Institute of Information Engineering, Chinese Academy of Sciences, China.His main research interests include network and information security, particularly mobile malware attack and defense.;
                                </span>
                    </p>
                                    <p><b>收稿日期：</b>2018-06-27</p>

                    <p>

                            <b>基金：</b>
                                                        <span>国家重点研发计划项目 (2016YFB0801502);</span>
                                <span>国家自然科学基金项目 (U1736218);</span>
                    </p>
            </div>
                    <h1><b>Detecting Malicious Domains Using Co-Occurrence Relation Between DNS Query</b></h1>
                    <h2>
                    <span>Peng Chengwei</span>
                    <span>Yun Xiaochun</span>
                    <span>Zhang Yongzheng</span>
                    <span>Li Shuhao</span>
            </h2>
                    <h2>
                    <span>Institute of Computing Technology, Chinese Academy of Sciences</span>
                    <span>University of Chinese Academy of Sciences</span>
                    <span>Institute of Information Engineering, Chinese Academy of Sciences</span>
            </h2>
                            <div class="data" id="a_abstractEN">
                <span class="keys">Abstract：</span>
                <p>Malicious domains play a vital role in illicit online activities. Effectively detecting the malicious domains can significantly decrease the damage of evil attacks. In this paper, we propose CoDetector, a novel technique to detect malicious domains based on the co-occurrence relationships of domains in DNS (domain name system) queries. We observe that DNS queries are not isolated, whereas co-occur with each other. We base it design on the intuition that domains that tend to co-occur in DNS traffic are strongly associated and are likely to be in the same property (i.e., malicious or benign) . Therefore, we first perform coarse-grained clustering of DNS traffic based on the chronological order of DNS queries. The domains co-occurring with each other will be clustered. Then, we design a mapping function that automatically projects every domain into a low-dimensional feature vector while maintaining their co-occurrence relationships. Domains that co-occur with each others are mapped to similar vectors while domains that not co-occur are mapped to distant vectors. Finally, based on the learned feature representations, we train a classifier over a labeled dataset and further apply it to detect unknown malicious domains. We evaluate CoDetector using real-world DNS traffic collected from an enterprise network over two months. The experimental results show that CoDetector can effectively detect malicious domains (91.64% precision and 96.04% recall) .</p>
            </div>
                    <div class="data" id="a_keywordsEN">
                <span class="keys">Keyword：</span>
                <p>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=DNS%20queries&amp;code=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4vMkp4azg1TUxGcERuK01CZG1GRT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">DNS queries;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=co-occurrence&amp;code=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4vMkp4azg1TUxGcERuK01CZG1GRT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">co-occurrence;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=malicious%20domains&amp;code=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4vMkp4azg1TUxGcERuK01CZG1GRT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">malicious domains;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=DNS%20cut&amp;code=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4vMkp4azg1TUxGcERuK01CZG1GRT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">DNS cut;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=tensor%20representation&amp;code=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4vMkp4azg1TUxGcERuK01CZG1GRT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">tensor representation;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=domain%20classification&amp;code=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4vMkp4azg1TUxGcERuK01CZG1GRT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">domain classification;</a>
                </p>
            </div>
                    <div class="brief">
                
                    <p>
                                            </p>
                                    <p><b>Received：</b> 2018-06-27</p>
                                    <p>
                            <b>Fund：</b>
                                                        <span>supported by the National Key Research and Development Program of China (2016YFB0801502);</span>
                                <span>the National Natural Science Foundation of China (U1736218);</span>
                    </p>
            </div>


        <!--brief start-->
                        <div class="p1">
                    <p id="57">域名系统 (domain name system, DNS) 是当今互联网中重要的基础核心服务之一, 负责提供统一的域名地址空间映射服务, 主要将易于人类记忆的域名翻译为易于机器识别的IP地址.然而, 伴随着域名系统提供正常服务的同时, 近年来越来越多的网络非法活动也开始滥用域名系统以达到其恶意目的.例如, 僵尸网络利用域名生成算法 (domain generate algorithm, DGA) 批量生成大量用于僵尸网络命令与控制 (command &amp; control, C&amp;C) 信道通信的域名, 来逃避权威安全防御机构的封杀和屏蔽<citation id="273" type="reference"><link href="221" rel="bibliography" /><link href="223" rel="bibliography" /><sup>[<a class="sup">1</a>,<a class="sup">2</a>]</sup></citation>.网络诈骗犯注册外观极其相似于知名合法域名 (如alipay.com) 的新域名 (如al1pay.com) , 并搭建钓鱼网站来欺骗网络用户, 达到窃取账户信息、信用卡密码等目的<citation id="271" type="reference"><link href="225" rel="bibliography" /><sup>[<a class="sup">3</a>]</sup></citation>.2016年思科年度安全报告<citation id="272" type="reference"><link href="227" rel="bibliography" /><sup>[<a class="sup">4</a>]</sup></citation>中指出, 高达91.3%的恶意软件均会对域名系统进行一定程度的滥用, 造成大量的经济损失.</p>
                </div>
                <div class="p1">
                    <p id="58">近年来出现了大量利用DNS流量检测恶意域名的研究工作, 其主要目的是为了在用户访问这些恶意域名之前进行防御和预警, 从而缓解攻击活动带来的威胁和损害.常见的方法<citation id="274" type="reference"><link href="229" rel="bibliography" /><link href="231" rel="bibliography" /><link href="233" rel="bibliography" /><sup>[<a class="sup">5</a>,<a class="sup">6</a>,<a class="sup">7</a>]</sup></citation>是从DNS流量、网页信息等数据中为每一个域名人为手动提取特征 (例如TTL (time to live) 大小、域名请求模式、解析的IP地址数目、涉及到的国家等) , 随后利用机器学习算法构建分类器.然而, 这类基于特征的检测方法能够有效地检测恶意域名的前提是提取特征的有效性, 即能否有效地区分黑白域名的行为, 并且攻击者不去修改恶意域名的行为来规避这些特征.实际上, 之前提出的很多特征已被证实不具有很好的鲁棒性, 攻击者可以通过简单地调整来改变这些特征, 从而逃避检测.</p>
                </div>
                <div class="p1">
                    <p id="59">本文提出CoDetector算法, 一种基于域名请求之间内在的时空伴随关系 (co-occurrence relation) 进行恶意域名检测的算法.本文发现域名请求之间不是彼此独立, 相反存在时空相似、伴随共现的特性.针对一次域名查询, 触发这次查询的底层应用程序同时会触发其他相关的域名查询, 这些域名相互伴随出现, 协同完成此次网络活动.例如使用浏览器打开链接, 如http://www.baidu.com会先触发对该页面域名www.baidu.com的DNS查询, 当网页内容开始呈现时, 则会进一步触发对页面嵌入内容 (如图片、广告等) 的链接进行额外的DNS查询.这些域名请求是为了共同完成这次页面展示而触发的请求, 在DNS请求上表现为伴随共现的特性.于此同时, 本文发现恶意域名请求之间同样存在时空伴随关系, 不同的恶意域名会在一次恶意网络活动中共同伴随地出现.例如一次路过式下载 (drive-by download) 行为通常由一个长长的URL重定向链条来逐步导向到最终的恶意软件.网络黑产中, 恶意的搜索引擎优化技术通过构建重复循环的URL链条, 让搜索引擎的爬虫持续停留在被敌手设计的页面中.</p>
                </div>
                <div class="p1">
                    <p id="60">本文的假设是伴随出现的域名之间存在紧密的关联, 性质上具有同态性, 即和恶意域名伴随出现的域名偏向于是恶意域名, 反之亦然.基于以上假设, 本文提出CoDetector恶意域名检测算法, 其主要思路是从DNS流量中挖掘域名之间时空伴随关系, 然后借鉴深度学习中张量化表示算法 (如word2vec<citation id="275" type="reference"><link href="235" rel="bibliography" /><sup>[<a class="sup">8</a>]</sup></citation>) 在保留域名彼此时空伴随关系的基础上将每一个域名映射为低维空间的特征向量, 最后结合机器学习分类算法构建恶意域名检测分类器.为实现以上目标, 本文主要面临2个挑战:</p>
                </div>
                <div class="p1">
                    <p id="61">1) 如何从DNS流量提取彼此具有时空伴随关系的域名?</p>
                </div>
                <div class="p1">
                    <p id="62">2) 如何在保留域名彼此时空伴随关系的同时张量化地提取域名特征?</p>
                </div>
                <div class="p1">
                    <p id="63">针对挑战1, 本文提出基于域名请求时间间隔的切割算法, 将原始DNS流量中的DNS请求根据时间顺序切割成不同长度的时空伴随域名序列.本文认为在时间上同时触发的域名请求彼此存在伴随关系, 存在明显的时间间隔的请求则不具有伴随关系.实际上, 通过对真实DNS数据分析, 本文发现每个用户所触发的DNS请求在时间上存在明显的分块聚簇现象, 即DNS请求一批接着一批触发, 不同批次之间存在明显时间间隔.例如在打开下一个网页之前, 会在上一个网页停留一定的时间, 从而导致这2次页面行为触发的域名请求之间也存在明显时间间隔.因此, 如果2个域名请求之间的时间间隔大于给定的阈值 (例如5 s) , 则很有可能是不同网络活动所触发的DNS请求, 本文便将这2个域名划分到不同序列中, 反之则划分到同一个序列中.每一个序列有1个或者多个域名组成, 近似认为是由一次网络活动所触发的DNS请求集合, 彼此具有时空伴随关系.</p>
                </div>
                <div class="p1">
                    <p id="64">针对挑战2, 本文借鉴Skip-Gram<citation id="276" type="reference"><link href="237" rel="bibliography" /><sup>[<a class="sup">9</a>]</sup></citation>的词向量表示算法, 将每一个域名投影成<i>d</i>维实数空间中的一个点 (向量) , 目标是使得具有伴随关系的域名映射成空间中距离相近的点;反之, 把不具有伴随关系的2个域名映射到空间中相隔较远的位置.考虑到挑战1中提取的时空伴随域名序列可能会存在噪声干扰和由序列长度过长带来的计算复杂度问题, 本文采用滑动窗口的方式, 进一步从时空伴随域名序列中提取具有时空伴随域名对.每个时空伴随域名对由2个域名组成, 彼此之间具有时空伴随关系, 同时, 本文采用负采样技术<citation id="277" type="reference"><link href="235" rel="bibliography" /><sup>[<a class="sup">8</a>]</sup></citation>构建不具有时空伴随关系的域名对作为负样本数据, 最后结合优化目标迭代地调整每一个域名在R<sup><i>d</i></sup>空间的位置.优化结束后, 本文便可得到每一个域名特征向量.</p>
                </div>
                <div class="p1">
                    <p id="65">与前人工作对比, 本文工作主要有3点不同之处:</p>
                </div>
                <div class="p1">
                    <p id="66">1) CoDetector自动地从DNS流量中挖掘潜在的域名伴随关系, 并映射为特征向量, 无需人工专家经验, 省去人工设计特征的繁杂工作.</p>
                </div>
                <div class="p1">
                    <p id="67">2) CoDetector仅利用域名请求的时间顺序挖掘伴随关系, 无需额外的附加信息.因此, 本文的方法更加轻量实时, 能够处理不具有正常应答的恶意域名, 例如DGA生成的NXDomain域名.</p>
                </div>
                <div class="p1">
                    <p id="68">3) CoDetector将具有伴随关系的域名进行了聚类, 因此可以用于恶意域名团伙发现.</p>
                </div>
                <div class="p1">
                    <p id="69">最后, 本文采集一个企业网下近2个月的DNS流量数据, 结合3种主流的机器学习分类算法 (随机森林、XGBoost和深度神经网络) 来评估CoDetector模型的检测效果.实验结果表明, CoDetector平均能够达到91.64%的检测精度和96.40%的召回率.因此, CoDetector能够有效地通过DNS流量挖掘域名请求之间时空伴随关系, 并用于检测恶意域名.</p>
                </div>
                <div class="p1">
                    <p id="70">总体来说, 本文工作具有4点贡献:</p>
                </div>
                <div class="p1">
                    <p id="71">1) 提出一种基于时间间隔的域名序列切割算法, 能够有效地从DNS流量中提取具有伴随关系的域名序列.</p>
                </div>
                <div class="p1">
                    <p id="72">2) 提出一种无监督的域名张量化表达算法, 能够将每一个域名映射为低维空间的特征向量并且保留域名彼此之间的伴随关系.</p>
                </div>
                <div class="p1">
                    <p id="73">3) 提出一种基于域名请求之间时空伴随关系的恶意域名检测算法——CoDetector.该模型自动地从原始DNS流量挖掘潜在的域名时空伴随关系, 并用于检测恶意域名.</p>
                </div>
                <div class="p1">
                    <p id="74">4) 结合真实DNS数据, 对CoDetector的可行性和有效性进行评估, 实验验证CoDetector能够有效地检测恶意域名.</p>
                </div>
                <h3 id="75" name="75" class="anchor-tag"><b>1 相关工作</b></h3>
                <div class="p1">
                    <p id="76">近年来出现了大量利用DNS流量检测恶意域名的研究工作.Antonakakis等人<citation id="278" type="reference"><link href="229" rel="bibliography" /><sup>[<a class="sup">5</a>]</sup></citation>提出了Notos动态域名打分系统.Notos主要提取3种类型的特征:1) 基于网络位置的特征 (历史上与域名关联的IP数量、地理位置的多样性、它们驻留的不同自治系统的数量等) ;2) 基于域名Zone文件的特征 (如域名不同gram分布的平均长度、不同顶级域名的数量、字符频率等) ;3) 基于历史证据的特征 (如域名解析的IP地址中有多少曾经在恶意样本中出现、该域名是否在蜜罐系统中捕获等) .Bilge等人<citation id="279" type="reference"><link href="231" rel="bibliography" /><sup>[<a class="sup">6</a>]</sup></citation>提出了Exposure恶意域名检测系统.Exposure克服了Notos的部分限制, 它能够识别之前从未在恶意活动中看到的恶意域名和地址, 并且只需要较短时间的训练数据.Bilge等人从DNS流量中为每一个二级域名提取了15个特征, 其中包括新颖的基于时间的特征 (短生命周期、每日访问相似度、重复模式、访问成功的比率等) 、基于DNS应答的特征 (不同IP地址的数量、不同国家的数量、共享IP地址的域名的数量、反向DNS查询结果) 、基于TTL值的特征 (TTL的平均值、TTL的标准偏差、不同的TTL值的数量、TTL变化的数量) 和基于域名词法的特征 (数字字符的百分比和最长有意义的子字符串的标准化长度) .Antonakakis等人<citation id="280" type="reference"><link href="233" rel="bibliography" /><sup>[<a class="sup">7</a>]</sup></citation>提出Kopis系统.与Notos和Exposure相比, Kopis使用了DNS系统中更高层次域名流量数据 (顶级域名服务器和权威域名服务器采集到的DNS流量) .因此, Kopis从更加全局的角度来提取每一个域名的行为, 其中包括基于请求来源分布的统计特征 (例如与递归DNS服务器相关联的IP地址的多样性) 和请求来源在每个时期结束时向给定域名的DNS流量, 递归DNS服务器的相对查询量以及与域名指向的IP空间相关的历史信息.这些方法主要是通过针对每一个域名的提取局部特征, 并利用机器学习分类器来构建检测模型.可能存在的问题是:如果这些检测方法 (特征) 被敌手了解之后, 很容易通过合理的调整来规避这些特征, 逃过检测.本文提出的CoDetector模型是考虑了域名之间的潜在时空伴随关联特性.如果敌手想要绕过CoDetector的检测, 需要消除其使用的恶意域名之间的时空伴随特性.例如每次只使用一个域名, 然而这极大地降低了恶意活动的灵活性.</p>
                </div>
                <div class="area_img" id="77">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JFYZ201906014_077.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4vMkp4azg1TUxGcERuK01CZG1GRT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图1 CoDetector模型工作流程图" src="Detail/GetImg?filename=images/JFYZ201906014_077.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4vMkp4azg1TUxGcERuK01CZG1GRT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图1 CoDetector模型工作流程图  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JFYZ201906014_077.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4vMkp4azg1TUxGcERuK01CZG1GRT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit">Fig. 1 The workflow of CoDetector</p>

                </div>
                <div class="p1">
                    <p id="78">Khalil等人<citation id="281" type="reference"><link href="239" rel="bibliography" /><sup>[<a class="sup">10</a>]</sup></citation>提出利用域名和IP之间的全局关联来检测恶意域名.其主要思路是利用 (域名、IP) 映射数据构建域名关联图.如果2个域名映射到相同的IP, 则在2个域名之间添加关联边.随后, 在域名关联图使用基于图上路径搜索的机制来推断未知域名的恶意分数.Peng等人<citation id="282" type="reference"><link href="241" rel="bibliography" /><sup>[<a class="sup">11</a>]</sup></citation>提出了一种基于DNS CNAME记录的恶意域检测方法, 该方法专注于没有解析到IP地址, 但出现在DNS CNAME记录中的域名.该方法是基于CNAME记录连接的2个域名存在内在紧密关系, 并且偏向于处于同样的性质 (即同时是恶意域名或者同时是正常域名) .他们提出一种基于置信传播的图推理方法, 通过计算未知域名与其他已知恶意和正常域名的全局关联来计算其恶意概率.他们的实验结果表明, 该方法可以有效揭露被以往研究工作所忽略的恶意域名.Manadhata等人<citation id="283" type="reference"><link href="243" rel="bibliography" /><sup>[<a class="sup">12</a>]</sup></citation>提出了一种基于图推断方法的恶意域名检测模型.该模型首先利用企业网络中的DNS数据构建了一个主机-域名二分图, 其中如果一台主机访问了某个域名, 便在该主机和该域名之间添加关联边, 最后利用置信传播 (belief propagation) 算法在图上进行推断.文献<citation id="284" type="reference">[<a class="sup">13</a>]</citation>提出了利用DNS服务器与用户之间通信的DNS数据来构建域名主机二分图, 其主要假设是访问恶意域名的机器更有可能是感染的机器, 反过来感染的机器访问的域名也更有可能是恶意域名.然而, 上述方法利用DNS服务器与用户之间的DNS数据, 会带来隐私问题.文献<citation id="285" type="reference">[<a class="sup">14</a>]</citation>提出利用DNS数据检测长周期下APT中隐蔽可疑的DNS行为.</p>
                </div>
                <div class="p1">
                    <p id="79">本文并不是第1个提出利用域名请求伴随关系来检测恶意域名的研究工作.Gao等人<citation id="286" type="reference"><link href="249" rel="bibliography" /><sup>[<a class="sup">15</a>]</sup></citation>提出了一种基于域名请求伴随关系来检测恶意域名团伙的算法.该工作利用部分已知的恶意域名作为种子, 统计域名和种子伴随出现的关系, 采用TF-IDF算法和XMeans聚类算法来提取域名团伙.然而, 该工作首先未考虑域名请求之间的时间间隔, 因此会将属于不同网络活动触发的域名划分到一个团伙中, 存在严重的噪声干扰.本文提出的模型能够自动地挖掘域名的伴随关系, 且具有线性的时间复杂度, 适合在大规模数据上运行.</p>
                </div>
                <h3 id="80" name="80" class="anchor-tag"><b>2 CoDetector检测模型</b></h3>
                <div class="p1">
                    <p id="81">本文发现主机层面的域名请求之间存在伴随共现关系, 并非互相独立.因此, 通过考虑一个域名经常和哪些域名伴随出现能够有效地协助决策该域名是否是恶意域名.本文的基本假设是具有时空伴随关系的域名之间存在紧密的关联, 在性质上 (恶意性质或者正常性质) 具有同态性.具体来说, 如果一个域名经常和恶意域名伴随共现, 那么该域名偏向于是恶意域名, 反之亦然.CoDetector模型首先从DNS流量中提取彼此具有时空伴随关系的域名, 形成时空伴随域名序列集合;随后利用深度学习算法在保留域名彼此伴随关系的同时将每个域名投影成低维实数空间的特征向量;最后结合部分已知的黑白域名, 利用机器学习分类算法构建恶意域名检测分类器, 用于识别未知的恶意域名.</p>
                </div>
                <div class="p1">
                    <p id="82">图1展示了CoDetector检测模型的工作流程, 其主要分为3个模块.</p>
                </div>
                <div class="p1">
                    <p id="83">1) 时空伴随域名序列提取模块.利用域名请求的先后时间顺序将原始域名数据进行粗粒度的聚类, 划分为不同的序列, 使得每一个序列中的域名彼此具有时空伴随关系.</p>
                </div>
                <div class="p1">
                    <p id="84">2) 特征学习模块.构建映射函数<i>f</i>:<i>D</i>→R<sup><i>d</i></sup>将每一个域名<i>x</i>∈<i>D</i>映射为<i>d</i>维空间的特征向量<b><i>v</i></b><sub><i>i</i></sub>, 同时保留域名之间的时空伴随关系, 即将具有伴随关系的域名映射到R<sup><i>d</i></sup>空间中距离相近的点, 把不具有伴随关系的域名映射到距离遥远的点.</p>
                </div>
                <div class="p1">
                    <p id="85">3) 恶意域名检测模块.利用特征学习模块中学习到的每个域名的特征向量, 结合部分黑白域名列表, 采用有监督的机器学习算法训练恶意域名分类器, 并应用于对更多未知属性的域名进行检测.</p>
                </div>
                <div class="p1">
                    <p id="86">详细介绍每一个模块的设计, 最后给出模型时间复杂度分析.</p>
                </div>
                <h4 class="anchor-tag" id="87" name="87"><b>2.1 时空伴随域名序列提取</b></h4>
                <div class="p1">
                    <p id="88">本模块首先针对原始DNS流量进行粗粒度的聚类操作, 将彼此具有伴随关系的域名划分在同一个域名簇中, 形成时空伴随域名序列结合.通过对真实的DNS流量分析, 本文发现每个用户的DNS请求具有明显分块聚簇的特点, 在时间顺序上存在聚类的现象.用户的域名请求一批接着一批发起, 不同批次之间的DNS请求具有明显的时间间隔.</p>
                </div>
                <div class="p1">
                    <p id="89">图2展示了本文采集到的部分用户在10 min时间段内的域名请求时间散点分布图, <i>x</i>轴为时间, 图2中每个点代表一次DNS请求, 不同直线代表不同用户的DNS请求随着时间的散点分布.本文发现, 每一个用户的域名请求在时间线上呈现成块行为.例如用户<i>u</i><sub>7</sub>, <i>u</i><sub>8</sub>, <i>u</i><sub>9</sub>的域名请求数据存在明显的聚簇现象, 同簇之间的请求几乎同时发起, 簇与簇之间存在明显时间间隔.因此, 本文近似地按照域名请求时间进行粗粒度的聚类, 认为每簇中的域名彼此伴随出现, 形成一个时空伴随域名序列.</p>
                </div>
                <div class="area_img" id="90">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JFYZ201906014_090.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4vMkp4azg1TUxGcERuK01CZG1GRT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图2 10 min内部分DNS数据请求散点图" src="Detail/GetImg?filename=images/JFYZ201906014_090.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4vMkp4azg1TUxGcERuK01CZG1GRT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图2 10 min内部分DNS数据请求散点图  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JFYZ201906014_090.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4vMkp4azg1TUxGcERuK01CZG1GRT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit">Fig. 2 The scatter of DNS queries in 10 min</p>

                </div>
                <div class="p1">
                    <p id="91">假设 <i>D</i>是通过DNS服务器监听到的DNS流量数据, 其可以分解为不同终端用户的DNS请求集合, 即<mathml id="92"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>D</mi><mo>=</mo><mstyle displaystyle="true"><munder><mo>∪</mo><mi>i</mi></munder><mi>D</mi></mstyle><msub><mrow></mrow><mi>i</mi></msub></mrow></math></mathml>, 其中<i>D</i><sub><i>i</i></sub>={ (<i>d</i><mathml id="93"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msubsup><mrow></mrow><mi>i</mi><mn>1</mn></msubsup></mrow></math></mathml>, <i>t</i><mathml id="94"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msubsup><mrow></mrow><mi>i</mi><mn>1</mn></msubsup></mrow></math></mathml>) , (<i>d</i><mathml id="95"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msubsup><mrow></mrow><mi>i</mi><mn>2</mn></msubsup></mrow></math></mathml>, <i>t</i><mathml id="96"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msubsup><mrow></mrow><mi>i</mi><mn>2</mn></msubsup></mrow></math></mathml>) , …, (<i>d</i><mathml id="97"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msubsup><mrow></mrow><mi>i</mi><mrow><mi>n</mi><msub><mrow></mrow><mi>i</mi></msub></mrow></msubsup></mrow></math></mathml>, <i>t</i><mathml id="98"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msubsup><mrow></mrow><mi>i</mi><mrow><mi>n</mi><msub><mrow></mrow><mi>i</mi></msub></mrow></msubsup></mrow></math></mathml>) }为用户<i>u</i><sub><i>i</i></sub>请求域名的集合, (<i>d</i><mathml id="99"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msubsup><mrow></mrow><mi>i</mi><mi>j</mi></msubsup></mrow></math></mathml>, <i>t</i><mathml id="100"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msubsup><mrow></mrow><mi>i</mi><mi>j</mi></msubsup></mrow></math></mathml>) 代表用户<i>u</i><sub><i>i</i></sub>在时间<i>t</i><mathml id="101"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msubsup><mrow></mrow><mi>i</mi><mi>j</mi></msubsup></mrow></math></mathml>请求域名<i>d</i><mathml id="102"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msubsup><mrow></mrow><mi>i</mi><mi>j</mi></msubsup></mrow></math></mathml>, <i>t</i><mathml id="103"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msubsup><mrow></mrow><mi>i</mi><mn>1</mn></msubsup></mrow></math></mathml>≤<i>t</i><mathml id="104"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msubsup><mrow></mrow><mi>i</mi><mn>2</mn></msubsup></mrow></math></mathml>≤…≤<i>t</i><mathml id="105"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msubsup><mrow></mrow><mi>i</mi><mrow><mi>n</mi><msub><mrow></mrow><mi>i</mi></msub></mrow></msubsup></mrow></math></mathml>.基于DNS请求的成块聚簇现象, 本文提出一种基于时间间隔的域名时空伴随序列切割算法.具体表现是:如果相邻的2个域名请求之间, { (<i>d</i><mathml id="106"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msubsup><mrow></mrow><mi>i</mi><mi>j</mi></msubsup></mrow></math></mathml>, <i>t</i><mathml id="107"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msubsup><mrow></mrow><mi>i</mi><mi>j</mi></msubsup></mrow></math></mathml>) , (<i>d</i><mathml id="108"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msubsup><mrow></mrow><mi>i</mi><mrow><mi>j</mi><mo>+</mo><mn>1</mn></mrow></msubsup></mrow></math></mathml>, <i>t</i><mathml id="109"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msubsup><mrow></mrow><mi>i</mi><mrow><mi>j</mi><mo>+</mo><mn>1</mn></mrow></msubsup></mrow></math></mathml>) }的时间间隔Δ<i>t</i>=<i>t</i><mathml id="110"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msubsup><mrow></mrow><mi>i</mi><mrow><mi>j</mi><mo>+</mo><mn>1</mn></mrow></msubsup></mrow></math></mathml>-<i>t</i><mathml id="111"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msubsup><mrow></mrow><mi>i</mi><mi>j</mi></msubsup></mrow></math></mathml>大于切割阈值<i>τ</i> (如5 s) , 本文便将这2个域名请求划分到不同的序列中, 反之则划分到同一个序列中.图3展示了利用时间间隔切割域名数据的简单示例图.最终, 将所有用户的域名数据切割形成的时空伴随域名序列即为从DNS流量 <i>D</i>中提取的时空伴随域名序列集合.</p>
                </div>
                <div class="area_img" id="112">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JFYZ201906014_112.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4vMkp4azg1TUxGcERuK01CZG1GRT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图3 时空伴随域名序列生成说明图" src="Detail/GetImg?filename=images/JFYZ201906014_112.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4vMkp4azg1TUxGcERuK01CZG1GRT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图3 时空伴随域名序列生成说明图  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JFYZ201906014_112.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4vMkp4azg1TUxGcERuK01CZG1GRT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit">Fig. 3 An illustration for generating co-occurring  domain sequences</p>

                </div>
                <h4 class="anchor-tag" id="113" name="113"><b>2.2 特征学习</b></h4>
                <div class="p1">
                    <p id="114">假设<i>S</i>={<i>S</i><sub>1</sub>, <i>S</i><sub>2</sub>, …, <i>S</i><sub><i>n</i></sub>}为提取到的时空伴随域名序列集合, 其中<i>S</i><sub><i>i</i></sub>={<i>d</i><sub>1</sub>, <i>d</i><sub>2</sub>, …, <i>d</i><sub><i>n</i><sub><i>i</i></sub></sub>}是由<i>n</i><sub><i>i</i></sub>个域名构成的序列.本模块的目标是在保留域名彼此之间的伴随关系的同时, 将每一个域名映射成低维空间的特征向量.本文把映射操作形式化为似然概率最大化问题:</p>
                </div>
                <div class="p1">
                    <p id="115">首先, 每一个时空伴随域名序列<i>S</i><sub><i>i</i></sub>的概率<i>P</i> (<i>S</i><sub><i>i</i></sub>) =<i>Pr</i> (<i>d</i><sub>1</sub>, <i>d</i><sub>2</sub>, …, <i>d</i><sub><i>n</i><sub><i>i</i></sub></sub>) 为这<i>n</i><sub><i>i</i></sub>个域名联合出现的概率.因此, 映射操作的基本优化目标是最大化序列集合<i>S</i>的概率, 即:</p>
                </div>
                <div class="p1">
                    <p id="116"><mathml id="117"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mrow><mi>max</mi></mrow><mspace width="0.25em" /><mi>Ρ</mi><mo stretchy="false"> (</mo><mi>S</mi><mo stretchy="false">) </mo><mo>=</mo><mrow><mi>max</mi></mrow><mspace width="0.25em" /><mstyle displaystyle="true"><munderover><mo>∏</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mi>Ρ</mi></mstyle><mo stretchy="false"> (</mo><mi>S</mi><msub><mrow></mrow><mi>i</mi></msub><mo stretchy="false">) </mo></mrow></math></mathml>. (1) </p>
                </div>
                <div class="p1">
                    <p id="118">然而, 最大化该目标函数在现实计算中存在问题, 尤其是当序列长度<i>n</i><sub><i>i</i></sub>过大而带来的联合概率计算呈指数增长的复杂度.近年来, Skip-Gram<citation id="287" type="reference"><link href="237" rel="bibliography" /><sup>[<a class="sup">9</a>]</sup></citation>语言模型在自然语言处理问题上取得了极大的成功, 其主要思想是通过一个单词来预测其上下文出现的单词.启发于Skip-Gram模型, 本文提出基于滑动窗口的思想来将长度为<i>n</i><sub><i>i</i></sub>的序列<i>S</i><sub><i>i</i></sub>分解为多个短小的子序列, 即只保留域名和其窗口内域名的时空伴随关系, 而忽略其和更远位置的域名关系, 从而极大地降低了计算复杂度.本文假设:</p>
                </div>
                <div class="p1">
                    <p id="119"><i>P</i> (<i>S</i><sub><i>i</i></sub>) ∝<mathml id="120"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mstyle displaystyle="true"><munderover><mo>∏</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>n</mi><msub><mrow></mrow><mi>i</mi></msub></mrow></munderover><mrow><mi>Ρ</mi><mi>r</mi></mrow></mstyle><mo stretchy="false"> (</mo><mi>C</mi><mo stretchy="false"> (</mo><mi>d</mi><msub><mrow></mrow><mi>j</mi></msub><mo stretchy="false">) </mo><mo stretchy="false">) </mo><mo>=</mo><mstyle displaystyle="true"><munderover><mo>∏</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>n</mi><msub><mrow></mrow><mi>i</mi></msub></mrow></munderover><mrow></mrow></mstyle><mstyle displaystyle="true"><munder><mo>∏</mo><mrow><mi>c</mi><mo>∈</mo><mi>C</mi><mo stretchy="false"> (</mo><mi>d</mi><msub><mrow></mrow><mi>j</mi></msub><mo stretchy="false">) </mo></mrow></munder><mrow></mrow></mstyle></mrow></math></mathml><i>p</i> (<i>d</i><sub><i>j</i></sub>, <i>c</i>) , (2) </p>
                </div>
                <div class="p1">
                    <p id="121">其中, <i>C</i> (<i>d</i><sub><i>j</i></sub>) 为域名<i>d</i><sub><i>j</i></sub>的上下文.假设窗口大小为<i>w</i>, 则<i>C</i> (<i>d</i><sub><i>j</i></sub>) = (<i>d</i><sub><i>j</i>-<i>w</i></sub>, <i>d</i><sub><i>j</i>-<i>w</i>+1</sub>, …, <i>d</i><sub><i>j</i>-1</sub>, <i>d</i><sub><i>j</i>+1</sub>, <i>d</i><sub><i>j</i>+2</sub>, …, <i>d</i><sub><i>j</i>+<i>w</i></sub>) , 更进一步分解为2<i>w</i>组具有时空伴随关系的域名对{ (<i>d</i><sub><i>j</i></sub>, <i>d</i><sub><i>j</i>-<i>w</i></sub>) , (<i>d</i><sub><i>j</i></sub>, <i>d</i><sub><i>j</i>-<i>w</i>+1</sub>) , …, (<i>d</i><sub><i>j</i></sub>, <i>d</i><sub><i>j</i>-1</sub>) , (<i>d</i><sub><i>j</i></sub>, <i>d</i><sub><i>j</i>+1</sub>) , (<i>d</i><sub><i>j</i></sub>, <i>d</i><sub><i>j</i>+2</sub>) , …, (<i>d</i><sub><i>j</i></sub>, <i>d</i><sub><i>j</i>+<i>w</i></sub>) }.</p>
                </div>
                <div class="p1">
                    <p id="122">图4展示了利用滑动窗口从时空伴随序列<i>S</i>生成时空伴随域名对的示意图, 其中该序列<i>S</i>是由7个域名组成, 滑动窗口<i>w</i>=2.采用滑动窗口的方式将时空伴随域名序列分解成时空伴随域名对的操作能够带来2点改进:1) 滑动窗口的引入成功地消除了由于序列长度过长而带来的计算复杂度增长的问题, 使得在现实中计算成为了可能;2) 滑动窗口能够有效地减少噪声伴随关联 (将本身不具有时空伴随的域名错误地认为具有时空伴随关系) .窗口滑动的方式保证了每一个域名只和其固定窗口大小内的域名具有伴随关系, 保证了域名伴随关系的质量.</p>
                </div>
                <div class="area_img" id="123">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JFYZ201906014_123.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4vMkp4azg1TUxGcERuK01CZG1GRT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图4 基于滑动窗口 (w=2) 的时空相似域名对生成示意图" src="Detail/GetImg?filename=images/JFYZ201906014_123.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4vMkp4azg1TUxGcERuK01CZG1GRT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图4 基于滑动窗口 (<i>w</i>=2) 的时空相似域名对生成示意图  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JFYZ201906014_123.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4vMkp4azg1TUxGcERuK01CZG1GRT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit">Fig. 4 An illustration for generating co-occurring  domain pairs (<i>w</i>=2) </p>

                </div>
                <div class="p1">
                    <p id="124">基于以上改进操作, 优化目标函数式 (2) 为</p>
                </div>
                <div class="p1">
                    <p id="125" class="code-formula">
                        <mathml id="125"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtable columnalign="left"><mtr><mtd><mrow><mi>log</mi></mrow><mtext> </mtext><mi>Ρ</mi><mo stretchy="false"> (</mo><mi>S</mi><mo stretchy="false">) </mo><mo>∝</mo><mstyle displaystyle="true"><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow><mstyle displaystyle="true"><munder><mo>∑</mo><mrow><mi>d</mi><mo>∈</mo><mi>S</mi><msub><mrow></mrow><mi>i</mi></msub></mrow></munder><mrow><mi>log</mi></mrow></mstyle></mrow></mstyle><mo stretchy="false">[</mo><mrow><mi>Ρ</mi><mi>r</mi></mrow><mo stretchy="false"> (</mo><mi>C</mi><mo stretchy="false"> (</mo><mi>d</mi><mo stretchy="false">) </mo><mo stretchy="false">) </mo><mo stretchy="false">]</mo><mo>=</mo></mtd></mtr><mtr><mtd><mstyle displaystyle="true"><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow><mstyle displaystyle="true"><munder><mo>∑</mo><mrow><mi>d</mi><mo>∈</mo><mi>S</mi><msub><mrow></mrow><mi>i</mi></msub></mrow></munder><mrow><mstyle displaystyle="true"><munder><mo>∑</mo><mrow><mi>c</mi><mo>∈</mo><mi>C</mi><mo stretchy="false"> (</mo><mi>d</mi><mo stretchy="false">) </mo></mrow></munder><mrow><mi>log</mi></mrow></mstyle></mrow></mstyle></mrow></mstyle><mtext> </mtext><mi>p</mi><mo stretchy="false"> (</mo><mi>d</mi><mo>, </mo><mi>c</mi><mo stretchy="false">) </mo><mo>=</mo></mtd></mtr><mtr><mtd><mstyle displaystyle="true"><munder><mo>∑</mo><mrow><mo stretchy="false"> (</mo><mi>d</mi><msub><mrow></mrow><mi>i</mi></msub><mo>, </mo><mi>d</mi><msub><mrow></mrow><mi>j</mi></msub><mo stretchy="false">) </mo><mo>∈</mo><mtext>Ρ</mtext></mrow></munder><mrow><mi>log</mi></mrow></mstyle><mtext> </mtext><mi>p</mi><mo stretchy="false"> (</mo><mi>d</mi><msub><mrow></mrow><mi>i</mi></msub><mo>, </mo><mi>d</mi><msub><mrow></mrow><mi>j</mi></msub><mo stretchy="false">) </mo><mo>, </mo><mrow><mtext> </mtext><mtext> </mtext><mtext> </mtext></mrow><mo stretchy="false"> (</mo><mn>3</mn><mo stretchy="false">) </mo></mtd></mtr></mtable></math></mathml>
                    </p>
                </div>
                <div class="p1">
                    <p id="126">其中, P为基于滑动窗口操作提取的所有具有时空伴随关系的域名对集合.</p>
                </div>
                <div class="p1">
                    <p id="127">假设<i>f</i>:<i>D</i>→R<sup><i>d</i></sup>为映射函数, 将每一个域名<i>d</i><sub><i>i</i></sub>∈<i>D</i>投影成实数空间R<sup><i>d</i></sup>中的一个向量<b><i>v</i></b><sub><i>i</i></sub>.本文采用Sigmoid函数来衡量这2个域名<i>d</i><sub><i>i</i></sub>和<i>d</i><sub><i>j</i></sub>的联合概率, 即</p>
                </div>
                <div class="p1">
                    <p id="128"><mathml id="129"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>p</mi><mo stretchy="false"> (</mo><mi>d</mi><msub><mrow></mrow><mi>i</mi></msub><mo>, </mo><mi>d</mi><msub><mrow></mrow><mi>j</mi></msub><mo stretchy="false">) </mo><mo>=</mo><mi>S</mi><mi>i</mi><mi>g</mi><mi>m</mi><mi>o</mi><mi>i</mi><mi>d</mi><mo stretchy="false"> (</mo><mi mathvariant="bold-italic">v</mi><msubsup><mrow></mrow><mi>i</mi><mtext>Τ</mtext></msubsup><mi mathvariant="bold-italic">v</mi><msub><mrow></mrow><mi>j</mi></msub><mo stretchy="false">) </mo><mo>=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><mi>exp</mi><mo stretchy="false"> (</mo><mo>-</mo><mi mathvariant="bold-italic">v</mi><msubsup><mrow></mrow><mi>i</mi><mtext>Τ</mtext></msubsup><mi mathvariant="bold-italic">v</mi><msub><mrow></mrow><mi>j</mi></msub><mo stretchy="false">) </mo></mrow></mfrac></mrow></math></mathml>. (4) </p>
                </div>
                <div class="p1">
                    <p id="130">更进一步, 由于式 (3) 中只考虑了具有时空伴随关系的域名对之间的映射关系, 而忽略了将不具有时空伴随关系的域名投影成R<sup><i>d</i></sup>空间中距离较远的向量, 因此一个通用的映射方式是将全部域名映射到一个点上.为此, 本文采用负采样技术<citation id="288" type="reference"><link href="235" rel="bibliography" /><sup>[<a class="sup">8</a>]</sup></citation>构建不具有时空伴随关系的域名对, 并最小化这部分域名对的联合概率.所以, 最终本文的目标函数是:</p>
                </div>
                <div class="p1">
                    <p id="131" class="code-formula">
                        <mathml id="131"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtable columnalign="left"><mtr><mtd><mrow><mi>min</mi></mrow><mo stretchy="false">[</mo><mo>-</mo><mstyle displaystyle="true"><munder><mo>∑</mo><mrow><mo stretchy="false"> (</mo><mi>d</mi><msub><mrow></mrow><mi>i</mi></msub><mo>, </mo><mi>d</mi><msub><mrow></mrow><mi>j</mi></msub><mo stretchy="false">) </mo><mo>∈</mo><mtext>Ρ</mtext></mrow></munder><mrow><mi>log</mi></mrow></mstyle><mtext> </mtext><mi>p</mi><mo stretchy="false"> (</mo><mi>d</mi><msub><mrow></mrow><mi>i</mi></msub><mo>, </mo><mi>d</mi><msub><mrow></mrow><mi>j</mi></msub><mo stretchy="false">) </mo><mo>+</mo></mtd></mtr><mtr><mtd><mstyle displaystyle="true"><munder><mo>∑</mo><mrow><mo stretchy="false"> (</mo><mi>d</mi><msub><mrow></mrow><mi>i</mi></msub><mo>, </mo><mi>d</mi><msub><mrow></mrow><mi>j</mi></msub><mo stretchy="false">) </mo><mo>∈</mo><mtext>Ν</mtext></mrow></munder><mrow><mi>log</mi></mrow></mstyle><mtext> </mtext><mi>p</mi><mo stretchy="false"> (</mo><mi>d</mi><msub><mrow></mrow><mi>i</mi></msub><mo>, </mo><mi>d</mi><msub><mrow></mrow><mi>j</mi></msub><mo stretchy="false">) </mo><mo stretchy="false">]</mo><mo>, </mo><mrow><mtext> </mtext><mtext> </mtext><mtext> </mtext></mrow><mo stretchy="false"> (</mo><mn>5</mn><mo stretchy="false">) </mo></mtd></mtr></mtable></math></mathml>
                    </p>
                </div>
                <div class="p1">
                    <p id="132">其中, P是所有具有时空伴随关系的域名对集合, N是通过负采样技术生成的不具有时空伴随关系的域名对集合.本文通过随机梯度下降 (stochastic gradient descent, SGD) <citation id="289" type="reference"><link href="251" rel="bibliography" /><sup>[<a class="sup">16</a>]</sup></citation>算法来最小化目标函数.迭代结束之后, 本文便得到每个域名<i>d</i><sub><i>i</i></sub>在R<sup><i>d</i></sup>空间中的特征向量<b><i>v</i></b><sub><i>i</i></sub>.</p>
                </div>
                <h4 class="anchor-tag" id="133" name="133"><b>2.3 恶意域名检测模块</b></h4>
                <div class="p1">
                    <p id="134">通过最小化式 (5) , 本文将<i>S</i>中每个域名表达成<i>d</i>维空间的特征向量.本文通过提前采集的黑白域名列表匹配 <i>S</i>中的域名, 从而获取部分有标签的数据, 再结合机器学习分类算法构建恶意域名检测分类器, 用于检测未知的恶意域名.</p>
                </div>
                <h4 class="anchor-tag" id="135" name="135">2.3.1 训练阶段</h4>
                <div class="p1">
                    <p id="136">结合域名黑白名单, 匹配数据集中出现的域名, 本文获得部分标记的恶意域名和正常域名.利用成熟的有监督的机器学习分类算法 (如随机森林) , 结合这部分域名在特征学习阶段学习到的特征向量, 最终得到恶意域名检测分类器<i>π</i>:<b><i>v</i></b>→<i>s</i>, 其中<b><i>v</i></b>为域名对应的特征向量, <i>s</i>∈[0, 1]为该域名的恶意打分.</p>
                </div>
                <h4 class="anchor-tag" id="137" name="137">2.3.2 检测阶段</h4>
                <div class="p1">
                    <p id="138">针对其余部分未知属性的域名, 本文利用训练阶段学习的分类器进行分类, 从而检测未知的恶意域名.对于域名待检测域名<i>d</i><sub><i>i</i></sub>, 假设其在特征学习阶段对应的特征向量为<b><i>v</i></b><sub><i>i</i></sub>, 则其恶意打分为<i>s</i><sub><i>i</i></sub>=<i>π</i> (<b><i>v</i></b><sub><i>i</i></sub>) .如果<i>s</i><sub><i>i</i></sub>&gt;0.5, 则判定域名<i>d</i><sub><i>i</i></sub>为恶意域名, 其分数越高, 则代表域名<i>d</i><sub><i>i</i></sub>为恶意域名的可能性越大.</p>
                </div>
                <h4 class="anchor-tag" id="139" name="139"><b>2.4 模型时间复杂度分析</b></h4>
                <div class="p1">
                    <p id="140">CoDetector共分为3个阶段.</p>
                </div>
                <div class="p1">
                    <p id="141">阶段1. 将DNS流量切割, 按照采集到的DNS的先后顺序根据时间便可以切割, 因此时间复杂度为<i>O</i> (<i>n</i>) , 其中<i>n</i>是DNS流量中域名请求的数量.</p>
                </div>
                <div class="p1">
                    <p id="142">阶段2. 可以细分为3个部分:</p>
                </div>
                <div class="p1">
                    <p id="143">1) 利用滑动窗口的方式生成时空伴随域名对, 针对每一个域名, 最多形成2<i>w</i>个伴随域名对, 因此, 本文最多共有2<i>wn</i>个域名对, 且时间复杂度为2<i>w</i>×<i>O</i> (<i>n</i>) .</p>
                </div>
                <div class="p1">
                    <p id="144">2) 利用负采样技术生成和正样本同数量级的负样本, 假设针对每一个域名通过随机的方式 (如Hash采样) 生成<i>K</i>个负样本 (本文中<i>K</i>=5) , 因此, 最多有2<i>Kwn</i>个负样本域名对, 且时间复杂度为<i>K</i>×2<i>w</i>×<i>O</i> (<i>n</i>) .</p>
                </div>
                <div class="p1">
                    <p id="145">3) 式 (5) 可以分解为对每一个时空伴随域名对进行优化调整.结合正负样本, 最多有2<i>w</i>× (<i>K</i>+1) ×<i>n</i>个域名对.针对每一个时空伴随域名对优化迭代一次的复杂度为<i>d</i>, 假设迭代<i>M</i>次, 那么式 (3) 最终的复杂度为<i>M</i>×2<i>w</i>× (<i>K</i>+1) ×<i>d</i>×<i>O</i> (<i>n</i>) .</p>
                </div>
                <div class="p1">
                    <p id="146">由于<i>M</i>, <i>K</i>, <i>w</i>, <i>d</i>均远小于<i>n</i>, 因此第2阶段的时间复杂度为<i>O</i> (<i>n</i>) .</p>
                </div>
                <div class="p1">
                    <p id="147">阶段3. 利用已知的黑白域名和其在R<sup><i>d</i></sup>空间的特征向量来训练模型分类器.其复杂度与分类器算法的选取和黑白域名的样本数量有关系.例如, 本文选择随机森林算法作为分类器算法, 共<i>m</i>棵树, 训练样本数量为<i>N</i>, 则复杂度为<i>O</i> (<i>m</i>×<i>d</i>×<i>N</i> log <i>N</i>) , 由于<i>N</i>为训练样本数量, 相对于全部域名数量<i>n</i>是很少的一部分, 因此这部分的复杂度相对于第1阶段和第2阶段均为常数.</p>
                </div>
                <div class="p1">
                    <p id="148">因此, CoDetector模型的计算量主要集中在第1阶段和第2阶段中, 综合起来复杂度为<i>O</i> (<i>n</i>) , 其中<i>n</i>是DNS流量中域名请求的数目.</p>
                </div>
                <h3 id="149" name="149" class="anchor-tag"><b>3 实  验</b></h3>
                <h4 class="anchor-tag" id="150" name="150"><b>3.1 数据集</b></h4>
                <div class="p1">
                    <p id="151">1) 域名黑名单.本文通过采集网络公开的黑名单列表来构建本文中的域名黑名单, 其中包括Malware Domains List<citation id="290" type="reference"><link href="253" rel="bibliography" /><sup>[<a class="sup">17</a>]</sup></citation>, Phishtank<citation id="291" type="reference"><link href="255" rel="bibliography" /><sup>[<a class="sup">18</a>]</sup></citation>, Openphish<citation id="292" type="reference"><link href="257" rel="bibliography" /><sup>[<a class="sup">19</a>]</sup></citation>, AbuseList<citation id="293" type="reference"><link href="259" rel="bibliography" /><sup>[<a class="sup">20</a>]</sup></citation>.本文从2017-01-03—2017-10-14, 持续不断地收集这些来源的黑名单, 最后保留去重的域名列表.除此之外, 本文还采集了宙斯 (Zeus) 病毒中使用的恶意域名和著名的蠕虫病毒飞客 (conficker) <citation id="294" type="reference"><link href="261" rel="bibliography" /><sup>[<a class="sup">21</a>]</sup></citation>中通过DGA算法生成的恶意域名.这些黑名单列表包含了形式多样的恶意域名, 如僵尸网络命令与控制通道的域名、偷渡式下载域名、网络钓鱼、垃圾邮件、网络诈骗勒索等域名, 能够很好地覆盖各种不同类型的网络攻击.更进一步, 为了保证本文中使用的黑名单列表的可靠性, 本文采用Google Safe Browsing<citation id="295" type="reference"><link href="263" rel="bibliography" /><sup>[<a class="sup">22</a>]</sup></citation>来进一步针对从Phishtank和Openphish采集到的域名做2次筛选, 只有当Google Safe Browsing也认为该域名是恶意域名, 本文才将该域名保留.</p>
                </div>
                <div class="p1">
                    <p id="152">2) 域名白名单.本文根据Alexa<citation id="296" type="reference"><link href="265" rel="bibliography" /><sup>[<a class="sup">23</a>]</sup></citation>每天提供的全球访问量最多的100万域名 (例如google.com) 列表来构建本文的白名单域名列表.本文筛选那些长时间 (如1年) 持续排名在Alexa Top 20000的域名作为本文的正常域名.通过持续排名的条件可以有效地删除噪声域名, 例如僵尸网络的域名在攻击活动发生时会存在短暂的访问量爆发, 从而有可能出现在Top 20000列表中.实验中, 本文收集了2015-01-16—2017-03-05共计513天的Alexa Top 100万域名列表, 本文共发现9216个域名持续地出现在这513天的Top 20000域名中.</p>
                </div>
                <div class="p1">
                    <p id="153">3) DNS数据.本文中使用的DNS数据集是在一个企业网内部网关捕获的2个月 (2017-10-13—2017-12-18) 的DNS流量, 其中共包含12 291 055条DNS请求数据包.表1列举了本文的实验数据, 其中包括采用基于时空时间的切割算法生成的时空伴随域名序数目、基于滑动窗口生成的时空伴随域名对数目, 以及匹配到的正常域名和恶意域名的数目.</p>
                </div>
                <div class="area_img" id="154">
                    <p class="img_tit"><b>表1 实验数据描述</b> <a class="downexcel" onclick="DownLoadReportExcel(this)">导出到EXCEL</a></p>
                    <p class="img_tit"><b>Table 1 Description of Experimental Data</b></p>
                    <p class="img_note"></p>
                    <table id="154" border="1"><tr><td><i>τ</i></td><td><i>w</i></td><td>Co-occurring<br />Domain Sequences</td><td>Co-occurring<br />Domain Pairs</td><td>Malicious<br />Domains</td><td>Benign<br />Domains</td></tr><tr><td>2</td><td>1</td><td>1 490 994</td><td>4 862 854</td><td>9 445</td><td>3 036</td></tr><tr><td><br />2</td><td>2</td><td>1 490 994</td><td>7 470 464</td><td>9 447</td><td>3 036</td></tr><tr><td><br />2</td><td>3</td><td>1 490 994</td><td>9 822 889</td><td>9 447</td><td>3 036</td></tr><tr><td><br />3</td><td>1</td><td>1 414 711</td><td>5 029 952</td><td>9 445</td><td>3 048</td></tr><tr><td><br />3</td><td>2</td><td>1 414 711</td><td>7 724 753</td><td>9 457</td><td>3 048</td></tr><tr><td><br />3</td><td>3</td><td>1 414 711</td><td>10 161 202</td><td>9 457</td><td>3 048</td></tr><tr><td><br />5</td><td>1</td><td>1 311 523</td><td>5 236 281</td><td>9 458</td><td>3 059</td></tr><tr><td><br />5</td><td>2</td><td>1 311 523</td><td>8 042 945</td><td>9 460</td><td>3 059</td></tr><tr><td><br />5</td><td>3</td><td>1 311 523</td><td>10 589 250</td><td>9 460</td><td>3 059</td></tr></table>
                    <form name="form" action="/kxreader/Detail/DownloadReportExcel" method="POST" style="display:inline">
                        <input type="hidden" name="hidTable" value="" />
                        <input type="hidden" name="hidFileName" value="" />
                    </form>
                    <p class="img_note"></p>
                    <p class="img_note"></p>
                </div>
                <h4 class="anchor-tag" id="155" name="155"><b>3.2 评价指标</b></h4>
                <div class="p1">
                    <p id="156">为了定量化地衡量CoDetector模型对恶意域名检测的效果, 本文采用3个指标.</p>
                </div>
                <div class="p1">
                    <p id="157">1) 召回率 (Recall, <i>R</i>) .测试集中所有的恶意域名样本, CoDetector能成功识别出恶意域名的比例.</p>
                </div>
                <div class="p1">
                    <p id="158">2) 检测精度 (Precision, <i>P</i>) .在测试集数据中, CoDetector判定为恶意域名的样本中确实是恶意域名的比例.</p>
                </div>
                <div class="p1">
                    <p id="159">3) <i>F</i>-值 (<i>F</i>-Measure, <i>F</i>) .<i>F</i>-值是召回率和精度这2个指标综合形成的指标, 能有效地权衡这2个指标.其中<mathml id="160"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>F</mi><mo>=</mo><mn>2</mn><mo>×</mo><mfrac><mrow><mi>R</mi><mo>×</mo><mi>Ρ</mi></mrow><mrow><mi>R</mi><mo>+</mo><mi>Ρ</mi></mrow></mfrac><mo>, </mo><mi>F</mi><mo>-</mo></mrow></math></mathml>值越大, 则代表模型整体检测效果越好.</p>
                </div>
                <h4 class="anchor-tag" id="161" name="161"><b>3.3 域名伴随关系分析</b></h4>
                <div class="p1">
                    <p id="162">CoDetector模型的基本前提是域名请求之间具有时空伴随关联关系, 即在用户层的DNS数据中域名请求的时间顺序并非完全随机分布, 而是存在伴随关系.给定域名全体集合<i>X</i>, 本文称<i>φ</i><sub><i>d</i></sub>为域名<i>d</i>的伴随分布, 即伴随<i>d</i>同时出现的域名 (在<i>d</i>窗口为<i>w</i>内的域名) 分布.如果<i>d</i>在DNS请求上具备伴随关系, 则<i>φ</i><sub><i>d</i></sub>在<i>X</i>上应为非均匀分布, 随机性差;反之应近似为均匀分布, 随机性强.本文采用香农熵来衡量一个分布函数的随机性.给定一个密度分布函数<i>p</i> (<i>x</i>) , 则其香农熵<i>H</i> (<i>p</i>) =-<mathml id="163"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mstyle displaystyle="true"><munder><mo>∑</mo><mi>x</mi></munder><mrow></mrow></mstyle></mrow></math></mathml><i>p</i> (<i>x</i>) lb <i>p</i> (<i>x</i>) .<i>H</i> (<i>p</i>) 越大, 代表分布函数<i>p</i> (<i>x</i>) 分布越均匀;反之代表<i>p</i> (<i>x</i>) 分布存在偏向性.针对采集的真实DNS数据, 为保证统计的有效性和降低计算规模, 本文统计出现次数在1 000次以上的域名, 共计1 315个域名, 其香农熵统计特征如表2所示:</p>
                </div>
                <div class="area_img" id="164">
                    <p class="img_tit"><b>表2 不同参数下的香农熵统计结果</b> <a class="downexcel" onclick="DownLoadReportExcel(this)">导出到EXCEL</a></p>
                    <p class="img_tit"><b>Table 2 Statistic Results of Shannon Entropy Under Different Parameters</b></p>
                    <p class="img_note"></p>
                    <table id="164" border="1"><tr><td><br /><i>τ</i></td><td><i>w</i></td><td>Mean</td><td>Std</td><td>Min</td><td>Max</td></tr><tr><td><br />2</td><td>1</td><td>4.98</td><td>1.45</td><td>0</td><td>8.21</td></tr><tr><td><br />2</td><td>2</td><td>5.22</td><td>1.42</td><td>0</td><td>8.23</td></tr><tr><td><br />2</td><td>3</td><td>5.39</td><td>1.4</td><td>0</td><td>8.36</td></tr><tr><td><br />3</td><td>1</td><td>5.09</td><td>1.44</td><td>0</td><td>8.29</td></tr><tr><td><br />3</td><td>2</td><td>5.34</td><td>1.4</td><td>0</td><td>8.33</td></tr><tr><td><br />3</td><td>3</td><td>5.52</td><td>1.38</td><td>0</td><td>8.4</td></tr><tr><td><br />5</td><td>1</td><td>5.23</td><td>1.42</td><td>0</td><td>8.35</td></tr><tr><td><br />5</td><td>2</td><td>5.5</td><td>1.38</td><td>0</td><td>8.43</td></tr><tr><td><br />5</td><td>3</td><td>5.69</td><td>1.35</td><td>0</td><td>8.45</td></tr></table>
                    <form name="form" action="/kxreader/Detail/DownloadReportExcel" method="POST" style="display:inline">
                        <input type="hidden" name="hidTable" value="" />
                        <input type="hidden" name="hidFileName" value="" />
                    </form>
                    <p class="img_note"></p>
                    <p class="img_note"></p>
                </div>
                <div class="p1">
                    <p id="165">表2列举了这1 315个域名在不同切割时间间隔<i>τ</i>={2 s, 3 s, 5 s}和不同窗口大小<i>w</i>={1, 2, 3}下生成的伴随分布及其对应的香农熵统计特征.注意到如果伴随分布是安全随机的, 则伴随分布的香农熵应该为lb 1 315=10.36.第1列代表时间间隔<i>τ</i>和窗口大小<i>w</i>的选择, 第2～5列列举了在该组参数下1 315个域名香农熵的统计特征 (平均值、标准差、最小值和最大值) .</p>
                </div>
                <div class="p1">
                    <p id="166">在这9组参数下, 这1 315个域名的香农熵均远小于10.36, 其中平均值不到10.36的一半, 最大值约为10.36的80%.数据结果表明:域名的伴随分布并不是均匀分布, 而是存在偏向性.因此验证了用户层域名请求之间具有时空伴随关联关系.</p>
                </div>
                <h4 class="anchor-tag" id="167" name="167"><b>3.4 模型假设验证</b></h4>
                <div class="p1">
                    <p id="168">CoDetector模型的基本假设是具有时空伴随关系的域名之间具有强关联, 偏向同时属于恶意域名或者正常域名, 即同态性.实验中, 本文首先利用采集到DNS流量对模型假设的合理性进行验证.本文主要从2个方面进行验证:1) 在包含恶意域名的时空伴随域名序列中, 其他域名是否更加偏向于是恶意域名;2) 在滑动窗口生成的时空伴随域名对中, 如果一个域名是恶意域名, 另外一个域名是否偏向于是恶意域名.注意本文只对和恶意域名伴随出现的域名的性质分布进行统计来评估同态性.因为本文的主要目的是为了检测恶意域名.</p>
                </div>
                <h4 class="anchor-tag" id="169" name="169">3.4.1 时空伴随域名序列同态性验证</h4>
                <div class="p1">
                    <p id="170">给定切割时间间隔<i>τ</i>, 本文将原始DNS流量切割成具有时空伴随关系的域名序列集合<i>S</i>.利用采集到的域名黑名单, 本文标定序列中每一个域名是否是恶意域名.本文定义<i>q</i> (<i>S</i>) 为序列<i>S</i>中恶意域名的个数, 记<i>S</i><sup><i>n</i></sup>={<i>S</i>|<i>q</i> (<i>S</i>) ≥<i>n</i>, <i>S</i>∈<i>S</i>}, 为<i>S</i>中包含恶意域名个数大于等于<i>n</i>的序列子集合.本文记包含恶意域名的时空伴随域名序列为可疑时空伴随域名序列.统计集合<i>S</i><sup><i>n</i></sup> (<i>n</i>≥1) 中, 恶意域名所占的比例为<i>δ</i>, 如果<i>δ</i>&gt;0.5则说明在<i>S</i><sup><i>n</i></sup>中的域名更多的是恶意域名, 从而验证假设.选择3种不同的时间间隔<i>τ</i>={2 s, 3 s, 5 s}生成时空伴随的域名序列集合, 并针对4种粒度的包含恶意域名的时空伴随域名序列子集, <i>n</i>={1, 2, 3, 4}统计恶意域名所占的比例<i>δ</i>.</p>
                </div>
                <div class="p1">
                    <p id="171">图5展示了包含恶意域名的时空伴随域名序列中恶意域名所占的整体比例<i>δ</i>, 其中横坐标代表<i>S</i>中的不同子集<i>S</i><sup>1</sup>, <i>S</i><sup>2</sup>, <i>S</i><sup>3</sup>, <i>S</i><sup>4</sup>.首先, 注意到所有子集中恶意域名比例均大于50%, 且使用相对较小的时间间隔<i>τ</i>切割生成的时空伴随域名序列中恶意域名所含比例越高.另一方面, 结果表明随着序列中包含的恶意域名数目增加, 序列在整体上是恶意序列的概率也在变大.</p>
                </div>
                <div class="area_img" id="172">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JFYZ201906014_172.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4vMkp4azg1TUxGcERuK01CZG1GRT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图5 伴随域名序列中恶意属性同态比例" src="Detail/GetImg?filename=images/JFYZ201906014_172.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4vMkp4azg1TUxGcERuK01CZG1GRT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图5 伴随域名序列中恶意属性同态比例  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JFYZ201906014_172.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4vMkp4azg1TUxGcERuK01CZG1GRT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit">Fig. 5 Homomorphic ratio of malicious property in  co-occurrence domain sequences</p>

                </div>
                <h4 class="anchor-tag" id="173" name="173">3.4.2 时空伴随域名对同态性验证</h4>
                <div class="p1">
                    <p id="174">基于滑动窗口的方式, 本文从时空伴随域名序列集合<i>S</i>生成时空伴随域名对集合P.针对集合P中每一个域名对 (<i>d</i><sub><i>i</i></sub>, <i>d</i><sub><i>j</i></sub>) , 本文统计当域名<i>d</i><sub><i>i</i></sub>是恶意域名时<i>d</i><sub><i>j</i></sub>同样是恶意域名的比例<i>δ</i>.实验中, 本文选择时间间隔参数<i>τ</i>={2 s, 3 s, 5 s}, 滑动窗口大小<i>w</i>={1, 2, 3}, 针对生成的9个时空伴随域名对集合P分别计算<i>δ</i>.结果如图6所示, 其中横坐标<i>w</i>为滑动窗口的大小, 纵坐标为当域名对 (<i>d</i><sub><i>i</i></sub>, <i>d</i><sub><i>j</i></sub>) 同时是恶意域名的比例<i>δ</i>.</p>
                </div>
                <div class="area_img" id="175">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JFYZ201906014_175.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4vMkp4azg1TUxGcERuK01CZG1GRT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图6 伴随域名对中恶意属性同态比例" src="Detail/GetImg?filename=images/JFYZ201906014_175.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4vMkp4azg1TUxGcERuK01CZG1GRT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图6 伴随域名对中恶意属性同态比例  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JFYZ201906014_175.jpg&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4vMkp4azg1TUxGcERuK01CZG1GRT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit">Fig. 6 Homomorphic ratio of malicious property in  co-occurrence domain pairs</p>

                </div>
                <div class="p1">
                    <p id="176">本文发现:1) 在时空伴随域名对中, 如果一个域名是恶意域名, 另外一个域名也是恶意域名的比例平均为89.34%, 即域名在时空伴随域名对中同样保持同态性;2) 通过滑动窗口生成的时空相似域名对能够有效地提高域名之间的同态性.例如当<i>w</i>=1时, 如果<i>d</i><sub><i>i</i></sub>是恶意域名, <i>d</i><sub><i>j</i></sub>是恶意域名的概率高达88%, 且随着窗口<i>w</i>的变大, 同态性也有所提升.这一结果进一步验证了本文实验的假设, 即具有时空相似性的域名之间同时在域名性质上具有同态性.</p>
                </div>
                <h4 class="anchor-tag" id="177" name="177"><b>3.5 模型检测效果</b></h4>
                <div class="p1">
                    <p id="178">CoDetector模型涉及到3个主要参数:1) 序列切割时间间隔<i>τ</i>;2) 滑动窗口大小<i>w</i>;3) 每个域名的特征的维度<i>d</i>.实验中本文选取<i>τ</i>={2 s, 3 s, 5 s}, <i>w</i>={1, 2, 3}和<i>d</i>={100, 200, 300}, 共27种参数组合.针对每一组参数<i>θ</i>= (<i>τ</i>, <i>w</i>, <i>d</i>) , 本文采用标准的10-Fold交叉验证的方式来评估实验效果.首先, 本文将训练数据集随机平均地分为10份, 其中9份作为训练集, 剩下1份作为测试集, 获取在测试集上的检测效果.如此重复10次, 并将10次的平均结果作为这组参数的最终实验结果.本实验全部运行在一个具有8核Inter<sup>®</sup> Core<sup>TM</sup> I7-6700K CPU@4.00 GHz、内存为32 GB的服务器.</p>
                </div>
                <div class="p1">
                    <p id="179">本文选用3个主流的有监督的机器学习算法作为恶意域名检测的分类器.</p>
                </div>
                <div class="p1">
                    <p id="180">1) 随机森林 (RandomForest) .随机森林是通过集成学习的思想将多棵决策树集成的一种算法.本文利用scikit-learn<citation id="297" type="reference"><link href="267" rel="bibliography" /><sup>[<a class="sup">24</a>]</sup></citation>机器学习库来实现随机森林分类器.主要参数设定为:<i>n</i>_<i>estimator</i>=200, <i>min</i>_<i>samples</i>_<i>split</i>=11.其他参数默认.</p>
                </div>
                <div class="p1">
                    <p id="181">2) XGBoost.XGBoost<citation id="298" type="reference"><link href="269" rel="bibliography" /><sup>[<a class="sup">25</a>]</sup></citation>是一种面向基础的GradientBoosting算法的优化版本, 具有高效的运行效率、灵活性和可移植性.本文采用其公开的Python库来训练本文的分类器模型, 参数设置为<i>max</i>_<i>depth</i>=6和<i>num</i>_<i>boost</i>_<i>round</i>=100, 其他参数默认.</p>
                </div>
                <div class="p1">
                    <p id="182">3) 深度神经网络 (deep neural network, DNN) .本文构建了一个4层的深层感知机模型.第1层是输入层, 接受通过时空相似表达模块学习的向量;第2层是隐藏层1, 包含<i>nh</i><sub>1</sub>个神经元;第3层是隐藏层2, 包含<i>nh</i><sub>2</sub>个神经元;第4层是输出层, 输出1个2维的向量, 第1个元素代表是正常域名的概率, 第2个元素代表是恶意域名的概率.层与层之间采用全连接网络进行连接, 并采用<i>Relu</i>非线性激活函数来增加模型的非线性能力.最后1层本文采用<i>softmax</i>函数来对最终的结果进行归一化.本文结合人为经验设定<i>nh</i><sub>1</sub>=128和<i>nh</i><sub>2</sub>=64, 采用交叉熵损失<i>cross</i>_<i>entropy</i>函数来衡量模型的效果.最后, 本文通过随机梯度下降SGD<citation id="299" type="reference"><link href="251" rel="bibliography" /><sup>[<a class="sup">16</a>]</sup></citation>算法来最小化损失函数.</p>
                </div>
                <div class="p1">
                    <p id="183">表3列举了CoDetector模型在这27组参数设置下利用3种分类器算法在训练集数据上通过10-Fold交叉验证得到的检测效果.RandomForest平均能够达到93.97%的<i>F</i>-Measure、91.80%的精度和96.30%的召回率.XGBoost平均能够达到94.06%的<i>F</i>-Measure、91.41%的精度和96.90%的召回率.DNN平均能够达到93.85%的<i>F</i>-Measure、91.76%的精度和96.05%的召回率.因此, 在3种不同的分类算法下, CoDetector模型均能够有效地检测恶意域名.</p>
                </div>
                <div class="area_img" id="184">
                    <p class="img_tit"><b>表3 27组参数下CoDetector基于3种分类器算法10-fold 交叉验证的检测效果</b> <a class="downexcel" onclick="DownLoadReportExcel(this)">导出到EXCEL</a></p>
                    <p class="img_tit"><b>Table 3 Detail Performance of CoDetector under the 27 Parameter Settings Using 3 Classifiers with 10-fold Cross Validation</b></p>
                    <p class="img_note"></p>
                    <table id="184" border="1"><tr><td colspan="3"><br />Parameters</td><td colspan="3">RandomForest</td><td colspan="3">XGBoost</td><td colspan="3">DNN</td></tr><tr><td><br /><i>τ</i></td><td><i>w</i></td><td><i>d</i></td><td><i>P</i>/%</td><td><i>R</i>/%</td><td><i>F</i>/%</td><td><i>P</i>/%</td><td><i>R</i>/%</td><td><i>F</i>/%</td><td><i>P</i>/%</td><td><i>R</i>/%</td><td><i>F</i>/%</td></tr><tr><td><br />2</td><td>1</td><td>100</td><td>92.83</td><td>96.22</td><td>94.49</td><td>92.46</td><td>96.91</td><td>94.63</td><td>92.72</td><td>96.69</td><td>94.66</td></tr><tr><td><br />2</td><td>1</td><td>200</td><td>92.62</td><td>96.3</td><td>94.43</td><td>91.72</td><td>97.53</td><td>94.54</td><td>92.53</td><td>96.46</td><td>94.46</td></tr><tr><td><br />2</td><td>1</td><td>300</td><td>92.33</td><td>96.35</td><td>94.3</td><td>91.57</td><td>97.47</td><td>94.42</td><td>92.32</td><td>96.77</td><td>94.49</td></tr><tr><td><br />2</td><td>2</td><td>100</td><td>93.11</td><td>96.04</td><td>94.55</td><td>92.63</td><td>97.05</td><td>94.78</td><td>92.89</td><td>96.82</td><td>94.81</td></tr><tr><td><br />2</td><td>2</td><td>200</td><td>93.21</td><td>96.08</td><td>94.62</td><td>92.51</td><td>97.05</td><td>94.72</td><td>93.11</td><td>96.59</td><td>94.82</td></tr><tr><td><br />2</td><td>2</td><td>300</td><td>93.04</td><td>95.99</td><td>94.49</td><td>92.32</td><td>97.31</td><td>94.75</td><td>92.63</td><td>96.94</td><td>94.73</td></tr><tr><td><br />2</td><td>3</td><td>100</td><td>86.87</td><td>97.26</td><td>91.77</td><td>87.18</td><td>96.57</td><td>91.63</td><td>88.17</td><td>94.4</td><td>91.17</td></tr><tr><td><br />2</td><td>3</td><td>200</td><td>86.28</td><td>97.54</td><td>91.56</td><td>87.02</td><td>95.79</td><td>91.19</td><td>87.71</td><td>92.5</td><td>90.03</td></tr><tr><td><br />2</td><td>3</td><td>300</td><td>86.07</td><td>97.3</td><td>91.34</td><td>86.81</td><td>95.55</td><td>90.97</td><td>87.5</td><td>92.27</td><td>89.81</td></tr><tr><td><br />3</td><td>1</td><td>100</td><td>92.87</td><td>96.03</td><td>94.42</td><td>92.21</td><td>97.05</td><td>94.57</td><td>92.44</td><td>96.97</td><td>94.64</td></tr><tr><td><br />3</td><td>1</td><td>200</td><td>92.74</td><td>96.14</td><td>94.41</td><td>92</td><td>97.38</td><td>94.61</td><td>92.22</td><td>97.07</td><td>94.58</td></tr><tr><td><br />3</td><td>1</td><td>300</td><td>92.61</td><td>96.16</td><td>94.35</td><td>91.84</td><td>97.43</td><td>94.55</td><td>91.96</td><td>97.08</td><td>94.45</td></tr><tr><td><br />3</td><td>2</td><td>100</td><td>93.21</td><td>96.23</td><td>94.69</td><td>92.83</td><td>96.9</td><td>94.81</td><td>92.88</td><td>96.49</td><td>94.65</td></tr><tr><td><br />3</td><td>2</td><td>200</td><td>86.12</td><td>97.07</td><td>91.27</td><td>86.63</td><td>96.05</td><td>91.09</td><td>87.35</td><td>92.29</td><td>89.74</td></tr><tr><td><br />3</td><td>2</td><td>300</td><td>85.91</td><td>96.84</td><td>91.05</td><td>86.42</td><td>95.81</td><td>90.87</td><td>87.14</td><td>92.06</td><td>89.53</td></tr><tr><td><br />3</td><td>3</td><td>100</td><td>93.38</td><td>96.21</td><td>94.78</td><td>92.97</td><td>97.01</td><td>94.95</td><td>93.04</td><td>96.91</td><td>94.93</td></tr><tr><td><br />3</td><td>3</td><td>200</td><td>93.35</td><td>95.76</td><td>94.54</td><td>92.88</td><td>96.91</td><td>94.85</td><td>92.73</td><td>96.88</td><td>94.76</td></tr><tr><td><br />3</td><td>3</td><td>300</td><td>93.42</td><td>95.94</td><td>94.66</td><td>92.66</td><td>97.11</td><td>94.83</td><td>93.14</td><td>96.46</td><td>94.77</td></tr><tr><td><br />5</td><td>1</td><td>100</td><td>92.91</td><td>95.89</td><td>94.37</td><td>92.39</td><td>96.93</td><td>94.61</td><td>92.35</td><td>97.03</td><td>94.63</td></tr><tr><td><br />5</td><td>1</td><td>200</td><td>92.84</td><td>96.17</td><td>94.47</td><td>92.07</td><td>97.11</td><td>94.52</td><td>92.9</td><td>96.29</td><td>94.56</td></tr><tr><td><br />5</td><td>1</td><td>300</td><td>92.7</td><td>96.27</td><td>94.45</td><td>91.9</td><td>97.15</td><td>94.45</td><td>92.6</td><td>96.76</td><td>94.63</td></tr><tr><td><br />5</td><td>2</td><td>100</td><td>93.24</td><td>96.08</td><td>94.64</td><td>92.69</td><td>97.03</td><td>94.81</td><td>92.84</td><td>96.98</td><td>94.86</td></tr><tr><td><br />5</td><td>2</td><td>200</td><td>93.3</td><td>95.87</td><td>94.56</td><td>92.59</td><td>96.87</td><td>94.68</td><td>92.58</td><td>97.06</td><td>94.77</td></tr><tr><td><br />5</td><td>2</td><td>300</td><td>93.22</td><td>96.08</td><td>94.63</td><td>92.52</td><td>97.21</td><td>94.81</td><td>92.85</td><td>96.7</td><td>94.74</td></tr><tr><td><br />5</td><td>3</td><td>100</td><td>93.33</td><td>96.18</td><td>94.73</td><td>93.07</td><td>96.82</td><td>94.91</td><td>92.52</td><td>97.1</td><td>94.75</td></tr><tr><td><br />5</td><td>3</td><td>200</td><td>93.47</td><td>95.86</td><td>94.64</td><td>92.88</td><td>96.89</td><td>94.84</td><td>92.86</td><td>96.74</td><td>94.76</td></tr><tr><td><br />5</td><td>3</td><td>300</td><td>93.42</td><td>95.76</td><td>94.57</td><td>92.93</td><td>97.01</td><td>94.92</td><td>93.09</td><td>96.65</td><td>94.83</td></tr></table>
                    <form name="form" action="/kxreader/Detail/DownloadReportExcel" method="POST" style="display:inline">
                        <input type="hidden" name="hidTable" value="" />
                        <input type="hidden" name="hidFileName" value="" />
                    </form>
                    <p class="img_note"></p>
                    <p class="img_note"></p>
                </div>
                <h3 id="185" name="185" class="anchor-tag"><b>4 讨  论</b></h3>
                <div class="p1">
                    <p id="186">CoDetector通过挖掘域名请求之间的伴随关系来进行恶意域名判定.因此, 对本文的模型可能会存在的问题进行讨论.</p>
                </div>
                <div class="p1">
                    <p id="187">1) 噪声伴随.本文通过基于时间间隔的切割算法来获取具有时空伴随的域名序列, 然后通过滑动窗口的方式提取时空伴随域名对.其基本的原理是基于域名请求的先后时间顺序, 因此后台网络活动触发的DNS请求可能会和当前的网络活动触发的DNS请求在时间上存在重叠, 从而带来噪声干扰.然而, 噪声干扰是属于小概率事件, 通过长时间的数据累积, 即可逐渐消除噪声带来的影响.</p>
                </div>
                <div class="p1">
                    <p id="188">2) 攻击绕过.攻击者通过在其网络活动所必需的DNS请求中混杂其他非必需的DNS请求, 从而制造虚假伴随关联关系.例如, 在恶意网页中添加虚假外链, 链接到已知的正常网站 (如qq.com) , 从而制造其恶意域名和正常的域名伴随出现的假象.</p>
                </div>
                <div class="p1">
                    <p id="189">3) 检测时空.CoDetector只能检测当前时空下采集到的DNS流量中的恶意域名.对于未来出现的未知域名, 本文没有提前训练该域名的特征表示, CoDetector无法对其恶意性质进行判定.本文将在后续的工作中进行补充.</p>
                </div>
                <h3 id="190" name="190" class="anchor-tag"><b>5 结  论</b></h3>
                <div class="p1">
                    <p id="191">恶意域名是网络攻击活动中主要的基础设施.本文提出一种基于域名请求之间存在时空伴随关联的恶意域名检测算法, 想法是如果一个域名经常和恶意域名伴随出现, 那么该域名很大可能是恶意域名.本文首先提出基于时间间隔的时空伴随域名序列提取算法, 从原始DNS流量中提取具有时空伴随关系的域名, 接着采用深度学习算法将每一个域名映射为低维空间的特征向量, 最后结合分类算法训练模型分类器.实验结果表明:CoDetector模型能够有效地检测恶意域名, 具有91.64%的检测精度和96.04%的召回率.</p>
                </div>

        <!--brief end-->
        
        <!--conten left  end-->
        <!--增强附件-->
                        <h3 class="anchor-tag">作者图片</h3>
                <div class="anchor-wrap">
                        <p>
                                    <div class="anchor-box">
                                        <span class="anchor-a"><image id="304" type="formula" href="images/JFYZ201906014_30400.jpg" display="inline" placement="inline"><alt></alt></image></span>
                                        <span class="anchor-a">彭成维</span>
                                    </div>
                                    <div class="anchor-box">
                                        <span class="anchor-a"><image id="305" type="formula" href="images/JFYZ201906014_30500.jpg" display="inline" placement="inline"><alt></alt></image></span>
                                        <span class="anchor-a">云晓春</span>
                                    </div>
                                    <div class="anchor-box">
                                        <span class="anchor-a"><image id="306" type="formula" href="images/JFYZ201906014_30600.jpg" display="inline" placement="inline"><alt></alt></image></span>
                                        <span class="anchor-a">张永铮</span>
                                    </div>
                                    <div class="anchor-box">
                                        <span class="anchor-a"><image id="307" type="formula" href="images/JFYZ201906014_30700.jpg" display="inline" placement="inline"><alt></alt></image></span>
                                        <span class="anchor-a">李书豪</span>
                                    </div>
                        </p>
                </div>


        <!--reference start-->
            <div class="reference anchor-tag" id="a_bibliography">
                    <h3>参考文献</h3>
                                        <p id="221">
                            <a id="bibliography_1" target="_blank" href="http://scholar.cnki.net/result.aspx?q=A comprehensive measurement study of domain generating malware">

                                <b>[1]</b>Plohmann D, Yakdan K, Klatt M, et al.A comprehensive measurement study of domain generating malware[C]Proc of USENIX Security Symp.Berkeley, CA:USENIXAssociation, 2016:263-278
                            </a>
                        </p>
                        <p id="223">
                            <a id="bibliography_2" target="_blank" href="http://scholar.cnki.net/result.aspx?q=From throwaway traffic to bots:Detecting the rise of DGA-based malware">

                                <b>[2]</b>Antonakakis M, Perdisci R, Nadji Y, et al.From throwaway traffic to bots:Detecting the rise of DGA-based malware[C]Proc of the 21st USENIX Security Symp.Berkeley, CA:USENIX Association, 2012:491-506
                            </a>
                        </p>
                        <p id="225">
                            <a id="bibliography_3" target="_blank" href="http://scholar.cnki.net/result.aspx?q=The long&amp;quot;taile&amp;quot;of typosquatting domain names">

                                <b>[3]</b>Szurdi J, Kocso B, Cseh G, et al.The long“taile”of typosquatting domain names[C]Proc of the 23rd USENIXSecurity Symp.Berkeley, CA:USENIX Association, 2014:191-206
                            </a>
                        </p>
                        <p id="227">
                            <a id="bibliography_4" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Cisco 2016 annual security report[R/OL]">

                                <b>[4]</b>Cisco.Cisco 2016 annual security report[R/OL].2016[2018-06-28].http:www.cisco.com/c/m/en_us/offers/sc04/2016-annual-security-report/index.html
                            </a>
                        </p>
                        <p id="229">
                            <a id="bibliography_5" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Building a dynamic reputation system for DNS">

                                <b>[5]</b>Antonakakis M, Perdisci R, Dagon D, et al.Building a dynamic reputation system for DNS[C]Proc of the 19th USENIX Security Symp.Berkeley, CA:USENIXAssociation, 2010:273-290
                            </a>
                        </p>
                        <p id="231">
                            <a id="bibliography_6" target="_blank" href="/kcms/detail/detail.aspx?dbcode=SJCM&amp;filename=SJCM14061800001271&amp;v=MTI1NzhRPU5pZklZN0s4SHRmTnA0OUZaT3NPRG5zNG9CTVQ2VDRQUUgvaXJSZEdlcnFRVE1ud1plWnVIeWptVUx2SktGd1ZhQg==&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4vMkp4azg1TUxGcERuK01CZG1GRT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[6]</b>Bilge L, Sen S, Balzarotti D, et al.Exposure:A passive DNS analysis service to detect and report malicious domains[J].ACM Transactions on Information and System Security, 2014, 16 (4) :14
                            </a>
                        </p>
                        <p id="233">
                            <a id="bibliography_7" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Detecting Malware Domains at the U pper DNS Hierarchy">

                                <b>[7]</b>Antonakakis M, Perdisci R, Lee W, et al.Detecting malware domains at the upper DNS hierarchy[C]Proc of the 20th USENIX Security Symp.Berkeley, CA:USENIXAssociation, 2011 (11) :1-16
                            </a>
                        </p>
                        <p id="235">
                            <a id="bibliography_8" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Distributed representations of words and phrases and their compositionality">

                                <b>[8]</b>Mikolov T, Sutskever I, Chen Kai, et al.Distributed representations of words and phrases and their compositionality[C]Proc of Advances in Neural Information Processing Systems.Cambridge, MA:MIT Press, 2013:3111-3119
                            </a>
                        </p>
                        <p id="237">
                            <a id="bibliography_9" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Enriching word vectors with subword information">

                                <b>[9]</b>Bojanowski P, Grave E, Joulin A, et al.Enriching word vectors with subword information[J].arXiv preprint arXiv:1607.04606, 2016
                            </a>
                        </p>
                        <p id="239">
                            <a id="bibliography_10" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Discovering malicious domains through passive DNS data graph analysis">

                                <b>[10]</b>Khalil I, Yu Ting, Guan Bei.Discovering malicious domains through passive DNS data graph analysis[C]Proc of the11th ACM on Asia Conf on Computer and Communications Security.New York:ACM, 2016:663-674
                            </a>
                        </p>
                        <p id="241">
                            <a id="bibliography_11" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Discovering malicious domains through alias-canonical graph">

                                <b>[11]</b>Peng Chengwei, Yun Xiaochun, Zhang Yongzheng, et al.Discovering malicious domains through alias-canonical graph[C]Proc of the 16th IEEE Int Conf on Trust, Security and Privacy in Computing and Communications.Piscataway, NJ:IEEE, 2017:225-232
                            </a>
                        </p>
                        <p id="243">
                            <a id="bibliography_12" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Detecting malicious domains via graph inference">

                                <b>[12]</b>Manadhata P K, Yadav S, Rao P, et al.Detecting malicious domains via graph inference[G]LNCS 8712:Proc of European Symp on Research in Computer Security.Berlin:Springer, 2014:1-18
                            </a>
                        </p>
                        <p id="245">
                            <a id="bibliography_13" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Segugio:Efficient behavior-based tracking of malware-control domains in large ISP networks">

                                <b>[13]</b>Rahbarinia B, Perdisci R, Antonakakis M.Segugio:Efficient behavior-based tracking of malware-control domains in large ISP networks[C]Proc of the 45th Annual IEEE/IFIP Int Conf on Dependable Systems and Networks (DSN) .Piscataway, NJ:IEEE, 2015:403-414
                            </a>
                        </p>
                        <p id="247">
                            <a id="bibliography_14" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JFYZ201710020&amp;v=MzAyOTZVcjNPTHl2U2RMRzRIOWJOcjQ5SFpJUUtESDg0dlI0VDZqNTRPM3pxcUJ0R0ZyQ1VSTE9lWmVScUZpRG4=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4vMkp4azg1TUxGcERuK01CZG1GRT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[14]</b>Wang Xiaoqi, Li Qiang, Yan Guanghua, et al.Detection of covert and suspicious DNS behavior in advanced persistent threats[J].Journal of Computer Research and Development, 2017, 54 (10) :2334-2343 (in Chinese) (王晓琪, 李强, 闫广华, 等.高级持续性威胁中的隐蔽可以DNS行为的检测[J].计算机研究与发展, 2017, 54 (10) :2334-2343) 
                            </a>
                        </p>
                        <p id="249">
                            <a id="bibliography_15" target="_blank" href="/kcms/detail/detail.aspx?dbcode=SJCM&amp;filename=SJCM6FFEF32754D1D1E946B4CF60B8517702&amp;v=MTAzOTJ3cTQ9TmlmSVk3WE9hS1M2ckkxQ1llOTdEUWc0dWg4WDdFMTVPd25rckdBOWZMT1RRcnFkQ09OdkZTaVdXcjdKSUZwbWFCdUhZZk9HUWxmQ3BiUTM1TnhnekxxKw==&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4vMkp4azg1TUxGcERuK01CZG1GRT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[15]</b>Gao Hongyu, Yegneswaran V, Jiang Jian, et al.Reexamining DNS from a global recursive resolver perspective[J].IEEE/ACM Transactions on Networking, 2016, 24 (1) :43-57
                            </a>
                        </p>
                        <p id="251">
                            <a id="bibliography_16" target="_blank" href="/kcms/detail/detail.aspx?dbcode=SJST&amp;filename=SJST14112600631510&amp;v=MDM4NjlGd1ZhQlE9TmlmWWVySzhIOURPcVk5Rll1Z09DWDA1b0JNVDZUNFBRSC9pclJkR2VycVFUTW53WmVadUh5am1VTHZKSw==&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4vMkp4azg1TUxGcERuK01CZG1GRT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[16]</b>Kiefer J, Wolfowitz J.Stochastic estimation of the maximum of a regression function[J].The Annals of Mathematical Statistics, 1952, 23 (3) :462-466
                            </a>
                        </p>
                        <p id="253">
                            <a id="bibliography_17" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Malware domain blocklist by risk-analytics">

                                <b>[17]</b>DNS-BH.Malware domain blocklist by risk-analytics[EB/OL].[2017-01-03].http:www.malwaredomains.com
                            </a>
                        </p>
                        <p id="255">
                            <a id="bibliography_18" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Phishtank">

                                <b>[18]</b>OpenDNS.Phishtank[EB/OL].[2017-01-03].http:www.phishtank.com
                            </a>
                        </p>
                        <p id="257">
                            <a id="bibliography_19" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Timely,accurate,relevant threat intelligence">

                                <b>[19]</b>OpenPhish.Timely, accurate, relevant threat intelligence[EB/OL].[2017-01-03].https:openphish.com
                            </a>
                        </p>
                        <p id="259">
                            <a id="bibliography_20" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Ransomware tracker">

                                <b>[20]</b>AbuseList.Ransomware tracker[EB/OL].[2017-01-03].https:ransomwaretracker.abuse.ch
                            </a>
                        </p>
                        <p id="261">
                            <a id="bibliography_21" target="_blank" href="http://scholar.cnki.net/result.aspx?q=A foray into conficker&amp;#39;&amp;#39;s logic and rendezvous points">

                                <b>[21]</b>Porras P A, Sa6di H, Yegneswaran V.A foray into conficker's logic and rendezvous points[EB/OL].[2017-01-03].https:www.usenix.org/legacy/event/leet09/tech/full_papers/porras/porras_html/
                            </a>
                        </p>
                        <p id="263">
                            <a id="bibliography_22" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Google safe browsing">

                                <b>[22]</b>Google.Google safe browsing[EB/OL].[2017-10-14].https:www.google.com/transparencyreport/safebrowsing/
                            </a>
                        </p>
                        <p id="265">
                            <a id="bibliography_23" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Alexa top 1 million">

                                <b>[23]</b>Alexa.Alexa top 1 million[EB/OL].[2017-03-05].http:s3.amazonaws.com/alexa-static/top-1m.csv.zip
                            </a>
                        </p>
                        <p id="267">
                            <a id="bibliography_24" >
                                    <b>[24]</b>
                                Pedregosa F, Varoquaux G, Gramfort A, et al.Scikit-learn:Machine learning in python[J].Journal of Machine Learning Research, 2011 (12) :2825-2830
                            </a>
                        </p>
                        <p id="269">
                            <a id="bibliography_25" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Xgboost:A scalable tree boosting system">

                                <b>[25]</b>Chen Tianqi, Guestrin C.XGBoost:A scalable tree boosting system[C]Proc of the 22nd ACM SIGKDD Int Conf on Knowledge Discovery and Data Mining.New York:ACM, 2016:785-794
                            </a>
                        </p>
            </div>
        <!--reference end-->
        <!--footnote start-->
        <!--footnote end-->



    </div>

        <input id="fileid" type="hidden" value="JFYZ201906014" />
        <input id="dpi" type="hidden" value="300" />
    </div>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?6e967eb120601ea41b9d312166416aa6";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
</script>


    


<input id="hid_uid" name="hid_uid" type="hidden" value="WEEvREcwSlJHSldRa1Fhb09jT0lPUU4vMkp4azg1TUxGcERuK01CZG1GRT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
<input id="hid_kLogin_headerUrl" name="hid_kLogin_headerUrl" type="hidden" value="/KLogin/Request/GetKHeader.ashx%3Fcallback%3D%3F" />
<input id="hid_kLogin_footerUrl" name="hid_kLogin_footerUrl" type="hidden" value="/KLogin/Request/GetKFooter.ashx%3Fcallback%3D%3F" />
<div class="btn-link" style="display: none"><a target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JFYZ201906014&amp;v=MTgyMzlPTHl2U2RMRzRIOWpNcVk5RVlJUUtESDg0dlI0VDZqNTRPM3pxcUJ0R0ZyQ1VSTE9lWmVScUZpRG5VcjM=&amp;uid=WEEvREcwSlJHSldRa1Fhb09jT0lPUU4vMkp4azg1TUxGcERuK01CZG1GRT0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">知网节</a></div>
<div class="popflow" id="popupTips" style="display: none;">
    <div class="popflowArr"></div>
    <div class="popflowCot">
        <div class="hd"><a href="javascript:void(0);" onclick="$('#popupTips').hide();$('#popupmsg').html('')" class="close">X</a></div>
        <div class="bd">
            <p class="mes" id="popupmsg" name="popupmsg"></p>
          
        </div>
    </div>
</div>
<input type="hidden" id="myexport" value="//kns.cnki.net" />

<input type="hidden" id="KPCAPIPATH" value="//ishufang.cnki.net" />
<input type="hidden" id="CitedTimes" value="" />
<div class="link" id="GLSearch" style="display: none;">
    <i class="icon-trangle"></i>
    <div class="inner">
        <a class="icon" id="copytext">复制</a>
        <a class="icon" target="_blank" onclick="searchCRFD(this)">工具书搜索</a>
    </div>
</div>




<input id="hidVirtualPath" name="hidVirtualPath" type="hidden" value="/kxreader" />
<script src="/kxreader/bundles/detail?v=-ULdk-c6FkZHtJA2KAXPgHnyA8mtgyPnBde_C2VZ2BY1"></script>

<script src="/kxreader/Scripts/layer.min.js" type="text/javascript"></script>

<div id="footerBox" class="rootw footer">
</div>
<script>
    if (typeof FlushLogin == 'function') {
        FlushLogin();
    }
    modifyEcpHeader(true);
</script>

<!--图片放大功能 start-->
<script src="/kxreader/bundles/imagebox?v=W4phPu9SNkGcuPeJclikuVE3PpRyIW_gnfjm_19nynI1"></script>

<script type="text/javascript">
    $(function () {
        var j = $.noConflict();
        j(function () {
            j(".zoom-in,.btn-zoomin").imgbox({
                'alignment': 'center',
                'allowMultiple': false,
                'overlayShow': true
            });
        })
    });
</script>
<!--图片放大功能 end-->
<div class="fixedbar">
    <div class="backtop hiddenV" id="backtop">
        <a id="backTopSide" href="javascript:scroll(0,0);" title=""></a>
    </div>
</div>
<script type="text/javascript" src="/kxreader/Scripts/MathJax-2.6-latest/MathJax.js?config=MML_HTMLorMML-full"></script>


    <link href="/kxreader/Content/css/LeftDetail?v=NLcKG8I1SJUaVFrQ0iGpF2klAT0OsmHRaVSZ1rKb5xg1" rel="stylesheet"/>

</body>
</html>

