<!DOCTYPE html>
<html>
<head>
    <title>全文阅读--XML全文阅读--中国知网</title>
    <link rel="icon" href="/kxreader/favicon.ico" />
    <link rel="shortcut Icon" href="/kxreader/favicon.ico" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="keywords" content="文献 XML KBASE CNKI 中国知网" />
    <meta name="description" content="XML文献检索" />
    <link href="/kxreader/Content/css/detail?v=qX2z2KjRAEyQiNfAbKtl7dLnsqFoQ5Jdw3TZfDf0n1k1" rel="stylesheet"/>

    <script type="text/javascript">
        var APPPATH = '/kxreader';
    </script>
</head>

<body>
    
<script type="text/javascript" src="//login.cnki.net/TopLogin/api/loginapi/get?type=top&amp;localCSS=&amp;returnurl=%2f%2fkns.cnki.net%2f%2fKXReader%2fDetail%3fTIMESTAMP%3d637135741573877500%26DBCODE%3dCJFD%26TABLEName%3dCJFDLAST2019%26FileName%3dJYRJ201905040%26RESULT%3d1%26SIGN%3dBGjwgZWNxcmU9wjAx0AKoYW7Qho%253d"></script>

<div id="headerBox" class="header">
    <div class="topbar">
        <div class="textalign">
            <a href="/kxreader/Detail?dbcode=CJFD&amp;filename=JYRJ201905040&amp;align=md">
                <i class="icon-cen active" title="居中对齐"></i>
            </a>
            <a href="/kxreader/Detail?dbcode=CJFD&amp;filename=JYRJ201905040&amp;align=lt">
                <i class="icon-left " title="左对齐"></i>
            </a>
        </div>
        <h6 class="free-tip"><i class="icon"></i>HTML阅读开放试用阶段，欢迎体验！</h6>
    </div>
</div>

    



<div class="btn-link" style="display: none"><a target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JYRJ201905040&amp;v=MDg3MThRS0RIODR2UjRUNmo1NE8zenFxQnRHRnJDVVI3cWZadVp0Rnl6a1VMM0tMelRaWkxHNEg5ak1xbzlCWkk=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">知网节</a></div>

    <div class="main">

        

    <div class="sidebar-a">
        <!--sidebar start-->
        <div class="sidenav">
            <div class="arrow"><span></span></div>
            <!--sidebar_list start-->
            <dl class="sidenav-list">
                    <dt class="tit">目录结构</dt>
                            <dd class="guide">
                                    <p><a href="#29" data-title="&lt;b&gt;0 引 言&lt;/b&gt; "><b>0 引 言</b></a><i></i></p>
                                                            </dd>
                            <dd class="guide">
                                    <p><a href="#40" data-title="&lt;b&gt;1 ARMv8条件跳转gadget的构造方法&lt;/b&gt; "><b>1 ARMv8条件跳转gadget的构造方法</b></a><i></i></p>
                                                            </dd>
                            <dd class="guide">
                                    <p><a href="#54" data-title="&lt;b&gt;2 基于if-gadget的复杂控制流实现机制&lt;/b&gt; "><b>2 基于if-gadget的复杂控制流实现机制</b></a><i></i></p>
                                                            </dd>
                            <dd class="guide">
                                    <p><a href="#71" data-title="&lt;b&gt;3 实验结果分析与测试&lt;/b&gt; "><b>3 实验结果分析与测试</b></a><i></i></p>
                                                                    <ul class="contentbox">
                                                <li><a href="#73" data-title="&lt;b&gt;3.1 gadget链&lt;/b&gt;"><b>3.1 gadget链</b></a></li>
                                                <li><a href="#104" data-title="&lt;b&gt;3.2 结果对比分析&lt;/b&gt;"><b>3.2 结果对比分析</b></a></li>
                                    </ul>
                            </dd>
                            <dd class="guide">
                                    <p><a href="#111" data-title="&lt;b&gt;4 结 语&lt;/b&gt; "><b>4 结 语</b></a><i></i></p>
                                                            </dd>
                            <dd class="guide">
                                    <p><a href="#" data-title="文内图表 ">文内图表</a><i></i></p>
                                                                    <ul class="contentbox">
                                                <li><a href="#34" data-title="图1 ARMv7架构条件跳转gadget构造实例">图1 ARMv7架构条件跳转gadget构造实例</a></li>
                                                <li><a href="#36" data-title="&lt;b&gt;表1 ARMv8架构与ARMv7架构对比表&lt;/b&gt;"><b>表1 ARMv8架构与ARMv7架构对比表</b></a></li>
                                                <li><a href="#38" data-title="图2 AArch64条件跳转指令编码格式">图2 AArch64条件跳转指令编码格式</a></li>
                                                <li><a href="#52" data-title="图3 条件控制流gadget构造方法">图3 条件控制流gadget构造方法</a></li>
                                                <li><a href="#70" data-title="图4 ARMv8 ROP shellcode中循环结构的实现原理">图4 ARMv8 ROP shellcode中循环结构的实现原理</a></li>
                                                <li><a href="#107" data-title="图5 不同情况跳转gadget的ROP工作原理图">图5 不同情况跳转gadget的ROP工作原理图</a></li>
                                                <li><a href="#107" data-title="图5 不同情况跳转gadget的ROP工作原理图">图5 不同情况跳转gadget的ROP工作原理图</a></li>
                                                <li><a href="#109" data-title="图6 ARMv8 ROP shellcode">图6 ARMv8 ROP shellcode</a></li>
                                                <li><a href="#110" data-title="&lt;b&gt;表2 结果对比&lt;/b&gt;"><b>表2 结果对比</b></a></li>
                                    </ul>
                            </dd>
                                    <dd class="guide">
                                        <h6>
                                            <p><a href="#a_bibliography">参考文献</a> </p>
                                        </h6>
                                    </dd>

            </dl>
        </div>
        <!--sidebar end-->
        &nbsp;
        <!--此处有一空格符 勿删-->
    </div>

                <div class="sidebar-b three-collumn" style="width:0;">
            <div class="refer" style="width: 0;">
                <div class="arrow off" title="参考文献"><span></span></div>
                <div class="js-scrollbox" >
                    
                    <div class="subbox active">
                        <h4>
                            <span class="tit">参考文献</span>
                            <a class="close" href="javascript:void(0)">x</a>
                        </h4>
                        <div class="side-scroller">
                            <ul class="refer-list">
                                <li id="125">


                                    <a id="bibliography_1" title=" ARM Ltd.The Architecture for the Digital World[OL].http://www.arm.com/zh/about/newsroom/arm-and-broadcom-exten-d-relationship-With-armv7-and-armv8-architecture-licenses.php." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=The Architecture for the Digital World[OL]">
                                        <b>[1]</b>
                                         ARM Ltd.The Architecture for the Digital World[OL].http://www.arm.com/zh/about/newsroom/arm-and-broadcom-exten-d-relationship-With-armv7-and-armv8-architecture-licenses.php.
                                    </a>
                                </li>
                                <li id="127">


                                    <a id="bibliography_2" title=" Davi L, Dmitrienko A, Sadeghi A R, et al.Return-oriented programming without returns on ARM[R].Technical Report HGI-TR-2010-002.System Security Lab, Ruhr University Bochum, 2010." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Return-Oriented Pro-gramming without Returns on ARM">
                                        <b>[2]</b>
                                         Davi L, Dmitrienko A, Sadeghi A R, et al.Return-oriented programming without returns on ARM[R].Technical Report HGI-TR-2010-002.System Security Lab, Ruhr University Bochum, 2010.
                                    </a>
                                </li>
                                <li id="129">


                                    <a id="bibliography_3" title=" Schwartz E J, Avgerinos T, Brumley D.Q:Exploit hardening made easy[C]//Proceedings of the 20th USENIX conference on Security.USENIX Association, 2011." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Q:Exploit hardening made easy">
                                        <b>[3]</b>
                                         Schwartz E J, Avgerinos T, Brumley D.Q:Exploit hardening made easy[C]//Proceedings of the 20th USENIX conference on Security.USENIX Association, 2011.
                                    </a>
                                </li>
                                <li id="131">


                                    <a id="bibliography_4" title=" Ding W, Xing X, Chen P, et al.Automatic construction of printable return-oriented programming payload[C]//2014 9th International Conference on Malicious and Unwanted Software:“The Americas” (MALWARE) .IEEE, 2014:18-25." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Automatic construction of printable return-oriented programming payload">
                                        <b>[4]</b>
                                         Ding W, Xing X, Chen P, et al.Automatic construction of printable return-oriented programming payload[C]//2014 9th International Conference on Malicious and Unwanted Software:“The Americas” (MALWARE) .IEEE, 2014:18-25.
                                    </a>
                                </li>
                                <li id="133">


                                    <a id="bibliography_5" title=" 邢骁, 陈平, 丁文彪, 等.BIOP:自动构造增强型 ROP 攻击[J].计算机学报, 2014, 37 (5) :1111-1123." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JSJX201405012&amp;v=MjQ1NDBMejdCZHJHNEg5WE1xbzlFWm9RS0RIODR2UjRUNmo1NE8zenFxQnRHRnJDVVI3cWZadVp0Rnl6a1VMM04=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[5]</b>
                                         邢骁, 陈平, 丁文彪, 等.BIOP:自动构造增强型 ROP 攻击[J].计算机学报, 2014, 37 (5) :1111-1123.
                                    </a>
                                </li>
                                <li id="135">


                                    <a id="bibliography_6" title=" Yang C, Zheng T, Lin Z.AR Exploit:An Automatic ROP Exploit Based on Long Sequence[C]//Proceedings of the 2014 IEEE Eighth International Conference on Software Security and Reliability-Companion.IEEE, 2014:50-56." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=AR Exploit:An Automatic ROP Exploit Based on Long Sequence">
                                        <b>[6]</b>
                                         Yang C, Zheng T, Lin Z.AR Exploit:An Automatic ROP Exploit Based on Long Sequence[C]//Proceedings of the 2014 IEEE Eighth International Conference on Software Security and Reliability-Companion.IEEE, 2014:50-56.
                                    </a>
                                </li>
                                <li id="137">


                                    <a id="bibliography_7" title=" 杨超.基于长指令序列的ROP攻击的自动化工具的研究与实现[D].南京:南京大学, 2015." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CMFD&amp;filename=1015310193.nh&amp;v=MTQzMjJDVVI3cWZadVp0Rnl6a1VMM05WRjI2RzdDNUh0REZySkViUElRS0RIODR2UjRUNmo1NE8zenFxQnRHRnI=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[7]</b>
                                         杨超.基于长指令序列的ROP攻击的自动化工具的研究与实现[D].南京:南京大学, 2015.
                                    </a>
                                </li>
                                <li id="139">


                                    <a id="bibliography_8" title=" Subramanian K G, Isawasan P, Budiarto R, et al.Binary image reconstruction based on prescribed numerical information[J].Acta Mathematicae Applicatae Sinica, English Series, 2015, 31 (2) :519-528." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=YISY201502020&amp;v=MzE1MjBESDg0dlI0VDZqNTRPM3pxcUJ0R0ZyQ1VSN3FmWnVadEZ5emtVTDNOUENUWWQ3RzRIOVRNclk5SFpJUUs=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[8]</b>
                                         Subramanian K G, Isawasan P, Budiarto R, et al.Binary image reconstruction based on prescribed numerical information[J].Acta Mathematicae Applicatae Sinica, English Series, 2015, 31 (2) :519-528.
                                    </a>
                                </li>
                                <li id="141">


                                    <a id="bibliography_9" title=" 林志添.一种不完全依赖栈的ROP攻击技术的研究[D].南京:南京大学, 2015." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CMFD&amp;filename=1015313622.nh&amp;v=MDM5NTF0Rnl6a1VMM05WRjI2RzdDNUhkZk9yWkViUElRS0RIODR2UjRUNmo1NE8zenFxQnRHRnJDVVI3cWZadVo=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[9]</b>
                                         林志添.一种不完全依赖栈的ROP攻击技术的研究[D].南京:南京大学, 2015.
                                    </a>
                                </li>
                                <li id="143">


                                    <a id="bibliography_10" title=" 袁平海, 曾庆凯.ROP图灵完备的普遍可实现性[J].软件学报, 2017, 28 (10) :2583-2598." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=RJXB201710005&amp;v=MTQ0MzlHRnJDVVI3cWZadVp0Rnl6a1VMM05OeWZUYkxHNEg5Yk5yNDlGWVlRS0RIODR2UjRUNmo1NE8zenFxQnQ=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[10]</b>
                                         袁平海, 曾庆凯.ROP图灵完备的普遍可实现性[J].软件学报, 2017, 28 (10) :2583-2598.
                                    </a>
                                </li>
                                <li id="145">


                                    <a id="bibliography_11" title=" 丁文彪.基于ROP技术的攻击自动化构造与程序混淆研究[D].南京:南京大学, 2015." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CMFD&amp;filename=1015317475.nh&amp;v=MTk4NDJDVVI3cWZadVp0Rnl6a1VMM05WRjI2RzdDNUdkWExxcEViUElRS0RIODR2UjRUNmo1NE8zenFxQnRHRnI=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[11]</b>
                                         丁文彪.基于ROP技术的攻击自动化构造与程序混淆研究[D].南京:南京大学, 2015.
                                    </a>
                                </li>
                                <li id="147">


                                    <a id="bibliography_12" title=" 彭建山, 周传涛, 王清贤, 等.基于多路径分发的ROP框架构造方法[J].计算机科学, 2018, 45 (1) :240-244." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JSJA201801045&amp;v=MjI4MTJybzlCWVlRS0RIODR2UjRUNmo1NE8zenFxQnRHRnJDVVI3cWZadVp0Rnl6a1VMM05MejdCYjdHNEg5bk0=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[12]</b>
                                         彭建山, 周传涛, 王清贤, 等.基于多路径分发的ROP框架构造方法[J].计算机科学, 2018, 45 (1) :240-244.
                                    </a>
                                </li>
                                <li id="149">


                                    <a id="bibliography_13" title=" Liang Y.Research on key techniques of software binary code reuse[D].Wuhan:Wuhan University, 2016." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Research on key techniques of software binary code reuse">
                                        <b>[13]</b>
                                         Liang Y.Research on key techniques of software binary code reuse[D].Wuhan:Wuhan University, 2016.
                                    </a>
                                </li>
                            </ul>
                            <div style='display: none;' class="zqscroller" >
                                <h4 class="">附加材料</h4>
                                <ul></ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            &nbsp;
            <!--此处有一空格符 勿删-->
        </div>

        
    <div class="content">



        <!--tips start-->
                            <div class="tips">
                    <a href="http://navi.cnki.net/KNavi/JournalDetail?pcode=CJFD&amp;pykm=JYRJ" target="_blank">计算机应用与软件</a>
                2019,36(05),225-230 DOI:10.3969/j.issn.1000-386x.2019.05.039            </div>
        <!--tips end-->
            <div class="top-title">
                <h1 class="title">
                    <span class="vm"><b>ARMv8 ROP shellcode复杂控制流构造</b></span>
                                    </h1>

            </div>
                        <h2>
                                <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=au&amp;skey=%E8%B5%B5%E5%88%A9%E5%86%9B&amp;code=40553851&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">赵利军</a>
                                <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=au&amp;skey=%E8%91%A3%E8%8E%8E%E8%8E%8E&amp;code=41744658&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">董莎莎</a>
                </h2>
                    <h2>
                    <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=in&amp;skey=%E9%99%86%E5%86%9B%E5%B7%A5%E7%A8%8B%E5%A4%A7%E5%AD%A6%E5%86%9B%E4%BA%8B%E7%90%86%E8%AE%BA%E5%88%9B%E6%96%B0%E4%B8%8E%E4%BD%9C%E6%88%98%E5%AE%9E%E9%AA%8C%E4%B8%AD%E5%BF%83&amp;code=1701801&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">陆军工程大学军事理论创新与作战实验中心</a>
            </h2>

        
<div class="link">
    <a id="aexport" class="icon icon-output"  onclick="" href="javascript:void(0);"><i></i>导出/参考文献</a>
    
    <span class="shareBoard" onmouseover="$('#sharedet').show();$('#this').addClass('shareBoardCUR')" onmouseout="$('#sharedet').hide();$('#this').removeClass('shareBoardCUR')">
        <a class="icon icon-share" href="#"><i></i>分享<em></em></a>
        <ul class="shareHide" id="sharedet" style="display: none;">
            <li><a title="复制链接" class="copy" onclick="" href="#"><i></i>复制链接</a></li>
            <li><a title="分享到新浪微博" class="xl" onclick="" href="javascript:common.ShareAction('xl');"><i></i>新浪微博</a></li>
            <li>
                <a title="分享到微信" class="wx" onclick="" href="#"><i></i>微信扫一扫</a>
                <div class="qrcode"><img src='' alt='' /></div>
            </li>
        </ul>

    </span>
    
    <a id="RefTrack" title="创建引文跟踪" class="icon icon-track" onclick="" href="javascript:void(0);"> <i></i>创建引文跟踪 </a>
    <a id="ashoucang" title="收藏" class="icon icon-favor" onclick="" href="javascript:void(0);"><i></i>收藏</a>
    <a class="icon icon-print" onclick="window.print();" href="javascript:void(0);"><i></i>打印</a>
    
    <!--版本切换 end-->
</div>
                            <div class="data" id="a_abstract">
                <span class="keys">摘<span style="font-family: 'Times New Roman';">&nbsp;&nbsp;&nbsp;&nbsp;</span>要：</span>
                <p>一个复杂的ROP shellcode从语义层面经常会用到循环和递归等控制流形式。条件跳转控制流gadget是循环和递归等控制结构的基础。然而ARMv7指令集中的间接条件跳转指令在ARMv8指令集中已经不再存在。ARMv8指令集中的条件跳转指令的目标地址的偏移已经被硬编码, 不能被使用, 所以ARMv8架构下只能通过无条件跳转gadget的重复使用实现循环和递归。这不仅执行效率低, 而且浪费了大量的内存空间。基于上述问题, 对ARMv7架构的条件跳转gadget进行了分析, 提出一种ARMv8架构基于CMP指令和CSEL指令gadget构造条件跳转gadget方法。不仅解决了ARMv7架构基于间接条件跳转指令gadget构造ROP shellcode复杂控制流的方法在ARMv8架构中不再适用的问题, 而且通过实验证明了与无条件跳转gadget方法相比, 节省了大量的内存空间。</p>
            </div>
                    <div class="data" id="a_keywords">
                <span class="keys">关键词：</span>
                <p>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=ROP%20shellcode&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">ROP shellcode;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=ARMv8&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">ARMv8;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=%E6%8E%A7%E5%88%B6%E6%B5%81%E8%AF%AD%E4%B9%89&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">控制流语义;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=CMP%20gadget&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">CMP gadget;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=CSEL%20gadget&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">CSEL gadget;</a>
                </p>
            </div>
        
        <!--brief start-->
        
            <div class="brief">
                    <p>
                            <b>作者简介：</b>
                                                        <span>
                                    赵利军, 讲师, 主研领域:软件开发, 信息安全。;
                                </span>
                                <span>
                                    董莎莎, 讲师。;
                                </span>
                    </p>
                                    <p><b>收稿日期：</b>2018-10-24</p>

            </div>
                    <h1><b>ARMV8 ROP SHELLCODE COMPLEX CONTROL FLOW STRUCTURE</b></h1>
                    <h2>
                    <span>Zhao Lijun</span>
                    <span>Dong Shasha</span>
            </h2>
                    <h2>
                    <span>Military Theoretical Innovation and Operational Experiment Center, Army Engineering University</span>
            </h2>
                            <div class="data" id="a_abstractEN">
                <span class="keys">Abstract：</span>
                <p>Control-flow form such as loops and recursion is often used for a complex ROP shellcode at the semantic level. Conditional jump control flow gadget is the foundation of control structures such as loops and recursion. However, the indirect conditional jump instructions in the ARMv7 instruction set no longer exist in the ARMv8 instruction set. The target address offset of conditional jump instructions in the ARMv8 instruction set has been hard-coded and cannot be used. Therefore, only by the reuse of unconditional jump gadget can cycle and recursion achieved, which is inefficient to execute and wastes a lot of memory space. To solve the above problems, we analyzed the conditional jump gadget in ARMv7 architecture, and proposed a method of constructing conditional jump gadget based on CMP instruction and CSEL instruction gadget in ARMv8 architecture. It could solve the problem that the method of constructing complex control flow of ROP shellcode based on indirect conditional jump instruction gadget in ARMv7 architecture was no longer applicable in ARMv8 architecture. It is proved by experiments that this method can save a lot of memory space compared with unconditional jump gadget method.</p>
            </div>
                    <div class="data" id="a_keywordsEN">
                <span class="keys">Keyword：</span>
                <p>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=ROP%20shellcode&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">ROP shellcode;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=ARMv8&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">ARMv8;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=Control%20flow%20semantics&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">Control flow semantics;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=CMP%20gadget&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">CMP gadget;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=CSEL%20gadget&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">CSEL gadget;</a>
                </p>
            </div>
                    <div class="brief">
                
                    <p>
                                            </p>
                                    <p><b>Received：</b> 2018-10-24</p>
                            </div>


        <!--brief start-->
                        <h3 id="29" name="29" class="anchor-tag"><b>0 引 言</b></h3>
                <div class="p1">
                    <p id="30">ARM架构处理器在嵌入式领域占有绝对的领先优势, 其市场占有率逐年保持持续增长状态。2011年ARM公司发布新一代处理器架构-ARMv8<citation id="151" type="reference"><link href="125" rel="bibliography" /><sup>[<a class="sup">1</a>]</sup></citation>。ARMv8处理器64位处理能力进一步扩大了其在高性能低功耗领域的地位。ARMv8新型体系架构即将在网络设备、智能移动设备和高端服务器等领域得以大规模部署。随着ARMv8架构的持续发展, 其上的安全问题也必将越来越受到研究者关注。2010年Davi等<citation id="152" type="reference"><link href="127" rel="bibliography" /><sup>[<a class="sup">2</a>]</sup></citation>在前人研究基础上提出了ARM架构上的JOP (jump-oriented programming) 攻击。ARM架构上的JOP攻击使用以BLX Rm指令结尾的gadget。</p>
                </div>
                <div class="p1">
                    <p id="31">2014年, 南京大学的邢骁等<citation id="153" type="reference"><link href="133" rel="bibliography" /><sup>[<a class="sup">5</a>]</sup></citation>在前人的研究基础之上提出了一种新的攻击技术——自动构造增强型ROP攻击 (BIOP) 。该技术使用JMP指令或CALL指令结尾的短指令序列构造攻击。相比于以前的工作, BIOP不引入新的特征, 能有效避免针对ROP攻击和JOP攻击的防御技术。同年, 南京大学的Chao Yang等<citation id="154" type="reference"><link href="135" rel="bibliography" /><sup>[<a class="sup">6</a>]</sup></citation>提出了一种基于长指令序列的ROP攻击技术 (A-R攻击) , 成功地避开了Ping Chen的检测方法。2015年杨超<citation id="155" type="reference"><link href="137" rel="bibliography" /><sup>[<a class="sup">7</a>]</sup></citation>在此基础上提出了一种自动化ROP攻击工具, 该工具可以自动填充与连接方案, 保证图灵完备的情况下降低其集合之间的依赖性, 保证修正后的gadget可以满足自动化构建的需要。2015年林志添<citation id="156" type="reference"><link href="141" rel="bibliography" /><sup>[<a class="sup">9</a>]</sup></citation>提出了一种不完全依赖栈的ROP攻击技术, 该方法将gadgets地址、运算数据存放在堆中, 通过一些类似于KeyFrame整形溢出的漏洞方式劫持程序流来运行gadgets从而完成恶意计算的攻击技术。2018年, 彭建山等<citation id="157" type="reference"><link href="147" rel="bibliography" /><sup>[<a class="sup">12</a>]</sup></citation>针对可用gadget数量少、实现难度大等问题, 提出了一种基于多路径分发的ROP框架构造方法。基于3种类型的gadget模块构造了一个gadget循环执行的框架, 框架内可以使用丰富的常规gadget, 从而形成一条完整、高效的ROP攻击链, 并通过实验证明不仅能够完成复杂的ROP功能, 而且特征足够小, 能够绕过主流ROP检测工具的检测。</p>
                </div>
                <div class="p1">
                    <p id="32">ROP构造功能代码的难点是实现条件转移逻辑。通过深入分析条件转移机器指令的执行上下文发现, 对这些指令的传统认知存在一定的局限性。事实上, 在已有代码中存在少量的条件转移指令, 它们的两个分支的开始部分都是可复用的代码片段 (称为gadgets) , 而且这两个gadgets会从不同的内存单元中取得下一个gadget的地址。因此, 以这些条件转移指令开始的代码片段可以帮助ROP实现条件转移逻辑。把这种代码片段称为if-gadget。袁平海等<citation id="158" type="reference"><link href="143" rel="bibliography" /><sup>[<a class="sup">10</a>]</sup></citation>通过实验证明在Linux和Windows系统if-gadget普遍存在, 即使在代码量很小的日常可执行程序中也存在, 并且引入if-gadget后, 构造复杂的ROP shellcode代码要比用传统方法容易得多。</p>
                </div>
                <div class="p1">
                    <p id="33">ARMv7指令集中的每条指令都具有条件执行功能的特殊性, 这使得ARMv7架构的条件跳转gadget的构造非常简单。图1显示了相等条件执行{if (v1==v2) ·:jump T1, else jump T2}的gadget实例, 其中gadget_4就是一个典型的if-gadget。gadget_3的CMP指令可以通过比较R3和R4寄存器中值进行标志位的改变。然后从栈中将gadget_4的首地址加载到寄存器LR, 程序跳转到gadget_4执行。gadget_4的第一条指令BX.eq r5为条件执行指令, POP{r2, lr}指令将栈中的gadget_5的首地址加载到LR寄存器, 然后程序跳转到gadget_5继续执行, 成功地实现了跳转。</p>
                </div>
                <div class="area_img" id="34">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JYRJ201905040_034.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图1 ARMv7架构条件跳转gadget构造实例" src="Detail/GetImg?filename=images/JYRJ201905040_034.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图1 ARMv7架构条件跳转gadget构造实例  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JYRJ201905040_034.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="p1">
                    <p id="35">从图1中可以看出, ARMv7架构下通过条件跳转gadget (gadget_4) 很好地实现了条件跳转。然而ARMv8是ARM公司最新发布的首款支持64位指令集的处理器架构, 其引入了一个全新的64位指令集——A64。与ARMv7架构相比, 其在指令集、地址长度、通用寄存器和工作模式等方面存在较大区别, 简要对比如表1所示。</p>
                </div>
                <div class="area_img" id="36">
                    <p class="img_tit"><b>表1 ARMv8架构与ARMv7架构对比表</b> <a class="downexcel" onclick="DownLoadReportExcel(this)">导出到EXCEL</a></p>
                    <p class="img_tit"></p>
                    <p class="img_note"></p>
                    <table id="36" border="1"><tr><td><br />特性</td><td>ARMy8</td><td>ARMy7</td></tr><tr><td>指令集</td><td>64位指令集AArch64, 并且兼容32位指令集AArch32</td><td>32位指令集A32和16位指令集T16</td></tr><tr><td><br />地址长度</td><td>64位</td><td>32位</td></tr><tr><td><br />通用寄存器</td><td>31个X0-X30 (64位) 或者W0-W30 (32) 位</td><td>15个R0-R14 (32) <br />位</td></tr><tr><td><br />工作模式</td><td>4层结构EL0-EL3, EL0表示用户模式</td><td>7种工作模式</td></tr><tr><td><br />密码算法指令</td><td>有</td><td>无</td></tr><tr><td><br />Virtualization</td><td>默认支持</td><td>可选支持</td></tr><tr><td><br />TrustZone</td><td>默认支持</td><td>可选支持</td></tr><tr><td><br />SIMD寄存器</td><td>32个×128位</td><td>32个×64位</td></tr></table>
                    <form name="form" action="/kxreader/Detail/DownloadReportExcel" method="POST" style="display:inline">
                        <input type="hidden" name="hidTable" value="" />
                        <input type="hidden" name="hidFileName" value="" />
                    </form>
                    <p class="img_note"></p>
                    <p class="img_note"></p>
                </div>
                <div class="p1">
                    <p id="37">通过对ARMv8架构指令系统的学习总结<citation id="159" type="reference"><link href="125" rel="bibliography" /><link href="127" rel="bibliography" /><link href="129" rel="bibliography" /><link href="131" rel="bibliography" /><link href="133" rel="bibliography" /><sup>[<a class="sup">1</a>,<a class="sup">2</a>,<a class="sup">3</a>,<a class="sup">4</a>,<a class="sup">5</a>]</sup></citation>, 发现总共有5类跳转指令可以影响程序的控制流。其可以分成三大类:条件跳转分支指令、非条件直接跳转分支指令和非条件间接跳转分支指令。AArch64中条件跳转指令的汇编格式如下:B.cond label, 其编码格式如图2所示, 其中imm19为跳转目标地址的偏移量。</p>
                </div>
                <div class="area_img" id="38">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JYRJ201905040_038.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图2 AArch64条件跳转指令编码格式" src="Detail/GetImg?filename=images/JYRJ201905040_038.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图2 AArch64条件跳转指令编码格式  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JYRJ201905040_038.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="p1">
                    <p id="39">从图2中可以看出, ARMv8架构条件接跳转指令的目标地址已经被编码到指令格式中, 其目的地址无法再进行修改。因此, ARMv7架构基于间接条件跳转指令构造条件跳转gadget的方法在ARMv8架构中已经不再适用, 尽管通过多个gadget的重复使用也可达成上述功能, 但将浪费大量的内存空间。基于上述问题, 本文提出了ARMv8架构基于CMP指令和CSEL指令构造if-gadget方法, 解决了ARMv8架构中缺失if-gadget的问题。最后通过实验证明了本文方法的可行性, 与传统的方法相比, 本文的方法节省更大的内存开支, 提高了执行效率。</p>
                </div>
                <h3 id="40" name="40" class="anchor-tag"><b>1 ARMv8条件跳转gadget的构造方法</b></h3>
                <div class="p1">
                    <p id="41">ARMv7架构基于间接条件跳转指令构造条件跳转gadget的方法在ARMv8架构中已经不再适用。通过对ARMv8指令集的分析, 本文提出了一种利用CSEL指令gadget和CMP指令gadget构造ARMv8 ROP shellcode复杂控制流的方法。实现过程如下:</p>
                </div>
                <div class="p1">
                    <p id="42"><b>Step 1</b> 通过算术或逻辑运算来设置相应的标志位。例如, 使用CMP命令来判断两个数是否相等, 如果两个数相等ZF为1, 否则为0。</p>
                </div>
                <div class="p1">
                    <p id="43"><b>Step 2</b> CSEL指令可根据标志位来选择相应的源寄存器对目的寄存器进行赋值。例如csel x0, x1, x2, ne中, 若ZF为0, x1赋给x0;若ZF为1, x2赋给x0。若x2和x1中预置为应转向的相应目标地址, 通过下一步可实现相应的条件跳转。</p>
                </div>
                <div class="p1">
                    <p id="44"><b>Step 3</b> Br X0指令实现跳转。</p>
                </div>
                <div class="p1">
                    <p id="45">下面的例子要实现:比较两个64位数V1和V2, 相等跳转到LABEL1;不等跳转到LABEL2。其对等的代码逻辑如下:</p>
                </div>
                <div class="area_img" id="122">
                                <img alt="" src="Detail/GetImg?filename=images/JYRJ201905040_12200.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                            <p class="img_tit"></p>

                </div>
                <div class="p1">
                    <p id="50">该条件跳转控制流gadget总共包含四个gadget, gadget (9) 将V1和V2两个操作数读取到寄存器X3和X4中;gadget (10) 将LABEL1和LABEL2的地址分别赋给寄存器X0和X1;gadget (11) 完成两个操作数X3和X4的比较, 如果不相等X0中为LABEL2的地址, 否则为LABEL1的地址;gadget (12) 实现相应的条件跳转, 若V1等于V2, 转去执行LABEL1;不等就执行LABEL2。</p>
                </div>
                <div class="p1">
                    <p id="51">工作原理如图3所示。首先第一个gadget从当前的栈顶读取两个常数v1和v2, 存储到寄存器X3和X4中, 然后SP加上0x30, 这时栈顶存储的是第2个gadget的首地址。当第1个gadget执行完毕后, 会将第2个gadget的首地址读取到X30寄存器中, 这时程序将会跳转到第2个gadget处执行, 对应图中的1、2、3步。第2个gadget完成和第1个gadget相似的功能, 从当前栈顶读取目标地址存储到X0和X1寄存器中, 然后程序跳转到第3个gadget执行, 对应图中的4、5、6步。第3个gadget对常数v1和v2比较, 如果不相等, 则目标地址为X1寄存器中的地址, 否则目标地址等于X0寄存器中的地址, 程序跳转到第4个gadget执行, 对应图中的7、8、9步。现在已经将目标地址存储到了寄存器X0中, 第4个gadget用br x0指令实现跳转。</p>
                </div>
                <div class="area_img" id="52">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JYRJ201905040_052.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图3 条件控制流gadget构造方法" src="Detail/GetImg?filename=images/JYRJ201905040_052.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图3 条件控制流gadget构造方法  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JYRJ201905040_052.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="p1">
                    <p id="53">上面的4个gadget完成了相等条件下的跳转, 其他类型的条件跳转, 如小于、大于、小于等于、大于等于均可使用上述规则进行构造, 只需将第3个gadget中的csel指令中的条件域改为相应的条件即可。有了条件跳转, 我们就可以实现有限的循环操作。</p>
                </div>
                <h3 id="54" name="54" class="anchor-tag"><b>2 基于if-gadget的复杂控制流实现机制</b></h3>
                <div class="p1">
                    <p id="55">大部分的shellcode都会涉及到循环结构, 循环结构保证了原始shellcode到生成的ARMv8 ROP shellcode间的控制流语义的一致性。虽然通过研究ROP的工作原理可以看出gadget的执行流程是通过控制结构来进行控制的。即使没有if-gadget, 可以通过合理地安排控制结构来控制gadget的执行流程, 但是这种方法存在一个重大的缺点, 它需要多次重复使用相同的数据, 这将造成内存空间的极度浪费, 而基于if-gadget的构造方法却可以避免这个问题。</p>
                </div>
                <div class="p1">
                    <p id="56">if-gadget是循环结构的基础, 本文将会基于ARMv8 if-gadget给出ARMv8 ROP shellcode中循环结构的构造方法。由于循环体需要多次使用相同的数据, 所以必须寻找一个gadget对SP指针进行调整以致gadget链可以多次使用同一块数据。本文使用下面的3个gadget来构建ARMv8 ROP shellcode中的循环结构:</p>
                </div>
                <div class="area_img" id="123">
                                <img alt="" src="Detail/GetImg?filename=images/JYRJ201905040_12300.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                            <p class="img_tit"></p>

                </div>
                <div class="p1">
                    <p id="69">其实现原理如图4所示。当循环体执行完核心功能后跳转到gadget (13) 执行。gadget (13) 、gadget (14) 和gadget (15) 为ARMv8架构基于跳转跳转gadget的ROP shellcode中的循环结构的构造方法。gadget (13) 中的第一条指令”cmp x4, x10”通过比较X1寄存器和X10寄存器的大小影响相应的标志位, 第二条指令”csel x2, x2, x1, ne”根据标志位设置寄存器X2的值, 如果X4中的值不等于X10寄存器中的值, 寄存器X2中保存循环体中第一个gadget的首地址。gadget (14) 用于实现栈指针的调整, 第一条指令将X29寄存器的值赋值给SP, 而X29寄存器中的值是通过gadget (13) 中的倒数第二条指令进行设置的, 为了可以准确地使SP指向循环体指向的数据结构, 必须准确安排X29寄存器中的值。本文中gadget (14) 执行完毕后, 栈指针位于SP1位置, 而循环体的数据的开始地址位于SP3位置, 通过对gadget (14) 的分析, gadget (13) 应将X29寄存器中的值设置为SP2+0x10所得的值, 这样当gadget (14) 执行完毕后, 栈指针将位于SP3位置。如果条件成立, gadget (15) 将会使程序跳转到循环体继续执行, 至此实现了ARMv8 ROP shellcode中循环结构。</p>
                </div>
                <div class="area_img" id="70">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JYRJ201905040_070.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图4 ARMv8 ROP shellcode中循环结构的实现原理" src="Detail/GetImg?filename=images/JYRJ201905040_070.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图4 ARMv8 ROP shellcode中循环结构的实现原理  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JYRJ201905040_070.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <h3 id="71" name="71" class="anchor-tag"><b>3 实验结果分析与测试</b></h3>
                <div class="p1">
                    <p id="72">本节将通过完成∑i的运算实例证明ARMv8架构基于CMP指令和CSEL指令构造的if-gadget方法完成复杂ARMv8 ROP shellcode的可行性。并通过实验证明与传统方法相比, 本文的方法节省了大量的内存空间。</p>
                </div>
                <h4 class="anchor-tag" id="73" name="73"><b>3.1 gadget链</b></h4>
                <div class="p1">
                    <p id="74">本例gadget链所用的7个gadget来自libc.so.6或ld-linux-aarch64.so.1库文件。gadget (16) 用于从内存加载数据到寄存器X10;gadget (2) 从内存中连续读取4个数据依次放入寄存器X1、X2、X3和X4;gadget (17) 将X3和X4相加, 结果保存到寄存器X3中;gadget (18) 完成X4寄存器的加1操作;gadget (13) 和gadget (14) 用于实现循环, gadget (13) 中的第一条指令”cmp x4, x10”通过比较X1寄存器和X10寄存器的大小影响相应的标志位;第二条指令”csel x2, x2, x1, ne”根据标志位设置寄存器X2的值, 如果X4中的值不等于X10寄存器中的值, 寄存器X2中保存gadget (17) 的首地址, 如果X4中的值等于X10寄存器中的值, 寄存器X2中保存gadget (14) 的首地址;第三条指令“ldp x29, x30, [sp], #0x10”将从gadget的CS中加载gadget (14) 函数的入口地址到X30中, 最后的RET指令将转去执行gadget (17) ;gadget (14) 用于实现栈指针的调整, 第一条指令将X29寄存器的值赋值给SP, 第二条指令从内存SP+0x10的位置读取两个数据放入寄存器X29和X30, 之后使用RET指令跳转待gadget (15) 执行;gadget (15) 实现跳转。</p>
                </div>
                <div class="area_img" id="124">
                                <img alt="" src="Detail/GetImg?filename=images/JYRJ201905040_12400.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                            <p class="img_tit"></p>

                </div>
                <div class="area_img" id="124">
                                <img alt="" src="Detail/GetImg?filename=images/JYRJ201905040_12401.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                            <p class="img_tit"></p>

                </div>
                <h4 class="anchor-tag" id="104" name="104"><b>3.2 结果对比分析</b></h4>
                <div class="p1">
                    <p id="105">本例中取<i>n</i>=3, 基于if-gadget和无条件跳转gadget的原理如图5所示。图的左侧给出ARMv8 ROP的内存安排和内存地址的后12位, 图的右侧的虚线代表指令序列的执行顺序。</p>
                </div>
                <div class="area_img" id="107">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JYRJ201905040_10700.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图5 不同情况跳转gadget的ROP工作原理图" src="Detail/GetImg?filename=images/JYRJ201905040_10700.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图5 不同情况跳转gadget的ROP工作原理图  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JYRJ201905040_10700.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="area_img" id="107">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JYRJ201905040_10701.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图5 不同情况跳转gadget的ROP工作原理图" src="Detail/GetImg?filename=images/JYRJ201905040_10701.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图5 不同情况跳转gadget的ROP工作原理图  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JYRJ201905040_10701.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="p1">
                    <p id="108">可以看出, 尽管通过无条件跳转gadget也可完成相同的功能, 但是与本文提出的基于条件跳转gadget的方法相比, 其需要不断地重复使用gadget (13) 、gadget (17) 和gadget (18) , 造成了内存空间的冗余。当<i>n</i>=3时, 基于if-gadget和无条件跳转gadget对应的控制结构如图6所示。基于if-gadget的方法生成了128字节大小的控制结构, 无条件跳转gadget的方法生成了240字节大小的控制结构, 造成了112字节的空间浪费。而且随着<i>n</i>的增大, 无条件跳转gadget的方法的控制结构也将越来越大, 浪费的内存空间也将越来越多。表2给出了<i>n</i>=4, 5, 6, 7时的情形, 可以看出, 当<i>n</i>接近无穷大时, 本文的方法可以节省大量的内存空间, 从而提高执行效率。</p>
                </div>
                <div class="area_img" id="109">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JYRJ201905040_109.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图6 ARMv8 ROP shellcode" src="Detail/GetImg?filename=images/JYRJ201905040_109.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图6 ARMv8 ROP shellcode  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JYRJ201905040_109.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="area_img" id="110">
                    <p class="img_tit"><b>表2 结果对比</b> <a class="downexcel" onclick="DownLoadReportExcel(this)">导出到EXCEL</a></p>
                    <p class="img_tit"></p>
                    <p class="img_note"></p>
                    <table id="110" border="1"><tr><td rowspan="2" colspan="2"><br /></td><td colspan="2"><br />方法</td><td rowspan="2">浪费的<br />内存空间</td></tr><tr><td><br />基于<br />if-gadget</td><td>无条件跳转<br />gadget</td></tr><tr><td rowspan="4"><br />大小<br />/Byte</td><td><br /><i>n</i>=4</td><td>128</td><td>304</td><td>176</td></tr><tr><td><br /><i>n</i>=5</td><td>128</td><td>368</td><td>240</td></tr><tr><td><br /><i>n</i>=6</td><td>128</td><td>432</td><td>304</td></tr><tr><td><br /><i>n</i>=7</td><td>128</td><td>496</td><td>368</td></tr><tr><td colspan="5"><br /></td></tr></table>
                    <form name="form" action="/kxreader/Detail/DownloadReportExcel" method="POST" style="display:inline">
                        <input type="hidden" name="hidTable" value="" />
                        <input type="hidden" name="hidFileName" value="" />
                    </form>
                    <p class="img_note"></p>
                    <p class="img_note"></p>
                </div>
                <h3 id="111" name="111" class="anchor-tag"><b>4 结 语</b></h3>
                <div class="p1">
                    <p id="112">ARMv7架构基于条件跳转指令构造条件跳转gadget的方法在ARMv8架构中已经不再适用, 而大多数的shellcode存在循环结构, 条件跳转gadget是ROP shellcode中循环结构构造的基础。基于上述问题, 本文首先提出一种在ARMv8平台利用CSEL指令和CMP指令gadget构造条件跳转gadget的方法。然后基于条件跳转gadget后给出了ARMv8 ROP shellcode中循环结构的构造方法, 并通过一个实例证明了本文的方法在ARMv8架构上的可行性。给出了ARMv8 ROP shellcode中循环结构的使用方法和包含循环结构的ARMv8 ROP控制结构的生成过程, 并通过与无条件跳转gadget方法相比, 本文的方法减小了ARMv8 ROP控制结构的大小, 节省了内存空间。</p>
                </div>

        <!--brief end-->
        
        <!--conten left  end-->
        <!--增强附件-->
        

        <!--reference start-->
            <div class="reference anchor-tag" id="a_bibliography">
                    <h3>参考文献</h3>
                                        <p id="125">
                            <a id="bibliography_1" target="_blank" href="http://scholar.cnki.net/result.aspx?q=The Architecture for the Digital World[OL]">

                                <b>[1]</b> ARM Ltd.The Architecture for the Digital World[OL].http://www.arm.com/zh/about/newsroom/arm-and-broadcom-exten-d-relationship-With-armv7-and-armv8-architecture-licenses.php.
                            </a>
                        </p>
                        <p id="127">
                            <a id="bibliography_2" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Return-Oriented Pro-gramming without Returns on ARM">

                                <b>[2]</b> Davi L, Dmitrienko A, Sadeghi A R, et al.Return-oriented programming without returns on ARM[R].Technical Report HGI-TR-2010-002.System Security Lab, Ruhr University Bochum, 2010.
                            </a>
                        </p>
                        <p id="129">
                            <a id="bibliography_3" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Q:Exploit hardening made easy">

                                <b>[3]</b> Schwartz E J, Avgerinos T, Brumley D.Q:Exploit hardening made easy[C]//Proceedings of the 20th USENIX conference on Security.USENIX Association, 2011.
                            </a>
                        </p>
                        <p id="131">
                            <a id="bibliography_4" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Automatic construction of printable return-oriented programming payload">

                                <b>[4]</b> Ding W, Xing X, Chen P, et al.Automatic construction of printable return-oriented programming payload[C]//2014 9th International Conference on Malicious and Unwanted Software:“The Americas” (MALWARE) .IEEE, 2014:18-25.
                            </a>
                        </p>
                        <p id="133">
                            <a id="bibliography_5" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JSJX201405012&amp;v=MDk0MDhadVp0Rnl6a1VMM05MejdCZHJHNEg5WE1xbzlFWm9RS0RIODR2UjRUNmo1NE8zenFxQnRHRnJDVVI3cWY=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[5]</b> 邢骁, 陈平, 丁文彪, 等.BIOP:自动构造增强型 ROP 攻击[J].计算机学报, 2014, 37 (5) :1111-1123.
                            </a>
                        </p>
                        <p id="135">
                            <a id="bibliography_6" target="_blank" href="http://scholar.cnki.net/result.aspx?q=AR Exploit:An Automatic ROP Exploit Based on Long Sequence">

                                <b>[6]</b> Yang C, Zheng T, Lin Z.AR Exploit:An Automatic ROP Exploit Based on Long Sequence[C]//Proceedings of the 2014 IEEE Eighth International Conference on Software Security and Reliability-Companion.IEEE, 2014:50-56.
                            </a>
                        </p>
                        <p id="137">
                            <a id="bibliography_7" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CMFD&amp;filename=1015310193.nh&amp;v=MTg2NzBERnJKRWJQSVFLREg4NHZSNFQ2ajU0TzN6cXFCdEdGckNVUjdxZlp1WnRGeXprVUwzTlZGMjZHN0M1SHQ=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[7]</b> 杨超.基于长指令序列的ROP攻击的自动化工具的研究与实现[D].南京:南京大学, 2015.
                            </a>
                        </p>
                        <p id="139">
                            <a id="bibliography_8" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=YISY201502020&amp;v=MDQwMzhRS0RIODR2UjRUNmo1NE8zenFxQnRHRnJDVVI3cWZadVp0Rnl6a1VMM05QQ1RZZDdHNEg5VE1yWTlIWkk=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[8]</b> Subramanian K G, Isawasan P, Budiarto R, et al.Binary image reconstruction based on prescribed numerical information[J].Acta Mathematicae Applicatae Sinica, English Series, 2015, 31 (2) :519-528.
                            </a>
                        </p>
                        <p id="141">
                            <a id="bibliography_9" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CMFD&amp;filename=1015313622.nh&amp;v=MDE4MDM2RzdDNUhkZk9yWkViUElRS0RIODR2UjRUNmo1NE8zenFxQnRHRnJDVVI3cWZadVp0Rnl6a1VMM05WRjI=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[9]</b> 林志添.一种不完全依赖栈的ROP攻击技术的研究[D].南京:南京大学, 2015.
                            </a>
                        </p>
                        <p id="143">
                            <a id="bibliography_10" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=RJXB201710005&amp;v=MTk0NTdZUUtESDg0dlI0VDZqNTRPM3pxcUJ0R0ZyQ1VSN3FmWnVadEZ5emtVTDNOTnlmVGJMRzRIOWJOcjQ5Rlk=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[10]</b> 袁平海, 曾庆凯.ROP图灵完备的普遍可实现性[J].软件学报, 2017, 28 (10) :2583-2598.
                            </a>
                        </p>
                        <p id="145">
                            <a id="bibliography_11" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CMFD&amp;filename=1015317475.nh&amp;v=MDQ2NjdmWnVadEZ5emtVTDNOVkYyNkc3QzVHZFhMcXBFYlBJUUtESDg0dlI0VDZqNTRPM3pxcUJ0R0ZyQ1VSN3E=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[11]</b> 丁文彪.基于ROP技术的攻击自动化构造与程序混淆研究[D].南京:南京大学, 2015.
                            </a>
                        </p>
                        <p id="147">
                            <a id="bibliography_12" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JSJA201801045&amp;v=MzI3NDdmWnVadEZ5emtVTDNOTHo3QmI3RzRIOW5Ncm85QllZUUtESDg0dlI0VDZqNTRPM3pxcUJ0R0ZyQ1VSN3E=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[12]</b> 彭建山, 周传涛, 王清贤, 等.基于多路径分发的ROP框架构造方法[J].计算机科学, 2018, 45 (1) :240-244.
                            </a>
                        </p>
                        <p id="149">
                            <a id="bibliography_13" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Research on key techniques of software binary code reuse">

                                <b>[13]</b> Liang Y.Research on key techniques of software binary code reuse[D].Wuhan:Wuhan University, 2016.
                            </a>
                        </p>
            </div>
        <!--reference end-->
        <!--footnote start-->
        <!--footnote end-->



    </div>

        <input id="fileid" type="hidden" value="JYRJ201905040" />
        <input id="dpi" type="hidden" value="600" />
    </div>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?6e967eb120601ea41b9d312166416aa6";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
</script>

    


<input id="hid_uid" name="hid_uid" type="hidden" value="WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
<input id="hid_kLogin_headerUrl" name="hid_kLogin_headerUrl" type="hidden" value="/KLogin/Request/GetKHeader.ashx%3Fcallback%3D%3F" />
<input id="hid_kLogin_footerUrl" name="hid_kLogin_footerUrl" type="hidden" value="/KLogin/Request/GetKFooter.ashx%3Fcallback%3D%3F" />
<div class="btn-link" style="display: none"><a target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JYRJ201905040&amp;v=MDg3MThRS0RIODR2UjRUNmo1NE8zenFxQnRHRnJDVVI3cWZadVp0Rnl6a1VMM0tMelRaWkxHNEg5ak1xbzlCWkk=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">知网节</a></div>
<div class="popflow" id="popupTips" style="display: none;">
    <div class="popflowArr"></div>
    <div class="popflowCot">
        <div class="hd"><a href="javascript:void(0);" onclick="$('#popupTips').hide();$('#popupmsg').html('')" class="close">X</a></div>
        <div class="bd">
            <p class="mes" id="popupmsg" name="popupmsg"></p>
          
        </div>
    </div>
</div>
<input type="hidden" id="myexport" value="//kns.cnki.net" />

<input type="hidden" id="KPCAPIPATH" value="//ishufang.cnki.net" />
<input type="hidden" id="CitedTimes" value="" />
<div class="link" id="GLSearch" style="display: none;">
    <i class="icon-trangle"></i>
    <div class="inner">
        <a class="icon" id="copytext">复制</a>
        <a class="icon" target="_blank" onclick="searchCRFD(this)">工具书搜索</a>
    </div>
</div>




<input id="hidVirtualPath" name="hidVirtualPath" type="hidden" value="/kxreader" />
<script src="/kxreader/bundles/detail?v=-ULdk-c6FkZHtJA2KAXPgHnyA8mtgyPnBde_C2VZ2BY1"></script>

<script src="/kxreader/Scripts/layer.min.js" type="text/javascript"></script>

<div id="footerBox" class="rootw footer">
</div>
<script>
    if (typeof FlushLogin == 'function') {
        FlushLogin();
    }
    modifyEcpHeader(true);
</script>

<!--图片放大功能 start-->
<script src="/kxreader/bundles/imagebox?v=W4phPu9SNkGcuPeJclikuVE3PpRyIW_gnfjm_19nynI1"></script>

<script type="text/javascript">
    $(function () {
        var j = $.noConflict();
        j(function () {
            j(".zoom-in,.btn-zoomin").imgbox({
                'alignment': 'center',
                'allowMultiple': false,
                'overlayShow': true
            });
        })
    });
</script>
<!--图片放大功能 end-->
<div class="fixedbar">
    <div class="backtop hiddenV" id="backtop">
        <a id="backTopSide" href="javascript:scroll(0,0);" title=""></a>
    </div>
</div>
<script type="text/javascript" src="/kxreader/Scripts/MathJax-2.6-latest/MathJax.js?config=MML_HTMLorMML-full"></script>

</body>
</html>
