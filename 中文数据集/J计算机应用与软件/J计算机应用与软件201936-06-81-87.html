<!DOCTYPE html>
<html>
<head>
    <title>全文阅读--XML全文阅读--中国知网</title>
    <link rel="icon" href="/kxreader/favicon.ico" />
    <link rel="shortcut Icon" href="/kxreader/favicon.ico" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="keywords" content="文献 XML KBASE CNKI 中国知网" />
    <meta name="description" content="XML文献检索" />
    <link href="/kxreader/Content/css/detail?v=qX2z2KjRAEyQiNfAbKtl7dLnsqFoQ5Jdw3TZfDf0n1k1" rel="stylesheet"/>

    <script type="text/javascript">
        var APPPATH = '/kxreader';
    </script>
</head>

<body>
    
<script type="text/javascript" src="//login.cnki.net/TopLogin/api/loginapi/get?type=top&amp;localCSS=&amp;returnurl=%2f%2fkns.cnki.net%2f%2fKXReader%2fDetail%3fTIMESTAMP%3d637135637959943750%26DBCODE%3dCJFD%26TABLEName%3dCJFDLAST2019%26FileName%3dJYRJ201906017%26RESULT%3d1%26SIGN%3dAQQNnECoFia1UH4G0zu2kgoJl9g%253d"></script>

<div id="headerBox" class="header">
    <div class="topbar">
        <div class="textalign">
            <a href="/kxreader/Detail?dbcode=CJFD&amp;filename=JYRJ201906017&amp;align=md">
                <i class="icon-cen active" title="居中对齐"></i>
            </a>
            <a href="/kxreader/Detail?dbcode=CJFD&amp;filename=JYRJ201906017&amp;align=lt">
                <i class="icon-left " title="左对齐"></i>
            </a>
        </div>
        <h6 class="free-tip"><i class="icon"></i>HTML阅读开放试用阶段，欢迎体验！</h6>
    </div>
</div>

    



<div class="btn-link" style="display: none"><a target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JYRJ201906017&amp;v=MTE5NjFIODR2UjRUNmo1NE8zenFxQnRHRnJDVVI3cWZadVp0Rnl2a1c3dkFMelRaWkxHNEg5ak1xWTlFWTRRS0Q=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ28xeDVteFZmK0p3enVSVkNoMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">知网节</a></div>

    <div class="main">

        

    <div class="sidebar-a">
        <!--sidebar start-->
        <div class="sidenav">
            <div class="arrow"><span></span></div>
            <!--sidebar_list start-->
            <dl class="sidenav-list">
                    <dt class="tit">目录结构</dt>
                            <dd class="guide">
                                    <p><a href="#29" data-title="&lt;b&gt;0 引 言&lt;/b&gt; "><b>0 引 言</b></a><i></i></p>
                                                            </dd>
                            <dd class="guide">
                                    <p><a href="#32" data-title="&lt;b&gt;1 原 理&lt;/b&gt; "><b>1 原 理</b></a><i></i></p>
                                                                    <ul class="contentbox">
                                                <li><a href="#35" data-title="&lt;b&gt;1.1 数据解析&lt;/b&gt;"><b>1.1 数据解析</b></a></li>
                                                <li><a href="#38" data-title="&lt;b&gt;1.2 反演方法&lt;/b&gt;"><b>1.2 反演方法</b></a></li>
                                                <li><a href="#57" data-title="&lt;b&gt;1.3 参数计算&lt;/b&gt;"><b>1.3 参数计算</b></a></li>
                                                <li><a href="#74" data-title="&lt;b&gt;1.4 数据报告导出&lt;/b&gt;"><b>1.4 数据报告导出</b></a></li>
                                    </ul>
                            </dd>
                            <dd class="guide">
                                    <p><a href="#77" data-title="&lt;b&gt;2 软件设计及实现&lt;/b&gt; "><b>2 软件设计及实现</b></a><i></i></p>
                                                                    <ul class="contentbox">
                                                <li><a href="#79" data-title="&lt;b&gt;2.1 软件架构&lt;/b&gt;"><b>2.1 软件架构</b></a></li>
                                                <li><a href="#86" data-title="&lt;b&gt;2.2 功能实现&lt;/b&gt;"><b>2.2 功能实现</b></a></li>
                                    </ul>
                            </dd>
                            <dd class="guide">
                                    <p><a href="#98" data-title="&lt;b&gt;3 可靠性验证及应用实例&lt;/b&gt; "><b>3 可靠性验证及应用实例</b></a><i></i></p>
                                                                    <ul class="contentbox">
                                                <li><a href="#99" data-title="&lt;b&gt;3.1 可靠性验证&lt;/b&gt;"><b>3.1 可靠性验证</b></a></li>
                                                <li><a href="#106" data-title="&lt;b&gt;3.2 应用实例&lt;/b&gt;"><b>3.2 应用实例</b></a></li>
                                    </ul>
                            </dd>
                            <dd class="guide">
                                    <p><a href="#114" data-title="&lt;b&gt;4 结 语&lt;/b&gt; "><b>4 结 语</b></a><i></i></p>
                                                            </dd>
                            <dd class="guide">
                                    <p><a href="#" data-title="文内图表 ">文内图表</a><i></i></p>
                                                                    <ul class="contentbox">
                                                <li><a href="#34" data-title="图1 软件业务流程设计">图1 软件业务流程设计</a></li>
                                                <li><a href="#37" data-title="图2 RES文件数据">图2 RES文件数据</a></li>
                                                <li><a href="#76" data-title="图3 岩心数据报告">图3 岩心数据报告</a></li>
                                                <li><a href="#81" data-title="图4 软件设计结构">图4 软件设计结构</a></li>
                                                <li><a href="#84" data-title="图5 软件主界面">图5 软件主界面</a></li>
                                                <li><a href="#90" data-title="图6 数据加载模块界面">图6 数据加载模块界面</a></li>
                                                <li><a href="#91" data-title="图7 原始回波串显示">图7 原始回波串显示</a></li>
                                                <li><a href="#94" data-title="图8 反演模块及反演结果">图8 反演模块及反演结果</a></li>
                                                <li><a href="#97" data-title="图9 参数计算模块及计算结果">图9 参数计算模块及计算结果</a></li>
                                                <li><a href="#102" data-title="图10 CoreSpec-1000配套软件和本软件反演的&lt;i&gt;T&lt;/i&gt;&lt;sub&gt;2&lt;/sub&gt;谱比对">图10 CoreSpec-1000配套软件和本软件反演的<i>T</i><sub>2</sub>谱比对</a></li>
                                                <li><a href="#105" data-title="图11 NIUMAG仪器配套软件和本软件反演的&lt;i&gt;T&lt;/i&gt;&lt;sub&gt;2&lt;/sub&gt;谱比对">图11 NIUMAG仪器配套软件和本软件反演的<i>T</i><sub>2</sub>谱比对</a></li>
                                                <li><a href="#111" data-title="图12 软件对NIUMAG仪器和CoreSpec-1000型仪器">图12 软件对NIUMAG仪器和CoreSpec-1000型仪器</a></li>
                                                <li><a href="#113" data-title="图13 多回波间隔数据处理结果">图13 多回波间隔数据处理结果</a></li>
                                    </ul>
                            </dd>
                                    <dd class="guide">
                                        <h6>
                                            <p><a href="#a_bibliography">参考文献</a> </p>
                                        </h6>
                                    </dd>

            </dl>
        </div>
        <!--sidebar end-->
        &nbsp;
        <!--此处有一空格符 勿删-->
    </div>

                <div class="sidebar-b three-collumn" style="width:0;">
            <div class="refer" style="width: 0;">
                <div class="arrow off" title="参考文献"><span></span></div>
                <div class="js-scrollbox" >
                    
                    <div class="subbox active">
                        <h4>
                            <span class="tit">参考文献</span>
                            <a class="close" href="javascript:void(0)">x</a>
                        </h4>
                        <div class="side-scroller">
                            <ul class="refer-list">
                                <li id="129">


                                    <a id="bibliography_1" title="王忠东, 汪浩, 李能根, 等.核磁共振岩心基础实验分析[J].测井技术, 2001, 25 (3) :170-174." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=CJJS200103002&amp;v=MTg4NzMzenFxQnRHRnJDVVI3cWZadVp0Rnl2bFVyN0pKaWZCZmJHNEh0RE1ySTlGWm9RS0RIODR2UjRUNmo1NE8=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ28xeDVteFZmK0p3enVSVkNoMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[1]</b>
                                        王忠东, 汪浩, 李能根, 等.核磁共振岩心基础实验分析[J].测井技术, 2001, 25 (3) :170-174.
                                    </a>
                                </li>
                                <li id="131">


                                    <a id="bibliography_2" title="Murphy D P.NMR logging and core analysis-simplified[J].World Oil, 1995, 216 (4) :65-70." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=NMR logging and core analysis-simplified">
                                        <b>[2]</b>
                                        Murphy D P.NMR logging and core analysis-simplified[J].World Oil, 1995, 216 (4) :65-70.
                                    </a>
                                </li>
                                <li id="133">


                                    <a id="bibliography_3" title="Morriss C, Rossini D, Straley C, et al.Core analysis by lowfield NMR[J].The Log Analyst, 1997, 38 (2) :84-94." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Core analysis by low-field NMR">
                                        <b>[3]</b>
                                        Morriss C, Rossini D, Straley C, et al.Core analysis by lowfield NMR[J].The Log Analyst, 1997, 38 (2) :84-94.
                                    </a>
                                </li>
                                <li id="135">


                                    <a id="bibliography_4" title="肖立志, 石红兵.低场核磁共振岩心分析及其在测井解释中的应用[J].测井技术, 1998, 22 (1) :42-49." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=CJJS801.009&amp;v=MjExMTZVZz09SmlmQmZidTRIOC9NcjRZcVllc01EUTR4enhZUzcweCtRSHZyMzMwM2ViQ1VSYnVmWmVkdEZ5bms=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ28xeDVteFZmK0p3enVSVkNoMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[4]</b>
                                        肖立志, 石红兵.低场核磁共振岩心分析及其在测井解释中的应用[J].测井技术, 1998, 22 (1) :42-49.
                                    </a>
                                </li>
                                <li id="137">


                                    <a id="bibliography_5" title="肖立志.核磁共振成像测井与岩石核磁共振及其应用[M].北京:科学出版社, 1998." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CBBD&amp;filename=0007030069242999&amp;v=MDMwMzRVU21EZDlTSDduM3hFOWZidm5LcmlmWmVadkZ5bm1VN3pJSVY4VlZWMjdHYk83SHRIS3BvMUJadUlHQlJNOHp4&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ28xeDVteFZmK0p3enVSVkNoMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[5]</b>
                                        肖立志.核磁共振成像测井与岩石核磁共振及其应用[M].北京:科学出版社, 1998.
                                    </a>
                                </li>
                                <li id="139">


                                    <a id="bibliography_6" >
                                        <b>[6]</b>
                                    王忠东, 魏钢, 柯启宇.岩心核磁实验解释分析软件的编制与应用[C]//第八届核技术与测井技术年会, 2002.</a>
                                </li>
                                <li id="141">


                                    <a id="bibliography_7" >
                                        <b>[7]</b>
                                    纽迈岩心核磁共振分析测量软件V4.0用户手册[M].</a>
                                </li>
                                <li id="143">


                                    <a id="bibliography_8" title="Munn K, Smith D M.A NMR technique for the analysis of pore structure:Numerical inversion of relaxation measurements[J].Journal of Colloid&amp;amp;Interface Science, 1987, 119 (1) :117-126." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=NMR TECHNIQUE FOR THE ANALYSIS OF PORE STRUCTURE: NUMERICAL INVERSION OF RELAXATION MEASUREMENTS">
                                        <b>[8]</b>
                                        Munn K, Smith D M.A NMR technique for the analysis of pore structure:Numerical inversion of relaxation measurements[J].Journal of Colloid&amp;amp;Interface Science, 1987, 119 (1) :117-126.
                                    </a>
                                </li>
                                <li id="145">


                                    <a id="bibliography_9" title="姚绪刚, 王忠东.一种新的核磁共振弛豫谱反演算法[J].测井技术, 2003, 27 (5) :373-376." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=CJJS200305006&amp;v=MDA1MTMzenFxQnRHRnJDVVI3cWZadVp0Rnl2bFVyN0pKaWZCZmJHNEh0TE1xbzlGWW9RS0RIODR2UjRUNmo1NE8=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ28xeDVteFZmK0p3enVSVkNoMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[9]</b>
                                        姚绪刚, 王忠东.一种新的核磁共振弛豫谱反演算法[J].测井技术, 2003, 27 (5) :373-376.
                                    </a>
                                </li>
                                <li id="147">


                                    <a id="bibliography_10" title="肖秋生, 朱巨义.岩样核磁共振分析方法及其在油田勘探中的应用[J].石油实验地质, 2009, 31 (1) :97-100." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=SYSD200901020&amp;v=MDg1MDl1WnRGeXZsVXI3Sk5qVFlhckc0SHRqTXJvOUhaSVFLREg4NHZSNFQ2ajU0TzN6cXFCdEdGckNVUjdxZlo=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ28xeDVteFZmK0p3enVSVkNoMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[10]</b>
                                        肖秋生, 朱巨义.岩样核磁共振分析方法及其在油田勘探中的应用[J].石油实验地质, 2009, 31 (1) :97-100.
                                    </a>
                                </li>
                                <li id="149">


                                    <a id="bibliography_11" title="肖亮, 肖忠祥.核磁共振测井T2cutoff确定方法及适用性分析[J].地球物理学进展, 2008, 23 (1) :167-172." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=DQWJ200801024&amp;v=MTc2OTdyN0pJVHpjWkxHNEh0bk1ybzlIWUlRS0RIODR2UjRUNmo1NE8zenFxQnRHRnJDVVI3cWZadVp0Rnl2bFU=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ28xeDVteFZmK0p3enVSVkNoMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[11]</b>
                                        肖亮, 肖忠祥.核磁共振测井T2cutoff确定方法及适用性分析[J].地球物理学进展, 2008, 23 (1) :167-172.
                                    </a>
                                </li>
                                <li id="151">


                                    <a id="bibliography_12" title="白松涛, 程道解, 万金彬, 等.砂岩岩石核磁共振T&lt;sub&gt;2&lt;/sub&gt;谱定量表征[J].石油学报, 2016, 37 (3) :382-391." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=SYXB201603011&amp;v=MDAxNTE0TzN6cXFCdEdGckNVUjdxZlp1WnRGeXZsVXI3Sk5qVFRiTEc0SDlmTXJJOUVaWVFLREg4NHZSNFQ2ajU=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ28xeDVteFZmK0p3enVSVkNoMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[12]</b>
                                        白松涛, 程道解, 万金彬, 等.砂岩岩石核磁共振T&lt;sub&gt;2&lt;/sub&gt;谱定量表征[J].石油学报, 2016, 37 (3) :382-391.
                                    </a>
                                </li>
                                <li id="153">


                                    <a id="bibliography_13" title="Kleinberg R L, Boyd A.Tapered cutoffs for magnetic resonance bound water volume[C]//SPE Annual Technical Conference and Exhibition, 1997, 37:387-388." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Tapered cutoffs for magnetic resonance bound water volume">
                                        <b>[13]</b>
                                        Kleinberg R L, Boyd A.Tapered cutoffs for magnetic resonance bound water volume[C]//SPE Annual Technical Conference and Exhibition, 1997, 37:387-388.
                                    </a>
                                </li>
                            </ul>
                            <div style='display: none;' class="zqscroller" >
                                <h4 class="">附加材料</h4>
                                <ul></ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            &nbsp;
            <!--此处有一空格符 勿删-->
        </div>

        
    <div class="content">



        <!--tips start-->
                            <div class="tips">
                    <a href="http://navi.cnki.net/KNavi/JournalDetail?pcode=CJFD&amp;pykm=JYRJ" target="_blank">计算机应用与软件</a>
                2019,36(06),81-87 DOI:10.3969/j.issn.1000-386x.2019.06.016            </div>
        <!--tips end-->
            <div class="top-title">
                <h1 class="title">
                    <span class="vm"><b>一种通用的岩心核磁共振实验数据分析软件设计与实现</b></span>
                                    </h1>

            </div>
                        <h2>
                                <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=au&amp;skey=%E8%A6%83%E8%8E%B9%E7%91%B6&amp;code=41979454&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ28xeDVteFZmK0p3enVSVkNoMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">覃莹瑶</a>
                                <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=au&amp;skey=%E5%BC%A0%E5%AE%AB&amp;code=26097249&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ28xeDVteFZmK0p3enVSVkNoMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">张宫</a>
                                <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=au&amp;skey=%E4%BD%95%E5%AE%97%E6%96%8C&amp;code=06469772&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ28xeDVteFZmK0p3enVSVkNoMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">何宗斌</a>
                                <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=au&amp;skey=%E5%BC%A0%E5%AE%B6%E6%88%90&amp;code=41979455&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ28xeDVteFZmK0p3enVSVkNoMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">张家成</a>
                </h2>
                    <h2>
                    <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=in&amp;skey=%E9%95%BF%E6%B1%9F%E5%A4%A7%E5%AD%A6%E6%B2%B9%E6%B0%94%E8%B5%84%E6%BA%90%E4%B8%8E%E5%8B%98%E6%8E%A2%E6%8A%80%E6%9C%AF%E6%95%99%E8%82%B2%E9%83%A8%E9%87%8D%E7%82%B9%E5%AE%9E%E9%AA%8C%E5%AE%A4&amp;code=0112354&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ28xeDVteFZmK0p3enVSVkNoMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">长江大学油气资源与勘探技术教育部重点实验室</a>
            </h2>

        
<div class="link">
    <a id="aexport" class="icon icon-output"  onclick="" href="javascript:void(0);"><i></i>导出/参考文献</a>
    
    <span class="shareBoard" onmouseover="$('#sharedet').show();$('#this').addClass('shareBoardCUR')" onmouseout="$('#sharedet').hide();$('#this').removeClass('shareBoardCUR')">
        <a class="icon icon-share" href="#"><i></i>分享<em></em></a>
        <ul class="shareHide" id="sharedet" style="display: none;">
            <li><a title="复制链接" class="copy" onclick="" href="#"><i></i>复制链接</a></li>
            <li><a title="分享到新浪微博" class="xl" onclick="" href="javascript:common.ShareAction('xl');"><i></i>新浪微博</a></li>
            <li>
                <a title="分享到微信" class="wx" onclick="" href="#"><i></i>微信扫一扫</a>
                <div class="qrcode"><img src='' alt='' /></div>
            </li>
        </ul>

    </span>
    
    <a id="RefTrack" title="创建引文跟踪" class="icon icon-track" onclick="" href="javascript:void(0);"> <i></i>创建引文跟踪 </a>
    <a id="ashoucang" title="收藏" class="icon icon-favor" onclick="" href="javascript:void(0);"><i></i>收藏</a>
    <a class="icon icon-print" onclick="window.print();" href="javascript:void(0);"><i></i>打印</a>
    
    <!--版本切换 end-->
</div>
                            <div class="data" id="a_abstract">
                <span class="keys">摘<span style="font-family: 'Times New Roman';">&nbsp;&nbsp;&nbsp;&nbsp;</span>要：</span>
                <p>岩心核磁共振实验中, 原始采集数据的处理与分析非常关键, 但各厂家核磁共振仪器提供的数据处理配套软件的反演方法、参数均不相同, 使得同样的岩心测量得到的回波信息无法进行对比分析。研发一套通用的岩心核磁共振实验数据分析软件, 基于统一的数据存储模式、统一的快速高分辨反演算法, 允许设置不同反演参数和岩心分析参数, 进行岩心核磁数据的反演和参数计算, 实现所有仪器测量回波数据的统一处理和分析。目前软件支持NIUMAG公司、OXFORD公司、Magritek公司和CoreSpec-1000型仪器测量得到的原始数据, 处理结果精确, 具有操作简单、方便扩展的特点。</p>
            </div>
                    <div class="data" id="a_keywords">
                <span class="keys">关键词：</span>
                <p>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=%E6%A0%B8%E7%A3%81%E5%85%B1%E6%8C%AF&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ28xeDVteFZmK0p3enVSVkNoMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">核磁共振;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=%E5%B2%A9%E5%BF%83%E5%88%86%E6%9E%90&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ28xeDVteFZmK0p3enVSVkNoMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">岩心分析;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ28xeDVteFZmK0p3enVSVkNoMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">数据处理;</a>
                </p>
            </div>
        
        <!--brief start-->
        
            <div class="brief">
                    <p>
                            <b>作者简介：</b>
                                                        <span>
                                    覃莹瑶, 硕士生, 主研领域:核磁共振测井方法。;
                                </span>
                                <span>
                                    张宫, 讲师。;
                                </span>
                                <span>
                                    何宗斌, 副教授。;
                                </span>
                                <span>
                                    张家成, 硕士生。;
                                </span>
                    </p>
                                    <p><b>收稿日期：</b>2018-12-07</p>

                    <p>

                            <b>基金：</b>
                                                        <span>湖北省教育厅科研计划科学技术研究项目 (Q20181320);</span>
                    </p>
            </div>
                    <h1><b>DESIGN AND IMPLEMENTATION OF A UNIVERSAL CORE NMR EXPERIMENTAL DATA ANALYSIS SOFTWARE</b></h1>
                    <h2>
                    <span>Qin Yingyao</span>
                    <span>Zhang Gong</span>
                    <span>He Zongbin</span>
                    <span>Zhang Jiacheng</span>
            </h2>
                    <h2>
                    <span>Key Laboratory of Exploration Technologies for Oil and Gas Resources of Education Ministry, Yangtze University</span>
            </h2>
                            <div class="data" id="a_abstractEN">
                <span class="keys">Abstract：</span>
                <p>In the core Nuclear magnetic resonance (NMR) experiment, the processing and analysis of original collected data is very critical. However, the inversion methods and parameters of the data processing software provided by various NMR instruments manufacturers are different, which make it incapable of comparing and analyzing the echo information from the same core measurements. Thus, we developed a universal core NMR experimental data analysis software. It was based on the unified data storage model and unified fast and high-resolution inversion algorithm. The inversion and parameter calculation of core nuclear magnetic data were carried out by setting different inversion parameters and core analysis parameters, which realized the unified processing and analysis of echo data from all instrument measurement. At present, the software supports the original data measured by NIUMAG, OXFORD, Magritek and CoreSpec-1000 instruments. The processing results are accurate with simple operation method and convenient expansion.</p>
            </div>
                    <div class="data" id="a_keywordsEN">
                <span class="keys">Keyword：</span>
                <p>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=Nuclear%20magnetic%20resonance%20(NMR)%20&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ28xeDVteFZmK0p3enVSVkNoMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">Nuclear magnetic resonance (NMR) ;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=Core%20analysis&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ28xeDVteFZmK0p3enVSVkNoMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">Core analysis;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=Data%20processing&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ28xeDVteFZmK0p3enVSVkNoMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">Data processing;</a>
                </p>
            </div>
                    <div class="brief">
                
                    <p>
                                            </p>
                                    <p><b>Received：</b> 2018-12-07</p>
                                    <p>
                                            </p>
            </div>


        <!--brief start-->
                        <h3 id="29" name="29" class="anchor-tag"><b>0 引 言</b></h3>
                <div class="p1">
                    <p id="30">核磁共振测井是一种有效的测井方法, 岩心核磁共振实验分析是NMR测井资料采集、处理、解释及应用的基础<citation id="155" type="reference"><link href="129" rel="bibliography" /><sup>[<a class="sup">1</a>]</sup></citation>。测井前做少量的实验室测量能节省实际测井时间, 提高测井曲线质量。而且实验室的岩心核磁共振测量实验能够实现岩心与测井之间的标定, 建立核磁共振测井解释模型<citation id="156" type="reference"><link href="131" rel="bibliography" /><sup>[<a class="sup">2</a>]</sup></citation>。利用岩心核磁共振实验可以直接观测到岩石孔隙的流体信号, 得到与岩性无关的孔隙度、孔径分布、渗透率、自由流体指数及流体饱和度等参数<citation id="161" type="reference"><link href="133" rel="bibliography" /><link href="135" rel="bibliography" /><sup>[<a class="sup">3</a>,<a class="sup">4</a>]</sup></citation>。岩心核磁共振实验中, 原始采集数据的处理与分析非常关键, 但各厂家核磁共振仪器提供的数据处理配套软件的反演方法、参数均不相同。例如美国NUMAR公司生产的CoreSpec-1000型岩心核磁共振分析仪由Echofit软件利用非负最小二乘法 (NNLS) 和基于奇异值分解的MAP-Ⅱ算法进行反演<citation id="157" type="reference"><link href="137" rel="bibliography" /><sup>[<a class="sup">5</a>]</sup></citation>;英国Resonance Instruments公司的MARAN系列核磁共振岩心分析仪没有提供配套的数据处理分析软件<citation id="158" type="reference"><link href="139" rel="bibliography" /><sup>[<a class="sup">6</a>]</sup></citation>;NIUMAG公司生产的岩心核磁共振分析仪配套软件使用罚函数法 (BRD) 和联合重建迭代法 (SIRT) 进行反演<citation id="159" type="reference"><link href="141" rel="bibliography" /><sup>[<a class="sup">7</a>]</sup></citation>。仪器性能和反演算法都不相同导致同样的岩心测量得到的回波信息无法对比分析, 无法确定反演的<i>T</i><sub>2</sub>谱有差异的原因, 很大程度上限制了核磁岩心分析仪的作用。王忠东等研发的岩心核磁实验解释分析软件CoreMR可以对MARAN系列谱仪所采集岩心和流体核磁信号进行解释分析<citation id="160" type="reference"><link href="139" rel="bibliography" /><sup>[<a class="sup">6</a>]</sup></citation>, 但是这款软件只能处理一种谱仪采集的数据, 没有实现对不同厂家仪器测量数据的统一处理分析。</p>
                </div>
                <div class="p1">
                    <p id="31">研发一种通用的岩心核磁共振实验数据分析软件可以解决这一问题, 使用C#语言进行软件开发, 支持硬件加速的WPF通用框架进行绘图, 采用格式统一、易于交互的XML序列化存储反演参数, 易于传输、解析的JSON序列化存储采样数据和处理结果。通过采用统一的模式进行数据存储、统一的快速高分辨反演算法, 设置不同参数进行核磁参数计算, 本软件可以使所有仪器测量的回波数据得到统一处理和分析, 在消除软件处理方法差异的影响上使同样岩心的回波信息进行对比分析。</p>
                </div>
                <h3 id="32" name="32" class="anchor-tag"><b>1 原 理</b></h3>
                <div class="p1">
                    <p id="33">岩心核磁共振实验数据分析软件一般包括加载数据、反演、计算参数和导出报告四个步骤。本文设计的软件力图将不同仪器所采集的数据进行统一处理, 业务流程如图1所示, 具体步骤为:① 数据加载要实现把所有仪器所测的不同格式数据解析成统一的模式;② 进行<i>T</i><sub>2</sub>谱反演;③ 计算参数要根据反演后的<i>T</i><sub>2</sub>谱计算出孔隙度、束缚水饱和度等核磁参数;④ 数据的处理和分析完成后需要导出指定格式的实验报告。</p>
                </div>
                <div class="area_img" id="34">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JYRJ201906017_034.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ28xeDVteFZmK0p3enVSVkNoMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图1 软件业务流程设计" src="Detail/GetImg?filename=images/JYRJ201906017_034.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ28xeDVteFZmK0p3enVSVkNoMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图1 软件业务流程设计  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JYRJ201906017_034.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ28xeDVteFZmK0p3enVSVkNoMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <h4 class="anchor-tag" id="35" name="35"><b>1.1 数据解析</b></h4>
                <div class="p1">
                    <p id="36">软件需要加载各类岩心分析仪测量得到不同格式的原始回波串数据, 首先要对数据进行解析。以CoreSpec-1000型仪器测量得到的RES数据和NIUMAG公司仪器测量得到的PEA数据为例。首先进行RES文件或PEA、PAR文件的格式分析, 如图2所示RES文件中有记录参数信息的头文件和原始回波数据;PEA文件中是原始回波数据, 参数信息在PAR文件中。然后对文件进行解析, 读取RES文件或PEA、PAR文件的数据后, 利用C#面向对象程序设计“CPMGCoreData”类提供的一系列方法将数据都解析成统一的模式。</p>
                </div>
                <div class="area_img" id="37">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JYRJ201906017_037.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ28xeDVteFZmK0p3enVSVkNoMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图2 RES文件数据" src="Detail/GetImg?filename=images/JYRJ201906017_037.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ28xeDVteFZmK0p3enVSVkNoMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图2 RES文件数据  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JYRJ201906017_037.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ28xeDVteFZmK0p3enVSVkNoMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <h4 class="anchor-tag" id="38" name="38"><b>1.2 反演方法</b></h4>
                <div class="p1">
                    <p id="39">对原始回波信号进行反演处理得到<i>T</i><sub>2</sub>分布谱, 这个过程叫做反演<citation id="162" type="reference"><link href="143" rel="bibliography" /><sup>[<a class="sup">8</a>]</sup></citation>。<i>T</i><sub>2</sub>谱的反演方法较多。其中, 最常用的算法有:罚函数法 (BRD) 、非负最小二乘法 (NNLS) 、联合迭代重建算法 (SIRT) 、奇异值分解法 (SVD) 以及针对SVD法的各种改进型反演算法。</p>
                </div>
                <div class="p1">
                    <p id="40">软件的反演模块主要实现了罚函数法 (BRD) 和联合迭代重建算法 (SIRT) 改进的快速高分辨反演算法, 可以在不抽样压缩回波串的情况下, 实时得到<i>T</i><sub>2</sub>谱。</p>
                </div>
                <div class="p1">
                    <p id="41">在岩心核磁共振实验中, 核磁共振横向弛豫信号<i>y</i> (<i>t</i>) 描述为如下的形式:</p>
                </div>
                <div class="p1">
                    <p id="42" class="code-formula">
                        <mathml id="42"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>y</mi><mo stretchy="false"> (</mo><mi>t</mi><mo stretchy="false">) </mo><mo>=</mo><mstyle displaystyle="true"><munder><mo>∑</mo><mi>i</mi></munder><mi>Ρ</mi></mstyle><msub><mrow></mrow><mi>i</mi></msub><mi>e</mi><mi>x</mi><mi>p</mi><mrow><mo> (</mo><mrow><mo>-</mo><mfrac><mi>t</mi><mrow><mi>Τ</mi><msub><mrow></mrow><mrow><mn>2</mn><mi>i</mi></mrow></msub></mrow></mfrac></mrow><mo>) </mo></mrow></mrow></math></mathml>
                    </p>
                </div>
                <div class="p1">
                    <p id="43">其矩阵方程的形式为:</p>
                </div>
                <div class="p1">
                    <p id="44"><i>Y</i>=<b><i>A</i></b>·<i>P</i>      (1) </p>
                </div>
                <div class="p1">
                    <p id="45"><i>Y</i>为测量的横向弛豫信号;<b><i>A</i></b>为<i>n</i>×<i>m</i>系数矩阵;<i>P</i>为所要反演计算的<i>T</i><sub>2</sub>谱中各个弛豫时间所对应的谱幅度值。在此利用联合迭代重建算法 (SIRT) 实现反演<citation id="163" type="reference"><link href="145" rel="bibliography" /><sup>[<a class="sup">9</a>]</sup></citation>, 首先给定谱的初始模型<i>P</i>′, 求出预测弛豫信号<i>Y</i>′与实测弛豫信号<i>Y</i>的误差<i>ΔY</i>, 即:</p>
                </div>
                <div class="p1">
                    <p id="46"><i>ΔY</i>=<i>Y</i>-<i>Y</i>′      (2) </p>
                </div>
                <div class="p1">
                    <p id="47"><mathml id="48"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mstyle displaystyle="true"><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><mi>a</mi></mstyle><msub><mrow></mrow><mrow><mi>i</mi><mi>j</mi></mrow></msub><mi>Δ</mi><mi>p</mi><msub><mrow></mrow><mi>j</mi></msub><mo>=</mo><mi>Δ</mi><mi>y</mi><msub><mrow></mrow><mi>i</mi></msub></mrow></math></mathml>      (3) </p>
                </div>
                <div class="p1">
                    <p id="49">利用<i>Δy</i><sub><i>i</i></sub>求出弛豫谱幅度的修正量<i>Δp</i><sub><i>j</i></sub>, 这是SIRT算法实现的主要思想。<i>p</i><sub><i>j</i></sub>的修正量为:</p>
                </div>
                <div class="p1">
                    <p id="50"><mathml id="51"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>Δ</mi><mi>p</mi><msubsup><mrow></mrow><mi>j</mi><mrow><mo stretchy="false"> (</mo><mi>q</mi><mo>+</mo><mn>1</mn><mo stretchy="false">) </mo></mrow></msubsup><mo>=</mo><mfrac><mn>1</mn><mrow><mi>Ι</mi><mi>A</mi><mo stretchy="false"> (</mo><mi>j</mi><mo stretchy="false">) </mo></mrow></mfrac><mstyle displaystyle="true"><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo stretchy="false">[</mo></mstyle><mi>λ</mi><mi>a</mi><msub><mrow></mrow><mrow><mi>i</mi><mi>j</mi></mrow></msub><mi>Δ</mi><mi>y</mi><msubsup><mrow></mrow><mi>j</mi><mrow><mo stretchy="false"> (</mo><mi>q</mi><mo stretchy="false">) </mo></mrow></msubsup><mo stretchy="false">]</mo></mrow></math></mathml>      (4) </p>
                </div>
                <div class="p1">
                    <p id="52">式中:<i>IA</i> (<i>j</i>) 为矩阵<b><i>A</i></b>第<i>j</i>列非零元素的个数;<i>Δy</i><mathml id="53"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msubsup><mrow></mrow><mi>j</mi><mrow><mo stretchy="false"> (</mo><mi>q</mi><mo stretchy="false">) </mo></mrow></msubsup></mrow></math></mathml>为第<i>q</i>次迭代中第<i>i</i>个弛豫信号的残差。</p>
                </div>
                <div class="p1">
                    <p id="54">通过式 (4) 计算的修正公式为:</p>
                </div>
                <div class="p1">
                    <p id="55"><i>P</i><sup> (<i>q</i>+1) </sup>=<i>P</i><sup> (<i>q</i>) </sup>+<i>ΔP</i>      (5) </p>
                </div>
                <div class="p1">
                    <p id="56">SIRT算法简单容易实现, 在利用算法处理时不需要用户干预, 也不需要设置一些复杂的反演控制参数, 减少了人为因素方面的反演结果误差。</p>
                </div>
                <h4 class="anchor-tag" id="57" name="57"><b>1.3 参数计算</b></h4>
                <h4 class="anchor-tag" id="58" name="58"> (1) 核磁孔隙度的确定</h4>
                <div class="p1">
                    <p id="59">用标准样品对饱和岩样测得的<i>T</i><sub>2</sub>谱进行刻度, 将核磁信号强度转换成孔隙度<citation id="164" type="reference"><link href="147" rel="bibliography" /><sup>[<a class="sup">10</a>]</sup></citation>, 转换公式如下:</p>
                </div>
                <div class="p1">
                    <p id="60"><mathml id="61"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mtext>ϕ</mtext><msub><mrow></mrow><mrow><mtext>n</mtext><mtext>m</mtext><mtext>r</mtext></mrow></msub><mo>=</mo><mstyle displaystyle="true"><munder><mo>∑</mo><mi>i</mi></munder><mrow><mfrac><mrow><mi>m</mi><msub><mrow></mrow><mi>i</mi></msub></mrow><mi>Μ</mi></mfrac></mrow></mstyle><mo>⋅</mo><mfrac><mi>S</mi><mi>s</mi></mfrac><mo>⋅</mo><mfrac><mi>G</mi><mi>g</mi></mfrac><mo>⋅</mo><mfrac><mi>V</mi><mi>v</mi></mfrac><mo>×</mo><mn>1</mn><mn>0</mn><mn>0</mn><mi>%</mi></mrow></math></mathml>      (6) </p>
                </div>
                <div class="p1">
                    <p id="62">式中:ϕ<sub>nmr</sub>为岩样核磁孔隙度值 (%) ;<i>M</i>为标准样品<i>T</i><sub>2</sub>谱的总幅度;<i>V</i>为标准样品总含水量 (cm<sup>3</sup>) ;<i>S</i>为标准样品在核磁共振数据采集时的累积次数;<i>G</i>为标准样品在核磁共振数据采集时的接受增益;<i>m</i><sub><i>i</i></sub>为第<i>i</i>个岩样<i>T</i><sub>2</sub>分量的核磁共振<i>T</i><sub>2</sub>谱幅度;<i>v</i>为岩样的体积 (cm<sup>3</sup>) ;<i>s</i>为岩样在核磁共振数据采集时的累积次数;<i>g</i>为样品在核磁共振数据采集时的接受增益。</p>
                </div>
                <h4 class="anchor-tag" id="63" name="63"> (2) <i>T</i><sub>2</sub>截止值的确定</h4>
                <div class="p1">
                    <p id="64">采用孔隙度累加法确定<i>T</i><sub>2</sub>截止值<citation id="165" type="reference"><link href="149" rel="bibliography" /><sup>[<a class="sup">11</a>]</sup></citation>。先将岩样用水100%饱和得到饱水样, 进行核磁共振测量得到<i>T</i><sub>2</sub>分布、累加孔隙度曲线和有效孔隙度值 (用MPHI表示) 。然后对岩样做脱水处理, 在一定压力的条件下, 使自由水脱出岩样, 得到孔隙空间中只剩下束缚水的离心样, 再做岩心核磁共振测量, 测得<i>T</i><sub>2</sub>分布、累加孔隙度曲线和束缚水孔隙体积值 (用MBVI表示) 。根据测量结果, 以MBVI作一条与横轴平行的平行线, 此线与100%饱和水时的累加孔隙度曲线有一交点, 以该交点作一条与纵轴平行的平行线, 此线与横轴交点对应的<i>T</i><sub>2</sub>值即<i>T</i><sub>2cutoff</sub>值。</p>
                </div>
                <h4 class="anchor-tag" id="65" name="65"> (3) <i>T</i><sub>2</sub>平均值的计算</h4>
                <div class="p1">
                    <p id="66">在分析过程中, 常用<i>T</i><sub>2</sub>的平均值来表征<i>T</i><sub>2</sub>分布, 算术平均值<i>T</i><sub>2<i>s</i></sub>和几何平均值<i>T</i><sub>2<i>g</i></sub>按下式计算<citation id="166" type="reference"><link href="151" rel="bibliography" /><sup>[<a class="sup">12</a>]</sup></citation>:</p>
                </div>
                <div class="p1">
                    <p id="67"><mathml id="68"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>Τ</mi><msub><mrow></mrow><mrow><mn>2</mn><mi>s</mi></mrow></msub><mo>=</mo><mfrac><mrow><mstyle displaystyle="true"><mo>∑</mo><mi>Τ</mi></mstyle><msub><mrow></mrow><mrow><mn>2</mn><mi>i</mi></mrow></msub><mtext>ϕ</mtext><msub><mrow></mrow><mi>i</mi></msub></mrow><mrow><mtext>ϕ</mtext><msub><mrow></mrow><mrow><mtext>n</mtext><mtext>m</mtext><mtext>r</mtext></mrow></msub></mrow></mfrac></mrow></math></mathml>      (7) </p>
                </div>
                <div class="p1">
                    <p id="69"><mathml id="70"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>Τ</mi><msub><mrow></mrow><mrow><mn>2</mn><mi>g</mi></mrow></msub><mo>=</mo><mrow><mo> (</mo><mrow><mstyle displaystyle="true"><mo>∏</mo><mi>Τ</mi></mstyle><msubsup><mrow></mrow><mrow><mn>2</mn><mi>i</mi></mrow><mrow><mtext>ϕ</mtext><msub><mrow></mrow><mi>i</mi></msub></mrow></msubsup></mrow><mo>) </mo></mrow><msup><mrow></mrow><mfrac><mn>1</mn><mrow><mtext>ϕ</mtext><msub><mrow></mrow><mrow><mtext>n</mtext><mtext>m</mtext><mtext>r</mtext></mrow></msub></mrow></mfrac></msup></mrow></math></mathml>      (8) </p>
                </div>
                <div class="p1">
                    <p id="71">式中:ϕ<sub><i>i</i></sub>为对应分量<i>T</i><sub>2<i>i</i></sub>的孔隙度分量。</p>
                </div>
                <h4 class="anchor-tag" id="72" name="72"> (4) 核磁束缚水饱和度的确定</h4>
                <div class="p1">
                    <p id="73">确定核磁共振束缚水饱和度的方法是以小孔隙束缚水体积模型作为理论基础的<i>T</i><sub>2</sub>截止值法<citation id="167" type="reference"><link href="153" rel="bibliography" /><sup>[<a class="sup">13</a>]</sup></citation>。在岩心核磁共振实验测得的<i>T</i><sub>2</sub>谱曲线中, 核磁束缚水饱和度为<i>T</i><sub>2</sub>谱中小于<i>T</i><sub>2</sub>截止值<i>T</i><sub>2cutoff</sub>的不可动峰下包面积和整个<i>T</i><sub>2</sub>谱曲线下包面积的比值。束缚水体积等于核磁束缚水饱和度和孔隙度的乘积, 可动水体积等于岩样的孔隙体积与束缚水体积的差值。</p>
                </div>
                <h4 class="anchor-tag" id="74" name="74"><b>1.4 数据报告导出</b></h4>
                <div class="p1">
                    <p id="75">利用软件对岩心原始回波串数据设置合适参数进行处理和分析后, 可以将文件保存成易于传输和解析的JSON格式文件, 还能够将分析结果导出成所选择的固定格式的EXCLE格式报告, 如图3所示。岩心测量报告中有具体的实验结果和回波数据, 实验结果中包括了岩心的井号、样号、体积、回波间隔等参数信息, 孔隙度、饱和度等核磁参数信息, 回波衰减曲线和反演的<i>T</i><sub>2</sub>分布谱;回波数据中包括了采集时间、原始回波和<i>T</i><sub>2</sub>分布的时间及幅度。</p>
                </div>
                <div class="area_img" id="76">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JYRJ201906017_076.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ28xeDVteFZmK0p3enVSVkNoMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图3 岩心数据报告" src="Detail/GetImg?filename=images/JYRJ201906017_076.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ28xeDVteFZmK0p3enVSVkNoMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图3 岩心数据报告  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JYRJ201906017_076.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ28xeDVteFZmK0p3enVSVkNoMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <h3 id="77" name="77" class="anchor-tag"><b>2 软件设计及实现</b></h3>
                <div class="p1">
                    <p id="78">根据原理和软件业务流程设计, 本软件基于.NET Framework 4.6开发框架在Visual Studio 2017上使用C#语言进行开发。</p>
                </div>
                <h4 class="anchor-tag" id="79" name="79"><b>2.1 软件架构</b></h4>
                <div class="p1">
                    <p id="80">软件架构设计结构如图4所示, 整体分为三大部分:算法、应用模块、数据及图形显示。</p>
                </div>
                <div class="area_img" id="81">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JYRJ201906017_081.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ28xeDVteFZmK0p3enVSVkNoMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图4 软件设计结构" src="Detail/GetImg?filename=images/JYRJ201906017_081.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ28xeDVteFZmK0p3enVSVkNoMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图4 软件设计结构  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JYRJ201906017_081.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ28xeDVteFZmK0p3enVSVkNoMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="p1">
                    <p id="82">软件使用的所有算法统一放在算法库中, 独立于交互界面。本文软件实现了罚函数法和联合迭代重建算法改进的反演算法, 利用外部算法接口, 可以对算法进行持续改进和扩展;应用模块包括数据加载模块、反演模块和参数计算模块;绘图模块和数据管理模块同样相对独立, 并专门设置有外部平台接口, 可以很容易地将研究成果迁移到其他平台进行使用。其中最核心的三个模块设计了四个类:CPMGCoreData类实现了数据的输入与输出;T2Inversion类实现反演的功能;Parameter类实现参数计算, 这三个类都引用了通用算法库的CommonAnalysis类。</p>
                </div>
                <div class="p1">
                    <p id="83">软件主界面如图5所示, 包括菜单栏、绘图区、参数查阅区和状态栏四部分。菜单栏有文件 (File) 、工具 (Tool) 、数据分析 (Data Analysis) 和帮助 (Help) 。</p>
                </div>
                <div class="area_img" id="84">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JYRJ201906017_084.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ28xeDVteFZmK0p3enVSVkNoMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图5 软件主界面" src="Detail/GetImg?filename=images/JYRJ201906017_084.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ28xeDVteFZmK0p3enVSVkNoMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图5 软件主界面  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JYRJ201906017_084.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ28xeDVteFZmK0p3enVSVkNoMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="p1">
                    <p id="85">File菜单主要是加载实验数据、输出报告、打开文件和保存文件;Tool菜单中有不同仪器的工具箱, 功能主要有批量实验数据处理、导出测井曲线文件;Data Analysis菜单主要实现反演和参数计算功能;帮助菜单中是本软件的一些开发过程及人员信息。</p>
                </div>
                <h4 class="anchor-tag" id="86" name="86"><b>2.2 功能实现</b></h4>
                <h4 class="anchor-tag" id="87" name="87"><b>2.2.1 岩心分析数据加载模块</b></h4>
                <div class="p1">
                    <p id="88">本软件将各类岩心分析仪测量得到的原始回波串数据经过CPMGCoreData类提供的一系列方法将数据都解析后, 用统一的模式进行存储。软件目前能实现的主要包括: (1) CoreSpec-1000型岩心核磁共振分析仪测量得到的RES数据; (2) NIUMAG公司生产的各型岩心核磁共振分析仪测量得到的PEA数据; (3) OXFORD公司生产的各型岩心核磁共振分析仪测量得到的RIDAT数据; (4) Magritek公司生产的仪器测量得到的数据; (5) EXCEL通用数据格式。</p>
                </div>
                <div class="p1">
                    <p id="89">软件自动解析并加载原始回波数据和对应的参数信息, 如图6所示。通过参数表格的形式, 显示出了岩心分析仪采集数据的参数及采集得到的具体回波串数据, 并在绘图区域绘制原始回波串 (图7) 。参数表列中主要参数有:等待时间、回波间隔、采集数目等。</p>
                </div>
                <div class="area_img" id="90">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JYRJ201906017_090.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ28xeDVteFZmK0p3enVSVkNoMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图6 数据加载模块界面" src="Detail/GetImg?filename=images/JYRJ201906017_090.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ28xeDVteFZmK0p3enVSVkNoMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图6 数据加载模块界面  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JYRJ201906017_090.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ28xeDVteFZmK0p3enVSVkNoMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="area_img" id="91">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JYRJ201906017_091.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ28xeDVteFZmK0p3enVSVkNoMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图7 原始回波串显示" src="Detail/GetImg?filename=images/JYRJ201906017_091.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ28xeDVteFZmK0p3enVSVkNoMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图7 原始回波串显示  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JYRJ201906017_091.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ28xeDVteFZmK0p3enVSVkNoMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <h4 class="anchor-tag" id="92" name="92"><b>2.2.2 反演模块</b></h4>
                <div class="p1">
                    <p id="93">反演模块利用罚函数法 (BRD) 和联合迭代重建算法 (SIRT) 改进的快速高分辨反演算法对加载的回波串数据进行反演。核心算法是原理中式 (1) -式 (5) 实现的联合迭代重建算法。反演参数设置的参数表区域中, 可以直接在里面进行反演参数的修改。主要参数包括:是否需要进行基线漂移校正、反演平滑级别、起始反演回波、终止反演回波、是否进行边界约束、反演布点数目、布点最小值、布点最大值。在反演参数设置区域填写合适的反演参数后, 单击右下角反演按钮, 即可进行快速高分辨反演, 反演结果 (图8) 会显示在左下角的绘图区域。反演的同时, 会对原始回波串进行拟合观察反演结果的好坏。</p>
                </div>
                <div class="area_img" id="94">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JYRJ201906017_094.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ28xeDVteFZmK0p3enVSVkNoMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图8 反演模块及反演结果" src="Detail/GetImg?filename=images/JYRJ201906017_094.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ28xeDVteFZmK0p3enVSVkNoMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图8 反演模块及反演结果  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JYRJ201906017_094.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ28xeDVteFZmK0p3enVSVkNoMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <h4 class="anchor-tag" id="95" name="95"><b>2.2.3 参数计算模块</b></h4>
                <div class="p1">
                    <p id="96">参数计算模块采用了参数计算原理中描述的确定孔隙度、<i>T</i><sub>2</sub>截止值等核磁参数的公式和方法进行计算。图9所示的参数计算设置区域中, 主要需要设置的参数包括:样品体积, <i>T</i><sub>2</sub>截止值, 渗透率计算模型参数等。反演完成后, 在参数设置区域填写正确的岩心分析参数, 然后单击分析按钮即可完成分析, 其中最重要的参数是岩心的体积。参数计算能够得到<i>T</i><sub>2</sub>几何均值、有效孔隙度、可动孔隙度、渗透率、束缚水饱和度等参数。</p>
                </div>
                <div class="area_img" id="97">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JYRJ201906017_097.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ28xeDVteFZmK0p3enVSVkNoMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图9 参数计算模块及计算结果" src="Detail/GetImg?filename=images/JYRJ201906017_097.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ28xeDVteFZmK0p3enVSVkNoMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图9 参数计算模块及计算结果  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JYRJ201906017_097.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ28xeDVteFZmK0p3enVSVkNoMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <h3 id="98" name="98" class="anchor-tag"><b>3 可靠性验证及应用实例</b></h3>
                <h4 class="anchor-tag" id="99" name="99"><b>3.1 可靠性验证</b></h4>
                <div class="p1">
                    <p id="100">为了验证软件的可靠性, 将本文研发的软件和其他软件对回波信息处理的结果进行比对, 以CoreSpec-1000型仪器和NIUMAG公司仪器的配套软件为例。</p>
                </div>
                <div class="p1">
                    <p id="101">本软件和CoreSpec-1000型仪器配套的软件进行比对。用CoreSpec-1000型仪器测量硫酸铜标样, 图10为CoreSpec-1000型仪器的配套软件处理的<i>T</i><sub>2</sub>谱和本软件对原始回波数据进行反演处理得到的<i>T</i><sub>2</sub>谱, 可以看出峰值位置非常接近, 都在200  ms附近。</p>
                </div>
                <div class="area_img" id="102">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JYRJ201906017_102.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ28xeDVteFZmK0p3enVSVkNoMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图10 CoreSpec-1000配套软件和本软件反演的T2谱比对" src="Detail/GetImg?filename=images/JYRJ201906017_102.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ28xeDVteFZmK0p3enVSVkNoMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图10 CoreSpec-1000配套软件和本软件反演的<i>T</i><sub>2</sub>谱比对  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JYRJ201906017_102.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ28xeDVteFZmK0p3enVSVkNoMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="p1">
                    <p id="103">本软件和NIUMAG公司生产的仪器配套的软件进行比对。用NIUMAG公司生产的仪器测量一块饱和水砂岩岩心, 图11是NIUMAG仪器配套软件反演的<i>T</i><sub>2</sub>谱和用本软件进行反演处理得到的谱。可以观察到两个<i>T</i><sub>2</sub>谱的形态相似, 峰值位置也非常接近。</p>
                </div>
                <div class="p1">
                    <p id="104">这两个验证说明本文研发的软件和其他软件处理结果一致, 验证了本软件的可靠性。</p>
                </div>
                <div class="area_img" id="105">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JYRJ201906017_105.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ28xeDVteFZmK0p3enVSVkNoMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图11 NIUMAG仪器配套软件和本软件反演的T2谱比对" src="Detail/GetImg?filename=images/JYRJ201906017_105.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ28xeDVteFZmK0p3enVSVkNoMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图11 NIUMAG仪器配套软件和本软件反演的<i>T</i><sub>2</sub>谱比对  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JYRJ201906017_105.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ28xeDVteFZmK0p3enVSVkNoMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <h4 class="anchor-tag" id="106" name="106"><b>3.2 应用实例</b></h4>
                <div class="p1">
                    <p id="107">研发的岩心核磁共振实验数据分析软件可以使不同仪器测量同样岩心得到的回波信息进行对比分析。以对一块饱和水的砂岩岩心进行不同仪器的核磁共振比对实验为例, 具体步骤为:</p>
                </div>
                <div class="p1">
                    <p id="108">第一步:用CoreSpec-1000型仪器和NIUMAG仪器对一块饱和水的砂岩岩心进行核磁共振实验, 得到两组岩心数据。</p>
                </div>
                <div class="p1">
                    <p id="109">第二步:将两仪器的两组岩心数据导出, 用研发的岩心核磁共振实验数据分析软件处理这两组数据, 进行反演得到<i>T</i><sub>2</sub>谱。</p>
                </div>
                <div class="p1">
                    <p id="110">图12是本文研发的软件对NIUMAG和CoreSpec-1000两种仪器测得同样岩心两组回波数据进行反演得到的<i>T</i><sub>2</sub>谱。在利用本软件对两组数据处理的反演方法和参数相同的情况下, 观察到谱的形态有差异, 峰值位置不同。图12 (a) 中主峰峰值位置在100 ms附近, 图12 (b) 主峰峰值位置在200 ms附近, 是由于图12 (a) 的仪器主频较高, 图12 (b) 的仪器主频较低, 反映出同样岩心<i>T</i><sub>2</sub>谱的不同是仪器性能不同所导致的。说明了本软件用统一的反演算法处理岩心数据, 能对比同样岩心的回波信息反映出仪器性能的不同。</p>
                </div>
                <div class="area_img" id="111">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JYRJ201906017_111.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ28xeDVteFZmK0p3enVSVkNoMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图12 软件对NIUMAG仪器和CoreSpec-1000型仪器" src="Detail/GetImg?filename=images/JYRJ201906017_111.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ28xeDVteFZmK0p3enVSVkNoMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图12 软件对NIUMAG仪器和CoreSpec-1000型仪器  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JYRJ201906017_111.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ28xeDVteFZmK0p3enVSVkNoMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="p1">
                    <p id="112">软件可以一次处理多回波间隔的数据得到长短<i>T</i><sub><i>E</i></sub>的核磁<i>T</i><sub>2</sub>谱。以CoreSpec-1000型仪器所测量的两个回波间隔分别为0.1 ms和0.2 ms的数据为例, 用本软件一次进行处理, 得到了如图13所示的回波串和长短<i>T</i><sub><i>E</i></sub>的<i>T</i><sub>2</sub>谱。</p>
                </div>
                <div class="area_img" id="113">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JYRJ201906017_113.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ28xeDVteFZmK0p3enVSVkNoMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图13 多回波间隔数据处理结果" src="Detail/GetImg?filename=images/JYRJ201906017_113.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ28xeDVteFZmK0p3enVSVkNoMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图13 多回波间隔数据处理结果  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JYRJ201906017_113.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ28xeDVteFZmK0p3enVSVkNoMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <h3 id="114" name="114" class="anchor-tag"><b>4 结 语</b></h3>
                <div class="p1">
                    <p id="115">本文开发的软件处理岩心核磁共振实验数据结果精确, 操作简单方便, 且具有通用性, 实现了对所有仪器测量的回波数据进行统一处理和分析, 可以对比分析不同仪器测量同样岩心的回波信息, 反映出仪器性能的差异。另外软件预留有外部接口, 方便扩展, 其中其他系统接口可以对接外部平台, 外部算法接口可以迅速实现新的算法。</p>
                </div>

        <!--brief end-->
        
        <!--conten left  end-->
        <!--增强附件-->
        

        <!--reference start-->
            <div class="reference anchor-tag" id="a_bibliography">
                    <h3>参考文献</h3>
                                        <p id="129">
                            <a id="bibliography_1" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=CJJS200103002&amp;v=MDUzNzh0R0ZyQ1VSN3FmWnVadEZ5dmxVcjdKSmlmQmZiRzRIdERNckk5RlpvUUtESDg0dlI0VDZqNTRPM3pxcUI=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ28xeDVteFZmK0p3enVSVkNoMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[1]</b>王忠东, 汪浩, 李能根, 等.核磁共振岩心基础实验分析[J].测井技术, 2001, 25 (3) :170-174.
                            </a>
                        </p>
                        <p id="131">
                            <a id="bibliography_2" target="_blank" href="http://scholar.cnki.net/result.aspx?q=NMR logging and core analysis-simplified">

                                <b>[2]</b>Murphy D P.NMR logging and core analysis-simplified[J].World Oil, 1995, 216 (4) :65-70.
                            </a>
                        </p>
                        <p id="133">
                            <a id="bibliography_3" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Core analysis by low-field NMR">

                                <b>[3]</b>Morriss C, Rossini D, Straley C, et al.Core analysis by lowfield NMR[J].The Log Analyst, 1997, 38 (2) :84-94.
                            </a>
                        </p>
                        <p id="135">
                            <a id="bibliography_4" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=CJJS801.009&amp;v=MDM3ODhIOC9NcjRZcVllc01EUTR4enhZUzcweCtRSHZyMzMwM2ViQ1VSYnVmWmVkdEZ5bmtVZz09SmlmQmZidTQ=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ28xeDVteFZmK0p3enVSVkNoMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[4]</b>肖立志, 石红兵.低场核磁共振岩心分析及其在测井解释中的应用[J].测井技术, 1998, 22 (1) :42-49.
                            </a>
                        </p>
                        <p id="137">
                            <a id="bibliography_5" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CBBD&amp;filename=0007030069242999&amp;v=MDY2NTB6SUlWOFZWVjI3R2JPN0h0SEtwbzFCWnVJR0JSTTh6eFVTbURkOVNIN24zeEU5ZmJ2bktyaWZaZVp2RnlubVU3&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ28xeDVteFZmK0p3enVSVkNoMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[5]</b>肖立志.核磁共振成像测井与岩石核磁共振及其应用[M].北京:科学出版社, 1998.
                            </a>
                        </p>
                        <p id="139">
                            <a id="bibliography_6" >
                                    <b>[6]</b>
                                王忠东, 魏钢, 柯启宇.岩心核磁实验解释分析软件的编制与应用[C]//第八届核技术与测井技术年会, 2002.
                            </a>
                        </p>
                        <p id="141">
                            <a id="bibliography_7" >
                                    <b>[7]</b>
                                纽迈岩心核磁共振分析测量软件V4.0用户手册[M].
                            </a>
                        </p>
                        <p id="143">
                            <a id="bibliography_8" target="_blank" href="http://scholar.cnki.net/result.aspx?q=NMR TECHNIQUE FOR THE ANALYSIS OF PORE STRUCTURE: NUMERICAL INVERSION OF RELAXATION MEASUREMENTS">

                                <b>[8]</b>Munn K, Smith D M.A NMR technique for the analysis of pore structure:Numerical inversion of relaxation measurements[J].Journal of Colloid&amp;Interface Science, 1987, 119 (1) :117-126.
                            </a>
                        </p>
                        <p id="145">
                            <a id="bibliography_9" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=CJJS200305006&amp;v=MzAxMzhRS0RIODR2UjRUNmo1NE8zenFxQnRHRnJDVVI3cWZadVp0Rnl2bFVyN0pKaWZCZmJHNEh0TE1xbzlGWW8=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ28xeDVteFZmK0p3enVSVkNoMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[9]</b>姚绪刚, 王忠东.一种新的核磁共振弛豫谱反演算法[J].测井技术, 2003, 27 (5) :373-376.
                            </a>
                        </p>
                        <p id="147">
                            <a id="bibliography_10" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=SYSD200901020&amp;v=MzAxNjBGckNVUjdxZlp1WnRGeXZsVXI3Sk5qVFlhckc0SHRqTXJvOUhaSVFLREg4NHZSNFQ2ajU0TzN6cXFCdEc=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ28xeDVteFZmK0p3enVSVkNoMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[10]</b>肖秋生, 朱巨义.岩样核磁共振分析方法及其在油田勘探中的应用[J].石油实验地质, 2009, 31 (1) :97-100.
                            </a>
                        </p>
                        <p id="149">
                            <a id="bibliography_11" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=DQWJ200801024&amp;v=MjMwNDBJVHpjWkxHNEh0bk1ybzlIWUlRS0RIODR2UjRUNmo1NE8zenFxQnRHRnJDVVI3cWZadVp0Rnl2bFVyN0o=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ28xeDVteFZmK0p3enVSVkNoMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[11]</b>肖亮, 肖忠祥.核磁共振测井T2cutoff确定方法及适用性分析[J].地球物理学进展, 2008, 23 (1) :167-172.
                            </a>
                        </p>
                        <p id="151">
                            <a id="bibliography_12" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=SYXB201603011&amp;v=MjU4MDNUYkxHNEg5Zk1ySTlFWllRS0RIODR2UjRUNmo1NE8zenFxQnRHRnJDVVI3cWZadVp0Rnl2bFVyN0pOalQ=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ28xeDVteFZmK0p3enVSVkNoMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[12]</b>白松涛, 程道解, 万金彬, 等.砂岩岩石核磁共振T<sub>2</sub>谱定量表征[J].石油学报, 2016, 37 (3) :382-391.
                            </a>
                        </p>
                        <p id="153">
                            <a id="bibliography_13" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Tapered cutoffs for magnetic resonance bound water volume">

                                <b>[13]</b>Kleinberg R L, Boyd A.Tapered cutoffs for magnetic resonance bound water volume[C]//SPE Annual Technical Conference and Exhibition, 1997, 37:387-388.
                            </a>
                        </p>
            </div>
        <!--reference end-->
        <!--footnote start-->
        <!--footnote end-->



    </div>

        <input id="fileid" type="hidden" value="JYRJ201906017" />
        <input id="dpi" type="hidden" value="300" />
    </div>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?6e967eb120601ea41b9d312166416aa6";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
</script>

    


<input id="hid_uid" name="hid_uid" type="hidden" value="WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ28xeDVteFZmK0p3enVSVkNoMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
<input id="hid_kLogin_headerUrl" name="hid_kLogin_headerUrl" type="hidden" value="/KLogin/Request/GetKHeader.ashx%3Fcallback%3D%3F" />
<input id="hid_kLogin_footerUrl" name="hid_kLogin_footerUrl" type="hidden" value="/KLogin/Request/GetKFooter.ashx%3Fcallback%3D%3F" />
<div class="btn-link" style="display: none"><a target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JYRJ201906017&amp;v=MTE5NjFIODR2UjRUNmo1NE8zenFxQnRHRnJDVVI3cWZadVp0Rnl2a1c3dkFMelRaWkxHNEg5ak1xWTlFWTRRS0Q=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ28xeDVteFZmK0p3enVSVkNoMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">知网节</a></div>
<div class="popflow" id="popupTips" style="display: none;">
    <div class="popflowArr"></div>
    <div class="popflowCot">
        <div class="hd"><a href="javascript:void(0);" onclick="$('#popupTips').hide();$('#popupmsg').html('')" class="close">X</a></div>
        <div class="bd">
            <p class="mes" id="popupmsg" name="popupmsg"></p>
          
        </div>
    </div>
</div>
<input type="hidden" id="myexport" value="//kns.cnki.net" />

<input type="hidden" id="KPCAPIPATH" value="//ishufang.cnki.net" />
<input type="hidden" id="CitedTimes" value="" />
<div class="link" id="GLSearch" style="display: none;">
    <i class="icon-trangle"></i>
    <div class="inner">
        <a class="icon" id="copytext">复制</a>
        <a class="icon" target="_blank" onclick="searchCRFD(this)">工具书搜索</a>
    </div>
</div>




<input id="hidVirtualPath" name="hidVirtualPath" type="hidden" value="/kxreader" />
<script src="/kxreader/bundles/detail?v=-ULdk-c6FkZHtJA2KAXPgHnyA8mtgyPnBde_C2VZ2BY1"></script>

<script src="/kxreader/Scripts/layer.min.js" type="text/javascript"></script>

<div id="footerBox" class="rootw footer">
</div>
<script>
    if (typeof FlushLogin == 'function') {
        FlushLogin();
    }
    modifyEcpHeader(true);
</script>

<!--图片放大功能 start-->
<script src="/kxreader/bundles/imagebox?v=W4phPu9SNkGcuPeJclikuVE3PpRyIW_gnfjm_19nynI1"></script>

<script type="text/javascript">
    $(function () {
        var j = $.noConflict();
        j(function () {
            j(".zoom-in,.btn-zoomin").imgbox({
                'alignment': 'center',
                'allowMultiple': false,
                'overlayShow': true
            });
        })
    });
</script>
<!--图片放大功能 end-->
<div class="fixedbar">
    <div class="backtop hiddenV" id="backtop">
        <a id="backTopSide" href="javascript:scroll(0,0);" title=""></a>
    </div>
</div>
<script type="text/javascript" src="/kxreader/Scripts/MathJax-2.6-latest/MathJax.js?config=MML_HTMLorMML-full"></script>

</body>
</html>
