<!DOCTYPE html>
<html>
<head>
    <title>全文阅读--XML全文阅读--中国知网</title>
    <link rel="icon" href="/kxreader/favicon.ico" />
    <link rel="shortcut Icon" href="/kxreader/favicon.ico" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="keywords" content="文献 XML KBASE CNKI 中国知网" />
    <meta name="description" content="XML文献检索" />
    <link href="/kxreader/Content/css/detail?v=qX2z2KjRAEyQiNfAbKtl7dLnsqFoQ5Jdw3TZfDf0n1k1" rel="stylesheet"/>

    <script type="text/javascript">
        var APPPATH = '/kxreader';
    </script>
</head>

<body>
    
<script type="text/javascript" src="//login.cnki.net/TopLogin/api/loginapi/get?type=top&amp;localCSS=&amp;returnurl=%2f%2fkns.cnki.net%2f%2fKXReader%2fDetail%3fTIMESTAMP%3d637135764793877500%26DBCODE%3dCJFD%26TABLEName%3dCJFDLAST2019%26FileName%3dJYRJ201904048%26RESULT%3d1%26SIGN%3dyvlFTYSoCoPchbLcC7SWaHn6PEo%253d"></script>

<div id="headerBox" class="header">
    <div class="topbar">
        <div class="textalign">
            <a href="/kxreader/Detail?dbcode=CJFD&amp;filename=JYRJ201904048&amp;align=md">
                <i class="icon-cen active" title="居中对齐"></i>
            </a>
            <a href="/kxreader/Detail?dbcode=CJFD&amp;filename=JYRJ201904048&amp;align=lt">
                <i class="icon-left " title="左对齐"></i>
            </a>
        </div>
        <h6 class="free-tip"><i class="icon"></i>HTML阅读开放试用阶段，欢迎体验！</h6>
    </div>
</div>

    



<div class="btn-link" style="display: none"><a target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JYRJ201904048&amp;v=MDc5NDVSNFQ2ajU0TzN6cXFCdEdGckNVUjdxZlp1WnRGeXpnVTcvTUx6VFpaTEc0SDlqTXE0OUJiSVFLREg4NHY=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">知网节</a></div>

    <div class="main">

        

    <div class="sidebar-a">
        <!--sidebar start-->
        <div class="sidenav">
            <div class="arrow"><span></span></div>
            <!--sidebar_list start-->
            <dl class="sidenav-list">
                    <dt class="tit">目录结构</dt>
                            <dd class="guide">
                                    <p><a href="#31" data-title="&lt;b&gt;0 引 言&lt;/b&gt; "><b>0 引 言</b></a><i></i></p>
                                                            </dd>
                            <dd class="guide">
                                    <p><a href="#35" data-title="&lt;b&gt;1 方案设计&lt;/b&gt; "><b>1 方案设计</b></a><i></i></p>
                                                                    <ul class="contentbox">
                                                <li><a href="#36" data-title="&lt;b&gt;1.1 总体架构设计&lt;/b&gt;"><b>1.1 总体架构设计</b></a></li>
                                                <li><a href="#42" data-title="&lt;b&gt;1.2 主要功能设计&lt;/b&gt;"><b>1.2 主要功能设计</b></a></li>
                                    </ul>
                            </dd>
                            <dd class="guide">
                                    <p><a href="#75" data-title="&lt;b&gt;2 系统实现&lt;/b&gt; "><b>2 系统实现</b></a><i></i></p>
                                                                    <ul class="contentbox">
                                                <li><a href="#77" data-title="&lt;b&gt;2.1 动态支付模块实现&lt;/b&gt;"><b>2.1 动态支付模块实现</b></a></li>
                                                <li><a href="#82" data-title="&lt;b&gt;2.2 风险评估模块实现&lt;/b&gt;"><b>2.2 风险评估模块实现</b></a></li>
                                                <li><a href="#87" data-title="&lt;b&gt;2.3 认证鉴权模块实现&lt;/b&gt;"><b>2.3 认证鉴权模块实现</b></a></li>
                                    </ul>
                            </dd>
                            <dd class="guide">
                                    <p><a href="#101" data-title="&lt;b&gt;3 核心算法&lt;/b&gt; "><b>3 核心算法</b></a><i></i></p>
                                                                    <ul class="contentbox">
                                                <li><a href="#102" data-title="&lt;b&gt;3.1 基于TOTP算法的动态支付密钥技术&lt;/b&gt;"><b>3.1 基于TOTP算法的动态支付密钥技术</b></a></li>
                                                <li><a href="#117" data-title="&lt;b&gt;3.2 基于朴素贝叶斯算法的风险评估算法&lt;/b&gt;"><b>3.2 基于朴素贝叶斯算法的风险评估算法</b></a></li>
                                    </ul>
                            </dd>
                            <dd class="guide">
                                    <p><a href="#134" data-title="&lt;b&gt;4 系统运行与测试&lt;/b&gt; "><b>4 系统运行与测试</b></a><i></i></p>
                                                                    <ul class="contentbox">
                                                <li><a href="#135" data-title="&lt;b&gt;4.1 系统运行&lt;/b&gt;"><b>4.1 系统运行</b></a></li>
                                                <li><a href="#161" data-title="&lt;b&gt;4.2 系统测试&lt;/b&gt;"><b>4.2 系统测试</b></a></li>
                                    </ul>
                            </dd>
                            <dd class="guide">
                                    <p><a href="#184" data-title="&lt;b&gt;5 结 语&lt;/b&gt; "><b>5 结 语</b></a><i></i></p>
                                                            </dd>
                            <dd class="guide">
                                    <p><a href="#" data-title="文内图表 ">文内图表</a><i></i></p>
                                                                    <ul class="contentbox">
                                                <li><a href="#38" data-title="图1 移动安全支付系统总体架构">图1 移动安全支付系统总体架构</a></li>
                                                <li><a href="#45" data-title="图2 支付流程">图2 支付流程</a></li>
                                                <li><a href="#51" data-title="图3 风险评估流程">图3 风险评估流程</a></li>
                                                <li><a href="#80" data-title="图4 动态密钥生成流程">图4 动态密钥生成流程</a></li>
                                                <li><a href="#89" data-title="图5 短信发送流程">图5 短信发送流程</a></li>
                                                <li><a href="#94" data-title="图6 Sign过程">图6 Sign过程</a></li>
                                                <li><a href="#116" data-title="图7 TOTP算法的生成与认证">图7 TOTP算法的生成与认证</a></li>
                                                <li><a href="#127" data-title="图8 贝叶斯风险评估流程图">图8 贝叶斯风险评估流程图</a></li>
                                                <li><a href="#137" data-title="图9 系统部署方案">图9 系统部署方案</a></li>
                                                <li><a href="#160" data-title="图10 系统运行">图10 系统运行</a></li>
                                                <li><a href="#169" data-title="&lt;b&gt;表1 训练样本&lt;/b&gt;"><b>表1 训练样本</b></a></li>
                                                <li><a href="#172" data-title="&lt;b&gt;表2 判断结果统计表&lt;/b&gt;"><b>表2 判断结果统计表</b></a></li>
                                                <li><a href="#174" data-title="&lt;b&gt;表3 三次3折交叉验证统计表&lt;/b&gt;"><b>表3 三次3折交叉验证统计表</b></a></li>
                                                <li><a href="#178" data-title="&lt;b&gt;表4 功能测试用例&lt;/b&gt;"><b>表4 功能测试用例</b></a></li>
                                                <li><a href="#181" data-title="&lt;b&gt;表5 性能测试用例&lt;/b&gt;"><b>表5 性能测试用例</b></a></li>
                                                <li><a href="#182" data-title="&lt;b&gt;表6 性能测试表&lt;/b&gt;"><b>表6 性能测试表</b></a></li>
                                    </ul>
                            </dd>
                                    <dd class="guide">
                                        <h6>
                                            <p><a href="#a_bibliography">参考文献</a> </p>
                                        </h6>
                                    </dd>

            </dl>
        </div>
        <!--sidebar end-->
        &nbsp;
        <!--此处有一空格符 勿删-->
    </div>

                <div class="sidebar-b three-collumn" style="width:0;">
            <div class="refer" style="width: 0;">
                <div class="arrow off" title="参考文献"><span></span></div>
                <div class="js-scrollbox" >
                    
                    <div class="subbox active">
                        <h4>
                            <span class="tit">参考文献</span>
                            <a class="close" href="javascript:void(0)">x</a>
                        </h4>
                        <div class="side-scroller">
                            <ul class="refer-list">
                                <li id="3">


                                    <a id="bibliography_1" title=" 陈慧慧. 新型移动支付创新发展及安全监管研究[J]. 电信网技术, 2016 (5) :37-39." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=DXWJ201605011&amp;v=MzA0OTVFWllRS0RIODR2UjRUNmo1NE8zenFxQnRHRnJDVVI3cWZadVp0Rnl6Z1U3L01JVFhjWkxHNEg5Zk1xbzk=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[1]</b>
                                         陈慧慧. 新型移动支付创新发展及安全监管研究[J]. 电信网技术, 2016 (5) :37-39.
                                    </a>
                                </li>
                                <li id="5">


                                    <a id="bibliography_2" title=" Lu J, Yang Z, Li L, et al. Multiple schemes for mobile payment authentication using QR code and visual cryptography[J]. Mobile Information Systems, 2017, 2017, Article ID 4356038:1-12." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=SJHD&amp;filename=SJHD950F9FB6B8940B36E97A9CBB098BE986&amp;v=MjgxMjBJRnBtYUJ1SFlmT0dRbGZCckxVMDV0dGh3TDIvd0t3PU5pZkRhcnE5SHFmRjJmMURGdU1HQ0h4THpCQm00emdNUVF5UTNoSThjY0RoVExLWkNPTnZGU2lXV3I3Sg==&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[2]</b>
                                         Lu J, Yang Z, Li L, et al. Multiple schemes for mobile payment authentication using QR code and visual cryptography[J]. Mobile Information Systems, 2017, 2017, Article ID 4356038:1-12.
                                    </a>
                                </li>
                                <li id="7">


                                    <a id="bibliography_3" title=" Burch L L, Buss D F, Henderson L H. Time-based one time password (totp) for network authentication: U.S. Patent Application 15/138, 521[P]. 2016:8-18." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Time-based one time password (totp) for network authentication">
                                        <b>[3]</b>
                                         Burch L L, Buss D F, Henderson L H. Time-based one time password (totp) for network authentication: U.S. Patent Application 15/138, 521[P]. 2016:8-18.
                                    </a>
                                </li>
                                <li id="9">


                                    <a id="bibliography_4" title=" 叶云, 石聪聪, 余勇, 等.保护隐私的分布式朴素贝叶斯挖掘[J]. 应用科学学报, 2017, 35 (1) :1-10." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=YYKX201701001&amp;v=MTMxNjg2ajU0TzN6cXFCdEdGckNVUjdxZlp1WnRGeXpnVTcvTVBEVEFkckc0SDliTXJvOUZaWVFLREg4NHZSNFQ=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[4]</b>
                                         叶云, 石聪聪, 余勇, 等.保护隐私的分布式朴素贝叶斯挖掘[J]. 应用科学学报, 2017, 35 (1) :1-10.
                                    </a>
                                </li>
                                <li id="11">


                                    <a id="bibliography_5" title=" 张建标, 徐万山, 刘国杰, 等.一种结合网络行为分析的可信连接架构[J]. 信息网络安全, 2018 (3) :78-85." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=XXAQ201803012&amp;v=MTI2MjVSNFQ2ajU0TzN6cXFCdEdGckNVUjdxZlp1WnRGeXpnVTcvTVBUWEtmN0c0SDluTXJJOUVab1FLREg4NHY=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[5]</b>
                                         张建标, 徐万山, 刘国杰, 等.一种结合网络行为分析的可信连接架构[J]. 信息网络安全, 2018 (3) :78-85.
                                    </a>
                                </li>
                                <li id="13">


                                    <a id="bibliography_6" title=" 孙韩林, 刘建华. 公众网络统一身份认证服务及标准研究[J]. 电信科学, 2017, 29 (2) :84-88." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=DXKX201302014&amp;v=MTAyMTBMTXJZOUVZSVFLREg4NHZSNFQ2ajU0TzN6cXFCdEdGckNVUjdxZlp1WnRGeXpnVTcvTUlUWEFkckc0SDk=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[6]</b>
                                         孙韩林, 刘建华. 公众网络统一身份认证服务及标准研究[J]. 电信科学, 2017, 29 (2) :84-88.
                                    </a>
                                </li>
                                <li id="15">


                                    <a id="bibliography_7" title=" 邓红, 杨茹, 王亚东. 基于云计算平台的鉴权分析[J]. 信息技术, 2014, 38 (7) :180-182." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=HDZJ201407048&amp;v=MDc5MzhRS0RIODR2UjRUNmo1NE8zenFxQnRHRnJDVVI3cWZadVp0Rnl6Z1U3L01MU25SWkxHNEg5WE1xSTlCYkk=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[7]</b>
                                         邓红, 杨茹, 王亚东. 基于云计算平台的鉴权分析[J]. 信息技术, 2014, 38 (7) :180-182.
                                    </a>
                                </li>
                                <li id="17">


                                    <a id="bibliography_8" title=" Owen S. Zxing[M]. Zebra Crossing, 2013." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Zxing">
                                        <b>[8]</b>
                                         Owen S. Zxing[M]. Zebra Crossing, 2013.
                                    </a>
                                </li>
                                <li id="19">


                                    <a id="bibliography_9" >
                                        <b>[9]</b>
                                     Pedregosa F, Varoquaux G, Gramfort A, et al. Scikit-learn: Machine learning in Python[J]. Journal of machine learning research, 2011, 12 (10) : 2825-2830.</a>
                                </li>
                                <li id="21">


                                    <a id="bibliography_10" title=" M’Raihi D, Machani S, Pei M, et al. Totp: Time-based one-time password algorithm[R]. RFC 6238, 2011." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=TOTP:Time-based one-time password algorithm">
                                        <b>[10]</b>
                                         M’Raihi D, Machani S, Pei M, et al. Totp: Time-based one-time password algorithm[R]. RFC 6238, 2011.
                                    </a>
                                </li>
                                <li id="23">


                                    <a id="bibliography_11" title=" McCallum A, Nigam K. A comparison of event models for naive bayes text classification[C].AAAI-98 workshop on learning for text categorization. 1998, 752: 41-48." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=A comparison of event models for Naive Bayes text classification">
                                        <b>[11]</b>
                                         McCallum A, Nigam K. A comparison of event models for naive bayes text classification[C].AAAI-98 workshop on learning for text categorization. 1998, 752: 41-48.
                                    </a>
                                </li>
                                <li id="25">


                                    <a id="bibliography_12" title=" 邓小鹏, 邢春晓, 蔡莲红. Web 应用测试技术进展[J]. 计算机研究与发展, 2007, 44 (8) :1273-1283." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JFYZ200708000&amp;v=MjYzMjhadVp0Rnl6Z1U3L01MeXZTZExHNEh0Yk1wNDlGWklRS0RIODR2UjRUNmo1NE8zenFxQnRHRnJDVVI3cWY=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[12]</b>
                                         邓小鹏, 邢春晓, 蔡莲红. Web 应用测试技术进展[J]. 计算机研究与发展, 2007, 44 (8) :1273-1283.
                                    </a>
                                </li>
                                <li id="27">


                                    <a id="bibliography_13" title=" 宋巍, 张春柳, 邬斌亮. Web系统性能测试研究与实践[J]. 计算机应用与软件, 2015, 32 (3) : 4-6." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JYRJ201503003&amp;v=MDM3NDlqNTRPM3pxcUJ0R0ZyQ1VSN3FmWnVadEZ5emdVNy9NTHpUWlpMRzRIOVRNckk5Rlo0UUtESDg0dlI0VDY=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[13]</b>
                                         宋巍, 张春柳, 邬斌亮. Web系统性能测试研究与实践[J]. 计算机应用与软件, 2015, 32 (3) : 4-6.
                                    </a>
                                </li>
                                <li id="29">


                                    <a id="bibliography_14" title=" Memon P, Hafiz T, Bhatti S, et al. Comparative Study of Testing Tools Blazemeter and Apache Jmeter[J]. Sukkur IBA Journal of Computing and Mathematical Sciences, 2018, 2 (1) :70-76." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Comparative Study of Testing Tools Blazemeter and Apache Jmeter">
                                        <b>[14]</b>
                                         Memon P, Hafiz T, Bhatti S, et al. Comparative Study of Testing Tools Blazemeter and Apache Jmeter[J]. Sukkur IBA Journal of Computing and Mathematical Sciences, 2018, 2 (1) :70-76.
                                    </a>
                                </li>
                            </ul>
                            <div style='display: none;' class="zqscroller" >
                                <h4 class="">附加材料</h4>
                                <ul></ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            &nbsp;
            <!--此处有一空格符 勿删-->
        </div>

        
    <div class="content">



        <!--tips start-->
                            <div class="tips">
                    <a href="http://navi.cnki.net/KNavi/JournalDetail?pcode=CJFD&amp;pykm=JYRJ" target="_blank">计算机应用与软件</a>
                2019,36(04),295-301+322 DOI:10.3969/j.issn.1000-386x.2019.04.047            </div>
        <!--tips end-->
            <div class="top-title">
                <h1 class="title">
                    <span class="vm"><b>移动云安全支付系统设计与实现</b></span>
                                    </h1>

            </div>
                        <h2>
                                <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=au&amp;skey=%E6%9B%B9%E9%B9%8F%E9%A3%9E&amp;code=10630700&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">曹鹏飞</a>
                                <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=au&amp;skey=%E6%9D%8E%E6%9D%B0&amp;code=40441642&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">李杰</a>
                                <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=au&amp;skey=%E6%9D%A8%E5%90%9B&amp;code=24371403&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">杨君</a>
                </h2>
                    <h2>
                    <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=in&amp;skey=%E4%B8%89%E6%B1%9F%E5%AD%A6%E9%99%A2%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6%E4%B8%8E%E5%B7%A5%E7%A8%8B%E5%AD%A6%E9%99%A2&amp;code=0219280&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">三江学院计算机科学与工程学院</a>
            </h2>

        
<div class="link">
    <a id="aexport" class="icon icon-output"  onclick="" href="javascript:void(0);"><i></i>导出/参考文献</a>
    
    <span class="shareBoard" onmouseover="$('#sharedet').show();$('#this').addClass('shareBoardCUR')" onmouseout="$('#sharedet').hide();$('#this').removeClass('shareBoardCUR')">
        <a class="icon icon-share" href="#"><i></i>分享<em></em></a>
        <ul class="shareHide" id="sharedet" style="display: none;">
            <li><a title="复制链接" class="copy" onclick="" href="#"><i></i>复制链接</a></li>
            <li><a title="分享到新浪微博" class="xl" onclick="" href="javascript:common.ShareAction('xl');"><i></i>新浪微博</a></li>
            <li>
                <a title="分享到微信" class="wx" onclick="" href="#"><i></i>微信扫一扫</a>
                <div class="qrcode"><img src='' alt='' /></div>
            </li>
        </ul>

    </span>
    
    <a id="RefTrack" title="创建引文跟踪" class="icon icon-track" onclick="" href="javascript:void(0);"> <i></i>创建引文跟踪 </a>
    <a id="ashoucang" title="收藏" class="icon icon-favor" onclick="" href="javascript:void(0);"><i></i>收藏</a>
    <a class="icon icon-print" onclick="window.print();" href="javascript:void(0);"><i></i>打印</a>
    
    <!--版本切换 end-->
</div>
                            <div class="data" id="a_abstract">
                <span class="keys">摘<span style="font-family: 'Times New Roman';">&nbsp;&nbsp;&nbsp;&nbsp;</span>要：</span>
                <p>以第三方支付平台为移动云支付系统基础, 从支付方式、支付风险、认证鉴权、加密方式、通信安全等方面对现有的移动支付系统进行研究。针对普通静态二维码易伪造、易被篡改、难辨别等问题, 设计一套基于TOTP算法的动态二维码移动云支付方案。采用基于朴素贝叶斯算法和自定规则进行风险评估, 经过测试能够在一定程度上提升移动支付系统的安全性。</p>
            </div>
                    <div class="data" id="a_keywords">
                <span class="keys">关键词：</span>
                <p>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=%E7%A7%BB%E5%8A%A8%E6%94%AF%E4%BB%98&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">移动支付;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=%E4%BA%91%E6%94%AF%E4%BB%98&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">云支付;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=%E6%94%AF%E4%BB%98%E7%B3%BB%E7%BB%9F&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">支付系统;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=%E5%AE%89%E5%85%A8%E6%94%AF%E4%BB%98&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">安全支付;</a>
                </p>
            </div>
        
        <!--brief start-->
        
            <div class="brief">
                    <p>
                            <b>作者简介：</b>
                                                        <span>
                                    曹鹏飞, 讲师, 主研领域:网络安全。;
                                </span>
                                <span>
                                    李杰, 实验师。;
                                </span>
                                <span>
                                    杨君, 副教授。;
                                </span>
                    </p>
                                    <p><b>收稿日期：</b>2018-10-09</p>

                    <p>

                            <b>基金：</b>
                                                        <span>江苏省教育厅自然基金项目 (17KJD520007);</span>
                    </p>
            </div>
                    <h1><b>DESIGN AND IMPLEMENTATION OF MOBILE CLOUD SECURITY PAYMENT SYSTEM</b></h1>
                    <h2>
                    <span>Cao Pengfei</span>
                    <span>Li Jie</span>
                    <span>Yang Jun</span>
            </h2>
                    <h2>
                    <span>College of Computer Science and Engineering , Sanjiang University</span>
            </h2>
                            <div class="data" id="a_abstractEN">
                <span class="keys">Abstract：</span>
                <p>Based on the third-party payment platform, this paper studied the existing mobile payment system from the aspects of payment mode, payment risk, authentication, encryption mode and communication security. Aiming at the problems of forgery, tampering and discrimination of ordinary static QR code, we designed a mobile cloud payment with a dynamic QR code based on TOTP algorithm. Risk assessment was based on naive Bayesian algorithm and self-defined rules. After testing, this method can improve the security of mobile payment system to a certain extent.</p>
            </div>
                    <div class="data" id="a_keywordsEN">
                <span class="keys">Keyword：</span>
                <p>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=Mobile%20payment&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">Mobile payment;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=Cloud%20payment&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">Cloud payment;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=Payment%20system&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">Payment system;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=Security%20payment&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">Security payment;</a>
                </p>
            </div>
                    <div class="brief">
                
                    <p>
                                            </p>
                                    <p><b>Received：</b> 2018-10-09</p>
                                    <p>
                                            </p>
            </div>


        <!--brief start-->
                        <h3 id="31" name="31" class="anchor-tag"><b>0 引 言</b></h3>
                <div class="p1">
                    <p id="32">现如今移动支付已成为人们日常生活中不可缺失的一部分, 用户使用智能手机就可以完成支付业务, 技术主要有:蓝牙支付技术、NFC支付技术、二维码支付技术、人脸识别支付技术<citation id="186" type="reference"><link href="3" rel="bibliography" /><link href="5" rel="bibliography" /><sup>[<a class="sup">1</a>,<a class="sup">2</a>]</sup></citation>。</p>
                </div>
                <div class="p1">
                    <p id="33">随着移动支付技术的发展, 移动支付的安全问题随之出现, 众多用户使用静态二维码作为收款码, 但静态条码容易被伪造, 误导客户扫描伪码, 实施欺诈, 导致账户资金被盗刷、个人敏感信息泄露等风险问题。在移动支付交易过程中, 移动终端与支付平台之间的通信安全也至关重要, 一旦交易过程中的数据被窃取, 信息被篡改。不法分子就能够获得用户、商户交易的相关信息, 并对交易过程的数据进行伪造、重放等攻击。</p>
                </div>
                <div class="p1">
                    <p id="34">本文针对移动支付中二维码易伪造、易被篡改、变造, 易携带木马等问题, 设计一套基于TOTP算法的动态二维码支付方案, 保证交易的不可为造性、实时性、唯一性、时效性、可认证性、完整性。</p>
                </div>
                <h3 id="35" name="35" class="anchor-tag"><b>1 方案设计</b></h3>
                <h4 class="anchor-tag" id="36" name="36"><b>1.1 总体架构设计</b></h4>
                <div class="p1">
                    <p id="37">系统由多终端设备与云支付平台组成, 各终端通过设计的REST接口与云支付平台进行交互。系统共分为三层:访问层、服务层、资源层。总体系统框架如图1所示。</p>
                </div>
                <div class="area_img" id="38">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JYRJ201904048_038.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图1 移动安全支付系统总体架构" src="Detail/GetImg?filename=images/JYRJ201904048_038.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图1 移动安全支付系统总体架构  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JYRJ201904048_038.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="p1">
                    <p id="39">访问层即访问云端的方式, 分别有手机APP、智能POS机、PC浏览器。</p>
                </div>
                <div class="p1">
                    <p id="40">服务层是整个移动支付系统的核心, 包含了云端支付系统的功能, 包括:核心业务服务和基础支撑服务。核心业务服务包含动态支付、风险评估、后台管理、用户模块、商户模块、订单模块。基础支撑服务包含签名、通信、日志、密钥管理、认证鉴权、加密解密等模块。</p>
                </div>
                <div class="p1">
                    <p id="41">资源层主要是存放移动支付系统信息的实体, 使用关系型数据库存储账户信息、支付信息、商户信息、商品信息等支付平台数据。使用分布式缓存 (Redis) 对热点数据进行缓存。随着系统业务量增大, 采用RabbitMQ作为消息系统, 能够解决数据投递, 非阻塞操作和推送通知, 异步处理和工作队列的问题等。针对一般文件存储, 可使用第三方存储服务, 利用主流CDN和自建CDN节点的优势, 在性能和成本之间寻求平衡。</p>
                </div>
                <h4 class="anchor-tag" id="42" name="42"><b>1.2 主要功能设计</b></h4>
                <h4 class="anchor-tag" id="43" name="43"><b>1.2.1</b> 动态支付功能设计</h4>
                <div class="p1">
                    <p id="44">动态支付是移动云支付系统的核心部分, 支付密钥是标记交易的唯一标识符, 只有商家通过发送订单信息和客户生成的支付密钥才能申请交易。云端对支付密钥进行认证后完成支付交易, 支付流程如图2所示。</p>
                </div>
                <div class="area_img" id="45">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JYRJ201904048_045.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图2 支付流程" src="Detail/GetImg?filename=images/JYRJ201904048_045.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图2 支付流程  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JYRJ201904048_045.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="p1">
                    <p id="46">支付流程由两个部分构成:</p>
                </div>
                <div class="p1">
                    <p id="47">1) 支付二维码产生 用户在支付时产生的二维码由基于时间规则算法动态生成的。在整个支付过程中支付二维码每60 s生成一次, 每个用户的支付二维码都是唯一的。二维码有效时间在支付完成或超时立即失效。相对于静态二维码的易伪造、成本低、易窃取等缺点, 动态二维码能保证其不可为造性、实时性、唯一性、时效性、可认证性、完整性。</p>
                </div>
                <div class="p1">
                    <p id="48">2) 支付密钥认证 云移动支付系统收到交易订单和支付密钥后, 要对密钥进行基于时间的认证。先验证是否在有效期内, 然后通过TOTP算法<citation id="187" type="reference"><link href="7" rel="bibliography" /><sup>[<a class="sup">3</a>]</sup></citation>生成6位动态口令, 将6位动态口令和时间戳合成的字符串通过哈希算法SHA-256生成动态支付密钥<citation id="188" type="reference"><link href="7" rel="bibliography" /><sup>[<a class="sup">3</a>]</sup></citation>。当云端服务器接收到交易过程产生的动态支付密钥后, 根据支付订单号查询其所对应的TOTP中密钥串K和时间戳, 与当前时间生成支付密钥并与用户生成的支付密钥进行验证。如相同则交易正确, 否则表明支付超时或被篡改伪造。</p>
                </div>
                <h4 class="anchor-tag" id="49" name="49"><b>1.2.2</b> 风险评估功能设计</h4>
                <div class="p1">
                    <p id="50">用户的风险评估是在商户发送收款请求时进行的。针对用户的个人信息、消费水平、消费时间、地点和习惯等方面进行安全性分析, 评估当前消费是否为该用户的正常购物行为。风险评估流程如图3所示。</p>
                </div>
                <div class="area_img" id="51">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JYRJ201904048_051.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图3 风险评估流程" src="Detail/GetImg?filename=images/JYRJ201904048_051.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图3 风险评估流程  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JYRJ201904048_051.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="p1">
                    <p id="52">系统采用朴素贝叶斯算法<citation id="189" type="reference"><link href="9" rel="bibliography" /><sup>[<a class="sup">4</a>]</sup></citation>与自定义规则匹配相结合的方式来实现支付风险评估。根据用户交易过程中产生的样本数据, 提取特征值属性, 对用户的支付行为行进分类。若结果异常, 则交易不被允许, 要求用户进行二次身份认证。若结果正常则对用户支付的相关数据进行规则匹配。自定义规则匹配用户常用的地点、支付时间、支付金额等限制。如果在用户预设范围内则通过则允许支付, 否则要求二次身份认证。</p>
                </div>
                <h4 class="anchor-tag" id="53" name="53"><b>1.2.3</b> 认证鉴权模块设计</h4>
                <div class="p1">
                    <p id="54">在移动云支付系统中认证鉴权包括:统一的认证服务和统一鉴权服务。</p>
                </div>
                <div class="p1">
                    <p id="55">统一认证服务主要是在用户执行操作时, 提供我是我本人的身份证明<citation id="190" type="reference"><link href="11" rel="bibliography" /><sup>[<a class="sup">5</a>]</sup></citation>。常见的身份认证用户名和密码的输入是存在被窃取的风险。现如今人脸识别、指纹、短信、声纹是用户认证主要方式。能够有效地避免不法分子通过自动化工具进行密码爆破和窃取。</p>
                </div>
                <div class="p1">
                    <p id="56">统一鉴权服务是在用户认证会话的维持和维护有效性<citation id="191" type="reference"><link href="13" rel="bibliography" /><sup>[<a class="sup">6</a>]</sup></citation>。大多数Web站点使用Session, 其主要功能是保持会话信息, 对用户相关信息的存储和对用户进行验证, 而在移动系统中要使用Token来对用户的身份鉴权。</p>
                </div>
                <div class="p1">
                    <p id="57">认证鉴权主要流程如下:</p>
                </div>
                <div class="p1">
                    <p id="58">1) 客户端通过获取登录验证码请求提交用户手机号获取登录验证码。</p>
                </div>
                <div class="p1">
                    <p id="59">2) 云端支付平台生成6位随机验证码, 通过第三方短信/语音平台发送至用户手机。</p>
                </div>
                <div class="p1">
                    <p id="60">3) 客户端得到短信/语音验证码后进行登录请求。</p>
                </div>
                <div class="p1">
                    <p id="61">4) 云端支付平台短信/语音验证通过后, 云端支付平台对用户进行登录地点/时间异常检查。</p>
                </div>
                <div class="p1">
                    <p id="62">5) 如果用户不在常用的地点或不在常规时间段登录, 将会要求用户输入密码进行二次身份认证。</p>
                </div>
                <div class="p1">
                    <p id="63">6) 云端支付平台验证后通过相应的方法生成一个Token与该用户进行关联, 并生成的Token返回给客户端。</p>
                </div>
                <div class="p1">
                    <p id="64">7) 客户端在所有的请求中都需要携带Token进行认证, 云端支付平台通过解析Token来对客户端进行身份检测。</p>
                </div>
                <div class="p1">
                    <p id="65">8) 当用户退出登录或在其他设备登录时, 之前的Token将会失效。</p>
                </div>
                <h4 class="anchor-tag" id="66" name="66"><b>1.2.4</b> 通信功能模块设计</h4>
                <div class="p1">
                    <p id="67">通信功能模块是连接移动端和云端支付平台的桥梁, 用来保证用户、商户和云端支付系统之间信息传递的安全性。</p>
                </div>
                <div class="p1">
                    <p id="68">为保证交易安全性, 系统传输模式使用HTTPS协议, 使用JSON格式作为数据的载体, 对通信过程中关键数据进行加密操作。对JSON数据进行数字签名, 能够有效地保证数据完整性、机密性和不可抵赖性。</p>
                </div>
                <div class="p1">
                    <p id="69">在通信过程中采用AES加密数据, 使用RSA密钥对AES共享密钥进行二次加密。云端支付系统为每一个用户生成私钥, 而公钥存储在云端, 具体加密方案设计流程如下:</p>
                </div>
                <div class="p1">
                    <p id="70">1) 云端支付平台随机生成16个数字Key。</p>
                </div>
                <div class="p1">
                    <p id="71">2) 云端支付平台使用RSA公钥将随机生成的Key加密生成AESkey。</p>
                </div>
                <div class="p1">
                    <p id="72">3) 云端支付平台通过AES算法结合Key对关键数据加密。</p>
                </div>
                <div class="p1">
                    <p id="73">4) 客户端通过提取JOSN数据中AESkey, 使用RSA私钥对AESKey解出Key。</p>
                </div>
                <div class="p1">
                    <p id="74">5) 客户端通过AES算法结合Key对关键数据解密。</p>
                </div>
                <h3 id="75" name="75" class="anchor-tag"><b>2 系统实现</b></h3>
                <div class="p1">
                    <p id="76">移动安全支付系统采用Android系统作为用户客户端, 智能POS机作为商户客户端。整个云端支付系统使用Redis作为高速缓存, 使用RabbitMQ作为消息队列系统, 完成各个模块之间的通信, 使用Celery作为任务分发模块。</p>
                </div>
                <h4 class="anchor-tag" id="77" name="77"><b>2.1 动态支付模块实现</b></h4>
                <div class="p1">
                    <p id="78">动态支付是整个移动支付平台中关键的功能。当用户在线下商店选完商品需要支付时, 客户端通过使用OKHttp发送支付请求。当云端支付系统验证请求合法性后, 通过从数据库设定的Sequence中取出序列号和当前日期组成唯一的预支付订单号和生成的16位随机密钥Key、当前时间戳存入数据库并返回给用户。</p>
                </div>
                <div class="p1">
                    <p id="79">如图4所示, 客户端接收到云端支付系统返回的数据后, 客户端利用本地共享密钥和随机密钥生成新的密钥K, 通过TOTP算法生成了6位动态口令。之后利用哈希函数HASH-256对6位动态口令与云端返回的时间戳拼接成的字符串进行生成不可逆的支付密钥。最后客户端利用ZXing<citation id="192" type="reference"><link href="17" rel="bibliography" /><sup>[<a class="sup">8</a>]</sup></citation>将“预支付订单号&amp;支付密钥”拼接成的字符串生成支付二维码, 支付二维码随着时间每60 s更换一次。</p>
                </div>
                <div class="area_img" id="80">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JYRJ201904048_080.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图4 动态密钥生成流程" src="Detail/GetImg?filename=images/JYRJ201904048_080.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图4 动态密钥生成流程  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JYRJ201904048_080.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="p1">
                    <p id="81">云端支付系统在收到订单信息后, 通过查询预支付订单表, 根据支付密钥规则重新生成当前密钥同订单中的商户上传的支付密钥进行比对。如果相同就通过事务处理扣除用户相应的支付金额, 增加商户的资金。如果不相同, 则返回支付失败, 并记录。</p>
                </div>
                <h4 class="anchor-tag" id="82" name="82"><b>2.2 风险评估模块实现</b></h4>
                <div class="p1">
                    <p id="83">该模块由SciKit learn实现, 它是一款数据挖掘和数据分析工具, 拥有分类、回归、聚类、降维等相关学习算法和模型<citation id="193" type="reference"><link href="19" rel="bibliography" /><sup>[<a class="sup">9</a>]</sup></citation>。</p>
                </div>
                <div class="p1">
                    <p id="84">本文通过提取用户支付地点、支付商户名、支付商品数量、支付时间和支付金额这五个维度特征数据进行训练, 对系统支付过程的风险进行评估。</p>
                </div>
                <div class="p1">
                    <p id="85">当商户发出交易指令后, 系统自动提取支付地点、支付商户名、商品数量、支付时间和支付金额, 使用朴素贝叶斯算法进行训练样本模型, 最后对本次用户支付行为进行支付风险判断。</p>
                </div>
                <div class="p1">
                    <p id="86">用户行为通过了朴素贝叶算法的异常识别后, 系统将再进行规则匹配。如果匹配不通过, 则要求用户输入支付密码, 进一步确认身份, 完成认证。</p>
                </div>
                <h4 class="anchor-tag" id="87" name="87"><b>2.3 认证鉴权模块实现</b></h4>
                <div class="p1">
                    <p id="88">如图5所示, 系统生成6位随机数后通过Celery异步发送给用户, 并设置过期时间存入缓存Redis中。</p>
                </div>
                <div class="area_img" id="89">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JYRJ201904048_089.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图5 短信发送流程" src="Detail/GetImg?filename=images/JYRJ201904048_089.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图5 短信发送流程  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JYRJ201904048_089.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="p1">
                    <p id="90">返回的数据由三个属性构成:用户手机号、超时时间、验证码。将用户手机号码作为Key, 验证码作为Value。云端支付系统直接从Redis中获取号当前手机对应的验证码与用户输入进行验证, 验证通过将用户ID转换生成携带身份信息的令牌值 (Token ID) 。具体过程如下:</p>
                </div>
                <div class="p1">
                    <p id="91">1) JWT头部header中typ为type缩写, 代表是JWT, alg表示加密方式为HS256, exp代表当前时间。</p>
                </div>
                <div class="p1">
                    <p id="92">2) 在JWT的消息体playload中添加user_id和时间戳。</p>
                </div>
                <div class="p1">
                    <p id="93">3) 签名 (Sign) 。其过程如图6所示, 把header、playload分别使用Base64编码, 使用‘.’将经过编码后的字符串进行连接, 执行HMAC-SHA-256算法加密, 对加密后的数据使用Base64编码, 生成签名的字符串。</p>
                </div>
                <div class="area_img" id="94">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JYRJ201904048_094.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图6 Sign过程" src="Detail/GetImg?filename=images/JYRJ201904048_094.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图6 Sign过程  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JYRJ201904048_094.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="p1">
                    <p id="95">4) 生成Token。把Base64编码后header和playload以及sign用‘.’连接起来即header.playload.sign, 就生成了Token。</p>
                </div>
                <div class="p1">
                    <p id="96">5) 校验Token。首先用将字符串按‘.’切分三段字符串, 分别得到header、playload和sign。然后将header.playload拼装用密钥和HAMC SHA-256算法进行加密然后得到新的字符串和Sign进行比对。如果一致数据正确, 则从head取出exp对存活期进行判断, 如果超时则要求重新登录, 如果在存活期内返回user_id值。</p>
                </div>
                <div class="p1">
                    <p id="97">用户短信登录认证成功后, 系统将签发两个Token:</p>
                </div>
                <div class="p1">
                    <p id="98">1) Token, 短期证书, 用于客户端的正常服务请求所携带的认证信息。</p>
                </div>
                <div class="p1">
                    <p id="99">2) Refresh Token, 较长期的证书, 用于Token失效后, 自动申请新的Token所需携带的认证信息, 不可直接用于服务请求。</p>
                </div>
                <div class="p1">
                    <p id="100">分别给这两个Token设置不同的有效期。在用户退出登录时通过客户端将Token和Refresh Token进行销毁。在Refresh有效期内, 在Token过期时客户端通过Refresh Token获取新的Token。当Refresh过期后, 需要用户重新认证登录。</p>
                </div>
                <h3 id="101" name="101" class="anchor-tag"><b>3 核心算法</b></h3>
                <h4 class="anchor-tag" id="102" name="102"><b>3.1 基于TOTP算法的动态支付密钥技术</b></h4>
                <div class="p1">
                    <p id="103">TOTP (基于时间的一次性密码算法) 是支持时间作为动态因素基于HMAC一次性密码算法的扩展<citation id="194" type="reference"><link href="21" rel="bibliography" /><sup>[<a class="sup">10</a>]</sup></citation>。</p>
                </div>
                <div class="p1">
                    <p id="104">TOTP计算公式如下:</p>
                </div>
                <div class="p1">
                    <p id="105">TOTP (<i>K</i>, <i>C</i>) =Truncate (HMAC-SHA-1 (<i>K</i>, <i>C</i>) )      (1) </p>
                </div>
                <div class="p1">
                    <p id="106">式中:<i>K</i>是密钥串 (Base32字符串) ;<i>C</i>是时间戳。</p>
                </div>
                <div class="p1">
                    <p id="107"><i>C</i>= (<i>T</i>-<i>T</i><sub>0</sub>) /<i>X</i>      (2) </p>
                </div>
                <div class="p1">
                    <p id="108">式中:<i>T</i>是当前时间戳;<i>T</i><sub>0</sub>取值为0;<i>X</i>表示时间步长, 默认是30 s。</p>
                </div>
                <div class="p1">
                    <p id="109">HMAC-SHA-1是从 SHA1 哈希函数构造的一种哈希算法, HMAC将密钥与消息数据混合, 输出长度为 160 位哈希。</p>
                </div>
                <div class="p1">
                    <p id="110">Truncate是函数, 实现如下:</p>
                </div>
                <div class="p1">
                    <p id="111">1) 将密钥串<i>K</i>与时间戳<i>C</i>通过HMAC-SHA-1加密, 得到一个长度为20字节的密串。</p>
                </div>
                <div class="p1">
                    <p id="112">2) 取出密串的最后一个字节的低4位, 作为截取加密串的下标偏移量。</p>
                </div>
                <div class="p1">
                    <p id="113">3) 按照下标偏移量开始, 获取4个字节, 按照大端方式组合成一个整数。</p>
                </div>
                <div class="p1">
                    <p id="114">4) 截取这个整数的后6位转成字符串返回。</p>
                </div>
                <div class="p1">
                    <p id="115">如图7所示, 因为TOTP的动态性, 其中密钥串<i>K</i>分别由静态密钥串key1和动态密钥串key2组成。静态密钥串key1是客户端与云端支付平台的共享密钥;动态密钥key2是由云端支付平台随机生成并下发给客户端。客户端则通过TOTP算法生成6位动态口令, 将生成的动态口令与时间戳相结合, 最后通过哈希算法SHA-256生成动态支付密钥。</p>
                </div>
                <div class="area_img" id="116">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JYRJ201904048_116.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图7 TOTP算法的生成与认证" src="Detail/GetImg?filename=images/JYRJ201904048_116.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图7 TOTP算法的生成与认证  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JYRJ201904048_116.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <h4 class="anchor-tag" id="117" name="117"><b>3.2 基于朴素贝叶斯算法的风险评估算法</b></h4>
                <div class="p1">
                    <p id="118">朴素贝叶斯 (Naive Bayes) 是贝叶斯算法中的分支之一, 是常见的一种分类方法, 简称NB算法<citation id="195" type="reference"><link href="23" rel="bibliography" /><sup>[<a class="sup">11</a>]</sup></citation>。公式如下:</p>
                </div>
                <div class="p1">
                    <p id="119"><mathml id="120"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>Ρ</mi><mo stretchy="false"> (</mo><mi>C</mi><mo stretchy="false">|</mo><mi>X</mi><mo stretchy="false">) </mo><mo>=</mo><mfrac><mrow><mi>Ρ</mi><mo stretchy="false"> (</mo><mi>X</mi><mo stretchy="false">|</mo><mi>C</mi><mo stretchy="false">) </mo><mi>Ρ</mi><mo stretchy="false"> (</mo><mi>C</mi><mo stretchy="false">) </mo></mrow><mrow><mi>Ρ</mi><mo stretchy="false"> (</mo><mi>X</mi><mo stretchy="false">) </mo></mrow></mfrac></mrow></math></mathml>      (3) </p>
                </div>
                <div class="p1">
                    <p id="121">式中:C为类别;X为待分类项;P (C|X) 为X的状态下是C的概率大小。求解过程如下:</p>
                </div>
                <div class="p1">
                    <p id="122">1) 设置待分类项X={a<sub>1</sub>, a<sub>2</sub>, …, a<sub>m</sub>}, 每个a为X一个特征属性。</p>
                </div>
                <div class="p1">
                    <p id="123">2) 确定类别集合C={Y<sub>1</sub>, Y<sub>2</sub>, …, Y<sub>m</sub>}。</p>
                </div>
                <div class="p1">
                    <p id="124">3) 计算P (Y<sub>1</sub>|X) , P (Y<sub>2</sub>|X) , …, P (Y<sub>n</sub>|X) 。</p>
                </div>
                <div class="p1">
                    <p id="125">4) 如果P (Y<sub>k</sub>|X) =Max{ P (Y<sub>1</sub>|X) , P (Y<sub>2</sub>|X) , …, P (Y<sub>n</sub>|X) }, 则X属于Y<sub>k</sub>类。</p>
                </div>
                <div class="p1">
                    <p id="126">如图8所示, 系统选取支付时间, 支付地点、商户、支付金额、支付商品数量五个维度作为特征属性, 设定用户的支付地点为L, 支付时间T, 支付商户S, 支付商品G, 支付金额M, 即X={L, T, S, G, M}。</p>
                </div>
                <div class="area_img" id="127">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JYRJ201904048_127.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图8 贝叶斯风险评估流程图" src="Detail/GetImg?filename=images/JYRJ201904048_127.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图8 贝叶斯风险评估流程图  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JYRJ201904048_127.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="p1">
                    <p id="128">将X代入式 (3) 运算:</p>
                </div>
                <div class="p1">
                    <p id="129"><mathml id="130"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>Ρ</mi><mo stretchy="false"> (</mo><mi>Y</mi><mo stretchy="false">|</mo><mi>X</mi><mo stretchy="false">{</mo><mi>L</mi><mo>, </mo><mi>Τ</mi><mo>, </mo><mi>S</mi><mo>, </mo><mi>G</mi><mo>, </mo><mi>Μ</mi><mo stretchy="false">}</mo><mo stretchy="false">) </mo><mo>=</mo><mfrac><mrow><mi>Ρ</mi><mo stretchy="false"> (</mo><mi>X</mi><mo stretchy="false">|</mo><mi>Τ</mi><mo stretchy="false">) </mo><mo>×</mo><mi>Ρ</mi><mo stretchy="false"> (</mo><mi>Y</mi><mo stretchy="false">) </mo></mrow><mrow><mi>Ρ</mi><mo stretchy="false"> (</mo><mi>X</mi><mo stretchy="false">) </mo></mrow></mfrac></mrow></math></mathml>      (4) </p>
                </div>
                <div class="p1">
                    <p id="131">结果如下:</p>
                </div>
                <div class="p1">
                    <p id="132" class="code-formula">
                        <mathml id="132"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtable columnalign="left"><mtr><mtd><mfrac><mrow><mi>Ρ</mi><mo stretchy="false"> (</mo><mi>Y</mi><mo stretchy="false">) </mo><mo>×</mo><mi>Ρ</mi><mo stretchy="false"> (</mo><mi>X</mi><mo stretchy="false">|</mo><mi>Y</mi><mo stretchy="false">) </mo></mrow><mrow><mi>Ρ</mi><mo stretchy="false"> (</mo><mi>X</mi><mo stretchy="false">) </mo></mrow></mfrac><mo>=</mo></mtd></mtr><mtr><mtd><mfrac><mrow><mi>Ρ</mi><mo stretchy="false"> (</mo><mi>Y</mi><mo stretchy="false">) </mo><mo>×</mo><mi>Ρ</mi><mo stretchy="false"> (</mo><mi>L</mi><mo stretchy="false">|</mo><mi>Y</mi><mo stretchy="false">) </mo><mi>Ρ</mi><mo stretchy="false"> (</mo><mi>Τ</mi><mo stretchy="false">|</mo><mi>Y</mi><mo stretchy="false">) </mo><mi>Ρ</mi><mo stretchy="false"> (</mo><mi>S</mi><mo stretchy="false">|</mo><mi>Y</mi><mo stretchy="false">) </mo><mi>Ρ</mi><mo stretchy="false"> (</mo><mi>G</mi><mo stretchy="false">|</mo><mi>Y</mi><mo stretchy="false">) </mo><mi>Ρ</mi><mo stretchy="false"> (</mo><mi>Μ</mi><mo stretchy="false">|</mo><mi>Y</mi><mo stretchy="false">) </mo></mrow><mrow><mi>Ρ</mi><mo stretchy="false"> (</mo><mi>L</mi><mo>, </mo><mi>Τ</mi><mo>, </mo><mi>S</mi><mo>, </mo><mi>G</mi><mo>, </mo><mi>Μ</mi><mo stretchy="false">) </mo></mrow></mfrac><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mrow><mtext> </mtext><mtext> </mtext><mtext> </mtext></mrow><mo stretchy="false"> (</mo><mn>5</mn><mo stretchy="false">) </mo></mtd></mtr></mtable></math></mathml>
                    </p>
                </div>
                <div class="p1">
                    <p id="133">式中:P (L|Y) 正常支付情况下L的概率;P (L) 为所有情况下L的概率。计算P (Y|X) 支付正常为P (<i>Yes</i>) , 计算P (N|X) 支付异常为P (<i>No</i>) , 如P (<i>Yes</i>) &gt;P (<i>No</i>) 则表明支付正常, 反之则支付异常。</p>
                </div>
                <h3 id="134" name="134" class="anchor-tag"><b>4 系统运行与测试</b></h3>
                <h4 class="anchor-tag" id="135" name="135"><b>4.1 系统运行</b></h4>
                <div class="p1">
                    <p id="136">本系统中所需要的服务器采用腾讯云CVM服务器, 整体部署方案如图9所示。整个云端支付系统使用Nginx作为HTTPS服务器和反向代理, 不仅可以提高Python的I/O处理能力, 还可以缓冲响应, 减轻后端压力。Gunicorn作为Python应用服务器, 易于配置管理, 能够按需求切换异步和同步工作模式。数据库服务器采用MySQL, 缓存服务器使用Redis, 消息队列使用RabbitMQ。Celery作为分布式任务队列系统。</p>
                </div>
                <div class="area_img" id="137">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JYRJ201904048_137.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图9 系统部署方案" src="Detail/GetImg?filename=images/JYRJ201904048_137.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图9 系统部署方案  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JYRJ201904048_137.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <h4 class="anchor-tag" id="138" name="138">1) 服务器端软硬件配置环境:</h4>
                <h4 class="anchor-tag" id="139" name="139"> (1) 服务器类别:</h4>
                <div class="p1">
                    <p id="140">腾讯云CVM服务器。</p>
                </div>
                <h4 class="anchor-tag" id="141" name="141"> (2) 服务器机型配置:</h4>
                <div class="p1">
                    <p id="142">标准型S1;CPU:16核;内存:8 GB;硬盘:带宽:100 Mbit/s。</p>
                </div>
                <h4 class="anchor-tag" id="143" name="143"> (3) 操作系统:</h4>
                <div class="p1">
                    <p id="144">Ubuntu Server 16.04.1 LTS 64位。</p>
                </div>
                <h4 class="anchor-tag" id="145" name="145"> (4) 应用服务器:</h4>
                <div class="p1">
                    <p id="146">Nginx 1.10.3 (Ubuntu) , Gunicorn-19.8.1;Python 3.6。</p>
                </div>
                <h4 class="anchor-tag" id="147" name="147"> (5) 数据库系统:</h4>
                <div class="p1">
                    <p id="148">MySQL 5.6, Redis 3.2.9。</p>
                </div>
                <h4 class="anchor-tag" id="149" name="149"> (6) 消息队列系统:</h4>
                <div class="p1">
                    <p id="150">RabbitMQ 3.5.7-1。</p>
                </div>
                <h4 class="anchor-tag" id="151" name="151"> (7) 分布式任务队列:</h4>
                <div class="p1">
                    <p id="152">Celery 4.1.0。</p>
                </div>
                <h4 class="anchor-tag" id="153" name="153">2) 客户端软硬件配置环境</h4>
                <div class="p1">
                    <p id="154">客户端使用安卓 (Android) 系统作为运行终端。运行配置如下:</p>
                </div>
                <div class="p1">
                    <p id="155"> (1) 手机型号:ONEPLUS A3010;</p>
                </div>
                <div class="p1">
                    <p id="156"> (2) 安卓版本:Android 7.1.1;</p>
                </div>
                <div class="p1">
                    <p id="157"> (3) 运行内存:6 GB;</p>
                </div>
                <div class="p1">
                    <p id="158"> (4) 存储内存:128 GB。</p>
                </div>
                <div class="p1">
                    <p id="159">云端系统搭建完成后, 在两部手机上安装移动支付APP。一部充当普通用户, 另一部当作商户, 分别注册各自账号。用户在需要购买商品时, 在商家确定商品后, 用户只在需要支付的时候打开支付二维码, 商家进行扫描二维码收款。其中二维码每60 s更新一次, 动态更新达到了基本的设计需求。系统运行如图10所示。</p>
                </div>
                <div class="area_img" id="160">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JYRJ201904048_160.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图10 系统运行" src="Detail/GetImg?filename=images/JYRJ201904048_160.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图10 系统运行  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JYRJ201904048_160.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <h4 class="anchor-tag" id="161" name="161"><b>4.2 系统测试</b></h4>
                <h4 class="anchor-tag" id="162" name="162"><b>4.2.1</b> 测试指标</h4>
                <div class="p1">
                    <p id="163">本系统测试分为风险评估测试、主要功能测试与性能测试。</p>
                </div>
                <div class="p1">
                    <p id="164">风险评估测试利用朴素贝叶斯算法在实验环境进行训练, 对用户的异常支付行为进行识别和匹配。</p>
                </div>
                <div class="p1">
                    <p id="165">功能测试主要使用黑盒测试<citation id="196" type="reference"><link href="25" rel="bibliography" /><sup>[<a class="sup">12</a>]</sup></citation>, 通过各个功能编写测试用例, 按照测试用例进行测试, 验证结果的正确性。检查系统各个功能是否能够满足生成环境需求, 包括短信登录认证、密钥生成分发、机密信息加密解密、动态支付密钥生成与认证、风险评估等功能模块。</p>
                </div>
                <div class="p1">
                    <p id="166">性能测试通过自动化的测试工具来对系统的各项性能指标进行测试<citation id="197" type="reference"><link href="27" rel="bibliography" /><sup>[<a class="sup">13</a>]</sup></citation>。系统性能测试主要测试系统的高并发性能, 包括:平均响应时间、每秒处理请求数量、平均流量和错误率等。</p>
                </div>
                <h4 class="anchor-tag" id="167" name="167"><b>4.2.2</b> 风险评估测试</h4>
                <div class="p1">
                    <p id="168">在实验环境下使用朴素贝叶斯算法进行训练, 通过统计两个用户的购物数据, 分别训练或测试使用的白样本和黑样本。通过人工标签Label (0为正常, 1为异常) 共600条, 其中150份为异常样本, 450份为正常样本, 部分训练样本如表1所示。</p>
                </div>
                <div class="area_img" id="169">
                    <p class="img_tit"><b>表1 训练样本</b> <a class="downexcel" onclick="DownLoadReportExcel(this)">导出到EXCEL</a></p>
                    <p class="img_tit"></p>
                    <p class="img_note"></p>
                    <table id="169" border="1"><tr><td>Time</td><td>Location</td><td>Store</td><td>Money</td><td>Number</td><td>Label</td></tr><tr><td><br />15</td><td>3010</td><td>12</td><td>3</td><td>1</td><td>0</td></tr><tr><td><br />11</td><td>5210</td><td>254</td><td>45</td><td>1</td><td>0</td></tr><tr><td><br />18</td><td>3056</td><td>111</td><td>86</td><td>2</td><td>0</td></tr><tr><td><br />0</td><td>3010</td><td>225</td><td>60</td><td>3</td><td>1</td></tr><tr><td><br />9</td><td>3010</td><td>125</td><td>100</td><td>4</td><td>1</td></tr><tr><td><br />20</td><td>5210</td><td>21</td><td>128</td><td>2</td><td>0</td></tr><tr><td><br />13</td><td>3010</td><td>52</td><td>6</td><td>1</td><td>1</td></tr><tr><td><br />15</td><td>5210</td><td>111</td><td>50</td><td>5</td><td>1</td></tr></table>
                    <form name="form" action="/kxreader/Detail/DownloadReportExcel" method="POST" style="display:inline">
                        <input type="hidden" name="hidTable" value="" />
                        <input type="hidden" name="hidFileName" value="" />
                    </form>
                    <p class="img_note"></p>
                    <p class="img_note"></p>
                </div>
                <div class="p1">
                    <p id="170">通过Scikit-Learn中的GaussianNB函数进行训练, 采用拉普拉斯平滑法, 对每个分量<i>x</i>的计数加1可以避免零概率问题。</p>
                </div>
                <div class="p1">
                    <p id="171">实验将数据样本分为3份, 采用3折交叉验证, 两份为训练集, 另一份为测试集。具体异常判断结果统计如表2所示。</p>
                </div>
                <div class="area_img" id="172">
                    <p class="img_tit"><b>表2 判断结果统计表</b> <a class="downexcel" onclick="DownLoadReportExcel(this)">导出到EXCEL</a></p>
                    <p class="img_tit"></p>
                    <p class="img_note"></p>
                    <table id="172" border="1"><tr><td><br />标签名</td><td>正常支付</td><td>异常支付</td></tr><tr><td><br />判断属于正常支付</td><td>121</td><td>12</td></tr><tr><td><br />判断属于异常支付</td><td>29</td><td>38</td></tr><tr><td><br />合计</td><td>150</td><td>50</td></tr></table>
                    <form name="form" action="/kxreader/Detail/DownloadReportExcel" method="POST" style="display:inline">
                        <input type="hidden" name="hidTable" value="" />
                        <input type="hidden" name="hidFileName" value="" />
                    </form>
                    <p class="img_note"></p>
                    <p class="img_note"></p>
                </div>
                <div class="p1">
                    <p id="173">对样本数据进行打乱, 再次进行三次3折交叉验证。具体数据如表3所示。</p>
                </div>
                <div class="area_img" id="174">
                    <p class="img_tit"><b>表3 三次3折交叉验证统计表</b> <a class="downexcel" onclick="DownLoadReportExcel(this)">导出到EXCEL</a></p>
                    <p class="img_tit"></p>
                    <p class="img_note"></p>
                    <table id="174" border="1"><tr><td><br />3折交叉验证</td><td>正确率</td><td>召回率</td><td>综合评价指标</td></tr><tr><td><br />第一次</td><td>0.851</td><td>0.82</td><td>0.835</td></tr><tr><td><br />第二次</td><td>0.795</td><td>0.88</td><td>0.835</td></tr><tr><td><br />第三次</td><td>0.864</td><td>0.84</td><td>0.851</td></tr><tr><td><br />均值</td><td>0.836</td><td>0.846</td><td>0.840</td></tr></table>
                    <form name="form" action="/kxreader/Detail/DownloadReportExcel" method="POST" style="display:inline">
                        <input type="hidden" name="hidTable" value="" />
                        <input type="hidden" name="hidFileName" value="" />
                    </form>
                    <p class="img_note"></p>
                    <p class="img_note"></p>
                </div>
                <div class="p1">
                    <p id="175">经测平均准确率能达到80%以上, 召回率在84%左右, 综合标价指标均达0.8, 而且数据都比较平稳, 没有太大的浮动。可以看出朴素贝叶斯算法在一定程度上能有效地辨别异常支付的能力, 再结合移动支付系统的自定义匹配规则, 能够对大部分的危险支付行为进行预警, 有效地保障用户的资金安全。</p>
                </div>
                <h4 class="anchor-tag" id="176" name="176"><b>4.2.3</b> 主要功能测试</h4>
                <div class="p1">
                    <p id="177">Token获取、密钥更新、生成测试、风险评估功能测试, 如表4所示。</p>
                </div>
                <div class="area_img" id="178">
                    <p class="img_tit"><b>表4 功能测试用例</b> <a class="downexcel" onclick="DownLoadReportExcel(this)">导出到EXCEL</a></p>
                    <p class="img_tit"></p>
                    <p class="img_note"></p>
                    <table id="178" border="1"><tr><td>测试<br />内容</td><td>Token测试</td><td>密钥更新、<br />生成测试</td><td>风险评估<br />功能测试</td></tr><tr><td>测试<br />目的</td><td>验证Token是否正常</td><td>验证密钥对中私钥是否正常生成、更新</td><td>验证能否识别风险。</td></tr><tr><td><br />测试<br />方法</td><td> (1) 输入手机号码, 获取验证码<br /> (2) 验证码发送给云端支付系统<br /> (3) 云端支付返回Token Refresh Token</td><td> (1) 云端支付系统发送支付请求、获取验证码<br /> (2) 客户端解析动态口令和时间戳<br /> (3) 客户端生成支付密钥<br /> (3) 提交给云端支付系统验证<br /> (4) 验证通过返回私钥</td><td> (1) 用户在同一城市多次支付<br /> (2) 修改地点属性执行支付操作<br /> (3) 云端支付系统风险评估</td></tr><tr><td><br />预期<br />结果</td><td>返回Token <br />Refresh Token</td><td>返回私钥<br />动态密钥生成成功</td><td>需二次验证</td></tr><tr><td><br />结果</td><td> 通过</td><td> 通过</td><td> 通过</td></tr></table>
                    <form name="form" action="/kxreader/Detail/DownloadReportExcel" method="POST" style="display:inline">
                        <input type="hidden" name="hidTable" value="" />
                        <input type="hidden" name="hidFileName" value="" />
                    </form>
                    <p class="img_note"></p>
                    <p class="img_note"></p>
                </div>
                <h4 class="anchor-tag" id="179" name="179"><b>4.2.4</b> 性能测试</h4>
                <div class="p1">
                    <p id="180">本系统性能测试主要测试系统的高并发性能, 包括:平均响应时间、每秒处理请求数量、平均流量和错误率等。具体测试用例如表5所示。采用专业测试工具Apache Jmeter<citation id="198" type="reference"><link href="29" rel="bibliography" /><sup>[<a class="sup">14</a>]</sup></citation>, 用于压力和性能测试, 测试结果如表6所示。</p>
                </div>
                <div class="area_img" id="181">
                    <p class="img_tit"><b>表5 性能测试用例</b> <a class="downexcel" onclick="DownLoadReportExcel(this)">导出到EXCEL</a></p>
                    <p class="img_tit"></p>
                    <p class="img_note"></p>
                    <table id="181" border="1"><tr><td><br />测试内容</td><td>高并发性能测试</td></tr><tr><td><br />测试目的</td><td>验证系统在高并发环境下是否能正常工作</td></tr><tr><td><br />测试方法</td><td> (1) 运行Jmeter, 选择测试端口443, 协议Https<br /> (2) 在SSL管理器中选择证书CA<br /> (3) 添加线程组, 配置相关参数<br /> (4) 开始测试</td></tr><tr><td><br />预期结果</td><td> (1) 服务器运行正常<br /> (2) 服务器能承受400QPS访问量</td></tr><tr><td><br />结果</td><td> (1) 服务器运行正常, 符合预期<br /> (2) 实测服务器能承受501QPS访问量</td></tr></table>
                    <form name="form" action="/kxreader/Detail/DownloadReportExcel" method="POST" style="display:inline">
                        <input type="hidden" name="hidTable" value="" />
                        <input type="hidden" name="hidFileName" value="" />
                    </form>
                    <p class="img_note"></p>
                    <p class="img_note"></p>
                </div>
                <div class="area_img" id="182">
                    <p class="img_tit"><b>表6 性能测试表</b> <a class="downexcel" onclick="DownLoadReportExcel(this)">导出到EXCEL</a></p>
                    <p class="img_tit"></p>
                    <p class="img_note"></p>
                    <table id="182" border="1"><tr><td>测试数<br />量/个</td><td>并发线<br />程/个</td><td>平均响应<br />时间/s</td><td>每秒请求<br />数量/个</td><td>平均流量/<br /> (KB·s<sup>-1</sup>) </td><td>错误<br />率/%</td></tr><tr><td><br />25 781</td><td>200</td><td>0.234</td><td>501</td><td>500</td><td>0</td></tr></table>
                    <form name="form" action="/kxreader/Detail/DownloadReportExcel" method="POST" style="display:inline">
                        <input type="hidden" name="hidTable" value="" />
                        <input type="hidden" name="hidFileName" value="" />
                    </form>
                    <p class="img_note"></p>
                    <p class="img_note"></p>
                </div>
                <div class="p1">
                    <p id="183">根据测试数据看出系统整体性能良好, 在网络状态良好的情况下延迟较低, 响应及时, 能正常运行。</p>
                </div>
                <h3 id="184" name="184" class="anchor-tag"><b>5 结 语</b></h3>
                <div class="p1">
                    <p id="185">本文为移动云安全支付设计了一套可靠的解决方案。通过与TOTP算法相结合设计出一种新型动态二维码支付方式, 保证二维码的不可伪造性、唯一性、时效性等安全性;通过改进现有的JWT协议建立完整的认证鉴权模式;在通信过程中, 采用数字签名确保数据的完整性、安全性, 同时具有不可抵赖性和防止重放等功能;采用了一种基于朴素贝叶斯算法和自定规则的风险评估模型, 经过测试能够在一定程度上提升移动支付系统的安全性。</p>
                </div>

        <!--brief end-->
        
        <!--conten left  end-->
        <!--增强附件-->
        

        <!--reference start-->
            <div class="reference anchor-tag" id="a_bibliography">
                    <h3>参考文献</h3>
                                        <p id="3">
                            <a id="bibliography_1" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=DXWJ201605011&amp;v=MTc1MzFNcW85RVpZUUtESDg0dlI0VDZqNTRPM3pxcUJ0R0ZyQ1VSN3FmWnVadEZ5emdVNy9NSVRYY1pMRzRIOWY=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[1]</b> 陈慧慧. 新型移动支付创新发展及安全监管研究[J]. 电信网技术, 2016 (5) :37-39.
                            </a>
                        </p>
                        <p id="5">
                            <a id="bibliography_2" target="_blank" href="/kcms/detail/detail.aspx?dbcode=SJHD&amp;filename=SJHD950F9FB6B8940B36E97A9CBB098BE986&amp;v=MjI5NjRXcjdKSUZwbWFCdUhZZk9HUWxmQnJMVTA1dHRod0wyL3dLdz1OaWZEYXJxOUhxZkYyZjFERnVNR0NIeEx6QkJtNHpnTVFReVEzaEk4Y2NEaFRMS1pDT052RlNpVw==&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[2]</b> Lu J, Yang Z, Li L, et al. Multiple schemes for mobile payment authentication using QR code and visual cryptography[J]. Mobile Information Systems, 2017, 2017, Article ID 4356038:1-12.
                            </a>
                        </p>
                        <p id="7">
                            <a id="bibliography_3" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Time-based one time password (totp) for network authentication">

                                <b>[3]</b> Burch L L, Buss D F, Henderson L H. Time-based one time password (totp) for network authentication: U.S. Patent Application 15/138, 521[P]. 2016:8-18.
                            </a>
                        </p>
                        <p id="9">
                            <a id="bibliography_4" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=YYKX201701001&amp;v=MzEzNzR6Z1U3L01QRFRBZHJHNEg5Yk1ybzlGWllRS0RIODR2UjRUNmo1NE8zenFxQnRHRnJDVVI3cWZadVp0Rnk=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[4]</b> 叶云, 石聪聪, 余勇, 等.保护隐私的分布式朴素贝叶斯挖掘[J]. 应用科学学报, 2017, 35 (1) :1-10.
                            </a>
                        </p>
                        <p id="11">
                            <a id="bibliography_5" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=XXAQ201803012&amp;v=MTAzNDBESDg0dlI0VDZqNTRPM3pxcUJ0R0ZyQ1VSN3FmWnVadEZ5emdVNy9NUFRYS2Y3RzRIOW5Nckk5RVpvUUs=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[5]</b> 张建标, 徐万山, 刘国杰, 等.一种结合网络行为分析的可信连接架构[J]. 信息网络安全, 2018 (3) :78-85.
                            </a>
                        </p>
                        <p id="13">
                            <a id="bibliography_6" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=DXKX201302014&amp;v=MDYxMTZVNy9NSVRYQWRyRzRIOUxNclk5RVlJUUtESDg0dlI0VDZqNTRPM3pxcUJ0R0ZyQ1VSN3FmWnVadEZ5emc=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[6]</b> 孙韩林, 刘建华. 公众网络统一身份认证服务及标准研究[J]. 电信科学, 2017, 29 (2) :84-88.
                            </a>
                        </p>
                        <p id="15">
                            <a id="bibliography_7" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=HDZJ201407048&amp;v=MDgxNDJDVVI3cWZadVp0Rnl6Z1U3L01MU25SWkxHNEg5WE1xSTlCYklRS0RIODR2UjRUNmo1NE8zenFxQnRHRnI=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[7]</b> 邓红, 杨茹, 王亚东. 基于云计算平台的鉴权分析[J]. 信息技术, 2014, 38 (7) :180-182.
                            </a>
                        </p>
                        <p id="17">
                            <a id="bibliography_8" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Zxing">

                                <b>[8]</b> Owen S. Zxing[M]. Zebra Crossing, 2013.
                            </a>
                        </p>
                        <p id="19">
                            <a id="bibliography_9" >
                                    <b>[9]</b>
                                 Pedregosa F, Varoquaux G, Gramfort A, et al. Scikit-learn: Machine learning in Python[J]. Journal of machine learning research, 2011, 12 (10) : 2825-2830.
                            </a>
                        </p>
                        <p id="21">
                            <a id="bibliography_10" target="_blank" href="http://scholar.cnki.net/result.aspx?q=TOTP:Time-based one-time password algorithm">

                                <b>[10]</b> M’Raihi D, Machani S, Pei M, et al. Totp: Time-based one-time password algorithm[R]. RFC 6238, 2011.
                            </a>
                        </p>
                        <p id="23">
                            <a id="bibliography_11" target="_blank" href="http://scholar.cnki.net/result.aspx?q=A comparison of event models for Naive Bayes text classification">

                                <b>[11]</b> McCallum A, Nigam K. A comparison of event models for naive bayes text classification[C].AAAI-98 workshop on learning for text categorization. 1998, 752: 41-48.
                            </a>
                        </p>
                        <p id="25">
                            <a id="bibliography_12" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JFYZ200708000&amp;v=MDAxMjc0SHRiTXA0OUZaSVFLREg4NHZSNFQ2ajU0TzN6cXFCdEdGckNVUjdxZlp1WnRGeXpnVTcvTUx5dlNkTEc=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[12]</b> 邓小鹏, 邢春晓, 蔡莲红. Web 应用测试技术进展[J]. 计算机研究与发展, 2007, 44 (8) :1273-1283.
                            </a>
                        </p>
                        <p id="27">
                            <a id="bibliography_13" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JYRJ201503003&amp;v=MTY5MTN5emdVNy9NTHpUWlpMRzRIOVRNckk5Rlo0UUtESDg0dlI0VDZqNTRPM3pxcUJ0R0ZyQ1VSN3FmWnVadEY=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[13]</b> 宋巍, 张春柳, 邬斌亮. Web系统性能测试研究与实践[J]. 计算机应用与软件, 2015, 32 (3) : 4-6.
                            </a>
                        </p>
                        <p id="29">
                            <a id="bibliography_14" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Comparative Study of Testing Tools Blazemeter and Apache Jmeter">

                                <b>[14]</b> Memon P, Hafiz T, Bhatti S, et al. Comparative Study of Testing Tools Blazemeter and Apache Jmeter[J]. Sukkur IBA Journal of Computing and Mathematical Sciences, 2018, 2 (1) :70-76.
                            </a>
                        </p>
            </div>
        <!--reference end-->
        <!--footnote start-->
        <!--footnote end-->



    </div>

        <input id="fileid" type="hidden" value="JYRJ201904048" />
        <input id="dpi" type="hidden" value="300" />
    </div>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?6e967eb120601ea41b9d312166416aa6";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
</script>

    


<input id="hid_uid" name="hid_uid" type="hidden" value="WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
<input id="hid_kLogin_headerUrl" name="hid_kLogin_headerUrl" type="hidden" value="/KLogin/Request/GetKHeader.ashx%3Fcallback%3D%3F" />
<input id="hid_kLogin_footerUrl" name="hid_kLogin_footerUrl" type="hidden" value="/KLogin/Request/GetKFooter.ashx%3Fcallback%3D%3F" />
<div class="btn-link" style="display: none"><a target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JYRJ201904048&amp;v=MDc5NDVSNFQ2ajU0TzN6cXFCdEdGckNVUjdxZlp1WnRGeXpnVTcvTUx6VFpaTEc0SDlqTXE0OUJiSVFLREg4NHY=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">知网节</a></div>
<div class="popflow" id="popupTips" style="display: none;">
    <div class="popflowArr"></div>
    <div class="popflowCot">
        <div class="hd"><a href="javascript:void(0);" onclick="$('#popupTips').hide();$('#popupmsg').html('')" class="close">X</a></div>
        <div class="bd">
            <p class="mes" id="popupmsg" name="popupmsg"></p>
          
        </div>
    </div>
</div>
<input type="hidden" id="myexport" value="//kns.cnki.net" />

<input type="hidden" id="KPCAPIPATH" value="//ishufang.cnki.net" />
<input type="hidden" id="CitedTimes" value="" />
<div class="link" id="GLSearch" style="display: none;">
    <i class="icon-trangle"></i>
    <div class="inner">
        <a class="icon" id="copytext">复制</a>
        <a class="icon" target="_blank" onclick="searchCRFD(this)">工具书搜索</a>
    </div>
</div>




<input id="hidVirtualPath" name="hidVirtualPath" type="hidden" value="/kxreader" />
<script src="/kxreader/bundles/detail?v=-ULdk-c6FkZHtJA2KAXPgHnyA8mtgyPnBde_C2VZ2BY1"></script>

<script src="/kxreader/Scripts/layer.min.js" type="text/javascript"></script>

<div id="footerBox" class="rootw footer">
</div>
<script>
    if (typeof FlushLogin == 'function') {
        FlushLogin();
    }
    modifyEcpHeader(true);
</script>

<!--图片放大功能 start-->
<script src="/kxreader/bundles/imagebox?v=W4phPu9SNkGcuPeJclikuVE3PpRyIW_gnfjm_19nynI1"></script>

<script type="text/javascript">
    $(function () {
        var j = $.noConflict();
        j(function () {
            j(".zoom-in,.btn-zoomin").imgbox({
                'alignment': 'center',
                'allowMultiple': false,
                'overlayShow': true
            });
        })
    });
</script>
<!--图片放大功能 end-->
<div class="fixedbar">
    <div class="backtop hiddenV" id="backtop">
        <a id="backTopSide" href="javascript:scroll(0,0);" title=""></a>
    </div>
</div>
<script type="text/javascript" src="/kxreader/Scripts/MathJax-2.6-latest/MathJax.js?config=MML_HTMLorMML-full"></script>

</body>
</html>
