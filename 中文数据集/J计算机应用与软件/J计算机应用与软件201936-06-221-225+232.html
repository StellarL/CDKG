<!DOCTYPE html>
<html>
<head>
    <title>全文阅读--XML全文阅读--中国知网</title>
    <link rel="icon" href="/kxreader/favicon.ico" />
    <link rel="shortcut Icon" href="/kxreader/favicon.ico" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="keywords" content="文献 XML KBASE CNKI 中国知网" />
    <meta name="description" content="XML文献检索" />
    <link href="/kxreader/Content/css/detail?v=qX2z2KjRAEyQiNfAbKtl7dLnsqFoQ5Jdw3TZfDf0n1k1" rel="stylesheet"/>

    <script type="text/javascript">
        var APPPATH = '/kxreader';
    </script>
</head>

<body>
    
<script type="text/javascript" src="//login.cnki.net/TopLogin/api/loginapi/get?type=top&amp;localCSS=&amp;returnurl=%2f%2fkns.cnki.net%2f%2fKXReader%2fDetail%3fTIMESTAMP%3d637135734678096250%26DBCODE%3dCJFD%26TABLEName%3dCJFDLAST2019%26FileName%3dJYRJ201906042%26RESULT%3d1%26SIGN%3dhmZvxQyQ6%252bKQ0MBgYGihOcVNvDU%253d"></script>

<div id="headerBox" class="header">
    <div class="topbar">
        <div class="textalign">
            <a href="/kxreader/Detail?dbcode=CJFD&amp;filename=JYRJ201906042&amp;align=md">
                <i class="icon-cen active" title="居中对齐"></i>
            </a>
            <a href="/kxreader/Detail?dbcode=CJFD&amp;filename=JYRJ201906042&amp;align=lt">
                <i class="icon-left " title="左对齐"></i>
            </a>
        </div>
        <h6 class="free-tip"><i class="icon"></i>HTML阅读开放试用阶段，欢迎体验！</h6>
    </div>
</div>

    



<div class="btn-link" style="display: none"><a target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JYRJ201906042&amp;v=MjcyMzVoVTc3Tkx6VFpaTEc0SDlqTXFZOUJab1FLREg4NHZSNFQ2ajU0TzN6cXFCdEdGckNVUjdxZlp1WnRGeTM=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">知网节</a></div>

    <div class="main">

        

    <div class="sidebar-a">
        <!--sidebar start-->
        <div class="sidenav">
            <div class="arrow"><span></span></div>
            <!--sidebar_list start-->
            <dl class="sidenav-list">
                    <dt class="tit">目录结构</dt>
                            <dd class="guide">
                                    <p><a href="#31" data-title="&lt;b&gt;0 引 言&lt;/b&gt; "><b>0 引 言</b></a><i></i></p>
                                                            </dd>
                            <dd class="guide">
                                    <p><a href="#35" data-title="&lt;b&gt;1 陷门模板化技术&lt;/b&gt; "><b>1 陷门模板化技术</b></a><i></i></p>
                                                                    <ul class="contentbox">
                                                <li><a href="#37" data-title="&lt;b&gt;1.1 嵌入式设备启动流程分析&lt;/b&gt;"><b>1.1 嵌入式设备启动流程分析</b></a></li>
                                                <li><a href="#53" data-title="&lt;b&gt;1.2 嵌入式设备启动模型&lt;/b&gt;"><b>1.2 嵌入式设备启动模型</b></a></li>
                                                <li><a href="#59" data-title="&lt;b&gt;1.3 陷门模板化&lt;/b&gt;"><b>1.3 陷门模板化</b></a></li>
                                    </ul>
                            </dd>
                            <dd class="guide">
                                    <p><a href="#65" data-title="&lt;b&gt;2 陷门模板设计实例&lt;/b&gt; "><b>2 陷门模板设计实例</b></a><i></i></p>
                                                                    <ul class="contentbox">
                                                <li><a href="#85" data-title="&lt;b&gt;2.1 可配置参数区实现&lt;/b&gt;"><b>2.1 可配置参数区实现</b></a></li>
                                                <li><a href="#103" data-title="&lt;b&gt;2.2 程序栈实现&lt;/b&gt;"><b>2.2 程序栈实现</b></a></li>
                                                <li><a href="#136" data-title="&lt;b&gt;2.3 数据池实现&lt;/b&gt;"><b>2.3 数据池实现</b></a></li>
                                    </ul>
                            </dd>
                            <dd class="guide">
                                    <p><a href="#148" data-title="&lt;b&gt;3 结 语&lt;/b&gt; "><b>3 结 语</b></a><i></i></p>
                                                            </dd>
                            <dd class="guide">
                                    <p><a href="#" data-title="文内图表 ">文内图表</a><i></i></p>
                                                                    <ul class="contentbox">
                                                <li><a href="#41" data-title="图1 Bootloader启动流程">图1 Bootloader启动流程</a></li>
                                                <li><a href="#44" data-title="图2 initrd机制启动流程">图2 initrd机制启动流程</a></li>
                                                <li><a href="#47" data-title="图3 initramfs机制启动流程">图3 initramfs机制启动流程</a></li>
                                                <li><a href="#49" data-title="图4 根文件系统挂载方式示意图">图4 根文件系统挂载方式示意图</a></li>
                                                <li><a href="#51" data-title="图5 嵌入式Linux启动流程">图5 嵌入式Linux启动流程</a></li>
                                                <li><a href="#55" data-title="图6 隔离涉及陷门模块设计执行阶段后的启动流程图">图6 隔离涉及陷门模块设计执行阶段后的启动流程图</a></li>
                                                <li><a href="#57" data-title="图7 嵌入式Linux启动模型">图7 嵌入式Linux启动模型</a></li>
                                                <li><a href="#62" data-title="图8 模板化陷门设计框架">图8 模板化陷门设计框架</a></li>
                                    </ul>
                            </dd>
                                    <dd class="guide">
                                        <h6>
                                            <p><a href="#a_bibliography">参考文献</a> </p>
                                        </h6>
                                    </dd>

            </dl>
        </div>
        <!--sidebar end-->
        &nbsp;
        <!--此处有一空格符 勿删-->
    </div>

                <div class="sidebar-b three-collumn" style="width:0;">
            <div class="refer" style="width: 0;">
                <div class="arrow off" title="参考文献"><span></span></div>
                <div class="js-scrollbox" >
                    
                    <div class="subbox active">
                        <h4>
                            <span class="tit">参考文献</span>
                            <a class="close" href="javascript:void(0)">x</a>
                        </h4>
                        <div class="side-scroller">
                            <ul class="refer-list">
                                <li id="165">


                                    <a id="bibliography_1" title=" Lord I.BIOS Rootkit:Welcome Home, My Lord! [EB/OL].[2007-05-11].http://www.xfocus.net/articles/200705/918.html." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=BIOS RootKit: Welcome Home, My Lord!">
                                        <b>[1]</b>
                                         Lord I.BIOS Rootkit:Welcome Home, My Lord! [EB/OL].[2007-05-11].http://www.xfocus.net/articles/200705/918.html.
                                    </a>
                                </li>
                                <li id="167">


                                    <a id="bibliography_2" title=" Kumar N, Kumar V.Vbootkit:Compromising windows vista security[C]//BlackHat Europe, 2007." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Vboot Kit:Compromising Windows Vista Security">
                                        <b>[2]</b>
                                         Kumar N, Kumar V.Vbootkit:Compromising windows vista security[C]//BlackHat Europe, 2007.
                                    </a>
                                </li>
                                <li id="169">


                                    <a id="bibliography_3" title=" Zheng W.Advanced Bootkit-Tophet[C]//Xcon2008, November, 2008." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Advanced Bootkit-Tophet">
                                        <b>[3]</b>
                                         Zheng W.Advanced Bootkit-Tophet[C]//Xcon2008, November, 2008.
                                    </a>
                                </li>
                                <li id="171">


                                    <a id="bibliography_4" title=" Miller C.Battery Firmware Hacking[C]//BlackHat USA, 2011." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Battery Firmware Hacking">
                                        <b>[4]</b>
                                         Miller C.Battery Firmware Hacking[C]//BlackHat USA, 2011.
                                    </a>
                                </li>
                                <li id="173">


                                    <a id="bibliography_5" title=" Lee H, Kim C H, Yi J H.Experimenting with System and Libc Call Interception Attacks on ARM-based Linux Kernel[C]//Proceedings of the 2011 ACM Symposium on Applied Computing.ACM, 2011:631-632." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Experimenting with system and Libc call interception a t-tacks on Linux kernel">
                                        <b>[5]</b>
                                         Lee H, Kim C H, Yi J H.Experimenting with System and Libc Call Interception Attacks on ARM-based Linux Kernel[C]//Proceedings of the 2011 ACM Symposium on Applied Computing.ACM, 2011:631-632.
                                    </a>
                                </li>
                                <li id="175">


                                    <a id="bibliography_6" title=" Craig.Jailbreaking the NeoTV[EB/OL].[2012-10-23].http://www.devttys0.com/2012/10/jailbreaking-the-neotv/." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Jailbreaking the NeoTV">
                                        <b>[6]</b>
                                         Craig.Jailbreaking the NeoTV[EB/OL].[2012-10-23].http://www.devttys0.com/2012/10/jailbreaking-the-neotv/.
                                    </a>
                                </li>
                                <li id="177">


                                    <a id="bibliography_7" title=" Cui A, Costello M, Stolfo S J.When Firmware Modifications Attack:A Case Study of Embedded Exploitation[C]//the 20th Annual Network &amp;amp; Distributed System Security Symposium, 2013." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=When firmware modifications attack:A case study of embedded exploitation">
                                        <b>[7]</b>
                                         Cui A, Costello M, Stolfo S J.When Firmware Modifications Attack:A Case Study of Embedded Exploitation[C]//the 20th Annual Network &amp;amp; Distributed System Security Symposium, 2013.
                                    </a>
                                </li>
                                <li id="179">


                                    <a id="bibliography_8" title=" Bambenek.Hacking HP Printers for Fun and Profit[EB/OL].[2011-11-29].https://isc.sans.edu/diary/Hacking+HP+Printers+for+Fun+and+Profit/12112." target="_blank"
                                       href="http://scholar.cnki.net/result.aspx?q=Hacking HP Printers for Fun and Profit">
                                        <b>[8]</b>
                                         Bambenek.Hacking HP Printers for Fun and Profit[EB/OL].[2011-11-29].https://isc.sans.edu/diary/Hacking+HP+Printers+for+Fun+and+Profit/12112.
                                    </a>
                                </li>
                                <li id="181">


                                    <a id="bibliography_9" title=" 李成林.Rootkit 的改进型实现与检测技术研究[D].南昌:江西师范大学, 2015." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CMFD&amp;filename=1015624548.nh&amp;v=MDI4MDl1WnRGeTNoVTc3TlZGMjZHN1c2R3RUSXA1RWJQSVFLREg4NHZSNFQ2ajU0TzN6cXFCdEdGckNVUjdxZlo=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[9]</b>
                                         李成林.Rootkit 的改进型实现与检测技术研究[D].南昌:江西师范大学, 2015.
                                    </a>
                                </li>
                                <li id="183">


                                    <a id="bibliography_10" title=" 冯培钧, 张平, 陈志锋, 等.一种新型 Linux 内核级 Rootkit 设计与实现[J].信息工程大学学报, 2016, 17 (2) :231-237." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=XXGC201602020&amp;v=MjY4MDU3cWZadVp0RnkzaFU3N05QVFhNYmJHNEg5Zk1yWTlIWklRS0RIODR2UjRUNmo1NE8zenFxQnRHRnJDVVI=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[10]</b>
                                         冯培钧, 张平, 陈志锋, 等.一种新型 Linux 内核级 Rootkit 设计与实现[J].信息工程大学学报, 2016, 17 (2) :231-237.
                                    </a>
                                </li>
                                <li id="185">


                                    <a id="bibliography_11" title=" 李扬, 周安民, 张磊, 等.一种基于硬件虚拟化的 Rootkit 技术[J].现代计算机:中旬刊, 2017 (2) :21-25." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=XDJS201705006&amp;v=MjIzMzNvOUZZb1FLREg4NHZSNFQ2ajU0TzN6cXFCdEdGckNVUjdxZlp1WnRGeTNoVTc3TlBTbkJmYkc0SDliTXE=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[11]</b>
                                         李扬, 周安民, 张磊, 等.一种基于硬件虚拟化的 Rootkit 技术[J].现代计算机:中旬刊, 2017 (2) :21-25.
                                    </a>
                                </li>
                                <li id="187">


                                    <a id="bibliography_12" title=" 孟晨宇, 阮阳, 王佳伟, 等.Rootkit 进程隐藏与检测技术研究[J].软件导刊, 2016, 15 (5) :188-190." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=RJDK201605068&amp;v=MjUwNTVxcUJ0R0ZyQ1VSN3FmWnVadEZ5M2hVNzdOTnlmUFpiRzRIOWZNcW85RGJJUUtESDg0dlI0VDZqNTRPM3o=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[12]</b>
                                         孟晨宇, 阮阳, 王佳伟, 等.Rootkit 进程隐藏与检测技术研究[J].软件导刊, 2016, 15 (5) :188-190.
                                    </a>
                                </li>
                                <li id="189">


                                    <a id="bibliography_13" title=" 蒋和国, 蒋烈辉, 舒辉, 等.基于 JTAG 仿真的 ARM Linux 设备 Bootkit 检测技术研究[J].计算机应用研究, 2016, 33 (2) :526-530." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JSYJ201602049&amp;v=MTQwNzR6cXFCdEdGckNVUjdxZlp1WnRGeTNoVTc3Tkx6N1NaTEc0SDlmTXJZOUJiWVFLREg4NHZSNFQ2ajU0TzM=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[13]</b>
                                         蒋和国, 蒋烈辉, 舒辉, 等.基于 JTAG 仿真的 ARM Linux 设备 Bootkit 检测技术研究[J].计算机应用研究, 2016, 33 (2) :526-530.
                                    </a>
                                </li>
                                <li id="191">


                                    <a id="bibliography_14" title=" 刘文祺, 范明钰, 赵永福.隐藏关系下计算机异常干扰检测方法仿真研究[J].计算机仿真, 2018, 35 (1) :424-427." target="_blank"
                                       href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JSJZ201801095&amp;v=MTI2OTE0TzN6cXFCdEdGckNVUjdxZlp1WnRGeTNoVTc3Tkx6N0JkTEc0SDluTXJvOU1ZWVFLREg4NHZSNFQ2ajU=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                        <b>[14]</b>
                                         刘文祺, 范明钰, 赵永福.隐藏关系下计算机异常干扰检测方法仿真研究[J].计算机仿真, 2018, 35 (1) :424-427.
                                    </a>
                                </li>
                            </ul>
                            <div style='display: none;' class="zqscroller" >
                                <h4 class="">附加材料</h4>
                                <ul></ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            &nbsp;
            <!--此处有一空格符 勿删-->
        </div>

        
    <div class="content">



        <!--tips start-->
                            <div class="tips">
                    <a href="http://navi.cnki.net/KNavi/JournalDetail?pcode=CJFD&amp;pykm=JYRJ" target="_blank">计算机应用与软件</a>
                2019,36(06),221-225+232 DOI:10.3969/j.issn.1000-386x.2019.06.041            </div>
        <!--tips end-->
            <div class="top-title">
                <h1 class="title">
                    <span class="vm"><b>面向Linux系统的嵌入式设备陷门模板化框架</b></span>
                                    </h1>

            </div>
                        <h2>
                                <a href="javascript:;">赵利军</a>
                                <a href="javascript:;">董莎莎</a>
                                <a href="javascript:;">张沙石</a>
                </h2>
                    <h2>

                    <span>陆军工程大学军事理论创新与作战实验中心</span>
            </h2>

        
<div class="link">
    <a id="aexport" class="icon icon-output"  onclick="" href="javascript:void(0);"><i></i>导出/参考文献</a>
    
    <span class="shareBoard" onmouseover="$('#sharedet').show();$('#this').addClass('shareBoardCUR')" onmouseout="$('#sharedet').hide();$('#this').removeClass('shareBoardCUR')">
        <a class="icon icon-share" href="#"><i></i>分享<em></em></a>
        <ul class="shareHide" id="sharedet" style="display: none;">
            <li><a title="复制链接" class="copy" onclick="" href="#"><i></i>复制链接</a></li>
            <li><a title="分享到新浪微博" class="xl" onclick="" href="javascript:common.ShareAction('xl');"><i></i>新浪微博</a></li>
            <li>
                <a title="分享到微信" class="wx" onclick="" href="#"><i></i>微信扫一扫</a>
                <div class="qrcode"><img src='' alt='' /></div>
            </li>
        </ul>

    </span>
    
    <a id="RefTrack" title="创建引文跟踪" class="icon icon-track" onclick="" href="javascript:void(0);"> <i></i>创建引文跟踪 </a>
    <a id="ashoucang" title="收藏" class="icon icon-favor" onclick="" href="javascript:void(0);"><i></i>收藏</a>
    <a class="icon icon-print" onclick="window.print();" href="javascript:void(0);"><i></i>打印</a>
    
    <!--版本切换 end-->
</div>
                            <div class="data" id="a_abstract">
                <span class="keys">摘<span style="font-family: 'Times New Roman';">&nbsp;&nbsp;&nbsp;&nbsp;</span>要：</span>
                <p>不同嵌入式设备间存在差异, 且陷门的设计受设备的软硬件结构特点及启动过程的差异影响较大。因此, 几乎不可能设计出一个固定不变的代码适用于任何设备的陷门。为解决上述问题, 研究嵌入式设备的启动过程, 建立涵盖不同启动流程异同点, 搭建陷门模板化设计框架。为设计具有一定程度通用性的陷门提供了依据。</p>
            </div>
                    <div class="data" id="a_keywords">
                <span class="keys">关键词：</span>
                <p>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=%E9%80%9A%E7%94%A8%E6%80%A7&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">通用性;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=%E9%99%B7%E9%97%A8&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">陷门;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=%E5%90%AF%E5%8A%A8%E6%A8%A1%E5%9E%8B&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">启动模型;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=%E6%A8%A1%E6%9D%BF%E5%8C%96%E6%A1%86%E6%9E%B6&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">模板化框架;</a>
                </p>
            </div>
        
        <!--brief start-->
        
            <div class="brief">
                    <p>
                            <b>作者简介：</b>
                                                        <span>
                                    赵利军, 讲师, 主研领域:软件开发, 信息安全。;
                                </span>
                                <span>
                                    董莎莎, 讲师。;
                                </span>
                                <span>
                                    张沙石, 助教。;
                                </span>
                    </p>
                                    <p><b>收稿日期：</b>2018-11-06</p>

            </div>
                    <h1><b>TRAPDOOR TEMPLATE FRAMEWORK FOR LINUX SYSTEM ON EMBEDDED DEVICE</b></h1>
                    <h2>
                    <span>Zhao Lijun</span>
                    <span>Dong Shasha</span>
                    <span>Zhang Shashi</span>
            </h2>
                    <h2>
                    <span>Military Theoretical Innovation and Operational Experiment Center, Army Engineering University of PLA</span>
            </h2>
                            <div class="data" id="a_abstractEN">
                <span class="keys">Abstract：</span>
                <p>There are differences among different embedded devices, and the design of trapdoor is greatly influenced by the differences of hardware and software structure and start-up process. So it is almost impossible to design a trapdoor with fixed code, which is suitable for any device. To solve the above problems, this paper studied the start-up process of embedded devices, established a trapdoor template design framework covering the similarities and differences of different start-up processes, and built a trapdoor template design framework. It provides a basis for the design of trapdoor with a certain degree of versatility.</p>
            </div>
                    <div class="data" id="a_keywordsEN">
                <span class="keys">Keyword：</span>
                <p>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=Generality&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">Generality;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=Trapdoor&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">Trapdoor;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=Startup%20model&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">Startup model;</a>
                        <a href="/kcms/detail/knetsearch.aspx?dbcode=CJFD&amp;sfield=kw&amp;skey=Template%20framework&amp;code=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" target="_blank">Template framework;</a>
                </p>
            </div>
                    <div class="brief">
                
                    <p>
                                            </p>
                                    <p><b>Received：</b> 2018-11-06</p>
                            </div>


        <!--brief start-->
                        <h3 id="31" name="31" class="anchor-tag"><b>0 引 言</b></h3>
                <div class="p1">
                    <p id="32">随着嵌入式设备的广泛使用, 如何攻克嵌入式设备成为当前网络空间作战中的关键环节, 为了能继续持有攻击主机的访问特权, 恶意程序必须较好地隐藏自己不被检测工具发现。作为一种高级的隐藏技术, 近几年PC机上的陷门攻击技术——Bootkit技术, 得到了广泛使用和发展。Bootkit技术是一种更高级的Rootkit技术, 两者的不同之处在于Bootkit将存储位置从文件系统变为硬件存储, 并且在操作系统加载之前启动。Rootkit修改操作系统内核, 重装系统可将其清除。Bootkit在加载操作系统之前启动, 因此独立于任何操作系统。与传统的Rootkit技术主要是在系统启动时提升权限不同, Bootkit通过篡改内核及操作系统引导过程隐藏自身。</p>
                </div>
                <div class="p1">
                    <p id="33">2007年研究人员IceLord (网名) 发布的公开资料是可以找到的第一个Windows环境下的BIOS Rootkit<citation id="193" type="reference"><link href="165" rel="bibliography" /><sup>[<a class="sup">1</a>]</sup></citation>。由此, 针对BIOS的陷门设计从一个技术构想变成了程序实体。同一年, Nitin Kumar和Vipin Kumar在Black Hat大会上呈现了一种名为Vbootkit的Bootkit攻击技术, 并成功突破Windows Vista系统。Vbootkit能够篡改引导向量获取执行权限, 绕过启动管理器的签名机制。通过Hook  Windows Vista系统启动文件入侵操作系统内核<citation id="194" type="reference"><link href="167" rel="bibliography" /><sup>[<a class="sup">2</a>]</sup></citation>。在2008年, Wenbin Zhen等<citation id="195" type="reference"><link href="169" rel="bibliography" /><sup>[<a class="sup">3</a>]</sup></citation>发布了Tophet.a, 一款基于篡改OSLoader的Bootkit技术。该技术可使攻击者获取系统控制权并通过篡改boot.ini文件中的语法格式将控制权转换到攻击者的驱动。同年的Black Hat大会上, C.Miller通过嗅探MacBook电池中内建的电量控制器经I2C收到的数据, 对电池的嵌入式微控制器固件进行修改, 可以使电池过度发热甚至起火, 并能够在获得微控制器的控制权后对系统进行配置<citation id="196" type="reference"><link href="171" rel="bibliography" /><sup>[<a class="sup">4</a>]</sup></citation>。Lee等<citation id="197" type="reference"><link href="173" rel="bibliography" /><sup>[<a class="sup">5</a>]</sup></citation>提出了劫持ARM Linux嵌入式设备的方法, 该方法借鉴通用计算机下的Linux系统常用劫持方案, 将系统调用表或者系统调用函数进行修改, 并指向自己的恶意代码, 从而实现控制流的转移, 达到劫持目的。在文献<citation id="198" type="reference">[<a class="sup">6</a>]</citation>中阐述了破解Netgear NTV300电视机顶盒的方法。文中作者dump下Netgear NTV300中的固件映像, 通过Binwalk解析固件组成、使用的压缩算法等, 并使用IDA的静态分析功能, 最终实现了对该设备的漏洞注入和远程控制。2013年, Ang Cui等<citation id="199" type="reference"><link href="177" rel="bibliography" /><sup>[<a class="sup">7</a>]</sup></citation>介绍了惠普HP-RFU (远程固件升级) 激光打印机固件修改漏洞, 通过打印含有特殊命令的文档来隐蔽地修改打印机的固件, 进而获得该打印机的控制权, 并采用静态分析方法对其中使用的第三方库分析发现超过80.4%的固件程序存在zlib漏洞。文献<citation id="200" type="reference">[<a class="sup">8</a>]</citation>对惠普RFU漏洞进行了验证, 攻击者通过MS Office Word、Adobe PostScript等标准的打印文档向任意打印机中注入恶意代码和命令, 使用这种攻击途径可以向打印机发送修改后的固件。2015年, 李成林<citation id="201" type="reference"><link href="181" rel="bibliography" /><sup>[<a class="sup">9</a>]</sup></citation>针对目前主流杀毒软件对KiFastCallEntry挂钩提出了躲避方案, 提出了改进型SSDT挂钩, 该方法不再直接修改SSDT分发表里的函数入口地址, 而是在函数体的内部进行修改。2016年, 冯培钧等<citation id="202" type="reference"><link href="183" rel="bibliography" /><sup>[<a class="sup">10</a>]</sup></citation>在“一种新型 Linux 内核级 Rootkit 设计与实现”一文中设计并实现了一种新型Linux内核级Rootkit, 该Rootkit能够实现后门提权、进程隐藏及文件隐藏等功能, 并能绕过当前主流的Rootkit检测工具的检测。2017年, 李扬等<citation id="203" type="reference"><link href="185" rel="bibliography" /><sup>[<a class="sup">11</a>]</sup></citation>提出一种基于硬件虚拟化的内核Rootkit技术, 该技术利用Intel VT-x硬件虚拟化技术将客户系统 (Guest OS) 迁移到VMM之上运行实现Rootkit。</p>
                </div>
                <div class="p1">
                    <p id="34">但是, 对于一个新的嵌入式设备, 多数的陷门设计技术都难以在有限的时间内设计出来, 设计的陷门通用性也较差, 无法部署到不同目标设备上。为此, 本文通过研究嵌入式设备的启动过程, 建立涵盖不同启动流程异同点的、陷门模板化设计框架, 为设计具有一定程度通用性的陷门提供依据。</p>
                </div>
                <h3 id="35" name="35" class="anchor-tag"><b>1 陷门模板化技术</b></h3>
                <div class="p1">
                    <p id="36">嵌入式设备的软硬件结构特点及启动过程的差异性严重影响陷门的设计效率, 人们可以针对不同设备, 进行分析和设计符合需求的陷门。但本文尝试引入陷门设计的模板化框架, 旨在为提炼出一种具有一定程度通用性的、适用于主流嵌入式设备的陷门设计提供方便。</p>
                </div>
                <h4 class="anchor-tag" id="37" name="37"><b>1.1 嵌入式设备启动流程分析</b></h4>
                <div class="p1">
                    <p id="38">首先, 我们对各种不同的嵌入式设备启动流程进行分析, 归纳它们的相同点与差异性, 建立统一的启动流程。</p>
                </div>
                <div class="p1">
                    <p id="39">存储芯片不同会造成Bootloader引导的差异;Bootloader不同会造成内核启动流程的差异;不同内核加载过程也存在较大差异;不同文件系统挂载的机制也有区别。启动流程分析主要是对这些差异性进行总结和归纳。</p>
                </div>
                <div class="p1">
                    <p id="40">Bootloader的启动过程可以是单个阶段的, 也可划分为多个阶段, 嵌入式设备下一般为二阶段的启动过程, 分Stage1和Stage2两部分启动。二阶段的Bootloader启动流程如图1所示。</p>
                </div>
                <div class="area_img" id="41">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JYRJ201906042_041.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图1 Bootloader启动流程" src="Detail/GetImg?filename=images/JYRJ201906042_041.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图1 Bootloader启动流程  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JYRJ201906042_041.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="p1">
                    <p id="42">导致Bootloader启动方式差异的因素还有内核挂载文件系统机制的差异。以Linux内核为例, Linux内核中包含两种挂载早期根文件系统的机制, 即initrd机制和initramfs机制。</p>
                </div>
                <div class="p1">
                    <p id="43">initrd是一个功能完备的小型根文件系统, 是一种启动早期用户空间处理流程的老式方法, 它通常包含一些指令, 用于在系统引导完成之前加载一些特定的设备驱动程序。为了使用initrd的功能, 大多数架构的引导加载程序会将initrd镜像传递给内核。常见的场景是, 引导加载程序先将压缩过的内核镜像加载到内存中, 接着将initrd镜像加载到另一段可用内存中。如图2所示。</p>
                </div>
                <div class="area_img" id="44">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JYRJ201906042_044.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图2 initrd机制启动流程" src="Detail/GetImg?filename=images/JYRJ201906042_044.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图2 initrd机制启动流程  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JYRJ201906042_044.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="p1">
                    <p id="45">在这个过程中, 引导加载程序负责在将控制权转交给内核之前, 将initrd镜像的地址传递给内核。具体的机制取决于架构、引导加载程序和平台的实现。然而, 内核必须知道initrd镜像的位置才能够加载它。当内核引导时, 它首先会检测内核命令行中是否包含root=参数并指定一个ramdisk (比如root=/dev/ram0) 。然后, 将这个压缩的二进制文件从内存中的指定位置复制到一个合适的内核ramdisk中, 并挂载它作为根文件系统。与PC机上Linux内核会卸载initrd, 尝试挂载另一个文件系统作为其根文件系统不同, 这类系统中唯一的根文件系统就是ramdisk, 在整个系统初始化完成后, initrd就会成为最终的根文件系统。</p>
                </div>
                <div class="p1">
                    <p id="46">与initrd是一种基于RAM的块设备不同, initramfs是一种基于RAM的内存文件系统。initramfs在编译内核的同时被编译, 并与内核连接成一个文件。在引导阶段它与内核同时被Bootloader加载到RAM中。而initrd是另外单独编译生成的, 是一个独立的文件, 它由Bootloader单独加载到RAM中内核空间外的地址。其启动过程如图3所示。</p>
                </div>
                <div class="area_img" id="47">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JYRJ201906042_047.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图3 initramfs机制启动流程" src="Detail/GetImg?filename=images/JYRJ201906042_047.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图3 initramfs机制启动流程  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JYRJ201906042_047.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="p1">
                    <p id="48">不同机制下根文件系统的挂载方式不同, 如图4所示。</p>
                </div>
                <div class="area_img" id="49">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JYRJ201906042_049.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图4 根文件系统挂载方式示意图" src="Detail/GetImg?filename=images/JYRJ201906042_049.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图4 根文件系统挂载方式示意图  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JYRJ201906042_049.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="p1">
                    <p id="50">根据上述分析的Bootloader启动流程和内核挂载文件系统机制的差异, 对启动流程的共性和特性进行归纳, 得到Linux内核嵌入式设备启动流程的一般化描述, 如图5所示。</p>
                </div>
                <div class="area_img" id="51">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JYRJ201906042_051.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图5 嵌入式Linux启动流程" src="Detail/GetImg?filename=images/JYRJ201906042_051.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图5 嵌入式Linux启动流程  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JYRJ201906042_051.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="p1">
                    <p id="52">图中①与①<sup>2</sup>代表启动过程中不同的执行路径, 其中①表示不同设备之间启动过程中的共性阶段, ①<sup>2</sup>表示不同设备之间启动过程的差异性阶段。同理, ②与②<sup>2</sup>、③与③<sup>2</sup>、④与④<sup>2</sup>分别代表不同设备系统启动过程中不同的执行路径。</p>
                </div>
                <h4 class="anchor-tag" id="53" name="53"><b>1.2 嵌入式设备启动模型</b></h4>
                <div class="p1">
                    <p id="54">Linux系统启动流程中, 将涉及陷门模块设计的执行阶段划分出来, 隔离成黑盒, 得到粗粒度的Linux启动流程, 如图6所示。</p>
                </div>
                <div class="area_img" id="55">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JYRJ201906042_055.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图6 隔离涉及陷门模块设计执行阶段后的启动流程图" src="Detail/GetImg?filename=images/JYRJ201906042_055.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图6 隔离涉及陷门模块设计执行阶段后的启动流程图  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JYRJ201906042_055.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="p1">
                    <p id="56">图6中, 黑盒1和黑盒2属于引导代码级陷门组件模块。黑盒3属于内核级陷门组件模块, 黑盒4为文件系统级陷门组件模块。其中, 除黑盒1外, 其他黑盒内部均存在路径分支, 陷门的设计需要依据设备的实际执行路径进行考虑。建立的嵌入式Linux启动模型如图7所示。</p>
                </div>
                <div class="area_img" id="57">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JYRJ201906042_057.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图7 嵌入式Linux启动模型" src="Detail/GetImg?filename=images/JYRJ201906042_057.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图7 嵌入式Linux启动模型  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JYRJ201906042_057.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="p1">
                    <p id="58">由于Bootloader Stage2、加载initrd、内核自解压与搬移、解压与搬移initrd操作在某些设备启动过程中不存在, 因而用虚线框表示。陷门设计时, 这些阶段对应的陷门组件需要依据实际设备的启动过程和陷门需求进行组合。</p>
                </div>
                <h4 class="anchor-tag" id="59" name="59"><b>1.3 陷门模板化</b></h4>
                <div class="p1">
                    <p id="60">高级语言中模板是根据参数类型生成函数和类的机制 (有时称为“参数决定类型”) 。通过使用模板, 可以只设计一个类来处理多种类型的数据, 而不必为每一种类型分别创建类。借鉴高级语言中模板函数、模板类等思想, 提出陷门模板化技术。</p>
                </div>
                <div class="p1">
                    <p id="61">陷门模板可以比作一个生成陷门攻击代码的“模子”, 是对适用于某一类型设备 (功能相同、结构相似) 的攻击方式的抽象化概括, 一个陷门模板允许根据具体的设备分析结果填写某些参数, 将模板实例化成针对某个特定设备的陷门。陷门模板化设计方法能够实现部分环节的自动化、减少人工工作量, 从一定程度上降低了陷门开发的难度, 提高了陷门设计的效率。结合启动模型, 模板化陷门设计框架如图8所示。</p>
                </div>
                <div class="area_img" id="62">
                                <a class="zoom-in" href="Detail/GetImg?filename=images/JYRJ201906042_062.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">
                                    <img alt="图8 模板化陷门设计框架" src="Detail/GetImg?filename=images/JYRJ201906042_062.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                                </a>
                                <p class="img_tit">图8 模板化陷门设计框架  <a class="btn-zoomin" href="Detail/GetImg?filename=images/JYRJ201906042_062.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!"></a><a class="downimg">&nbsp;&nbsp;下载原图</a></p>
                            <p class="img_tit"></p>

                </div>
                <div class="p1">
                    <p id="63">整个陷门模板分为BootLoader级组件、内核级组件和文件系统级组件, 分别对应引导阶段、内核启动阶段、文件系统挂载阶段的操作。其中文件系统级组件可单独实现陷门攻击, 也可与其他两个组件配合使用。陷门模板留有拼接各组件的配置接口, 可根据实际对目标设备的分析结果进行扩展。每个组件也以可配置的形式存在, 可根据陷门设计需求实例化为某个特定功能的组件。</p>
                </div>
                <div class="p1">
                    <p id="64">陷门功能组件中又分别存在不同部件, 不同部件功能也相对独立, 部件间一般需要互相配合完成特定功能。部件内部也留有“个性化”的配置接口, 可根据对实际设备的分析填写相应的参数。特别说明路径选择部件主要负责根据设备启动阶段的判别信息, 选择陷门设计所需的部件。</p>
                </div>
                <h3 id="65" name="65" class="anchor-tag"><b>2 陷门模板设计实例</b></h3>
                <div class="p1">
                    <p id="66">本文提出的模板化陷门设计框架适用于跨平台的陷门设计。根据陷门框架设计的陷门模板如下所示:</p>
                </div>
                <div class="area_img" id="161">
                                <img alt="" src="Detail/GetImg?filename=images/JYRJ201906042_16100.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                            <p class="img_tit"></p>

                </div>
                <div class="area_img" id="161">
                                <img alt="" src="Detail/GetImg?filename=images/JYRJ201906042_16101.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                            <p class="img_tit"></p>

                </div>
                <div class="p1">
                    <p id="82">陷门模板代码的开头为各模块可配置的参数区。陷门代码的实体部分是一个嵌套的实现过程, 与陷门代码逐级感染设备的流程想匹配。陷门最外层为最先执行的陷门代码模块, 即引导级陷门代码模块。第二层为内核级陷门代码模块。最里层为陷门实际需要完成的功能模块, 如网络劫持、文件下载、破坏设备等, 可根据实际设备选择。每一层的执行任务完成后都会由下一层负责清理上一层陷门代码执行留下的痕迹, 达到陷门隐蔽的效果。</p>
                </div>
                <div class="p1">
                    <p id="83">从陷门设计框架可知, 陷门结构也可能只由文件系统级陷门模块和陷门实际功能模块组成。由前面提出的可重构陷门设计方法可知陷门结构中各模块的组合以及各模块内部不同部件的组成, 都可根据实际需求进行调整。</p>
                </div>
                <div class="p1">
                    <p id="84">陷门功能需要汇编语言实现, 因此陷门模板的实现只适用于某个特定架构。以ARM架构为例, 阐述陷门模板具体实现。由于完整代码太长, 将陷门模板的实现过程进行分块说明。</p>
                </div>
                <h4 class="anchor-tag" id="85" name="85"><b>2.1 可配置参数区实现</b></h4>
                <div class="p1">
                    <p id="86">陷门模板中的可配置参数保留区分为全局参数区和局部参数区。全局参数区主要是一些执行各模块时必须配置的参数, 如Bootloader级模块和内核级模块必须配置内核镜像加载的起始地址及结束地址。局部参数区主要用作陷门各模块内部件执行时的参数配置, 如Bootloader级模块陷门寄生加载部件需要配置陷门加载的地址和大小、碎片重组部件需要配置碎片数目和各碎片加载的地址及大小。可配置参数区的实现如下:</p>
                </div>
                <div class="area_img" id="162">
                                <img alt="" src="Detail/GetImg?filename=images/JYRJ201906042_16200.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                            <p class="img_tit"></p>

                </div>
                <div class="area_img" id="162">
                                <img alt="" src="Detail/GetImg?filename=images/JYRJ201906042_16201.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                            <p class="img_tit"></p>

                </div>
                <h4 class="anchor-tag" id="103" name="103"><b>2.2 程序栈实现</b></h4>
                <div class="p1">
                    <p id="104">“程序栈”是保存和恢复陷门劫持控制流后破坏的设备运行时上下文信息的区域, 一般位于每个陷门模块和模块部件的开头和结尾处。具体实现如下:</p>
                </div>
                <div class="area_img" id="164">
                                <img alt="" src="Detail/GetImg?filename=images/JYRJ201906042_16400.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                            <p class="img_tit"></p>

                </div>
                <h4 class="anchor-tag" id="136" name="136"><b>2.3 数据池实现</b></h4>
                <div class="p1">
                    <p id="137">数据池不仅可以用来存储下一个模块的代码和数据, 也可作为当前模块需要传递给下一个模块的数据保存区。数据池的实现较为简单, 但是陷门模板设计中不可或缺的重要部分, 具体形式如下:</p>
                </div>
                <div class="area_img" id="163">
                                <img alt="" src="Detail/GetImg?filename=images/JYRJ201906042_16300.jpg&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
                            <p class="img_tit"></p>

                </div>
                <div class="p1">
                    <p id="147">其中第一部分为模块间传递的数据区, .ascii 为某个shellcode形式的陷门模块。</p>
                </div>
                <h3 id="148" name="148" class="anchor-tag"><b>3 结 语</b></h3>
                <div class="p1">
                    <p id="149">由于嵌入式设备“客制化”的生产模式, 大多数情况下难以在给定的时间内设计出针对一个新的嵌入式设备的陷门, 设计的陷门通用性也较差, 无法部署到不同目标设备上。本文通过研究嵌入式设备的启动过程, 建立涵盖不同启动流程异同点的, 搭建了陷门模板化设计框架, 最后通过势力说明了陷门模板的设计方法。本文提出了框架为设计具有一定程度通用性的陷门提供了依据。</p>
                </div>

        <!--brief end-->
        
        <!--conten left  end-->
        <!--增强附件-->
        

        <!--reference start-->
            <div class="reference anchor-tag" id="a_bibliography">
                    <h3>参考文献</h3>
                                        <p id="165">
                            <a id="bibliography_1" target="_blank" href="http://scholar.cnki.net/result.aspx?q=BIOS RootKit: Welcome Home, My Lord!">

                                <b>[1]</b> Lord I.BIOS Rootkit:Welcome Home, My Lord! [EB/OL].[2007-05-11].http://www.xfocus.net/articles/200705/918.html.
                            </a>
                        </p>
                        <p id="167">
                            <a id="bibliography_2" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Vboot Kit:Compromising Windows Vista Security">

                                <b>[2]</b> Kumar N, Kumar V.Vbootkit:Compromising windows vista security[C]//BlackHat Europe, 2007.
                            </a>
                        </p>
                        <p id="169">
                            <a id="bibliography_3" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Advanced Bootkit-Tophet">

                                <b>[3]</b> Zheng W.Advanced Bootkit-Tophet[C]//Xcon2008, November, 2008.
                            </a>
                        </p>
                        <p id="171">
                            <a id="bibliography_4" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Battery Firmware Hacking">

                                <b>[4]</b> Miller C.Battery Firmware Hacking[C]//BlackHat USA, 2011.
                            </a>
                        </p>
                        <p id="173">
                            <a id="bibliography_5" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Experimenting with system and Libc call interception a t-tacks on Linux kernel">

                                <b>[5]</b> Lee H, Kim C H, Yi J H.Experimenting with System and Libc Call Interception Attacks on ARM-based Linux Kernel[C]//Proceedings of the 2011 ACM Symposium on Applied Computing.ACM, 2011:631-632.
                            </a>
                        </p>
                        <p id="175">
                            <a id="bibliography_6" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Jailbreaking the NeoTV">

                                <b>[6]</b> Craig.Jailbreaking the NeoTV[EB/OL].[2012-10-23].http://www.devttys0.com/2012/10/jailbreaking-the-neotv/.
                            </a>
                        </p>
                        <p id="177">
                            <a id="bibliography_7" target="_blank" href="http://scholar.cnki.net/result.aspx?q=When firmware modifications attack:A case study of embedded exploitation">

                                <b>[7]</b> Cui A, Costello M, Stolfo S J.When Firmware Modifications Attack:A Case Study of Embedded Exploitation[C]//the 20th Annual Network &amp; Distributed System Security Symposium, 2013.
                            </a>
                        </p>
                        <p id="179">
                            <a id="bibliography_8" target="_blank" href="http://scholar.cnki.net/result.aspx?q=Hacking HP Printers for Fun and Profit">

                                <b>[8]</b> Bambenek.Hacking HP Printers for Fun and Profit[EB/OL].[2011-11-29].https://isc.sans.edu/diary/Hacking+HP+Printers+for+Fun+and+Profit/12112.
                            </a>
                        </p>
                        <p id="181">
                            <a id="bibliography_9" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CMFD&amp;filename=1015624548.nh&amp;v=MDIzNThRS0RIODR2UjRUNmo1NE8zenFxQnRHRnJDVVI3cWZadVp0RnkzaFU3N05WRjI2RzdXNkd0VElwNUViUEk=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[9]</b> 李成林.Rootkit 的改进型实现与检测技术研究[D].南昌:江西师范大学, 2015.
                            </a>
                        </p>
                        <p id="183">
                            <a id="bibliography_10" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=XXGC201602020&amp;v=MTk1NzQ5SFpJUUtESDg0dlI0VDZqNTRPM3pxcUJ0R0ZyQ1VSN3FmWnVadEZ5M2hVNzdOUFRYTWJiRzRIOWZNclk=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[10]</b> 冯培钧, 张平, 陈志锋, 等.一种新型 Linux 内核级 Rootkit 设计与实现[J].信息工程大学学报, 2016, 17 (2) :231-237.
                            </a>
                        </p>
                        <p id="185">
                            <a id="bibliography_11" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=XDJS201705006&amp;v=MDA3NTE0TzN6cXFCdEdGckNVUjdxZlp1WnRGeTNoVTc3TlBTbkJmYkc0SDliTXFvOUZZb1FLREg4NHZSNFQ2ajU=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[11]</b> 李扬, 周安民, 张磊, 等.一种基于硬件虚拟化的 Rootkit 技术[J].现代计算机:中旬刊, 2017 (2) :21-25.
                            </a>
                        </p>
                        <p id="187">
                            <a id="bibliography_12" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=RJDK201605068&amp;v=MDA3MTZVNzdOTnlmUFpiRzRIOWZNcW85RGJJUUtESDg0dlI0VDZqNTRPM3pxcUJ0R0ZyQ1VSN3FmWnVadEZ5M2g=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[12]</b> 孟晨宇, 阮阳, 王佳伟, 等.Rootkit 进程隐藏与检测技术研究[J].软件导刊, 2016, 15 (5) :188-190.
                            </a>
                        </p>
                        <p id="189">
                            <a id="bibliography_13" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JSYJ201602049&amp;v=MjgwNDY0VDZqNTRPM3pxcUJ0R0ZyQ1VSN3FmWnVadEZ5M2hVNzdOTHo3U1pMRzRIOWZNclk5QmJZUUtESDg0dlI=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[13]</b> 蒋和国, 蒋烈辉, 舒辉, 等.基于 JTAG 仿真的 ARM Linux 设备 Bootkit 检测技术研究[J].计算机应用研究, 2016, 33 (2) :526-530.
                            </a>
                        </p>
                        <p id="191">
                            <a id="bibliography_14" target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JSJZ201801095&amp;v=MTI3MTJGeTNoVTc3Tkx6N0JkTEc0SDluTXJvOU1ZWVFLREg4NHZSNFQ2ajU0TzN6cXFCdEdGckNVUjdxZlp1WnQ=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">

                                <b>[14]</b> 刘文祺, 范明钰, 赵永福.隐藏关系下计算机异常干扰检测方法仿真研究[J].计算机仿真, 2018, 35 (1) :424-427.
                            </a>
                        </p>
            </div>
        <!--reference end-->
        <!--footnote start-->
        <!--footnote end-->



    </div>

        <input id="fileid" type="hidden" value="JYRJ201906042" />
        <input id="dpi" type="hidden" value="300" />
    </div>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?6e967eb120601ea41b9d312166416aa6";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
</script>

    


<input id="hid_uid" name="hid_uid" type="hidden" value="WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!" />
<input id="hid_kLogin_headerUrl" name="hid_kLogin_headerUrl" type="hidden" value="/KLogin/Request/GetKHeader.ashx%3Fcallback%3D%3F" />
<input id="hid_kLogin_footerUrl" name="hid_kLogin_footerUrl" type="hidden" value="/KLogin/Request/GetKFooter.ashx%3Fcallback%3D%3F" />
<div class="btn-link" style="display: none"><a target="_blank" href="/kcms/detail/detail.aspx?dbcode=CJFD&amp;filename=JYRJ201906042&amp;v=MjcyMzVoVTc3Tkx6VFpaTEc0SDlqTXFZOUJab1FLREg4NHZSNFQ2ajU0TzN6cXFCdEdGckNVUjdxZlp1WnRGeTM=&amp;uid=WEEvREcwSlJHSldRa1FhcTdnTnhXM3ZKQ291S0FIT2hubWNrWXI0QkNHMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!">知网节</a></div>
<div class="popflow" id="popupTips" style="display: none;">
    <div class="popflowArr"></div>
    <div class="popflowCot">
        <div class="hd"><a href="javascript:void(0);" onclick="$('#popupTips').hide();$('#popupmsg').html('')" class="close">X</a></div>
        <div class="bd">
            <p class="mes" id="popupmsg" name="popupmsg"></p>
          
        </div>
    </div>
</div>
<input type="hidden" id="myexport" value="//kns.cnki.net" />

<input type="hidden" id="KPCAPIPATH" value="//ishufang.cnki.net" />
<input type="hidden" id="CitedTimes" value="" />
<div class="link" id="GLSearch" style="display: none;">
    <i class="icon-trangle"></i>
    <div class="inner">
        <a class="icon" id="copytext">复制</a>
        <a class="icon" target="_blank" onclick="searchCRFD(this)">工具书搜索</a>
    </div>
</div>




<input id="hidVirtualPath" name="hidVirtualPath" type="hidden" value="/kxreader" />
<script src="/kxreader/bundles/detail?v=-ULdk-c6FkZHtJA2KAXPgHnyA8mtgyPnBde_C2VZ2BY1"></script>

<script src="/kxreader/Scripts/layer.min.js" type="text/javascript"></script>

<div id="footerBox" class="rootw footer">
</div>
<script>
    if (typeof FlushLogin == 'function') {
        FlushLogin();
    }
    modifyEcpHeader(true);
</script>

<!--图片放大功能 start-->
<script src="/kxreader/bundles/imagebox?v=W4phPu9SNkGcuPeJclikuVE3PpRyIW_gnfjm_19nynI1"></script>

<script type="text/javascript">
    $(function () {
        var j = $.noConflict();
        j(function () {
            j(".zoom-in,.btn-zoomin").imgbox({
                'alignment': 'center',
                'allowMultiple': false,
                'overlayShow': true
            });
        })
    });
</script>
<!--图片放大功能 end-->
<div class="fixedbar">
    <div class="backtop hiddenV" id="backtop">
        <a id="backTopSide" href="javascript:scroll(0,0);" title=""></a>
    </div>
</div>
<script type="text/javascript" src="/kxreader/Scripts/MathJax-2.6-latest/MathJax.js?config=MML_HTMLorMML-full"></script>

</body>
</html>
